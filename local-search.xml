<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Java8ç‰¹æ€§å­¦ä¹ </title>
    <link href="/2022/07/30/Java8%E7%89%B9%E6%80%A7%E5%AD%A6%E4%B9%A0/"/>
    <url>/2022/07/30/Java8%E7%89%B9%E6%80%A7%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1>Java8ç‰¹æ€§å­¦ä¹ </h1><blockquote><p>Mybatisä¸­å‡ºç°äº†ä¸€äº›ä¸Lambdaç›¸å…³çš„å‡½æ•°æ–¹æ³•ï¼Œä½¿å¾—åœ¨ç¼–ç¨‹æ—¶éå¸¸çš„æ–¹ä¾¿ï¼Œä½†è‡ªå·±å´ä¸çŸ¥é“å¦‚ä½•ä½¿ç”¨åŸºäºJava8çš„è¯­æ³•</p></blockquote><h2 id="æ¦‚è¿°">æ¦‚è¿°</h2><p><strong>ä¼˜ç‚¹</strong></p><ul><li>å¤§æ•°é‡ä¸‹å¤„ç†é›†åˆæ•ˆç‡é«˜</li><li>ä»£ç å¯è¯»æ€§é«˜ï¼Œä»£ç ç®€æ´ï¼Œå¼€å‘å¿«é€Ÿ</li><li>æ˜“äºå¹¶å‘ç¼–ç¨‹</li><li>å‡å°‘åµŒå¥—</li></ul><h3 id="å‡½æ•°å¼ç¼–ç¨‹æ€æƒ³">å‡½æ•°å¼ç¼–ç¨‹æ€æƒ³</h3><p>é¢å‘å¯¹è±¡çš„æ€æƒ³å…³æ³¨çš„è¯´ç”¨ä»€ä¹ˆå¯¹è±¡å®Œæˆä»€ä¹ˆäº‹æƒ…ï¼Œè€Œå‡½æ•°å¼ç¼–ç¨‹å…³æ³¨æ˜¯å¯¹æ•°æ®è¿›è¡Œäº†ä»€ä¹ˆæ“ä½œ</p><h2 id="Lambdaè¡¨è¾¾å¼">Lambdaè¡¨è¾¾å¼</h2><p>æœ¬è´¨æ˜¯JDK8 çš„<strong>è¯­æ³•ç³–</strong>ï¼Œèƒ½å¯¹æŸäº›åŒ¿åå†…éƒ¨ç±»çš„å†™æ³•è¿›è¡Œç®€åŒ–ï¼Œæ˜¯å‡½æ•°å¼ç¼–ç¨‹æ€æƒ³çš„é‡è¦ä½“ç°ã€‚<strong>ä¸å…³æ³¨æ˜¯ä»€ä¹ˆå¯¹è±¡ï¼Œè€Œå…³æ³¨æˆ‘ä»¬å¯¹æ•°æ®è¿›è¡Œäº†ä»€ä¹ˆæ“ä½œ</strong></p><h3 id="ç¤ºä¾‹">ç¤ºä¾‹</h3><p>å…¶ä¸­ä¸€ç§è¾ƒä¸ºå¸¸è§çš„Lambdaè¡¨è¾¾å¼å¦‚ä¸‹ï¼Œä¼ å‚æ˜¯ä¸€ä¸ªæ¥å£å¹¶ä¸”æ¥å£ä¸­åªå®šä¹‰äº†ä¸€ä¸ªæ–¹æ³•</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">" Runnable Thread Start"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p><strong>æ³¨æ„ï¼Œè¿™é‡Œ()ä»£è¡¨çš„é‚£ä¸ªæ¥å£ä¸­çš„å”¯ä¸€çš„é‚£ä¸ªæ–¹æ³•ï¼Œè€Œä¸æ˜¯æŒ‡ä»£é‚£ä¸ªæ¥å£</strong></p><p><strong>è¿”å›å€¼</strong></p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LambdaTest</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">testFunc</span><span class="token punctuation">(</span>value <span class="token operator">-></span>  value<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testFunc</span><span class="token punctuation">(</span><span class="token class-name">MyInt</span> myInt<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">String</span> value <span class="token operator">=</span> myInt<span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">interface</span> <span class="token class-name">MyInt</span><span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token class-name">String</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>å¦‚æœåŒ¿åç±»å‡½æ•°åªæœ‰ä¸€è¡Œï¼Œåˆ™å¯ä»¥ç›´æ¥ä¸åŠ å¤§æ‹¬å·å’Œreturnï¼Œä¹Ÿè¡¨ç¤ºè¿”å›å€¼ã€‚å¦åˆ™åˆ™éœ€è¦æ·»åŠ å¤§æ‹¬å·å’Œreturnï¼ˆå¦‚æœæœ‰è¿”å›ç±»å‹è¦æ±‚çš„è¯ï¼‰</p><p><strong>ä¼˜åŒ–è§„åˆ™</strong></p><ul><li>å‡½æ•°ä½“åªæœ‰ä¸€è¡Œä»£ç æ—¶ï¼Œå¯ä»¥å¿½ç•¥æ‰å¤§æ‹¬å·ï¼Œreturnè¯­å¥ä»¥åŠéšåçš„åˆ†å·</li><li>æ–¹æ³•åªæœ‰ä¸€ä¸ªå‚æ•°æ—¶å°æ‹¬å·å¯ä»¥çœç•¥</li><li>å‚æ•°ç±»å‹å¯ä»¥çœç•¥</li></ul><h2 id="Streamæµ">Streamæµ</h2><p>ç”¨æ¥å¯¹é›†åˆæˆ–æ•°ç»„è¿›è¡Œé“¾çŠ¶æµå¼çš„æ“ä½œ</p><h3 id="å¸¸ç”¨æ“ä½œ">å¸¸ç”¨æ“ä½œ</h3><h4 id="åˆ›å»ºæµ"><strong>åˆ›å»ºæµ</strong></h4><p>é›†åˆå¯¹è±¡.stream()</p><h4 id="ä¸­é—´æ“ä½œ">ä¸­é—´æ“ä½œ</h4><p><strong>filter</strong>ï¼šæ ¹æ®æŸä¸ªæ¡ä»¶è¿‡æ»¤ï¼Œè¿”å›å€¼ä¸ºBooleanå€¼</p><p><strong>map</strong>ï¼šé€šè¿‡æŸç§è½¬åŒ–ï¼ŒæŠŠæµè½¬åŒ–ä¸º<strong>æ‰¿è½½</strong>å¦ä¸€ç§æ•°æ®ï¼ˆæ ¼å¼ï¼‰çš„æµï¼Œ<strong>åªèƒ½æŠŠä¸€ä¸ªå¯¹è±¡è½¬åŒ–æˆå¦ä¸€ä¸ªå¯¹è±¡æ¥ä½œä¸ºæµä¸­çš„å…ƒç´ </strong></p><p><strong>sort</strong>ï¼šæœ‰å‚å’Œæ— å‚ä¸¤ç§ï¼Œæœ‰å‚éœ€è¦æä¾›Comparator</p><p><strong>distinct</strong>ï¼š å»é‡æ“ä½œï¼Œé€šè¿‡ç±»çš„å†…éƒ¨equalsæ–¹æ³•è¿›è¡Œæ¯”è¾ƒ</p><p><strong>limit skip</strong>ï¼šé™åˆ¶æ€»æ¡æ•°ä¸ºå¤šå°‘æˆ–è·³è¿‡<strong>å¼€å¤´</strong>çš„nä¸ªå…ƒç´ </p><p><strong>flatMap</strong>ï¼šæŠŠä¸€ä¸ªå¯¹è±¡è½¬åŒ–ä¸ºå¤šä¸ªå¯¹è±¡ä½œä¸ºæµä¸­çš„å…ƒç´ ï¼Œæ¯”å¦‚ä¸€ä¸ªå¯¹è±¡ä¸­æœ‰ä¸€ä¸ª<code>List&lt;Object&gt;</code> åˆ™flatMapå¯ä»¥å°†æ‰€æœ‰å¯¹è±¡çš„è¯¥å±æ€§æ•´åˆæˆä¸€ä¸ªæ‰¿è½½Objectçš„æµï¼Œè€Œmapåªèƒ½è½¬åŒ–ä¸ºæ‰¿è½½<code>List&lt;Object&gt;</code>çš„æµ</p><h4 id="ç»ˆç»“æ“ä½œ">ç»ˆç»“æ“ä½œ</h4><div class="note note-primary">            <p><strong>æƒ°æ€§æ±‚å€¼</strong>ï¼šå¦‚æœä¸€ä¸ªæµä¸­æ²¡æœ‰ç»ˆç»“æ“ä½œï¼Œåˆ™è¿™ä¸ªæµä¸ä¼šå¯åŠ¨<br><strong>ä¸€æ¬¡æ€§</strong>ï¼šä¸€ä¸ªæµè¿›è¿‡ä¸€ä¸ªç»ˆç»“æ“ä½œååˆ™ä¸èƒ½å†æ¬¡è¢«ä½¿ç”¨</p>          </div><p><strong>forEach</strong></p><p><strong>count</strong></p><p><strong>max&amp;min</strong>: éœ€è¦ä¼ å…¥<code>Optional&lt;Compartor&gt;</code>ï¼ŒæŒ‡å‡ºä»¥å“ªä¸€ç§æ–¹å¼è·å¾—æœ€å¤§æœ€å°å€¼</p><p><strong>collect</strong></p><p>æŠŠå½“å‰æµè½¬åŒ–ä¸ºä¸€ä¸ªé›†åˆ</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token comment">// List è½¬åŒ–  stream.collect(Collectors.toList());</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> collect <span class="token operator">=</span> defaultPersonArrays<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toMap</span><span class="token punctuation">(</span>person <span class="token operator">-></span> person<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> person <span class="token operator">-></span> person<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p>è¿™é‡ŒCollectorsæ˜¯java.util.streamä¸‹çš„ç±»</p><p><strong>anyMatch</strong>: åˆ¤æ–­æœ‰ä»»æ„ç¬¦åˆåŒ¹é…æ¡ä»¶çš„å…ƒç´ ï¼Œåªè¦æœ‰ä¸€ä¸ªåˆ™å°±æ»¡è¶³</p><p><strong>allMatch</strong>: å…¨éƒ¨æ»¡è¶³ä¸ºtrue</p><p><strong>noneMatch</strong>: æµä¸­çš„å…ƒç´ æ˜¯å¦éƒ½ä¸ç¬¦åˆ</p><p><strong>findAny</strong>: è·å–æµä¸­å¯¹ä»»æ„ä¸€ä¸ªå…ƒç´ ï¼Œ<strong>æ— æ³•ä¿è¯ä¸€å®šæ˜¯æµä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ </strong></p><p><strong>findFirst</strong>: è·å–æµä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ </p><p><strong>reduce</strong></p><p>å¯¹æµä¸­çš„æ•°æ®æŒ‰ç…§åˆ¶å®šçš„è®¡ç®—æ–¹å¼ç»™å‡ºä¸€ä¸ªç»“æœï¼ˆç¼©ç´§æ“ä½œï¼‰ã€‚å¯ä»¥ç›´æ¥ç»™å‡ºåˆå€¼ä¹Ÿå¯ä»¥ä¸è®¾ç½®åˆå€¼ï¼ˆä¸è®¾ç½®æ—¶ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºåˆå€¼ï¼‰</p><h2 id="Optional">Optional</h2><p>ä¼˜é›…åœ°é¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œå‡å°‘éç©ºåˆ¤æ–­å¯¹ä»£ç è¡Œæ•°ã€‚æ¯æ¬¡é€šè¿‡æŸ¥è¯¢æˆ–è®¡ç®—å¾—åˆ°ç»“æœæ—¶ï¼Œè‹¥æ–¹æ³•å†…éƒ¨æ²¡æœ‰å¤„ç†ç©ºæ•°æ®çš„é€»è¾‘ï¼Œåˆ™åœ¨å¤–éƒ¨ä»£ç éƒ¨åˆ†å°±å¿…é¡»åˆ¤æ–­ç»“æœæ˜¯å¦ä¸ºç©º</p><h3 id="ä½¿ç”¨">ä½¿ç”¨</h3><p>ç±»ä¼¼åŒ…è£…ç±»</p><p>å°†ä¸€ä¸ªå¯¹è±¡å°è£…æˆOptional</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">></span></span> person1 <span class="token operator">=</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">ofNullable</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ä¼ å…¥å¯¹è±¡å¿…é¡»éç©º</span><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">></span></span> person1 <span class="token operator">=</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p><strong>ifPresent</strong></p><p>å®‰å…¨æ¶ˆè´¹ï¼Œå¦‚æœä¸ä¸ºç©ºçš„è¯ï¼Œåˆ™è¿›è¡Œå¤„ç†</p><p><strong>orElseGet</strong></p><p>å®‰å…¨è·å–å€¼ï¼Œå¦‚æœæ•°æ®ä¸ä¸ºç©ºåˆ™è¿”å›è¯¥æ•°æ®ï¼Œä¸ºç©ºåˆ™æ ¹æ®ä»£ç è¿”å›å¦ä¸€ä¸ªå€¼</p><p><strong>orElseThrow</strong></p><p>å®‰å…¨è·å–å€¼ï¼Œå¦‚æœå€¼ä¸å­˜åœ¨åˆ™æŠ›å‡ºä¸€ä¸ªè‡ªå·±æŒ‡å®šçš„å¼‚å¸¸</p><p><strong>get</strong> ä¸å®‰å…¨è·å–å€¼ï¼Œå¦‚æœOptionalä¸­ä¸å­˜åœ¨å€¼ï¼Œåˆ™ä¼šæŠ›å‡ºå¼‚å¸¸</p><p><strong>filter</strong> å¦‚æœä¸ç¬¦åˆæ¡ä»¶ï¼Œåˆ™ä¼šå˜æˆä¸€ä¸ªæ— æ•°æ®çš„Optionalå¯¹è±¡</p><p><strong>isPresent</strong> æ˜¯å¦å­˜åœ¨å€¼ è¿”å›boolean</p><p><strong>map&amp;flatMap</strong> åŒStreamï¼Œåªæ˜¯å˜æˆäº†å•ä¸€å¯¹è±¡</p><h2 id="å‡½æ•°å¼æ¥å£">å‡½æ•°å¼æ¥å£</h2><p>å‡½æ•°æ¥å£ï¼š åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ï¼ˆé»˜è®¤æ–¹æ³•ä¸ç®—ï¼‰</p><p>**JDKå‡½æ•°å¼æ¥å£éƒ½åŠ ä¸Šäº†<code>@FunctionalInterface</code>ï¼Œä½†æ— è®ºæ˜¯å¦æœ‰æ­¤æ³¨è§£ï¼Œåªè¦æ¥å£ä¸­åªæœ‰ä¸€ä¸ªæ–¹æ³•åˆ™éƒ½æ˜¯å‡½æ•°å¼æ¥å£ã€‚æ­¤æ³¨è§£åªæ˜¯ä¸€ä¸ªæ ‡æ³¨ **</p><p>JDKä¸­é»˜è®¤ç»™å‡ºäº†å‡ ä¸ªå‡½æ•°å¼æ¥å£ã€‚Consumeræ¶ˆè´¹æ¥å£ã€ Functionè®¡ç®—è½¬æ¢æ¥å£ï¼ˆæ¥å—ä¸€ä¸ªTç±»å‹æ•°æ®å¹¶è¿”å›ä¸ºRç±»å‹æ•°æ®ï¼‰ã€ Predictåˆ¤æ–­æ¥å£ã€ç”Ÿäº§å‹æ¥å£Supplyï¼ˆç”Ÿæˆä¸€ä¸ªç±»å‹çš„å¯¹è±¡ï¼‰ç­‰</p><p>è‡³äºBiConsumer ã€ BiFunctionç­‰ï¼Œå·®åˆ«æ˜¯éœ€è¦ä¸¤ä¸ªå‚æ•°</p><h3 id="é»˜è®¤æ–¹æ³•æ­é…">é»˜è®¤æ–¹æ³•æ­é…</h3><p>ä¾‹å¦‚Predictæ¥å£ä¸­è¿˜æœ‰andã€orä¹‹ç±»çš„é»˜è®¤æ–¹æ³•ï¼Œåœ¨ä½¿ç”¨streamæ—¶å¯ä»¥é€šè¿‡orã€andæ¥æ‹¼æ¥æ¡ä»¶ï¼ˆä½†ä¼¼ä¹æ— æ³•ä½¿ç”¨lambdaæ¥å®ç°æ‹¼æ¥ï¼Œåªèƒ½ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»çš„æ–¹å¼ï¼‰</p><h2 id="æ–¹æ³•å¼•ç”¨">æ–¹æ³•å¼•ç”¨</h2><p>ä½¿ç”¨lambdaæ—¶è‹¥æ–¹æ³•ä½“ä¸­åªæœ‰ä¸€ä¸ªæ–¹æ³•çš„å¼•ç”¨ï¼Œåˆ™å¯ä»¥ç”¨æ–¹æ³•å¼•ç”¨è¿›ä¸€æ­¥ä¼˜åŒ–ä»£ç ï¼Œä¾‹å¦‚Mybatisä¸­çš„lambdaQueryWrapperä½¿ç”¨æŸ¥è¯¢æ—¶å°±æœ‰Class::Function</p><p><strong>æ ¼å¼ï¼šç±»å/å¯¹è±¡å :: æ–¹æ³•å</strong></p><ul><li><p><strong>è°ƒç”¨é™æ€æ–¹æ³•</strong>ï¼šæŠ½è±¡æ–¹æ³•åªæœ‰ä¸€è¡Œå—²å—ï¼Œä¸”å…¶ä¸­çš„å‚æ•°éƒ½æŒ‰ç…§é¡ºåºä¼ å…¥é™æ€æ–¹æ³•ä¸­ä¸­ï¼Œé¢å¯ä»¥ç›´æ¥ä½¿ç”¨ ç±»å:æ–¹æ³•å çš„æ–¹å¼ï¼ˆå‚æ•°éƒ½ä¸ç”¨å†™äº†ï¼‰</p></li><li><p><strong>å¼•ç”¨å¯¹è±¡çš„å®ä¾‹æ–¹æ³•</strong>ï¼šå‰ç½®æ¡ä»¶ä¸ä¸Šç±»ä¼¼ï¼Œä½†æœ€ç»ˆä¸º <strong>å¯¹è±¡</strong>å:æ–¹æ³•å</p></li><li><p><strong>å¼•ç”¨ç±»çš„å®ä¾‹æ–¹æ³•</strong>ï¼š å®ç°çš„æ–¹æ³•ä½“åªæœ‰ä¸€è¡Œä»£ç ï¼Œä¸”è¿™è¡Œä»£ç è°ƒç”¨äº†ç¬¬ä¸€ä¸ªå‚æ•°çš„æˆå‘˜æ–¹æ³•ï¼Œå¹¶ä¸”å®ç°çš„æ¥å£çš„æ–¹æ³•ä¸­<strong>å‰©ä½™çš„æ‰€æœ‰å‚æ•°</strong>éƒ½æŒ‰ç…§é¡ºåºä¼ å…¥åˆ°è¿™ä¸ªæˆå‘˜æ–¹æ³•ä¸­ã€‚ç±»å:æ–¹æ³•å</p></li><li><p><strong>æ„é€ å™¨å¼•ç”¨</strong>ï¼šä¸€æ ·ï¼ŒæŠ½è±¡æ–¹æ³•ä¸­å®šä¹‰çš„å‚æ•°éƒ½æŒ‰ç…§é¡ºåºä¼ å…¥äº†æ„é€ å™¨ä¸­ï¼Œç±»å:new</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Echo-è½¯å·¥å®è®­-å›¢é˜ŸSpringBooté¡¹ç›®æ€»ç»“</title>
    <link href="/2022/07/08/%E8%BD%AF%E5%B7%A5%E5%AE%9E%E8%AE%AD-%E5%9B%A2%E9%98%9FSSM%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/"/>
    <url>/2022/07/08/%E8%BD%AF%E5%B7%A5%E5%AE%9E%E8%AE%AD-%E5%9B%A2%E9%98%9FSSM%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<h1>Echo-è½¯å·¥å®è®­-å›¢é˜ŸSpringBooté¡¹ç›®æ€»ç»“</h1><blockquote><p>å¿™ç¢Œäº†4å‘¨ï¼Œç»ˆäºç»“æŸäº†å­¦é™¢çš„å®è®­è¯¾ç¨‹ï¼Œä¹Ÿæ˜¯å¤§å­¦ä»¥æ¥æœ€åä¸€ä¸ªç”±å›¢é˜Ÿåä½œå®Œæˆçš„å®è®­é¡¹ç›®ï¼Œä¹Ÿç®—æ˜¯è‡ªå·±æ¯”è¾ƒç”¨å¿ƒä¸å›¢é˜Ÿæˆå‘˜ä¸€èµ·å®Œæˆçš„é¡¹ç›®äº†ã€‚è™½ç„¶æœ€ç»ˆæ•ˆæœè¿˜ä¸æ˜¯å¾ˆå¥½ï¼Œä½†è‡ªå·±è¿˜æ˜¯èŠ±äº†è®¸å¤šæ—¶é—´ä¸ç²¾åŠ›ï¼Œç¬¬ä¸€æ¬¡æ¯”è¾ƒæ­£è§„çš„ç»„ç»‡å¼€å‘ï¼Œåœ¨æ­¤è¿›è¡Œä¸€ä¸‹å¤ç›˜ï¼Œæ€»ç»“ä¸€ä¸‹ç»„ç»‡å¼€å‘æ—¶è‡ªå·±ä¸€äº›ç–å¿½ä¹‹å¤„ä¸é¡¹ç›®å¼€å‘æ—¶æ‰€é‡åˆ°çš„é—®é¢˜ã€‚ä¹Ÿç®—æ˜¯è‡ªå·±åç«¯å®é™…å¼€å‘æ‰€ç çš„ç¬¬ä¸€å—ç –äº†</p></blockquote><h2 id="ä»‹ç»-v8">ä»‹ç»</h2><p>æ‰€é€‰å®šçš„é¡¹ç›®æ˜¯åŸºäºCSDNä¸çŸ¥ä¹ä¹‹é—´çš„å¼€å‘è€…è®ºå›ç¤¾åŒº <strong>Echo</strong>, æ„Ÿè§‰åœ¨æƒ³æ³•ä¸Šæ˜¯ç»“åˆäº†è¿™ä¸¤è€…ä¸Hexoåšå®¢çš„æ„Ÿè§‰ã€‚è¿™ä¸ªå‘½åæ˜¯å¾ˆå¥½çš„ï¼Œæœ‰å‡ å±‚è¯­ä¹‰ï¼Œä¸€æ˜¯Echoæœ¬èº«æœ‰å›å£°çš„æ„æ€ï¼Œå¸Œæœ›å¼€å‘è€…åœ¨æŠ€æœ¯è®ºå›è¿›è¡Œå‘å¸–ã€è®¨è®ºä¸æ±‚é—®æ—¶èƒ½å¾—åˆ°å›åº”ï¼›äºŒæ˜¯æœ‰ç†æƒ³çš„å¸Œæœ›, æœ‰å«å£°å°±æœ‰å›å£°ï¼Œæœ‰ä»˜å‡ºå°±æœ‰æ”¶è´§ï¼›ä¸‰æ˜¯Echoæœ¬æ¥å°±ä½œä¸ºLinuxå‘½ä»¤çš„å…³é”®è¯ï¼Œä¹Ÿæœ‰åŒå…³ä¹‹æ„ã€‚</p><p>é¡¹ç›®ä¸»è¦åˆ†ä¸ºä¸‰å¤§æ¨¡å—ï¼š</p><ol><li><strong>ç”¨æˆ·å‰ç«¯é¡µé¢</strong>ï¼ˆç”¨æˆ·è¿›è¡Œæ“ä½œçš„ç•Œé¢ï¼ŒåŒ…æ‹¬å‘è¡¨æ–‡ç« ã€æŸ¥çœ‹æ–‡ç« ç­‰ï¼‰</li><li><strong>ç®¡ç†å‘˜å‰ç«¯ç•Œé¢</strong>ï¼ˆç®¡ç†å‘˜æ“ä½œçš„ç•Œé¢ï¼ŒåŒ…æ‹¬å°ç¦ç”¨æˆ·ã€æ–‡ç« ï¼Œä¸Šæ¶çƒ­é—¨æ–‡ç« ï¼ŒæŸ¥çœ‹æ–‡ç« æ€»æ•°ç­‰ï¼‰</li><li><strong>é€šç”¨åç«¯ç•Œé¢</strong>ï¼ˆç»Ÿä¸€å¯¹ç®¡ç†å‘˜å’Œç”¨æˆ·å‰ç«¯å‘æ¥çš„è¯·æ±‚è¿›è¡Œå¤„ç†å¹¶å“åº”ï¼‰</li></ol><p><strong>å‰ç«¯é¡µé¢çš„éƒ¨åˆ†å±•ç¤º</strong></p><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220708094350410.png" alt="ç™»å½•ä¸»é¡µ"></div><div class="group-image-wrap"><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220708094908059.png" alt="æ³¨å†Œç•Œé¢"></div><div class="group-image-wrap"><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220708094421987.png" alt="é¦–é¡µ"></div></div><div class="group-image-row"><div class="group-image-wrap"><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220708094510465.png" alt="æ–‡ç« é¡µé¢"></div><div class="group-image-wrap"><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220708094601371.png" alt="æœç´¢ç•Œé¢"></div></div></div><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220708094609133.png" alt="æœç´¢ç”¨æˆ·ç•Œé¢"></div><div class="group-image-wrap"><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220708094714625.png" alt="æ–‡ç« å‘è¡¨ç•Œé¢"></div><div class="group-image-wrap"><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220708094817675.png" alt="æ–‡ç« æäº¤ç•Œé¢"></div></div><div class="group-image-row"><div class="group-image-wrap"><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220708094806254.png" alt="æ–‡ç« å°é¢å¯è£å‰ª"></div><div class="group-image-wrap"><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220708094836673.png" alt="ä¸ªäººç•Œé¢"></div></div></div><h2 id="å›¢é˜Ÿå¼€å‘">å›¢é˜Ÿå¼€å‘</h2><p>ç”±äºå‰å‡ æ¬¡å¼€å‘ç”±äºéƒ¨åˆ†åŒå­¦ä¸ç†Ÿæ‚‰Gitæ“ä½œç­‰ï¼Œå¯¼è‡´è¿˜æ˜¯æœ‰éƒ¨åˆ†ä½¿ç”¨é¡ºåºå¼€å‘ å‘ZipåŒ…çš„æƒ…å†µï¼Œè¿™æ¬¡å’¬å’¬ç‰™ï¼Œç»Ÿä¸€äº†ä¸‹å¼€å‘è§„èŒƒå¹¶å†™æ˜äº†å¿…é¡»ä½¿ç”¨Gitå’ŒGithubæ¥è¿›è¡Œåˆ†æ”¯å’Œä»“åº“ç®¡ç†ï¼Œå¹¶ä¸”åœ¨å‰åç«¯å¼€å‘è§„èŒƒä¸Šä¹Ÿåšäº†ä¸€äº›ç»Ÿä¸€ã€‚è¿˜æœ‰å¼€ä¼šè®¨è®ºçš„æ—¶å€™ä¹Ÿæœ‰çº¿ä¸Šã€çº¿ä¸‹äº¤æµé—®é¢˜è€Œå¯¼è‡´çš„é¡¹ç›®è¿›åº¦å»¶åç­‰é—®é¢˜ï¼Œä¹Ÿç»Ÿä¸€ä½¿ç”¨é£ä¹¦ä½œä¸ºçº¿ä¸Šæ²Ÿé€šè½¯ä»¶ï¼Œé£ä¹¦äº‘æ–‡æ¡£ä½œä¸ºæ¯æ¬¡å¼€ä¼šå’Œé‡è¦ä»»åŠ¡åˆ†é…çš„è¯´æ˜ï¼Œè®¸å¤šæ–‡æ¡£éƒ½æ”¾åœ¨é£ä¹¦ä¸Šï¼Œä¸å¾—ä¸è¯´ï¼Œæå‰å†™å¥½å¼€å‘è§„èŒƒæ–‡æ¡£ï¼Œè®©é˜Ÿå‘˜ä»¬åœ¨å¼€å‘ä¹‹å‰å…ˆç†Ÿæ‚‰å¦‚ä½•å†™ç»Ÿä¸€çš„ä»£ç ï¼ŒåŒ…æ‹¬åç«¯å¸¸é‡çš„ç»Ÿä¸€ã€å‰ç«¯APIè¯·æ±‚çš„ç»Ÿä¸€å°è£…ã€Gitåˆ†æ”¯å‘½åä¸Githubæpræµç¨‹ç­‰éƒ½æœ‰è¯´æ˜ï¼ˆæ„Ÿè§‰è¿™æ˜¯è‡ªå·±åšçš„æ¯”è¾ƒå¥½çš„ä¸€ç‚¹ï¼‰ï¼Œè™½ç„¶èŠ±äº†ç‚¹æ—¶é—´ï¼Œä½†äº‹å®è¯æ˜è¿™ç‚¹æ—¶é—´æ˜¯å€¼å¾—çš„ã€‚</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220708103250108.png" alt="image-20220708103250108"></p><h2 id="æŠ€æœ¯">æŠ€æœ¯</h2><p>æ€»ç»“ä¸€ä¸‹ç”¨åˆ°çš„ä¸€äº›æŠ€æœ¯å’Œæ¡†æ¶</p><h3 id="åç«¯">åç«¯</h3><p>åç«¯é…ç½®å’Œå®‰å…¨éªŒè¯æ–¹é¢åŸºæœ¬ä¸Šæ˜¯æˆ‘åœ¨åšï¼Œå¯¹è¿™æ–¹é¢ä¹Ÿæ˜¯åˆæ¬¡æ¥è§¦ï¼Œå¯èƒ½è¿˜æœ‰è€ƒè™‘ä¸å‘¨ä¹‹å¤„</p><ul><li>æ•´ä½“é‡‡ç”¨SpringBoot + MybatisPlusæ­å»ºçš„åç«¯æ¡†æ¶</li><li>æ•´åˆäº†JWTä¸SpringSecurityä½œä¸ºç™»å½•éªŒè¯æ¨¡å—, æœ‰ç™»å½•æ‹¦æˆªæ¨¡å—</li><li>æ”¯æŒJavaMailå‘é€é‚®ä»¶</li><li>æ•´åˆSwagger-UIæ–¹ä¾¿æŸ¥çœ‹APIä¿¡æ¯</li><li>ä½¿ç”¨ASpectä½œä¸ºæ—¥å¿—æ‰“å°æ¨¡å—</li><li>éƒ¨åˆ†åŠŸèƒ½é‡‡ç”¨çº¿ç¨‹æ± æŠ€æœ¯ï¼Œå‡å°‘åŒæ­¥çš„è€—æ—¶</li><li>æ•´åˆTencent å¯¹è±¡å­˜å‚¨COS SDKï¼Œæ”¯æŒä¸‹å‘ä¸´æ—¶Keyï¼Œé¿å…SecretKeyç›´æ¥å­˜å‚¨åœ¨å‰ç«¯è€Œå¼•å‘æ³„éœ²é—®é¢˜</li></ul><h3 id="ç”¨æˆ·å‰ç«¯">ç”¨æˆ·å‰ç«¯</h3><p>ä¸ºäº†å‰åç«¯åˆ†ç¦»ï¼Œç”¨æˆ·å‰ç«¯æˆ‘ä»¬é‡‡ç”¨äº†Vue 2.6æ¥å¼€å‘ï¼Œæ•´åˆElement-UIä½œä¸ºè®¾è®¡å…ƒç´ è¾…åŠ©ï¼Œå°è£…Axiosè¿›è¡Œç½‘ç»œè¯·æ±‚å¹¶è¿›è¡Œæ‹¦æˆªï¼Œæ”¯æŒmdè¯­æ³•çš„å›æ˜¾ä¸»è¦æ˜¯é€šè¿‡ä¸€ä¸ªvue-markdownçš„åº“æ¥å®Œæˆï¼Œæœ€ç»ˆæ•ˆæœè¿˜æ˜¯éå¸¸å®Œå–„ã€‚ä½†è¿™éƒ¨åˆ†å·¥ä½œä¸ç”±æˆ‘æ¥å®Œæˆï¼Œæ•…åœ¨è¿™é‡Œä¸èµ˜è¿°ã€‚æœ‰å…´è¶£å¯ç§»æ­¥è‡³ <a href="https://wleoo.gitee.io/">WLeooâ€™s Blog</a> ä¸ <a href="https://dognew0126.github.io/">dogNewâ€™s Blog</a></p><h3 id="æ•°æ®åº“">æ•°æ®åº“</h3><p>æ•°æ®åº“ä¸»è¦è¿˜æ˜¯é‡‡ç”¨Mysqlä¸Redisï¼Œå¯¹å•æ¡æ•°æ®é‡å¤§ä¸”æ•°æ®æ¡æ•°å¤šçš„å®ä½“(ä¾‹å¦‚ç”¨æˆ·ã€æ–‡ç« ä¿¡æ¯ç­‰)éƒ½å­˜å‚¨åœ¨Mysqlä¸­ï¼Œå¯¹ä¸€äº›ç»å¸¸è®¿é—®ä¸”æ•°æ®é‡è¾ƒå°çš„æ¡ç›®ï¼ˆä¾‹å¦‚ç”¨æˆ·TokenéªŒè¯ä¸ç”¨æˆ·å…³æ³¨åˆ—è¡¨ç­‰ï¼‰å°±æ”¾åœ¨Redisä¸­å­˜å‚¨ï¼ŒRedisä¸Mysqléƒ½æ˜¯é€šè¿‡Dockeréƒ¨ç½²åœ¨ä¸€å°æœåŠ¡å™¨çš„ä¸åŒç«¯å£ä¸Šï¼Œä¸æœ¬åœ°ç«¯å£ä¸æ•°æ®æ–‡ä»¶åœ°å€å½¢æˆæ˜ å°„å…³ç³»ã€‚</p><p>ç”¨æˆ·ä¸Šä¼ çš„å›¾ç‰‡ä¸ç”±æœåŠ¡å™¨ä¿å­˜ï¼Œè€Œç›´æ¥äº¤ç”±ç¬¬ä¸‰æ–¹COSå¯¹è±¡å­˜å‚¨æœåŠ¡ï¼ˆTencent COSï¼‰ã€‚</p><h2 id="é—®é¢˜-v6">é—®é¢˜</h2><p>è¿™æ¬¡å¼€å‘ä¸­å…¶å®æœ‰éå¸¸å¤šçš„é—®é¢˜ï¼Œç¬¬ä¸€ä¸ªé—®é¢˜å°±æ˜¯æ²¡æœ‰åœ¨å¼€å‘æ—¶é‡åˆ°çš„è¿™äº›é—®é¢˜åŠæ—¶è®°å½•ï¼Œè€Œæ˜¯æ‹–åˆ°é¡¹ç›®ç»“æŸæ‰æ¥å¤ç›˜ ğŸ˜“ï¼Œè¿™é‡Œåˆ†ç±»æ¥åˆ—å‡º</p><p><strong>å›¢é˜Ÿåˆä½œ</strong></p><ol><li><strong>æ•°æ®åº“è®¾è®¡åº”å½“æå‰ä¸å›¢é˜Ÿæˆå‘˜åœ¨é¡¹ç›®åˆæœŸè®¨è®ºå‡ºåˆç¨¿</strong>ã€‚è€Œæˆ‘ä»¬åªæ˜¯è™½ç„¶åœ¨é£ä¹¦äº‘æ–‡æ¡£ä¸Šæ•²å®šäº†ä¸€äº›å­—æ®µè®¾è®¡ï¼Œä½†æ²¡æœ‰è€ƒè™‘çš„éƒ¨åˆ†è¿˜æœ‰å¾ˆå¤šï¼Œå¯¼è‡´åæœŸè¿˜èŠ±äº†ä¸€äº›æ—¶é—´åœ¨æ•°æ®åº“è®¨è®ºä¸Šï¼ˆåŒæ—¶ä¹Ÿé€ æˆäº†å¼€å‘åˆæœŸæ•°æ®åº“æ— æ³•ç¡®å®šï¼Œå¯¼è‡´æ•°æ®ä¸èƒ½æ’å…¥ï¼Œä¸èƒ½æµ‹è¯•æ•°æ®åº“æ•°æ®æŸ¥è¯¢ï¼‰</li><li><strong>å›¢é˜Ÿæˆå‘˜åˆ†å·¥ä¸æ˜ç¡®ä¸éœ€æ±‚åˆ’åˆ†ä¸å…¨</strong>ã€‚é¡¹ç›®å¼€å‘å‰æ²¡æœ‰å½»åº•è®¨è®ºå‡ºåŠŸèƒ½éœ€æ±‚ä¸å¼€å‘æ—¶åŠŸèƒ½åˆ’åˆ†ï¼Œå¯¼è‡´åœ¨åæœŸè¿˜æœ‰éƒ¨åˆ†åŠŸèƒ½æ— äººå¼€å‘</li><li><strong>æ²¡æœ‰æå‰ç¡®å®šå‰åç«¯è¯·æ±‚æ¥å£</strong>ã€‚ä¹Ÿæ¯”è¾ƒç‰¹æ®Šï¼Œå› ä¸ºæˆ‘ä»¬æ¯ä¸ªäººæ—¢è´Ÿè´£äº†å‰ç«¯åˆè´Ÿè´£äº†åç«¯ï¼Œå¹¶ä¸”æ˜¯æŒ‰ç…§åŠŸèƒ½æ¨¡å—è¿›è¡Œåˆ’åˆ†çš„ï¼Œæ‰€ä»¥è‡ªå·±è´Ÿè´£è‡ªå·±åŠŸèƒ½æ¨¡å—çš„å‰åç«¯ï¼Œè¿™ä¹Ÿå¯¼è‡´äº†ä¸€äº›åç«¯æ¥å£çš„å†—ä½™ä¸å†²çªã€‚åº”è¯¥æ˜¯æå‰è§„èŒƒAPIï¼Œç„¶åå°±ç›´æ¥èƒ½å¤Ÿåœ¨å‰ç«¯ä¸­å…ˆå°è£…å¥½APIè¯·æ±‚äº†ï¼Œè€Œä¸æ˜¯å†™äº†åç«¯å†å¡«å‰ç«¯ã€‚</li><li><strong>æ²¡æœ‰è§„å®šæˆå‘˜å¼€å‘æ¨¡å—çš„DDL</strong>ã€‚æ²¡æœ‰æŒæ¡æ¯ä¸ªäººçš„å¼€å‘è¿›åº¦ï¼Œå®¹æ˜“é€ æˆæœ€ç»ˆäº¤ä»˜æ—¥æœŸä¸è´¨é‡çš„ä¸ç¡®å®šæ€§ã€‚</li><li><strong>æ²¡æœ‰é¢„ç•™Reviewæ—¶é—´</strong>ã€‚é¡¹ç›®åˆå¹¶å®Œåï¼Œåªæ˜¯ç®€å•çš„çœ‹äº†ä¸‹æœ‰æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯æ¶‰åŠåˆ°ä¸€äº›åŠŸèƒ½æ²¡æœ‰è¦†ç›–ï¼ˆå¯¼è‡´æœ€ç»ˆéªŒæ”¶çš„æ—¶å€™è¿˜æœ‰ä¸€ä¸¤ä¸ªbugï¼‰</li></ol><p><strong>åç«¯</strong></p><input type="checkbox" disabled > æ•°æ®åº“ä¸»é”®å­—æ®µè®¾è®¡è¿˜å­˜åœ¨é—®é¢˜ï¼ˆè‡ªå¢ï¼Ÿé›ªèŠ±ç®—æ³•ï¼ŸUUIDï¼Ÿå”¯ä¸€å­—ç¬¦ä¸²ï¼Ÿï¼‰ä»¥åŠä»–ä»¬åˆ†åˆ«çš„åº”ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆ</br><input type="checkbox" disabled > SpringSecurityéªŒè¯æµç¨‹æ²¡æœ‰ææ¸…æ¥šï¼Œé¡¹ç›®å¼€å‘æ—¶åªçŸ¥é“æ€ä¹ˆç”¨ï¼Œè€Œä¸çŸ¥é“ä¸ºä»€ä¹ˆ</br><input type="checkbox" disabled > WebSecurityConfigurerAdapter Webå®‰å…¨é…ç½®å·²è¿‡æ—¶ï¼Œå¦‚ä½•ä½¿ç”¨SecurityFilterChainæ¥ä½œä¸ºæ›¿ä»£</br><input type="checkbox" disabled > Springbootçº¿ç¨‹æ± æŠ€æœ¯çš„åº”ç”¨ä¸çº¿ç¨‹æ± æŠ€æœ¯æ„Ÿè§‰åˆå¿˜äº†ï¼Œä¸å¤ªç†Ÿæ‚‰å…¶ä½œç”¨äº†ã€‚</br><input type="checkbox" disabled > Mybatis-Pluså¯¹æŸä¸€å®ä½“çš„æŸ¥è¯¢(ä¾‹å¦‚å¤šä¸ªæ“ä½œåªæŸ¥è¯¢å…¶ä¸­å‡ ä¸ªå­—æ®µ)ï¼Œæ²¡æœ‰è¿›è¡Œå°è£…ï¼Œå¯¼è‡´å‡ºç°äº†å¤§é‡Duplicate Codeï¼Œåªä¸ºäº†åšç›¸åŒçš„wrapper.select(....)æ“ä½œ</br><input type="checkbox" disabled > ç”¨äº†Swagger-UIä½†æ²¡æœ‰å®Œå…¨ä½¿ç”¨@APIOperationæ¥è¯´æ˜æ¥å£çš„ä½¿ç”¨åœºæ™¯</br><input type="checkbox" disabled > æƒé™åˆ†é…ä¸è®¤è¯è¿™ä¸€å—å› ä¸ºæ—¶é—´ç¼˜æ•…åŸºæœ¬æ²¡æœ‰åš</br><input type="checkbox" disabled > å¯¹Serviceå±‚ä¸­å› Daoå±‚çš„æŸ¥è¯¢å¯èƒ½å¯¼è‡´çš„å¼‚å¸¸æ²¡æœ‰è¿›è¡Œæ•è·ï¼Œå¯¼è‡´è¯·æ±‚è¿”å›ä¸è§„èŒƒ</br><input type="checkbox" disabled > å¯¹Java8 ä¸­å‡ºç°çš„Streamå’ŒLambdaç­‰ç‰¹æ€§ä¸€ç‚¹éƒ½ä¸ç†Ÿæ‚‰ï¼Œæœ‰åœºæ™¯éœ€è¦ä½¿ç”¨æ—¶ä¸èƒ½ä½¿ç”¨è¿™æ ·æ›´å¿«æ·çš„ç¼–ç¨‹æ–¹å¼ï¼ˆMybatis-Plusï¼‰</br><p><strong>å‰ç«¯</strong></p><h2 id="æ€»ç»“-v15">æ€»ç»“</h2>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Spring Boot</tag>
      
      <tag>SSM</tag>
      
      <tag>Team Work</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Springæºç ä¹‹æ—…</title>
    <link href="/2022/06/17/Spring%E6%BA%90%E7%A0%81%E4%B9%8B%E6%97%85/"/>
    <url>/2022/06/17/Spring%E6%BA%90%E7%A0%81%E4%B9%8B%E6%97%85/</url>
    
    <content type="html"><![CDATA[<h1>Springæºç ä¹‹æ—…</h1><blockquote><p>SpringFramework: 5.2.20-RELEASE</p></blockquote><h2 id="Core">Core</h2><h3 id="ApplicationContext">ApplicationContext</h3><p>ApplicationContextå°±æ˜¯Springå®¹å™¨ä¸­çš„ä¸€ç§æŠ½è±¡è¡¨ç¤ºï¼Œå…ˆçœ‹ä¸€ä¸‹ApplicationContextæ¥å£çš„æºç </p><p>æ³¨é‡Šä¸­å¦‚ä¸‹ä»‹ç»ï¼š</p><blockquote><p>Central interface to provide configuration for an application. This is read-only while the application is running, but may be reloaded if the implementation supports this.<br>An ApplicationContext provides:</p><ul><li>Bean factory methods for accessing application components. Inherited from ListableBeanFactory.</li><li>The ability to load file resources in a generic fashion. Inherited from the org.springframework.core.io.ResourceLoader interface.</li><li>The ability to publish events to registered listeners. Inherited from the ApplicationEventPublisher interface.</li><li>The ability to resolve messages, supporting internationalization. Inherited from the MessageSource interface.</li><li>Inheritance from a parent context. Definitions in a descendant context will always take priority. This means, for example, that a single parent context can be used by an entire web application, while each servlet has its own child context that is independent of that of any other servlet.</li></ul></blockquote><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ApplicationContext</span> <span class="token keyword">extends</span> <span class="token class-name">EnvironmentCapable</span><span class="token punctuation">,</span> <span class="token class-name">ListableBeanFactory</span><span class="token punctuation">,</span> <span class="token class-name">HierarchicalBeanFactory</span><span class="token punctuation">,</span> <span class="token class-name">MessageSource</span><span class="token punctuation">,</span> <span class="token class-name">ApplicationEventPublisher</span><span class="token punctuation">,</span> <span class="token class-name">ResourcePatternResolver</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Nullable</span>    <span class="token class-name">String</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// è¿”å›å®¹å™¨çš„å”¯ä¸€Id</span>    <span class="token class-name">String</span> <span class="token function">getApplicationName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¿”å›åº”ç”¨åç§°</span>    <span class="token class-name">String</span> <span class="token function">getDisplayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å±•ç¤ºå</span>    <span class="token keyword">long</span> <span class="token function">getStartupDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å®¹å™¨å¯åŠ¨æ—¶é—´</span>    <span class="token annotation punctuation">@Nullable</span>    <span class="token class-name">ApplicationContext</span> <span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">AutowireCapableBeanFactory</span> <span class="token function">getAutowireCapableBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">;</span> <span class="token comment">// è·å¾—è‡ªåŠ¨è£…é…çš„beanå·¥å‚</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/ApplicationContext.png" alt="ApplicationContextç»§æ‰¿å…³ç³»å›¾"></p><table><thead><tr><th>çˆ¶æ¥å£</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>EnvironmentCapable</td><td>å…·æœ‰è·å–ç¯å¢ƒç›¸å…³å‚æ•°çš„åŠŸèƒ½ï¼Œpropertiessæ–‡ä»¶</td></tr><tr><td>ListableBeanFactory</td><td>æä¾›Beanè¿­ä»£åŠŸèƒ½çš„BeanFactory</td></tr><tr><td>HierarchicalBeanFactory</td><td>æä¾›çˆ¶å®¹å™¨çš„è®¿é—®åŠŸèƒ½çš„BeanFactory</td></tr><tr><td>MessageSource</td><td>å¯¹å›½é™…åŒ–æ–‡ä»¶æ”¯æŒçš„åŸºç¡€æ¥å£</td></tr><tr><td>ApplicationEventPublisher</td><td>åº”ç”¨äº‹ä»¶çš„å‘å¸ƒæ¥å£</td></tr><tr><td>ResourcePatternResolver</td><td>èµ„æºè§£æå’ŒåŠ è½½çš„æ¥å£</td></tr></tbody></table><p>ApplicationContextçš„å®ç°ç±»</p><p><img src="/home/pplong/.config/Typora/typora-user-images/image-20220618100624379.png" alt="image-20220618100624379"></p><p>ä¸‹ä¸€å±‚è‡³ConfigurableApplicationContextæ¥å£ï¼Œå‘ç°å…¶æœ‰å¾ˆå¤šsetå’Œaddæ–¹æ³•ï¼Œç”¨æ¥é…ç½®ApplicationContextï¼Œæä¾›äº†çˆ¶å®¹å™¨ã€ç¯å¢ƒã€ç±»åŠ è½½å™¨ã€BeanFactoryç­‰ï¼ŒåŒæ—¶è¿˜ç»§æ‰¿äº†Lifecycle, Closeableæ¥å£ï¼Œå¯ä»¥è¿›è¡Œç”Ÿå‘½å‘¨æœŸçš„æ§åˆ¶å’Œå…³é—­æ“ä½œ</p><p>å†å¾€ä¸‹å±‚AbstractApplicationContextï¼Œå…¶ç»§æ‰¿äºDefaultResourceLoaderï¼Œå®ç°äº†å¤šä¸ªæ¥å£çš„é€šç”¨æ–¹æ³•ï¼ˆä¸ºå…¶å­ç±»å‡è´Ÿï¼‰ï¼ŒConfigurableListableBeanFactoryå¯¹è±¡çš„ä¸€äº›æ“ä½œè¿›è¡Œäº†ä¿ç•™</p><h4 id="ClassPathXmlApplicationContext">ClassPathXmlApplicationContext</h4><p><strong>1. åˆå§‹åŒ–</strong></p><p>é€šå¸¸è¿›è¡Œçš„xmlé…ç½®ï¼Œä¼šè¿›å…¥åˆ°è¿™ä¸€æ­¥æ„é€ å‡½æ•°åˆå§‹åŒ–ï¼ˆå…¶ä¸­refreshä¸ºtrueï¼‰</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> configLocations<span class="token punctuation">,</span> <span class="token keyword">boolean</span> refresh<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">ApplicationContext</span> parent<span class="token punctuation">)</span><span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">&#123;</span><span class="token keyword">super</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">setConfigLocations</span><span class="token punctuation">(</span>configLocations<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>refresh<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p>è€Œsuper(parent)å®åˆ™ä¸ºnullï¼Œåœ¨é€’å½’æ„é€ å…¶ä¸­é—´è®¸å¤šæŠ½è±¡çˆ¶ç±»çš„ä¹Ÿä»…æœ‰super(parent)è€Œä¸åšå…¶ä»–æ“ä½œï¼Œæœ€ç»ˆåœ¨æœ€åˆæŠ½è±¡å­ç±»AbstractApplicationContextä¸­æ·»åŠ äº†<code>ResourcePatternResolver </code>å¹¶å°†å…¶æŒ‡å®šä¸º<code>PathMatchingResourcePatternResolver</code>ï¼Œä¹Ÿå°±æ˜¯æŒ‡å®šäº†èµ„æºæ£€ç´¢å™¨ï¼Œèƒ½æ£€ç´¢åˆ°classpath*: â€¦ç­‰çš„èµ„æºï¼Œè€ŒsetParentä¸ºå…¶æŒ‡å®šäº†Environmentç¯å¢ƒå±æ€§ï¼Œå¦‚æœå­˜åœ¨çˆ¶ç±»çš„ApplicationContextï¼Œå°±åˆå¹¶è¿™ä¸¤ä¸ªç±»çš„ç¯å¢ƒå±æ€§ã€‚Environmentå±æ€§ä¸­åŒ…å«äº†è®¸å¤šç¯å¢ƒè®¾ç½®ï¼ŒåŒ…æ‹¬æœ¬æœºçš„ç¯å¢ƒè®¾ç½®(PATH ã€JAVA_HOME ã€USERç­‰ç­‰)</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">AbstractApplicationContext</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">ApplicationContext</span> parent<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">setParent</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token class-name">AbstractApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>   <span class="token keyword">this</span><span class="token punctuation">.</span>resourcePatternResolver <span class="token operator">=</span> <span class="token function">getResourcePatternResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">protected</span> <span class="token class-name">ResourcePatternResolver</span> <span class="token function">getResourcePatternResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">PathMatchingResourcePatternResolver</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token annotation punctuation">@Override</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setParent</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">ApplicationContext</span> parent<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>parent <span class="token operator">=</span> parent<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>parent <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Environment</span> parentEnvironment <span class="token operator">=</span> parent<span class="token punctuation">.</span><span class="token function">getEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>parentEnvironment <span class="token keyword">instanceof</span> <span class="token class-name">ConfigurableEnvironment</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">getEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableEnvironment</span><span class="token punctuation">)</span> parentEnvironment<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p><strong>2. setConfigLocation</strong></p><p>åœ¨<code>abstractRefreshableConfigApplicationContext</code>æ‰æœ‰çš„æ–¹æ³•ï¼Œè¿›è¡Œéç©ºéªŒè¯ï¼Œå¹¶æ ¹æ®Environmentä¸­ConfigurablePropertyResolverçš„resolveRequiredPlaceholdersè§£å†³è·¯å¾„å¯»æ‰¾é—®é¢˜ï¼Œä»¥å­—ç¬¦ä¸²çš„å½¢å¼ä¿å­˜åœ¨<code>abstractRefreshableConfigApplicationContext</code>ä¸­</p><p><strong>3. refresh</strong></p><p>æ¥è‡ª<code>AbstractApplicationContext</code>æ¥å£çš„æ–¹æ³•</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">,</span> <span class="token class-name">IllegalStateException</span> <span class="token punctuation">&#123;</span><span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>startupShutdownMonitor<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// Prepare this context for refreshing.</span><span class="token function">prepareRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Tell the subclass to refresh the internal bean factory.</span><span class="token class-name">ConfigurableListableBeanFactory</span> beanFactory <span class="token operator">=</span> <span class="token function">obtainFreshBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Prepare the bean factory for use in this context.</span><span class="token function">prepareBeanFactory</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">try</span> <span class="token punctuation">&#123;</span><span class="token comment">// Allows post-processing of the bean factory in context subclasses.</span><span class="token function">postProcessBeanFactory</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Invoke factory processors registered as beans in the context.</span><span class="token function">invokeBeanFactoryPostProcessors</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Register bean processors that intercept bean creation.</span><span class="token function">registerBeanPostProcessors</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Initialize message source for this context.</span><span class="token function">initMessageSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Initialize event multicaster for this context.</span><span class="token function">initApplicationEventMulticaster</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Initialize other special beans in specific context subclasses.</span><span class="token function">onRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Check for listener beans and register them.</span><span class="token function">registerListeners</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Instantiate all remaining (non-lazy-init) singletons.</span><span class="token function">finishBeanFactoryInitialization</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Standard</span><span class="token comment">// Last step: publish corresponding event.</span><span class="token function">finishRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">BeansException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isWarnEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>logger<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">"Exception encountered during context initialization - "</span> <span class="token operator">+</span><span class="token string">"cancelling refresh attempt: "</span> <span class="token operator">+</span> ex<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// Destroy already created singletons to avoid dangling resources.</span><span class="token function">destroyBeans</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Reset 'active' flag.</span><span class="token function">cancelRefresh</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Propagate exception to caller.</span><span class="token keyword">throw</span> ex<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">finally</span> <span class="token punctuation">&#123;</span><span class="token comment">// Reset common introspection caches in Spring's core, since we</span><span class="token comment">// might not ever need metadata for singleton beans anymore...</span><span class="token function">resetCommonCaches</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p><strong>1-1. prepareRefresh</strong></p><p>å…ˆåšä¸€äº›åˆ·æ–°å‰çš„å‡†å¤‡æ´»åŠ¨ï¼ŒåŒ…æ‹¬è®¾ç½®å®¹å™¨çš„å¯åŠ¨æ—¶é—´ã€æ‰“å¼€å®¹å™¨çš„æ´»è·ƒçŠ¶æ€ã€éªŒè¯å¿…è¦éœ€æ±‚(æˆ–è€…è¯´æ˜¯ç¯å¢ƒå˜é‡ï¼Œå¦‚æœæ²¡æœ‰è¯¥ç¯å¢ƒå˜é‡åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸)<code>validateRequiredProperties</code>ï¼Œå¯é€šè¿‡ç»§æ‰¿<code>AbstractApplicationContext</code>çš„å®ç°å­ç±»ç„¶åé‡å†™<code>initPorpertySources</code>æ–¹æ³•<code>getEnvironment().setRequiredProterties(&quot;xxxx&quot;)</code>è®¾ç½®</p><p><strong>1-2. obtainFreshBeanFactory</strong></p><p>ç„¶åè·å–ConfigurableListableBeanFactoryå¹¶è¿›è¡Œä¸€ç³»åˆ—è®¾ç½®ï¼Œå…ˆæ£€æŸ¥æ˜¯å¦æœ‰BeanFactoryï¼ˆåˆå§‹åŒ–æ—¶è‚¯å®šæ˜¯æ²¡æœ‰çš„ï¼‰ï¼Œæ²¡æœ‰ä¾¿åŠ è½½ä¸€ä¸ªï¼Œè£…å¡«è¿›æ¥ï¼Œåšä¸€äº›è®¾ç½®ï¼Œä½¿å¾—ApplicationContextæœ‰äº†BeanFactoryçš„æ‰€æœ‰åŠŸèƒ½</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">refreshBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">&#123;</span>   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">hasBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token function">destroyBeans</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">closeBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>      <span class="token class-name">DefaultListableBeanFactory</span> beanFactory <span class="token operator">=</span> <span class="token function">createBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// ä¸ºäº†é€šè¿‡idååºåˆ—è·å–åˆ°beanFactoryå¯¹è±¡</span>      beanFactory<span class="token punctuation">.</span><span class="token function">setSerializationId</span><span class="token punctuation">(</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">customizeBeanFactory</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>beanFactory <span class="token operator">=</span> beanFactory<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ApplicationContextException</span><span class="token punctuation">(</span><span class="token string">"I/O error parsing bean definition source for "</span> <span class="token operator">+</span> <span class="token function">getDisplayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ex<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// customizeåŠ è½½åœ¨loadé…ç½®æ–‡ä»¶ä¹‹å‰ï¼Œé‚£ä¹ˆå¦‚ä½•å®šä¹‰ï¼Ÿ</span><span class="token comment">// ä¸ºä»€ä¹ˆæ˜¯customize: protected : å¯é€šè¿‡é‡å†™æ¥æ”¹å˜</span><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">customizeBeanFactory</span><span class="token punctuation">(</span><span class="token class-name">DefaultListableBeanFactory</span> beanFactory<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// æ˜¯å¦å…è®¸è¦†ç›–ç›¸åŒåç§°ä¸‹çš„ä¸åŒå®šä¹‰çš„å¯¹è±¡</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>allowBeanDefinitionOverriding <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>beanFactory<span class="token punctuation">.</span><span class="token function">setAllowBeanDefinitionOverriding</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>allowBeanDefinitionOverriding<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>   <span class="token comment">// æ˜¯å¦å…è®¸beanä¹‹é—´å­˜åœ¨å¾ªç¯ä¾èµ–</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>allowCircularReferences <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>beanFactory<span class="token punctuation">.</span><span class="token function">setAllowCircularReferences</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>allowCircularReferences<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p><strong>loadBeanDefinitions</strong></p><p>æ¥ä¸‹ä¾¿æ˜¯è§£æçš„æœ€é‡è¦çš„æ–¹æ³•ï¼ŒåŠ è½½Beanå®šä¹‰ï¼Œè°ƒç”¨è‡ªAbstractApplicationContextï¼Œå…ˆç©¿é‚£ä¸ªä»¶ä¸€ä¸ªè¯»å–XML Beanå®šä¹‰çš„è¯»å…¥ç±»ï¼Œç„¶åæ·»åŠ è¯¥ApplicationContextçš„ç¯å¢ƒå’Œèµ„æºåŠ è½½å™¨ã€å®ä½“è§£æå™¨ã€‚</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">DefaultListableBeanFactory</span> beanFactory<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span><span class="token comment">// Create a new XmlBeanDefinitionReader for the given BeanFactory.</span><span class="token class-name">XmlBeanDefinitionReader</span> beanDefinitionReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XmlBeanDefinitionReader</span><span class="token punctuation">(</span>beanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Configure the bean definition reader with this context's</span><span class="token comment">// resource loading environment.</span>beanDefinitionReader<span class="token punctuation">.</span><span class="token function">setEnvironment</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>beanDefinitionReader<span class="token punctuation">.</span><span class="token function">setResourceLoader</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>beanDefinitionReader<span class="token punctuation">.</span><span class="token function">setEntityResolver</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ResourceEntityResolver</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Allow a subclass to provide custom initialization of the reader,</span><span class="token comment">// then proceed with actually loading the bean definitions.</span>    <span class="token comment">// è®¾ç½®æ˜¯å¦å¯¹é…ç½®æ–‡ä»¶è¿›è¡ŒéªŒè¯</span><span class="token function">initBeanDefinitionReader</span><span class="token punctuation">(</span>beanDefinitionReader<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span>beanDefinitionReader<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>é‚£ä¹ˆè¿™ä¸ªå®ä½“è§£æå™¨æ˜¯ä»€ä¹ˆï¼Ÿå‘ç°å…¶å®é™…ä¸Šæ˜¯EntityResolveræ¥å£çš„å®ç°ï¼Œé‚£ä¹ˆEntityResolveræ¥å£æ˜¯å¹²ä»€ä¹ˆç”¨çš„ï¼Ÿå…¶æºç æ³¨é‡Šä¸ºï¼š</p><blockquote><p>If a SAX application needs to implement customized handling for external entities, it must implement this interface and register an instance with the SAX driver using the setEntityResolver method.<br>The XML reader will then allow the application to intercept any external entities (including the external DTD subset and external parameter entities, if any) before including them.</p></blockquote><p>SAX(Simple API for XML)è¿™é‡Œä¹Ÿå°±è·Ÿxmlæ–‡ä»¶çš„ç»“æ„è§£ææœ‰è”ç³»äº†ï¼ˆè‡ªå·±å¯¹xmlæ–‡ä»¶çš„ç»“æ„è¿˜ä¸ç†Ÿæ‚‰ï¼‰ï¼Œå¯ä»¥è§£é‡Šä¸ºå¯¹xmlçš„è§„èŒƒæ–‡ä»¶xsd(xml schema definition)æˆ–dtd(document type definition)ç­‰åŒ…å«æ ‡ç­¾çš„å®šä¹‰ä¿¡æ¯ï¼Œå¯è¢«EntityResolverè¿›è¡Œè¯»å–å’Œè§£æï¼Œåç»­äº†è§£åxmlæ–‡ä»¶ç»“æ„åå¯¹è¿™é‡Œç»§ç»­æ·±å…¥â€¦</p><p>ç„¶åæ ¹æ®è·å¾— ConfigResourcesï¼ˆåˆ›å»ºClassPathXmlApplicationContextæ²¡æœ‰è®¾ç½®ApplicationContextæ—¶ä¾¿ä¸ä¼šè®¾ç½®ï¼‰æ¥è¿›è¡Œè¯»å–ï¼Œç„¶åå°±ç”±XmlBeanDefinitionReaderæ¥è¿›è¡Œè¯»å–</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">XmlBeanDefinitionReader</span> reader<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span><span class="token class-name">Resource</span><span class="token punctuation">[</span><span class="token punctuation">]</span> configResources <span class="token operator">=</span> <span class="token function">getConfigResources</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>configResources <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>reader<span class="token punctuation">.</span><span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span>configResources<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> configLocations <span class="token operator">=</span> <span class="token function">getConfigLocations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>configLocations <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>reader<span class="token punctuation">.</span><span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span>configLocations<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token annotation punctuation">@Override</span><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> locations<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeanDefinitionStoreException</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>locations<span class="token punctuation">,</span> <span class="token string">"Location array must not be null"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> location <span class="token operator">:</span> locations<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        count <span class="token operator">+=</span> <span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span>location<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> count<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token annotation punctuation">@Override</span><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">String</span> location<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeanDefinitionStoreException</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span>location<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>å…ˆè¿›è¡ŒresourceLoaderçš„åˆ¤æ–­ï¼ˆä¹‹å‰é»˜è®¤ä¸ºmainæ–¹æ³•ä¸­newçš„ApplicationContextçš„ç±»ï¼‰</p><p><code>ResourcePatternResolver</code>æ˜¯å¹²å˜›çš„ï¼Ÿæ³¨é‡Šä¸ºï¼š<code>Strategy interface for resolving a location pattern (for example, an Ant-style path pattern) into Resource objects.</code>ä¹Ÿå°±æ˜¯èƒ½å¤Ÿè¿›è¡Œèµ„æºæ–‡ä»¶çš„è·¯å¾„è§£æ</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">String</span> location<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Resource</span><span class="token punctuation">></span></span> actualResources<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeanDefinitionStoreException</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">ResourceLoader</span> resourceLoader <span class="token operator">=</span> <span class="token function">getResourceLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>resourceLoader <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BeanDefinitionStoreException</span><span class="token punctuation">(</span>            <span class="token string">"Cannot load bean definitions from location ["</span> <span class="token operator">+</span> location <span class="token operator">+</span> <span class="token string">"]: no ResourceLoader available"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>resourceLoader <span class="token keyword">instanceof</span> <span class="token class-name">ResourcePatternResolver</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// Resource pattern matching available.</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Resource</span><span class="token punctuation">[</span><span class="token punctuation">]</span> resources <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">ResourcePatternResolver</span><span class="token punctuation">)</span> resourceLoader<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResources</span><span class="token punctuation">(</span>location<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span>resources<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>actualResources <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>actualResources<span class="token punctuation">,</span> resources<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isTraceEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                logger<span class="token punctuation">.</span><span class="token function">trace</span><span class="token punctuation">(</span><span class="token string">"Loaded "</span> <span class="token operator">+</span> count <span class="token operator">+</span> <span class="token string">" bean definitions from location pattern ["</span> <span class="token operator">+</span> location <span class="token operator">+</span> <span class="token string">"]"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">return</span> count<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BeanDefinitionStoreException</span><span class="token punctuation">(</span>                <span class="token string">"Could not resolve bean definition resource pattern ["</span> <span class="token operator">+</span> location <span class="token operator">+</span> <span class="token string">"]"</span><span class="token punctuation">,</span> ex<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// Can only load single resources by absolute URL.</span>        <span class="token class-name">Resource</span> resource <span class="token operator">=</span> resourceLoader<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span>location<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>actualResources <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            actualResources<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isTraceEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            logger<span class="token punctuation">.</span><span class="token function">trace</span><span class="token punctuation">(</span><span class="token string">"Loaded "</span> <span class="token operator">+</span> count <span class="token operator">+</span> <span class="token string">" bean definitions from location ["</span> <span class="token operator">+</span> location <span class="token operator">+</span> <span class="token string">"]"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> count<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token comment">// AbstractApplicationContext</span><span class="token annotation punctuation">@Override</span><span class="token keyword">public</span> <span class="token class-name">Resource</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getResources</span><span class="token punctuation">(</span><span class="token class-name">String</span> locationPattern<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>resourcePatternResolver<span class="token punctuation">.</span><span class="token function">getResources</span><span class="token punctuation">(</span>locationPattern<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>AbstractApplicationContextå®ç°äº†<code>ResourcePatternResolver</code>æ¥å£æ‰€ä»¥æœ‰æ¥å£å®šä¹‰çš„Resource[] getResourcesæ–¹æ³•ä¸”ä¼šå‘ç°å…¶beanDefinitionReader.setResourceLoader(this)å®é™…è®¾ç½®çš„æ˜¯ClassPathXMLApplicationContextï¼Œæ‰€ä»¥èƒ½å¤Ÿå°±è¿›å…¥åˆ°AbstractApplicationContextçš„getReourcesæ–¹æ³•ï¼Œå®é™…åˆè°ƒç”¨åˆ°äº†è‡ªèº«å±æ€§<code>resourcePatternResolver</code>çš„getResourcesæ–¹æ³•ï¼Œé‚£è¿™ä¸ªresourcePattherResolverä»ä»€ä¹ˆæ—¶å€™åˆå§‹åŒ–çš„å‘¢ï¼Ÿä¼šå‘ç°å…¶åœ¨AbstractApplicationContextåˆå§‹åŒ–æ—¶å°±å·²ç»newäº†ä¸€ä¸ªï¼Œå…¶ç±»å‹æ˜¯å®ç°äº†<code>ResourcePatternResolver</code>æ¥å£çš„ç±»<code>PathMatchingResourcePatternResolver</code>ï¼Œå¯çŸ¥è¿™æ‰æ˜¯çœŸæ­£è§£ææ–‡ä»¶è·¯å¾„çš„è§£æå™¨ï¼Œæ³¨é‡Šï¼š</p><blockquote><p>A ResourcePatternResolver implementation that is able to resolve a specified resource location path into one or more matching Resources. The source path may be a simple path which has a one-to-one mapping to a target Resource, or alternatively may contain the special â€œclasspath*:â€ prefix and/or internal Ant-style regular expressions (matched using Springâ€™s AntPathMatcher utility). Both of the latter are effectively wildcards.</p></blockquote><p>ç„¶åå¼€å§‹åœ¨å…¶çˆ¶ç±»AbstractBeanDefinitionReaaderä¸­<code>loadBeanDefinitions</code>è¿™é‡Œçš„è¿™ä¸ªæ–¹æ³•è¿›è¡Œäº†é‡æ„ï¼Œæ¥å—çš„ä¸å†æ˜¯Stringâ€¦å¯¹è±¡è€Œæ˜¯Resourceâ€¦å¯¹è±¡</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">Resource</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> resources<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeanDefinitionStoreException</span> <span class="token punctuation">&#123;</span><span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>resources<span class="token punctuation">,</span> <span class="token string">"Resource array must not be null"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Resource</span> resource <span class="token operator">:</span> resources<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>count <span class="token operator">+=</span> <span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> count<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p><code>loadBeanDefinitions</code>ä½œä¸ºæ¥å£<code>BeanDefinitionReader</code>å®šä¹‰çš„æ–¹æ³•ï¼Œç”±<code>AbstractBeanDefinitionReader</code>å®ç°ï¼Œç”±äºåŠ è½½çš„æ˜¯XMLæ–‡ä»¶ï¼Œæ‰€ä»¥æœ€ç»ˆä¼šåˆ°å…¶å­ç±»<code>XmlBeanDefinitionReader</code>ä¸­é‡å†™çš„æ–¹æ³•ï¼Œå…ˆåˆ›å»ºä¸€ä¸ªEncodedResource(<code>Holder that combines a Resource descriptor with a specific encoding or Charset to be used for reading from the resource.</code>)</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token comment">// XmlBeanDefinitionReader</span><span class="token annotation punctuation">@Override</span><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">Resource</span> resource<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeanDefinitionStoreException</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">EncodedResource</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">EncodedResource</span> encodedResource<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeanDefinitionStoreException</span> <span class="token punctuation">&#123;</span><span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>encodedResource<span class="token punctuation">,</span> <span class="token string">"EncodedResource must not be null"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isTraceEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>logger<span class="token punctuation">.</span><span class="token function">trace</span><span class="token punctuation">(</span><span class="token string">"Loading XML bean definitions from "</span> <span class="token operator">+</span> encodedResource<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">EncodedResource</span><span class="token punctuation">></span></span> currentResources <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>resourcesCurrentlyBeingLoaded<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>currentResources<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>encodedResource<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BeanDefinitionStoreException</span><span class="token punctuation">(</span><span class="token string">"Detected cyclic loading of "</span> <span class="token operator">+</span> encodedResource <span class="token operator">+</span> <span class="token string">" - check your import definitions!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> encodedResource<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">InputSource</span> inputSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InputSource</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>encodedResource<span class="token punctuation">.</span><span class="token function">getEncoding</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>inputSource<span class="token punctuation">.</span><span class="token function">setEncoding</span><span class="token punctuation">(</span>encodedResource<span class="token punctuation">.</span><span class="token function">getEncoding</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token function">doLoadBeanDefinitions</span><span class="token punctuation">(</span>inputSource<span class="token punctuation">,</span> encodedResource<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BeanDefinitionStoreException</span><span class="token punctuation">(</span><span class="token string">"IOException parsing XML document from "</span> <span class="token operator">+</span> encodedResource<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ex<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>currentResources<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>encodedResource<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>currentResources<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>resourcesCurrentlyBeingLoaded<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><div class="note note-info">            <p>classpath ä»£è¡¨ä»€ä¹ˆæ„ä¹‰</p>          </div><p>åœ¨<code>PathMatchingResourcePatternResolver</code>ï¼Œä¸»è¦æ ¹æ®ä¼ å…¥çš„locationPatternï¼ˆæ˜¯å¦æœ‰å‰åç¼€ï¼‰ï¼Œé€šè¿‡<code>ResourceLoader</code>æ¥æ‰¾åˆ°å¯¹åº”çš„èµ„æºæ–‡ä»¶å¹¶å…·ä½“ä¸ºResourceå¯¹è±¡ï¼ˆResourceåªæ˜¯è§„èŒƒçš„æ¥å£ï¼Œå…·ä½“åˆ°å…¶å®ç°ç±»ï¼‰</p><ol><li><p>å…è®¸å¯¹BeanFactoryäºŒæ¬¡åŠ å·¥ï¼ˆpostProcessBeanFactoryæ˜¯å¯é‡å†™çš„protectedç©ºæ–¹æ³•ï¼‰</p></li><li><p>å¤„ç†æ‰€æœ‰çš„BeanFactoryPpostProcessor</p></li><li><p>æ³¨å†ŒBeanPostProcessor</p></li><li><p>åˆå§‹åŒ–Messageæº</p></li><li><p>åˆå§‹åŒ–åº”ç”¨æ¶ˆæ¯å¹¿æ’­</p></li><li><p>ç•™ç»™å­ç±»æ¥åˆå§‹åŒ–å…¶ä»–çš„bean</p></li><li><p>åœ¨æ‰€æœ‰æ³¨å†Œçš„beanä¸­æŸ¥æ‰¾ApplicationListener beanå¹¶æ³¨å†Œåˆ°å¹¿æ’­ä¸­</p></li><li><p>åˆå§‹åŒ–å‰©ä¸‹çš„å•å®ä¾‹</p></li><li><p>å®Œæˆåˆ·æ–°ï¼šæ¸…é™¤èµ„æºç¼“å­˜ï¼Œé€šçŸ¥ç”Ÿå‘½å‘¨æœŸå¤„ç†å™¨å¹¶startï¼Œå‘å‡ºäº‹ä»¶é€šçŸ¥</p></li></ol><h3 id="Bean">Bean</h3><h4 id="LifeCycle">LifeCycle</h4><h4 id="FactoryBean">FactoryBean</h4><h4 id="BeanFactory">BeanFactory</h4>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Spring</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JDKåŠ¨æ€ä»£ç†</title>
    <link href="/2022/06/15/JDK%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/"/>
    <url>/2022/06/15/JDK%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/</url>
    
    <content type="html"><![CDATA[<h1>JDKåŠ¨æ€ä»£ç†</h1><blockquote><p>Spring AOP å’Œæ³¨è§£ä¸­æ¶‰åŠåˆ°ä¸€äº›JDKåŠ¨æ€ä»£ç†çš„å†…å®¹ï¼Œæƒ³è¦ç†è§£ä¸€ä¸‹åœ¨Javaå±‚çš„åŠ¨æ€ä»£ç†å…·ä½“è¿‡ç¨‹ã€‚</p><p>æ¶µç›–å†…å®¹ï¼š ä»£ç†çš„ä¾‹å­ã€é™æ€/åŠ¨æ€ä»£ç†æ¦‚å¿µã€JDKä¸­åŠ¨æ€ä»£ç†åŸç†ã€Javaå±‚åŠ¨æ€ä»£ç†è¿‡ç¨‹åˆ†æ</p></blockquote><h2 id="å¼•å…¥">å¼•å…¥</h2><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Bird</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// core code</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"fly"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"sing"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p>è€ƒè™‘æœ‰å¦‚ä¸Šçš„å®ä¾‹ç±»ï¼Œåœ¨ä¸šåŠ¡ä¸­æˆ‘ä»¬éœ€è¦å¯¹ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ–¹æ³•åšå‡ºæŸäº›å˜åŒ–ï¼Œä¸ºå…¶æ·»åŠ ä¸€äº›é¢å¤–çš„åŠŸèƒ½ï¼Œé‚£å¯èƒ½æˆ–æ€ä¹ˆåšï¼Ÿ</p><p><strong>1. ç›´æ¥ä¿®æ”¹æºæ–¹æ³•</strong></p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"start fly"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// core code</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"fly"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"end fly"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"start sing"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"sing"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"end sing"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>è¿™ç§æ–¹æ³•æ˜¯æœ€ç›´æ¥çš„ï¼Œä½†æœ‰å¾ˆå¤šé—®é¢˜ï¼š</p><ol><li>ä¸ç¬¦åˆå¼€é—­åŸåˆ™ï¼Œâ€œ<strong>å¯¹å¤–å¼€å‘å¯¹å†…å°é—­</strong>â€ï¼›</li><li>å¦‚æœè¦ä¿®æ”¹çš„æ–¹æ³•æœ‰è®¸å¤šï¼Œé‚£åˆ™ä¼šæœ‰å¾ˆå¤§çš„ä¿®æ”¹æˆæœ¬ï¼Œé‡å¤ä»£ç è¿‡å¤š</li></ol><p>ç”±æ­¤è€ƒè™‘é€šè¿‡<strong>ä»£ç†</strong>(Proxy)æ¥å®ç°ä¸€ç§ä¾¿æ·çš„ç¬¬ä¸‰æ–¹çš„æ“ä½œ</p><h2 id="é™æ€ä»£ç†">é™æ€ä»£ç†</h2><p>ä»£ç†ï¼šå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥<strong>æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®</strong>ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸€ä¸ªå¯¹è±¡ä¸é€‚åˆæˆ–è€…ä¸èƒ½ç›´æ¥å¼•ç”¨å¦ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä»£ç†å¯¹è±¡å¯ä»¥åœ¨å®¢æˆ·ç«¯å’Œç›®æ ‡å¯¹è±¡ä¹‹é—´èµ·åˆ°ä¸­ä»‹çš„ä½œç”¨ã€‚</p><p><strong>å¯¹ä¸Šè¿°ä¾‹å­çš„æ”¹è¿›</strong></p><p>å°†æ ¸å¿ƒæ–¹æ³•æŠ½è±¡æˆæ¥å£ï¼ŒåŸæœ‰ä¸šåŠ¡ç±»ï¼ˆæˆ–æ ¸å¿ƒä»£ç ç±»ï¼‰å®ç°è¯¥æ¥å£ï¼ˆç†è§£ä¸ºä¸»è¦æ‰§è¡Œç±»ï¼‰ã€‚æ–°å»ºä»£ç†ç±»åŒæ ·å®ç°è¯¥æ¥å£ï¼ˆä¿æŒæ–¹æ³•ä¸å˜æ€§ï¼‰å¹¶ä¸”<strong>æŒæœ‰åŸæœ‰ä¸šåŠ¡ç±»çš„å®ä¾‹</strong>ï¼ˆè¿™é‡Œä¸ºäº†æ›´å¥½ä½æŠ½è±¡ï¼Œå¯ä»¥å°†ä¸šåŠ¡ç±»çš„ç±»å‹å˜ä¸ºæ¥å£ç±»å‹ï¼Œè€Œéå…¶å®ä½“ç±»ï¼‰</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">BirdAbility</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">void</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">sing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BirdImpl</span> <span class="token keyword">implements</span> <span class="token class-name">BirdAbility</span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"fly"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"sing"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BirdProxy</span> <span class="token keyword">implements</span> <span class="token class-name">BirdAbility</span><span class="token punctuation">&#123;</span>    <span class="token comment">// ä½¿ç”¨æ¥å£ä½œä¸ºç±»å</span>    <span class="token class-name">BirdAbility</span> target<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTarget</span><span class="token punctuation">(</span><span class="token class-name">BirdAbility</span> target<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>target <span class="token operator">=</span> target<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"fly start"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        target<span class="token punctuation">.</span><span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"fly end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"sing start"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        target<span class="token punctuation">.</span><span class="token function">sing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"sing end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p>é€šè¿‡é™æ€ä»£ç†ï¼Œèƒ½è®©ä»£ç æœ‰ä¸€å®šçš„å°é—­æ€§ï¼Œå¼€é—­åŸåˆ™æ»¡è¶³ï¼Œä½†è¿˜æ˜¯ä¸èƒ½è§£å†³ä»£ç å†—ä½™å’Œè¿‡å¤šå·¥ä½œé‡çš„é—®é¢˜ã€‚æ­¤å¤–ç”±äºè§„å®šçš„æ¥å£æ˜¯BirdAbilityï¼Œåˆ™å…¶åªèƒ½æ¥å—BirdAbilityçš„å®ç°ç±»ï¼Œè€Œæ— æ³•ä¸ºå…¶ä»–ç±»åšä»£ç†ï¼Œå¦‚æœè¦ä¸ºæ‰€æœ‰ç±»æ·»åŠ è¯¥åŠŸèƒ½ï¼Œåˆ™å¯èƒ½è¦å†™å¾ˆå¤šçš„ä»£ç†ç±»å’Œæ¥å£ã€‚</p><p>å¦‚ä½•å°‘å†™ä»£ç†ç±»è€Œå®Œæˆä»£ç†ä»»åŠ¡ï¼Ÿ</p><h2 id="åŠ¨æ€ä»£ç†-v2">åŠ¨æ€ä»£ç†</h2><p>èƒ½å¦é€šè¿‡æ¥å£è€Œç›´æ¥åŠ¨æ€åˆ›é€ ä¸€ä¸ªä»£ç†ç±»å‘¢ï¼Ÿ</p><h3 id="Proxy">Proxy</h3><h4 id="getProxyClass">getProxyClass()</h4><p>Proxyç±»çš„getProxyClass(ClassLoader loader,Class&lt;?&gt;â€¦ interfaces)èƒ½å¤Ÿæ¥å—Classå¯¹è±¡åŠä¸€ä¸ªå®šä¹‰è¯¥classçš„classloaderï¼Œæ¥åˆ›å»ºä¸€ä¸ª<strong>åŠ å¼ºç‰ˆçš„ä»£ç†ç±»</strong>ï¼Œæ‹¥æœ‰å…¶æ‰€æœ‰æ–¹æ³•å’Œæ„é€ å™¨$Proxy0</p><p>éœ€è¦æ³¨æ„çš„è¿™ç§æ–¹æ³•åˆ›å»ºçš„ä»£ç†ç±»åªèƒ½é€šè¿‡ä¼ å…¥InvocationHandlerå®ä¾‹æ¥æ„é€ ï¼Œæ²¡æœ‰æ— å‚æ–¹æ³•ã€‚</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> birdProxyClass <span class="token operator">=</span> <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">getProxyClass</span><span class="token punctuation">(</span><span class="token class-name">BirdAbility</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">BirdAbility</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>birdProxyClass<span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// $Proxy0</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Constructor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> constructor <span class="token operator">:</span> birdProxyClass<span class="token punctuation">.</span><span class="token function">getConstructors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>constructor<span class="token punctuation">.</span><span class="token function">toGenericString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//public com.sun.proxy.$Proxy0(java.lang.reflect.InvocationHandler)</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Method</span> declaredMethod <span class="token operator">:</span> birdProxyClass<span class="token punctuation">.</span><span class="token function">getDeclaredMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>declaredMethod<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Field</span> declaredField <span class="token operator">:</span> birdProxyClass<span class="token punctuation">.</span><span class="token function">getDeclaredFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>declaredField<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/v2-2b77f72c33aa99d2b3ddf112ef269368_r.jpg" alt="preview"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/v2-3979759089c5226bf8997b141109632d_r.jpg" alt="é™æ€ä»£ç†"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/v2-ccdc245db98539305abc7ffef9da46b5_720w.jpg" alt="åŠ¨æ€ä»£ç†"></p><p>è€Œ$Proxy0ç±»æ˜¯åŠ¨æ€ç”Ÿæˆçš„ï¼Œå¦‚ä½•ä¿ç•™å¹¶æŸ¥çœ‹è¿™ä¸ªç±»çš„classï¼Ÿ<br>åœ¨IDEA Run And Debug Configurationä¸­æ·»åŠ ä¸€ä¸‹VM Optionå³å¯<code>-Djdk.proxy.ProxyGenerator.saveGeneratedFiles=true</code></p><p>å¯ä»¥çœ‹è¿™é‡Œï¼ŒProxy0å®ç°äº†è§„å®šçš„æ¥å£å¹¶ä¸”ç»§æ‰¿Proxyç±»ï¼ŒåŸºæœ¬æ‰€æœ‰çš„æ–¹æ³•éƒ½æ’å…¥äº†h.invokeï¼Œè¿™é‡Œçš„hå±æ€§å³æ˜¯InvocationHandlerï¼Œé€šè¿‡ä¼ å…¥è‡ªå®šä¹‰çš„InvocationHandlerå®ç°ç±»æ¥æ‰§è¡Œinvokeæ–¹æ³•</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Proxy</span> <span class="token keyword">implements</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span>Serializable</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span> <span class="token class-name">InvocationHandler</span> h<span class="token punctuation">;</span>            <span class="token keyword">protected</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token class-name">InvocationHandler</span> h<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">requireNonNull</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>h <span class="token operator">=</span> h<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> $<span class="token class-name">Proxy0</span> <span class="token keyword">extends</span> <span class="token class-name">Proxy</span> <span class="token keyword">implements</span> <span class="token class-name">BirdAbility</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Method</span> m0<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Method</span> m1<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Method</span> m2<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Method</span> m3<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Method</span> m4<span class="token punctuation">;</span>    <span class="token keyword">public</span> $<span class="token class-name">Proxy0</span><span class="token punctuation">(</span><span class="token class-name">InvocationHandler</span> param1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">super</span><span class="token punctuation">(</span>var1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">)</span><span class="token keyword">super</span><span class="token punctuation">.</span>h<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> m0<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">RuntimeException</span> <span class="token operator">|</span> <span class="token class-name">Error</span> var2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> var2<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> var3<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UndeclaredThrowableException</span><span class="token punctuation">(</span>var3<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> var1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">Boolean</span><span class="token punctuation">)</span><span class="token keyword">super</span><span class="token punctuation">.</span>h<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> m1<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>var1<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">RuntimeException</span> <span class="token operator">|</span> <span class="token class-name">Error</span> var2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> var2<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> var3<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UndeclaredThrowableException</span><span class="token punctuation">(</span>var3<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token keyword">super</span><span class="token punctuation">.</span>h<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> m2<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">RuntimeException</span> <span class="token operator">|</span> <span class="token class-name">Error</span> var2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> var2<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> var3<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UndeclaredThrowableException</span><span class="token punctuation">(</span>var3<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token comment">// æ— å‚æƒ…å†µ</span>    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">sing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">super</span><span class="token punctuation">.</span>h<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> m3<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">RuntimeException</span> <span class="token operator">|</span> <span class="token class-name">Error</span> var2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> var2<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> var3<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UndeclaredThrowableException</span><span class="token punctuation">(</span>var3<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token comment">// æœ‰å‚æƒ…å†µ</span>   <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">fly</span><span class="token punctuation">(</span><span class="token keyword">int</span> var1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">)</span><span class="token keyword">super</span><span class="token punctuation">.</span>h<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> m3<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>var1<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">RuntimeException</span> <span class="token operator">|</span> <span class="token class-name">Error</span> var2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> var2<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> var3<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UndeclaredThrowableException</span><span class="token punctuation">(</span>var3<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">static</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            m0 <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"java.lang.Object"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"hashCode"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            m1 <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"java.lang.Object"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"equals"</span><span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"java.lang.Object"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            m2 <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"java.lang.Object"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"toString"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            m3 <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"BirdAbility"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"sing"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            m4 <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"BirdAbility"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"fly"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">NoSuchMethodException</span> var2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NoSuchMethodError</span><span class="token punctuation">(</span>var2<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> var3<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NoClassDefFoundError</span><span class="token punctuation">(</span>var3<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><div class="note note-primary">            <p><strong>getProxyClass Deprecated</strong></p><blockquote><p>Proxy classes generated in a named module are encapsulatedand not accessible to code outside its module.{@link Constructor#newInstance(Objectâ€¦) Constructor.newInstance}will throw {@code  IllegalAccessException} when it is called on an inaccessible proxy class.</p></blockquote><p>ä¹Ÿå°±æ˜¯åœ¨è°ƒç”¨getProxyClassæ—¶å¯èƒ½ä¼šæŠ›å‡ºIllegalAccessExceptionå¼‚å¸¸ï¼Œè€ŒnewProxyInstanceåˆ™ä¸ä¼šï¼Œä»¥åå¯æ”¹ç”¨è¯¥æ–¹æ³•</p>          </div><h3 id="InvocationHandler">InvocationHandler</h3><p>InvocationHandleræœ¬èº«æ˜¯ä¸€ä¸ªæ¥å£</p><h4 id="Invoke">Invoke</h4><p>ä»ä¸ŠåŒ¿åå®šä¹‰çš„ InvocationHandlerå®éªŒå¯çŸ¥ï¼Œæ¯æ¬¡é€šè¿‡Proxyåˆ›å»ºçš„ä»£ç†ç±»è°ƒç”¨æ–¹æ³•æ—¶ï¼Œéƒ½ä¼šè¿›å…¥åˆ°invokeæ–¹æ³•ä¸­ï¼Œinvokeèƒ½è¾¨è®¤å½“å‰ä»£ç†å¯¹è±¡ã€æ–¹æ³•åã€å‚æ•°åˆ—è¡¨ï¼Œå¹¶ä¸”è¿”å›å€¼ç›´æ¥è¿”å›åˆ°æ–¹æ³•ä¸­</p><p>ç›®å‰ä¸ºæ­¢ï¼Œç†ä¸€ä¸‹æ€è·¯ï¼š<br>Proxyåˆ›å»ºåŠ¨æ€ä»£ç†ç±»$Proxyâ¡ï¸ Proxyå¯¹æ¯ä¸ªæ–¹æ³•ä¼šæ‰§è¡ŒInvocationHandlerçš„Invokeæ–¹æ³•â¡ï¸ å…·ä½“æ€ä¹ˆå®ç°ç”±Invokeæ–¹æ³•è§„å®š</p><p>é‚£ä¹ˆå¦‚ä½•å°†å…·ä½“ä¸šåŠ¡ç±»ä¸ä»£ç†ç±»è¿›è¡Œä¸€ä¸ªå…³è”å‘¢ï¼Ÿä¸»è¦æ˜¯ä¼ å…¥å½“å‰ä»£ç†ç±»çš„Proxy</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Object</span> <span class="token function">getProxy</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">Object</span> target<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token class-name">Object</span> proxy <span class="token operator">=</span> <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> target<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInterfaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">InvocationHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token annotation punctuation">@Override</span>           <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> proxy<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">&#123;</span>               <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"invocation start -- method "</span> <span class="token operator">+</span>method<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token class-name">Object</span> result <span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"invocation end -- method "</span> <span class="token operator">+</span>method<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token keyword">return</span> result<span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">return</span> proxy<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><h2 id="æºç ">æºç </h2><blockquote><p>JDKæºç ç‰ˆæœ¬ï¼šcorretto-15.0.2</p></blockquote><p>å°±ä»¥ä¸Šè¿°ä»£ç ä¸ºä¾‹ï¼Œåˆ†æä¸€ä¸‹newProxyInstanceå¹²äº†ä»€ä¹ˆäº‹ï¼Ÿé•¿ç¯‡æºç è­¦å‘Š âš ï¸<br>çŒœæµ‹ï¼šåŠ¨æ€åŠ è½½äº†ProxyåŠ¨æ€ç”Ÿæˆçš„ä»£ç†ç±»ï¼Œæœ‰äº†ä»£ç†ç±»åœ¨JVMä¸­ï¼Œé‚£ä¹‹ånewä¸€ä¸ªå®ä¾‹éƒ½ä¸æ˜¯äº‹ï¼Œæ‰€ä»¥é—®é¢˜éƒ½è½åœ¨äº†<strong>å¦‚ä½•åŠ¨æ€åœ°å°†ä¸€ä¸ªæ¥å£åŠ è½½æˆå…¶ä»£ç†çš„åŠ¨æ€ç±»</strong></p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@CallerSensitive</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Object</span> <span class="token function">newProxyInstance</span><span class="token punctuation">(</span><span class="token class-name">ClassLoader</span> loader<span class="token punctuation">,</span>                                          <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> interfaces<span class="token punctuation">,</span>                                          <span class="token class-name">InvocationHandler</span> h<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">requireNonNull</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">final</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> caller <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getSecurityManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> <span class="token class-name">Reflection</span><span class="token punctuation">.</span><span class="token function">getCallerClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// Look up or generate the designated proxy class and its constructor.</span>        <span class="token class-name">Constructor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> cons <span class="token operator">=</span> <span class="token function">getProxyConstructor</span><span class="token punctuation">(</span>caller<span class="token punctuation">,</span> loader<span class="token punctuation">,</span> interfaces<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">newProxyInstance</span><span class="token punctuation">(</span>caller<span class="token punctuation">,</span> cons<span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p>è¿™é‡Œç»è¿‡è°ƒè¯•ï¼Œå‘ç°ç±»çš„åŠ è½½æ“ä½œåœ¨getProxyConstructorè¿™ä¸€æ­¥ä¸­ï¼ˆå½“ç„¶æ³¨é‡Šä¹Ÿå†™å‡ºæ¥äº†â€¦ï¼‰</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Constructor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> <span class="token function">getProxyConstructor</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> caller<span class="token punctuation">,</span><span class="token class-name">ClassLoader</span> loader<span class="token punctuation">,</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> interfaces<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// optimization for single interface</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>interfaces<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> intf <span class="token operator">=</span> interfaces<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>caller <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token function">checkProxyAccess</span><span class="token punctuation">(</span>caller<span class="token punctuation">,</span> loader<span class="token punctuation">,</span> intf<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">return</span> proxyCache<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>intf<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">computeIfAbsent</span><span class="token punctuation">(</span>                loader<span class="token punctuation">,</span>                <span class="token punctuation">(</span>ld<span class="token punctuation">,</span> clv<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">new</span> <span class="token class-name">ProxyBuilder</span><span class="token punctuation">(</span>ld<span class="token punctuation">,</span> clv<span class="token punctuation">.</span><span class="token function">key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// interfaces cloned</span>            <span class="token keyword">final</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> intfsArray <span class="token operator">=</span> interfaces<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>caller <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token function">checkProxyAccess</span><span class="token punctuation">(</span>caller<span class="token punctuation">,</span> loader<span class="token punctuation">,</span> intfsArray<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span><span class="token punctuation">></span></span> intfs <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>intfsArray<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> proxyCache<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>intfs<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">computeIfAbsent</span><span class="token punctuation">(</span>                loader<span class="token punctuation">,</span>                <span class="token punctuation">(</span>ld<span class="token punctuation">,</span> clv<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">new</span> <span class="token class-name">ProxyBuilder</span><span class="token punctuation">(</span>ld<span class="token punctuation">,</span> clv<span class="token punctuation">.</span><span class="token function">key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p>åˆ¤æ–­æ¥å£æ•°ç›®ï¼Œå¦‚æœæ¥å£æ•°ç›®ä¸º1ï¼Œé‚£å°±ç›´æ¥å–å…¶Classï¼Œæ£€æŸ¥ä¸€ä¸‹ä»£ç†æƒé™ï¼Œä¸ºä»€ä¹ˆè¦æ£€æŸ¥å‘¢ï¼Ÿæ³¨é‡Šä¸­æœ‰å†™</p><blockquote><p>To define a proxy class, it performs the access checks as in Class.forName (VM will invoke ClassLoader.checkPackageAccess):</p><ol><li>â€œgetClassLoaderâ€ permission check if loader == null</li><li>checkPackageAccess on the interfaces it implements</li></ol><p>If an interface is non-public, the proxy class must be defined by the defining loader of the interface.  If the callerâ€™s class loader is not the same as the defining loader of the interface, the VM will throw IllegalAccessError when the generated proxy class is being defined.</p></blockquote><p>ä¹Ÿå°±æ˜¯å¦‚æœä¸€ä¸ªæ¥å£ä¸æ˜¯å…¬æœ‰çš„ï¼Œé‚£è¿™ä¸ªä»£ç†ç±»å¿…é¡»å¿…é¡»è¢«å®šä¹‰æ¥å£çš„åŠ è½½å™¨å®šä¹‰ï¼Œå¦‚æœcallerçš„classä¸å®šä¹‰æ¥å£çš„åŠ è½½å™¨ä¸ä¸€è‡´ï¼Œåˆ™å°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼ˆæš‚ä¸æ¸…æ¥šè¿™é‡Œcallerçš„ä½œç”¨ï¼‰</p><p>æ£€æŸ¥ä¸€ä¸‹å¦‚æœä¸ä¸º1çš„è¯å°±è¦ä½¿ç”¨interfaces.clone()ï¼Œå°šä¸æ¸…æ¥šä¸ºä»€ä¹ˆè¦ç”¨clone</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Constructor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> proxyClass <span class="token operator">=</span> <span class="token function">defineProxyClass</span><span class="token punctuation">(</span><span class="token keyword">module</span><span class="token punctuation">,</span> interfaces<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">final</span> <span class="token class-name">Constructor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> cons<span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>        cons <span class="token operator">=</span> proxyClass<span class="token punctuation">.</span><span class="token function">getConstructor</span><span class="token punctuation">(</span>constructorParams<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">NoSuchMethodException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">InternalError</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token class-name">AccessController</span><span class="token punctuation">.</span><span class="token function">doPrivileged</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PrivilegedAction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">public</span> <span class="token class-name">Void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            cons<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> cons<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span></code></pre></div><p>å…³é”®çš„buildæ–¹æ³•åŠ è½½Classçš„ä»£ç ä¸€çœ¼å¯çŸ¥ defineProxyClass</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> <span class="token function">defineProxyClass</span><span class="token punctuation">(</span><span class="token class-name">Module</span> m<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span><span class="token punctuation">></span></span> interfaces<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">//.....</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>proxyPkg <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// all proxy interfaces are public</span>        proxyPkg <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token function">isNamed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> PROXY_PACKAGE_PREFIX <span class="token operator">+</span> <span class="token string">"."</span> <span class="token operator">+</span> m<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                               <span class="token operator">:</span> PROXY_PACKAGE_PREFIX<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>proxyPkg<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> m<span class="token punctuation">.</span><span class="token function">isNamed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span>                <span class="token string">"Unnamed package cannot be added to "</span> <span class="token operator">+</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">long</span> num <span class="token operator">=</span> nextUniqueNumber<span class="token punctuation">.</span><span class="token function">getAndIncrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">String</span> proxyName <span class="token operator">=</span> proxyPkg<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                            <span class="token operator">?</span> proxyClassNamePrefix <span class="token operator">+</span> num                            <span class="token operator">:</span> proxyPkg <span class="token operator">+</span> <span class="token string">"."</span> <span class="token operator">+</span> proxyClassNamePrefix <span class="token operator">+</span> num<span class="token punctuation">;</span>    <span class="token class-name">ClassLoader</span> loader <span class="token operator">=</span> <span class="token function">getLoader</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">trace</span><span class="token punctuation">(</span>proxyName<span class="token punctuation">,</span> m<span class="token punctuation">,</span> loader<span class="token punctuation">,</span> interfaces<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// Generate the specified proxy class.</span>    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> proxyClassFile <span class="token operator">=</span> <span class="token class-name">ProxyGenerator</span><span class="token punctuation">.</span><span class="token function">generateProxyClass</span><span class="token punctuation">(</span>loader<span class="token punctuation">,</span> proxyName<span class="token punctuation">,</span> interfaces<span class="token punctuation">,</span> accessFlags<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> pc <span class="token operator">=</span> JLA<span class="token punctuation">.</span><span class="token function">defineClass</span><span class="token punctuation">(</span>loader<span class="token punctuation">,</span> proxyName<span class="token punctuation">,</span> proxyClassFile<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">"__dynamic_proxy__"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        reverseProxyCache<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span>pc<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">putIfAbsent</span><span class="token punctuation">(</span>loader<span class="token punctuation">,</span> <span class="token class-name">Boolean</span><span class="token punctuation">.</span>TRUE<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> pc<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassFormatError</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p>proxyPkgå’Œnumæ‹¼æ¥èµ·æˆ‘ä»¬æœ€ç»ˆçœ‹åˆ°çš„åŒ…åproxyName <code>com.sun.proxy.$Proxy0</code> ï¼Œè¿™é‡Œç»Ÿè®¡proxyçš„æ•°é‡çš„numç”¨äº†AtomicåŸå­ç±»ï¼Œä¸ºä»€ä¹ˆç”¨è¿™ä¸ªç±»å‘¢?åˆ©ç”¨è‡ªæ—‹é”CASæ¥ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚<br>æœ€ä¸»è¦çš„åŠ è½½æ­¥éª¤æ¥äº†ï¼ŒProxyGenerator.generateProxyClassï¼Œå…¶å±…ç„¶æ˜¯ç›´æ¥åŠ è½½ï¼ä¹Ÿå°±æ˜¯é€šè¿‡è¿è¡Œæ—¶è½¬æ¢äºŒè¿›åˆ¶çš„byte[]æ•°ç»„è¡¨ç¤ºçš„classå­—èŠ‚ç </p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">generateProxyClass</span><span class="token punctuation">(</span><span class="token class-name">ClassLoader</span> loader<span class="token punctuation">,</span>                                 <span class="token keyword">final</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span>                                 <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span><span class="token punctuation">></span></span> interfaces<span class="token punctuation">,</span>                                 <span class="token keyword">int</span> accessFlags<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">ProxyGenerator</span> gen <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ProxyGenerator</span><span class="token punctuation">(</span>loader<span class="token punctuation">,</span> name<span class="token punctuation">,</span> interfaces<span class="token punctuation">,</span> accessFlags<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">final</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> classFile <span class="token operator">=</span> gen<span class="token punctuation">.</span><span class="token function">generateClassFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>saveGeneratedFiles<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span>AccessController</span><span class="token punctuation">.</span><span class="token function">doPrivileged</span><span class="token punctuation">(</span>                <span class="token keyword">new</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span>PrivilegedAction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">public</span> <span class="token class-name">Void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                            <span class="token keyword">int</span> i <span class="token operator">=</span> name<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token char">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token class-name">Path</span> path<span class="token punctuation">;</span>                            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                                <span class="token class-name">Path</span> dir <span class="token operator">=</span> <span class="token class-name">Path</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token function">dotToSlash</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                <span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">createDirectories</span><span class="token punctuation">(</span>dir<span class="token punctuation">)</span><span class="token punctuation">;</span>                                path <span class="token operator">=</span> dir<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">".class"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                                path <span class="token operator">=</span> <span class="token class-name">Path</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">".class"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token punctuation">&#125;</span>                            <span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> classFile<span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>                        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">InternalError</span><span class="token punctuation">(</span>                                    <span class="token string">"I/O exception saving generated file: "</span> <span class="token operator">+</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token punctuation">&#125;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> classFile<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>é€šè¿‡ProxyGeneratorå»åˆ›å»ºclasså­—èŠ‚ç æ–‡ä»¶</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">generateClassFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// ...</span>    <span class="token function">addProxyMethod</span><span class="token punctuation">(</span>hashCodeMethod<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">addProxyMethod</span><span class="token punctuation">(</span>equalsMethod<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">addProxyMethod</span><span class="token punctuation">(</span>toStringMethod<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> intf <span class="token operator">:</span> interfaces<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Method</span> m <span class="token operator">:</span> intf<span class="token punctuation">.</span><span class="token function">getMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Modifier</span><span class="token punctuation">.</span><span class="token function">isStatic</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span><span class="token function">getModifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token function">addProxyMethod</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> intf<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>     <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ProxyMethod</span><span class="token punctuation">></span></span> sigmethods <span class="token operator">:</span> proxyMethods<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">checkReturnTypes</span><span class="token punctuation">(</span>sigmethods<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">generateConstructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// ...</span>        <span class="token keyword">return</span> <span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>generateClassFile æŒ‡æ˜äº†ä¸ºä»€ä¹ˆProxyç”Ÿæˆçš„ä»£ç†ç±»ä¼šæœ‰hashCode ã€ equals å’Œ toStringæ–¹æ³•ï¼Œå› ä¸ºåœ¨ç”Ÿæˆçš„æ—¶å€™å°±å·²ç»é™æ€åœ°åŠ ä¸Šäº†ï¼Œç„¶åè¿™é‡Œéå†æ¯ä¸€ä¸ªæ¥å£ï¼Œå¯¹æ¥å£ä¸­ä¸æ˜¯é™æ€æ–¹æ³•çš„æ–¹æ³•è¿›è¡Œæ·»åŠ ï¼Œæœ€ç»ˆtoByteArray()æ•´åˆå­—èŠ‚ç æ•°æ®ï¼Œè¿”å›åˆ°ä¸Šä¸€æ­¥æ–¹æ³•ä¸­ï¼Œä¼šæ ¹æ®æ˜¯å¦æœ‰å­˜å…¥åˆ°æœ¬åœ°çš„è®¾ç½®æ¥é€‰æ‹©æ˜¯å¦å†™å…¥åˆ°diskã€‚<br>å›åˆ°Proxyä¸­</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> pc <span class="token operator">=</span> JLA<span class="token punctuation">.</span><span class="token function">defineClass</span><span class="token punctuation">(</span>loader<span class="token punctuation">,</span> proxyName<span class="token punctuation">,</span> proxyClassFile<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">"__dynamic_proxy__"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p>é€”ç»Systemç±»ä¸­è½¬ï¼Œæœ€ç»ˆè¿›å…¥åˆ°ä¼šè¿›å…¥åˆ°ClassLoaderç±»ï¼Œè¿›åˆ°nativeæ–¹æ³•ï¼ˆä¹Ÿéƒ¨åˆ†è¯æ˜æ˜¯ä»JVMå±‚æ‰€æä¾›çš„ç‰¹æ€§ï¼‰</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> <span class="token function">defineClass1</span><span class="token punctuation">(</span><span class="token class-name">ClassLoader</span> loader<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span> off<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">,</span>                                        <span class="token class-name">ProtectionDomain</span> pd<span class="token punctuation">,</span> <span class="token class-name">String</span> source<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p>æ€»ç»“ä¸€ä¸‹ï¼ŒLoad Class In JVMçš„æµç¨‹å›¾</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220616000455155.png" alt="Load Class In JVM"></p><h2 id="æ€»ç»“">æ€»ç»“</h2><p>äº†è§£äº†JDKä¸ºæ¥å£æä¾›çš„æ–¹ä¾¿çš„ä»£ç†æ“ä½œï¼Œäº†è§£äº†å¦‚ä½•åŠ¨æ€åŠ è½½ä»£ç†ç±»ï¼Œå¯¹éƒ¨åˆ†æºç è¿˜å­˜æœ‰ç–‘æƒ‘ï¼Œå¾…ç»éªŒæŠ€æœ¯å†ç§¯ç´¯ç§¯ç´¯å†å›å¤´çœ‹çœ‹ã€‚è¿™éƒ¨åˆ†æºç æ¶‰åŠçš„æ³¨é‡Šæ¯”è¾ƒè¯¦ç»†ï¼Œå†æ¬¡é˜…è¯»æ—¶è¿˜è¦å€ŸåŠ©åˆ°æ³¨é‡Š</p><div class="note note-info">            <p>å‚è€ƒæ–‡ç« ğŸ”—</p><p><a href="https://zhuanlan.zhihu.com/p/62534874">çŸ¥ä¹-æµ…è°ˆJDKåŠ¨æ€ä»£ç†ï¼ˆä¸Šï¼‰</a><br><a href="https://zhuanlan.zhihu.com/p/62660956">çŸ¥ä¹-æµ…è°ˆJDKåŠ¨æ€ä»£ç†ï¼ˆä¸­ï¼‰</a></p>          </div>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>JVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç¼–è¯‘JDKæºç å¹¶è°ƒè¯•Nativeæ–¹æ³•</title>
    <link href="/2022/06/15/%E7%BC%96%E8%AF%91JDK%E6%BA%90%E7%A0%81%E5%B9%B6%E8%B0%83%E8%AF%95Native%E6%96%B9%E6%B3%95/"/>
    <url>/2022/06/15/%E7%BC%96%E8%AF%91JDK%E6%BA%90%E7%A0%81%E5%B9%B6%E8%B0%83%E8%AF%95Native%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h1>ç¼–è¯‘JDKæºç å¹¶è°ƒè¯•Nativeæ–¹æ³•</h1><blockquote><p>åœ¨å­¦ä¹ åå°„çš„è¿‡ç¨‹ä¸­æ ¸å¿ƒæ–¹æ³•Nativeåå°„çš„invoke0æ–¹æ³•æ˜¯Nativeçš„ï¼Œè¿˜æƒ³å¤šç ”ç©¶ä¸€ä¸‹Cå±‚çš„ä»£ç ï¼Œäºæ˜¯å¼€å§‹æ£é¼“å¦‚ä½•è°ƒè¯•JDKæºç ä¸­Nativeæ–¹æ³•ã€‚</p><p>æ¦‚è¦ï¼šç¼–è¯‘è‡ªå·±çš„JDKæºç ã€é€šè¿‡Clionä¸IDEAè°ƒè¯•Nativeæ–¹æ³•</p></blockquote><h2 id="ç¼–è¯‘JDKæºç ">ç¼–è¯‘JDKæºç </h2><div class="note note-info">            <p>ä¸ªäººç¯å¢ƒ<br>Linux: 5.10.121-1-MANJARO<br>gcc/g++: 12.1.0<br>Java:<br>java version â€œ1.7.0_80â€<br>Javaâ„¢ SE Runtime Environment (build 1.7.0_80-b15)<br>Java HotSpotâ„¢ Server VM (build 24.80-b11, mixed mode)</p>          </div><h3 id="å‡†å¤‡-v2">å‡†å¤‡</h3><h4 id="ä¸‹è½½JDKæºç ">ä¸‹è½½JDKæºç </h4><p>æ³¨æ„æ˜¯è¦ä¸‹è½½JDK SourceCode è€Œéæ˜¯DevelopmentKit ä¹‹ç±»çš„<br>ç”±äºJDK8ç‰ˆæœ¬çš„ç¼–è¯‘åœ¨æˆ‘çš„Manjaroä¸Šå±¡æ¬¡å‡ºé”™ï¼ˆè¿™é‡Œä¹‹åä¼šæåˆ°ï¼‰ï¼Œæˆ‘å°†å¾…ç¼–è¯‘çš„JDKç‰ˆæœ¬æš‚æ—¶æå‡åˆ°15ï¼Œå…ˆç¼–è¯‘é«˜ç‰ˆæœ¬çš„ã€‚è¿™é‡Œä¸‹è½½ <a href="http://hg.openjdk.java.net/jdk/jdk15/">OpenJDK 15</a></p><div class="note note-info">            <p>å½“ç„¶è¿™é‡Œè¿˜æœ‰å¦å¤–ä¸€ç§æ–¹å¼ï¼Œé€šè¿‡Mercurialçš„hg cloneä¸‹è½½ï¼Œä¸è¿‡æ›´æœ‰æ•ˆçš„æ˜¯é’ˆå¯¹è€ç‰ˆæœ¬çš„JDK8ä¹‹ç±»çš„ï¼Œå…ˆhg clone æŒ‡å®šçš„JDKç‰ˆæœ¬ï¼Œå†sh get_source.shå»è·å–æŒ‡å®šçš„å†…å®¹</p>          </div><h4 id="ç¯å¢ƒé…ç½®">ç¯å¢ƒé…ç½®</h4><p>ç”±äºAURä¸­å·²ç»æœ‰æ¯”è¾ƒå…¨é¢çš„ç¼–è¯‘å·¥å…·base-develï¼Œæ‰€ä»¥è¿™é‡Œåªéœ€è¦å†å®‰è£…ä¸€ä¸ªccacheå³å¯</p><h3 id="ç¼–è¯‘-v3">ç¼–è¯‘</h3><div class="code-wrapper"><pre class="language-sh" data-language="sh"><code class="language-sh">sh configure --disable-warnings-as-errors --enable-debug --with-jvm-variants&#x3D;server --with-boot-jdk&#x3D;&#x2F;home&#x2F;pplong&#x2F;.jdks&#x2F;corretto-15.0.2</code></pre></div><p>æˆåŠŸåå†make imagesæˆ–make all</p><div class="code-wrapper"><pre class="language-sh" data-language="sh"><code class="language-sh">make images</code></pre></div><p>å³å¯å¾—åˆ°æºç </p><h3 id="é”™è¯¯">é”™è¯¯</h3><p>ç¼–è¯‘JDK8æ—¶ä¸è®ºæ˜¯ä»€ä¹ˆç‰ˆæœ¬ä¸€ç›´ä¼šå‡ºç°è¿™æ ·çš„æŠ¥é”™ï¼Œæˆ‘çŒœåº”è¯¥æ˜¯gccå’Œg++çš„ç‰ˆæœ¬è¿‡é«˜å¯¼è‡´warningè¢«å½“æˆerrorå¯¹å¾…ï¼Œä½†æ˜¯æ¢æˆgcc 7æ—¶ä¹Ÿä¸èƒ½æˆåŠŸç¼–è¯‘ï¼Œå‡ºç°åŒæ ·çš„é”™è¯¯ï¼Œä¸çŸ¥é“æ˜¯å“ªé‡Œä¾èµ–ç¼ºå¤±ï¼Ÿ</p><div class="code-wrapper"><pre class="language-sh" data-language="sh"><code class="language-sh">## Starting langtoolsCompiling 2 files for BUILD_TOOLS&#x2F;opt&#x2F;SourceCode&#x2F;jdk8u60&#x2F;langtools&#x2F;src&#x2F;share&#x2F;classes&#x2F;com&#x2F;sun&#x2F;tools&#x2F;javac&#x2F;parser&#x2F;JavacParser.java:310: é”™è¯¯: æ‰¾ä¸åˆ°ç¬¦å·        return tk.accepts(S.token(lookahead + 1).kind);                                                ^  ç¬¦å·:   å˜é‡ kind  ä½ç½®: ç±» Token&#x2F;opt&#x2F;SourceCode&#x2F;jdk8u60&#x2F;langtools&#x2F;src&#x2F;share&#x2F;classes&#x2F;com&#x2F;sun&#x2F;tools&#x2F;javac&#x2F;parser&#x2F;JavacParser.java:318: é”™è¯¯: æ‰¾ä¸åˆ°ç¬¦å·        return tk1.accepts(S.token(lookahead + 1).kind) &amp;&amp;                                                 ^  ç¬¦å·:   å˜é‡ kind  ä½ç½®: ç±» Token&#x2F;opt&#x2F;SourceCode&#x2F;jdk8u60&#x2F;langtools&#x2F;src&#x2F;share&#x2F;classes&#x2F;com&#x2F;sun&#x2F;tools&#x2F;javac&#x2F;parser&#x2F;JavacParser.java:319: é”™è¯¯: æ‰¾ä¸åˆ°ç¬¦å·</code></pre></div><p>è¿™ä¸ªé—®é¢˜ä»¥åè¿˜æœ‰å¾…è§£å†³</p><h3 id="å®‰è£…-v2">å®‰è£…</h3><p>åœ¨IDEA ProjectStuctureä¸­è¿›è¡Œå¦‚ä¸‹è®¾ç½®ï¼Œæ·»åŠ ç¼–è¯‘å¥½çš„JDKï¼Œæ³¨æ„è·¯å¾„</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220615121115012.png" alt="image-20220615121115012"></p><p>ä¸è¿‡è¿™ä¸ªæ—¶å€™æ— æ³•æŸ¥çœ‹å’Œä¿®æ”¹æºç ï¼Œéœ€è¦åœ¨è®¾ç½®ä¸­åˆ‡æ¢æºç ç›®å½•ï¼Œåˆ é™¤æ‰åŸæœ‰çš„SourcePathå¹¶ä¸”æ·»åŠ è¯¥æºç ä¸»ç›®å½•ä¸‹srcæ–‡ä»¶å¤¹</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220615121346567.png" alt="image-20220615121346567"></p><p><strong>å¿«é€Ÿç¼–è¯‘</strong></p><p>åœ¨IDEAä¸­ä¿®æ”¹æºç æ–‡ä»¶åï¼Œé‡æ–°åœ¨æºç ä¸»ç›®å½•ä¸­è¿›è¡Œ<code>make images</code>(å› ä¸ºä¸æ˜¯å…¨é‡ç¼–è¯‘äº†ï¼Œåªç¼–è¯‘æ›´æ”¹çš„éƒ¨åˆ†ï¼Œæ‰€ä»¥å¾ˆå¿«)ï¼Œå†æ¬¡è¿è¡Œé¡¹ç›®ä¾¿èƒ½å®ç°æºç çš„æ›´æ”¹</p><h2 id="è°ƒè¯•">è°ƒè¯•</h2><h3 id="å‰ç½®">å‰ç½®</h3><p>é¡¹ç›®çš„JDKå¿…é¡»ä¸Clionä¸­æ‰“å¼€çš„æºç ç›®å½•ç›¸åŒ</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">NoSuchMethodException</span><span class="token punctuation">,</span> <span class="token class-name">InstantiationException</span><span class="token punctuation">,</span> <span class="token class-name">IllegalAccessException</span><span class="token punctuation">,</span> <span class="token class-name">InvocationTargetException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Obj</span><span class="token punctuation">></span></span> objClass <span class="token operator">=</span> <span class="token class-name">Obj</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>        <span class="token class-name">Obj</span> obj <span class="token operator">=</span> objClass<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Method</span> go <span class="token operator">=</span> objClass<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"go"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        go<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// break point</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"finish"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220615121839779.png" alt="æºç æ–­ç‚¹"></p><p>åœ¨nativeæ–¹æ³•invoke0ä¸­æ–­ç‚¹ï¼Œå¹¶ä¸”ç›¸åº”çš„åœ¨Clionä¸­å¯¹åº”çš„æ–¹æ³•æ–­ç‚¹</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220615122322598.png" alt="image-20220615122322598"></p><h3 id="å¼€å§‹-v2">å¼€å§‹</h3><p>éœ€è¦è°ƒè¯•Javaé¡¹ç›®åˆ°å¯¹åº”çš„æ–­ç‚¹ï¼Œç„¶åé¡¹ç›®ç›®å½•å†…å‘½ä»¤è¡Œ <code>jps</code>æŸ¥çœ‹å¯¹åº”çš„è¿›ç¨‹ï¼Œæ‰¾åˆ°ç±»åä¸å½“å‰æ–­ç‚¹ç±»ç›¸åŒçš„è¿›ç¨‹ï¼ˆè‹¥æ˜¯æºç ç±»ï¼Œå¯èƒ½å‡ºç°unknownï¼‰</p><p><strong>åœ¨Clioné¡¹ç›®ä¸‹<code>Ctrl + alt + 5</code> attach to processï¼Œå°†Clionä¾é™„åˆ°æ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹ä¸­</strong>ï¼Œè¿™ä¸€æ­¥å¯èƒ½ä¼šæŠ¥é”™ï¼Œptrace permissioin not permittedä¹‹ç±»çš„ï¼Œéœ€è¦<code>echo 0 | sudo tee /proc/sys/kernel/yama/ptrace_scope</code>è®¾ç½®ä¸€ä¸‹ptrace_scope</p><p>ç„¶åå†åœ¨Javaé¡¹ç›®ä¸­æ·±å…¥æ–­ç‚¹ï¼Œè¿™æ ·ä¾¿æˆåŠŸè¿›å…¥åˆ°Cå±‚çš„é¡¹ç›®ä¸­å¹¶ä¸”å¯ä»¥è¿›è¡Œæ–­ç‚¹è°ƒè¯•ã€‚</p><blockquote><p>ğŸ“– å‚è€ƒæ–‡ç« </p><p>ğŸ”— <a href="https://www.bilibili.com/video/BV1zT4y177Zf?spm_id_from=333.337.search-card.all.click&amp;vd_source=54e58923618f5f75efa9edc84b0400b0">Biliblii - CodeSheep - JDKéƒ½æ²¡æ‰‹åŠ¨ç¼–è¯‘è¿‡ï¼Œæ•¢è¯´è‡ªå·±æ˜¯Javaç¨‹åºå‘˜å—ï¼Ÿå®æˆ˜ç¼–è¯‘Javaæºç ï¼ˆJDKæºç ,JVMï¼‰è§†é¢‘æ•™ç¨‹</a><br>ğŸ”— <a href="https://www.youtube.com/watch?v=8Cjeq4l5COU">Youtube - recipeNoD002 - Debugging JNI code with IntelliJ/CLion</a></p></blockquote>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaåå°„åŸç†æ¢ç©¶</title>
    <link href="/2022/06/14/Java%E5%8F%8D%E5%B0%84%E5%8E%9F%E7%90%86%E6%8E%A2%E7%A9%B6/"/>
    <url>/2022/06/14/Java%E5%8F%8D%E5%B0%84%E5%8E%9F%E7%90%86%E6%8E%A2%E7%A9%B6/</url>
    
    <content type="html"><![CDATA[<h1>Javaåå°„åŸç†æ¢ç©¶</h1><blockquote><p>ä¸ºä»€ä¹ˆè¦å†™è¿™ç¯‡æ–‡ç« ï¼ŸåŸºäºSpringçš„å­¦ä¹ æˆ‘éœ€è¦å¯¹Javaçš„åå°„å’Œæ³¨è§£æœºåˆ¶æœ‰ä¸€ä¸ªå…¨é¢çš„è®¤çŸ¥ï¼Œå¹¶ä¸”æ³¨è§£ä¸­æœ‰è®¸å¤šå…³ç³»ä¹Ÿç‰µæ‰¯åˆ°åå°„çš„åŸç†ï¼Œæ‰€ä»¥å…ˆå­¦å¥½åå°„æ‰èƒ½å­¦ä¹ æ³¨è§£ç­‰å†…å®¹</p></blockquote><p>Reflection is a feature in the Java programming language. It allows an executing Java program to examine or â€œintrospectâ€ upon itself, and manipulate internal properties of the program. For example, itâ€™s possible for a Java class to obtain the names of all its members and display them.<br>è¿™å¥é‡Šä¹‰æ¥è‡ªOracleå¯¹Javaåå°„çš„è§£é‡Šï¼Œå³å…è®¸Javaç¨‹åºåœ¨è¿è¡Œæ—¶è·å–è‡ªèº«çš„ä¿¡æ¯å¹¶ä¸”å¯ä»¥æ“ä½œç±»æˆ–è€…å¯¹è±¡çš„å†…éƒ¨å±æ€§ã€‚</p><p>åå°„çš„æ ¸å¿ƒæ˜¯ JVM åœ¨è¿è¡Œæ—¶æ‰åŠ¨æ€åŠ è½½ç±»æˆ–è°ƒç”¨æ–¹æ³•/è®¿é—®å±æ€§ï¼Œå®ƒä¸éœ€è¦äº‹å…ˆï¼ˆå†™ä»£ç çš„æ—¶å€™æˆ–ç¼–è¯‘æœŸï¼‰çŸ¥é“è¿è¡Œå¯¹è±¡æ˜¯è°ã€‚ä¸€å¼€å§‹å¹¶ä¸çŸ¥é“è¦åˆå§‹åŒ–çš„ç±»å¯¹è±¡ï¼Œæ— æ³•ä½¿ç”¨newå…³é”®å­—æ¥åˆ›å»ºå¯¹è±¡ã€‚</p><p>Java åå°„ä¸»è¦æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š</p><ul><li>åœ¨è¿è¡Œæ—¶åˆ¤æ–­ä»»æ„ä¸€ä¸ªå¯¹è±¡æ‰€å±çš„ç±»ï¼›</li><li>åœ¨è¿è¡Œæ—¶æ„é€ ä»»æ„ä¸€ä¸ªç±»çš„å¯¹è±¡ï¼›</li><li>åœ¨è¿è¡Œæ—¶åˆ¤æ–­ä»»æ„ä¸€ä¸ªç±»æ‰€å…·æœ‰çš„æˆå‘˜å˜é‡å’Œæ–¹æ³•ï¼ˆé€šè¿‡åå°„ç”šè‡³å¯ä»¥è°ƒç”¨privateæ–¹æ³•ï¼‰ï¼›</li><li>åœ¨è¿è¡Œæ—¶è°ƒç”¨ä»»æ„ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•</li></ul><p><strong>åå°„é‡è¦çš„ç”¨é€”å°±æ˜¯  å¼€å‘å„ç§æ¡†æ¶</strong></p><h2 id="åŸºç¡€-v2">åŸºç¡€</h2><h3 id="Class">Class</h3><p><strong>Classæ˜¯åå°„çš„åŸºç¡€</strong></p><p><strong>6ç§æƒ…å†µä¸‹å¿…é¡»ç«‹å³å¯¹ç±»è¿›è¡Œåˆå§‹åŒ–ï¼ˆä¸»åŠ¨å¼•ç”¨ï¼‰</strong></p><h2 id="ä½¿ç”¨-v2">ä½¿ç”¨</h2><p><strong>è·å–åå°„ä¸­Classå¯¹è±¡</strong></p><ol><li><p>é€šè¿‡åŒ…åç›´æ¥è·å–</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Class</span> clazz <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"java.lang.String"</span><span class="token punctuation">)</span></code></pre></div></li><li><p>ä½¿ç”¨classå­—é¢é‡ï¼ˆç”¨äºåœ¨ç¼–è¯‘å‰å°±çŸ¥é“çš„ç±»ï¼‰</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Class</span> clazz <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span></code></pre></div></li><li><p>ä½¿ç”¨ç±»<strong>å¯¹è±¡</strong>çš„getClass()æ–¹æ³•</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Class</span> clazz <span class="token operator">=</span> obj<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div></li></ol><p><strong>å¯¹Classå¯¹è±¡çš„å±æ€§è¿›è¡Œæ“ä½œ</strong></p><p>getDeclaredâ€¦ ï¼š è·å–åŒ…æ‹¬ç§æœ‰å±æ€§(æ–¹æ³•)åœ¨å†…çš„æ‰€æœ‰å±æ€§(æ–¹æ³•)</p><blockquote><p>å‚è€ƒæ–‡ç« ï¼š</p><p><a href="https://www.sczyh30.com/posts/Java/java-reflection-1/">æ·±å…¥è§£æJavaåå°„(1)</a></p></blockquote>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaæ³¨è§£æ¢ç©¶</title>
    <link href="/2022/06/14/Java%E6%B3%A8%E8%A7%A3%E6%8E%A2%E7%A9%B6/"/>
    <url>/2022/06/14/Java%E6%B3%A8%E8%A7%A3%E6%8E%A2%E7%A9%B6/</url>
    
    <content type="html"><![CDATA[<h1>Javaæ³¨è§£æ¢ç©¶</h1><div class="note note-info">            <p>ä¸ºä»€ä¹ˆå­¦ä¹ ï¼Ÿä»¥å‰åªæ˜¯åˆæ­¥äº†è§£æ³¨è§£çš„æ¦‚å¿µï¼Œä½†å®é™…åº”ç”¨åœºæ™¯å¯¥å¯¥æ— å‡ ã€‚å› ä¸ºæœ€è¿‘æ‰å¼€å§‹æ·±å…¥çš„å­¦ä¹ Springï¼Œå¸Œæœ›ä»åº•å±‚å¼„æ‡‚å…¶åŸç†ï¼Œå½“ç„¶ä½œä¸ºSpringä¸€å®šä¼šç”¨åˆ°çš„å…³é”®çš„æ³¨è§£ï¼Œä¾‹å¦‚@Autowiredä¹‹ç±»çš„ï¼Œè¦å¼„æ¸…å…¶åŸç†åˆ™è‚¯å®šé¦–å…ˆè¦å¼„æ‡‚Javaçš„æ³¨è§£æœºåˆ¶ï¼Œå› æ­¤æ‰æœ‰äº†æœ¬æ–‡</p><p>å…³äºæœ¬æ–‡ä½ å¯èƒ½éœ€è¦æå‰äº†è§£ï¼šğŸ“– <a href="http://www.pplong.top/2022/06/14/Java%E5%8F%8D%E5%B0%84%E5%8E%9F%E7%90%86%E6%8E%A2%E7%A9%B6/">Javaçš„åå°„</a>ã€ğŸ“– <a href="http://www.pplong.top/2022/06/15/JDK%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/">JDKåŠ¨æ€ä»£ç†æœºåˆ¶</a><br>å…³äºæœ¬æ–‡åŒ…å«çš„å†…å®¹ï¼šæ³¨è§£çš„æ¦‚å¿µã€æ³¨è§£çš„ç»“æ„ã€è‡ªå®šä¹‰æ³¨è§£ã€æ³¨è§£å­—èŠ‚ç å±‚é¢å’ŒJavaå±‚é¢æ¢ç©¶</p>          </div><h2 id="ä»‹ç»-v2">ä»‹ç»</h2><p>Java æ³¨è§£ï¼ˆAnnotationï¼‰åˆç§° Java æ ‡æ³¨ï¼Œæ˜¯ JDK5.0 å¼•å…¥çš„ä¸€ç§æ³¨é‡Šæœºåˆ¶ã€‚</p><p>Java è¯­è¨€ä¸­çš„<strong>ç±»ã€æ–¹æ³•ã€å˜é‡ã€å‚æ•°å’ŒåŒ…</strong>ç­‰éƒ½å¯ä»¥è¢«æ ‡æ³¨ã€‚å’Œ Javadoc ä¸åŒï¼ŒJava æ ‡æ³¨å¯ä»¥é€šè¿‡åå°„è·å–æ ‡æ³¨å†…å®¹ã€‚åœ¨ç¼–è¯‘å™¨ç”Ÿæˆç±»æ–‡ä»¶æ—¶ï¼Œæ ‡æ³¨å¯ä»¥è¢«åµŒå…¥åˆ°å­—èŠ‚ç ä¸­ã€‚Java è™šæ‹Ÿæœºå¯ä»¥ä¿ç•™æ ‡æ³¨å†…å®¹ï¼Œåœ¨è¿è¡Œæ—¶å¯ä»¥è·å–åˆ°æ ‡æ³¨å†…å®¹ ã€‚ å½“ç„¶å®ƒä¹Ÿæ”¯æŒè‡ªå®šä¹‰ Java æ ‡æ³¨ã€‚</p><p><strong>æ³¨è§£ä¸»è¦è¢«åå°„æ‰€è¯»å–å¹¶è¿›è¡Œé…ç½®</strong><br>â” ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºåå°„æ˜¯JVMæ‰€æä¾›çš„ç‰¹æ€§ï¼Œèƒ½è¯»å–å†…å­˜ä¸­å­—èŠ‚ç çš„ä¿¡æ¯</p><p><strong>å†…ç½®çš„æ³¨è§£</strong></p><p>Java å®šä¹‰äº†ä¸€å¥—æ³¨è§£ï¼Œå…±æœ‰ 7 ä¸ªï¼Œ3 ä¸ªåœ¨ java.lang ä¸­ï¼Œå‰©ä¸‹ 4 ä¸ªåœ¨ java.lang.annotation ä¸­ã€‚</p><p><strong>ä½œç”¨åœ¨ä»£ç çš„æ³¨è§£æ˜¯</strong></p><ul><li>@Override - æ£€æŸ¥è¯¥æ–¹æ³•æ˜¯å¦æ˜¯é‡å†™æ–¹æ³•ã€‚å¦‚æœå‘ç°å…¶çˆ¶ç±»ï¼Œæˆ–è€…æ˜¯å¼•ç”¨çš„æ¥å£ä¸­å¹¶æ²¡æœ‰è¯¥æ–¹æ³•æ—¶ï¼Œä¼šæŠ¥ç¼–è¯‘é”™è¯¯ã€‚</li><li>@Deprecated - æ ‡è®°è¿‡æ—¶æ–¹æ³•ã€‚å¦‚æœä½¿ç”¨è¯¥æ–¹æ³•ï¼Œä¼šæŠ¥ç¼–è¯‘è­¦å‘Šã€‚</li><li>@SuppressWarnings - æŒ‡ç¤ºç¼–è¯‘å™¨å»å¿½ç•¥æ³¨è§£ä¸­å£°æ˜çš„è­¦å‘Šã€‚</li></ul><p>ä½œç”¨åœ¨å…¶ä»–æ³¨è§£çš„æ³¨è§£(æˆ–è€…è¯´ å…ƒæ³¨è§£)æ˜¯:</p><ul><li>@Retention - æ ‡è¯†è¿™ä¸ªæ³¨è§£æ€ä¹ˆä¿å­˜ï¼Œæ˜¯åªåœ¨ä»£ç ä¸­ï¼Œè¿˜æ˜¯ç¼–å…¥classæ–‡ä»¶ä¸­ï¼Œæˆ–è€…æ˜¯åœ¨è¿è¡Œæ—¶å¯ä»¥é€šè¿‡åå°„è®¿é—®ã€‚</li><li>@Documented - æ ‡è®°è¿™äº›æ³¨è§£æ˜¯å¦åŒ…å«åœ¨ç”¨æˆ·æ–‡æ¡£ä¸­ã€‚</li><li>@Target - æ ‡è®°è¿™ä¸ªæ³¨è§£åº”è¯¥æ˜¯å“ªç§ Java æˆå‘˜ã€‚</li><li>@Inherited - æ ‡è®°è¿™ä¸ªæ³¨è§£æ˜¯ç»§æ‰¿äºå“ªä¸ªæ³¨è§£ç±»(é»˜è®¤ æ³¨è§£å¹¶æ²¡æœ‰ç»§æ‰¿äºä»»ä½•å­ç±»)</li></ul><p>ä» Java 7 å¼€å§‹ï¼Œé¢å¤–æ·»åŠ äº† 3 ä¸ªæ³¨è§£:</p><ul><li>@SafeVarargs - Java 7 å¼€å§‹æ”¯æŒï¼Œå¿½ç•¥ä»»ä½•ä½¿ç”¨å‚æ•°ä¸ºæ³›å‹å˜é‡çš„æ–¹æ³•æˆ–æ„é€ å‡½æ•°è°ƒç”¨äº§ç”Ÿçš„è­¦å‘Šã€‚</li><li>@FunctionalInterface - Java 8 å¼€å§‹æ”¯æŒï¼Œæ ‡è¯†ä¸€ä¸ªåŒ¿åå‡½æ•°æˆ–å‡½æ•°å¼æ¥å£ã€‚</li><li>@Repeatable - Java 8 å¼€å§‹æ”¯æŒï¼Œæ ‡è¯†æŸæ³¨è§£å¯ä»¥åœ¨åŒä¸€ä¸ªå£°æ˜ä¸Šä½¿ç”¨å¤šæ¬¡</li></ul><h2 id="åŸºæœ¬ç»“æ„">åŸºæœ¬ç»“æ„</h2><h3 id="è§„å®š">è§„å®š</h3><p><strong>æ³¨è§£å¯æ¶µç›–çš„æ•°æ®ç±»å‹</strong></p><ul><li>å…«ç§åŸºæœ¬æ•°æ®ç±»å‹</li><li>String</li><li>æšä¸¾</li><li>Class</li><li>æ³¨è§£ç±»å‹</li><li>ä»¥ä¸Šç±»å‹çš„ä¸€ç»´æ•°ç»„ï¼Œæ•°ç»„çš„èµ‹å€¼ç”¨{}å£°æ˜ï¼ˆåªæœ‰ä¸€ä¸ªå…ƒç´ æ—¶{}å¯çœç•¥ï¼‰</li></ul><p>å¦‚æœä½¿ç”¨å…¶ä»–ç±»å‹çš„å¯¹è±¡ï¼Œåˆ™ä¼šæŠ¥é”™<br><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220616105156419.png" alt="image-20220616105156419"></p><p>è‹¥æ³¨è§£ä¸­åªæœ‰<strong>ä¸€ä¸ª</strong>æ–¹æ³•<strong>value()</strong>ï¼Œåˆ™æ³¨è§£æ—¶å¯ä»¥ç›´æ¥ä¸åŠ æ–¹æ³•åç§°è¯´æ˜ï¼Œ@Hello(â€œmynameâ€)å³å¯</p><h3 id="ç»“æ„">ç»“æ„</h3><p><strong>æ³¨è§£çš„æœ¬è´¨æ˜¯ä¸€ä¸ªç»§æ‰¿äº†Annotationæ¥å£çš„æ¥å£</strong></p><div class="note note-primary">            <p>åŸºç¡€å›é¡¾ï¼š Interfaceä¸­çš„æ–¹æ³•é»˜è®¤éƒ½æ˜¯public abstractçš„ï¼Œä¸”å±æ€§é»˜è®¤æ˜¯staticçš„</p>          </div><p><strong>Annotation</strong></p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Annotation</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/**     * Returns the annotation type of this annotation.     * @return the annotation type of this annotation     */</span>    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Annotation</span><span class="token punctuation">></span></span> <span class="token function">annotationType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p><strong>ElementType</strong></p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">ElementType</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/** Class, interface (including annotation type), or enum declaration */</span>    TYPE<span class="token punctuation">,</span>    <span class="token comment">/** Field declaration (includes enum constants) */</span>    FIELD<span class="token punctuation">,</span>    <span class="token comment">/** Method declaration */</span>    METHOD<span class="token punctuation">,</span>    <span class="token comment">/** Formal parameter declaration */</span>    PARAMETER<span class="token punctuation">,</span>    <span class="token comment">/** Constructor declaration */</span>    CONSTRUCTOR<span class="token punctuation">,</span>    <span class="token comment">/** Local variable declaration */</span>    LOCAL_VARIABLE<span class="token punctuation">,</span>    <span class="token comment">/** Annotation type declaration */</span>    ANNOTATION_TYPE<span class="token punctuation">,</span>    <span class="token comment">/** Package declaration */</span>    PACKAGE<span class="token punctuation">,</span>    <span class="token comment">/**     * Type parameter declaration     *     * @since 1.8     */</span>    TYPE_PARAMETER<span class="token punctuation">,</span>    <span class="token comment">/**     * Use of a type     *     * @since 1.8     */</span>    TYPE_USE<span class="token punctuation">&#125;</span></code></pre></div><p><strong>RetentionPolicy</strong></p><ul><li>Source: ä»…åœ¨æºç ä¸­ä½¿ç”¨ï¼Œä¸ä¼šç”Ÿæˆåœ¨Classæ–‡ä»¶ä¸­ï¼ŒJVMä¹Ÿæ£€æµ‹ä¸åˆ°</li><li>Class: åœ¨Classæ–‡ä»¶ä¸­ç”Ÿæˆï¼ˆèƒ½åœ¨Classæ–‡ä»¶ä¸­çœ‹åˆ°è¯¥æ³¨è§£çš„æ ‡æ³¨ï¼‰ï¼Œä½†JVMä¸­æ£€æµ‹ä¸åˆ°ï¼ˆåœ¨åŠ è½½å­—èŠ‚ç æ–‡ä»¶è¿›å…¥å†…å­˜ä¸­æ—¶ä¾¿ä¼šç­›å»ï¼‰</li><li>Runtimeï¼šJVMæ£€æµ‹çš„å‡º =&gt; <strong>èƒ½å¤Ÿé€šè¿‡getAnnotation(â€¦)æ¥æ£€æµ‹è¯¥æ³¨è§£</strong></li></ul><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Annotation retention policy.  The constants of this enumerated type * describe the various policies for retaining annotations.  They are used * in conjunction with the &#123;@link Retention&#125; meta-annotation type to specify * how long annotations are to be retained. * * @author  Joshua Bloch * @since 1.5 */</span><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">RetentionPolicy</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**     * Annotations are to be discarded by the compiler.     */</span>    SOURCE<span class="token punctuation">,</span>    <span class="token comment">/**     * Annotations are to be recorded in the class file by the compiler     * but need not be retained by the VM at run time.  This is the default     * behavior.     */</span>    CLASS<span class="token punctuation">,</span>    <span class="token comment">/**     * Annotations are to be recorded in the class file by the compiler and     * retained by the VM at run time, so they may be read reflectively.     *     * @see java.lang.reflect.AnnotatedElement     */</span>    RUNTIME<span class="token punctuation">&#125;</span></code></pre></div><p>ä¸€ä¸ªAnnotationä¸ä¸€ä¸ªRetentionPolicyå…³è”ï¼Œå¹¶ä¸”ä¸1-nä¸ªElementTypeå…³è”ï¼›ElementTypeæ¥æŒ‡å®šAnnotationçš„ç±»å‹ï¼ŒæŒ‡æ˜Annotationçš„ç”¨é€”ï¼›RetentionPolicyæŒ‡å®šAnnotationçš„ä½œç”¨åŸŸï¼Œä¸‰ç§ä½œç”¨åŸŸçš„ä½œç”¨åœ¨ä¸Šè¿°æ³¨è§£ä¸­å‡å·²è¯´æ˜ã€‚</p><h2 id="å®éªŒ-v2">å®éªŒ</h2><h3 id="ä½¿ç”¨-v3">ä½¿ç”¨</h3><p>getAnnotationæŒ‡å®šçš„æ³¨è§£æ¥è·å–æŒ‡å®šçš„æ³¨è§£ç±»å‹ï¼Œå¯ç›´æ¥è°ƒç”¨è¯¥<strong>æ³¨è§£å¯¹è±¡</strong>ä¸‹çš„æ–¹æ³•ï¼Œè¿›è€Œè·å–å…¶ä¸­çš„æ•°æ®</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span>FIELD<span class="token punctuation">,</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span>METHOD<span class="token punctuation">,</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span>TYPE<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">Hello</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">"123"</span><span class="token punctuation">;</span>    <span class="token class-name">String</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">"zyl"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token annotation punctuation">@Hello</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"hhh"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Obj</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// .....</span><span class="token punctuation">&#125;</span></code></pre></div><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Obj</span><span class="token punctuation">></span></span> clazz <span class="token operator">=</span> <span class="token class-name">Obj</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span><span class="token class-name">Hello</span> annotations <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">getAnnotation</span><span class="token punctuation">(</span><span class="token class-name">Hello</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>annotations<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><h2 id="æ¢ç©¶">æ¢ç©¶</h2><h3 id="å­—èŠ‚ç å±‚">å­—èŠ‚ç å±‚</h3><p>å®šä¹‰ä¸€ä¸ªç®€å•çš„æ³¨è§£ï¼Œç„¶åé€šè¿‡javap -c -v åç¼–è¯‘å…¶classæ–‡ä»¶</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span>FIELD<span class="token punctuation">,</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span>METHOD<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">Hello</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">"123"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><div class="code-wrapper"><pre class="language-shell" data-language="shell"><code class="language-shell">Classfile &#x2F;opt&#x2F;JavaProjects&#x2F;AnnotationStudy&#x2F;target&#x2F;classes&#x2F;Hello.class  Last modified 2022-6-14; size 442 bytes  MD5 checksum 4db04dd07931cec8b63bb2890dd0ad0d  Compiled from &quot;Hello.java&quot;public interface Hello extends java.lang.annotation.Annotation  minor version: 0  major version: 52  flags: ACC_PUBLIC, ACC_INTERFACE, ACC_ABSTRACT, ACC_ANNOTATIONConstant pool:   #1 &#x3D; Class              #18            &#x2F;&#x2F; Hello   #2 &#x3D; Class              #19            &#x2F;&#x2F; java&#x2F;lang&#x2F;Object   #3 &#x3D; Class              #20            &#x2F;&#x2F; java&#x2F;lang&#x2F;annotation&#x2F;Annotation   #4 &#x3D; Utf8               value   #5 &#x3D; Utf8               ()Ljava&#x2F;lang&#x2F;String;   #6 &#x3D; Utf8               AnnotationDefault   #7 &#x3D; Utf8               123   #8 &#x3D; Utf8               SourceFile   #9 &#x3D; Utf8               Hello.java  #10 &#x3D; Utf8               RuntimeVisibleAnnotations  #11 &#x3D; Utf8               Ljava&#x2F;lang&#x2F;annotation&#x2F;Target;  #12 &#x3D; Utf8               Ljava&#x2F;lang&#x2F;annotation&#x2F;ElementType;  #13 &#x3D; Utf8               FIELD  #14 &#x3D; Utf8               METHOD  #15 &#x3D; Utf8               Ljava&#x2F;lang&#x2F;annotation&#x2F;Retention;  #16 &#x3D; Utf8               Ljava&#x2F;lang&#x2F;annotation&#x2F;RetentionPolicy;  #17 &#x3D; Utf8               RUNTIME  #18 &#x3D; Utf8               Hello  #19 &#x3D; Utf8               java&#x2F;lang&#x2F;Object  #20 &#x3D; Utf8               java&#x2F;lang&#x2F;annotation&#x2F;Annotation&#123;  public abstract java.lang.String value();    descriptor: ()Ljava&#x2F;lang&#x2F;String;    flags: ACC_PUBLIC, ACC_ABSTRACT    AnnotationDefault:      default_value: s#7 &#125;SourceFile: &quot;Hello.java&quot;RuntimeVisibleAnnotations:  0: #11(#4&#x3D;[e#12.#13,e#12.#14])  1: #15(#4&#x3D;e#16.#17)</code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œæœ¬è´¨ä¸Šæ³¨è§£æ˜¯ç»§æ‰¿äºAnnotationæ¥å£çš„ï¼Œä¹Ÿå°±æ˜¯æ³¨é‡Šæœ¬è´¨ä¸Šæ˜¯ä¸€ç§æ¥å£ï¼Œè‡ªå®šä¹‰çš„æ–¹æ³•å˜æˆäº†æŠ½è±¡çš„æ–¹æ³•ï¼Œå¹¶å¸¦æœ‰ç‰¹æ®Šçš„AnnotationDefaultè¯´æ˜ã€‚</p><p>é‚£æåˆ°äº†æ¥å£ï¼Œè€Œæ³¨è§£åˆæ¶‰åŠåˆ°åå°„ï¼Œé‚£è‡ªç„¶æƒ³åˆ°äº†JDKçš„åŠ¨æ€åŠ è½½ï¼Œäºæ˜¯åœ¨VMOptionsé‡Œå¼€ä¸€ä¸‹<code>-Dsun.misc.ProxyGenerator.saveGeneratedFiles=true</code>æ˜¾ç¤ºä¸€ä¸‹ProxyåŠ è½½çš„classæ–‡ä»¶ï¼Œæœç„¶çœ‹åˆ°å…¶è¢«JDKåŠ¨æ€åŠ è½½</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220616111005419.png" alt="image-20220616111005419">è€Œ</p><p>é¢„å…ˆåŠ è½½äº†Retentionçš„æ³¨è§£ï¼Œå› ä¸ºHelloçš„æ³¨è§£ä¸­æœ‰ä½¿ç”¨åˆ°Retentionæ³¨è§£ï¼ˆé‚£ä¸ºå•¥æ²¡æœ‰Targetï¼Ÿï¼‰</p><h3 id="æºç å±‚é¢">æºç å±‚é¢</h3><blockquote><p>JDK ç‰ˆæœ¬ï¼š 1.8.0_312</p></blockquote><p>ç»è¿‡è°ƒè¯•å‘ç°ï¼Œé€”ç»ä¸€ç³»åˆ—è°ƒç”¨ï¼Œæœ€ç»ˆè¿›è¡ŒProxy.newProxyInstanceï¼Œå¹¶ä¸”ä¼ å…¥çš„æ˜¯ä¸€ä¸ªAnnotationInvocationHandlerï¼Œtypeè¡¨ç¤ºä¸€ä¸ªè¯¥æ³¨è§£Classå¯¹è±¡ï¼ˆinterfaceï¼‰,memberValuesè¡¨æ˜<strong>ä½¿ç”¨è¯¥æ³¨è§£çš„å¯¹è±¡</strong>ä¸‹æ³¨è§£çš„æ–¹æ³•ä¸å¯¹åº”çš„å€¼ï¼Œæœ¬è´¨æ˜¯ä¸€ä¸ªLinkedHashMapï¼Œå­˜å‚¨æ–¹æ³•åä¸å¯¹åº”çš„Objectå€¼</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">return</span> <span class="token class-name">AccessController</span><span class="token punctuation">.</span><span class="token function">doPrivileged</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PrivilegedAction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Annotation</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">public</span> <span class="token class-name">Annotation</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">Annotation</span><span class="token punctuation">)</span> <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span>                    type<span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">&#123;</span> type <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>                    <span class="token keyword">new</span> <span class="token class-name">AnnotationInvocationHandler</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> memberValues<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p>å®šä½åˆ°AnnotationInvocationHandlerçš„invokeæ–¹æ³•ï¼ŒæŸ¥çœ‹ç”Ÿæˆçš„è¿™ä¸ªä»£ç†ç±»æ˜¯å¦‚ä½•è¿›è¡Œæ–¹æ³•è°ƒç”¨çš„ã€‚</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> proxy<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">String</span> member <span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> paramTypes <span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">getParameterTypes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// Handle Object and Annotation methods</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>member<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"equals"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> paramTypes<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span>            paramTypes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token function">equalsImpl</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>paramTypes<span class="token punctuation">.</span>length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">AssertionError</span><span class="token punctuation">(</span><span class="token string">"Too many parameters for an annotation method"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">switch</span><span class="token punctuation">(</span>member<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">case</span> <span class="token string">"toString"</span><span class="token operator">:</span>            <span class="token keyword">return</span> <span class="token function">toStringImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">"hashCode"</span><span class="token operator">:</span>            <span class="token keyword">return</span> <span class="token function">hashCodeImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string">"annotationType"</span><span class="token operator">:</span>            <span class="token keyword">return</span> type<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// Handle annotation member accessors</span>        <span class="token class-name">Object</span> result <span class="token operator">=</span> memberValues<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>member<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IncompleteAnnotationException</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> member<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token keyword">instanceof</span> <span class="token class-name">ExceptionProxy</span><span class="token punctuation">)</span>            <span class="token keyword">throw</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">ExceptionProxy</span><span class="token punctuation">)</span> result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">generateException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token class-name">Array</span><span class="token punctuation">.</span><span class="token function">getLength</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>            result <span class="token operator">=</span> <span class="token function">cloneArray</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> result<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p>å³ä»£ç†ç±»åœ¨è°ƒç”¨æ–¹æ³•æ—¶å¯¹è‡ªå®šä¹‰çš„æ–¹æ³•ï¼Œä¼šé€šè¿‡Map memberValueså»å–ä¹‹å‰å­˜æœ‰çš„æ³¨è§£ä¸­çš„å€¼ã€‚è€Œæ³¨è§£ä¸­è®¾ç½®çš„å€¼<strong>å¹¶ä¸ç›´æ¥åœ¨ç”Ÿæˆçš„$Proxyç±»ä¸­</strong>ï¼Œè€Œæ˜¯é€šè¿‡æ„é€ è¯¥ç±»æ—¶ä¼ å…¥çš„AnnotationInvocationHandlerä¸­çš„Map&lt;String, Object&gt; memberValuesæ¥ç®¡ç†ï¼Œåœ¨æ¯æ¬¡invokeæ—¶å»getå¯¹åº”çš„å€¼</p><h2 id="æ€»ç»“-v2">æ€»ç»“</h2><p>æ³¨è§£æ˜¯ä¸€ç§å¸®åŠ©å¿«é€Ÿå¼€å‘çš„æ‰‹æ®µï¼Œé€šè¿‡ä¸»è¦Javaåå°„æ¥æ£€æµ‹å’Œæ‰§è¡Œï¼Œä¾èµ–JDKåŠ¨æ€ä»£ç†çš„æœºåˆ¶ã€‚</p><div class="note note-info">            <p>å‚è€ƒæ–‡ç« ï¼š ğŸ“–  <a href="https://zhuanlan.zhihu.com/p/60966151">çŸ¥ä¹-æ³¨è§£(ä¸Š)</a>     ğŸ“– <a href="https://www.runoob.com/w3cnote/java-annotation.html">Javaæ³¨è§£ï¼ˆAnnotationï¼‰ </a> ğŸ“– <a href="https://www.runoob.com/w3cnote/java-annotation.html">RUNOOB-Java æ³¨è§£</a></p>          </div>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Springä¸€çŸ¥åŠè§£</title>
    <link href="/2022/06/14/Spring%E4%B8%80%E7%9F%A5%E5%8D%8A%E8%A7%A3/"/>
    <url>/2022/06/14/Spring%E4%B8%80%E7%9F%A5%E5%8D%8A%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<h1>Springä¸€çŸ¥åŠè§£</h1><blockquote><p>Springçš„é‡è¦æ€§ä¸è¨€è€Œå–»ï¼Œä½†ä¹‹å‰ä¸€ç›´å¬åˆ«äººçš„å®è·µè¯¾ï¼Œç…§çŒ«ç”»è™åœ°åšä¸”ä»æ¥æ²¡åšç¬”è®°ï¼Œå¯¼è‡´è‡ªå·±å­¦å®Œåå¿˜äº†å¾ˆå¤šï¼Œå¹¶ä¸”æ²¡æœ‰ç†è§£ã€‚ä½†å¯¹Springçš„ç»“æ„å’ŒåŸç†çš„æ¢ç´¢æ˜¯å¿…é¡»çš„ã€ä¸”æ˜¯ä¸å¯é¿å…çš„ï¼Œä¸å¦‚å°±ä»ç°åœ¨å¼€å§‹ï¼</p><p>å½“å‰æ‰€å­¦ä¹ çš„Spring Frameworkç‰ˆæœ¬ï¼š 5.2.20-RELEASE</p><p>æœ¬æ–‡æ‰€æ¶µç›–çš„å†…å®¹ï¼šSpringåŸºæœ¬æ¦‚å¿µã€Spring Frameworkä»‹ç»ã€SpringåŸºæœ¬ä½¿ç”¨<br>å»ºè®®é˜…è¯»æ—¶æ­é… ğŸ“– <a href="">Springæºç æ¢ç©¶è¿™ç¯‡æ–‡ç« </a>é£Ÿç”¨ï¼Œæ•ˆæœæ›´ä½³</p></blockquote><h2 id="ä»‹ç»-v3">ä»‹ç»</h2><h3 id="AOP">AOP</h3><blockquote><p>ğŸ”—  <a href="https://zh.wikipedia.org/wiki/%E9%9D%A2%E5%90%91%E5%88%87%E9%9D%A2%E7%9A%84%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1">Wiki â€“ AOP</a></p><p><strong>é¢å‘åˆ‡é¢çš„ç¨‹åºè®¾è®¡</strong>ï¼ˆAspect-oriented programmingï¼ŒAOPï¼Œåˆè¯‘ä½œ<strong>é¢å‘æ–¹é¢çš„ç¨‹åºè®¾è®¡</strong>ã€<strong>å‰–é¢å¯¼å‘ç¨‹åºè®¾è®¡</strong>ï¼‰ï¼Œæ˜¯<a href="https://zh.wikipedia.org/wiki/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6">è®¡ç®—æœºç§‘å­¦</a>ä¸­çš„ä¸€ç§<a href="https://zh.wikipedia.org/wiki/%E7%BC%96%E7%A8%8B%E8%8C%83%E5%9E%8B">ç¨‹åºè®¾è®¡æ€æƒ³</a>ï¼Œæ—¨åœ¨å°†<a href="https://zh.wikipedia.org/wiki/%E6%A8%AA%E5%88%87%E5%85%B3%E6%B3%A8%E7%82%B9">æ¨ªåˆ‡å…³æ³¨ç‚¹</a>ä¸ä¸šåŠ¡ä¸»ä½“è¿›è¡Œè¿›ä¸€æ­¥åˆ†ç¦»ï¼Œä»¥æé«˜ç¨‹åºä»£ç çš„<a href="https://zh.wikipedia.org/wiki/%E6%A8%A1%E5%9D%97%E5%8C%96%E7%BC%96%E7%A8%8B">æ¨¡å—åŒ–</a>ç¨‹åº¦ã€‚é€šè¿‡åœ¨ç°æœ‰ä»£ç åŸºç¡€ä¸Šå¢åŠ é¢å¤–çš„é€šçŸ¥ï¼ˆAdviceï¼‰æœºåˆ¶ï¼Œèƒ½å¤Ÿå¯¹è¢«å£°æ˜ä¸ºâ€œåˆ‡ç‚¹ï¼ˆPointcutï¼‰â€çš„ä»£ç å—è¿›è¡Œç»Ÿä¸€ç®¡ç†ä¸è£…é¥°ï¼Œæ¯”å¦‚è¯´ï¼šâ€œå¯¹æ‰€æœ‰æ–¹æ³•åä»¥<code>set*</code>å¼€å¤´çš„æ–¹æ³•æ·»åŠ åå°æ—¥å¿—â€ã€‚è¯¥æ€æƒ³ä½¿å¾—å¼€å‘äººå‘˜èƒ½å¤Ÿå°†ä¸ä»£ç æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å…³ç³»ä¸é‚£ä¹ˆå¯†åˆ‡çš„åŠŸèƒ½ï¼ˆå¦‚æ—¥å¿—åŠŸèƒ½ï¼‰æ·»åŠ è‡³ç¨‹åºä¸­ï¼ŒåŒæ—¶åˆä¸é™ä½ä¸šåŠ¡ä»£ç çš„å¯è¯»æ€§ã€‚</p></blockquote><p><strong>ä¸ºä»€ä¹ˆä¼šæœ‰AOPå‡ºç°</strong></p><p>è€ƒè™‘ä¸€ä¸ªåœ¨OOPä¸‹çš„åº”ç”¨åœºæ™¯ï¼Œä¾‹å¦‚ä¸€ä¸ªä¸šåŠ¡æ–¹æ³• <code>updateUserMoney()</code>ä¸­ï¼Œé™¤äº†æœ¬èº«çš„ä¸šåŠ¡ä»£ç å¤–ï¼Œè¿˜å¯èƒ½æ¶µç›–å®‰å…¨æ£€æŸ¥ã€æ—¥å¿—æ£€æŸ¥ã€äº‹åŠ¡å¤„ç†</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateUserMoney</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">,</span> <span class="token keyword">double</span> money<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">securityCheck</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Transaction</span> tx <span class="token operator">=</span> <span class="token function">startTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// æ ¸å¿ƒä¸šåŠ¡é€»è¾‘</span>            tx<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">RuntimeException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            tx<span class="token punctuation">.</span><span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">throw</span> e<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"created book: "</span> <span class="token operator">+</span> book<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p>è¿™å°±è®©ä¸€ä¸ªæœ¬æ¥æ™®é€šçš„æ–¹æ³•å°±æŒ¤äº†å¾ˆå¤šå¾ˆå¤šçš„é¢å¤–é™„åŠ çš„å†…å®¹ï¼Œå¢å¤§äº†ä¸å¿…è¦çš„å¼€å‘é‡ï¼Œå³ä¾¿ç”¨äº†ä»£ç†æ¨¡å¼ï¼Œä¸€æ ·ä¼šé€ æˆé‡å¤çš„ä»£ç å’Œè¿‡å¤šçš„æ¥å£</p><p>é‚£ä¸å¦‚æŠŠå®‰å…¨ã€æ—¥å¿—ã€äº‹åŠ¡ç­‰è¿™äº›ä¸å®é™…ä¸šåŠ¡ä¸å¤ªç›¸å…³ä½†æœ‰å¿…é¡»çš„å†…å®¹æŠ½è±¡æˆä¸åŒçš„åˆ‡é¢(PointCut)ï¼Œä»¥ä¸€ç§è‡ªåŠ¨åŒ–çš„æ–¹å¼æŠŠåˆ‡é¢<strong>ç»‡å…¥</strong>ï¼ˆWeaveï¼‰è¿›æ ¸å¿ƒé€»è¾‘ä¸­ã€‚ç±»ä¼¼invokeï¼Œåœ¨<code>updateUserMoney</code>æ–¹æ³•è°ƒç”¨æ—¶ï¼Œå…ˆå¯¹æ–¹æ³•è¿›è¡Œ<strong>æ‹¦æˆª</strong>ï¼Œåœ¨æ–¹æ³•å‰åæ‰§è¡Œè¿™äº›ä¸åŒåˆ‡é¢çš„å†…å®¹å¤„ç†ï¼Œè¿™æ ·ä¾¿èƒ½è¾¾åˆ°æ—¢ä¸ç ´ååŸæœ‰æ ¸å¿ƒä¸šåŠ¡æ–¹æ³•çš„å†…å®¹åˆèƒ½å¯ä¿®æ”¹åœ°è¿›è¡ŒåŠŸèƒ½å¢åŠ ã€‚</p><p>åœ¨Javaå¹³å°ä¸Šï¼Œå¯¹äºAOPçš„ç»‡å…¥ï¼Œæœ‰3ç§æ–¹å¼ï¼š</p><ol><li>ç¼–è¯‘æœŸï¼š<strong>åœ¨ç¼–è¯‘æ—¶ï¼Œç”±ç¼–è¯‘å™¨æŠŠåˆ‡é¢è°ƒç”¨ç¼–è¯‘è¿›å­—èŠ‚ç </strong>ï¼Œè¿™ç§æ–¹å¼éœ€è¦<strong>å®šä¹‰æ–°çš„å…³é”®å­—å¹¶æ‰©å±•ç¼–è¯‘å™¨</strong>ï¼ŒAspectJå°±æ‰©å±•äº†Javaç¼–è¯‘å™¨ï¼Œä½¿ç”¨å…³é”®å­—aspectæ¥å®ç°ç»‡å…¥ï¼›</li><li>ç±»åŠ è½½å™¨ï¼šåœ¨ç›®æ ‡ç±»è¢«è£…è½½åˆ°JVMæ—¶ï¼Œé€šè¿‡ä¸€ä¸ªç‰¹æ®Šçš„ç±»åŠ è½½å™¨ï¼Œå¯¹ç›®æ ‡ç±»çš„å­—èŠ‚ç é‡æ–°â€œå¢å¼ºâ€ï¼›</li><li>è¿è¡ŒæœŸï¼šç›®æ ‡å¯¹è±¡å’Œåˆ‡é¢éƒ½æ˜¯æ™®é€šJavaç±»ï¼Œé€šè¿‡<strong>JVMçš„åŠ¨æ€ä»£ç†åŠŸèƒ½</strong>æˆ–è€…ç¬¬ä¸‰æ–¹åº“å®ç°è¿è¡ŒæœŸåŠ¨æ€ç»‡å…¥ã€‚æ˜¯æœ€ç®€å•çš„æ–¹å¼ï¼ŒSpringçš„AOPå®ç°å°±æ˜¯åŸºäºJVMçš„åŠ¨æ€ä»£ç†</li></ol><h3 id="IOC">IOC</h3><p><strong>IoC - Inversion of Control - æ§åˆ¶åè½¬</strong></p><p>ä¸ºä»€ä¹ˆä¼šæœ‰IoCå‡ºç°ï¼Ÿè€ƒè™‘ä¸€ä¸‹åœºæ™¯ï¼š</p><p>JDBCæ—¶ä»£ï¼Œåœ¨ä¸åŒçš„<code>Dao</code>å±‚ï¼Œéœ€è¦è·å–æ•°æ®åº“è¿æ¥è·å¾—dataSourceè¿›è€Œæ‰èƒ½å¯¹æ•°æ®åº“è¿›è¡Œæ“ä½œï¼Œé‚£ä¹ˆæœ‰è®¸å¤šä¸ªDaoå¯¹è±¡å»è·å–DataSourceå®ä¾‹ï¼Œå¯èƒ½çš„å½¢å¼åƒè¿™æ ·ï¼š</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserDao</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">DataSourceConfig</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataSourceConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">DataSource</span> dataSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataSource</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// ...</span><span class="token punctuation">&#125;</span></code></pre></div><p>ä½†æ˜¯å…¶å®DataSourceå¤§å¯ä»¥ä¸ç”¨newå•Šï¼Œå› ä¸ºå…¶å®åŒæ ·çš„Configæ‹¿åˆ°çš„æ˜¯ä¸€æ ·çš„DataSourceå¯¹è±¡ã€‚newè§£å†³çš„é—®é¢˜ä¾¿æ˜¯ï¼Œå¦‚æœä¸€ä¸ªç±»å®Œä¸æˆçš„ä»»åŠ¡ï¼Œå°±åœ¨è¿™ä¸ªç±»ä¸­å§”æ‰˜ç»™å¦ä¸€ä¸ªç±»æ¥æ‰§è¡Œï¼Œé‚£è¿™ç§<strong>å§”æ‰˜</strong> æˆ–è€…è¯´è¿™ç§<strong>åè°ƒ</strong>å…³ç³»é ä»€ä¹ˆæ¥å¤„ç†å‘¢ï¼Ÿåœ¨IoCæ—¶ä»£ä¹‹å‰ï¼Œä¾¿æ˜¯ç”±newå…³é”®å­—æ¥è¿›è¡Œï¼Œä½†è¿™ç§æ–¹å¼é€ æˆäº†ç»„ä»¶ä¹‹é—´çš„è€¦åˆã€‚è€ŒIoCä¾¿å°†è¿™ç§å§”æ‰˜å…³ç³»ä»ç»„ä»¶å†…éƒ¨çš„new â€¦çš„æ–¹å¼æå‡åˆ°<strong>å¤–éƒ¨å®¹å™¨</strong>æ¥ç®¡ç†ï¼Œå®¹å™¨åœ¨è¿è¡ŒæœŸé—´å°†ç»„ä»¶é—´çš„ä¾èµ–å…³ç³»åŠ¨æ€åœ°æ³¨å…¥è¿›ç»„ä»¶ä¸­</p><p><strong>ç†è§£ä¸ºä»€ä¹ˆnewä¼šé€ æˆè€¦åˆ</strong></p><p>å¦‚ä¸‹ä»£ç ï¼Œå¦‚æœRabbitToyå‘ç”Ÿäº†å˜åŒ–ï¼ˆæ„é€ å‡½æ•°ã€å®ç°æ–¹æ³•ã€å‚æ•°ã€å±æ€§ç­‰ï¼‰ï¼Œé‚£RabbitToyæ‰€å½±å“çš„æ‰€æœ‰ç±»éƒ½éœ€è¦åšå‡ºå˜åŒ–ï¼Œå› ä¸ºè¿™äº›å˜åŒ–å®é™…ä¸Šæ˜¯å†™æ­»åœ¨ä»£ç ä¸­çš„ï¼Œè¿™å°±é€ æˆäº†ç±»ä¹‹é—´çš„è€¦åˆã€‚</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Son</span> <span class="token keyword">extends</span> <span class="token class-name">Father</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Toy</span> toy<span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token class-name">Son</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        toy <span class="token operator">=</span> <span class="token class-name">RabbitToy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p>å¦‚æœåœ¨ç±»Açš„å†…éƒ¨å»å®ä¾‹åŒ–ç±»Bï¼Œé‚£ä¹ˆä¸¤è€…ä¹‹é—´ä¼šå‡ºç°è¾ƒé«˜çš„<strong>è€¦åˆ</strong>ï¼Œä¸€æ—¦ç±»Bå‡ºç°äº†é—®é¢˜ï¼Œç±»Aä¹Ÿéœ€è¦è¿›è¡Œæ”¹é€ ï¼Œå¦‚æœè¿™æ ·çš„æƒ…å†µè¾ƒå¤šï¼Œæ¯ä¸ªç±»ä¹‹é—´éƒ½æœ‰å¾ˆå¤šä¾èµ–ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°ç‰µä¸€å‘è€ŒåŠ¨å…¨èº«çš„æƒ…å†µï¼Œ<strong>ç¨‹åºä¼šæéš¾ç»´æŠ¤</strong>ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“å‡ºç°é—®é¢˜ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°±è¦<strong>æŠŠAç±»å¯¹Bç±»çš„æ§åˆ¶æƒ</strong>æŠ½ç¦»å‡ºæ¥ï¼Œäº¤ç»™ä¸€ä¸ªç¬¬ä¸‰æ–¹å»åšï¼ŒæŠŠæ§åˆ¶æƒåè½¬ç»™ç¬¬ä¸‰æ–¹ï¼Œå°±ç§°ä½œ<strong>æ§åˆ¶åè½¬ï¼ˆIOC Inversion Of Controlï¼‰</strong>ã€‚</p><p><strong>ç†è§£Springçš„æ§åˆ¶åè½¬ï¼š å¯¹Springæ¥è¯´ Springè´Ÿè´£æ§åˆ¶äº†å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå’Œå¯¹è±¡é—´çš„å…³ç³»ï¼Œæ‰€æœ‰çš„ç±»éƒ½åœ¨Springä¸­ç™»è®°ï¼Œéœ€è¦æå‰å‘ŠçŸ¥Springä½ æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Œä½ éœ€è¦ä»€ä¹ˆä¸œè¥¿ï¼Œç„¶åSpringä¼šåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå½“ä½ éœ€è¦æ—¶ä¼šæŠŠä½ éœ€è¦çš„ä¸œè¥¿ä¸»åŠ¨ç»™ä½ ã€‚ç±»çš„åˆ›å»ºå’Œé”€æ¯éƒ½æœ‰Springæ¥å†³å®šï¼Œ<strong>æ§åˆ¶å¯¹è±¡ç”Ÿå‘½å‘¨æœŸçš„ä¸å†æ˜¯å¼•ç”¨å®ƒçš„å¯¹è±¡ï¼Œè€Œæ˜¯Spring IoC Container</strong>ï¼Œè¿™å°±è¾¾åˆ°äº†</strong>æ§åˆ¶åè½¬**çš„æ•ˆæœã€‚</p><p>é‚£Springæ˜¯å¦‚ä½•åŠ¨æ€çš„æŠŠä¸€ä¸ªç±»æ‰€éœ€è¦çš„å¯¹è±¡ç»™å®ƒå‘¢ï¼Ÿ <strong>DI ä¾èµ–æ³¨å…¥</strong></p><h4 id="DI">DI</h4><p>Dependency Injection : ä¾èµ–æ³¨å…¥</p><p>ç°åœ¨Aç±»ä¾èµ–Bç±»ï¼Œå¹¶ä¸åœ¨Aç±»ä¸­ç›´æ¥new å¯¹è±¡Bï¼Œè€Œæ˜¯é€šè¿‡é…ç½®åœ¨å¤–éƒ¨æ–‡ä»¶ä¸­ï¼ŒBç±»çš„å®ä¾‹ä¸åœ¨ä»£ç ä¸­åˆ›å»ºï¼Œè€Œæ˜¯å¤–éƒ¨é€šè¿‡æ„é€ å‡½æ•°ä¼ å…¥</p><p>ä¾èµ–æ³¨å…¥çš„æŠ€æœ¯åŸºç¡€æ˜¯<strong>å¤šæ€æœºåˆ¶</strong>ä¸<strong>åå°„æœºåˆ¶</strong>ã€‚</p><div class="note note-warning">            <p><strong>æ€è€ƒ</strong>ï¼š é‚£æˆ‘é€šè¿‡æ„é€ å™¨æ­é…newçš„æ–¹å¼èƒ½å¦è§£å†³è§£è€¦çš„é—®é¢˜ï¼Ÿä»…åˆ›å»ºåˆ°Sonç±»æ—¶ä¼ å…¥ä¸€ä¸ªç‰¹å®šçš„Fatherçš„å­ç±»å¯¹è±¡ï¼Œæ•ˆæœä¸æ˜¯å’ŒDIæ˜¯ä¸€æ ·çš„å—ï¼Ÿ</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Son</span> <span class="token keyword">extends</span> <span class="token class-name">Father</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Father</span> father<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">Son</span><span class="token punctuation">(</span><span class="token class-name">Father</span> father<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>father <span class="token operator">=</span> father<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div>          </div><p>ä¸Šé¢æåˆ°çš„é—®é¢˜ä¹Ÿèƒ½è§£è€¦ï¼Œä½†æ˜¯è¿˜æ˜¯éœ€è¦åœ¨ä»£ç å†…éƒ¨new æˆ–è€…æ‰¾åˆ°ä¸€ä¸ªæ‰€éœ€çš„Fatherå¯¹è±¡æ¥é…ç½®ï¼Œä½†é€šè¿‡å¤–ç½®æ–‡ä»¶é…ç½®å°±ä¸éœ€è¦åœ¨ä»£ç ä¸­å†™å‡ºã€‚<strong>é€šè¿‡æ¥å£ã€æ„é€ å‡½æ•°ã€setteræ–¹æ³•éƒ½æ˜¯ä¾èµ–æ³¨å…¥å¯è¡Œçš„æ–¹å¼</strong></p><p><strong>æ€»ç»“ä¸€ä¸‹</strong> ï¼šæ§åˆ¶åè½¬æ˜¯ä¸€ç§<strong>æ€æƒ³</strong>ï¼Œæ˜¯èƒ½å¤Ÿè§£å†³é—®é¢˜çš„ä¸€ç§å¯èƒ½çš„ç»“æœï¼Œè€Œä¾èµ–æ³¨å…¥ï¼ˆDependency Injectionï¼‰å°±æ˜¯å…¶æœ€å…¸å‹çš„<strong>å®ç°æ–¹æ³•</strong>ã€‚ç”±ç¬¬ä¸‰æ–¹ï¼ˆ<strong>æˆ‘ä»¬ç§°ä½œIoCå®¹å™¨</strong>ï¼‰æ¥æ§åˆ¶ä¾èµ–ï¼ŒæŠŠä»–é€šè¿‡<strong>æ„é€ å‡½æ•°ã€å±æ€§æˆ–è€…å·¥å‚æ¨¡å¼</strong>ç­‰æ–¹æ³•ï¼Œæ³¨å…¥åˆ°ç±»Aå†…ï¼Œè¿™æ ·å°±æå¤§ç¨‹åº¦çš„å¯¹ç±»Aå’Œç±»Bè¿›è¡Œäº†<strong>è§£è€¦</strong>ã€‚</p><h3 id="Spring">Spring</h3><p>é€šå¸¸æˆ‘ä»¬è¯´Springï¼Œå¾€å¾€æŒ‡çš„æ˜¯Springå…¨å®¶æ¡¶ï¼ŒSpringæ¡†æ¶åˆ†ä¸ºå¤šä¸ªæ¨¡å—ï¼Œåº”ç”¨é¡¹ç›®å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©</p><blockquote><p>At the heart are the modules of the core container, including a configuration model and a dependency injection mechanism.</p></blockquote><p><strong>æ ¸å¿ƒå®¹å™¨çš„æ¨¡å—æ˜¯æ ¸å¿ƒï¼ŒåŒ…æ‹¬é…ç½®æ¨¡å‹å’Œä¾èµ–é¡¹æ³¨å…¥æœºåˆ¶</strong>ã€‚å¹¶ä¸”Spring æ¡†æ¶ä¸ºä¸åŒçš„åº”ç”¨ç¨‹åºä½“ç³»ç»“æ„æä¾›äº†åŸºç¡€æ”¯æŒï¼ŒåŒ…æ‹¬æ¶ˆæ¯ä¼ é€’ï¼Œäº‹åŠ¡æ€§æ•°æ®å’ŒæŒä¹…æ€§ä»¥åŠ Webã€‚å®ƒè¿˜åŒ…æ‹¬åŸºäº Servlet çš„ Spring MVC Web æ¡†æ¶ï¼Œä»¥åŠå¹¶è¡Œçš„ Spring WebFlux ååº”å¼ Web æ¡†æ¶ã€‚</p><h2 id="Core-v2">Core</h2><h3 id="IoC">IoC</h3><h4 id="Introduce">Introduce</h4><blockquote><p>The <code>org.springframework.beans</code> and <code>org.springframework.context</code> packages are the basis for Spring Frameworkâ€™s IoC container.</p></blockquote><p>BeanFactory æ¥å£æä¾›äº†ä¸€ç§é«˜çº§çš„é…ç½®æœºåˆ¶ï¼Œèƒ½å¤Ÿç®¡ç†ä»»ä½•ç±»å‹çš„å¯¹è±¡ï¼ˆæä¾›é…ç½®æ¡†æ¶å’ŒåŸºæœ¬åŠŸèƒ½ï¼‰ï¼›ApplicationContextæ˜¯BeanFactoryçš„å­æ¥å£ï¼Œå®ƒå¢åŠ äº†ä¼ä¸šç‰¹å®šåŠŸèƒ½ï¼š</p><ul><li>ä¸ Spring çš„ AOP åŠŸèƒ½è½»æ¾é›†æˆ</li><li>æ¶ˆæ¯èµ„æºå¤„ç†(ç”¨äºå›½é™…åŒ–)</li><li>Event publication</li><li>ç‰¹å®šäºåº”ç”¨ç¨‹åºå±‚çš„ä¸Šä¸‹æ–‡ï¼Œä¾‹å¦‚ç”¨äº Web åº”ç”¨ç¨‹åºçš„<code>WebApplicationContext</code>ã€‚</li></ul><p><strong>Springä¸­çš„bean</strong></p><blockquote><p>In Spring, the objects that form the backbone of your application and that are managed by the Spring IoC container are called <strong>beans</strong>. A <strong>bean</strong> is an object that is instantiated, assembled, and managed <strong>by a Spring IoC container</strong>. Otherwise, a bean is simply one of many objects in your application. Beans, and the dependencies among them, are reflected in the configuration metadata used by a container.</p></blockquote><p>æ„æˆåº”ç”¨ç¨‹åºä¸»å¹²å¹¶ç”±Spring IoCå®¹å™¨ç®¡ç†çš„å¯¹è±¡ç§°ä¸ºbeanï¼Œbeanç”±å®¹å™¨å®ä¾‹åŒ–ã€ç»„è£…å’Œç®¡ç†ã€‚beanåŠå…¶ä¹‹é—´çš„ä¾èµ–å…³ç³»ååº”åœ¨å®¹å™¨ä½¿ç”¨çš„é…ç½®å…ƒæ•°æ®ä¸­</p><h4 id="Container">Container</h4><p><code>org.springframework.context.ApplicationContext</code>æ¥å£ä»£è¡¨Sping IoCå®¹å™¨å¹¶ä¸”è´Ÿè´£beançš„åˆå§‹åŒ–ã€é…ç½®å’Œè£…é…ã€‚å®¹å™¨é€šè¿‡è¯»å–å…ƒæ•°æ®æ¥è·å–æœ‰å…³è¦å®ä¾‹åŒ–ã€é…ç½®å’Œç»„è£…å“ªäº›å¯¹è±¡çš„æŒ‡ä»¤ã€‚<strong>é…ç½®å…ƒæ•°æ®ä»¥XMLã€Javaæ³¨è§£æˆ–Javaä»£ç è¡¨ç¤º</strong></p><p>è€ŒSpringæä¾›äº†ApplicationContextæ¥å£çš„é›†ä¸­å®ç°ï¼Œåˆ›å»ºClassPathXmlâ€¦å’ŒFileSystemXmlâ€¦çš„å®ä¾‹å‡å¯</p><p><img src="https://docs.spring.io/spring-framework/docs/current/reference/html/images/container-magic.png" alt="The Spring IoC container"></p><p>Spring IoCä½¿ç”¨ä¸€ç§é…ç½®å…ƒæ•°æ®çš„å½¢å¼ï¼Œè¡¨ç¤ºå¼€å‘è€…å¦‚ä½•å‘Šè¯‰Springå®¹å™¨å®ä¾‹åŒ–ã€é…ç½®å¹¶ç»„è£…å¯¹è±¡ã€‚ä¼ ç»Ÿä¸Šè¿˜æ˜¯ç”¨XMLæ¥è¿›è¡Œé…ç½®ï¼Œè¿˜å¯ä»¥ç”¨å…¶ä»–å½¢å¼çš„å…ƒæ•°æ®ä¿¡æ¯ï¼š</p><ul><li><a href="https://www.docs4dev.com/docs/zh/spring-framework/5.1.3.RELEASE/reference/core.html#beans-annotation-config">Annotation-based configuration</a>ï¼šSpring 2.5 å¼•å…¥äº†å¯¹åŸºäºæ³¨è§£çš„é…ç½®å…ƒæ•°æ®çš„æ”¯æŒã€‚</li><li><a href="https://www.docs4dev.com/docs/zh/spring-framework/5.1.3.RELEASE/reference/core.html#beans-java">Java-based configuration</a>ï¼šä» Spring 3.0 å¼€å§‹ï¼ŒSpring JavaConfig é¡¹ç›®æä¾›çš„è®¸å¤šåŠŸèƒ½æˆä¸ºäº†æ ¸å¿ƒ Spring Framework çš„ä¸€éƒ¨åˆ†ã€‚å› æ­¤ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Java è€Œä¸æ˜¯ XML æ–‡ä»¶æ¥å®šä¹‰åº”ç”¨ç¨‹åºç±»å¤–éƒ¨çš„ beanã€‚è¦ä½¿ç”¨è¿™äº›æ–°åŠŸèƒ½ï¼Œè¯·å‚è§<a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/context/annotation/Configuration.html">@Configuration</a>ï¼Œ<a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/context/annotation/Bean.html">@Bean</a>ï¼Œ<a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/context/annotation/Import.html">@Import</a>å’Œ<a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/context/annotation/DependsOn.html">@DependsOn</a>æ³¨è§£ã€‚</li></ul><p>Springé…ç½®åŒ…å«è‡³å°‘ä¸€ä¸ªå®¹å™¨å¿…é¡»ç®¡ç†çš„beançš„å®šä¹‰ã€‚åŸºäº XML çš„é…ç½®å…ƒæ•°æ®å°†è¿™äº› bean é…ç½®ä¸ºé¡¶çº§<code>&lt;beans/&gt;</code>å…ƒç´ å†…çš„<code>&lt;bean/&gt;</code>å…ƒç´ ã€‚ Java é…ç½®é€šå¸¸åœ¨<code>@Configuration</code>ç±»ä¸­ä½¿ç”¨<code>@Bean</code>æ³¨è§£çš„æ–¹æ³•ã€‚</p><p>è¿™äº›beanå®šä¹‰å¯¹åº”äºç»„æˆåº”ç”¨ç¨‹åºçš„å®é™…å¯¹è±¡ï¼Œé€šå¸¸ï¼Œå®šä¹‰æ•°æ®è®¿é—®å¯¹è±¡ï¼ˆDAOï¼‰ã€åŸºç¡€ç»“æ„å¯¹è±¡ï¼ˆä¾‹å¦‚Hibernateä¸­çš„SessioniFactoriesï¼‰ç­‰</p><p>ğŸ“ <a href="#demo-application-bean-01">Demo-01ï¼š é€šè¿‡ClassPathXmlæ¥å®šä¹‰ApplicationContextè¿›è€Œå®šä¹‰beançš„å®ä¾‹</a></p><h4 id="Bean-v2">Bean</h4><p>Beané€šè¿‡é…ç½®çš„xmlæ–‡ä»¶ï¼Œç”±Spring IoC Containeråˆ›å»ºï¼Œåœ¨å®¹å™¨æœ¬èº«å†…è¿™äº›beanè¢«è¡¨ç¤ºä¸ºBeanDefinitionå¯¹è±¡ï¼ŒåŒ…å«ä»¥ä¸‹å…ƒæ•°æ®ï¼š</p><ul><li>åŒ…é™å®šçš„ç±»åï¼šé€šå¸¸ï¼Œå®šä¹‰äº† Bean çš„å®é™…å®ç°ç±»ã€‚</li><li>Bean è¡Œä¸ºé…ç½®å…ƒç´ ï¼Œç”¨äºå£°æ˜ Bean åœ¨å®¹å™¨ä¸­çš„è¡Œä¸º(ä½œç”¨åŸŸï¼Œç”Ÿå‘½å‘¨æœŸå›è°ƒç­‰)ã€‚</li><li>å¼•ç”¨å…¶ä»– bean è¿›è¡Œå…¶å·¥ä½œæ‰€éœ€çš„ beanã€‚è¿™äº›å¼•ç”¨ä¹Ÿç§°ä¸ºåä½œè€…æˆ–ä¾èµ–é¡¹ã€‚</li><li>è¦åœ¨æ–°åˆ›å»ºçš„å¯¹è±¡ä¸­è®¾ç½®çš„å…¶ä»–é…ç½®è®¾ç½®ï¼Œä¾‹å¦‚ï¼Œæ± çš„å¤§å°é™åˆ¶æˆ–åœ¨ Management è¿æ¥æ± çš„ bean ä¸­ä½¿ç”¨çš„è¿æ¥æ•°</li></ul><p>è¯¥å…ƒæ•°æ®è½¬æ¢ä¸ºæ„æˆæ¯ä¸ª bean å®šä¹‰çš„ä¸€ç»„å±æ€§ã€‚ä¸‹è¡¨æè¿°äº†è¿™äº›å±æ€§ï¼ˆå…·ä½“åœ°è¡¨ç°åœ¨BeanDefinitionæºç ä¸­ï¼‰ï¼š</p><table><thead><tr><th style="text-align:left">Property</th><th style="text-align:left">Explained inâ€¦</th></tr></thead><tbody><tr><td style="text-align:left">Class</td><td style="text-align:left"><a href="https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-factory-class">Instantiating Beans</a></td></tr><tr><td style="text-align:left">Name</td><td style="text-align:left"><a href="https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-beanname">Naming Beans</a></td></tr><tr><td style="text-align:left">Scope</td><td style="text-align:left"><a href="https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-factory-scopes">Bean Scopes</a></td></tr><tr><td style="text-align:left">Constructor arguments</td><td style="text-align:left"><a href="https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-factory-collaborators">Dependency Injection</a></td></tr><tr><td style="text-align:left">Properties</td><td style="text-align:left"><a href="https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-factory-collaborators">Dependency Injection</a></td></tr><tr><td style="text-align:left">Autowiring mode</td><td style="text-align:left"><a href="https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-factory-autowire">Autowiring Collaborators</a></td></tr><tr><td style="text-align:left">Lazy initialization mode</td><td style="text-align:left"><a href="https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-factory-lazy-init">Lazy-initialized Beans</a></td></tr><tr><td style="text-align:left">Initialization method</td><td style="text-align:left"><a href="https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-factory-lifecycle-initializingbean">Initialization Callbacks</a></td></tr><tr><td style="text-align:left">Destruction method</td><td style="text-align:left"><a href="https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-factory-lifecycle-disposablebean">Destruction Callbacks</a></td></tr></tbody></table><p><a href="">BeanDefinitionæºç æ¢ç©¶</a></p><p><strong>Beançš„å‘½å</strong></p><p>æ¯ä¸ªbeanæœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ ‡è¯†ç¬¦ï¼Œåœ¨æ‰¿è½½beançš„å®¹å™¨å†…æ ‡è¯†ç¬¦å¿…é¡»å”¯ä¸€ï¼Œé…ç½®å¤šä¸ªæ ‡è¯†ç¬¦ï¼Œå¯ä»¥åœ¨XMLä¸­é€šè¿‡<code>name=&quot;a, b, c&quot;</code>æ¥é…ç½®ï¼Œcontext.getBean()å³å¯é€šè¿‡idåˆå¯é€šè¿‡nameæ¥æŸ¥æ‰¾ã€‚beançš„å‘½åä¸€èˆ¬æ˜¯é©¼å³°å¼</p><p>é€šè¿‡<code>&lt;alias/&gt;</code>æ¥å®šä¹‰åˆ«åï¼ˆå¯¹idå’Œnameå‡ç”Ÿæ•ˆï¼‰ï¼Œé€‚é…å¤§å‹ç³»ç»Ÿä¸­æ¯ä¸ªå­ç³»ç»Ÿè‡ªå·±çš„å¯¹è±¡å®šä¹‰é›†</p><p><strong>Beançš„å®ä¾‹åŒ–</strong></p><p>å½“è¢«éœ€è¦æ—¶ï¼ŒContainerå°†æŸ¥çœ‹å‘½åbeançš„é…æ–¹recipeï¼Œå¹¶ä½¿ç”¨è¯¥beanå®šä¹‰å°è£…çš„é…ç½®å…ƒæ•°æ®æ¥åˆ›å»ºå®é™…å¯¹è±¡ã€‚</p><ul><li>é€šè¿‡æ„é€ æ–¹æ³•å®ä¾‹åŒ–ã€‚å½“é€šè¿‡æ„é€ æ–¹æ³•åˆ›å»ºä¸€ä¸ª bean æ—¶ï¼Œæ‰€æœ‰æ™®é€šç±»éƒ½å¯ä»¥è¢« Spring ä½¿ç”¨å¹¶ä¸ä¹‹å…¼å®¹ã€‚</li><li>ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•å®ä¾‹åŒ–ã€‚å®šä¹‰ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•åˆ›å»ºçš„ bean æ—¶ï¼Œè¯·ä½¿ç”¨<code>class</code>å±æ€§æ¥æŒ‡å®šåŒ…å«<code>static</code>å·¥å‚æ–¹æ³•çš„ç±»ï¼Œå¹¶ä½¿ç”¨åä¸º<code>factory-method</code>çš„å±æ€§æ¥æŒ‡å®šå·¥å‚æ–¹æ³•æœ¬èº«çš„åç§°ã€‚</li><li>ä½¿ç”¨å®ä¾‹å·¥å‚æ–¹æ³•å®ä¾‹åŒ–ï¼ˆä»¥ä¸Šä¸¤ä¸ªæ–¹æ³•å‡ä¸å¤ªæ¸…æ¥šï¼Œæºäºå¯¹å·¥å‚æ–¹æ³•çš„ç†è§£ä¸æ¸…æ¥šï¼‰</li></ul><h4 id="Dependency">Dependency</h4><h5 id="DI-v2">DI</h5><blockquote><p>Dependency injection (DI) is a process whereby objects define their dependencies (that is, the other objects with which they work) only through constructor arguments, arguments to a factory method, or properties that are set on the object instance after it is constructed or returned from a factory method. The container then injects those dependencies when it creates the bean.</p></blockquote><p>ä¾èµ–æ³¨å…¥(DI)æ˜¯ä¸€ä¸ªè¿‡ç¨‹ï¼Œé€šè¿‡è¯¥è¿‡ç¨‹ï¼Œå¯¹è±¡åªèƒ½é€šè¿‡æ„é€ å‡½æ•°å‚æ•°ï¼Œå·¥å‚æ–¹æ³•çš„å‚æ•°æˆ–åœ¨æ„é€ æˆ–åˆ›å»ºå¯¹è±¡å®ä¾‹ååœ¨å¯¹è±¡å®ä¾‹ä¸Šè®¾ç½®çš„å±æ€§æ¥å®šä¹‰å…¶ä¾èµ–å…³ç³»(å³ï¼Œä¸å®ƒä»¬ä¸€èµ·å·¥ä½œçš„å…¶ä»–å¯¹è±¡)ã€‚ä»å·¥å‚æ–¹æ³•è¿”å›ã€‚ç„¶åï¼Œå®¹å™¨åœ¨åˆ›å»º bean æ—¶æ³¨å…¥é‚£äº›ä¾èµ–é¡¹ã€‚</p><p>DIå­˜åœ¨çš„ä¸¤ä¸ªå˜ä½“ï¼š<strong>åŸºäºæ„é€ å‡½æ•°çš„æ³¨å…¥</strong>å’Œ<strong>åŸºäºSetterçš„ä¾èµ–æ³¨å…¥</strong></p><ul><li><p>åŸºäºæ„é€ å‡½æ•°çš„æ³¨å…¥</p><ul><li><p>å¦‚æœä¸»è¦ä½¿ç”¨æ„é€ å‡½æ•°æ³¨å…¥ï¼Œåˆ™å¯èƒ½ä¼šåˆ›å»ºæ— æ³•è§£å†³çš„å¾ªç¯ä¾èµ–æ–¹æ¡ˆã€‚</p><p>ä¾‹å¦‚ï¼šA ç±»é€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥éœ€è¦ B ç±»çš„å®ä¾‹ï¼Œè€Œ B ç±»é€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥éœ€è¦ A ç±»çš„å®ä¾‹ã€‚å¦‚æœä¸ºå°†ç±» A å’Œ B ç›¸äº’æ³¨å…¥è€Œé…ç½®äº† beanï¼Œåˆ™ Spring IoC å®¹å™¨ä¼šåœ¨è¿è¡Œæ—¶æ£€æµ‹åˆ°æ­¤å¾ªç¯å¼•ç”¨ï¼Œå¹¶æŠ›å‡º<code>BeanCurrentlyInCreationException</code>ã€‚</p></li></ul></li><li><p>åŸºäºSetterçš„ä¾èµ–æ³¨å…¥</p><ul><li>é€šè¿‡@Required()åœ¨å¯¹åº”Setteræ–¹æ³•ä¸Šå¯æŒ‡å®šå¯¹åº”çš„å±æ€§ä¸ºå¿…è¦é…ç½®ä¾èµ–é¡¹</li><li>setæ³¨å…¥èƒ½è§£å†³ä»¥ä¸Šé—®é¢˜ï¼Œé…ç½®å¾ªç¯ä¾èµ–å…³ç³»</li></ul></li></ul><h5 id="é…ç½®Bean">é…ç½®Bean</h5><p><strong>æ„é€ å™¨é…ç½®</strong></p><p><strong>å±æ€§é…ç½®</strong></p><div class="code-wrapper"><pre class="language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>driverClassName<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.mysql.jdbc.Driver<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span></code></pre></div><p>xmlä¸­é€šè¿‡<code>value</code>å£°æ˜<strong>å­—ç¬¦ä¸²</strong>è¡¨ç¤ºçš„å¯¹è±¡æ¥æŒ‡å®šç‰¹å®šnameå±æ€§çš„å€¼</p><p>ä¹Ÿå¯ä»¥é€šè¿‡p-namespaceæˆ–c-namespaceè¿›è¡Œæ›´ç®€æ´çš„XMLé…ç½®ï¼Œå°†åœ¨æ ‡ç­¾ä½“ä¸­çš„é…ç½®è½¬åŒ–ä¸ºåœ¨æ ‡ç­¾å†…è¿›è¡Œï¼Œä¾‹å¦‚</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"myDataSource"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"org.apache.commons.dbcp.BasicDataSource"</span>        destroy<span class="token operator">-</span>method<span class="token operator">=</span><span class="token string">"close"</span>        p<span class="token operator">:</span>driverClassName<span class="token operator">=</span><span class="token string">"com.mysql.jdbc.Driver"</span>        p<span class="token operator">:</span>url<span class="token operator">=</span><span class="token string">"jdbc:mysql://localhost:3306/mydb"</span>        p<span class="token operator">:</span>username<span class="token operator">=</span><span class="token string">"root"</span>        p<span class="token operator">:</span>password<span class="token operator">=</span><span class="token string">"masterkaoli"</span><span class="token operator">/</span><span class="token operator">></span></code></pre></div><p><strong>1. ä½¿ç”¨ idrefï¼š</strong><code>idref</code>å…ƒç´ åªæ˜¯å°†å®¹å™¨ä¸­å¦ä¸€ä¸ª bean çš„<code>id</code>(<strong>å­—ç¬¦ä¸²å€¼</strong>-ä¸æ˜¯å¼•ç”¨)ä¼ é€’ç»™<code>&lt;constructor-arg/&gt;</code>æˆ–<code>&lt;property/&gt;</code>å…ƒç´ çš„ä¸€ç§é˜²é”™æ–¹æ³•ã€‚</p><div class="code-wrapper"><pre class="language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>theTargetBean<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>...<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>theClientBean<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>...<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>targetName<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>idref</span> <span class="token attr-name">bean</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>theTargetBean<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- equals: &lt;property name="targetName" value="theTargetBean"/> --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span></code></pre></div><p>ç¬¬ä¸€ç§å½¢å¼ä¼˜äºç¬¬äºŒç§å½¢å¼ï¼Œå› ä¸ºä½¿ç”¨<code>idref</code>æ ‡ç­¾å¯ä»¥ä½¿å®¹å™¨åœ¨éƒ¨ç½²æ—¶éªŒè¯æ‰€å¼•ç”¨çš„å‘½å Bean å®é™…ä¸Šæ˜¯å¦å­˜åœ¨ã€‚åœ¨ç¬¬äºŒä¸ªå˜ä½“ä¸­ï¼Œä¸å¯¹ä¼ é€’ç»™<code>client</code> bean çš„<code>targetName</code>å±æ€§çš„å€¼æ‰§è¡ŒéªŒè¯ã€‚ä»…åœ¨å®é™…å®ä¾‹åŒ–<code>client</code> bean æ—¶æ‰å‘ç°æ‹¼å†™é”™è¯¯(ææœ‰å¯èƒ½å¯¼è‡´è‡´å‘½çš„ç»“æœ)ã€‚</p><p>**2. ä½¿ç”¨parentï¼š **é€šè¿‡<code>parent</code>å±æ€§æŒ‡å®šç›®æ ‡ bean å°†åˆ›å»ºå¯¹å½“å‰å®¹å™¨çš„çˆ¶å®¹å™¨ä¸­çš„ bean çš„å¼•ç”¨ã€‚ <code>parent</code>å±æ€§çš„å€¼å¯ä»¥ä¸ç›®æ ‡ Bean çš„<code>id</code>å±æ€§æˆ–ç›®æ ‡ Bean çš„<code>name</code>å±æ€§ä¸­çš„å€¼ç›¸åŒã€‚<strong>ç›®æ ‡ Bean å¿…é¡»ä½äºå½“å‰å®¹å™¨çš„çˆ¶å®¹å™¨ä¸­</strong>ã€‚</p><p>ä¹Ÿå¯ä»¥åœ¨beanä¸­åµŒå¥—beanï¼Œæ­¤æ—¶åˆ™ä¸éœ€è¦å®šä¹‰IDæˆ–nameï¼Œå†…éƒ¨beanå§‹ç»ˆæ˜¯åŒ¿åçš„ï¼Œå¹¶ä¸”ä¸å¤–éƒ¨beanä¸€èµ·åˆ›å»º</p><p><strong>3. åœ¨beanä¸­é…ç½®é›†åˆ</strong></p><div class="code-wrapper"><pre class="language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>moreComplexObject<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>example.ComplexObject<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- results in a setAdminEmails(java.util.Properties) call --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>adminEmails<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>props</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prop</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>administrator<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>[emailprotected]<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prop</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prop</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>support<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>[emailprotected]<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prop</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prop</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>development<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>[emailprotected]<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prop</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>props</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- results in a setSomeList(java.util.List) call --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>someList<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>list</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>a list element followed by a reference<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ref</span> <span class="token attr-name">bean</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myDataSource<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>list</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- results in a setSomeMap(java.util.Map) call --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>someMap<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>map</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>an entry<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>just some string<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>a ref<span class="token punctuation">"</span></span> <span class="token attr-name">value-ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myDataSource<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>map</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- results in a setSomeSet(java.util.Set) call --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>someSet<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>set</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>just some string<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ref</span> <span class="token attr-name">bean</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myDataSource<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>set</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span></code></pre></div><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œpropsæ˜¯mapçš„ç®€åŒ–ç‰ˆï¼Œç”¨æ¥åªå­˜å‚¨å­—ç¬¦ä¸²å‹çš„é”®å€¼å¯¹</p><p>å¹¶ä¸”Springè¿˜æ”¯æŒåœ¨é…ç½®æ–‡ä»¶å±‚çš„é›†åˆåˆå¹¶ï¼Œé€šè¿‡çˆ¶å­beanæ¥è¿›è¡Œæ“ä½œ å‚è€ƒ <a href="#sucession-of-bean">beançš„ç»§æ‰¿</a></p><div class="code-wrapper"><pre class="language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>parent<span class="token punctuation">"</span></span> <span class="token attr-name">abstract</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>example.ComplexObject<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>adminEmails<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>props</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prop</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>administrator<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>[emailprotected]<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prop</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prop</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>support<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>[emailprotected]<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prop</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>props</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>child<span class="token punctuation">"</span></span> <span class="token attr-name">parent</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>parent<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>adminEmails<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!-- the merge is specified on the child collection definition --></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>props</span> <span class="token attr-name">merge</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prop</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sales<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>[emailprotected]<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prop</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prop</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>support<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>[emailprotected]<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prop</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>props</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span><span class="token punctuation">></span></span></code></pre></div><p><strong>4. ä½¿ç”¨<code>&lt;null/&gt;</code></strong></p><div class="code-wrapper"><pre class="language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>null</span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- equal: obj.setEmail(null); --></span></code></pre></div><p><strong>5. ä½¿ç”¨å¤åˆå±æ€§åç§°</strong></p><div class="code-wrapper"><pre class="language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>something<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>things.ThingOne<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fred.bob.sammy<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>123<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span></code></pre></div><p><code>something</code> bean å…·æœ‰<code>fred</code>å±æ€§ï¼Œè¯¥å±æ€§å…·æœ‰<code>bob</code>å±æ€§ï¼Œè¯¥å±æ€§å…·æœ‰<code>sammy</code>å±æ€§ï¼Œå¹¶ä¸”æœ€ç»ˆçš„<code>sammy</code>å±æ€§è¢«è®¾ç½®ä¸º<code>123</code>çš„å€¼ã€‚ä¸ºäº†ä½¿å®ƒèµ·ä½œç”¨ï¼Œåœ¨æ„é€  bean ä¹‹åï¼Œ<code>something</code>çš„<code>fred</code>å±æ€§å’Œ<code>fred</code>çš„<code>bob</code>å±æ€§ä¸€å®šä¸èƒ½ä¸º<code>null</code>ã€‚å¦åˆ™ï¼Œå°†æŠ›å‡º<code>NullPointerException</code>ã€‚</p><h5 id="åˆå§‹åŒ–bean">åˆå§‹åŒ–bean</h5><p>è‹¥ä¸€ä¸ªbeanæ˜¯å¦ä¸€ä¸ªbeançš„ä¾èµ–é¡¹ï¼Œä½¿ç”¨<code>ref</code>èƒ½å¤Ÿæ»¡è¶³å¤§å¤šæ•°åœºæ™¯ã€‚ä½†æœ‰æ—¶beané—´çš„ä¾èµ–æ€§ä¸å¤ªç›´æ¥(ä½•æ—¶éœ€è¦è§¦å‘ç±»ä¸­çš„é™æ€åˆå§‹å€¼è®¾å®šé¡¹ï¼Œä¾‹å¦‚ç”¨äºæ•°æ®åº“é©±åŠ¨ç¨‹åºæ³¨å†Œ)ï¼Œä½¿ç”¨<code>depends-on</code>èƒ½åœ¨åˆå§‹åŒ–ä½¿ç”¨è¯¥å…ƒç´ æ—¶å¼ºåˆ¶åœ°åˆå§‹åŒ–ä¸€ä¸ªæˆ–è€…å¤šä¸ªbean</p><div class="code-wrapper"><pre class="language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>beanOne<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ExampleBean<span class="token punctuation">"</span></span> <span class="token attr-name">depends-on</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>manager, ceo<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>manager<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ManagerBean<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></code></pre></div><p><strong>æ‡’åˆå§‹åŒ–bean</strong></p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒApplicationContextä¼šæ€¥äºåˆ›å»ºå’Œé…ç½®æ‰€æœ‰çš„ singleton beanã€‚å¯ä½¿ç”¨<code>lazy-init</code>å±æ€§æ¥æ§åˆ¶ã€‚ä½†å¦‚æœè¯¥beanæ˜¯æœªå»¶è¿Ÿåˆå§‹åŒ–çš„beançš„ä¾èµ–é¡¹æ—¶ï¼ŒAppContextä¹Ÿä¼šåˆ›å»ºè¿™ä¸ªbeanï¼Œå› ä¸ºå…¶ä¾èµ–å…³ç³»å¿…é¡»è¢«æ»¡è¶³ã€‚</p><div class="code-wrapper"><pre class="language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>lazy<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.something.ExpensiveToCreateBean<span class="token punctuation">"</span></span> <span class="token attr-name">lazy-init</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>not.lazy<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.something.AnotherBean<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span></code></pre></div><h5 id="æ–¹æ³•æ³¨å…¥">æ–¹æ³•æ³¨å…¥</h5><h4 id="bean-scope">bean scope</h4><p>beançš„ä½œç”¨åŸŸ  <code>scrop=xxx</code></p><table><thead><tr><th>Scope</th><th>Description</th></tr></thead><tbody><tr><td><a href="https://www.docs4dev.com/docs/zh/spring-framework/5.1.3.RELEASE/reference/core.html#beans-factory-scopes-singleton">singleton</a></td><td>(é»˜è®¤)å°†æ¯ä¸ª Spring IoC å®¹å™¨çš„å•ä¸ª bean å®šä¹‰èŒƒå›´é™å®šä¸ºå•ä¸ªå¯¹è±¡å®ä¾‹ã€‚</td></tr><tr><td><a href="https://www.docs4dev.com/docs/zh/spring-framework/5.1.3.RELEASE/reference/core.html#beans-factory-scopes-prototype">prototype</a></td><td>å°†å•ä¸ª bean å®šä¹‰çš„ä½œç”¨åŸŸé™å®šä¸ºä»»æ„æ•°é‡çš„å¯¹è±¡å®ä¾‹ã€‚</td></tr><tr><td><a href="https://www.docs4dev.com/docs/zh/spring-framework/5.1.3.RELEASE/reference/core.html#beans-factory-scopes-request">request</a></td><td>å°†å•ä¸ª bean å®šä¹‰çš„èŒƒå›´é™å®šä¸ºå•ä¸ª HTTP è¯·æ±‚çš„ç”Ÿå‘½å‘¨æœŸã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ª HTTP è¯·æ±‚éƒ½æœ‰ä¸€ä¸ªåœ¨å•ä¸ª bean å®šä¹‰åé¢åˆ›å»ºçš„ bean å®ä¾‹ã€‚ä»…åœ¨å¯æ„ŸçŸ¥ç½‘ç»œçš„ Spring <code>ApplicationContext</code>ä¸­æœ‰æ•ˆã€‚</td></tr><tr><td><a href="https://www.docs4dev.com/docs/zh/spring-framework/5.1.3.RELEASE/reference/core.html#beans-factory-scopes-session">session</a></td><td>å°†å•ä¸ª bean å®šä¹‰çš„èŒƒå›´é™å®šä¸º HTTP <code>Session</code>çš„ç”Ÿå‘½å‘¨æœŸã€‚ä»…åœ¨å¯æ„ŸçŸ¥ç½‘ç»œçš„ Spring <code>ApplicationContext</code>ä¸Šä¸‹æ–‡ä¸­æœ‰æ•ˆã€‚</td></tr><tr><td><a href="https://www.docs4dev.com/docs/zh/spring-framework/5.1.3.RELEASE/reference/core.html#beans-factory-scopes-application">application</a></td><td>å°†å•ä¸ª bean å®šä¹‰çš„èŒƒå›´é™å®šä¸º<code>ServletContext</code>çš„ç”Ÿå‘½å‘¨æœŸã€‚ä»…åœ¨å¯æ„ŸçŸ¥ç½‘ç»œçš„ Spring <code>ApplicationContext</code>ä¸Šä¸‹æ–‡ä¸­æœ‰æ•ˆã€‚</td></tr><tr><td><a href="https://www.docs4dev.com/docs/zh/spring-framework/5.1.3.RELEASE/reference/web.html#websocket-stomp-websocket-scope">websocket</a></td><td>å°†å•ä¸ª bean å®šä¹‰çš„èŒƒå›´é™å®šä¸º<code>WebSocket</code>çš„ç”Ÿå‘½å‘¨æœŸã€‚ä»…åœ¨å¯æ„ŸçŸ¥ç½‘ç»œçš„ Spring <code>ApplicationContext</code>ä¸Šä¸‹æ–‡ä¸­æœ‰æ•ˆã€‚</td></tr></tbody></table><ul><li>Singleton å•ä¾‹å¯¹è±¡ <em>(default)</em>: ä¸€ä¸ªå®ä¾‹å¯¹åº”æ‰€æœ‰åŒ¹é…idçš„bean, ä¾‹å¦‚DAOå±‚å¯¹è±¡</li><li>Prototype åŸå‹å¯¹è±¡: æ¯æ¬¡å¯¹beanæå‡ºè¯·æ±‚æ—¶ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„beanå®ä¾‹ ã€‚Springä¸ç®¡ç† åŸå‹beançš„å®Œæ•´å£°æ˜å‘¨æœŸï¼Œå®¹å™¨å°†å®ä¾‹åŒ–ã€é…ç½®æˆ–ç»„è£…åŸå‹å¯¹è±¡ï¼Œç„¶åå°†å…¶äº¤ç»™Clientç«¯ï¼Œæ— éœ€å¯¹è¯¥åŸå‹å®ä¾‹è¿›ä¸€æ­¥è®°å½•</li></ul><h4 id="customize-bean">customize bean</h4><h5 id="ç”Ÿå‘½å‘¨æœŸå›è°ƒ">ç”Ÿå‘½å‘¨æœŸå›è°ƒ</h5><p><strong>å¼€å§‹</strong></p><p>è¦ä¸å®¹å™¨å¯¹ bean ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†è¿›è¡Œäº¤äº’ï¼Œå¯ä»¥å®ç° Spring <code>InitializingBean</code>å’Œ<code>DisposableBean</code>æ¥å£ã€‚å®¹å™¨å¯¹å‰è€…è°ƒç”¨<code>afterPropertiesSet()</code>ï¼Œå¯¹åè€…è°ƒç”¨<code>destroy()</code>ï¼Œä»¥ä½¿ Bean åœ¨åˆå§‹åŒ–å’Œé”€æ¯ Bean æ—¶æ‰§è¡ŒæŸäº›æ“ä½œã€‚ä¾‹å¦‚åˆ¤æ–­XMLæ³¨å…¥çš„å±æ€§å€¼æ˜¯å¦ä¸ºnullï¼Œæ˜¯å¦ç¬¦åˆè§„èŒƒï¼Œå¦åˆ™æŠ›å‡ºå¼‚å¸¸ç­‰â€¦</p><p><code>org.springframework.beans.factory.InitializingBean</code>æ¥å£å…è®¸å®¹å™¨åœ¨å®¹å™¨ä¸Šè®¾ç½®äº†æ‰€æœ‰å¿…éœ€çš„å±æ€§åï¼Œbean å¯ä»¥æ‰§è¡Œåˆå§‹åŒ–å·¥ä½œã€‚ä½†å…¶ä¸å¿…è¦åœ°å°†ä»£ç è€¦åˆåˆ° Springï¼ˆä¸æ˜¯å¾ˆç†è§£ï¼‰ã€‚å¯ä»¥ä½¿ç”¨<code>init-method</code>å±æ€§æŒ‡å®šå…·æœ‰æ— æ•ˆæ— å‚æ•°ç­¾åçš„æ–¹æ³•çš„åç§°ã€‚é€šè¿‡ Java é…ç½®ï¼Œå¯ä»¥ä½¿ç”¨<code>@Bean</code>çš„<code>initMethod</code>å±æ€§ã€‚<code>init-method</code>æ–¹æ³•çš„è°ƒç”¨æ˜¯åœ¨æ•´ä¸ªå¯¹è±¡åˆ›å»ºåï¼ˆåŒ…æ‹¬æ„é€ å™¨ç”Ÿæˆå’Œpropertyæ³¨å…¥ï¼‰æ‰§è¡Œã€‚å¯ä»¥ç›´æ¥åœ¨æ–¹æ³•ä¸Šä½¿ç”¨@PostConstructæ¥æŒ‡å®šï¼ˆä½†è‡ªå·±è¯•äº†å¥½åƒæ²¡æœ‰æ•ˆæœï¼‰</p><p><strong>é”€æ¯</strong></p><p>å®ç°<code>org.springframework.beans.factory.DisposableBean</code>æ¥å£åï¼Œå½“åŒ…å« bean çš„å®¹å™¨è¢«é”€æ¯æ—¶ï¼Œbean å¯ä»¥è·å–å›è°ƒã€‚åŒæ ·ä¹Ÿä¼šé€ æˆè€¦åˆ ã€‚å¯¹åº”çš„xmlé…ç½®ä¸º<code>destroy-method</code> ï¼ŒJava @Beanå¯é€šè¿‡destroyMethodå±æ€§æ¥è®¾ç½®</p><p>ä¹Ÿå¯åœ¨é¡¶å±‚çš„beanä¸Šè®¾ç½®<code>default-init-method</code>æˆ–<code>default-destroy-method</code>æ¥è®¾ç½®è¯¥beanä¸‹åˆ›å»ºçš„æ‰€æœ‰beançš„é»˜è®¤initå’Œdestroyæ–¹æ³•ï¼Œéå¸¸æ–¹ä¾¿</p><p><strong>å¯åŠ¨å’Œå…³é—­å›è°ƒ</strong></p><p><code>Lifecycle</code>æ¥å£ä¸ºå…·æœ‰è‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸè¦æ±‚(ä¾‹å¦‚å¯åŠ¨å’Œåœæ­¢æŸäº›åå°è¿›ç¨‹)çš„ä»»ä½•å¯¹è±¡å®šä¹‰åŸºæœ¬æ–¹æ³•ã€‚</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Lifecycle</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">boolean</span> <span class="token function">isRunning</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>ä»»ä½• SpringManagement çš„å¯¹è±¡éƒ½å¯ä»¥å®ç°<code>Lifecycle</code>æ¥å£</p><p>ä¸å¤ªæ‡‚ â¬†ï¸</p><h5 id="beanæ„ŸçŸ¥Container">beanæ„ŸçŸ¥Container</h5><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ApplicationContextAware</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">void</span> <span class="token function">setApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">ApplicationContext</span> applicationContext<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>å¯ä»¥å«åšæ§åˆ¶åè½¬å†åè½¬ï¼Œå‰é¢è¯´è¿‡ä¸ºè§£å†³ä¸€äº›IoCæ§åˆ¶åè½¬è§£å†³ä¸äº†çš„é—®é¢˜ï¼ŒSpringä¹Ÿå…è®¸beanåœ¨è¿è¡Œæ—¶æ„ŸçŸ¥ApplicationContextã€‚ä¸€ç§ç”¨é€”æ˜¯é€šè¿‡ç¼–ç¨‹æ–¹å¼æ£€ç´¢å…¶ä»– beanã€‚æœ‰æ—¶ï¼Œæ­¤åŠŸèƒ½å¾ˆæœ‰ç”¨ã€‚ä½†æ˜¯ï¼Œé€šå¸¸åº”é¿å…ä½¿ç”¨å®ƒï¼Œå› ä¸ºå®ƒå°†ä»£ç è€¦åˆåˆ° Springï¼Œå¹¶ä¸”ä¸éµå¾ªæ§åˆ¶åè½¬æ ·å¼ï¼Œåœ¨è¯¥æ ·å¼ä¸­ï¼Œå°†åä½œè€…ä½œä¸ºå±æ€§æä¾›ç»™ beanã€‚</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">BeanNameAware</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">void</span> <span class="token function">setBeanName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>è¿”å›è¯¥beanå¯¹è±¡å®šä¹‰çš„idæˆ–nameï¼Œåœ¨å¡«å……å¸¸è§„ bean å±æ€§ä¹‹åä½†åœ¨åˆå§‹åŒ–å›è°ƒä¹‹å‰è°ƒç”¨</p><p>é™¤æ­¤ä¹‹å¤–è¿˜æœ‰å…¶ä»–æ›´å¤šçš„æ„ŸçŸ¥æ¥å£â€¦</p><table><thead><tr><th>Name</th><th>Injected Dependency</th><th>Explained inâ€¦</th></tr></thead><tbody><tr><td><code>ApplicationContextAware</code></td><td>å£°æ˜<code>ApplicationContext</code>ã€‚</td><td><a href="https://www.docs4dev.com/docs/zh/spring-framework/5.1.3.RELEASE/reference/core.html#beans-factory-aware">ApplicationContextAware å’Œ BeanNameAware</a></td></tr><tr><td><code>ApplicationEventPublisherAware</code></td><td>é™„ä»¶<code>ApplicationContext</code>çš„äº‹ä»¶å‘å¸ƒè€…ã€‚</td><td><a href="https://www.docs4dev.com/docs/zh/spring-framework/5.1.3.RELEASE/reference/core.html#context-introduction">ApplicationContext çš„å…¶ä»–åŠŸèƒ½</a></td></tr><tr><td><code>BeanClassLoaderAware</code></td><td>ç±»åŠ è½½å™¨ï¼Œç”¨äºåŠ è½½ Bean ç±»ã€‚</td><td><a href="https://www.docs4dev.com/docs/zh/spring-framework/5.1.3.RELEASE/reference/core.html#beans-factory-class">Instantiating Beans</a></td></tr><tr><td><code>BeanFactoryAware</code></td><td>å£°æ˜<code>BeanFactory</code>ã€‚</td><td><a href="https://www.docs4dev.com/docs/zh/spring-framework/5.1.3.RELEASE/reference/core.html#beans-factory-aware">ApplicationContextAware å’Œ BeanNameAware</a></td></tr><tr><td><code>BeanNameAware</code></td><td>å£°æ˜ bean çš„åç§°ã€‚</td><td><a href="https://www.docs4dev.com/docs/zh/spring-framework/5.1.3.RELEASE/reference/core.html#beans-factory-aware">ApplicationContextAware å’Œ BeanNameAware</a></td></tr><tr><td><code>BootstrapContextAware</code></td><td>è¿è¡Œå®¹å™¨çš„èµ„æºé€‚é…å™¨<code>BootstrapContext</code>ã€‚é€šå¸¸ä»…åœ¨æ”¯æŒ JCA çš„<code>ApplicationContext</code>å®ä¾‹ä¸­å¯ç”¨ã€‚</td><td><a href="https://www.docs4dev.com/docs/zh/spring-framework/5.1.3.RELEASE/reference/integration.html#cci">JCA CCI</a></td></tr><tr><td><code>LoadTimeWeaverAware</code></td><td>å®šä¹‰çš„ç¼–ç»‡å™¨ï¼Œç”¨äºåœ¨åŠ è½½æ—¶å¤„ç†ç±»å®šä¹‰ã€‚</td><td><a href="https://www.docs4dev.com/docs/zh/spring-framework/5.1.3.RELEASE/reference/core.html#aop-aj-ltw">åœ¨ Spring Framework ä¸­ä½¿ç”¨ AspectJ è¿›è¡ŒåŠ è½½æ—¶ç¼–ç»‡</a></td></tr><tr><td><code>MessageSourceAware</code></td><td>è§£å†³æ¶ˆæ¯çš„å·²é…ç½®ç­–ç•¥(æ”¯æŒå‚æ•°åŒ–å’Œå›½é™…åŒ–)ã€‚</td><td><a href="https://www.docs4dev.com/docs/zh/spring-framework/5.1.3.RELEASE/reference/core.html#context-introduction">ApplicationContext çš„å…¶ä»–åŠŸèƒ½</a></td></tr><tr><td><code>NotificationPublisherAware</code></td><td>Spring JMX é€šçŸ¥å‘å¸ƒè€…ã€‚</td><td><a href="https://www.docs4dev.com/docs/zh/spring-framework/5.1.3.RELEASE/reference/integration.html#jmx-notifications">Notifications</a></td></tr><tr><td><code>ResourceLoaderAware</code></td><td>é…ç½®çš„åŠ è½½ç¨‹åºï¼Œç”¨äºå¯¹èµ„æºçš„ä½çº§åˆ«è®¿é—®ã€‚</td><td><a href="https://www.docs4dev.com/docs/zh/spring-framework/5.1.3.RELEASE/reference/core.html#resources">Resources</a></td></tr><tr><td><code>ServletConfigAware</code></td><td>å½“å‰å®¹å™¨è¿è¡Œçš„<code>ServletConfig</code>ã€‚ä»…åœ¨å¯æ„ŸçŸ¥ç½‘ç»œçš„ Spring <code>ApplicationContext</code>ä¸­æœ‰æ•ˆã€‚</td><td><a href="https://www.docs4dev.com/docs/zh/spring-framework/5.1.3.RELEASE/reference/web.html#mvc">Spring MVC</a></td></tr><tr><td><code>ServletContextAware</code></td><td>å½“å‰å®¹å™¨è¿è¡Œçš„<code>ServletContext</code>ã€‚ä»…åœ¨å¯æ„ŸçŸ¥ç½‘ç»œçš„ Spring <code>ApplicationContext</code>ä¸­æœ‰æ•ˆã€‚</td><td><a href="https://www.docs4dev.com/docs/zh/spring-framework/5.1.3.RELEASE/reference/web.html#mvc">Spring MVC</a></td></tr></tbody></table><p>ä½†æ˜¯ä½¿ç”¨è¿™äº›æ¥å£å‡ä¼šè®©ä»£ç ä¸Spring APIç»‘å®šåœ¨ä¸€èµ·ï¼ˆä¹Ÿå°±æ˜¯éœ€è¦Srping API çš„å›è°ƒæ•°æ®ï¼Œè€Œéæ˜¯å±äºè‡ªå·±çš„æ–¹æ³•ï¼‰ï¼Œä¸éµå¾ªIoCæ ·å¼</p><h4 id="Container-Extension">Container Extension</h4><p>é€šå¸¸ï¼Œåº”ç”¨ç¨‹åºå¼€å‘äººå‘˜ä¸éœ€è¦å°†<code>ApplicationContext</code>å®ç°ç±»ä½œä¸ºå­ç±»ï¼ˆä»€ä¹ˆæ„æ€ï¼Ÿï¼‰ã€‚ç›¸åï¼Œå¯ä»¥é€šè¿‡æ’å…¥ç‰¹æ®Šé›†æˆæ¥å£çš„å®ç°æ¥æ‰©å±• Spring IoC å®¹å™¨ã€‚</p><h5 id="BeanPostProcessorè‡ªå®šä¹‰bean">BeanPostProcessorè‡ªå®šä¹‰bean</h5><blockquote><p><code>BeanPostProcessor</code> instances operate on bean (or object) instances. That is, the Spring IoC container instantiates a bean instance and then <code>BeanPostProcessor</code> instances do their work.</p></blockquote><p>Spring IoCå®¹å™¨å®ä¾‹åŒ–ä¸€ä¸ªbeanï¼Œç„¶åBeanPostProcesså®ä¾‹å®Œæˆå…¶å·¥ä½œã€‚ä»€ä¹ˆå·¥ä½œï¼Ÿä¹Ÿå³å¯åœ¨beanå®ä¾‹åˆ›å»º è°ƒç”¨init-methodæ–¹æ³•å‰åè¿›è¡Œå›è°ƒ</p><p><code>ApplicationContext</code>è‡ªåŠ¨æ£€æµ‹å®ç°<code>BeanPostProcessor</code>æ¥å£çš„é…ç½®å…ƒæ•°æ®ä¸­å®šä¹‰çš„æ‰€æœ‰ beanã€‚ <code>ApplicationContext</code>å°†è¿™äº› bean æ³¨å†Œä¸ºåå¤„ç†å™¨ï¼Œä»¥ä¾¿ä»¥ååœ¨ bean åˆ›å»ºæ—¶å¯ä»¥è°ƒç”¨å®ƒä»¬ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨<code>addBeanPostProcessor</code>é€šè¿‡<code>ConfigurableBeanFactory</code>ä»¥ç¼–ç¨‹æ–¹å¼æ³¨å†Œå®ƒä»¬ã€‚</p><p>å¯ä»¥é…ç½®å¤šä¸ª<code>BeanPostProcessor</code>å®ä¾‹ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡è®¾ç½®<code>order</code>å±æ€§æ¥æ§åˆ¶è¿™äº›<code>BeanPostProcessor</code>å®ä¾‹çš„æ‰§è¡Œ Sequencesã€‚ä»…å½“<code>BeanPostProcessor</code>å®ç°<code>Ordered</code>æ¥å£æ—¶ï¼Œæ‰å¯ä»¥è®¾ç½®æ­¤å±æ€§ã€‚</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">BeanPostProcessor</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Nullable</span>    <span class="token keyword">default</span> <span class="token class-name">Object</span> <span class="token function">postProcessBeforeInitialization</span><span class="token punctuation">(</span><span class="token class-name">Object</span> bean<span class="token punctuation">,</span> <span class="token class-name">String</span> beanName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> bean<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Nullable</span>    <span class="token keyword">default</span> <span class="token class-name">Object</span> <span class="token function">postProcessAfterInitialization</span><span class="token punctuation">(</span><span class="token class-name">Object</span> bean<span class="token punctuation">,</span> <span class="token class-name">String</span> beanName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> bean<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p>ç›´æ¥é€šè¿‡<code>&lt;bean class=&quot;com.pplong.dao.InstancePostBeanProcessor&quot;/&gt;</code>æ’å…¥åˆ°xmlä¸­å³å¯å®ç°BeanPostProcessorçš„æ³¨å†Œ</p><h5 id="BeanFactoryPostProcessorè‡ªå®šä¹‰é…ç½®å…ƒæ•°æ®">BeanFactoryPostProcessorè‡ªå®šä¹‰é…ç½®å…ƒæ•°æ®</h5><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@FunctionalInterface</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">BeanFactoryPostProcessor</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">void</span> <span class="token function">postProcessBeanFactory</span><span class="token punctuation">(</span><span class="token class-name">ConfigurableListableBeanFactory</span> var1<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>ä¸BeanPostProcessorç•¥æœ‰ä¸åŒï¼Œ<code>BeanFactoryPostProcessor</code>å¯¹ Bean é…ç½®å…ƒæ•°æ®è¿›è¡Œæ“ä½œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒSpring IoC å®¹å™¨å…è®¸<code>BeanFactoryPostProcessor</code>è¯»å–é…ç½®å…ƒæ•°æ®ï¼Œå¹¶å¯èƒ½<strong>åœ¨å®¹å™¨å®ä¾‹åŒ–<code>BeanFactoryPostProcessor</code>å®ä¾‹ä»¥å¤–çš„ä»»ä½• bean ä¹‹å‰</strong>*å¯¹å…¶è¿›è¡Œæ›´æ”¹ã€‚</p><p><code>BeanFactoryPostProcessor</code>ä¹Ÿæ”¯æŒé€šè¿‡Orderedæ¥å£æ¥è®¾ç½®å¯åŠ¨é¡ºåº</p><p><code>ApplicationContext</code>è‡ªåŠ¨æ£€æµ‹å®ç°<code>BeanFactoryPostProcessor</code>æ¥å£çš„éƒ¨ç½²åˆ°å…¶ä¸­çš„æ‰€æœ‰ beanã€‚</p><p>å…¶å®ç°ç±»åŒ…æ‹¬PropertyPlaceholderConfigurerã€PropertyOverrideConfigurerç­‰</p><p><a id="sucession-of-bean"></a></p><p><strong>beançš„ç»§æ‰¿</strong></p><p>beanä¹‹é—´ä¹Ÿå¯ä»¥æœ‰ç»§æ‰¿çš„å±‚æ¬¡å…³ç³»ï¼Œç»“åˆparentå…³é”®å­—ã€‚è®©å­beanç»§æ‰¿å¹¶å¯é‡å†™çˆ¶beançš„å±æ€§</p><p>è¿˜å¯é€šè¿‡abstractæŒ‡å®šè¯¥beanä¸ºæŠ½è±¡çš„ï¼ŒæŠ½è±¡çš„beanæ˜¯ä¸ä¼šåŠ è½½å®ä¾‹çš„ï¼Œä¸ä¼šé€šè¿‡getBean()å¾—åˆ°å®ä¾‹ã€‚<strong>æŠ½è±¡beanä¸»è¦ä½œç”¨æ˜¯ç”¨æ¥ä½œä¸ºæ¨¡æ¿</strong>ã€‚å£°æ˜æŠ½è±¡beanæ—¶å¯ä»¥ä¸åŒæŒ‡å®šå…¶ç±»ï¼Œä½†éœ€è¦åœ¨å­beanä¸­å£°æ˜</p><div class="code-wrapper"><pre class="language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>testObj<span class="token punctuation">"</span></span> <span class="token attr-name">abstract</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>map<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>props</span><span class="token punctuation">></span></span>               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prop</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>n1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>nnn1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prop</span><span class="token punctuation">></span></span>               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prop</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>n2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>nnn2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prop</span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>props</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>child<span class="token punctuation">"</span></span> <span class="token attr-name">parent</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>testObj<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.pplong.dao.TestObj<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>zyl<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>map<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>props</span><span class="token punctuation">></span></span>               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>prop</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>n2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>nnn3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>prop</span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>props</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span></code></pre></div><h4 id="åŸºäºæ³¨è§£çš„å®¹å™¨é…ç½®">åŸºäºæ³¨è§£çš„å®¹å™¨é…ç½®</h4><p>é€šè¿‡å…¶<a href="https://www.docs4dev.com/docs/zh/spring-framework/5.1.3.RELEASE/reference/core.html#beans-java">JavaConfig</a>é€‰é¡¹ï¼ŒSpring å…è®¸ä»¥éä¾µå…¥æ–¹å¼ä½¿ç”¨ æ³¨è§£ï¼Œè€Œæ— éœ€æ¥è§¦ç›®æ ‡ç»„ä»¶çš„æºä»£ç ï¼Œä½¿ç”¨<code>&lt;context:annotation-config/&gt;</code>é…ç½®åœ¨XMLæ–‡ä»¶ä¸­</p><ul><li>@Requiredï¼šå¿…é¡»æ˜¾å¼åœ°é…ç½®å±æ€§</li><li>@Autowiredï¼š<ul><li>åº”ç”¨äºæ„é€ å‡½æ•°ä¸Š</li><li>åº”ç”¨äºâ€œä¼ ç»Ÿâ€ setter æ–¹æ³•</li><li>åº”ç”¨äºå…·æœ‰ä»»æ„åç§°å’Œå¤šä¸ªå‚æ•°çš„æ–¹æ³•</li><li>åº”ç”¨äºå­—æ®µï¼Œç”šè‡³å°†å…¶ä¸æ„é€ å‡½æ•°æ··åˆä½¿ç”¨</li></ul></li><li>@Primaryï¼šæŒ‰ç±»å‹è‡ªåŠ¨å¸ƒçº¿å¯èƒ½ä¼šå¯¼è‡´å¤šä¸ªå€™é€‰å¯¹è±¡ï¼Œå› æ­¤é€šå¸¸æœ‰å¿…è¦å¯¹é€‰æ‹©è¿‡ç¨‹è¿›è¡Œæ›´å¤šæ§åˆ¶ã€‚è¡¨ç¤ºå½“å¤šä¸ª bean å¯ä»¥è‡ªåŠ¨è¿æ¥åˆ°å•å€¼ä¾èµ–é¡¹çš„å€™é€‰å¯¹è±¡æ—¶ï¼Œåº”ä¼˜å…ˆè€ƒè™‘ç‰¹å®šçš„ beanã€‚ç”¨äºæ„é€ å‡½æ•°ä¸Š</li><li>@Qualifierï¼šå°†é™å®šç¬¦å€¼ä¸ç‰¹å®šçš„å‚æ•°ç›¸å…³è”ï¼Œä»è€Œç¼©å°ç±»å‹åŒ¹é…çš„èŒƒå›´ï¼Œä»¥ä¾¿<strong>ä¸ºæ¯ä¸ªå‚æ•°é€‰æ‹©ç‰¹å®šçš„ bean</strong></li><li>@Resourceï¼šæŒ‡å®šæ³¨å…¥çš„beançš„åç§°ï¼Œè‹¥æœªæŒ‡å®šåˆ™é‡‡ç”¨é»˜è®¤å</li><li>@PostConstruct ä¸ @PreDestroy</li></ul><h4 id="ClassPathæ‰«æå’Œæ‰˜ç®¡ç»„ä»¶">ClassPathæ‰«æå’Œæ‰˜ç®¡ç»„ä»¶</h4><p>é€šè¿‡æ‰«æ Classpath æ¥éšå¼æ£€æµ‹å€™é€‰ç»„ä»¶çš„é€‰é¡¹ã€‚å€™é€‰ç»„ä»¶æ˜¯ä¸è¿‡æ»¤æ¡ä»¶åŒ¹é…çš„ç±»ï¼Œå¹¶åœ¨å®¹å™¨ä¸­æ³¨å†Œäº†ç›¸åº”çš„ Bean å®šä¹‰ã€‚è¿™æ¶ˆé™¤äº†ä½¿ç”¨ XML è¿›è¡Œ bean æ³¨å†Œçš„éœ€è¦ã€‚</p><p>Spring æä¾›äº†è¿›ä¸€æ­¥çš„æ„é€ å‹ æ³¨è§£ï¼š<code>@Component</code>ï¼Œ<code>@Service</code>å’Œ<code>@Controller</code>ã€‚ <code>@Component</code>æ˜¯ä»»ä½• Springç®¡ç†ç»„ä»¶çš„é€šç”¨æ„é€ å‹ã€‚</p><p><strong>è‡ªåŠ¨æ£€æµ‹ç±»å¹¶æ³¨å†Œ Bean å®šä¹‰</strong></p><p>å‘<code>ApplicationContext</code>æ³¨å†Œç›¸åº”çš„<code>BeanDefinition</code>å®ä¾‹ï¼Œå°†<code>@ComponentScan</code>æ·»åŠ åˆ°<code>@Configuration</code>ç±»ä¸­ï¼Œå…¶ä¸­<code>basePackages</code>å±æ€§æ˜¯ä¸¤ä¸ªç±»çš„å…¬å…±çˆ¶åŒ…ï¼ŒSpingä¼šè‡ªåŠ¨æ‰«æè¿™äº›Componentç»„ä»¶beanå¹¶è¿›è¡Œæ³¨å†Œ</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>basePackages <span class="token operator">=</span> <span class="token string">"org.example"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppConfig</span>  <span class="token punctuation">&#123;</span>   <span class="token comment">// ...</span><span class="token punctuation">&#125;</span></code></pre></div><p>ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨<code>  &lt;context:component-scan base-package=&quot;org.example&quot;/&gt;</code></p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå”¯ä¸€æ£€æµ‹åˆ°çš„å€™é€‰ç»„ä»¶æ˜¯ç”¨<code>@Component</code>ï¼Œ<code>@Repository</code>ï¼Œ<code>@Service</code>ï¼Œ<code>@Controller</code>æ³¨è§£ çš„ç±»æˆ–æœ¬èº«ç”¨<code>@Component</code>æ³¨è§£ çš„å®šåˆ¶ æ³¨è§£ã€‚å¯ä»¥é€šè¿‡åº”ç”¨è‡ªå®šä¹‰è¿‡æ»¤å™¨æ¥ä¿®æ”¹å’Œæ‰©å±•æ­¤è¡Œä¸ºã€‚å°†å®ƒä»¬æ·»åŠ ä¸º<code>@ComponentScan</code>æ³¨è§£çš„<code>includeFilters</code>æˆ–<code>excludeFilters</code>å‚æ•°(æˆ–<code>component-scan</code>å…ƒç´ çš„<code>include-filter</code>æˆ–<code>exclude-filter</code>å­å…ƒç´ )ã€‚æ¯ä¸ªè¿‡æ»¤å™¨å…ƒç´ éƒ½éœ€è¦<code>type</code>å’Œ<code>expression</code>å±æ€§</p><h1>ä½¿ç”¨</h1><h2 id="åŸºç¡€-v4">åŸºç¡€</h2><h3 id="é…ç½®bean">é…ç½®bean</h3><p><a id="demo-application-bean-01"></a></p><p><strong>é€šè¿‡ClassPathXmlæ¥å®šä¹‰ApplicationContextè¿›è€Œå®šä¹‰beançš„å®ä¾‹</strong></p><div class="code-wrapper"><pre class="language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!-- beans.xml --></span><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>       <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans        http://www.springframework.org/schema/beans/spring-beans.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>testObj<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.pplong.dao.TestObj<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>zyl<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>age<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">></span></span></code></pre></div><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">ApplicationContext</span> context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token string">"beans.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">TestObj</span> testObj <span class="token operator">=</span>  context<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">"testObj"</span><span class="token punctuation">,</span> <span class="token class-name">TestObj</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p>å¯ä»¥çœ‹åˆ°åœ¨Xmlä¸­èƒ½å¤Ÿé…ç½®æŒ‡å®šclassçš„beanå¹¶ä¸”é€šè¿‡æ„é€ å™¨ä¸å±æ€§èƒ½ä¸ºå…¶èµ‹å€¼ï¼Œæœ€ç»ˆé€šè¿‡context.getBean(targetId)æ¥è·å–æŒ‡å®šidä¸‹çš„beanå¯¹è±¡</p><p>ä¹Ÿå¯ä»¥é€šè¿‡importå°†å¤šä¸ªXMLæ–‡ä»¶è¿›è¡Œæ•´åˆï¼Œä½†æ‰€æœ‰å¯¼å…¥çš„è·¯å¾„éƒ½è¦ç›¸å¯¹äºè¿›è¡Œå¯¼å…¥çš„å®šä¹‰æ–‡ä»¶</p><div class="note note-warning">            <p>âš ï¸ å¯ä»¥ä½†ä¸å»ºè®®ä½¿ç”¨ç›¸å¯¹çš„â€œ â€¦/â€è·¯å¾„å¼•ç”¨çˆ¶ç›®å½•ä¸­çš„æ–‡ä»¶ã€‚è¿™æ ·åšä¼šåˆ›å»ºå¯¹å½“å‰åº”ç”¨ç¨‹åºå¤–éƒ¨æ–‡ä»¶çš„ä¾èµ–å…³ç³»ã€‚ç‰¹åˆ«æ˜¯ï¼Œä¸å»ºè®®å¯¹<code>classpath:</code> URL(ä¾‹å¦‚<code>classpath:../services.xml</code>)ä½¿ç”¨æ­¤å¼•ç”¨ï¼Œåœ¨ URL ä¸­ï¼Œè¿è¡Œæ—¶è§£æè¿‡ç¨‹é€‰æ‹©â€œæœ€è¿‘â€Classpath æ ¹ï¼Œç„¶åæŸ¥çœ‹å…¶çˆ¶ç›®å½•ã€‚Classpath é…ç½®çš„æ›´æ”¹å¯èƒ½å¯¼è‡´é€‰æ‹©å…¶ä»–é”™è¯¯çš„ç›®å½•ã€‚</p>          </div><p>ä¹Ÿå¯ä»¥é€šè¿‡é™æ€æ–¹æ³•è¿›è¡Œæ³¨å…¥ï¼Œä¸è¿‡éœ€è¦é€šè¿‡<code>factory-method</code>å£°æ˜é™æ€æ–¹æ³•åï¼Œå¹¶ä¸”é™æ€æ–¹æ³•çš„ å‚æ•°ç”±<code>&lt;constructor-arg/&gt;</code>æŒ‡å‡º</p><div class="code-wrapper"><pre class="language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>exampleBean<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>examples.ExampleBean<span class="token punctuation">"</span></span> <span class="token attr-name">factory-method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>createInstance<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>anotherExampleBean<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>yetAnotherBean<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span></code></pre></div><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ExampleBean</span> createInstance <span class="token punctuation">(</span>    <span class="token class-name">AnotherBean</span> anotherBean<span class="token punctuation">,</span> <span class="token class-name">YetAnotherBean</span> yetAnotherBean<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">ExampleBean</span> eb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExampleBean</span> <span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// some other operations...</span>    <span class="token keyword">return</span> eb<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><div class="note note-primary">            <p>ğŸ”— å‚è€ƒæ–‡ç« :</p><ul><li>ğŸ“– <a href="https://docs.spring.io/spring-framework/docs/current/reference/html/">Spring-Framework Reference</a></li><li>ğŸ“– <a href="https://www.docs4dev.com/docs/zh/spring-framework/5.1.3.RELEASE/reference/core.html">Spring Framework ä¸­æ–‡æ–‡æ¡£ </a></li><li>ğŸ“– <a href="https://en.wikipedia.org/wiki/Aspect-oriented_programming">Wiki - Aspect-oriented programming</a></li><li>ğŸ“– <a href="https://www.liaoxuefeng.com/wiki/1252599548343744/1266265125480448">ä½¿ç”¨AOP- å»–é›ªå³°çš„å®˜æ–¹ç½‘ç«™</a></li><li>ğŸ“– <a href="https://zhuanlan.zhihu.com/p/33492169">æµ…è°ˆæ§åˆ¶åè½¬ä¸ä¾èµ–æ³¨å…¥</a></li><li>ğŸ“– <a href="https://www.qikegu.com/docs/1541">ç†è§£ä¾èµ–æ³¨å…¥ï¼ˆDI â€“ Dependency Injectionï¼‰</a></li></ul>          </div>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>Spring</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CSRFä»‹ç»</title>
    <link href="/2022/05/04/CSRF%E4%BB%8B%E7%BB%8D/"/>
    <url>/2022/05/04/CSRF%E4%BB%8B%E7%BB%8D/</url>
    
    <content type="html"><![CDATA[<h1>CSRFä»‹ç»</h1><blockquote><p>çœ‹äº†CORSå’ŒSOPåè¿˜æƒ³ç»§ç»­äº†è§£ä¸€ä¸‹Webå®‰å…¨çš„ä¸€äº›æ”»é˜²ï¼Œæ€•ä»¥åæ­å»ºåç«¯çš„æ—¶å€™å¯èƒ½ä¼šæœ‰å‘ï¼Œè¿™é‡Œå…ˆå…¥ä¸ªé—¨</p></blockquote><h2 id="ä»‹ç»">ä»‹ç»</h2><p><strong>Cross-Site Request Forgery è·¨ç«™è¯·æ±‚ä¼ªé€ </strong>ï¼Œä¹Ÿå¯ç§°ä¸ºâ€œOne  Click Attackâ€ æˆ–è€… â€œSession Ridingâ€ã€‚é€šè¿‡ä¼ªè£…ç½‘ç«™å—ä¿¡ä»»çš„ç”¨æˆ·å‘é€çš„è¯·æ±‚æ¥ç ´åæ•°æ®</p><p><strong>å¼•å…¥</strong></p><p><strong>ä¸ºä»€ä¹ˆä¼šå‘ç”ŸCSRFæ”»å‡»ï¼Ÿ</strong> <strong>â€”â€”æµè§ˆå™¨çš„éšå¼è®¤è¯</strong></p><p>ä¸€èˆ¬ç½‘ç«™ä¸ä¼šç›´æ¥é€šè¿‡æ— Cookieçš„GETè¯·æ±‚æ¥ç›´æ¥ä¿®æ”¹å†…éƒ¨æ•°æ®ï¼Œè¿™ä¹Ÿæ˜¯ä¸æ¨èçš„åšæ³•ã€‚ä¸€èˆ¬éœ€è¦åœ¨ç½‘ç«™ç”¨æˆ·ç™»å½•åï¼Œåœ¨æœ¬åœ°æµè§ˆå™¨å’ŒæœåŠ¡å™¨ç«¯åˆ†åˆ«å­˜æœ‰æœ‰æ•ˆCookieå’ŒSessionçš„æƒ…å†µä¸‹ï¼Œè¯·æ±‚æºå¸¦Cookieæ‰èƒ½é€šè¿‡è®¤è¯ï¼Œè¿›è€Œä¿®æ”¹æ•°æ®ã€‚<br>è€Œåœ¨æœ¬åœ°å«æœ‰æŸåŸŸçš„Cookieçš„æƒ…å†µä¸‹ï¼Œå¯¹è¯¥åŸŸçš„è¯·æ±‚æµè§ˆå™¨ä¼šè‡ªåŠ¨æºå¸¦Cookieï¼ˆè€ŒCookieå…·æœ‰ä¸å¯è·¨åŸŸæ€§ï¼Œæ‰€ä»¥åœ¨ä¸åŒåŸŸä¸‹çš„è¯·æ±‚ä¸ä¼šæºå¸¦ä¸åŒçš„Cookieï¼‰</p><p><strong>è€ƒè™‘ä¸€ä¸ªåœºæ™¯ï¼š</strong></p><ul><li>æˆ‘åœ¨ç½‘ç«™AæˆåŠŸç™»å½•äº†è‡ªå·±çš„ç”¨æˆ·ï¼Œæœªæ³¨é”€</li><li>åœ¨Cookieçš„æœ‰æ•ˆæœŸå†…ï¼Œæˆ‘åœ¨åŒä¸€æµè§ˆå™¨çš„å¦ä¸€ä¸ªTabé¡µé¢å†…è®¿é—®äº†å¦ä¸€ä¸ªæ¶æ„ç½‘ç«™</li><li>å‡è®¾è¿™ä¸ªæ¶æ„ç½‘ç«™é€šè¿‡scriptæˆ–è€…imgçš„srcå‘é€POSTæˆ–è€…GETè¯·æ±‚ï¼ŒæŒ‡å‘äº†ç½‘ç«™A æ›´æ”¹ç”¨æˆ·æ•°æ®çš„æ“ä½œï¼ˆå› ä¸ºæµè§ˆå™¨éšå¼è®¤è¯çš„åŠŸèƒ½ï¼Œåœ¨Cookieå­˜åœ¨æ—¶è®¿é—®ç½‘ç«™ä¼šè‡ªåŠ¨æºå¸¦ä¸Šç½‘ç«™çš„Cookieï¼‰[ä»è€Œä½¿å¾—ç½‘ç«™Aè¯¯ä»¥ä¸ºæ˜¯ç”¨æˆ·è¿›è¡Œçš„æ“ä½œ]</li></ul><div class="note note-primary">            <p>ç”±äºæºå¸¦äº† Cookieï¼Œä¸”å‘é€äº†è·¨åŸŸçš„è¯·æ±‚ï¼ŒæœåŠ¡å™¨Access-Control-Allow-Originæ²¡æœ‰è®¾ç½®ä¸º* ï¼Œé‚£ä¹ˆä¸€å®šä¼šè§¦å‘SOPï¼Œé‚£ä¹ˆï¼š</p><p><strong>SOPèƒ½é™åˆ¶CRSFæ”»å‡»å—ï¼Ÿ</strong></p><p>ä¸èƒ½ï¼Œå› ä¸ºSOPåªæ˜¯æ‹¦æˆªäº†æœåŠ¡å™¨è¿”å›çš„ç›¸åº”ï¼Œä½†å‘å‡ºçš„è¯·æ±‚ä»ç„¶æ˜¯æˆåŠŸå¤„ç†çš„ï¼ˆå¯ä»¥çœ‹å“åº”ç è¿”å›çš„æ˜¯200ï¼‰ï¼Œå¯ä»¥è¿™æ ·ç†è§£ï¼šSOPæ˜¯å¯¹æµè§ˆå™¨ç”¨æˆ·åšäº†ä¿æŠ¤ï¼Œä½†å¹¶æ²¡æœ‰ä¸ºè¯·æ±‚çš„å¯¹è±¡åšä¿æŠ¤ã€‚ï¼ˆè¿™é‡Œè‡ªå·±æƒ³äº†å¾ˆä¹…ï¼Œä»¥ä¸ºSOPç›´æ¥æ‹¦æˆªäº†å®¢æˆ·ç«¯å‘å‡ºçš„è¯·æ±‚ï¼Œåæ¥å®éªŒæ‰å‘ç°åªæ˜¯æ‹¦æˆªäº†æœåŠ¡å™¨è¿”å›çš„å“åº”ï¼‰</p>          </div><h2 id="å®éªŒ">å®éªŒ</h2><p>æ­å»ºä¸€ä¸ªç®€æ˜“çš„åå°ç¯å¢ƒæ¨¡æ‹ŸæœåŠ¡å™¨ï¼Œé€šè¿‡å­˜å–Cookieæ¥è§‚å¯Ÿæ˜¯å¦å­˜åœ¨æµè§ˆå™¨çš„éšå¼è®¤è¯</p><blockquote><p>Utils : Tornado  Chrome</p></blockquote><p>æ€è·¯ï¼š</p><ul><li>é€šè¿‡ç›´æ¥æµè§ˆå™¨è®¿é—®æœåŠ¡å™¨ä¸€URLï¼Œå¤„ç†GETè¯·æ±‚ï¼Œå¹¶åœ¨æœåŠ¡ç«¯ä¸ºresponseå¡å…¥ä¸€ä¸ªè‡ªå®šä¹‰Cookie</li><li>ä¸æ¸…é™¤è¯¥Cookie ï¼Œè®¿é—®æ¶æ„ç½‘ç«™ï¼Œå…¶ä¸­æ¶æ„ç½‘ç«™çš„ScriptåŒ…å«ä¸€ä¸ªå‘é€åˆ°æœåŠ¡å™¨çš„POSTè¯·æ±‚</li><li>æŸ¥çœ‹è¯¥è¯·æ±‚æ˜¯å¦æºå¸¦å‰è€…çš„Cookie</li></ul><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">MainHandler</span><span class="token punctuation">(</span>tornado<span class="token punctuation">.</span>web<span class="token punctuation">.</span>RequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># å¤„ç†GETè¯·æ±‚, æ·»åŠ Cookie</span>    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>set_cookie<span class="token punctuation">(</span><span class="token string">'zyl'</span><span class="token punctuation">,</span> <span class="token string">'zzzzz'</span><span class="token punctuation">)</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220504101749696.png" alt="æ¨¡æ‹Ÿç™»å½•"></p><div class="code-wrapper"><pre class="language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">    <span class="token comment">// æœåŠ¡ç«¯å‘é€POSTè¯·æ±‚</span>    <span class="token keyword">var</span> xhr  <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"POST"</span><span class="token punctuation">,</span><span class="token string">"http://localhost:9002/post"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>    <span class="token keyword">var</span> postData <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string-property property">'name'</span><span class="token operator">:</span><span class="token string">'value'</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// é‡è¦, ä½¿å¾—å‘é€çš„è¯·æ±‚èƒ½å¤Ÿé™„å¸¦Cookieå‚æ•°</span>    xhr<span class="token punctuation">.</span>withCredentials <span class="token operator">=</span> <span class="token boolean">true</span>    xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>postData<span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œç”±æ¶æ„é¡µé¢å‘é€çš„è¯·æ±‚ç¡®å®æºå¸¦äº†ç›®æ ‡ç½‘ç«™çš„Cookieï¼Œè¿™é‡Œéœ€è¦åŒºåˆ†ä¸€ç‚¹çš„æ˜¯ï¼š<strong>æ¶æ„ç½‘ç«™æœ¬èº«å¹¶ä¸çŸ¥é“æœåŠ¡å™¨ä¿å­˜çš„æ­£å¸¸ç½‘ç«™çš„Cookieæ˜¯ä»€ä¹ˆ</strong>ï¼Œå®ƒåªæ˜¯åˆ©ç”¨äº†éšå¼è®¤è¯çš„ç‰¹ç‚¹ï¼Œé€šè¿‡æµè§ˆå™¨å‘é€äº†è¿™ä¸ªå¸¦æœ‰Cookieçš„è¯·æ±‚ã€‚è€ŒæœåŠ¡ç«¯æ°å¥½åˆè®¤ä¸ºï¼Œæ—¢ç„¶ä½ å¸¦äº†Cookieï¼Œé‚£ä½ è‚¯å®šæ˜¯å—ä¿¡ä»»çš„ï¼Œé‚£æˆ‘å°±å…è®¸è¿™ä¸ªæ“ä½œï¼Œç»“æœå°±ä¼šå¼•å‘æ‚²å‰§â€¦</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220504101917870.png" alt="æ¶æ„é¡µé¢ä¸­å‘æœåŠ¡ç«¯å‘é€çš„POSTè¯·æ±‚"></p><div class="note note-warning">            <p><strong>ä¸€ä¸ªè¶…çº§è¶…çº§è¶…çº§å°çš„å‘</strong></p><p>æ€ªè‡ªå·±å¯¹HTTPè¯·æ±‚å„ç§å‚æ•°å’ŒXHRé…ç½®ä¸ç†Ÿæ‚‰ï¼Œè¿™é‡Œå…¶å®æœ€å¼€å§‹ä½¿ç”¨çš„æ˜¯img srcçš„è¯·æ±‚åµŒå…¥æ²¡æœ‰è§‚å¯Ÿåˆ°æµè§ˆå™¨æœ‰é™„å¸¦Cookieï¼Œç„¶åä½¿ç”¨XHRå‘é€POSTè¯·æ±‚ä¹Ÿæ²¡æœ‰è§‚å¯Ÿåˆ°ï¼Œå…¶å®æ˜¯<strong>å› ä¸ºXHRæ²¡æœ‰é…ç½®withCredentials = true</strong>ï¼Œå¯¼è‡´è¯·æ±‚æœ¬èº«æ²¡æœ‰æºå¸¦Cookieï¼Œå¡äº†å¾ˆä¹…â€¦ï¼ˆå› ä¸ºè‡ªå·±ä¸€ç›´åœ¨æƒ³ï¼Œæˆ‘æœåŠ¡ç«¯æ˜¯ä¸æ˜¯å‡ºäº†ä»€ä¹ˆé—®é¢˜æ‰å¯¼è‡´ä¸èƒ½è¯·æ±‚ä¸æºå¸¦Cookieï¼Ÿä½†å…¶å®æœåŠ¡ç«¯æœ¬èº«æ²¡æœ‰é”™ï¼Œé—®é¢˜æ˜¯åœ¨æ¶æ„ç½‘ç«™ï¼Œå› ä¸ºæ˜¯æ¶æ„ç½‘ç«™å‘å‡ºçš„è¯·æ±‚ï¼Œæ‰€ä»¥æ¶æ„ç½‘ç«™ä¼šæƒ³å°½åŠæ³•è®©æµè§ˆå™¨å¸¦ä¸ŠCookieï¼‰</p><p>XHRçš„å‘é€è¯·æ±‚çš„Cookieæºå¸¦é—®é¢˜è§£å†³äº†ï¼Œä½†é€šè¿‡imgçš„srcè¯·æ±‚è¿˜æ˜¯ä¸èƒ½éªŒè¯å¸¦æœ‰Cookieï¼Œè¿™é‡Œè¿˜å­˜æœ‰ç–‘æƒ‘â“</p>          </div><h2 id="å¦‚ä½•é˜²èŒƒ">å¦‚ä½•é˜²èŒƒ</h2><h3 id="ReferreréªŒè¯">ReferreréªŒè¯</h3><p>åœ¨è¯·æ±‚ä½“ä¸­åŠ å…¥Referrerçš„éªŒè¯ï¼Œåˆ¤æ–­æ˜¯å¦æ˜¯ä»æŒ‡å®šçš„ç½‘ç«™å‘é€çš„è¯·æ±‚ï¼Œä¸è¿‡Referrerä½œä¸ºè¯·æ±‚å¤´å¯ä»¥æ›´æ”¹ï¼Œæ‰€ä»¥åªèƒ½è¿‡æ»¤ä¸€äº›ä½çº§çš„æ”»å‡»</p><h3 id="éªŒè¯ç åˆ¤æ–­">éªŒè¯ç åˆ¤æ–­</h3><p>å¾ˆå¤šçš„ç½‘ç«™åœ¨è¿›è¡Œå…³é”®æ“ä½œæ—¶éƒ½éœ€è¦è¿›è¡ŒéªŒè¯ç åˆ¤æ–­ï¼Œå°±æ˜¯ä¸ºäº†ç¡®ä¿ä½ åšçš„æ“ä½œä¸€å®šæ˜¯äººå·¥è¿›è¡Œçš„è€Œéæœºå™¨è¯·æ±‚ï¼Œä¸€æ˜¯ä¸ºäº†é˜²æ­¢ä½ è¿‡åº¦è¯·æ±‚ï¼Œå‡å°‘æ•°æ®åº“å‹åŠ›ï¼ŒäºŒæ˜¯ç¡®ä¿è¿™ä¸ªè¯·æ±‚ç¡®å®æ˜¯ä½ å‘å‡ºçš„ï¼ˆä¾‹å¦‚åˆ é™¤ä¸ªäººä¿¡æ¯ç­‰ï¼‰ï¼Œè€Œéæ¶æ„ç½‘ç«™å‘å‡º</p><h3 id="Anti-CSRF-Tokenï¼ˆå¸¸ç”¨ï¼‰">Anti CSRF Tokenï¼ˆå¸¸ç”¨ï¼‰</h3><p>åœ¨è®¸å¤šè¯·æ±‚ä½“ä¸­ï¼Œå¯èƒ½éƒ½ä¼šè§åˆ°csrf-tokenç±»ä¼¼è¿™æ ·çš„è¯·æ±‚å¤´ã€‚æœåŠ¡ç«¯åœ¨ç”Ÿæˆé¡µé¢æˆ–è€…è¯·æ±‚æ—¶ä¼šç»™ä¸€ä¸ªTokenï¼Œï¼ˆåœ¨é¡µé¢ä¸­æ”¾åœ¨Headå¤„ï¼‰ï¼Œå¹¶ä¸”åœ¨æ¯æ¬¡é‡æ–°æ—¶éƒ½ä¸ä¸€æ ·ï¼Œå‘é€è¯·æ±‚æ—¶ä¼šå‘é€è¿™ä¸ªTokenï¼Œåœ¨æœåŠ¡å™¨è¿‡æ»¤å™¨ä¸­ä¼šéªŒè¯è¿™ä¸ªTokenï¼Œ<strong>éªŒè¯æˆåŠŸåå°±ä¼šé”€æ¯æ‰</strong></p><p>ç”±äºç½‘é¡µå‘é€è¯·æ±‚æ—¶ä¼šå»æ‰¾head metaä¸­çš„csrf-tokenå¹¶è£…è¿›è¯·æ±‚å¤´ä¸­ï¼Œæ¶æ„ç½‘ç«™å»ä¼ªé€ è¯·æ±‚æ—¶å´è·å–ä¸åˆ°è¿™ä¸ªå€¼ï¼ˆæ— æ³•è¿›å…¥é¡µé¢å»å–headå€¼ï¼Œä¹Ÿä¸èƒ½é¢„æµ‹åˆ°tokençš„å€¼ï¼‰ï¼Œæ‰€ä»¥å°±èƒ½å¤ŸæˆåŠŸçš„è¿›è¡Œé˜²å¾¡</p><p>æœªå®Œâ€¦</p>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Web</tag>
      
      <tag>Web Security</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Pythonçˆ¬è™«æ¡ˆä¾‹æ•´åˆ</title>
    <link href="/2022/04/30/Python%E7%88%AC%E8%99%AB%E6%A1%88%E4%BE%8B%E6%95%B4%E5%90%88/"/>
    <url>/2022/04/30/Python%E7%88%AC%E8%99%AB%E6%A1%88%E4%BE%8B%E6%95%B4%E5%90%88/</url>
    
    <content type="html"><![CDATA[<h1>Pythonçˆ¬è™«æ¡ˆä¾‹æ•´åˆ</h1><blockquote><p>æ•´åˆä¸€ä¸‹è‡ªå·±å†™çš„ä¸€äº›çˆ¬è™«æ¡ˆä¾‹ï¼Œæ¶‰åŠä¸€äº›å¸¸è§çš„åçˆ¬æœºåˆ¶å’Œæ€è·¯æ¢³ç†</p></blockquote><p>Githubä»“åº“åœ°å€ï¼š<a href="https://github.com/PPLong222/PythonSpiderCases">PythonSpiderCases</a></p><h2 id="æ¨±èŠ±åŠ¨æ¼«ç½‘ç«™è§†é¢‘çˆ¬å–">æ¨±èŠ±åŠ¨æ¼«ç½‘ç«™è§†é¢‘çˆ¬å–</h2><p>(æ¨±èŠ±åŠ¨æ¼«)[<a href="http://dmh8.com">http://dmh8.com</a>]</p><p><img src="/home/pplong/.config/Typora/typora-user-images/image-20220430230303132.png" alt="image-20220430230303132"></p><p>ä¸€ç›´æƒ³åšä¸€ä¸ªè‡ªåŠ¨æ›´æ–°è¿½ç•ªçš„é¢˜å‹ï¼Œä»¥åŠåšä¸€ä¸ªç®€æ˜“çš„æœç´¢çˆ¬å–ã€‚</p><ul><li>Version 1ï¼š<ul><li>æ”¯æŒåœ¨æœ¬åœ°è¾“å…¥åç§°æŸ¥è¯¢ï¼Œè·å–å¯¹åº”çš„åç§°åˆ—è¡¨ï¼Œé€‰æ‹©åºå·ï¼Œå¹¶è·å–å¯¹åº”çš„URLï¼Œè·å–è¯¥ç•ªå‰§çš„é›†æ•°å¹¶ä¸‹è½½æŒ‡å®šé›†æ•°èŒƒå›´çš„è§†é¢‘ï¼Œåˆå¹¶åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­</li><li>æ”¯æŒå¯¹ç½‘é¡µéªŒè¯ç çš„è§£æï¼ˆAPIå¼•å…¥ ï¼Œå­˜åœ¨ä½¿ç”¨æ¬¡æ•°é™åˆ¶ï¼‰</li><li>æ”¯æŒå¯¹ä¸‹è½½çš„m3u8è§†é¢‘è¿›è¡ŒAES-128è§£ç </li></ul></li></ul><h3 id="åˆ†æ">åˆ†æ</h3><p><strong>ç±»å‹</strong>ï¼šè¿™æ˜¯ä¸€ç§å…¸å‹çš„<strong>å¸¦åŠ å¯†ç±»å‹</strong>ã€äºŒæ¬¡ç´¢å¼•ã€<strong>m3u8è§†é¢‘æ ¼å¼</strong>çš„åœ¨çº¿è§†é¢‘ç½‘ç«™ï¼Œéå¸¸å…¸å‹ï¼Œè®¸å¤šå›½å†…è®¸å¤šçš„ç½‘ç«™éƒ½ç”¨çš„è¿™ç§æ ¼å¼ã€‚</p><h4 id="å…¥æ‰‹">å…¥æ‰‹</h4><p>å¯ä»¥å­¦ä¹ çš„æ€è·¯ï¼šçˆ¬è™«åˆ†ææ—¶ï¼Œå…ˆ<strong>ä»å†…åˆ°å¤–</strong>ã€‚å³<strong>å…ˆçˆ¬å–è‡ªå·±æœ€æƒ³è¦çš„æ•°æ®ï¼Œç„¶åå†ç”±å†…åˆ°å¤–ï¼Œæ‰©å±•åˆ°ä¸å¤ªéœ€è¦çš„è¾¹ç¼˜æ¨¡å—</strong>ã€‚è¿™é‡Œæˆ‘æœ€æƒ³è¦çš„å°±æ˜¯è·å–è§†é¢‘çš„ä¸€é›†ï¼Œæ‰€ä»¥æˆ‘ç›´æ¥è¿›å…¥åˆ°è§†é¢‘æ’­æ”¾é¡µé¢çœ‹ã€‚</p><ol><li>è€æ­¥éª¤ï¼Œå…ˆçœ‹HTMLæ˜¯å¦æœ‰video srcï¼Œå½“ç„¶è‚¯å®šä¸ä¼šæœ‰çš„ï¼Œå‘ç°åˆ™æ˜¯é€šè¿‡jsåŠ¨æ€åŠ è½½çš„ã€‚åˆçœ‹XHRè¯·æ±‚ï¼Œå‘ç°æ˜¯å¾ˆå¤šçš„tsæ–‡ä»¶è¯·æ±‚å’Œä¸¤ä¸ªä¸»è¦çš„m3u8è¯·æ±‚<img src="/home/pplong/.config/Typora/typora-user-images/image-20220430232928248.png" alt="image-20220430232928248">ï¼Œä¸€ä¸ªm3u8å¼•å‡ºä¸»è¦çš„m3u8åœ°å€ï¼Œè€Œè¿™ä¸ªä¸»è¦çš„m3u8æ–‡ä»¶åˆ™æ˜¯çœŸæ­£çš„è§†é¢‘m3u8æ–‡ä»¶ï¼ŒæŒ‡ç¤ºæ‰€æœ‰tsè¯·æ±‚ï¼Œæ‰€ä»¥è¦æº¯æºæ‰¾åˆ°æœ€ä¸»è¦çš„m3u8æ–‡ä»¶è¯·æ±‚çš„åœ°å€</li><li>ç„¶åæŸ¥çœ‹ChromeåŠ è½½åå¸¦Scriptçš„HTMLï¼Œå‘ç°å…¶å®videoæ ‡ç­¾åµŒå…¥äº†ä¸€å±‚<strong>iframe</strong>ä¸­ï¼Œè¿™ä¹Ÿæ˜¯ä¸€èˆ¬åŒç±»å‹ç½‘ç«™æ¯”è¾ƒå¸¸ç”¨çš„åŠ è½½æ–¹æ³•</li><li>æ‰€ä»¥åˆè¿”å›åœ¨HTMLæºä»£ç é¡µé¢æŸ¥çœ‹æ˜¯å¦æœ‰iframeæ ‡ç­¾ï¼Œè¿™é‡Œå…¶å®å‘ç°äº†iframeæ ‡ç­¾ä½†æ²¡æ‰¾åˆ°å…·ä½“çš„srcæŒ‡å‘ã€‚åæ¥é€šè¿‡Chrome è°ƒç”¨æ ˆè°ƒè¯•æ‰æ‰¾åˆ°æºå¤´ï¼Œå…¶å®iframeçš„srcä¹Ÿæ˜¯å†™æ­»åœ¨äº†htmlä¸­çš„ï¼Œåªæ˜¯é€šè¿‡å˜é‡å½¢å¼è—åœ¨äº†å¦ä¸€ä¸ªscriptæ ‡ç­¾ä¸‹ã€‚è¿™é‡Œä¹Ÿæ˜¯éš¾æ‰¾çš„ç‚¹ï¼Œå³ï¼šæˆ‘åœ¨å‰é¢å¼•å…¥äº†ä¸€ä¸ªæ— å…³å˜é‡ï¼Œé€šè¿‡åé¢çš„jsä»£ç å»è°ƒç”¨è¿™ä¸ªå˜é‡ï¼Œæº¯æºæ—¶å°±æ¯”è¾ƒéš¾æ‰¾ã€‚<br>è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªç›²ç‚¹ï¼Œéƒ¨åˆ†scriptä»£ç ç›´æ¥å†™åœ¨äº†divä¸­ï¼Œè€Œæ²¡æœ‰scriptæ ‡ç­¾åŒ…è£¹ï¼Œä¼°è®¡å¯èƒ½ä¼šæ¶‰åŠåˆ°åŠ¨æ€çš„å–å‡ºæ ‡ç­¾å¹¶è½¬æ¢æˆä»£ç ï¼ˆä½†æœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿï¼‰</li><li>æ­£åˆ™è¡¨è¾¾å¼æå–åˆ°è¿™ä¸ªurlåï¼Œè¯·æ±‚ï¼Œå¹¶è¿”å›åŒ…å«æ‰€æœ‰tsè¯·æ±‚çš„m3u8æ–‡ä»¶ï¼Œå­˜åˆ°æœ¬åœ°ï¼Œç„¶åå¯¹æ¯ä¸ªtsæ–‡ä»¶ä¸‹è½½å¹¶å­˜å…¥åˆ°æœ¬åœ°<ul><li>æ³¨æ„éƒ¨åˆ†è§†é¢‘ä¼šå¯¹tsæ–‡ä»¶è¿›è¡ŒåŠ å¯†ï¼Œè¦åˆ¤æ–­ä¸»è¦m3u8æ–‡ä»¶ä¸­æ˜¯å¦åŒ…å«Keyçš„urlï¼Œå¦‚æœæœ‰åˆ™è¦æå–keyå¹¶å¯¹æ¯ä¸ªtsæ–‡ä»¶è¿›è¡Œå¯¹åº”çš„è§£å¯†ï¼Œè¿™é‡Œåˆ™æ˜¯AES-128</li><li>å¯¹æ¯ä¸ªtsæ–‡ä»¶åˆå¹¶ï¼ˆé¡ºåºä¾ç…§index.m3u8çš„æŒ‡ç¤ºé¡ºåºï¼‰ï¼Œæ¯”è¾ƒç¥å¥‡çš„æ˜¯ï¼Œå±…ç„¶å¯ä»¥ç›´æ¥ cat a b c â€¦ &gt; test.tsé€šè¿‡è¿™ç§æ–¹å¼ç›´æ¥æ•´åˆè§†é¢‘ï¼Œä½†ä¼¼ä¹ä¸€äº›æ’­æ”¾å™¨ä¸æ”¯æŒtsæ–‡ä»¶çš„æ’­æ”¾ï¼Œç›®å‰å¯ä»¥æ’­æ”¾çš„æ˜¯mpvæ’­æ”¾å™¨ğŸ‘</li></ul></li><li>ä¼˜åŒ–ï¼šå¼‚æ­¥å¼•å…¥ã€‚å› ä¸ºå¯¹æ¯ä¸€tsæ–‡ä»¶çš„è¯·æ±‚å’Œå­˜å…¥æœ¬åœ°çš„æ“ä½œå¯ä»¥æ˜¯å¼‚æ­¥çš„ï¼ˆæœ€åæ•´åˆæ˜¯éƒ½ä¸‹è½½å®Œæˆä¹‹åæ‰æ•´åˆï¼‰</li></ol><p>åˆ°è¿™é‡Œï¼Œä¸€é›†çš„è§†é¢‘çš„æŠ“å–å°±å®Œæˆäº†ï¼Œä½†ç¼ºç‚¹æ˜¯å¿…é¡»æä¾›å¯¹åº”ç•ªå‰§çš„å¯¹åº”é›†æ•°çš„URLï¼Œæ‰€ä»¥ä¸‹ä¸€æ­¥æ‹“å±•åº”è¯¥æ˜¯é€šè¿‡å…·ä½“è§†é¢‘é¡µé¢è·å–æ‰€æœ‰é›†æ•°ï¼Œå¹¶æŒ‡ç¤ºå‡ºå¯¹åº”é›†æ•°çš„URL</p><div class="note note-warning">            <p><strong>å‘ç‚¹</strong>ï¼šéœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œå¯¹ä¸€äº›æƒ…å†µæˆ–è€…ä¸€äº›å…¶ä»–ç½‘ç«™ï¼Œæœ‰æ—¶å€™ä¼šå­˜åœ¨å¯¹æŸä¸€tsè¯·æ±‚æœªå“åº”çš„æƒ…å†µï¼Œæœ€å¼€å§‹è€ƒè™‘æ˜¯ä»£ç†çš„é—®é¢˜ï¼Œåæ¥ä¸€æ®µæ—¶é—´ååˆæ²¡é—®é¢˜ã€‚åˆè€ƒè™‘æ˜¯æœåŠ¡å™¨ç«¯çš„ä¸»åŠ¨æ‹‰é»‘ï¼Œä½†è§‰å¾—ä¸å¤ªå¯èƒ½ï¼Œå¯èƒ½è¿˜æ˜¯ç½‘ç»œæ³¢åŠ¨çš„é—®é¢˜ï¼Œå¦‚æœä¸å¤ªæ”¾å¿ƒè¿˜æ˜¯å¯ä»¥è®¾ç½®åœ¨æ€»è¯·æ±‚æ•°æ¯è¾¾åˆ°å¤šå°‘æ—¶sleepä¸€ä¸‹</p>          </div><h4 id="é›†æ•°">é›†æ•°</h4><p>åˆ°è¿™ä¸€æ­¥éœ€è¦æä¾›çš„urlå°±ä»å…·ä½“è§†é¢‘æŸä¸€é›†åˆ°å…·ä½“è§†é¢‘ä»‹ç»é¡µé¢çš„urlï¼Œå¹¶æä¾›å¯é€‰æ‹©çš„ä¸‹è½½å‚æ•°ï¼ˆä¾‹å¦‚ä¸‹è½½çš„å¼€å§‹é›†æ•°å’Œç»“æŸé›†æ•°ï¼‰ã€‚</p><p>åšæ³•è¿˜æ˜¯æ¯”è¾ƒç®€å•ï¼Œå› ä¸ºå¯å¾—çš„å†…å®¹éƒ½å†™æ­»åœ¨htmlä¸­ï¼Œæ‰€ä»¥ç›´æ¥é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼å»å–å°±è¡Œäº†ã€‚ä¸è¿‡å“äººçš„æ˜¯ï¼Œæœ‰äº›é›†æ•°æœ‰1000å¤šé›†ï¼Œåˆ™ç½‘é¡µä¸­å°±ç›´æ¥å¡äº†1000å¤šä¸ªblockï¼Œç¦»è°±</p><h4 id="æœç´¢">æœç´¢</h4><p>æœç´¢åº”è¯¥æ˜¯æ¯”è¾ƒæŠ€å·§çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿæ¶‰åŠåˆ°å¾ˆå¤šç½‘ç«™çš„éªŒè¯æœºåˆ¶ï¼Œåœ¨é¦–æ¬¡ä¸å¸¦Cookieæˆ–Cookieè¿‡æœŸçš„è¯·æ±‚ä¸‹æ˜¯ï¼Œæœç´¢ä¼šå¼¹å‡ºéªŒè¯ç è¾“å…¥æ¡†ï¼Œè¿™é‡Œæˆ‘çš„è§£å†³æ–¹æ¡ˆæ˜¯Selenium + Cookie</p><p>ä¸ºä»€ä¹ˆä¸ç»§ç»­ä½¿ç”¨ç›¸å¯¹è¾ƒå¿«requestè·å–é¡µé¢å¹¶å†æ¬¡è·å–éªŒè¯ç çš„å›¾ç‰‡å†å»è¯†åˆ«å‘¢ï¼Ÿå› ä¸ºè¿™é‡Œç½‘ç«™ç”¨çš„æ˜¯åŠ¨æ€å›¾ç‰‡çš„æœºåˆ¶ï¼Œå¸¦ä¸€ä¸ªrandomå‚æ•° ä¾‹å¦‚ <a href="http://www.dmh8.com/index.php/verify/index.html?r=0.21647202821721345%EF%BC%8C%E6%AF%8F%E6%AC%A1%E8%AF%B7%E6%B1%82%E7%9A%84%E5%9B%BE%E7%89%87%E9%83%BD%E4%B8%8D%E4%B8%80%E8%87%B4%EF%BC%8C%E4%B9%9F%E5%B0%B1%E6%98%AF%E6%88%91%E8%8E%B7%E5%8F%96%E5%88%B0%E4%BA%86%E9%A1%B5%E9%9D%A2%E5%9B%BE%E7%89%87%E7%9A%84url%EF%BC%8C%E4%BD%86%E6%98%AF%E5%86%8D%E6%AC%A1%E8%AF%B7%E6%B1%82%E6%98%AF%E5%8D%B4%E5%8F%91%E7%8E%B0%E6%98%AF%E5%8F%A6%E4%B8%80%E5%BC%A0%E5%9B%BE%E7%9A%84%E8%AF%B7%E6%B1%82%EF%BC%88%E5%8F%AF%E8%83%BD%E8%B7%9FTimeStamp%E6%9C%89%E5%85%B3%E7%B3%BB%EF%BC%89%EF%BC%8C%E6%89%80%E4%BB%A5%E8%BF%99%E7%A7%8D%E6%96%B9%E5%BC%8F%E4%B8%8D%E8%A1%8C%EF%BC%8C%E6%89%80%E4%BB%A5%E6%88%91%E9%80%89%E6%8B%A9%E6%98%AFSelenium+%E6%88%AA%E5%9B%BE%E7%9A%84%E6%96%B9%E5%BC%8F%EF%BC%8C%E5%B9%B6%E4%B8%94%E4%BF%9D%E5%AD%98%E5%BD%93%E5%89%8DCookie%E5%88%B0%E6%9C%AC%E5%9C%B0%EF%BC%8C%E6%96%B9%E4%BE%BF%E4%B8%8B%E6%AC%A1%E4%BD%BF%E7%94%A8">http://www.dmh8.com/index.php/verify/index.html?r=0.21647202821721345ï¼Œæ¯æ¬¡è¯·æ±‚çš„å›¾ç‰‡éƒ½ä¸ä¸€è‡´ï¼Œä¹Ÿå°±æ˜¯æˆ‘è·å–åˆ°äº†é¡µé¢å›¾ç‰‡çš„urlï¼Œä½†æ˜¯å†æ¬¡è¯·æ±‚æ˜¯å´å‘ç°æ˜¯å¦ä¸€å¼ å›¾çš„è¯·æ±‚ï¼ˆå¯èƒ½è·ŸTimeStampæœ‰å…³ç³»ï¼‰ï¼Œæ‰€ä»¥è¿™ç§æ–¹å¼ä¸è¡Œï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©æ˜¯Selenium+æˆªå›¾çš„æ–¹å¼ï¼Œå¹¶ä¸”ä¿å­˜å½“å‰Cookieåˆ°æœ¬åœ°ï¼Œæ–¹ä¾¿ä¸‹æ¬¡ä½¿ç”¨</a></p><ul><li><p>å…ˆå‘é€ä¸€ä¸ªé¢„è¯·æ±‚</p><ul><li>å¦‚æœæœ¬åœ°æœ‰Cookieï¼Œåˆ™æºå¸¦Cookieå»æ‰¾<ul><li>å¦‚æœæ²¡æœ‰æ˜¾ç¤ºéªŒè¯ç çš„blockå…ƒç´ ï¼Œé‚£å°±é€šè¿‡ã€‚</li><li>å¦‚æœæ˜¾ç¤ºäº†éªŒè¯ç çš„blockï¼Œåˆ™è¯æ˜Cookieè¿‡æœŸï¼Œåˆ™Seleniumå‘é€è¯·æ±‚</li></ul></li><li>å¦‚æœæœ¬åœ°æ— Cookieï¼Œåˆ™ç›´æ¥Seleniumå‘é€è¯·æ±‚</li></ul></li><li><p>SeleniuméªŒè¯ï¼š</p><ul><li><p>åˆ›å»ºä¸€ä¸ªdriverï¼Œè¯»å–è¾“å…¥æ¡†å¹¶ä¸”å†™å…¥è¦æŸ¥çš„å€¼å¹¶ä¸”å›è½¦ï¼Œè·³è½¬åˆ°éªŒè¯ç é¡µé¢åå¯¹é¡µé¢è¿›è¡Œæˆªå±ï¼Œç„¶åè·å–åˆ°éªŒè¯ç åœ¨htmlçš„åæ ‡å’Œå¤§å°ï¼Œå¯¹æˆªå›¾è¿›è¡Œè£å–ï¼Œä»¥è·å¾—éªŒè¯ç çš„å›¾ç‰‡ï¼Œå°†å›¾ç‰‡ä»¥äºŒè¿›åˆ¶å½¢å¼äº¤ç”±ç¬¬ä¸‰æ–¹éªŒè¯æ–¹API-- <em>è¶…çº§é¹°</em> æ¥åšéªŒè¯ï¼Œå°†è¿”å›çš„æ•°æ®å¡«å…¥inputæ¡†ä¸­ï¼Œå¹¶è¾“å…¥å›è½¦ã€‚ä¿å­˜cookie</p><p>æ³¨æ„è¿™é‡Œä¸€ä¸ªå‘ç‚¹ï¼š</p><p>Seleniumä¸­get_cookies()å¾—åˆ°çš„æ˜¯æ ‡å‡†çš„é”®å€¼å¯¹å½¢å¼ï¼Œä½†åœ¨Chromeä¸­å…¶å®Cookieæ˜¯ç»è¿‡è½¬åŒ–çš„</p><div class="code-wrapper"><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>'domain'<span class="token operator">:</span> '.www.dmh8.com'<span class="token punctuation">,</span> 'httpOnly'<span class="token operator">:</span> False<span class="token punctuation">,</span> 'name'<span class="token operator">:</span> 'Hm_lpvt_ea6972a9380e5a8a6607cc4c62409955'<span class="token punctuation">,</span> 'path'<span class="token operator">:</span> '/'<span class="token punctuation">,</span> 'secure'<span class="token operator">:</span> False<span class="token punctuation">,</span> 'value'<span class="token operator">:</span> '<span class="token number">1651335658</span>'<span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span>'domain'<span class="token operator">:</span> '.www.dmh8.com'<span class="token punctuation">,</span> 'expiry'<span class="token operator">:</span> <span class="token number">1682871658</span><span class="token punctuation">,</span> 'httpOnly'<span class="token operator">:</span> False<span class="token punctuation">,</span> 'name'<span class="token operator">:</span> 'Hm_lvt_ea6972a9380e5a8a6607cc4c62409955'<span class="token punctuation">,</span> 'path'<span class="token operator">:</span> '/'<span class="token punctuation">,</span> 'secure'<span class="token operator">:</span> False<span class="token punctuation">,</span> 'value'<span class="token operator">:</span> '<span class="token number">1651335658</span>'<span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span>'domain'<span class="token operator">:</span> 'www.dmh8.com'<span class="token punctuation">,</span> 'httpOnly'<span class="token operator">:</span> False<span class="token punctuation">,</span> 'name'<span class="token operator">:</span> 'PHPSESSID'<span class="token punctuation">,</span> 'path'<span class="token operator">:</span> '/'<span class="token punctuation">,</span> 'secure'<span class="token operator">:</span> False<span class="token punctuation">,</span> 'value'<span class="token operator">:</span> '550o7c1716kbh8gaqo8je29uo2'<span class="token punctuation">&#125;</span></code></pre></div><p><img src="/home/pplong/.config/Typora/typora-user-images/image-20220501002215451.png" alt="image-20220501002215451"></p><p>æ‰€ä»¥è¦å°†jsonè½¬åŒ–ä¸ºå¯¹åº”çš„å­—ç¬¦ä¸²æ ¼å¼</p></li></ul></li><li><p>å‘é€requestè¯·æ±‚ï¼šå¸¦ä¸Šåˆšåˆšè·å¾—çš„Cookieå»è¿›è¡Œæœç´¢requestè§£æè¿”å›çš„HTMLé¡µé¢ï¼Œå°†è·å¾—çš„ç»“æœå’Œå¯¹åº”çš„urlé€šè¿‡æ­£åˆ™è¡¨è¾¾å¼æå–ï¼Œè¿”å›listå½¢å¼ã€‚</p><ul><li>TODOï¼šç›®å‰åªæ”¯æŒä¸€é¡µçš„æœç´¢ç»“æœï¼ˆåæœŸå¯ä»¥è€ƒè™‘åšæˆå…¨éƒ¨æœç´¢ç»“æœæˆ–è€…åŠ¨æ€å±•ç¤ºæŸä¸€é¡µçš„æœç´¢ç»“æœï¼‰</li></ul></li><li><p>é€‰æ‹©å¯¹åº”çš„urlï¼Œåˆ™å°±ç›´æ¥ç”±å¤–åˆ°å†…å›åˆ°ç¬¬äºŒæ­¥ ç„¶åå†æ ¹æ®é›†æ•°å›åˆ°ç¬¬ä¸€æ­¥å°±å¯ä»¥å¾—åˆ°è§†é¢‘äº†</p></li></ul><h3 id="ä»£ç -v3">ä»£ç </h3><p>è´´ä¸Šå¼‚æ­¥ä¸‹è½½çš„ä»£ç å—ï¼Œä¸»è¦æ³¨æ„è¿™é‡Œçš„å¼‚æ­¥ä¸‹è½½æ–¹å¼ï¼ˆè¦å¼‚æ­¥ï¼Œåˆ™å‘ç”Ÿè€—æ—¶æ—¶éƒ½è¦å¼‚æ­¥ï¼‰</p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">async_download</span><span class="token punctuation">(</span>index_name<span class="token punctuation">,</span> dir_name<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""download ts files in index m3u8 file """</span>    tasks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>M3U8_INDEX<span class="token punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">&#123;</span>dir_name<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token boolean">False</span><span class="token punctuation">:</span>        os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>M3U8_INDEX<span class="token punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">&#123;</span>dir_name<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>    <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>RAW_M3U8_DIR<span class="token punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">&#123;</span>dir_name<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token boolean">False</span><span class="token punctuation">:</span>        os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>RAW_M3U8_DIR<span class="token punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">&#123;</span>dir_name<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>    <span class="token keyword">async</span> <span class="token keyword">with</span> aiohttp<span class="token punctuation">.</span>ClientSession<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>        <span class="token keyword">async</span> <span class="token keyword">with</span> aiofiles<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>M3U8_INDEX<span class="token punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">&#123;</span>dir_name<span class="token punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">&#123;</span>index_name<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>            <span class="token keyword">async</span> <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>                <span class="token keyword">if</span> line<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'#'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">continue</span>                <span class="token comment"># get the last name to storage</span>                name <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>                task <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>create_task<span class="token punctuation">(</span><span class="token punctuation">(</span>download_single_m3u8file<span class="token punctuation">(</span>dir_name<span class="token punctuation">,</span> line<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> session<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                tasks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>task<span class="token punctuation">)</span>            <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>wait<span class="token punctuation">(</span>tasks<span class="token punctuation">)</span><span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">download_single_m3u8file</span><span class="token punctuation">(</span>dir_name<span class="token punctuation">,</span> url<span class="token punctuation">,</span> name<span class="token punctuation">,</span> session<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">async</span> <span class="token keyword">with</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token keyword">as</span> resp<span class="token punctuation">:</span>        <span class="token keyword">async</span> <span class="token keyword">with</span> aiofiles<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>RAW_M3U8_DIR<span class="token punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">&#123;</span>dir_name<span class="token punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">&#123;</span>name<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"start write file "</span> <span class="token operator">+</span> url<span class="token punctuation">)</span>            <span class="token keyword">await</span> <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token keyword">await</span> resp<span class="token punctuation">.</span>content<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"successfully write file "</span> <span class="token operator">+</span> url<span class="token punctuation">)</span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ä»€ä¹ˆæ˜¯CORS</title>
    <link href="/2022/04/26/%E4%BB%80%E4%B9%88%E6%98%AFCORS/"/>
    <url>/2022/04/26/%E4%BB%80%E4%B9%88%E6%98%AFCORS/</url>
    
    <content type="html"><![CDATA[<h1>SOPä¸CORS</h1><h2 id="é—®é¢˜æº¯æº">é—®é¢˜æº¯æº</h2><p>ä¸ºä»€ä¹ˆæˆ‘ä¼šé‡åˆ°è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿå¦‚æœä½ ä¹Ÿæœ‰ç±»ä¼¼çš„ç»å†ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥çš„å†…å®¹å°±æˆ–è®¸èƒ½å¤Ÿå¸®åŠ©ä½ è§£å†³é—®é¢˜</p><p><strong>1. é€šè¿‡æœåŠ¡å™¨ç½‘é¡µä¸Šçš„jsè„šæœ¬æƒ³åœ¨çº¿è·å–leetcodeçš„æ•°æ®</strong></p><p>é€šè¿‡ç½‘é¡µä¸Šçš„jsè„šæœ¬ç»™leetcodeå‘é€è¯·æ±‚ï¼Œè¿™ä¸ªbugå‘ç°èŠ±äº†å¾ˆé•¿æ—¶é—´ï¼Œå› ä¸ºåœ¨è‡ªå·±çš„Chromeä¸Šä»¥å‰ä¹Ÿå‘ç”Ÿè¿‡ç±»ä¼¼çš„CORSè¯·æ±‚å¤±è´¥é—®é¢˜ï¼Œå½“æ—¶æ²¡æœ‰æ·±ç©¶ï¼ŒæŸ¥äº†ä¸‹ ä¸‹è½½äº†Allow CORSè¿™ä¸ªæ’ä»¶ï¼Œç«‹é©¬è§£å†³äº†é—®é¢˜ã€‚åæ¥æµè§ˆå™¨å°±ä¸€ç›´ä¿æŒAllow CORSæ‰“å¼€çš„æƒ…å†µã€‚<br>åæ¥è‡ªå·±å†™<a href="https://www.npmjs.com/package/hexo-leetcode-calendar">hexo-leetcode-calendar</a>çš„jså†æ¬¡é€šè¿‡CORSå»è®¿é—®å…¶ä»–ç½‘ç«™ï¼Œä½†å‘ç°åœ¨æ‰‹æœºä¸Šæ˜¾ç¤ºä¸å‡ºæ¥ç”»é¢å’Œæ•°æ®ï¼ˆä½†æˆ‘è‡ªå·±çš„å®¢æˆ·ç«¯ä¸Šå´æ²¡æœ‰é—®é¢˜ï¼‰ã€‚ï¼ˆå½“æ—¶è®¤ä¸ºæ˜¯Canvasåœ¨é«˜æ¸…çš„æ‰‹æœºå±ä¸Šç»˜åˆ¶å­˜åœ¨å†²çªï¼‰åˆå› ä¸ºä¸ä¼šç§»åŠ¨ç«¯Chromeè°ƒè¯•ï¼ŒæŸ¥äº†å¾ˆä¹…æ‰å®šä½åˆ°æ˜¯ç½‘ç»œè¯·æ±‚å‡ºäº†é—®é¢˜ï¼Œè¿™æ‰æº¯æºçªç„¶å‘ç°CORSçš„é—®é¢˜ï¼Œç„¶åä¸€åˆ‡çš„ä¸€åˆ‡çš„ä¸€åˆ‡ç¬é—´æ˜¯é‚£ä¹ˆè±ç„¶å¼€æœ—ï¼Œä»æœ€å¼€å§‹çš„ç½‘é¡µCORSæŠ¥é”™åˆ°æ— æ³•è®¿é—®Bilibiliå’ŒYouTubeçš„ä¸€äº›èµ„æºï¼Œå†åˆ°ç°åœ¨çš„è„šæœ¬ç»˜åˆ¶ä¸æ˜¾ç¤ºï¼Œé¡¿æ—¶å°±é€šäº†ã€‚è„šæœ¬çš„ä¸»è¦é—®é¢˜å°±æ˜¯ <strong>æ²¡æŠ“$.get()çš„æŠ¥é”™ï¼Œå¯¼è‡´å•¥é”™å‘ç”Ÿäº†åœ¨æµè§ˆå™¨ä¸Šéƒ½ä¸çŸ¥é“</strong></p><p><strong>2. æ— æ³•è®¿é—®bilibiliå’ŒYoutubeçš„éƒ¨åˆ†èµ„æº</strong></p><p>å¦‚æœä½ çš„Chromeçªç„¶æ— æ³•æœç´¢bilibiliï¼Œåˆæˆ–è€…èƒ½å¤Ÿæ­£å¸¸è®¿é—®Youtubeç½‘é¡µä½†æ— æ³•æ­£å¸¸è§‚çœ‹Youtubeè§†é¢‘ï¼Œé‚£ä½ å¯èƒ½è¦æ£€æŸ¥ä¸€ä¸‹ä½ çš„Chromeæ’ä»¶äº†ï¼Œä¹‹å‰ä¸€æ®µæ—¶é—´å†…çªç„¶ä¸èƒ½è®¿é—®Bilibiliäº†ï¼Œä¸èƒ½ç™»å½•ä¹Ÿä¸èƒ½è§‚çœ‹è§†é¢‘ï¼ŒYoutubeä¹Ÿç¦»å¥‡æŠ¥é”™ï¼Œèƒ½å¤Ÿç¿»å¢™ã€æ­£å¸¸æœç´¢è§†é¢‘å´ä¸èƒ½è§‚çœ‹ã€‚ä¸€ç›´ä»¥ä¸ºæ˜¯ä»£ç†å“ªå„¿è®¾ç½®é”™äº†ï¼ˆç»å…¸ä»£ç†èƒŒé”…ï¼‰</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220426173912299.png" alt="image-20220426173912299"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220426174053301.png" alt="image-20220426174053301"></p><p>å†™å®Œè¿™ç¯‡æ–‡ç« åæˆ‘æ‰“å¼€Allow-CORS æŠ“äº†ä¸‹åŒ…ï¼Œå‘ç°å¾ˆå¤šéƒ½æ˜¯CORS errorï¼Œå¯èƒ½åŸå› æ˜¯è™½ç„¶ä½ å®¢æˆ·ç«¯æ˜¯ä¸å¯ç”¨CORSäº†ï¼Œä½†æˆ‘å¯èƒ½æœ‰ä¸€äº›è„šæœ¬ä¸ä¼šè¢«Allow-CORSæ‹¦æˆªè€Œå‘é€è¯·æ±‚ã€‚</p><h2 id="ä»‹ç»-v5">ä»‹ç»</h2><p><strong>Cross-Origin Resource Sharing</strong>ï¼šä¸€ç§å…è®¸å½“å‰åŸŸçš„èµ„æºè¢«å…¶ä»–åŸŸçš„è„šæœ¬è¯·æ±‚è®¿é—®çš„æœºåˆ¶ï¼Œé€šå¸¸ç”±äº<strong>åŒåŸŸå®‰å…¨ç­–ç•¥(Same Origin Policy)</strong>ï¼Œæµè§ˆå™¨ä¼šç¦æ­¢è¿™ç§è·¨åŸŸè¯·æ±‚çš„è¿”å›ã€‚<strong>ï¼ˆæ³¨æ„ï¼Œåªæ˜¯è¿‡æ»¤æ‰è¿”å›çš„è¯·æ±‚ï¼Œä½†å®é™…ä¸Šè¯·æ±‚æ˜¯æˆåŠŸå‘é€ç»™æœåŠ¡ç«¯çš„, åªæ˜¯å‘å›æ¥çš„æ•°æ®è¢«æµè§ˆå™¨æ‰”æ‰äº†ï¼‰</strong></p><p><strong>Domain åŸŸ</strong>ï¼ˆåè®®schema ä¸»æœºhost ç«¯å£å·portï¼‰éƒ½å¿…é¡»ä¸€è‡´çš„</p><p>ä»€ä¹ˆåˆæ˜¯<strong>åŒæºç­–ç•¥</strong>ï¼Ÿä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚åœ¨æˆ‘çš„ç½‘ç«™ä¸Šæœ‰ä¸ªjsè„šæœ¬ï¼Œjsè„šæœ¬è¦é€šè¿‡getå»è·å–å¦ä¸€ä¸ªç½‘ç«™çš„æ•°æ®å¹¶è¿”å›ï¼Œæœ€ç»ˆåœ¨æˆ‘çš„ç½‘ç«™ä¸Šæ˜¾ç¤ºï¼Œè¿™å°±äº§ç”Ÿäº†è·¨åŸŸçš„è¯·æ±‚ã€‚æœ¬æ¥åªæ˜¯å½“å‰æµè§ˆå™¨ &lt;â€”&gt; æˆ‘çš„ç½‘ç«™ çš„åŒå‘å“åº”ï¼Œä½†ç”±äºjsè„šæœ¬å‘å‡ºçš„è¯·æ±‚ï¼Œå°±å½“å‰æµè§ˆå™¨å°±è¦å»å¾€å…¶ä»–çš„æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼ˆ<strong>æ³¨æ„ï¼Œè¿™é‡Œå¹¶ä¸æ˜¯ç½‘ç«™çš„æœåŠ¡å™¨å»å‘é€è¯·æ±‚ï¼Œè€Œæ˜¯è®¿é—®çš„å®¢æˆ·ç«¯å»å‘é€</strong>ï¼‰ï¼Œè¿™å¾€å¾€å¯èƒ½æ˜¯ä¸å®‰å…¨çš„ï¼Œå› ä¸ºæˆ‘å¯ä»¥æ ¹æ®Cookieå»å…¶ä»–çš„ç½‘ç«™ä¸Šå‘é€è¯·æ±‚</p><h2 id="å®éªŒ-v3">å®éªŒ</h2><blockquote><p>å·¥å…·ï¼šPyCharm ã€Tonardo ã€Wiresharkã€Chrome</p></blockquote><p>é¦–å…ˆé€šè¿‡fetchå»æµ‹è¯•åœ¨å½“å‰åŸŸä¸‹å»è®¿é—®è¯¥åŸŸçš„ä¸€äº›èµ„æºï¼Œè‚¯å®šæ˜¯å¯è¡Œçš„ã€‚</p><h3 id="æ­å»ºç®€å•çš„æœåŠ¡å™¨">æ­å»ºç®€å•çš„æœåŠ¡å™¨</h3><p>æˆ‘å…ˆé€šè¿‡åŸºäºpythonçš„tornadoæ­å»ºäº†ç®€æ˜“çš„æœåŠ¡å™¨ï¼Œç›‘å¬9002ç«¯å£å¹¶è¿”å›æ•°æ®</p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> tornado<span class="token punctuation">.</span>ioloop<span class="token keyword">import</span> tornado<span class="token punctuation">.</span>web<span class="token keyword">class</span> <span class="token class-name">MainHandler</span><span class="token punctuation">(</span>tornado<span class="token punctuation">.</span>web<span class="token punctuation">.</span>RequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"Hello World"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">makeApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> tornado<span class="token punctuation">.</span>web<span class="token punctuation">.</span>Application<span class="token punctuation">(</span><span class="token punctuation">[</span>        <span class="token punctuation">(</span><span class="token string">r"/"</span><span class="token punctuation">,</span> MainHandler<span class="token punctuation">)</span>    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app <span class="token operator">=</span> makeApp<span class="token punctuation">(</span><span class="token punctuation">)</span>    app<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">9002</span><span class="token punctuation">)</span>    tornado<span class="token punctuation">.</span>ioloop<span class="token punctuation">.</span>IOLoop<span class="token punctuation">.</span>current<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div><h3 id="CORSè®¿é—®">CORSè®¿é—®</h3><p>æˆ‘åœ¨ç½‘ç«™çš„consoleä¸Šï¼Œè°ƒç”¨fetchå»è·å–ä¸åŒåŸŸçš„æ•°æ®ï¼Œè¿™é‡Œä¾¿å‡ºç°äº†CORSçš„é™åˆ¶ã€‚â€œæœåŠ¡å™¨æ²¡æœ‰è¿”å›å¯ä»¥è¿›è¡Œè·¨åŸŸè®¿é—®çš„è¯´æ˜â€</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220426155024359.png" alt="image-20220426155024359"></p><p>æ‰€ä»¥è¿™æ—¶å€™é—®é¢˜å‡ºåœ¨æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å¯¹å‘å‡ºçš„respéœ€è¦æ·»åŠ CORSçš„è¯´æ˜å“åº”å¤´</p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">self<span class="token punctuation">.</span>set_header<span class="token punctuation">(</span><span class="token string">"Access-Control-Allow-Origin"</span><span class="token punctuation">,</span> <span class="token string">"https://pplong.top"</span><span class="token punctuation">)</span></code></pre></div><p>æ­¤æ—¶æµè§ˆå™¨ä¾¿å¯ä»¥æˆåŠŸæ‰“å°</p><div class="note note-info">            <p><strong>å°å‘</strong></p><p>è¿™é‡Œè¿˜æœ‰ä¸ªè·Ÿä»£ç†æœ‰å…³çš„å‘ç‚¹</p><p>æœ€å¼€å§‹æ˜¯ç”¨è®¾ç½®äº†Clashä»£ç†çš„Chromeå»åšfetchè¯·æ±‚ï¼Œä½†åªè¿”å›äº†Promiseå¯¹è±¡è€Œæœªè¿”å›æ•°æ®ï¼Œåæ¥ç”¨æœªå¼€å¯ä»£ç†çš„Firefoxå»è¯·æ±‚ï¼Œåˆ™å¾—åˆ°äº†æ­£å¸¸çš„æ•°æ®ã€‚æœªéªŒè¯ä½†ä¼°è®¡è·Ÿproxyæœ‰å…³ç³»ï¼Œå¯èƒ½æ˜¯æ•°æ®è¿”å›ç»™Proxyå»¶æ—¶å¤ªä¹…ï¼Ÿ</p>          </div><p>å³<strong>Access-Control-Allow-Origin</strong>ä¸ºæœåŠ¡å™¨æŒ‡æ˜äº†ä»é‚£äº›åŸŸæ¥çš„è·¨åŸŸè¯·æ±‚å¯ä»¥æˆ‘å¯ä»¥æ¥å—</p><h3 id="Preflight">Preflight</h3><p>å¦‚æœæ­£å¦‚ä¹‹å‰è¯·æ±‚Leetcode APIä¸€æ ·ï¼Œå¦‚æœåŠ ä¸Šä¸€ä¸ªContent Type ï¼Œé‚£ä¹ˆä¸€æ ·ä¼šæŠ¥é”™ï¼Œè¿™é‡Œå°±æ¶‰åŠåˆ°Preflightçš„çŸ¥è¯†äº†</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220426162442588.png" alt="image-20220426162442588"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220426164610722.png" alt="probably-mistake"></p><p>Preflight ä¸€èˆ¬æŒ‡çš„å°±æ˜¯OPTIONSè¯·æ±‚ï¼Œåœ¨æµè§ˆå™¨è®¤ä¸ºå³å°†è¦æ‰§è¡Œçš„è¯·æ±‚å¯èƒ½ä¼šå¯¹æœåŠ¡å™¨é€ æˆä¸å¯é¢„çŸ¥çš„å½±å“æ—¶ï¼Œä¼šç”±æµè§ˆå™¨è‡ªåŠ¨å‘å‡ºï¼Œä¸æœåŠ¡å™¨æ²Ÿé€šæ˜¯å¦èƒ½å‘é€ç±»ä¼¼çš„è¯·æ±‚ã€‚</p><h4 id="å¦‚ä½•è§¦å‘">å¦‚ä½•è§¦å‘</h4><p>åˆšåˆšçš„GETè¯·æ±‚å°±æ²¡æœ‰è§¦å‘Preflightï¼Œé‚£å…·ä½“ä»€ä¹ˆæ—¶å€™ä¼šè§¦å‘æµè§ˆå™¨å‘é€è¯¥è¯·æ±‚å‘¢ï¼Ÿ</p><ol><li>è¯·æ±‚æ–¹æ³•ï¼šPOST GET HEAD</li><li>è¯·æ±‚å¤´ï¼š Accept<code> </code>Accept-Language<code> </code>Content-Language<code> </code>Content-Type<code> </code>DPR<code> </code>Downlink<code> </code>Save-Data<code> </code>Viewport-Width<code>  </code>Width</li><li><strong>Content-Type</strong>ï¼štext/plain<code> </code>multipart/form-data<code> </code>application/x-www-form-urlencoded</li><li>â€¦</li></ol><p>ä¸æ»¡è¶³ä»¥ä¸Šå››ç§æ¡ä»¶çš„éƒ½ä¼šè§¦å‘æµè§ˆå™¨çš„é¢„æ£€ï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œè®¾ç½®äº†Content-Typeï¼Œåˆ™è§¦å‘äº†é¢„æ£€ï¼Œæ¥çœ‹ä¸€ä¸‹å…·ä½“æŠ“åŒ…çš„ç»†èŠ‚ã€‚</p><h4 id="æŠ“åŒ…">æŠ“åŒ…</h4><p>è¿™é‡Œé¦–å…ˆåœ¨æµè§ˆå™¨å†…çœ‹åˆ°ç¬¬ä¸€ä¸ªåŒ…ï¼Œç±»å‹æ˜¯OPTIONSï¼ŒæŠŠå®ƒæƒ³å‘çš„è¯·æ±‚ç±»å‹ã€æƒ³è¦è¿ä½œçš„è¯·æ±‚å¤´éƒ½å‘äº†å‡ºå»ï¼Œå¹¶ä¸”è¯´æ˜äº†FetchModeæ˜¯corsçš„ï¼Œéšåæµè§ˆå™¨ä¾¿è¿”å›ä¸€ä¸ª 405çš„åŒ…ï¼Œè¯´æ˜è¯·æ±‚ä¸è¢«å…è®¸</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220426163732009.png" alt="image-20220426163732009"></p><p>é€šè¿‡æœåŠ¡å™¨ä¸­optionsæ–¹æ³•æ¥è¿›è¡Œå¯¹OPTIONSè¯·æ±‚çš„å¤„ç†ï¼Œåœ¨tornadoä¸­ï¼Œæœªç»è¿‡é¢„æ£€çš„å‘½ä»¤åˆ™ä¸ä¼šé€šè¿‡OPTIONSï¼Œä¸ä¼šè¿›å…¥åˆ°å¯¹åº”çš„è¯·æ±‚æ–¹æ³•ä½“ä¸­ï¼Œæ‰€ä»¥è¦å¤„ç†è¿™ä¸ªé—®é¢˜ï¼Œåº”è¯¥è¦å¤„ç†optionså‡½æ•°ã€‚</p><p>å›åˆ°å‰é¢çš„ä¸¤ä¸ªé”™è¯¯å“åº”ï¼Œé¦–å…ˆç¬¬ä¸€å¼ æ˜¯å› ä¸ºæˆ‘åªä¸ºgetè¯·æ±‚è®¾ç½®äº†Allow-Originï¼Œä½†è¿™æ˜¯ä¸€ä¸ªé¢„æ£€çš„OPTIONSè¯·æ±‚ï¼Œè€Œå¯¹åº”optionsè¯·æ±‚çš„æœåŠ¡å™¨å“åº”æ²¡æœ‰è®¾ç½®ï¼Œæ‰€ä»¥è¿˜éœ€è¦ä¸ºoptionsè®¾ç½®è·¨åŸŸè¯·æ±‚çš„åŸŸåç™½åå•ã€‚</p><p>ç¬¬äºŒä¸ªé”™è¯¯å“åº”æ˜¯å› ä¸ºæˆ‘ä»¬è®¾ç½®äº†å¯èƒ½é€ æˆå½±å“çš„è¯·æ±‚å¤´ï¼ˆè§¦å‘Preflightçš„æ ¹æºï¼‰ï¼ŒæœåŠ¡å™¨æ²¡æœ‰å…è®¸è®¾ç½®äº†è¿™ä¸ªç±»å‹çš„è¯·æ±‚å¤´å¯ä»¥é€šè¿‡ï¼Œæ‰€ä»¥è¿˜éœ€è¦æ·»åŠ <strong>Access-Control-Allow-Headers</strong>ï¼Œä¸ºè¿™æ ·çš„è¯·æ±‚å¤´æ”¾è¡Œ</p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"receive!"</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>set_header<span class="token punctuation">(</span><span class="token string">"Access-Control-Allow-Origin"</span><span class="token punctuation">,</span> <span class="token string">"http://www.pplong.top"</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Hello World"</span></span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">options</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>set_header<span class="token punctuation">(</span><span class="token string">"Access-Control-Allow-Origin"</span><span class="token punctuation">,</span> <span class="token string">"http://www.pplong.top"</span><span class="token punctuation">)</span>    self<span class="token punctuation">.</span>set_header<span class="token punctuation">(</span><span class="token string">"Access-Control-Allow-Headers"</span><span class="token punctuation">,</span> <span class="token string">"Content-Type"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"trigger options"</span><span class="token punctuation">)</span></code></pre></div><p>å®¢æˆ·ç«¯æˆåŠŸå“åº”</p><h3 id="Max-Age">Max-Age</h3><p><strong>Access-Control-Max-Age</strong> æŒ‡æ˜æœåŠ¡å™¨åœ¨æŒ‡å®šæ—¶é—´å†…ä¸ç”¨ä¸ºåŒä¸€è¯·æ±‚æ‰§è¡Œå¤šæ¬¡é¢„æ£€ï¼Œæ²¡æœ‰åœ¨æœåŠ¡å™¨ä¸­ç»™å®¢æˆ·ç«¯è¿”å›æ­¤å€¼ï¼Œåˆ™å¤šæ¬¡è·¨åŸŸè¯·æ±‚ æ¯æ¬¡éƒ½ä¼šè§¦å‘é¢„æ£€ã€‚<strong>è¿™ä¸ªå€¼ä»…ä»…æ˜¯å‘Šè¯‰å®¢æˆ·ç«¯ï¼Œè®©ä»–ä¸ç”¨åšé¢„æ£€å¤„ç†ï¼Œè€ŒæœåŠ¡ç«¯æœ¬èº«æ˜¯æ²¡æœ‰ä»€ä¹ˆæ“ä½œçš„</strong></p><h4 id="ä¸€ä¸ªè¯¡è®¡">ä¸€ä¸ªè¯¡è®¡</h4><p>ç”±äºmax-ageæ˜¯åªå­˜åœ¨æµè§ˆå™¨å†…çš„ï¼Œæ‰€ä»¥è¿™å°±å¯èƒ½å¯¼è‡´ä¸€ä¸ªé—®é¢˜ï¼Œè€ƒè™‘å¦‚ä¸‹åœºæ™¯ï¼š</p><p>å¦‚æœæˆ‘çš„æœåŠ¡å™¨æœ€å¼€å§‹æ˜¯å…è®¸æŸä¸ªç½‘ç«™è·¨åŸŸè®¿é—®å¹¶ä¸”ä¿æŒä¸€å®šæ—¶é—´çš„max-ageå†…ä¸ç”¨é¢„æ£€ï¼Œä½†è¿è¡Œä¸€æ®µæ—¶é—´åæˆ‘åæ‚”äº†ï¼Œæˆ‘åœ¨æœåŠ¡å™¨ç«¯åˆ å»äº†è¿™ä¸ªè¯·æ±‚å¤´ï¼Œé‚£è¯·é—®å®¢æˆ·ç«¯åœ¨max-ageå†…è¿›è¡Œè·¨åŸŸè®¿é—®è¿˜ä¼šè§¦å‘é¢„æ£€å—ï¼Ÿ</p><p><strong>ç­”æ¡ˆæ˜¯å¦å®šçš„ï¼</strong> å› ä¸ºæµè§ˆå™¨ä¸ä¼šè§¦å‘é¢„æ£€ï¼Œæ‰€ä»¥ä¹Ÿå°±æ— æ³•è¿›å…¥å¤„ç†åˆ°optionsæ–¹æ³•ï¼Œé‚£å°±æœ‰å¯èƒ½è®©è®¿é—®è€…å¯¹æœåŠ¡å™¨é€šè¿‡å±é™©çš„è¯·æ±‚ä¾‹å¦‚DELETEæˆ–PUTç­‰æ¥å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œè¿™å°±é€ æˆäº†éšæ‚£ï¼</p><p>è¿™é‡Œæˆ‘ä¹Ÿè¿›è¡Œäº†å®éªŒï¼Œå…ˆæ‰“å¼€æœåŠ¡å™¨ç«¯çš„max-ageï¼Œè®©æµè§ˆå™¨è¯·æ±‚æ•°æ®å¹¶ä¿å­˜max-ageï¼Œç„¶åæœåŠ¡å™¨åˆ å»max-ageè¯·æ±‚å¤´ï¼Œè®©å®¢æˆ·ç«¯å†æ¬¡è¯·æ±‚ï¼Œå¯ä»¥å‘ç°ï¼Œå®¢æˆ·ç«¯æœªå‘é€OPTIONSåŒ…è€Œç›´æ¥å‘é€äº†POSTåŒ…ã€‚</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220426172021100.png" alt="image-20220426172021100"></p><p>ï¼ˆå³ä½¿æ”¹å˜çš„æœåŠ¡å™¨çš„æ•°æ®ï¼Œä¸€æ ·èƒ½æˆåŠŸè¯·æ±‚å¹¶è¿”å›200çš„å“åº”ç ï¼‰</p><p>å¦‚æœåç«¯äººå‘˜çªç„¶å˜æ›´è¯¥è¯·æ±‚å¤´ï¼Œé‚£ä¹ˆå°±å¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ï¼Œè™½ç„¶å…·ä½“åˆ°åº”ç”¨å±‚é¢ï¼Œåç«¯è®¾ç½®å¯èƒ½æ›´ä¸ºå¤æ‚ï¼Œå¯èƒ½æœ‰è‡ªå·±çš„åˆ¤æ–­æ ‡å¿—ï¼Œä½†å¸¸è§„æ¥è®²è¿™æ ·åšå¯èƒ½å¯¼è‡´é£é™©ã€‚ï¼ˆç»™è‡ªå·±æä¸ªé†’ğŸ¤•, é˜²æ­¢æ—¥åå‡ºå¤§é—®é¢˜ ï¼‰</p><h2 id="æ·±å…¥">æ·±å…¥</h2><h3 id="CORSä¼šé€ æˆå“ªäº›é—®é¢˜ï¼Ÿ">CORSä¼šé€ æˆå“ªäº›é—®é¢˜ï¼Ÿ</h3><p><strong>ä¿¡æ¯æ³„éœ²</strong></p><p>æ¯”å¦‚ä½ åˆšåœ¨ç½‘ç«™ä¸Šç™»å½•äº†è´¦æˆ·ï¼Œæµè§ˆå™¨ä¿å­˜äº†cookieï¼Œå¦‚æœè¿™æ—¶å€™ä½ è®¿é—®å¦ä¸€ä¸ªæ¶æ„ç½‘ç«™ï¼Œé‚£ä¹ˆå¦‚æœæ²¡æœ‰åŒæºç­–ç•¥åˆ™ä½ çš„æµè§ˆå™¨å†…çš„è´¦æˆ·cookieå¯èƒ½å°±ä¼šè¢«è·å–</p><h3 id="å¦‚ä½•ç»•è¿‡CORSï¼Ÿ">å¦‚ä½•ç»•è¿‡CORSï¼Ÿ</h3><h4 id="JSONP">JSONP</h4><p><strong>ä»scriptæ ‡ç­¾çš„å¯è·¨åŸŸæ€§å…¥æ‰‹ï¼Œä¸”é»˜è®¤æ˜¯javascriptç±»å‹æ‰§è¡Œçš„</strong></p><p>ç”±äºscript srcå¯è·¨åŸŸè·å–ï¼Œæ‰€ä»¥é€šè¿‡åœ¨srcä¸­å¾€jsè¯·æ±‚å¡å…¥å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°æ˜¯ä¹‹å‰scriptå®šä¹‰çš„æ–¹æ³• + å‚æ•°å€¼æ¥è¿›è¡Œï¼ŒæœåŠ¡ç«¯é€šè¿‡å–è¿™äº›å‚æ•°å’Œå€¼ï¼Œç›´æ¥åŒ…è£…æˆä¸€ä¸ªå‡½æ•°è¿”å›ã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘æ ¹æœ¬å¯ä»¥æ²¡æœ‰jså‡½æ•°ï¼Œjsè¯·æ±‚åªæ˜¯ä¸ªå¹Œå­ï¼Œå› ä¸ºhtml5ä¸­é»˜è®¤çš„scriptç±»å‹æ˜¯text/javascriptï¼Œæ‰€ä»¥åªè¦è¿”å›æ¥çš„æ˜¯ä¸html scriptå…³è”çš„<strong>æ­£ç¡®çš„å‡½æ•°ä»£ç </strong>ï¼Œé‚£å°±å¯ä»¥æ‰§è¡Œ</p><div class="code-wrapper"><pre class="language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">let</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3200</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'OK'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/getData'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>  <span class="token comment">// æ³¨æ„Function.prototypeå¾ˆé‡è¦ï¼ŒæŒ‡å®šæ˜¯å‡½æ•°ç±»å‹ï¼ˆåŸç†è¿˜æ²¡ææ¸…æ¥šï¼‰</span>  <span class="token keyword">let</span> <span class="token punctuation">&#123;</span> callback <span class="token operator">=</span> <span class="token class-name">Function</span><span class="token punctuation">.</span>prototype <span class="token punctuation">&#125;</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">;</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'å¼ ä¸‰'</span><span class="token punctuation">,</span>    <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'Person'</span><span class="token punctuation">,</span>    <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token string">'ç”·'</span>  <span class="token punctuation">&#125;</span>  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>callback<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// value == jsonpCallback(&#123;"name":"å¼ ä¸‰","message":"Person","sex":"ç”·"&#125;)</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å‘é€æˆåŠŸ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></code></pre></div><div class="code-wrapper"><pre class="language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token constant">HTML</span>å†…è‡ªå®šä¹‰çš„å‡½æ•°ä½“ <span class="token operator">--</span><span class="token operator">></span><span class="token keyword">function</span> <span class="token function">jsonpCallback</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"123123"</span><span class="token punctuation">)</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://127.0.0.1:3200/getData?callback=jsonpCallback<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220426200501038.png" alt="image-20220426200501038"></p><p>æˆåŠŸæ‰“å°ï¼Œä½†JSONPæœ‰ç¼ºé™·ï¼Œé€šè¿‡urlçš„æ–¹å¼ï¼Œåªèƒ½å®ç°getè¯·æ±‚ï¼Œå…¶ä»–è¯·æ±‚å°±ä¸èƒ½æ‰§è¡Œäº†ï¼Œæ‰€ä»¥èŒƒå›´è¿˜æ˜¯æ¯”è¾ƒå±€é™ã€‚å› æ­¤ä¹Ÿå°±æœ‰äº†CORS</p><h4 id="CORS">CORS</h4><p>æœ¬æ–‡æ‰€ä»‹ç»åˆ°çš„</p><h2 id="å›é¡¾">å›é¡¾</h2><p>å›é¡¾å‰é¢çš„é—®é¢˜ï¼Œå°è¯•å…ˆæ¸…ç©ºç¼“å­˜åå¼€å¯Allow-CORSï¼Œç„¶åè¿›è¡Œæœªè¢«å…è®¸çš„CORSè¯·æ±‚ï¼Œå‘ç°å“åº”ç 200å¹¶è¿”å›æ­£å¸¸æ•°æ®ï¼Œéšåè¿›è¡ŒæŠ“åŒ…å‘ç°ï¼Œåªå‘é€äº†ä¸€ä¸ªGETè¯·æ±‚ï¼Œå³æµè§ˆå™¨è‡ªèº«ç›´æ¥å¿½ç•¥äº†é¢„æ£€è¿™ä¸€æ­¥éª¤ã€‚</p><p>Bilibili CORS Errorä¸­ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯jsè„šæœ¬è§¦å‘çš„CORS Errorï¼Œè¯´æ˜å¯èƒ½jsè„šæœ¬ä¸­ä¸€äº›xhrç±»å‡½æ•°çš„æ‰§è¡Œæ²¡æœ‰è¢«Allow-CORSæ•è·å¹¶é‡æ–°è®¾ç½®ï¼Œè¿›å…¥åˆ°é”™è¯¯jsä¸­è°ƒè¯•åå‘ç°å¼•å‘äº†æˆ‘ä»¬éƒ½å·²ç†Ÿæ‚‰äº†çš„è¿™ä¸ªé—®é¢˜</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220426175608360.png" alt="image-20220426175608360"></p><h2 id="æ€»ç»“-v14">æ€»ç»“</h2><p>å¥½äº†ï¼Œä¸€å¥è¯ï¼Œ<s><strong>ç½ªé­ç¥¸é¦–ï¼šAllow-CORSå…¨é”…ï¼</strong></s> ğŸ˜†</p><p>å…¶å®è¿˜æ˜¯ä¸€ä¸ªå‰åç«¯é€šä¿¡ä¸€ä¸ªæ¯”è¾ƒç»å…¸çš„é—®é¢˜ï¼Œç›¸ä¿¡å®æˆ˜çš„æ—¶å€™è‚¯å®šè¿˜ä¼šé‡åˆ°æ­¤ç±»é—®é¢˜ï¼Œåˆ°æ—¶å€™åº”è¯¥è¿˜ä¼šæœ‰æ–°çš„å¿ƒå¾—</p>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Web</tag>
      
      <tag>HTTP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸ºä½ çš„Hexoåšå®¢æ·»åŠ LeetCodeæ—¥å†</title>
    <link href="/2022/04/25/%E4%B8%BA%E4%BD%A0%E7%9A%84Hexo%E5%8D%9A%E5%AE%A2%E6%B7%BB%E5%8A%A0LeetCode%E6%97%A5%E5%8E%86/"/>
    <url>/2022/04/25/%E4%B8%BA%E4%BD%A0%E7%9A%84Hexo%E5%8D%9A%E5%AE%A2%E6%B7%BB%E5%8A%A0LeetCode%E6%97%A5%E5%8E%86/</url>
    
    <content type="html"><![CDATA[<h1>ä¸ºä½ çš„Hexoåšå®¢æ·»åŠ LeetCodeæ—¥å†</h1><div style="display: inline-block;">    <a target="_blank" href="https://hexo.io/"><img height="20" src="https://img.shields.io/badge/Build-Hexo-blue?logo=Hexo&style=flat&logoColor=3686F0&color=3686F0"></a><img height="20" src="https://img.shields.io/badge/Build-JavaScript-blue?logo=javascript&style=flat&logoColor=e1ea3d&color=f0a835"><a target="_blank" href="https://www.npmjs.com/package/hexo-leetcode-calendar"><img height="20" src="https://img.shields.io/badge/Publish-npm-blue?logo=npm&style=flat&logoColor=e1ea3d&color=f01822"></a>    <a target="_blank" href="https://github.com/PPLong222/hexo-leetcode-calendar"><img height="20" src="https://img.shields.io/badge/Repo-Github-blue?logo=github&style=flat&logoColor=5fa1e7&color=5fa1e7"></a></div><h2 id="ä»‹ç»-v4">ä»‹ç»</h2><p><strong>hexo-leetcode-calendar</strong>å¯ä»¥è®©ä½ åœ¨ä»¥hexoä¸ºé©±åŠ¨çš„åšå®¢é¡µé¢å±•ç¤ºleetcodeç”¨æˆ·çš„æäº¤è®°å½•ï¼ŒåŒ…æ‹¬è¿‘ä¸€å¹´çš„æäº¤è®°å½•ï¼Œä»¥åŠæ¯ä¸€å¤©å¯¹åº”çš„å¤©æ•°ï¼ˆåŠ¨æ€æ˜¾ç¤ºï¼‰ï¼Œå¹¶èƒ½åˆ†é¢˜å‹éš¾æ˜“ç¨‹åº¦æ˜¾ç¤ºå·²è§£å†³çš„é—®é¢˜æ•°ã€‚ï¼ˆçµæ„Ÿæºè‡ª<a href="">hexo-githubcalendar</a>ï¼‰</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220425194054775.png" alt="image-20220425194054775"></p><center><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/demostration.gif"></center><h2 id="å®‰è£…">å®‰è£…</h2><h3 id="å¿«é€Ÿä¸Šæ‰‹">å¿«é€Ÿä¸Šæ‰‹</h3><p>å®šä½åˆ°hexoä¸»ç›®å½•ä¸‹ï¼Œå¹¶æ‰“å¼€å‘½ä»¤è¡Œï¼Œé€šè¿‡npmå‘½ä»¤å®‰è£…ï¼š</p><div class="code-wrapper"><pre class="language-sh" data-language="sh"><code class="language-sh">npm install hexo-leetcode-calendar --save</code></pre></div><p>å®‰è£…å®Œæˆåï¼Œå¯ä»¥åœ¨ä½ åšå®¢çš„mdæ–‡æ¡£ä»»ä½•ä½ç½®æ’å…¥ä»¥ä¸‹å†…å®¹</p><div class="code-wrapper"><pre class="language-markdown" data-language="markdown"><code class="language-markdown">&#123;% leetcode username %&#125;</code></pre></div><p>ç„¶åæ‰§è¡Œï¼šhexo clean &amp;&amp; hexo g &amp;&amp; hexo sï¼Œä½ å°±å¯ä»¥åœ¨æœ¬åœ°è¿›è¡Œé¢„è§ˆäº†</p><h3 id="è‡ªå®šä¹‰">è‡ªå®šä¹‰</h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220425203816033.png" alt="image-20220425203816033"></p><p>å¯ä»¥å‚ç…§ä¸€ä¸‹æ ¼å¼è‡ªå®šä¹‰ä½ ä¸ªäººçš„leetcode calendarï¼Œé¦–å…ˆå®šä½åˆ°ç›®å½•ä¸‹çš„ç«™ç‚¹é…ç½®æ–‡ä»¶ _config.taï¼ˆ<strong>ä¸æ˜¯ä¸»é¢˜é…ç½®æ–‡ä»¶</strong>ï¼‰ï¼Œå‚ç…§ä»¥ä¸‹å†…å®¹æ·»åŠ </p><div class="code-wrapper"><pre class="language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">leetcodecalendar</span><span class="token punctuation">:</span>  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">submitGap</span><span class="token punctuation">:</span> <span class="token number">5</span>  <span class="token key atrule">showIcon</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">color</span><span class="token punctuation">:</span>    <span class="token key atrule">submitColor</span><span class="token punctuation">:</span> <span class="token string">'#c4c6c9'</span>    <span class="token key atrule">bgColor</span><span class="token punctuation">:</span> <span class="token string">'#252d38'</span>    <span class="token key atrule">subColors</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'#ebedf0'</span><span class="token punctuation">,</span> <span class="token string">'#bef5cb'</span><span class="token punctuation">,</span> <span class="token string">'#85e89d'</span><span class="token punctuation">,</span> <span class="token string">'#34d058'</span><span class="token punctuation">,</span> <span class="token string">'#1c992f'</span><span class="token punctuation">]</span></code></pre></div><table><thead><tr><th>å‚æ•°</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td>enable</td><td>å¼€å¯æ’ä»¶ï¼ˆå¦åˆ™ä¸ä¼šæ˜¾ç¤ºï¼‰</td></tr><tr><td>submitGap</td><td>ä¸ºæäº¤åˆ†é—´éš”æ¥æ˜¾ç¤ºé¢œè‰²ï¼Œä¾‹å¦‚0~gapä¸ªç»˜åˆ¶ç™½è‰² gap~2*gap -1ä¸ªä¸ºç»¿è‰²</td></tr><tr><td>showIcon</td><td>æ˜¯å¦æ˜¾ç¤ºä¸­é—´çš„Leetcodeå›¾æ ‡</td></tr><tr><td>submitColor</td><td>æäº¤æ¬¡æ•°çš„æ–‡å­—é¢œè‰²</td></tr><tr><td>bgColor</td><td>æ—¥å†èƒŒæ™¯é¢œè‰²</td></tr><tr><td>subColors</td><td>ä¸åŒå±‚æ¬¡çš„æäº¤æ•°æ‰€å¯¹åº”çš„é¢œè‰²æ•°ç»„ï¼ˆä»ä½åˆ°é«˜ï¼‰</td></tr></tbody></table><p>Githubåœ°å€: <a href="https://github.com/PPLong222/hexo-leetcode-calendar">hexo-leetcode-calendar</a> å¦‚æœè§‰å¾—å–œæ¬¢çš„è¯å¯ä»¥starä¸€ä¸‹</p><h2 id="æ›´æ–°-v2">æ›´æ–°</h2><h2 id="ç‰¹ç‚¹">ç‰¹ç‚¹</h2><ul><li>æ”¯æŒéƒ¨åˆ†ç§»åŠ¨è®¾å¤‡ä¸Šçš„æ˜¾ç¤ºï¼ˆå±å¹•è¿‡å°æ—¶æœ‰åˆ å‡ï¼‰</li></ul><h2 id="TODO">TODO</h2><ul><li>æ”¯æŒåœ¨ä¸€ä¸ªé¡µé¢æ˜¾ç¤ºå¤šä¸ªcalendar</li><li>æ”¯æŒè‹±è¯­æ˜¾ç¤º</li><li>å¢åŠ æ ‡é¢˜titleé…ç½®</li></ul><h2 id="æ„Ÿè°¢">æ„Ÿè°¢</h2><blockquote><p>ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šæ‰èƒ½çœ‹å¾—æ›´é«˜</p></blockquote><p>æ„Ÿè°¢<a href="https://github.com/TankNee/hexo-douban-card">hexo-douban-card</a> ä¸ <a href="https://github.com/Zfour/hexo-github-calendar">hexo-githubcalendar</a> åœ¨è®¾è®¡å’Œæ„æ€ä¸Šæä¾›æ€è·¯å’Œè§£å†³æ–¹æ¡ˆ</p><p>å¦‚æœä½ æœ‰å¥½çš„æè®®æˆ–æ’ä»¶ä¸é€‚é…ä½ çš„ä¸»é¢˜ï¼Œè¯·è”ç³»</p>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ­£åˆ™è¡¨è¾¾å¼æ•´åˆ</title>
    <link href="/2022/04/21/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%95%B4%E5%90%88/"/>
    <url>/2022/04/21/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%95%B4%E5%90%88/</url>
    
    <content type="html"><![CDATA[<h1>æ­£åˆ™è¡¨è¾¾å¼</h1><blockquote><p>æ­£åˆ™è¡¨è¾¾å¼å¾ˆå¼ºå¤§ï¼Œä½†ä¸€ç›´ä¸æ˜¯å¾ˆæ¸…æ¥šå…·ä½“è¯­æ³•ï¼Œæ¯æ¬¡é‡åˆ°æƒ³åŒ¹é…çš„å­—ç¬¦ä¸²éƒ½æ˜¯åœ¨ç½‘ä¸ŠæŠ„ï¼Œç»ˆäºæœ‰æ—¶é—´å¥½å¥½æ•´åˆä¸€ä¸‹ï¼Œåšä¸€ä¸ªæ€»çš„æ•´ç†ï¼Œå¹¶ä¸”å°†åç»­é¡¹ç›®ä¸­å¯èƒ½ç”¨åˆ°çš„åŒ¹é…å¼ä¹Ÿæ”¶å½•è¿›æ¥ã€‚</p></blockquote><h2 id="è¯­æ³•">è¯­æ³•</h2><h3 id="ä½ç½®">ä½ç½®</h3><ul><li><p>^ : åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²å¼€å§‹çš„ä½ç½®</p><ul><li><sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>+ä»¥ä¸€ä¸ªæˆ–å¤šä¸ªæ•°å­—å¼€å¤´</li></ul></li><li><p>$ : åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„ç»“æŸä½ç½®</p><ul><li>abc$è¡¨ç¤ºä»¥abcç»“å°¾</li></ul></li><li><p>\b: åŒ¹é…å•è¯è¾¹ç•Œï¼ˆå­—ä¸ç©ºæ ¼çš„ä½ç½®ï¼‰</p><ul><li>\bçš„ä½ç½®éå¸¸é‡è¦ï¼Œå¯¹äºâ€™Chapterâ€™ /\bChap/æ˜¯ä»å¼€å§‹åŒ¹é… /pter\b/æ˜¯ä»åŒ¹é…åˆ°æœ«å°¾</li></ul></li><li><p>\B: éå•è¯è¾¹ç•Œ</p><ul><li>ä¸\bçš„åŒºåˆ«ï¼šåŒ¹é…çš„å­—ç¬¦å¤„äºéå•è¯è¾¹ç•Œï¼Œâ€˜Chapterâ€™ /\Bapt/åŒ¹é…ï¼Œå¯¹apteråˆ™ä¸åŒ¹é…</li></ul></li></ul><h3 id="ä¸ªæ•°">ä¸ªæ•°</h3><ul><li>+: åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ª</li><li>{n,m}: é™åˆ¶åŒ¹é…ä¸ªæ•°</li><li>[0-9] åŒ¹é…å•ä¸ªæ•°å­—<ul><li>[0-9]+åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªæ•°å­—</li></ul></li></ul><h3 id="åŒ¹é…">åŒ¹é…</h3><ul><li><code>[abc]</code>: åŒ¹é…å•ä¸ªå­—ç¬¦a\b\c\dï¼Œæœ‰å°±åŒ¹é…<ul><li><code>[^abc]</code>: åŒ¹é…é™¤äº†æè¿°å­—ç¬¦é›†çš„æ‰€æœ‰å•ä¸ªå­—ç¬¦ï¼ˆç»“æœæ˜¯å•ä¸ªï¼‰</li><li><code>[a-z]</code>: åŒ¹é…a-zçš„æ‰€æœ‰å•ä¸ªå­—ç¬¦ï¼ˆç»“æœæ˜¯å•ä¸ªï¼‰</li></ul></li><li>. : åŒ¹é…é™¤äº†æ¢è¡Œç¬¦\n \rå¤–çš„æ‰€æœ‰å­—ç¬¦ = <code>[^\r\n]</code>(å•ä¸ª)</li><li><code>[\s\S]</code>: åŒ¹é…æ‰€æœ‰<ul><li>\s: åŒ¹é…æ‰€æœ‰ç©ºç™½ç¬¦</li><li>\S: åŒ¹é…éç©ºç™½ç¬¦</li></ul></li><li>\w: åŒ¹é…æ•°å­—ã€å­—æ¯ã€ä¸‹åˆ’çº¿ = [A-Za-z0-9]</li></ul><h4 id="éæ‰“å°å­—ç¬¦">éæ‰“å°å­—ç¬¦</h4><table><thead><tr><th style="text-align:left">å­—ç¬¦</th><th style="text-align:left">æè¿°</th></tr></thead><tbody><tr><td style="text-align:left">\cx</td><td style="text-align:left">åŒ¹é…ç”±xæŒ‡æ˜çš„æ§åˆ¶å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œ \cM åŒ¹é…ä¸€ä¸ª Control-M æˆ–å›è½¦ç¬¦ã€‚x çš„å€¼å¿…é¡»ä¸º A-Z æˆ– a-z ä¹‹ä¸€ã€‚å¦åˆ™ï¼Œå°† c è§†ä¸ºä¸€ä¸ªåŸä¹‰çš„ â€˜câ€™ å­—ç¬¦ã€‚</td></tr><tr><td style="text-align:left">\f</td><td style="text-align:left">åŒ¹é…ä¸€ä¸ªæ¢é¡µç¬¦ã€‚ç­‰ä»·äº \x0c å’Œ \cLã€‚</td></tr><tr><td style="text-align:left">\n</td><td style="text-align:left">åŒ¹é…ä¸€ä¸ªæ¢è¡Œç¬¦ã€‚ç­‰ä»·äº \x0a å’Œ \cJã€‚</td></tr><tr><td style="text-align:left">\r</td><td style="text-align:left">åŒ¹é…ä¸€ä¸ªå›è½¦ç¬¦ã€‚ç­‰ä»·äº \x0d å’Œ \cMã€‚</td></tr><tr><td style="text-align:left">\s</td><td style="text-align:left">åŒ¹é…ä»»ä½•ç©ºç™½å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦ç­‰ç­‰ã€‚ç­‰ä»·äº [ \f\n\r\t\v]ã€‚æ³¨æ„ Unicode æ­£åˆ™è¡¨è¾¾å¼ä¼šåŒ¹é…å…¨è§’ç©ºæ ¼ç¬¦ã€‚</td></tr><tr><td style="text-align:left">\S</td><td style="text-align:left">åŒ¹é…ä»»ä½•éç©ºç™½å­—ç¬¦ã€‚ç­‰ä»·äº [^ \f\n\r\t\v]ã€‚</td></tr><tr><td style="text-align:left">\t</td><td style="text-align:left">åŒ¹é…ä¸€ä¸ªåˆ¶è¡¨ç¬¦ã€‚ç­‰ä»·äº \x09 å’Œ \cIã€‚</td></tr><tr><td style="text-align:left">\v</td><td style="text-align:left">åŒ¹é…ä¸€ä¸ªå‚ç›´åˆ¶è¡¨ç¬¦ã€‚ç­‰ä»·äº \x0b å’Œ \cKã€‚</td></tr></tbody></table><h4 id="ç‰¹æ®Šå­—ç¬¦">ç‰¹æ®Šå­—ç¬¦</h4><table><thead><tr><th style="text-align:left">ç‰¹åˆ«å­—ç¬¦</th><th style="text-align:left">æè¿°</th></tr></thead><tbody><tr><td style="text-align:left">$</td><td style="text-align:left">åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„ç»“å°¾ä½ç½®ã€‚å¦‚æœè®¾ç½®äº† RegExp å¯¹è±¡çš„ Multiline å±æ€§ï¼Œåˆ™ $ ä¹ŸåŒ¹é… â€˜\nâ€™ æˆ– â€˜\râ€™ã€‚è¦åŒ¹é… $ å­—ç¬¦æœ¬èº«ï¼Œè¯·ä½¿ç”¨ <code>\$</code>ã€‚</td></tr><tr><td style="text-align:left">( )</td><td style="text-align:left">æ ‡è®°ä¸€ä¸ªå­è¡¨è¾¾å¼çš„å¼€å§‹å’Œç»“æŸä½ç½®ã€‚å­è¡¨è¾¾å¼å¯ä»¥è·å–ä¾›ä»¥åä½¿ç”¨ã€‚è¦åŒ¹é…è¿™äº›å­—ç¬¦ï¼Œè¯·ä½¿ç”¨ <code>\(</code> å’Œ <code>\)</code></td></tr><tr><td style="text-align:left">*</td><td style="text-align:left">åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡ã€‚è¦åŒ¹é… <code>*</code> å­—ç¬¦ï¼Œè¯·ä½¿ç”¨ <code>\*</code></td></tr><tr><td style="text-align:left">+</td><td style="text-align:left">åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚è¦åŒ¹é… + å­—ç¬¦ï¼Œè¯·ä½¿ç”¨ <code>\+</code>ã€‚</td></tr><tr><td style="text-align:left">.</td><td style="text-align:left">åŒ¹é…é™¤æ¢è¡Œç¬¦ \n ä¹‹å¤–çš„ä»»ä½•å•å­—ç¬¦ã€‚è¦åŒ¹é… . ï¼Œè¯·ä½¿ç”¨ <code>\.</code> ã€‚</td></tr><tr><td style="text-align:left">[</td><td style="text-align:left">æ ‡è®°ä¸€ä¸ªä¸­æ‹¬å·è¡¨è¾¾å¼çš„å¼€å§‹ã€‚è¦åŒ¹é… [ï¼Œè¯·ä½¿ç”¨ <code>\[</code>ã€‚</td></tr><tr><td style="text-align:left">?</td><td style="text-align:left">åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–ä¸€æ¬¡ï¼Œæˆ–æŒ‡æ˜ä¸€ä¸ªéè´ªå©ªé™å®šç¬¦ã€‚è¦åŒ¹é… ? å­—ç¬¦ï¼Œè¯·ä½¿ç”¨ <code>\?</code>ã€‚</td></tr><tr><td style="text-align:left">\</td><td style="text-align:left">å°†ä¸‹ä¸€ä¸ªå­—ç¬¦æ ‡è®°ä¸ºæˆ–ç‰¹æ®Šå­—ç¬¦ã€æˆ–åŸä¹‰å­—ç¬¦ã€æˆ–å‘åå¼•ç”¨ã€æˆ–å…«è¿›åˆ¶è½¬ä¹‰ç¬¦ã€‚ä¾‹å¦‚ï¼Œ â€˜nâ€™ åŒ¹é…å­—ç¬¦ â€˜nâ€™ã€‚â€˜\nâ€™ åŒ¹é…æ¢è¡Œç¬¦ã€‚åºåˆ— <code>\\</code> åŒ¹é… <code>\</code>ï¼Œè€Œ <code>\(</code> åˆ™åŒ¹é… â€œ(â€ã€‚</td></tr><tr><td style="text-align:left">^</td><td style="text-align:left">åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®ï¼Œé™¤éåœ¨æ–¹æ‹¬å·è¡¨è¾¾å¼ä¸­ä½¿ç”¨ï¼Œå½“è¯¥ç¬¦å·åœ¨æ–¹æ‹¬å·è¡¨è¾¾å¼ä¸­ä½¿ç”¨æ—¶ï¼Œè¡¨ç¤ºä¸æ¥å—è¯¥æ–¹æ‹¬å·è¡¨è¾¾å¼ä¸­çš„å­—ç¬¦é›†åˆã€‚è¦åŒ¹é… ^ å­—ç¬¦æœ¬èº«ï¼Œè¯·ä½¿ç”¨ <code>\^</code>ã€‚</td></tr><tr><td style="text-align:left">{</td><td style="text-align:left">æ ‡è®°é™å®šç¬¦è¡¨è¾¾å¼çš„å¼€å§‹ã€‚è¦åŒ¹é… {ï¼Œè¯·ä½¿ç”¨ <code>\&#123;</code>ã€‚</td></tr><tr><td style="text-align:left">|</td><td style="text-align:left">æŒ‡æ˜ä¸¤é¡¹ä¹‹é—´çš„ä¸€ä¸ªé€‰æ‹©ã€‚è¦åŒ¹é… |ï¼Œè¯·ä½¿ç”¨ <code>|</code>ã€‚</td></tr></tbody></table><h4 id="ç•Œå®šç¬¦">ç•Œå®šç¬¦</h4><table><thead><tr><th style="text-align:left">å­—ç¬¦</th><th style="text-align:left">æè¿°</th></tr></thead><tbody><tr><td style="text-align:left">*</td><td style="text-align:left">åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡ã€‚ä¾‹å¦‚ï¼Œzo* èƒ½åŒ¹é… â€œzâ€ ä»¥åŠ â€œzooâ€ã€‚* ç­‰ä»·äº{0,}ã€‚</td></tr><tr><td style="text-align:left">+</td><td style="text-align:left">åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€˜zo+â€™ èƒ½åŒ¹é… â€œzoâ€ ä»¥åŠ â€œzooâ€ï¼Œä½†ä¸èƒ½åŒ¹é… â€œzâ€ã€‚+ ç­‰ä»·äº {1,}ã€‚</td></tr><tr><td style="text-align:left">?</td><td style="text-align:left">åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–ä¸€æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€œdo(es)?â€ å¯ä»¥åŒ¹é… â€œdoâ€ ã€ â€œdoesâ€ ä¸­çš„ â€œdoesâ€ ã€ â€œdoxyâ€ ä¸­çš„ â€œdoâ€ ã€‚? ç­‰ä»·äº {0,1}ã€‚</td></tr><tr><td style="text-align:left">{n}</td><td style="text-align:left">n æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚åŒ¹é…<strong>ç¡®å®šçš„ n æ¬¡</strong>ã€‚ä¾‹å¦‚ï¼Œâ€˜o{2}â€™ ä¸èƒ½åŒ¹é… â€œBobâ€ ä¸­çš„ â€˜oâ€™ï¼Œä½†æ˜¯èƒ½åŒ¹é… â€œfoodâ€ ä¸­çš„ä¸¤ä¸ª oã€‚</td></tr><tr><td style="text-align:left">{n,}</td><td style="text-align:left">n æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚<strong>è‡³å°‘åŒ¹é…n æ¬¡</strong>ã€‚ä¾‹å¦‚ï¼Œâ€˜o{2,}â€™ ä¸èƒ½åŒ¹é… â€œBobâ€ ä¸­çš„ â€˜oâ€™ï¼Œä½†èƒ½åŒ¹é… â€œfooooodâ€ ä¸­çš„æ‰€æœ‰ oã€‚â€˜o{1,}â€™ ç­‰ä»·äº â€˜o+â€™ã€‚â€˜o{0,}â€™ åˆ™ç­‰ä»·äº â€˜o*â€™ã€‚</td></tr><tr><td style="text-align:left">{n,m}</td><td style="text-align:left">m å’Œ n å‡ä¸ºéè´Ÿæ•´æ•°ï¼Œå…¶ä¸­n &lt;= mã€‚æœ€å°‘åŒ¹é… n æ¬¡ä¸”æœ€å¤šåŒ¹é… m æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€œo{1,3}â€ å°†åŒ¹é… â€œfoooooodâ€ ä¸­çš„å‰ä¸‰ä¸ª oã€‚â€˜o{0,1}â€™ ç­‰ä»·äº â€˜o?â€™ã€‚<strong>æ³¨æ„åœ¨é€—å·å’Œä¸¤ä¸ªæ•°ä¹‹é—´ä¸èƒ½æœ‰ç©ºæ ¼ã€‚</strong></td></tr></tbody></table><h4 id="é€‰æ‹©">é€‰æ‹©</h4><ul><li>?=: exp1(?=exp2): æŸ¥æ‰¾exp2å‰é¢çš„<strong>exp1</strong><ul><li>zyl(?=[\d]+) : æŸ¥æ‰¾ä¸€ä¸²æ•°å­—å‰çš„zylå­—ç¬¦</li></ul></li><li>?&lt;: (?&lt;=exp2)exp1: æŸ¥æ‰¾exp2åé¢çš„<strong>exp1</strong><ul><li>(?&lt;=[\d]+)zyl: æŸ¥æ‰¾ä¸€ä¸²æ•°å­—åçš„zylå­—ç¬¦</li><li>(?&lt;!exp2)exp1: æŸ¥æ‰¾å‰é¢ä¸æ˜¯exp2çš„exp1</li></ul></li><li>?!: exp1(?!exp2): æŸ¥æ‰¾exp1åä¸æ˜¯exp2çš„å­—ç¬¦ä¸²</li></ul><h4 id="åå‘å¼•ç”¨">åå‘å¼•ç”¨</h4><p>å¯¹ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼æˆ–éƒ¨åˆ†æ¨¡å¼ä¸¤è¾¹æ·»åŠ åœ†æ‹¬å·å°†å¯¼è‡´ç›¸å…³åŒ¹é…å­˜å‚¨åˆ°ä¸€ä¸ª<strong>ä¸´æ—¶ç¼“å†²åŒº</strong>ä¸­ï¼Œæ‰€æ•è·çš„æ¯ä¸ªå­åŒ¹é…éƒ½æŒ‰ç…§åœ¨æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä¸­ä»å·¦åˆ°å³å‡ºç°çš„é¡ºåºå­˜å‚¨ã€‚<strong>ç¼“å†²åŒºç¼–å·ä» 1 å¼€å§‹ï¼Œæœ€å¤šå¯å­˜å‚¨ 99 ä¸ªæ•è·</strong>çš„å­è¡¨è¾¾å¼ã€‚</p><p>åå‘å¼•ç”¨çš„æœ€ç®€å•çš„ã€æœ€æœ‰ç”¨çš„åº”ç”¨ä¹‹ä¸€ï¼Œæ˜¯æä¾›æŸ¥æ‰¾æ–‡æœ¬ä¸­ä¸¤ä¸ªç›¸åŒçš„ç›¸é‚»å•è¯çš„åŒ¹é…é¡¹çš„èƒ½åŠ›ã€‚</p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># ä¾‹å¦‚ï¼šåŒ¹é…ç›¸é‚»ä¸”ç›¸åŒçš„å•è¯</span>a <span class="token operator">=</span> <span class="token string">"Is is the cost of of gasoline going up up"</span><span class="token comment"># /\b([a-z]+) \1\b/gi</span><span class="token comment"># \b([a-z]+) è¡¨ç¤ºå°†åŒ¹é…å•è¯å¹¶å­˜å…¥åˆ°ç¼“å­˜ä¸­</span><span class="token comment"># \1\bè¡¨ç¤ºåˆšåˆšçš„é‚£ä¸ªå•è¯ï¼Œå®ç°äº†é‡å¤åˆ©ç”¨</span><span class="token comment"># æ³¨æ„ï¼šå®Œæˆä¸€æ¬¡åŒ¹é…åï¼Œ()ç¼“å­˜ä¼šæ¸…ç©ºäº†</span></code></pre></div><h2 id="ä¿®é¥°ç¬¦">ä¿®é¥°ç¬¦</h2><p>å†™åœ¨è¡¨è¾¾å¼å¤–ï¼Œç”¨äºæŒ‡å®šé¢å¤–çš„åŒ¹é…ç­–ç•¥</p><table><thead><tr><th style="text-align:left">ä¿®é¥°ç¬¦</th><th style="text-align:left">å«ä¹‰</th><th style="text-align:left">æè¿°</th></tr></thead><tbody><tr><td style="text-align:left">i</td><td style="text-align:left">ignore - ä¸åŒºåˆ†å¤§å°å†™</td><td style="text-align:left">å°†åŒ¹é…è®¾ç½®ä¸ºä¸åŒºåˆ†å¤§å°å†™ï¼Œæœç´¢æ—¶ä¸åŒºåˆ†å¤§å°å†™: A å’Œ a æ²¡æœ‰åŒºåˆ«ã€‚</td></tr><tr><td style="text-align:left">g</td><td style="text-align:left">global - å…¨å±€åŒ¹é…</td><td style="text-align:left">æŸ¥æ‰¾æ‰€æœ‰çš„åŒ¹é…é¡¹ã€‚</td></tr><tr><td style="text-align:left">m</td><td style="text-align:left">multi line - å¤šè¡ŒåŒ¹é…</td><td style="text-align:left">ä½¿è¾¹ç•Œå­—ç¬¦ <strong>^</strong> å’Œ <strong>$</strong> åŒ¹é…æ¯ä¸€è¡Œçš„å¼€å¤´å’Œç»“å°¾ï¼Œè®°ä½æ˜¯å¤šè¡Œï¼Œè€Œä¸æ˜¯æ•´ä¸ªå­—ç¬¦ä¸²çš„å¼€å¤´å’Œç»“å°¾ã€‚</td></tr><tr><td style="text-align:left">s</td><td style="text-align:left">ç‰¹æ®Šå­—ç¬¦åœ†ç‚¹ <strong>.</strong> ä¸­åŒ…å«æ¢è¡Œç¬¦ <strong>\n</strong></td><td style="text-align:left">é»˜è®¤æƒ…å†µä¸‹çš„åœ†ç‚¹ <strong>.</strong> æ˜¯åŒ¹é…é™¤æ¢è¡Œç¬¦ <strong>\n</strong> ä¹‹å¤–çš„ä»»ä½•å­—ç¬¦ï¼ŒåŠ ä¸Š <strong>s</strong> ä¿®é¥°ç¬¦ä¹‹å, <strong>åœ¨åŒ¹é…çš„ç»“æœä¸­åŒ…å«æ¢è¡Œç¬¦ \n</strong></td></tr></tbody></table><p>å¦‚æœå¯¹å¤šè¡Œå­—ç¬¦ä¸²â€™abc\n acss\nâ€™ä¸ä½¿ç”¨-mï¼Œåˆ™^aåªèƒ½åŒ¹é…åˆ°ä¸€ä¸ªç»“æœï¼Œåä¹‹åˆ™ä¼šæœ‰å¤šä¸ªç»“æœ</p><h2 id="åŒ¹é…æ¡ˆä¾‹">åŒ¹é…æ¡ˆä¾‹</h2><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>0-9 <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p></li></ol></section>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>RE</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Pythonçˆ¬è™«å…¥é—¨</title>
    <link href="/2022/04/21/Python%E7%88%AC%E8%99%AB%E5%85%A5%E9%97%A8/"/>
    <url>/2022/04/21/Python%E7%88%AC%E8%99%AB%E5%85%A5%E9%97%A8/</url>
    
    <content type="html"><![CDATA[<h1>Pythonçˆ¬è™«å…¥é—¨</h1><blockquote><p>åˆè¡·ï¼šå¸Œæœ›èƒ½ä»Leetcodeä¸Šçˆ¬å–ä¸ªäººç™»å½•ä¸€å¹´çš„æ¯å¤©æäº¤æ¬¡æ•°çš„jsonï¼Œé€šè¿‡mouse inè§¦å‘jsäº‹ä»¶çš„ç„¶åç»˜åˆ¶çš„HTMLå—ï¼Œå¸Œæœ›å­¦ä¹ å®Œåèƒ½å¤Ÿåšåˆ°ï¼Œä¹Ÿèƒ½è½»æ¾çˆ¬å–è±†ç“£ç­‰èµ„æº</p><p>è¿™ç¯‡æ–‡ç« æ¶‰åŠåˆ°çš„çŸ¥è¯†ï¼š</p><ul><li>Python Lib: Scrapy Re BeautifulSoup Selenium XPath</li><li>Web: Request Response Cookie Session</li><li>Chrome: Debug-Tips</li></ul></blockquote><h2 id="Request">Request</h2><p><a href="https://docs.python-requests.org/zh_CN/latest/user/quickstart.html">å¿«é€Ÿä¸Šæ‰‹</a></p><h3 id="è¾¨æ">è¾¨æ</h3><p><strong>æ­£å¸¸ä»é¡µé¢è®¿é—®ï¼Œè¿”å›çš„Requestçš„è¯·æ±‚å¤´</strong></p><div class="code-wrapper"><pre class="language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">/</span> <span class="token http-version property">HTTP/1.1</span></span><span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span><span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span><span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">zh-CN,zh;q=0.9</span></span><span class="token header"><span class="token header-name keyword">Cache-Control</span><span class="token punctuation">:</span> <span class="token header-value">max-age=0</span></span><span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">__vtins__Jf1FrphVHSZkysQl=%7B%22sid%22%3A%20%2256fa7d47-8eae-5875-ad17-c0ec88a3cc8a%22%2C%20%22vd%22%3A%201%2C%20%22stt%22%3A%200%2C%20%22dr%22%3A%200%2C%20%22expires%22%3A%201650535320988%2C%20%22ct%22%3A%201650533520988%7D; __51uvsct__Jf1FrphVHSZkysQl=1; __51vcke__Jf1FrphVHSZkysQl=af87f021-3cf9-5d99-952d-95d503a0a38f; __51vuft__Jf1FrphVHSZkysQl=1650533520995</span></span><span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">www.pplong.top</span></span><span class="token header"><span class="token header-name keyword">If-Modified-Since</span><span class="token punctuation">:</span> <span class="token header-value">Thu, 21 Apr 2022 06:26:32 GMT</span></span><span class="token header"><span class="token header-name keyword">If-None-Match</span><span class="token punctuation">:</span> <span class="token header-value">"6260f918-9669"</span></span><span class="token header"><span class="token header-name keyword">Proxy-Connection</span><span class="token punctuation">:</span> <span class="token header-value">keep-alive</span></span><span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span><span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.60 Safari/537.36</span></span></code></pre></div><p><strong>é€šè¿‡Requestè®¿é—®ï¼Œè¿”å›çš„è¯·æ±‚å¤´</strong></p><div class="code-wrapper"><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span> 'Server'<span class="token operator">:</span> 'nginx/<span class="token number">1.14</span>.<span class="token number">1</span>'<span class="token punctuation">,</span>  'Date'<span class="token operator">:</span> 'Thu<span class="token punctuation">,</span> <span class="token number">21</span> Apr <span class="token number">2022</span> <span class="token number">09</span><span class="token operator">:</span><span class="token number">32</span><span class="token operator">:</span><span class="token number">48</span> GMT'<span class="token punctuation">,</span>  'Content-Type'<span class="token operator">:</span> 'text/html'<span class="token punctuation">,</span>  'Content-Length'<span class="token operator">:</span> '<span class="token number">38505</span>'<span class="token punctuation">,</span>  'Last-Modified'<span class="token operator">:</span> 'Thu<span class="token punctuation">,</span> <span class="token number">21</span> Apr <span class="token number">2022</span> <span class="token number">06</span><span class="token operator">:</span><span class="token number">26</span><span class="token operator">:</span><span class="token number">32</span> GMT'<span class="token punctuation">,</span>  'Connection'<span class="token operator">:</span> 'keep-alive'<span class="token punctuation">,</span> 'ETag'<span class="token operator">:</span> '<span class="token string">"6260f918-9669"</span>'<span class="token punctuation">,</span>  'Accept-Ranges'<span class="token operator">:</span> 'bytes'<span class="token punctuation">&#125;</span></code></pre></div><p>æ­£å¸¸å¾—åˆ°äº†å†…å®¹ï¼Œä½†è¯·æ±‚å¤´ä¸ä¸€æ ·ï¼ˆå› ä¸ºRequestå’ŒChromeå¯¹è¯·æ±‚å¤´çš„åŒ…è£…ä¸åŒï¼‰</p><h3 id="è¿‡æ»¤">è¿‡æ»¤</h3><p>ä»è±†ç“£è·å–jsonçš„apiä¸­ï¼Œå¦‚æœé€šè¿‡æµè§ˆå™¨è®¿é—®ï¼Œèƒ½å¤Ÿæ­£å¸¸å¾—åˆ°jsoné¡µé¢ï¼Œä½†å¦‚æœé€šè¿‡requestå¾—åˆ°ï¼Œåˆ™å¾—ä¸åˆ°ï¼Œè¿™é‡Œå°±å¯èƒ½æ˜¯æœåŠ¡å™¨åœ¨æ¥æ”¶åˆ°Requestæ—¶ä¼šå»æ£€æŸ¥è¯·æ±‚å¤´æœ‰æ— è®¾ç½®ä¸€äº›ç‰¹æ®Šçš„å‚æ•°ã€‚æˆ‘å…ˆåœ¨Chromeä¸Šå»è·å–äº†è¿™ä¸ªé¡µé¢ï¼Œé¿å…cookieå’Œå…¶ä»–çš„è¯·æ±‚å¤´å‚æ•°ï¼Œæˆ‘ä½¿ç”¨æ–°çš„firefoxå»è®¿é—®è¿™ä¸ªé¡µé¢ï¼Œå‘ç°è¿˜æ˜¯å¯ä»¥è®¿é—®ï¼Œè¯´æ˜ä¸å­˜åœ¨cookieç­‰çš„å› ç´ ï¼Œè€ƒè™‘æ˜¯æ²¡æœ‰pythonä¸­requestæ²¡æœ‰User-Agentè¯·æ±‚å¤´ï¼Œå°†Chromeçš„å¤åˆ¶å¹¶æ·»åŠ åˆ°Requestä¸­ï¼Œå‘ç°èƒ½å¤Ÿæ­£å¸¸è¯·æ±‚ã€‚</p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.60 Safari/537.36'</span><span class="token punctuation">&#125;</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'https://movie.douban.com/j/chart/top_list?type=24&amp;interval_id=100%3A90&amp;action=&amp;start=0&amp;limit=20'</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>r<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">'utf-8'</span><span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span></code></pre></div><p>ä½†è®©äººç–‘æƒ‘çš„æ˜¯ï¼Œæœ€åå»æ‰“å°request.headersï¼Œå‘ç°å´æ²¡æœ‰æ–°åŠ çš„è¿™äº›å‚æ•°ï¼Œä½†ä¸ºä»€ä¹ˆåˆèƒ½å¤Ÿæ­£å¸¸çš„å‘é€è¯·æ±‚ï¼Ÿè¿™é‡Œè¿˜ä¸æ˜¯å¾ˆæ¸…æ¥šï¼ˆå› ä¸ºæˆ‘è‡ªå·±ä¹Ÿè®¾ç½®äº†ä»£ç†ï¼Œä¸æ¸…æ¥šæ˜¯å¦æ˜¯ä»£ç†é€ æˆçš„é—®é¢˜ï¼‰å¼•ç”¨ä¸€ä¸‹å®˜æ–¹çš„è¯ï¼š</p><blockquote><p>æ³¨æ„: å®šåˆ¶ header çš„ä¼˜å…ˆçº§ä½äºæŸäº›ç‰¹å®šçš„ä¿¡æ¯æºï¼Œä¾‹å¦‚ï¼š</p><ul><li>å¦‚æœåœ¨ <code>.netrc</code> ä¸­è®¾ç½®äº†ç”¨æˆ·è®¤è¯ä¿¡æ¯ï¼Œä½¿ç”¨ headers= è®¾ç½®çš„æˆæƒå°±ä¸ä¼šç”Ÿæ•ˆã€‚è€Œå¦‚æœè®¾ç½®äº† <code>auth=</code> å‚æ•°ï¼Œ<code>.netrc</code> çš„è®¾ç½®å°±æ— æ•ˆäº†ã€‚</li><li>å¦‚æœè¢«é‡å®šå‘åˆ°åˆ«çš„ä¸»æœºï¼Œæˆæƒ header å°±ä¼šè¢«åˆ é™¤ã€‚</li><li>ä»£ç†æˆæƒ header ä¼šè¢« URL ä¸­æä¾›çš„ä»£ç†èº«ä»½è¦†ç›–æ‰ã€‚</li><li>åœ¨æˆ‘ä»¬èƒ½åˆ¤æ–­å†…å®¹é•¿åº¦çš„æƒ…å†µä¸‹ï¼Œheader çš„ Content-Length ä¼šè¢«æ”¹å†™ã€‚</li></ul><p>æ›´è¿›ä¸€æ­¥è®²ï¼ŒRequests ä¸ä¼šåŸºäºå®šåˆ¶ header çš„å…·ä½“æƒ…å†µæ”¹å˜è‡ªå·±çš„è¡Œä¸ºã€‚åªä¸è¿‡åœ¨æœ€åçš„è¯·æ±‚ä¸­ï¼Œæ‰€æœ‰çš„ header ä¿¡æ¯éƒ½ä¼šè¢«ä¼ é€’è¿›å»ã€‚</p></blockquote><h3 id="æ•°æ®">æ•°æ®</h3><p>ä¸€ä¸ªè¯·æ±‚ç™¾åº¦ç¿»è¯‘çš„ä¾‹å­ï¼Œæ‰¾åˆ°å¯¹åº”Postæ–¹å¼çš„è¯·æ±‚ï¼Œé€šè¿‡è¯·æ±‚å¤´æ˜ç¡®å…¶Request URLï¼ŒæŸ¥çœ‹å…¶è¯·æ±‚ä½“ï¼Œåˆ™å¯ä»¥å¼€å§‹ç¼–å†™å¸¦dataçš„Postè¯·æ±‚</p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">'kw'</span><span class="token punctuation">:</span> <span class="token string">'dog'</span><span class="token punctuation">&#125;</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">'https://fanyi.baidu.com/sug'</span><span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>r<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">'utf-8'</span><span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>headers<span class="token punctuation">)</span></code></pre></div><p><strong>çˆ¬å–æ•°æ®åï¼Œè®°å¾—closeå…³é—­è¿™ä¸ªè¯·æ±‚</strong></p><h3 id="è¿›é˜¶-v2">è¿›é˜¶</h3><h4 id="ç™»å½•å¤„ç†-Cookie">ç™»å½•å¤„ç† Cookie</h4><p>ç†è§£æ­£å¸¸ç™»å½•æµç¨‹ï¼šç™»å½•æˆåŠŸåä¸ºä»€ä¹ˆä¸ç”¨å†æ¬¡ç™»å½•ï¼ŸCookieä¸­å«æœ‰åŠ å¯†çš„ä¿¡æ¯ï¼Œä¸è®¾å¤‡ä¿¡æ¯æ˜¯ç»‘å®šçš„ã€‚</p><p>sessionï¼šä¸€è¿ä¸²çš„çš„è¯·æ±‚ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­cookieä¸ä¼šæ¶ˆå¤±ï¼Œé€šè¿‡session.post session.getæ¥ä¿æŒä¼šè¯ï¼Œä¿å­˜cookie</p><h4 id="å®æˆ˜">å®æˆ˜</h4><h5 id="Referrerçš„åº”ç”¨â€“æ¢¨è§†é¢‘æŠ“å–">Referrerçš„åº”ç”¨â€“æ¢¨è§†é¢‘æŠ“å–</h5><p>æŠ“å–æ¢¨è§†é¢‘å•ä¸ªè§†é¢‘çš„æ¡ˆä¾‹</p><p><strong>ä¸€ä¸ªæœ‰æ„æ€çš„ç‚¹â€“ä¸»é¡µé¢å’Œè¯·æ±‚çš„ä¸åŒç‚¹</strong></p><p>Google-Chromeçš„F12å¼€å‘å·¥å…·ä¸­æ˜¾ç¤ºçš„å…¶å®æ˜¯åŠ¨æ€çš„HTMLé¡µé¢ï¼ˆåŸç”Ÿ + JSä»£ç åˆ›å»ºçš„ï¼‰ï¼Œè€ŒæŸ¥çœ‹<strong>ç½‘é¡µæºä»£ç </strong>ï¼Œå…¶å®åªæ˜¯æŸ¥çœ‹çš„æ˜¯å¯¹åº”çš„ä¸€æ¡ä¸»HTMLé¡µé¢è¯·æ±‚çš„é¡µé¢ï¼Œæ˜¯ä¸åŒ…å«JSçš„ï¼Œåªè¿”å›ä¸€ä¸ªHTMLé¡µé¢ã€‚è¿™å°±é€ æˆäº†ä¸€ä¸ªç°è±¡ï¼Œæ¯”å¦‚æ¢¨è§†é¢‘èƒ½åœ¨F12ä¸­çœ‹åˆ°videoæ ‡ç­¾ï¼Œä½†åœ¨é¡µé¢æºä»£ç å†…çœ‹ä¸åˆ°ï¼Œä¾§é¢è¯´æ˜äº†å…¶å®videoæ ‡ç­¾æ˜¯ é€šè¿‡jsåŠ¨æ€åŠ è½½åˆ°ä¸»é¡µé¢çš„</p><div class="note note-primary">            <p>Tips:  <img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220421210323532.png" alt="image-20220421210323532">ç‚¹å‡»å¼€å‘è€…å·¥å…·çš„è¿™ä¸ªæŒ‰é’®ï¼Œèƒ½å¤Ÿè‡ªç”±çš„åœ¨é¡µé¢ä¸Šé€‰æ‹©å¹¶å®šä½å…ƒç´ ï¼Œå†ä¹Ÿä¸ç”¨ä¸€æ­¥ä¸€æ­¥çš„æ‰¾äº†ï¼</p>          </div><p>ä½è¿™é‡Œå‘ç°å…¶å®å•ä¸ªè§†é¢‘é¡µé¢ï¼Œæ¢¨è§†é¢‘ä¼šè¿”å›ä¸€ä¸ªè§†é¢‘çš„jsonï¼ŒåŒ…å«è§†é¢‘çš„urlï¼Œä½†ç‹¬ç«‹é€šè¿‡urlè®¿é—®è§†é¢‘æ—¶ï¼Œå´æ— æ³•è®¿é—®ï¼ˆ404ï¼‰å†æ¬¡åˆ†æï¼ŒHTML videoæ ‡ç­¾å†…çš„srcæ˜¯æœ‰æ•ˆçš„</p><div class="code-wrapper"><pre class="language-sh" data-language="sh"><code class="language-sh"># video_image: &quot;https:&#x2F;&#x2F;image1.pearvideo.com&#x2F;cont&#x2F;20220418&#x2F;cont-1759035-12669061.jpeg&quot;https:&#x2F;&#x2F;video.pearvideo.com&#x2F;mp4&#x2F;adshort&#x2F;20220418&#x2F;cont-1759035-15863820_adpkg-ad_hd.mp4 # è½¬ä¹‰çš„ æœ‰æ•ˆhttps:&#x2F;&#x2F;video.pearvideo.com&#x2F;mp4&#x2F;adshort&#x2F;20220418&#x2F;1650545630017-15863820_adpkg-ad_hd.mp4 # åŸå§‹çš„ æ— æ•ˆ</code></pre></div><p>å‘ç°ä»…æœ‰ä¸­é—´éƒ¨åˆ†ä¸ä¸€è‡´ï¼Œå…¶ä¸­1650545630017æ˜¯å½“å‰æ—¶é—´æˆ³ï¼Œcont-1759035æ­£å¥½ä»£è¡¨äº†å›¾ç‰‡imageçš„æè¿°ï¼Œè¯´æ˜åå°åœ¨å†…éƒ¨è¿›è¡Œäº†è½¬æ¢ï¼Œä½¿å¾—ä¸èƒ½ç›´æ¥ä»jsonè¿”å›çš„urlè¯»åˆ°åœ°å€ï¼ˆä½†å…¶å®è¿˜æ˜¯å¯ä»¥çš„ï¼‰</p><p>ç›´æ¥å¯¹è¯¥api urlçš„åœ°å€è¿›è¡Œè®¿é—®ï¼Œä¼šè¿”å›å¼‚å¸¸æƒ…å†µï¼ŒåŠ ä¸ŠU-A Cookieï¼Œå‘ç°ä¹Ÿæ²¡æœ‰ç”¨</p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">header <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'...'</span><span class="token punctuation">,</span>    <span class="token string">'Cookie'</span><span class="token punctuation">:</span> <span class="token string">'...'</span><span class="token punctuation">&#125;</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'https://www.pearvideo.com/videoStatus.jsp?contId=1759035&amp;mrd=0.8055881311378088'</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>header<span class="token punctuation">)</span>r<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">'utf-8'</span><span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token comment"># "resultMsg":"è¯¥æ–‡ç« å·²ç»ä¸‹çº¿ï¼",</span></code></pre></div><p>è¿™æ—¶å°±ä½“ç°å‡ºè¯·æ±‚å¤´é˜²ç›—é“¾Referrerçš„ä½œç”¨äº†ï¼Œä»€ä¹ˆæ˜¯Referrerï¼ŒReferrerå°±æ˜¯ä½ ä»å“ªä¸ªé¡µé¢è®¿é—®çš„è¿™ä¸ªé¡µé¢ï¼ŒæŒ‡å‘çš„æ˜¯ä¸Šä¸€ä¸ªé¡µé¢çš„urlï¼Œè¯·æ±‚å¤´ä¸ŠåŠ ä¸Šæ­£ç¡®çš„Referrerï¼Œåˆ™å¯ä»¥è®¿é—®åˆ°æ•°æ®ã€‚è¿™é‡Œå°±è¯´æ˜ç½‘ç«™ä»…å¯¹Referrerè¿›è¡Œäº†ç­›æŸ¥ï¼Œæ­£ç¡®çš„Referreræ‰æ”¾è¡Œ</p><h4 id="æ³¨æ„ç‚¹">æ³¨æ„ç‚¹</h4><h2 id="æ•°æ®è§£æ">æ•°æ®è§£æ</h2><p>ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®è§£æï¼Ÿ</p><p><strong>ä¸€äº›æ•°æ®æ²¡æœ‰é€šè¿‡apiè¿›è¡Œjsonè¿”å›ï¼Œè€Œæ˜¯ç›´æ¥åµŒåœ¨äº†HTMLé‡Œé¢</strong></p><h3 id="Re">Re</h3><p>Regular Expression ï¼šæ­£åˆ™è¡¨è¾¾å¼</p><p>é€Ÿåº¦å¿«ï¼Œæ•ˆç‡é«˜ã€å‡†ç¡®æ€§é«˜</p><h3 id="XPath">XPath</h3><p>XPath: XML Path Language ï¼Œæœ€åˆç”¨äºåœ¨XMLä¸­æœç´¢ï¼Œç”±äºXMLä¸HTMLç»“æ„ç›¸ä¼¼æ€§ï¼ŒåŒæ ·å¯ä»¥ç”¨äºHTMLå…ƒç´ æœç´¢ã€‚<strong>ä½¿ç”¨è·¯å¾„è¡¨è¾¾å¼åœ¨XMLä¸­è¿›è¡Œå¯¼èˆª</strong></p><p>ä¸ºä»€ä¹ˆæ˜¯å®ƒï¼Ÿæä¾›éå¸¸é—´æ¥æ˜äº†çš„è·¯å¾„é€‰æ‹©è¡¨è¾¾å¼ï¼Œæ–¹ä¾¿çš„å¯»æ‰¾èŠ‚ç‚¹</p><h4 id="åŒ¹é…è§„åˆ™">åŒ¹é…è§„åˆ™</h4><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> lxml <span class="token keyword">import</span> etreehtml <span class="token operator">=</span>  etree<span class="token punctuation">.</span>parse<span class="token punctuation">(</span><span class="token string">'./index.html'</span><span class="token punctuation">,</span> etree<span class="token punctuation">.</span>HTMLParser<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>result <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*'</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token comment"># æ‰“å°çš„æ˜¯é¡µé¢æ‰€æœ‰çš„å…ƒç´ èŠ‚ç‚¹æŒ‡é’ˆ</span></code></pre></div><ul><li>//tagï¼šä»£è¡¨è¦è·å–çš„æ ‡ç­¾å</li><li>//tag/aï¼štagæ ‡ç­¾ä¸‹çš„æ‰€æœ‰aæ ‡ç­¾å­èŠ‚ç‚¹</li><li>//tag//aï¼štagæ ‡ç­¾ä¸‹æ‰€æœ‰å­å­™aæ ‡ç­¾èŠ‚ç‚¹</li><li>//tag[@key=â€˜valueâ€™]ï¼štagæ ‡ç­¾ä¸‹æ‰€æœ‰å±æ€§ä¸ºkey å€¼ä¸ºvalueçš„èŠ‚ç‚¹ï¼ˆç²¾ç¡®åŒ¹é…ï¼‰<ul><li>å±æ€§æœ‰å¤šä¸ªå€¼ï¼Œç²¾ç¡®åŒ¹é…åˆ™æ— æ•ˆã€‚éœ€è¦ç”¨åˆ°//tag[<strong>contains</strong>(@key,â€œvalueâ€)]æ¥è¡¨ç¤º</li><li>å¤šå±æ€§åŒ¹é…ï¼š//tag[@class=â€˜aâ€™ <strong>and</strong> @key=â€˜valueâ€™]ï¼Œè¿˜å¯ä»¥ç”¨or mod != &gt; &lt; &lt;=ç­‰</li></ul></li><li>//tag/â€¦/ï¼štagæ ‡ç­¾çš„çˆ¶æ ‡ç­¾</li><li>//tag/@keyï¼štagæ ‡ç­¾ä¸‹keyå±æ€§çš„å€¼</li><li>//tag/a/text()ï¼šè·å–tagæ ‡ç­¾çš„å­èŠ‚ç‚¹aæ ‡ç­¾çš„textå†…å®¹ï¼ˆå¯ä»¥ç†è§£ä¸ºinnerHTMLï¼Ÿï¼‰</li><li>æŒ‡å®šä½ç½®é€‰å–ï¼š<ul><li>//tag[1] ï¼šé€‰å–ç¬¬äºŒä¸ªtagèŠ‚ç‚¹</li><li>//tag[last()]ï¼šæœ€åä¸€ä¸ªèŠ‚ç‚¹</li><li>//tag[position()â¤ï¸]ï¼šç´¢å¼•ä½ç½®å°äº3</li><li>//tag[last() - 2]ï¼šå€’æ•°ä¸‰ä¸ªå…ƒç´ </li></ul></li><li>èŠ‚ç‚¹è½´ï¼š<ul><li>//tag/ancestor:: *ï¼šè·å–tagæ‰€æœ‰ç¥–å…ˆèŠ‚ç‚¹ï¼ˆåŒ…æ‹¬htmlï¼‰</li><li>//tag/ancestor::div ï¼šè·å–tagä¸ºdivçš„<strong>ç¥–å…ˆ</strong>èŠ‚ç‚¹</li><li>//tag/attribue:: * ï¼šè¿”å›tagæ ‡ç­¾çš„æ‰€æœ‰å±æ€§å€¼</li><li>//tag/child:: *ï¼štagæ ‡ç­¾ æ‰€æœ‰<strong>ç›´æ¥</strong> å­èŠ‚ç‚¹</li><li>//tag/descendant:: *ï¼štagæ ‡ç­¾æ‰€æœ‰å­å­™èŠ‚ç‚¹</li><li>//tag/following:: *[2] ï¼štagæ ‡ç­¾åç¬¬ä¸‰ä¸ªèŠ‚ç‚¹</li><li>//tag/following-siblingï¼štagæ ‡ç­¾çš„åŒçº§èŠ‚ç‚¹</li></ul></li></ul><div class="note note-info">            <p>å‚è€ƒï¼š<a href="https://www.w3school.com.cn/xpath">W3CSchool</a></p>          </div><h2 id="Selenium">Selenium</h2><h2 id="Scrapy">Scrapy</h2><p><strong>ç‰¹ç‚¹</strong>ï¼šå¼‚æ­¥æ€§ï¼šå¼‚æ­¥å‘é€å¤šä¸ªçˆ¬å–è¯·æ±‚ï¼›ç¤¼è²Œæ€§ï¼šé™åˆ¶çˆ¬å–é€Ÿç‡ã€é™åˆ¶æ¯ä¸ªåŸŸå’ŒIPçš„å¹¶å‘è¯·æ±‚é‡</p><p>å®‰è£…Scrapyåº“</p><p>Pycharmå¯¹åº”é¡¹ç›®ç›´æ¥pip install scrapy</p><p>scrapy startproject xxxåˆ›å»ºä¸€ä¸ªscrapyé¡¹ç›®ï¼Œé¡¹ç›®ä¸­åˆå§‹ç»“æ„ï¼š</p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">tutorial<span class="token operator">/</span>    scrapy<span class="token punctuation">.</span>cfg            <span class="token comment"># deploy configuration file</span>    tutorial<span class="token operator">/</span>             <span class="token comment"># project's Python module, you'll import your code from here</span>        __init__<span class="token punctuation">.</span>py        items<span class="token punctuation">.</span>py          <span class="token comment"># project items definition file</span>        middlewares<span class="token punctuation">.</span>py    <span class="token comment"># project middlewares file</span>        pipelines<span class="token punctuation">.</span>py      <span class="token comment"># project pipelines file</span>        settings<span class="token punctuation">.</span>py       <span class="token comment"># project settings file</span>        spiders<span class="token operator">/</span>          <span class="token comment"># a directory where you'll later put your spiders</span>            __init__<span class="token punctuation">.</span>py</code></pre></div><h3 id="å…¥é—¨">å…¥é—¨</h3><p><strong>åˆ›å»ºç¬¬ä¸€ä¸ªScrapyè„šæœ¬</strong></p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> scrapy<span class="token keyword">class</span> <span class="token class-name">QuoteSpider</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Spider<span class="token punctuation">)</span><span class="token punctuation">:</span>    name <span class="token operator">=</span> <span class="token string">"quotes"</span><span class="token comment"># ä¹Ÿå¯ä»¥é€šè¿‡å†…ç½®å˜é‡start_urlså®šä¹‰urlï¼Œæ­¤æ—¶é»˜è®¤callbackä¸ºparse</span>    <span class="token keyword">def</span> <span class="token function">start_requests</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        urls <span class="token operator">=</span> <span class="token punctuation">[</span>            <span class="token string">'https://quotes.toscrape.com/page/1/'</span><span class="token punctuation">,</span>            <span class="token string">'https://quotes.toscrape.com/page/2/'</span><span class="token punctuation">,</span>        <span class="token punctuation">]</span>        <span class="token keyword">for</span> url <span class="token keyword">in</span> urls<span class="token punctuation">:</span>            <span class="token keyword">yield</span> scrapy<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> callback<span class="token operator">=</span>self<span class="token punctuation">.</span>parse<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">parse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>        page <span class="token operator">=</span> response<span class="token punctuation">.</span>url<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span>        filename <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'quotes-</span><span class="token interpolation"><span class="token punctuation">&#123;</span>page<span class="token punctuation">&#125;</span></span><span class="token string">.html'</span></span>        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>response<span class="token punctuation">.</span>body<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'Saved file </span><span class="token interpolation"><span class="token punctuation">&#123;</span>filename<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></code></pre></div><ul><li>name:å¿…é¡»æ˜¯ç‹¬ç‰¹çš„</li><li>start_requests: å®šä¹‰ç›®æ ‡urlä¸callback</li><li>parseï¼šrequestå¾—åˆ°responseåè§£æé¡µé¢ï¼Œè¿›è¡Œæ“ä½œ</li></ul><p>scrapy crawl xxxå¼€å§‹æ‰§è¡Œè¿™ä¸ªçˆ¬è™«é¡¹ç›®</p><div class="note note-primary">            <p>ä¸ºä»€ä¹ˆç”¨åœ¨start_requestä¸­ç”¨yieldï¼Ÿ</p><p>å› ä¸ºæœ‰å¤šä¸ªé¡µé¢ï¼Œè¦åˆ†åˆ«å¯¹å…¶è¿›è¡Œè§£æï¼Œä½¿å…¶åœ¨ä¸€æ”¶åˆ°ç›¸åº”ä½“åè°ƒç”¨åˆ†åˆ«çš„callbackå¯¹å…¶è¿›è¡Œè§£æï¼Œè€Œä¸æ˜¯ç­‰å¾…æ‰€æœ‰urlè¯·æ±‚çš„ç½‘é¡µç»“æ„ä½“è¿”å›åä¸€æ¬¡æ€§è§£æ</p>          </div><h2 id="åŸºç¡€æ¡ˆä¾‹">åŸºç¡€æ¡ˆä¾‹</h2><div class="note note-primary">            <p>ä»¥ä¸‹æ¡ˆä¾‹ä»…ç”¨äºåˆå§‹é˜¶æ®µå­¦ä¹ ï¼Œåç»­è¿›é˜¶æ¡ˆä¾‹è¯·å‰å¾€<a href="http://www.pplong.top/2022/04/30/Python%E7%88%AC%E8%99%AB%E6%A1%88%E4%BE%8B%E6%95%B4%E5%90%88/">Pythonçˆ¬è™«æ¡ˆä¾‹æ•´åˆ</a></p>          </div><h3 id="çˆ¬å–ç½‘æ˜“äº‘éŸ³ä¹è¯„è®º">çˆ¬å–ç½‘æ˜“äº‘éŸ³ä¹è¯„è®º</h3><h4 id="ç»“æ„ç ”ç©¶">ç»“æ„ç ”ç©¶</h4><p>å…ˆæŸ¥çœ‹ç½‘é¡µç»“æ„ï¼Œå‘ç°ç½‘é¡µæºä»£ç ä¸­æ˜¯å®Œå…¨æ²¡æœ‰è¯„è®ºç›¸å…³çš„å†…å®¹çš„ï¼Œè¯´æ˜æ˜¯ç½‘é¡µæ˜¯é€šè¿‡urlè¯·æ±‚åæœŸä½¿ç”¨jsåŠ è½½çš„ï¼Œæ‰€ä»¥ç›´æ¥å®šä½åˆ°urlä¸­</p><p>åœ¨è‹¥å¹²ä¸ªè¯·æ±‚ä¸­åˆ†æurlå†…å®¹ï¼Œå‘ç°åŒ¹é…é¡¹ï¼š</p><p><a href="https://music.163.com/weapi/comment/resource/comments/get?csrf_token=%E5%A4%A7%E6%A6%82%E9%95%BF%E8%BF%99%E6%A0%B7%EF%BC%8C">https://music.163.com/weapi/comment/resource/comments/get?csrf_token=å¤§æ¦‚é•¿è¿™æ ·ï¼Œ</a><strong>Postè¯·æ±‚</strong>æŸ¥çœ‹è¯·æ±‚ä½“æ˜¯å¸¦æœ‰paramså’ŒencSecKeyçš„ï¼Œå‘ç°æ•°æ®éƒ½æ˜¯ç»è¿‡åŠ å¯†å¤„ç†çš„ï¼Œè¿™å°±å¾ˆæ¼ç«äº†ï¼Œå› ä¸ºä½†ä»ç½‘é¡µurlåˆ†æhttps://music.163.com/#/song?id=208902ï¼Œä»…ä»…æŒ‡æ˜äº†æ­Œæ›²çš„idï¼Œæœ¬åº”è¯¥ç›´æ¥ä»idå’Œå½“å‰è¯„è®ºpageNumberå»è¿”å›ç»™æˆ‘æ•°æ®ï¼Œä½†æœåŠ¡å™¨åšäº†åŠ å¯†å¤„ç†ï¼Œä½¿å¾—ä¸é‚£ä¹ˆå®¹æ˜“å»æ‹¿åˆ°æˆ‘æƒ³è¦çš„æ•°æ®ï¼Œæ‰€ä»¥è¿™é‡Œå°±éœ€è¦ç”¨åˆ°GoogleChromeçš„è°ƒç”¨æ ˆçš„åŠŸèƒ½</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220422223020117.png" alt="å“åº”ä½“"></p><p>ç‚¹å‡»å³æ–¹çš„initiatorå³å¯æŸ¥çœ‹è¿™ä¸ªurlçš„è°ƒç”¨æ ˆï¼Œé€šè¿‡è°ƒç”¨æ ˆCall Stackä¸­ï¼Œå¯¹ä»£ç è¿›è¡Œæ ¼å¼åŒ–åï¼ˆç‚¹å‡»å·¦ä¸‹è§’{ }ï¼‰è®¾ç½®æ–­ç‚¹ï¼Œç„¶åé‡æ–°åˆ·æ–°é¡µé¢ä¾æ¬¡å»åˆ†æè°ƒç”¨è¿‡ç¨‹</p><h4 id="åŠ å¯†å¤„ç†">åŠ å¯†å¤„ç†</h4><p>è¿™é‡Œç½‘æ˜“å…ˆè¿›è¡Œäº†ä¸€äº›configçš„è¯·æ±‚ï¼Œå½“æ¥åˆ°å±äºè¯¥urlçš„è¯·æ±‚æ—¶ï¼Œé€šè¿‡ä¸‹æ¨è°ƒç”¨æ ˆè§‚å¯Ÿå…¶paramåœ¨<strong>ä½•æ—¶</strong>ä»å¯ç†è§£çš„idè½¬åŒ–ä¸ºä¸å¯ç†è§£çš„tokenï¼Œæœ€ç»ˆå‘ç°åŠ å¯†å‡½æ•°</p><div class="code-wrapper"><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// éšæœºç”Ÿæˆ16ä½å­—ç¬¦</span><span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">var</span> d<span class="token punctuation">,</span> e<span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"</span><span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>       <span class="token keyword">for</span> <span class="token punctuation">(</span>d <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> a <span class="token operator">></span> d<span class="token punctuation">;</span> d <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span>           e <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> b<span class="token punctuation">.</span>length<span class="token punctuation">,</span>           e <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span>           c <span class="token operator">+=</span> b<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">return</span> c   <span class="token punctuation">&#125;</span><span class="token comment">// AESåŠ å¯†ï¼Œbä¸ºå¯†é’¥ aä¸ºdataï¼Œå¾—åˆ°encParam</span>   <span class="token keyword">function</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">var</span> c <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>         <span class="token punctuation">,</span> d <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">"0102030405060708"</span><span class="token punctuation">)</span>         <span class="token punctuation">,</span> e <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>         <span class="token punctuation">,</span> f <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span><span class="token constant">AES</span><span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> c<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>           <span class="token literal-property property">iv</span><span class="token operator">:</span> d<span class="token punctuation">,</span>           <span class="token literal-property property">mode</span><span class="token operator">:</span> CryptoJS<span class="token punctuation">.</span>mode<span class="token punctuation">.</span><span class="token constant">CBC</span>       <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">return</span> f<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token punctuation">&#125;</span><span class="token comment">// RSAåŠ å¯†ï¼Œå¾—åˆ°secKey</span>   <span class="token keyword">function</span> <span class="token function">c</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">var</span> d<span class="token punctuation">,</span> e<span class="token punctuation">;</span>       <span class="token keyword">return</span> <span class="token function">setMaxDigits</span><span class="token punctuation">(</span><span class="token number">131</span><span class="token punctuation">)</span><span class="token punctuation">,</span>       d <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RSAKeyPair</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span>       e <span class="token operator">=</span> <span class="token function">encryptedString</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">)</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">function</span> <span class="token function">d</span><span class="token punctuation">(</span><span class="token parameter">d<span class="token punctuation">,</span> e<span class="token punctuation">,</span> f<span class="token punctuation">,</span> g</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">var</span> h <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>         <span class="token punctuation">,</span> i <span class="token operator">=</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// å…ˆè¿›è¡Œä¸€æ¬¡åŠ å¯†ï¼Œå†å¯¹åŠ å¯†çš„æ•°æ®å†æ¬¡åŠ å¯†</span>       <span class="token keyword">return</span> h<span class="token punctuation">.</span>encText <span class="token operator">=</span> <span class="token function">b</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> g<span class="token punctuation">)</span><span class="token punctuation">,</span>       h<span class="token punctuation">.</span>encText <span class="token operator">=</span> <span class="token function">b</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>encText<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">,</span>       h<span class="token punctuation">.</span>encSecKey <span class="token operator">=</span> <span class="token function">c</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> e<span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">,</span>       h   <span class="token punctuation">&#125;</span><span class="token comment">// enter function</span>   window<span class="token punctuation">.</span>asrsea <span class="token operator">=</span> d<span class="token punctuation">,</span></code></pre></div><div class="code-wrapper"><pre class="language-json" data-language="json"><code class="language-json"><span class="token comment">// d: åŸå§‹æ•°æ®</span>d<span class="token operator">:</span> <span class="token string">"&#123;\"rid\":\"R_SO_4_208902\",\"threadId\":\"R_SO_4_208902\",\"pageNo\":\"1\",\"pageSize\":\"20\",\"cursor\":\"-1\",\"offset\":\"0\",\"orderType\":\"1\",\"csrf_token\":\"\"&#125;"</span><span class="token comment">// ä¸­æ–‡å­—ç¬¦è½¬ä¸ºçš„key</span>e<span class="token operator">:</span> <span class="token string">"010001"</span><span class="token comment">// f: </span>f<span class="token operator">:</span> <span class="token string">"00e0b509f6259df8642dbc35662901477df22677ec152b5ff68ace615bb7b725152b3ab17a876aea8a5aa76d2e417629ec4ee341f56135fccf695280104e0312ecbda92557c93870114af6c9d05c4f7f0c3685b7a46bee255932575cce10b424d813cfe4875d3e82047b97ddef52741d546b8e289dc6935b3ece0462db0a22b8e7"</span><span class="token comment">// ä¸­æ–‡å­—ç¬¦è½¬ä¸ºçš„key</span>g<span class="token operator">:</span> <span class="token string">"0CoJUm6Qyw8W8jud"</span><span class="token comment">// éšæœºç”Ÿæˆ16ä½å­—ç¬¦</span>i<span class="token operator">:</span> <span class="token string">"lmkFmnPxWkSzB2OD"</span></code></pre></div><h4 id="ä»£ç ">ä»£ç </h4><p>åŸå§‹å‚æ•°æ˜¯å¯ä»¥ç›´æ¥æ¨¡ä»¿çš„ï¼Œä¸»è¦æ˜¯å¦‚ä½•åŠ å¯†çš„è¿‡ç¨‹ã€‚æ‰€ä»¥è¦è‡ªåŠ¨åŒ–å‘é€è¯·æ±‚ï¼Œå°±è¦<strong>æ¨¡æ‹Ÿå®ƒçš„åŠ å¯†è¿‡ç¨‹</strong>ã€‚è¿™é‡Œæš‚æ—¶ä¸ç ”ç©¶RSAåŠ å¯†ï¼Œåªå…³æ³¨AESåŠ å¯†ã€‚</p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> json<span class="token keyword">from</span> base64 <span class="token keyword">import</span> b64encode<span class="token keyword">import</span> requests<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES<span class="token comment"># æŠ“å–ä¸€ä¸ªç‰¹ä¾‹éŸ³ä¹</span>i1x <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">'csrf_token'</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>    <span class="token string">'cursor'</span><span class="token punctuation">:</span> <span class="token string">"-1"</span><span class="token punctuation">,</span>    <span class="token string">'offset'</span><span class="token punctuation">:</span> <span class="token string">"0"</span><span class="token punctuation">,</span>    <span class="token string">'orderType'</span><span class="token punctuation">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>    <span class="token string">'pageNo'</span><span class="token punctuation">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>    <span class="token string">'pageSize'</span><span class="token punctuation">:</span> <span class="token string">"20"</span><span class="token punctuation">,</span>    <span class="token string">'rid'</span><span class="token punctuation">:</span> <span class="token string">'R_SO_4_208902'</span><span class="token punctuation">,</span>    <span class="token string">'threadId'</span><span class="token punctuation">:</span> <span class="token string">"R_SO_4_208902"</span><span class="token punctuation">&#125;</span>url <span class="token operator">=</span> <span class="token string">"https://music.163.com/weapi/comment/resource/comments/get?csrf_token="</span>d <span class="token operator">=</span> i1xe <span class="token operator">=</span> <span class="token string">'010001'</span><span class="token comment"># f = buV2x(Rg6a.md)</span>f <span class="token operator">=</span> <span class="token string">"00e0b509f6259df8642dbc35662901477df22677ec152b5ff68ace615bb7b725152b3ab17a876aea8a5aa76d2e417629ec4ee341f56135fccf695280104e0312ecbda92557c93870114af6c9d05c4f7f0c3685b7a46bee255932575cce10b424d813cfe4875d3e82047b97ddef52741d546b8e289dc6935b3ece0462db0a22b8e7"</span><span class="token comment"># g = buV2x(["çˆ±å¿ƒ", "å¥³å­©", "æƒŠæ", "å¤§ç¬‘"])</span>g <span class="token operator">=</span> <span class="token string">"0CoJUm6Qyw8W8jud"</span>i <span class="token operator">=</span> <span class="token string">"KERgVgrbxP7ZK6Ht"</span><span class="token keyword">def</span> <span class="token function">getSecKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token string">"1b8ed8e70825247c537c60f6fb6d7d63a0202873b77d8afe8870ad384e2062f8c4f2dee6c34f71a0e2ad574396a02eb541a5839fa92219b7523cbb44515dc1dbe6e78748f7b17e17b7ece5b49e562b5588a5b46dfc77c3f0ac3ce53cdd6ba170c6dac069aa75ea16405c2ac7f975e88259e710d879cbe6fbd3fadbcb067e78fa"</span><span class="token keyword">def</span> <span class="token function">to_16</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    pad <span class="token operator">=</span> <span class="token number">16</span> <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">16</span>    data <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>pad<span class="token punctuation">)</span> <span class="token operator">*</span> pad    <span class="token keyword">return</span> data<span class="token comment"># æ¨¡æ‹ŸåŠ å¯†è¿‡ç¨‹</span><span class="token keyword">def</span> <span class="token function">encrypto</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token string">':arg aä»£è¡¨Data bä»£è¡¨å¯†é’¥'</span>    iv <span class="token operator">=</span> <span class="token string">'0102030405060708'</span>    data <span class="token operator">=</span> to_16<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    aes <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token operator">=</span>key<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> IV<span class="token operator">=</span>iv<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mode<span class="token operator">=</span>AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">)</span>    bs <span class="token operator">=</span> aes<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>data<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token builtin">str</span><span class="token punctuation">(</span>b64encode<span class="token punctuation">(</span>bs<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">getParams</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>    temp1 <span class="token operator">=</span> encrypto<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>    temp2 <span class="token operator">=</span> encrypto<span class="token punctuation">(</span>temp1<span class="token punctuation">,</span> i<span class="token punctuation">)</span>    <span class="token keyword">return</span> temp2<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">&#123;</span>        <span class="token string">'params'</span><span class="token punctuation">:</span> getParams<span class="token punctuation">(</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">,</span>g<span class="token punctuation">)</span><span class="token punctuation">,</span>        <span class="token string">'encSecKey'</span><span class="token punctuation">:</span> getSecKey<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    jsonTxt <span class="token operator">=</span> resp<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>jsonTxt<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'hotComments'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre></div><p>**æ³¨æ„ä¸€ä¸ªå‘ç‚¹ï¼š**python3.10ä¸­éœ€è¦åœ¨å‡çº§pybluezå¯¼è‡´AESå‡ºç°SystemError  <a href="https://stackoverflow.com/questions/70999481/how-do-i-resolve-py-ssize-t-clean-macro-must-be-defined-for-formats-for-py">Stack-Overflow: How do I resolve â€˜PY_SSIZE_T_CLEAN macro must be defined for â€˜#â€™ formatsâ€™ for Pybluez on Windows 10</a>ï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œé™çº§äº†å†æ¬¡è¿è¡Œçš„</p><p>æœ€ç»ˆèƒ½å¾—åˆ°æ­£ç¡®çš„ç»“è®ºï¼Œæ³¨æ„ä¼ å‚å’ŒåŠ è§£å¯†æ—¶å¾ˆå¤šæ—¶å€™è¦æ±‚çš„æ˜¯utf-8å½¢å¼çš„ç¼–ç ï¼Œç„¶åAESè¦æ±‚ç¼–ç çš„dataè¦æ˜¯16çš„å€æ•°ï¼Œkeyæ˜¯16 24 32çš„å€æ•°ï¼Œæ‰€ä»¥éœ€è¦å¡«è¡¥ç¼ºå¤±çš„Dataï¼Œéšä¾¿å¡«æ»¡å³å¯ã€‚</p><h3 id="å¼‚æ­¥çˆ¬å–ä¸€æœ¬å°è¯´">å¼‚æ­¥çˆ¬å–ä¸€æœ¬å°è¯´</h3><p><a href="https://dushu.baidu.com/pc/reader?gid=4306063500">ç™¾åº¦å°è¯´â€“è¥¿æ¸¸è®°</a></p><h4 id="æ€è·¯">æ€è·¯</h4><p>è¿™é‡Œä¸»è¦æ³¨æ„ä¸€ä¸‹æ€è·¯ï¼šå…ˆ<strong>åŒæ­¥</strong>åœ°è·å–æŒ‡å®šä¸€æœ¬ä¹¦çš„idå’Œç« èŠ‚ç¼–å·cidï¼Œç„¶åæ ¹æ®cidå»<strong>å¼‚æ­¥</strong>çš„è¯·æ±‚æ¯ä¸€ç« èŠ‚çš„æ•°æ®å¹¶<strong>å¼‚æ­¥</strong>åœ°å†™è¿›æ–‡ä»¶</p><ul><li><strong>å¼‚æ­¥çš„æ¦‚å¿µ</strong>ï¼šä¸ä»…å‘é€è¯·æ±‚æ˜¯å¼‚æ­¥çš„ï¼Œé€šè¿‡aiofileså®ç°è¯»å†™çš„æ—¶å€™ä¹Ÿæ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œè¿™ä¸€ç‚¹å°±éå¸¸çš„é«˜æ•ˆã€‚</li></ul><h4 id="ä»£ç -v2">ä»£ç </h4><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> json<span class="token keyword">import</span> aiofiles<span class="token keyword">import</span> requests<span class="token keyword">import</span> aiohttp<span class="token keyword">import</span> asyncio<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">getCatatgory</span><span class="token punctuation">(</span>bookId<span class="token punctuation">)</span><span class="token punctuation">:</span>    url <span class="token operator">=</span> <span class="token string">'https://dushu.baidu.com/api/pc/getCatalog?data=&#123;"book_id":"'</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>bookId<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'"&#125;'</span>    resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>    titles <span class="token operator">=</span> resp<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'novel'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'items'</span><span class="token punctuation">]</span>    book_id <span class="token operator">=</span> resp<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'novel'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'book_id'</span><span class="token punctuation">]</span>    tasks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> title <span class="token keyword">in</span> titles<span class="token punctuation">:</span>        cid <span class="token operator">=</span> title<span class="token punctuation">[</span><span class="token string">'cid'</span><span class="token punctuation">]</span>        name <span class="token operator">=</span> title<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span>        tasks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>getContent<span class="token punctuation">(</span>book_id<span class="token punctuation">,</span> cid<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>wait<span class="token punctuation">(</span>tasks<span class="token punctuation">)</span><span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">getContent</span><span class="token punctuation">(</span>book_id<span class="token punctuation">,</span> cid<span class="token punctuation">,</span> title<span class="token punctuation">)</span><span class="token punctuation">:</span>    params <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        <span class="token string">'book_id'</span><span class="token punctuation">:</span> book_id<span class="token punctuation">,</span>        <span class="token string">'cid'</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>book_id<span class="token punctuation">&#125;</span></span><span class="token string">|</span><span class="token interpolation"><span class="token punctuation">&#123;</span>cid<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>        <span class="token string">'need_bookinfo'</span><span class="token punctuation">:</span> <span class="token number">1</span>    <span class="token punctuation">&#125;</span>    params <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>params<span class="token punctuation">)</span>    url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'https://dushu.baidu.com/api/pc/getChapterContent?data=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>params<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span>    <span class="token keyword">async</span> <span class="token keyword">with</span> aiohttp<span class="token punctuation">.</span>ClientSession<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>        <span class="token keyword">async</span> <span class="token keyword">with</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">)</span> <span class="token keyword">as</span> resp<span class="token punctuation">:</span>            dic <span class="token operator">=</span> <span class="token keyword">await</span> resp<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>url<span class="token punctuation">)</span>            txt <span class="token operator">=</span> dic<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'novel'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'content'</span><span class="token punctuation">]</span>            <span class="token keyword">async</span> <span class="token keyword">with</span> aiofiles<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'./books/</span><span class="token interpolation"><span class="token punctuation">&#123;</span>title<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">'w'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>                <span class="token keyword">await</span> f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>txt<span class="token punctuation">)</span>    <span class="token keyword">pass</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    bookId <span class="token operator">=</span> <span class="token number">4306063500</span>    asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>getCatatgory<span class="token punctuation">(</span>bookId<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>Web Spider</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hexo Fluid--åšå®¢è£…ä¿®æ•´ç†</title>
    <link href="/2022/04/07/Hexo-Fluid-%E5%8D%9A%E5%AE%A2%E8%A3%85%E4%BF%AE/"/>
    <url>/2022/04/07/Hexo-Fluid-%E5%8D%9A%E5%AE%A2%E8%A3%85%E4%BF%AE/</url>
    
    <content type="html"><![CDATA[<h1>Hexo Fluidåšå®¢è£…ä¿®</h1><blockquote><p>è‡ªä»åšå®¢ä»Nextä¸»é¢˜è¿ç§»åˆ°Fluidåï¼ŒåŸºæœ¬ä¸Šå°±æ²¡æœ‰å˜åŠ¨å¤ªå¤šä¸œè¥¿ï¼Œä½†ç°åœ¨çœ‹äº†åˆ«äººçš„åšå®¢æ¯”å¦‚åŸºäºButterflyçš„ï¼Œå°±ä¸å¤ªæ»¡è¶³äºç›®å‰çš„Fluidäº†ã€‚ButterFlyå›ºç„¶å¥½ï¼Œä½†å¤ªèŠ±å“¨ï¼Œé€‚åˆä¹‹åé’ˆå¯¹å‰ç«¯å­¦ä¹ çš„æ—¶å€™ç”¨è¿™æ¬¾ä¸»é¢˜ï¼Œæˆ‘æ›´å–œæ¬¢Fluidçš„æ•´ä½“å¸ƒå±€ï¼Œä½†ç»†èŠ‚æ–¹é¢ï¼Œå°±éœ€è¦å»è‡ªå·±DIYäº†ï¼Œè¿™ä¹Ÿå°±æœ‰äº†è¿™ç¯‡æ–‡ç« </p></blockquote><p>Done-TODO Listï¼š</p><input type="checkbox" disabled checked="checked"> å¢æ·»æ›´æ–°æ—¶é—´æ¨¡å—å¹¶è‡ªåŠ¨æ›´æ–°<br><input type="checkbox" disabled checked="checked"> æ–°å¢å‹é“¾<br><input type="checkbox" disabled checked="checked"> æ·»åŠ æ€»å­—æ•°<br><input type="checkbox" disabled checked="checked"> æ·»åŠ Githubè´¡çŒ®<br><input type="checkbox" disabled checked="checked"> ä½¿hexoæ”¯æŒmdè¡¨æƒ…<br><input type="checkbox" disabled checked="checked"> æ·»åŠ å” å” æ¥¼<br><ul><li><input type="checkbox" disabled > ç¾åŒ–æ ·å¼æ¡† <br></li></ul><input type="checkbox" disabled checked="checked"> æ–°å¢ç”µå½±ç•Œé¢ <br><ul><li><input type="checkbox" disabled > ç»§ç»­ç¾åŒ–<br></li></ul><input type="checkbox" disabled checked="checked"> ç¾åŒ–ä»£ç æ¿å—<br><ul><li><input type="checkbox" disabled checked="checked"> æ·»åŠ è¯­è¨€è¯†åˆ«<br></li><li><input type="checkbox" disabled checked="checked"> æ·»åŠ ä»£ç å—æŠ˜å <br></li></ul><input type="checkbox" disabled checked="checked"> æ·»åŠ æ›´æ–°æ—¶é—´<br><ul><li><input type="checkbox" disabled > æ‰‹æœºç«¯æ˜¾ç¤ºå¼‚å¸¸ <br></li></ul><input type="checkbox" disabled > æ·»åŠ å›é¡¾æ¨¡å—çš„ç‰¹å®šæ ·å¼<br><input type="checkbox" disabled checked="checked"> æ·»åŠ Githubå¾½æ ‡<br><h2 id="æ›´æ–°">æ›´æ–°</h2><h3 id="å¢æ·»æ›´æ–°æ—¶é—´æ¨¡å—å¹¶è‡ªåŠ¨æ›´æ–°">å¢æ·»æ›´æ–°æ—¶é—´æ¨¡å—å¹¶è‡ªåŠ¨æ›´æ–°</h3><p><span class="label label-primary">Time : 2022 / 4 / 7</span></p><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220407212939266.png" alt="image-20220407212939266"></div><div class="group-image-wrap"><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220407212809434.png" alt="image-20220407212809434"></div></div></div><h4 id="1-æ·»åŠ è„šæœ¬">1. æ·»åŠ è„šæœ¬</h4><p>ç½‘ä¸ŠCopyçš„jsè„šæœ¬ï¼Œè‡ªåŠ¨è¯†åˆ«ç›®å½•ä¸‹çš„mdæ–‡æ¡£ï¼Œæ ¹æ®æ˜¯å¦æœ‰categoryæ¥å¢åŠ updatedçš„font-matterï¼Œå¦‚æœæœ‰åˆ™å¿½ç•¥ã€‚æ¯”è¾ƒå®ç”¨ã€‚æˆ‘æ”¹äº†éƒ¨åˆ†å‚æ•°ï¼Œä¸æƒ³æŠŠè„šæœ¬æ”¾åœ¨_postsä¸‹ï¼Œæˆ‘æ”¾åœ¨æ¬¡ç›®å½•çš„å¦ä¸€ç›®å½•jsä¸­ï¼Œæ›´æ”¹äº†ç›¸åº”çš„å‚æ•°</p><div class="code-wrapper"><pre class="language-js" data-language="js"><code class="language-js"><span class="token hashbang comment">#!/usr/bin/env node</span><span class="token comment">/*æ‰¹é‡æ›´æ–°ä¿®æ”¹æ—¶é—´åšå®¢è‡ªåŠ¨æ›´æ–°æ–‡ç« çš„ä¿®æ”¹æ—¶é—´*/</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'è„šæœ¬å¼€å§‹è¿è¡Œ..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"fs"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è¯·æ±‚æ–‡ä»¶ç³»ç»Ÿ</span><span class="token keyword">var</span> file <span class="token operator">=</span> <span class="token string">"./txt"</span><span class="token punctuation">;</span> <span class="token comment">//è®¾ç½®è¯»å–å’Œå†™å…¥çš„æ–‡ä»¶ï¼Œå½“å‰ç›®å½•ä¸‹çš„testæ–‡ä»¶</span><span class="token keyword">var</span> RegExp<span class="token operator">=</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(updated:\s*)((\d&#123;2&#125;(([02468][048])|([13579][26]))[\-\/\s]?((((0?[13578])|(1[02]))[\-\/\s]?((0?[1-9])|([1-2][0-9])|(3[01])))|(((0?[469])|(11))[\-\/\s]?((0?[1-9])|([1-2][0-9])|(30)))|(0?2[\-\/\s]?((0?[1-9])|([1-2][0-9])))))|(\d&#123;2&#125;(([02468][1235679])|([13579][01345789]))[\-\/\s]?((((0?[13578])|(1[02]))[\-\/\s]?((0?[1-9])|([1-2][0-9])|(3[01])))|(((0?[469])|(11))[\-\/\s]?((0?[1-9])|([1-2][0-9])|(30)))|(0?2[\-\/\s]?((0?[1-9])|(1[0-9])|(2[0-8]))))))(\s((([0-1][0-9])|(2?[0-3]))\:([0-5]?[0-9])((\s)|(\:([0-5]?[0-9])))))</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">;</span>fs<span class="token punctuation">.</span><span class="token function">readdir</span><span class="token punctuation">(</span><span class="token string">"../_posts/"</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>files</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">var</span> len<span class="token operator">=</span>files<span class="token punctuation">.</span>length<span class="token punctuation">;</span><span class="token keyword">var</span> file<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>file<span class="token operator">=</span>files<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//console.log("è¯»å–æ–‡ä»¶ï¼š",file);</span><span class="token keyword">if</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">".md"</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"æ­£åœ¨å¤„ç†æ–‡ä»¶ï¼š"</span><span class="token punctuation">,</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">writeFileTime</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span>fs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*file:è¯»å–æ—¶é—´çš„æ–‡ä»¶ä»¥åŠå†™å…¥å†…å®¹çš„æ–‡ä»¶fs: æ–‡ä»¶ç³»ç»Ÿ*/</span><span class="token keyword">function</span> <span class="token function">writeFileTime</span><span class="token punctuation">(</span><span class="token parameter">file<span class="token punctuation">,</span>fs</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    file<span class="token operator">=</span><span class="token string">"../_posts/"</span><span class="token operator">+</span>file<span class="token punctuation">;</span>fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//è¯»å–æ–‡ä»¶å†…å®¹</span><span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"è¯»å–æ–‡ä»¶å†…å®¹é”™è¯¯ï¼š"</span><span class="token punctuation">,</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//console.log("æ–‡ä»¶"+file+"çš„å†…å®¹ï¼š",data);</span><span class="token keyword">if</span><span class="token punctuation">(</span>RegExp<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">//å¦‚æœåŒ¹é…åˆ°`updated`å­—æ®µ</span>fs<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> stats</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//è¯»å–æ–‡ä»¶ä¿¡æ¯ï¼Œåˆ›å»ºæ—¶é—´ç­‰</span><span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"è¯»å–æ–‡ä»¶ä¿¡æ¯é”™è¯¯ï¼š"</span><span class="token punctuation">,</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> updateds<span class="token operator">=</span>data<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>RegExp<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//console.log("updatedæ•°ç»„:",updateds);</span><span class="token keyword">if</span><span class="token punctuation">(</span>updateds<span class="token punctuation">.</span>length<span class="token operator">></span><span class="token number">1</span><span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"æ–‡ä»¶"</span><span class="token operator">+</span>file<span class="token operator">+</span><span class="token string">"åŒ¹é…åˆ°å¤šå¤„updateå­—æ®µ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> updated<span class="token operator">=</span>updateds<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"updated: "</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">-</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//æ—¶é—´æ ¼å¼åŒ–ä¸º2018/01/29 21:33:30</span><span class="token comment">//console.log("updated:",updated);</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>stats<span class="token punctuation">.</span>mtime<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>updated<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">1000</span><span class="token operator">*</span><span class="token number">60</span><span class="token operator">*</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">// åªè¦ä¿®æ”¹æ—¶é—´å’Œæ–‡ç« å†…updatedæ—¶é—´å·®å¤§äº1000æ¯«ç§’*60*5=5åˆ†é’Ÿå°±è§¦å‘æ›´æ–°</span><span class="token keyword">var</span> result<span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>RegExp<span class="token punctuation">,</span><span class="token string">"updated: "</span><span class="token operator">+</span><span class="token function">getFormatDate</span><span class="token punctuation">(</span>stats<span class="token punctuation">.</span>mtime<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ›¿æ¢æ›´æ–°æ—¶é—´</span>fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> result<span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//å†™å…¥æ–°çš„æ–‡ä»¶å†…å®¹</span><span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"å†™æ–‡ä»¶é”™è¯¯ï¼š"</span><span class="token punctuation">,</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>fs<span class="token punctuation">.</span><span class="token function">utimes</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>stats<span class="token punctuation">.</span>atime<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>stats<span class="token punctuation">.</span>mtime<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token comment">//è¿˜åŸè®¿é—®æ—¶é—´å’Œä¿®æ”¹æ—¶é—´</span><span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"ä¿®æ”¹æ—¶é—´å¤±è´¥ï¼š"</span><span class="token punctuation">,</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span><span class="token string">"æˆåŠŸæ›´æ–°æ—¶é—´"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/* timeStr:æ—¶é—´ï¼Œæ ¼å¼å¯ä¸ºï¼š"September 16,2016 14:15:05ã€ "September 16,2016"ã€"2016/09/16 14:15:05"ã€"2016/09/16"ã€ '2014-04-23T18:55:49'å’Œæ¯«ç§’ dateSeparatorï¼šå¹´ã€æœˆã€æ—¥ä¹‹é—´çš„åˆ†éš”ç¬¦ï¼Œé»˜è®¤ä¸º"-"ï¼Œ timeSeparatorï¼šæ—¶ã€åˆ†ã€ç§’ä¹‹é—´çš„åˆ†éš”ç¬¦ï¼Œé»˜è®¤ä¸º":" */</span><span class="token keyword">function</span> <span class="token function">getFormatDate</span><span class="token punctuation">(</span><span class="token parameter">timeStr<span class="token punctuation">,</span> dateSeparator<span class="token punctuation">,</span> timeSeparator</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    dateSeparator <span class="token operator">=</span> dateSeparator <span class="token operator">?</span> dateSeparator <span class="token operator">:</span> <span class="token string">"-"</span><span class="token punctuation">;</span>    timeSeparator <span class="token operator">=</span> timeSeparator <span class="token operator">?</span> timeSeparator <span class="token operator">:</span> <span class="token string">":"</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>timeStr<span class="token punctuation">)</span><span class="token punctuation">,</span>            year <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">// è·å–å®Œæ•´çš„å¹´ä»½(4ä½,1970)</span>            month <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">// è·å–æœˆä»½(0-11,0ä»£è¡¨1æœˆ,ç”¨çš„æ—¶å€™è®°å¾—åŠ ä¸Š1)</span>            day <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">// è·å–æ—¥(1-31)</span>            hour <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">// è·å–å°æ—¶æ•°(0-23)</span>            minute <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">// è·å–åˆ†é’Ÿæ•°(0-59)</span>            seconds <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getSeconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">// è·å–ç§’æ•°(0-59)</span>            <span class="token constant">Y</span> <span class="token operator">=</span> year <span class="token operator">+</span> dateSeparator<span class="token punctuation">,</span>            <span class="token constant">M</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>month <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">9</span> <span class="token operator">?</span> <span class="token punctuation">(</span>month <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token string">'0'</span> <span class="token operator">+</span> <span class="token punctuation">(</span>month <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> dateSeparator<span class="token punctuation">,</span>            <span class="token constant">D</span> <span class="token operator">=</span> <span class="token punctuation">(</span>day <span class="token operator">></span> <span class="token number">9</span> <span class="token operator">?</span> day <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token string">'0'</span> <span class="token operator">+</span> day<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' '</span><span class="token punctuation">,</span>            h <span class="token operator">=</span> <span class="token punctuation">(</span>hour <span class="token operator">></span> <span class="token number">9</span> <span class="token operator">?</span> hour <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token string">'0'</span> <span class="token operator">+</span> hour<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> timeSeparator<span class="token punctuation">,</span>            m <span class="token operator">=</span> <span class="token punctuation">(</span>minute <span class="token operator">></span> <span class="token number">9</span> <span class="token operator">?</span> minute <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token string">'0'</span> <span class="token operator">+</span> minute<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> timeSeparator<span class="token punctuation">,</span>            s <span class="token operator">=</span> <span class="token punctuation">(</span>seconds <span class="token operator">></span> <span class="token number">9</span> <span class="token operator">?</span> seconds <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token string">'0'</span> <span class="token operator">+</span> seconds<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            formatDate <span class="token operator">=</span> <span class="token constant">Y</span> <span class="token operator">+</span> <span class="token constant">M</span> <span class="token operator">+</span> <span class="token constant">D</span> <span class="token operator">+</span> h <span class="token operator">+</span> m <span class="token operator">+</span> s<span class="token punctuation">;</span>    <span class="token keyword">return</span> formatDate<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>Node.jsè¿˜æ˜¯å¯ä»¥å‘€ï¼Œèƒ½å¤Ÿä»¥è„šæœ¬æ–¹å¼ç›´æ¥æ‰§è¡Œï¼Œæœ‰ç©ºå¯ä»¥çœ‹çœ‹~</p><h4 id="2-è¡¥å……ä¸»è„šæœ¬">2. è¡¥å……ä¸»è„šæœ¬</h4><p>cdåˆ°è„šæœ¬ç›®å½•jsä¸‹ï¼Œæ‰§è¡Œè¿™ä¸ªå‡½æ•°å°±è¡Œäº†</p><h4 id="3-å†™HTML-JS">3. å†™HTML/JS</h4><p>å…¶å®è¿™é‡ŒFluidå·²ç»ç»™å‡º<a href="https://github.com/fluid-dev/hexo-theme-fluid/issues/162">ä¸€ç§è§£å†³æ–¹å¼</a>äº†ï¼Œä½†æ˜¯å› ä¸ºæœ€ç»ˆçš„æ•ˆæœä¸å¤ªå¥½<img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220407212023590.png" alt="image-20220407212023590"></p><p>æ‰€ä»¥è¿˜æ˜¯é€‰æ‹©è‡ªå®šä¹‰çš„æ–¹å¼ã€‚</p><p>æ€è·¯æ˜¯ å…ˆæ ¹æ®æ–‡ç« é¡µCoverä¸ŠåŸæœ‰çš„æ—¶é—´HTMLï¼Œè¿™è‚¯å®šæ˜¯é€šè¿‡dateçš„font-matterç”Ÿæˆçš„ï¼Œäºæ˜¯é€šè¿‡æŸ¥çœ‹ç½‘é¡µæºä»£ç å®šä½è¿™ä¸ªæ¨¡å—ï¼Œç„¶åå»æ‰¾åˆ°post-meta.ejsæ–‡ä»¶ï¼Œæ‰¾åˆ°ä¸¤ä¸ªç±»ä¼¼çš„divï¼Œç„¶åä»¿ç…§dateå»æ·»åŠ updatedï¼Œä½†è¿™é‡Œä¹Ÿè¦æ³¨æ„ï¼Œè¿˜éœ€è¦åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸‹æ·»åŠ ï¼Œå› ä¸ºtheme.post.meta.updated.enableå…¶å®å°±æ˜¯å»æŸ¥ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸‹çš„ç›¸åº”å­—æ®µï¼Œç„¶åæ›´æ”¹äº†ä¸‹åŸºäºmoment jsçš„æ—¶é—´è®¾ç½®ï¼Œâ€œLL aâ€ - &gt; â€œLLLâ€</p><div class="code-wrapper"><pre class="language-ejs" data-language="ejs"><code class="language-ejs"><span class="token comment">&lt;!-- è‡ªå®šä¹‰çš„æ›´æ–°æ—¶é—´ --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mt-1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token ejs language-ejs"><span class="token delimiter punctuation">&lt;%</span><span class="token language-javascript"> <span class="token keyword">if</span> <span class="token punctuation">(</span>theme<span class="token punctuation">.</span>post<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>updated<span class="token punctuation">.</span>enable<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> </span><span class="token delimiter punctuation">%></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post-meta<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>iconfont icon-clipcheck<span class="token punctuation">"</span></span> <span class="token attr-name">aria-hidden</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>time</span> <span class="token attr-name">datetime</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token ejs language-ejs"><span class="token delimiter punctuation">&lt;%=</span><span class="token language-javascript"> <span class="token function">full_date</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span>updated<span class="token punctuation">,</span> <span class="token string">'YYYY-MM-DD HH:mm'</span><span class="token punctuation">)</span> </span><span class="token delimiter punctuation">%></span></span><span class="token punctuation">"</span></span> <span class="token attr-name">pubdate</span><span class="token punctuation">></span></span>    Updated: <span class="token ejs language-ejs"><span class="token delimiter punctuation">&lt;%=</span><span class="token language-javascript"> <span class="token function">full_date</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span>updated<span class="token punctuation">,</span> theme<span class="token punctuation">.</span>post<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>updated<span class="token punctuation">.</span>format<span class="token punctuation">)</span> </span><span class="token delimiter punctuation">%></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>time</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span> <span class="token ejs language-ejs"><span class="token delimiter punctuation">&lt;%</span><span class="token language-javascript"> <span class="token punctuation">&#125;</span> </span><span class="token delimiter punctuation">%></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre></div><p>æœ€ç»ˆå¤§åŠŸå‘Šæˆï¼æ˜¾ç¤ºå¸ƒå±€æ–¹é¢è¿˜éœ€è¦æ”¹å˜ï¼Œæ–‡å­—éƒ¨åˆ†å¤ªé•¿ï¼Œä½†ç›¸æ¯”å®˜ç½‘æ·»åŠ çš„ï¼Œæˆ‘å¯¹è¿™ä¸ªå·²ç»å¾ˆæ»¡æ„äº†</p><h3 id="æ–°å¢å‹é“¾">æ–°å¢å‹é“¾</h3><p><span class="label label-primary">Time : 2022 / 4 / 7</span></p><p>ä¸€ç›´æ²¡å¢å‹é“¾ï¼Œè¿™ä¸‹å¢åŠ ä¸Šå»ï¼Œæ ¹æ®æ–‡æ¡£æ”¹ä¸»é¢˜é…ç½®å°±è¡Œäº†ï¼Œè®°å¾—è¡¥å……ä¸­æ–‡ç¿»è¯‘</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220407213731552.png" alt="image-20220407213731552"></p><h3 id="æ·»åŠ æ€»å­—æ•°">æ·»åŠ æ€»å­—æ•°</h3><p><span class="label label-primary">Time : 2022 / 4 / 7</span></p><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220407214058095.png" alt="image-20220407214058095"></div><div class="group-image-wrap"><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220407214022354.png" alt="image-20220407214022354"></div></div></div><p>å¾ˆä¹…å°±æœ‰çš„æƒ³æ³•äº†ï¼Œä¸è¿‡ä¸€ç›´å—é™äºæ€è·¯ï¼Œä»¥ä¸ºå¯èƒ½è¦shå»ç»Ÿè®¡å­—æ•°ï¼Œæ²¡æƒ³åˆ°npm çš„ hexo-wordcountå·²ç»æä¾›äº†è¿™ä¸ªåŠŸèƒ½ã€‚ä¼ å…¥ä¸€ä¸ªæ•´ä½“ç½‘é¡µå‚æ•°siteå³å¯<br>æ€è·¯è¿˜æ˜¯è€æ–¹æ³•ï¼Œé€šè¿‡HTMLå—å»å®šä½ä»£ç ï¼Œå‘ç°å…³è”éƒ¨åˆ†åœ¨archive.ejså’Œarchive-list.ejsï¼Œå‰è€…ä¼ å‚ç»™åè€…ï¼Œåè€…è¿›è¡Œæ˜¾ç¤ºã€‚è¿™é‡Œæˆ‘ä¹Ÿæ·»åŠ äº†ä¸€ä¸ªå‚æ•°è®¡ç®—äº†æ€»å­—æ•°ï¼Œç„¶ååœ¨åè€…ä¸­è¿›è¡Œæ˜¾ç¤º</p><div class="code-wrapper"><pre class="language-ejs" data-language="ejs"><code class="language-ejs"><span class="token comment">&lt;!-- archive.ejs --></span>    <span class="token ejs language-ejs"><span class="token delimiter punctuation">&lt;%-</span><span class="token language-javascript"> <span class="token function">partial</span><span class="token punctuation">(</span><span class="token string">'_partial/archive-list.ejs'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">postTotal</span><span class="token operator">:</span> site<span class="token punctuation">.</span>posts<span class="token punctuation">.</span>length <span class="token punctuation">,</span><span class="token literal-property property">postBitTotal</span><span class="token operator">:</span> <span class="token function">totalcount</span><span class="token punctuation">(</span>site<span class="token punctuation">)</span><span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> </span><span class="token delimiter punctuation">%></span></span><span class="token comment">&lt;!-- archive-list.ejs--></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>label label-primary<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token ejs language-ejs"><span class="token delimiter punctuation">&lt;%=</span><span class="token language-javascript"> <span class="token function">__</span><span class="token punctuation">(</span><span class="token string">'postTotal'</span><span class="token punctuation">,</span> params<span class="token punctuation">.</span>postTotal<span class="token punctuation">)</span>     </span><span class="token delimiter punctuation">%></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>label label-success<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">margin-left</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span>        <span class="token ejs language-ejs"><span class="token delimiter punctuation">&lt;%=</span><span class="token language-javascript"> <span class="token function">__</span><span class="token punctuation">(</span><span class="token string">'postBitTotal'</span><span class="token punctuation">,</span> params<span class="token punctuation">.</span>postBitTotal<span class="token punctuation">)</span> </span><span class="token delimiter punctuation">%></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></code></pre></div><p>è¿˜è¦æ³¨æ„ï¼Œè¿™é‡Œâ€™postTotalâ€™,æ˜¯ä¸€ä¸ªç±»ä¼¼é”®å€¼å¯¹çš„ä¸œè¥¿ï¼Œå€¼æ˜¯formatçš„stringå­—ç¬¦ä¸²ï¼Œæ¯”å¦‚xxxx %d xxx ï¼Œæ‰€ä»¥è¿˜éœ€è¦å®šä½åˆ°å…¶è¯­è¨€é…ç½®ç•Œé¢è®¾ç½®ä¸€ä¸‹ã€‚å¹¶ä¸”<br>æˆ‘ä¹‹å‰ä¼¼ä¹wordcountæ²¡æœ‰æ›´æ–°ï¼Œæˆ–è€…ç”¨çš„æ˜¯Fluidçš„wordcountæ‰€ä»¥å®ƒæç¤ºæ‰¾ä¸åˆ°totalcountè¿™ä¸ªæ–¹æ³•ï¼Œé‡æ–°npm i save xxxx ä¸€ä¸‹å°±OKäº†ã€‚æœ€ç»ˆç”¨Labelä¿®é¥°äº†ä¸€ä¸‹ï¼Œä¹‹åå¯ä»¥è€ƒè™‘å¢å¤§ä¸€ä¸‹å­—ä½“</p><h3 id="æ·»åŠ Githubè´¡çŒ®">æ·»åŠ Githubè´¡çŒ®</h3><p><span class="label label-primary">Time : 2022 / 4 / 7</span></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220407215426141.png" alt="image-20220407215426141"></p><p>ä»¥ä¸ºå¯ä»¥ç›´æ¥æ·»åŠ åŸºäºåšå®¢Localçš„è®¡æ•°ï¼Œä¸è¿‡æ²¡æœ‰æ‰¾åˆ°ï¼Œåªæœ‰åŸºäºgithubçš„è®¡æ•°ï¼Œæ‰€ä»¥è¿˜åˆå¾—æ·»åŠ github repoï¼Œç°åœ¨ä¹Ÿæ˜¯åŒrepoäº†ğŸ‰‘ï¼ˆåˆ«é—®ä¸ºå•¥Githubæäº¤è¿™ä¹ˆå°‘ï¼Œå› ä¸ºéƒ½æ˜¯æäº¤åˆ°äº‘æœåŠ¡å™¨ä¸Šçš„ğŸ˜¢ ï¼‰</p><p>ä¸»è¦å‚è€ƒå°å†°çš„åšå®¢<a class="btn" href="https://zfe.space/post/hexo-githubcalendar.html" title="title">æ•™ç¨‹ï¼šhexo-githubcalendar æ’ä»¶ 1.0</a>ï¼Œä¹Ÿæ¨ä¸€ä¸‹ä»–çš„ç½‘ç«™ï¼Œæ’ä»¶éƒ½éå¸¸ä¸é”™ï¼é€šè¿‡htmlçš„idæˆ–nameå»æŒ‚è½½è¿™ä¸ªtableï¼Œä¸‰ä»¶äº‹ï¼šnpmä¸‹è½½ï¼›ç«™ç‚¹é…ç½®å¢åŠ ï¼›é¡µé¢åµŒå…¥jsã€‚è¿˜æ”¯æŒä¿®æ”¹é¢œè‰²å¤§å°ç­‰ï¼Œéƒ½åœ¨_config.yamlä¸­ï¼Œé¢œè‰²ä¹‹ç±»çš„å¯ä»¥åæœŸä¼˜åŒ–</p><h3 id="æ·»åŠ å” å” æ¥¼">æ·»åŠ å” å” æ¥¼</h3><p><span class="label label-primary">Time : 2022 / 4 / 8</span></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220410161440199.png" alt="image-20220410161440199"></p><p>æƒ³æ·»åŠ ä¸€ä¸ªè‡ªè¨€è‡ªè¯­çš„æ¨¡å—ï¼Œè¿™ä¸ªç®—æ˜¯ä¸€ä¸ªåˆçº§ç‰ˆæœ¬äº† ğŸ˜†</p><p>ä¹‹å‰æœ‰è€ƒè™‘è¿‡ç”¨ç°æˆçš„å¨å¨ hexo-daodaoï¼Œé€šè¿‡vercelæ­å»ºï¼Œä½†ä¼¼ä¹æ˜¯ç”¨çš„åˆ«äººçš„æ•°æ®ï¼Œä¸å¤ªå¥½ï¼Œåæ¥å¯»æ‰¾åˆ°äº†åŸºäºArtitalk å’Œ LeanCloudçš„è§£å†³æ–¹æ¡ˆ å…·ä½“çš„åšå®¢å‚åŠ <a href="https://juejin.cn/post/6958014853403377672">ä½¿ç”¨leanCloudç»™Hexoåšå®¢åŠ ä¸Šartitalkè¯´è¯´æ¨¡å—</a>ã€‚ä½†æ˜¯csså¤ªä¸‘äº†ï¼Œå°±è‡ªå·±æ‰¾äº†ä¸‹artitalkçš„å®˜ç½‘çš„é…ç½®æ–‡ä»¶ï¼Œç”¨è‡ªå·±çš„cssç¨å¾®æ”¹äº†ä¸‹ï¼Œè™½ç„¶è¿˜æ˜¯ä¸å¤ªæ»¡æ„UIï¼Œä¸è¿‡è‡ªå®šä¹‰çš„ç›®çš„ç®—æ˜¯è¾¾åˆ°äº†ä¸€åŠ</p><p>ä¹‹åè€ƒè™‘åšæˆè¿™ç§æ•ˆæœï¼š<img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220410172808872.png" alt="image-20220410172808872">è„±ç¦»åŸæœ‰çš„æ¡†ï¼Œä¸€æ¡ä¿¡æ¯ç‹¬ç«‹æˆå•ç‹¬çš„æ¡†</p><h3 id="æ–°å¢ç”µå½±ç•Œé¢-ğŸ‘">æ–°å¢ç”µå½±ç•Œé¢ ğŸ‘</h3><p><span class="label label-primary">Time : 2022 / 4 / 8 â€“ 2022 / 4 / 10</span></p><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220410162508365.png" alt="image-20220410162508365"></div><div class="group-image-wrap"><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220410162535972.png" alt="image-20220410162535972"></div></div><div class="group-image-row"><div class="group-image-wrap"><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220410162543859.png" alt="image-20220410162543859"></div></div></div><p>è¿™ä¸ªç®—æ˜¯æ¯”è¾ƒç”¨å¿ƒåšçš„ä¸€ä¸ªé¡µé¢äº†å“ˆå“ˆï¼Œå‡†å¤‡ææˆå‘¨æ›´çš„å¥½ç”µå½±æ”¶é›†ç³»åˆ—ã€‚</p><h4 id="æº¯æº">æº¯æº</h4><p>å…¶å®æœ€å¼€å§‹æƒ³åšæˆButterflyè¿™ç§çš„<img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220410162817114.png" alt="image-20220410162817114"></p><p>æœç´¢äº†ä¸‹å…¶å®æ˜¯åŸºäºhexo-doubançš„ï¼Œä½†æ˜¯å¥ˆä½•è¿™ä¸ªnpmåŒ…æ˜¯3ã€4å¹´å‰æ‰updateçš„ï¼Œé€ æˆäº†å¾ˆå¤šä¾èµ–çš„ç‰ˆæœ¬å†²çªé—®é¢˜ï¼Œè‡ªå·±ç”¨ä¸Šäº†å¾ˆå¤šæ—¶å€™æ²¡æœ‰ååº”ï¼Œå¹¶ä¸”ç”Ÿæˆç•Œé¢çš„æ—¶å€™è€—æ—¶è¾ƒé•¿ï¼Œåæ¥æ¢äº†ä¸ªç±»ä¼¼çš„hexo-butterfly-doubanä½†ç•Œé¢åˆä¸å¤ªå¥½çœ‹ï¼Œä¸”ä¹Ÿæ˜¯ç»å¸¸generateä¸å‡ºæ¥ã€‚æ­£å¥½åˆçœ‹åˆ°äº†hexo-douban-cardçš„åŒ…ï¼Œæ¯”è¾ƒå–œæ¬¢è¿™ç§å¡ç‰‡çš„è®¾è®¡ï¼Œåæ¥ä¸€å’¬ç‰™ï¼Œè‡ªå·±å†™é¡µé¢ç®—äº†ï¼Œè¿˜å¯ä»¥è‡ªå®šä¹‰ã€‚éº»çƒ¦ä¸€ç‚¹ï¼Œä½†æ˜¯å¯å®šåˆ¶æ€§é«˜ã€‚</p><h4 id="HTMLé™æ€åˆ†é¡µ">HTMLé™æ€åˆ†é¡µ</h4><p>è¿™é‡Œä¸»è¦å¤æ‚ç‚¹å°±æ˜¯è¿™ä¸ªé™æ€åˆ†é¡µï¼Œä¸è¿‡æŸ¥äº†ä¸€ä¸‹èµ„æ–™ï¼Œè¿˜æ˜¯æ¯”è¾ƒå®¹æ˜“ã€‚é€šè¿‡å»è®¾ç½®html div styleçš„displayå±æ€§ï¼ˆä½†ç¼ºé™·å¯èƒ½æ˜¯ï¼šåæœŸå…ƒç´ ä¸€å¤šé™æ€é¡µé¢åŠ è½½å¾ˆæ…¢ï¼Œç”Ÿæˆå¾ˆæ…¢ï¼Œç”šè‡³å»è®¾ç½®displayçš„æ—¶å€™ä¹Ÿä¼šæ…¢ä¸€ç‚¹ï¼‰ã€‚</p><p>è¿™é‡Œæ€è·¯æ˜¯å…ˆç»Ÿè®¡å¤šå°‘ä¸ªç±»åç›¸åŒçš„divï¼Œç„¶åå†å»é€šè¿‡å½“å‰é¡µé¢å·maskå’Œopenå¯¹åº”çš„divã€‚é‚£å¦‚ä½•æ§åˆ¶é¡µé¢ï¼Ÿé€šè¿‡jsæ§åˆ¶ï¼Œä¹Ÿæ˜¯æŠ„äº†ç‚¹ç½‘ä¸Šçš„ä»£ç ï¼Œä½†æ¯”è¾ƒç¬¨ï¼Œé€šè¿‡ä¸åŒç±»åæ¥æ§åˆ¶ï¼Œæ¯æ¬¡éœ€è¦æ‰‹åŠ¨æ·»åŠ å…ƒç´ åˆ°æ•°ç»„ä¸­ï¼Œç¨ä½œä¿®æ”¹ï¼Œæˆ‘è¿™é‡Œç›´æ¥getElementsByClassNameå°±è¡Œäº†ï¼Œä¸ç”¨æ‰‹åŠ¨ä¿®æ”¹æ€»é¡µæ•°å’Œé•¿åº¦ã€‚å°è´´ä¸€ä¸‹ä»£ç </p><div class="code-wrapper"><pre class="language-js" data-language="js"><code class="language-js"><span class="token comment">// å®šä¹‰ä¸€ä¸ªæ•°ç»„ï¼Œä¿å­˜å½“å‰æ‰€æœ‰é¡µé¢çš„class name</span>   <span class="token keyword">var</span> page_index <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">"my-single-movie"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// è¾“å…¥pagenameï¼Œæ‰“å¼€æŒ‡å®šçš„divï¼Œéšè—å…¶ä»–çš„div</span>   <span class="token keyword">function</span> <span class="token function">page_option</span><span class="token punctuation">(</span><span class="token parameter">pageIdx</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> page_index<span class="token punctuation">.</span>length <span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>j <span class="token operator">!=</span> pageIdx<span class="token punctuation">)</span>                page_index<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>display<span class="token operator">=</span><span class="token string">"none"</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>       page_index<span class="token punctuation">[</span>pageIdx<span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>display<span class="token operator">=</span><span class="token string">"block"</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token comment">// ç‚¹å‡» è¿”å›ç¬¬ä¸€é¡µæŒ‰é’® æ‰§è¡Œçš„æ“ä½œ</span>   <span class="token keyword">function</span> <span class="token function">first_click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token function">page_option</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'currentPage'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token comment">// ç‚¹å‡» è·³åˆ°æœ€åä¸€é¡µæŒ‰é’® æ‰§è¡Œçš„æ“ä½œ</span>   <span class="token keyword">function</span> <span class="token function">last_click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token keyword">var</span> total_page <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'totalPage'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML<span class="token punctuation">;</span>       <span class="token function">page_option</span><span class="token punctuation">(</span>page_index<span class="token punctuation">[</span>page_index<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'currentPage'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token operator">=</span>total_page<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token comment">// ç‚¹å‡» ä¸Šä¸€é¡µæŒ‰é’® æ‰§è¡Œçš„æ“ä½œ</span>   <span class="token keyword">function</span> <span class="token function">prev_click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token keyword">var</span> cur_page <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'currentPage'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>       <span class="token keyword">if</span> <span class="token punctuation">(</span>cur_page <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'currentPage'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token operator">=</span><span class="token function">parseInt</span><span class="token punctuation">(</span>cur_page<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>           <span class="token function">page_option</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>cur_page<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span>   <span class="token comment">// ç‚¹å‡» ä¸‹ä¸€é¡µæŒ‰é’® æ‰§è¡Œçš„æ“ä½œ</span>   <span class="token keyword">function</span> <span class="token function">next_click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token keyword">var</span> cur_page <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'currentPage'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>       <span class="token keyword">var</span> total_page <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'totalPage'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML<span class="token punctuation">;</span>       <span class="token keyword">if</span> <span class="token punctuation">(</span>cur_page <span class="token operator">&lt;</span> total_page<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'currentPage'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token operator">=</span><span class="token function">parseInt</span><span class="token punctuation">(</span>cur_page<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>           <span class="token function">page_option</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>cur_page<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span>   <span class="token comment">// æ‰‹åŠ¨æ”¹å˜å½“å‰é¡µç æ—¶æ‰§è¡Œçš„æ“ä½œ</span>   <span class="token keyword">function</span> <span class="token function">choose_page</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token keyword">var</span> cur_page <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'currentPage'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>       <span class="token function">page_option</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>cur_page<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p>å½“ç„¶å•¦ï¼Œä¹Ÿå°†è·³è½¬çš„æŒ‰é’®å°åšç¾åŒ–ï¼Œä¿æŒè·ŸFluidä¸»é¢˜æ ·å¼çš„ä¸€è‡´æ€§ï¼Œä½†æ˜¯æ·»åŠ äº†hoveråŠ¨æ•ˆåä¼šå¶å°”å‡ºç°Chromeå´©æºƒï¼Œæˆ‘ä¸çŸ¥é“æ˜¯linux chromeçš„é—®é¢˜è¿˜æ˜¯ä»£ç é—®é¢˜ï¼Œæœ‰å¾…éªŒè¯ã€‚</p><h4 id="hexo-douban-card">hexo-douban-card</h4><p>è¿™ä¸ªè¿˜æœ‰ä¸ªå°ç‚¹ï¼Œç¬¬ä¸€ç‚¹æ˜¯æœ‰æ—¶å€™generateæ—¶ä¼šé€šè¿‡apiçˆ¬æ•°æ®å¹¶å†™è¿›æ¥ï¼Œæ¯”è¾ƒæ…¢ï¼ŒåæœŸè€ƒè™‘skip-renderäº†ï¼›ç¬¬äºŒç‚¹æ˜¯æœ‰æ—¶å€™generateæŠ¥é”™ï¼Œæ˜¯å› ä¸ºè±†ç“£çš„åŸå› ï¼Œè¦ä¹ˆæ˜¯è®¿é—®é™åˆ¶äº† éœ€è¦è‡ªå·±æ‰‹åŠ¨å»è¾“å…¥éªŒè¯ç ï¼Œè¦ä¹ˆæ˜¯cookieè¿‡æœŸï¼Œåˆ°æ—¶å€™é‡æ–°åœ¨configé‡Œå¡«ä¸€ä¸‹cookieå°±è¡Œäº†ã€‚</p><p>å‘ç°css blurå¥½æœ‰æ„æ€å•Šï¼Œä¸€ä¸ªå‚æ•°å°±è®¾ç½®äº†æƒ³è¦çš„èƒŒæ™¯æ•ˆæœï¼Œè¿™ç§æ¨¡ç³Šçš„äºšå…‹åŠ›èˆ¬çš„æ„Ÿè§‰ã€‚å½“ç„¶è¿™ä¸ªcssä¹Ÿæ˜¯å¯ä»¥æ›´æ¢çš„ğŸ™‚ï¼Œå‡†å¤‡åæœŸé­”æ”¹ä¸€ä¸‹ï¼Œä¹Ÿæœ‰è€ƒè™‘é€šè¿‡apiå»çˆ¬æ•°æ®ç„¶åè‡ªå·±ç”Ÿæˆhtmlï¼Œä½†æ˜¯ç•¥éº»çƒ¦ï¼Œè¿™é‡Œæš‚æ—¶å…ˆè¿™æ ·ã€‚</p><h4 id="ç¾åŒ–">ç¾åŒ–</h4><ul><li>å¢åŠ ç»„å›¾çš„hoveræ•ˆæœ</li><li>æ·»åŠ è‹±æ–‡å­—ä½“</li><li>ä¿®å¤å¡é¡¿å´©æºƒç°è±¡</li><li>å•å›¾ä¼˜åŒ–ï¼Œè‡ªé€‚åº”</li><li>è·³è½¬åŠ¨ç”»</li></ul><h4 id="å¾…ä¼˜åŒ–ç‚¹">å¾…ä¼˜åŒ–ç‚¹</h4><ul><li><s>é¦–å°¾é¡µè¿˜å­˜åœ¨ä¸å®Œå–„ä¹‹å¤„</s> å·²ä¿®å¤</li><li>æ•´ä½“ç•Œé¢æœ‰å¾…ç»§ç»­ç¾åŒ–å’Œç»Ÿä¸€</li><li><s>æƒ³æŠŠå›¾ç‰‡å±•ç¤ºéƒ¨åˆ† éƒ¨åˆ†åšæˆhover scaleçš„ï¼Œä½†æ˜¯æœ‰ç‚¹éº»çƒ¦</s> å·²å®Œæˆ</li></ul><h3 id="ç¾åŒ–ä»£ç æ¿å—">ç¾åŒ–ä»£ç æ¿å—</h3><p><span class="label label-primary">Time : 2022 / 4 / 8 â€“ 2022 / 4 / 9</span></p><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220410165405168.png" alt="image-20220410165405168"></div></div><div class="group-image-row"><div class="group-image-wrap"><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220410165429966.png" alt="image-20220410165429966"></div></div></div><p>ç”¨MacPanelçš„æ ·å¼ï¼Œç¨å¾®å¥½çœ‹äº†ä¸€äº›ã€‚æ€è·¯è¿˜æ˜¯æ”¹cssï¼Œæ·»åŠ äº†_customä¸‹çš„è‡ªå®šä¹‰cssï¼Œä½†åŸºäºä¸»é¢˜ä»£ç highlightçš„é—®é¢˜ï¼Œé¢œè‰²ä¸æ˜“åˆ†è¾¨ï¼Œæ”¹äº†ä¸‹ä¸»é¢˜é…ç½®æ–‡ä»¶çš„highlightåº“ï¼Œç”¨äº†prime.jsçš„ã€‚æœ‰ä¸ªå‘ç‚¹æ˜¯ï¼Œä¸»é¢˜é…ç½®ä¸‹æ‰“å¼€linenumberæ˜¾ç¤ºè¡Œå·ï¼Œcssæ ·å¼ä¼šæ‰¯æ‰ï¼Œæ‰€ä»¥å°±å…ˆå…³é—­äº†è¡Œå·åŠŸèƒ½</p><p>ä½†è¿™é‡ŒçŸ¥ä¹ä¸Šçœ‹åˆ°ä¸€ç¯‡æ›´å¥½çš„ï¼ŒButterflyæ”¯æŒçš„ä»£ç æ ·å¼ï¼Œè¿˜æœ‰æŠ˜å ä»£ç å’Œæ˜¾ç¤ºå½“å‰è¯­è¨€åŠŸèƒ½ï¼Œä½†æˆ‘è¿™é‡Œé™äºä¸»é¢˜ä¸èƒ½ç›´æ¥copyï¼Œå‡†å¤‡ä¹‹åé­”æ”¹ä¸€æ³¢ã€‚åŠ ä¸Šä»£ç è¯­è¨€å’ŒæŠ˜å åŠŸèƒ½</p><h4 id="æ˜¾ç¤ºä»£ç è¯­è¨€">æ˜¾ç¤ºä»£ç è¯­è¨€</h4><p><span class="label label-success">Time : 2022 / 4 / 11</span></p><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220411185249424.png" alt="image-20220411185249424"></div></div><div class="group-image-row"><div class="group-image-wrap"><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220411185306916.png" alt="image-20220411185306916"></div></div></div><p>é»˜è®¤ä»£ç æ¡†ä¸å±•å¼€ï¼Œå› ä¸ºå±•å¼€çš„æ—¶å€™ä¾‹å¦‚LeetCodeé¡µé¢å°±å¤ªé•¿äº†ï¼Œè™½ç„¶HTMLåŠ è½½æ˜¯åŒæ ·çš„æ—¶é—´ï¼Œä½†ä¸ºäº†ç¾è§‚è¿˜æ˜¯å…ˆè®¾ç½®ä¸ºä¸å±•å¼€ã€‚</p><p><strong>è·å–HTML:beforeçš„é—®é¢˜</strong></p><p>æ”¯æŒæ˜¾ç¤ºä»£ç è¯­è¨€çš„æ€è·¯æ˜¯ï¼šå…ˆæ‰¾åˆ°htmlä¸‹å¯¹åº”çš„ä»£ç æ¡†blockï¼Œå‘ç°å…¶æœ‰å†…ç½®çš„ä»£ç è¯­è¨€ï¼ˆå·²ç»è¯»å–å¹¶è®¾ç½®åˆ°htmlä¸­ï¼‰ï¼Œåªéœ€è¦è‡ªå·±æ·»åŠ ä¸€ä¸ªblockå¹¶è·å–ä»£ç å—å°±è¡Œäº†ã€‚ä½†è¿™é‡Œæˆ‘å…¶å®æœ€å¼€å§‹æƒ³é€šè¿‡è®¾ç½®ä»£ç æ•´ä½“æ¡†çš„:beforeçš„contentå€¼æ¥åšçš„ï¼Œå› ä¸ºå¾ˆæ–¹ä¾¿ä¹Ÿä¸ç”¨æ·»åŠ ä»€ä¹ˆå…ƒç´ ï¼Œä½†è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºæˆ‘çš„æœ€ç»ˆèµ‹å€¼æ˜¯åœ¨é¡µé¢åŠ è½½åé€šè¿‡jsä»£ç å»è¯»å–ï¼ˆæœªåœ¨ç”Ÿæˆhtmlæ—¶å°±èµ‹å€¼ï¼‰ï¼Œæ‰€ä»¥ä¹‹åå°±è¦åŠ¨æ€çš„å»get :beforeè¿™ä¸ªElementï¼Œä½†:beforeä½œä¸ºä¼ªå…ƒç´ ï¼Œå…¶å®ä¸æ˜¯å¤ªå¥½get å’Œ setä¸€äº›å€¼ï¼ˆå°è¯•äº†ä¸€ä¸‹ä¸å¤ªè¡Œï¼Œä½†å¯èƒ½æ˜¯æœªonLoadåè¿›è¡Œæ“ä½œå¯¼è‡´çš„ï¼‰ï¼Œå› ä¸ºæœ€åå…¶å®htmlæ˜¯å½“åšä¸€ä¸ªæ•´ä½“æ¥çš„ï¼Œæ‰€ä»¥è¿™é‡Œåæ¥æ¢äº†æ€è·¯ï¼šè‡ªå·±åŠ ä¸€ä¸ªdivï¼Œé€šè¿‡<strong>ç»å¯¹å¸ƒå±€</strong>ï¼Œå°†divå›ºå®šåˆ°å›ºå®šä½ç½®ï¼Œç„¶åå»è®¾ç½®è¿™ä¸ªdivçš„å€¼ï¼Œç›¸æ¯”åªè®¾ç½®divçš„contentï¼Œå•ç‹¬åŠ divçš„å¯å®šåˆ¶åº¦ä¹Ÿæ›´é«˜ã€‚å®šä½åˆ°æ·»åŠ å…„å¼Ÿå…ƒç´ çš„æ–‡ä»¶ï¼ŒåŠ ä¸Šå°±è¿™ä¸€è¡Œä»£ç å°±è¡Œäº†ã€‚</p><p><strong>HTMLå†…getå…ƒç´ å€¼çš„é—®é¢˜</strong></p><p>è¿™é‡Œè¿˜è¸©äº†ä¸€ä¸ªHTMLåŠ è½½çš„å‘ï¼Œæˆ‘çš„è‡ªå®šä¹‰jsé€šè¿‡fluidæ˜¯åŠ è½½åœ¨é¡µé¢åº•éƒ¨çš„ã€‚æˆ‘é€šè¿‡åŠ è½½é¡µé¢åå»runæˆ‘çš„è¿™ä¸ªjsï¼Œjsä¸­å»getå¯¹åº”çš„divçš„ä¸€äº›å…ƒç´ å€¼ï¼ˆæ¯”å¦‚ä»£ç è¯­è¨€ï¼‰ï¼Œä½†å…¶å®è¿è¡Œåå¾—åˆ°çš„å€¼æ˜¯undefinedï¼Œlogçˆ¶å…ƒç´ å‘ç°å¹¶ä¸æ˜¯æœ‰å±‚çº§çš„divï¼Œè€Œæ˜¯è¿‘ä¹rawæ ¼å¼çš„é”®å€¼å¯¹ï¼ŒçŒœæµ‹å¯èƒ½æ˜¯HTMLéƒ¨åˆ†å€¼è¿˜æ²¡æœ‰å¡«å…¥ï¼Ÿè¿™é‡Œæ¶‰åŠåˆ°å‰ç«¯é¡µé¢çš„æ¸²æŸ“å’Œæ•°å€¼åŠ è½½çš„è¿‡ç¨‹ï¼Œä½†æ˜¯åº”è¯¥æ˜¯é¡µé¢æœªå®Œå…¨åŠ è½½çš„é—®é¢˜ï¼Œjsä¸­ç­‰å¾…é¡µé¢å®Œå…¨åŠ è½½å¥½åï¼Œå†è·‘è¿™ä¸ªæ–¹æ³•å°±è¡Œï¼Œè¿™æ˜¯js ç­‰å¾…htmlåŠ è½½çš„ä¸¤ç§æ–¹æ³•ã€‚</p><div class="code-wrapper"><pre class="language-js" data-language="js"><code class="language-js"> <span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é€Ÿåº¦æ›´å¿«ï¼Œè¿˜æœªæ¸²æŸ“imgç­‰å›¾ç‰‡</span>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'onload'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">i</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é€Ÿåº¦è¾ƒæ…¢ï¼Œç­‰é¡µé¢å®Œå…¨åŠ è½½å¥½åæ‰è°ƒç”¨</span></code></pre></div><h4 id="æ–°å¢ä»£ç æ¡†æ”¶ç¼©">æ–°å¢ä»£ç æ¡†æ”¶ç¼©</h4><p><span class="label label-success">Time : 2022 / 4 / 11</span></p><p>æ”¯æŒä»£ç æ¡†åŠ¨æ€æ”¶ç¼©å’Œæ¢å¤ï¼Œè¿™ä¸ªéœ€æ±‚å¤ªé‡è¦äº†ï¼Œæ—©å°±æƒ³åšï¼Œä¸è¿‡å¥—äº†ä¸‹çŸ¥ä¹çš„æ²¡ç”¨ã€‚è‡ªå·±å…ˆåšäº†ä¸ªv1.0ç‰ˆæœ¬çš„ã€‚ä¸æ”¯æŒåŠ¨ç”»æ•ˆæœ</p><p>æ€è·¯ï¼šæ‰¾å¯¹åº”çš„æ¨¡å—ï¼Œå¢åŠ ä¸‹æ‹‰å’Œæ”¶ç¼©çš„iconfont div ï¼Œé€šè¿‡jsè®¾ç½®clickçš„listener</p><p><strong>jsä¸­var const</strong></p><p>varæ˜¯å‡½æ•°ä½œç”¨åŸŸï¼Œå…è®¸å€¼ä¿®æ”¹ï¼Œå˜é‡æå‡ï¼Œå¤šæ¬¡é‡å®šä¹‰<br>constä½œç”¨åŸŸä¸letä¸€æ ·ï¼Œå—ä½œç”¨åŸŸï¼Œconstæ˜¯åŸºæœ¬ç±»å‹å€¼ï¼Œå€¼ä¸å¯å˜ï¼Œå¦‚æœä¸ºå¼•ç”¨çš„æ•°æ®ç±»å‹ï¼Œåˆ™å¼•ç”¨çš„å˜é‡ä¸å¯å˜ï¼Œå¿…é¡»å…ˆåˆå§‹åŒ–æ‰èƒ½ä½¿ç”¨</p><p>è¿™é‡Œæˆ‘å…¶å®æœ€å¼€å§‹ç”¨çš„varå˜é‡ï¼Œå¯¼è‡´ä¸€ç›´æ‰§è¡Œç›‘å¬å‡½æ•°çš„æ˜¯æœ€åä¸€ä¸ªdivå—ï¼Œåæ¥å‘ç°æ‰æ›´æ”¹ä¸ºconst</p><h4 id="å¾…ä¼˜åŒ–">å¾…ä¼˜åŒ–</h4><ul><li>ä¸ºä»£ç æ¡†æ”¶ç¼©æ·»åŠ åŠ¨ç”»æ•ˆæœ</li></ul><h3 id="æ·»åŠ æ›´æ–°æ—¶é—´">æ·»åŠ æ›´æ–°æ—¶é—´</h3><p><span class="label label-primary">Time : 2022 / 4 / 10</span></p><p>æœ¬æ¥æƒ³æŒ‰ç…§æ›´æ–°æ—¶é—´æ’åºæ–‡ç« çš„ï¼Œè¿™é‡Œhexo configä¹Ÿç»™äº†å¯é…ç½®çš„è®¾ç½®ï¼Œä½†åæ¥æƒ³æƒ³è¿˜æœ‰ç‚¹æ—©ï¼Œå› ä¸ºæ‰æ·»åŠ äº†updatedå­—æ®µï¼Œå¾ˆå¤šæ–‡ä»¶æ›´æ–°æ—¶é—´ä¸æ˜¯çœŸå®çš„ï¼Œå…ˆæŒ‰ç…§dateæ’åºå§ï¼Œå°±å…ˆæ·»åŠ ä¸€ä¸ªé¡¶éƒ¨çš„æœ€è¿‘æ›´æ–°æ—¶é—´å’Œæ–‡ç« çš„æé†’ã€‚ï¼ˆæœ€å¼€å§‹è¿˜æƒ³é€šè¿‡è„šæœ¬é™æ€å†™å…¥å¹¶è¯»å–çš„æ–¹å¼è§£å†³ï¼Œä½†æ˜¯å¤ªéº»çƒ¦å¹¶ä¸”ä¹Ÿæ²¡æœ‰å¿…è¦ï¼‰</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220410170438778.png" alt="image-20220410170438778"></p><p>æ•°æ®éƒ¨åˆ†å…¶å®è¿˜æŒºæœ‰è¯´å¤´çš„ï¼Œè¿™é‡Œä»£ç æ®µåœ¨index.ejsä¸­ï¼Œå¦‚æœé€šè¿‡page.postsè·å–ï¼Œé‚£ä¹ˆåªæ˜¯å¾—åˆ°ä¸€é¡µçš„æ–‡ç« æ•°ç›®ã€‚å°è¯•é˜…è¯»å®˜ç½‘æ–‡æ¡£ï¼Œå‘ç°æœ‰list_postsçš„å…¨å±€æ–¹æ³•ï¼Œå¯æŒ‰ç…§å­—æ®µæ’åºæ˜¾ç¤ºæ‰€æœ‰çš„postï¼Œä½†åªæ˜¯åå­—ï¼Œä¸å¤ªå¥½ã€‚ç„¶åçªç„¶çœ‹åˆ°æœ‰siteè¿™ä¸ªå…¨å±€å˜é‡â€¦æœäº†ï¼Œå¯é€šè¿‡è¿™ä¸ªå˜é‡è·å–ç½‘ç«™åŸºæœ¬æ‰€æœ‰ä¿¡æ¯ï¼Œç„¶åå°±æŒ‰ç…§updatedå­—æ®µ sortäº†ï¼Œå¾—åˆ°æœ€è¿‘æ›´æ–°æ–‡ç« çš„postï¼Œç„¶ååœ¨å»å–updatedå’Œtitleï¼Œä½†è¿™é‡Œupdatedä¹Ÿæ˜¯å·äº†æ‡’ï¼Œå› ä¸ºä¹‹å‰çœ‹fluid issueçš„æ—¶å€™æœ‰äººæäº†ä¸€å˜´ï¼Œç„¶åå¼€å‘äººå‘˜å°±å‡ºäº†æ¯ç¯‡æ–‡ç« çš„updatedæé†’ï¼Œæ˜¾ç¤ºä¸ºç¦»ç°åœ¨å¤šå°‘å¤©å‰æ›´æ–°çš„ï¼Œæˆ‘å°±ç”¨äº†è¿™ä¸ªå‡½æ•°ï¼Œå°±ä¸ç”¨å»æ˜¾ç¤ºå’Œè½¬æ¢éº»çƒ¦çš„Moment&lt;â€¦&gt;äº†ã€‚</p><p>HTMLéƒ¨åˆ†çš„è¯ä¸»è¦è¿˜æ˜¯ejsä¸ä¼šä½¿ç”¨ï¼Œå±…ç„¶èƒ½å¤Ÿç›´æ¥åœ¨htmléƒ¨åˆ†é€šè¿‡&lt;%= %&gt;è¿›è¡Œèµ‹å€¼ï¼ç¦»è°±ï¼Œéå¸¸å¥½ç”¨ï¼Œè¿™é‡Œè§£å†³äº†hrefçš„é—®é¢˜ã€‚ç„¶ååŠ äº†ä¸‹å¾ªç¯é£å…¥å’Œhoveræš‚åœçš„çš„åŠ¨ç”»æ•ˆæœï¼Œå¤ªæ‡’äº†ï¼Œç›´æ¥åŠ åœ¨index.stylé‡Œçš„</p><div class="code-wrapper"><pre class="language-css" data-language="css"><code class="language-css"><span class="token selector">// è‡ªå®šä¹‰é¡¶éƒ¨æ›´æ–°barå’ŒåŠ¨ç”».latest_post</span><span class="token punctuation">&#123;</span>  <span class="token property">animation</span><span class="token punctuation">:</span> latest_post_ani 10s linear infinite<span class="token punctuation">;</span>    <span class="token property">display</span><span class="token punctuation">:</span> inline-flex<span class="token punctuation">;</span>  <span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token selector">.latest_post:hover</span> <span class="token punctuation">&#123;</span>  <span class="token property">animation-play-state</span><span class="token punctuation">:</span> paused<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token atrule"><span class="token rule">@keyframes</span> latest_post_ani</span> <span class="token punctuation">&#123;</span>    <span class="token selector">0%</span> <span class="token punctuation">&#123;</span>        <span class="token comment">/* è°ƒæ•´åˆå§‹ä½ç½®*/</span>          <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateX</span><span class="token punctuation">(</span><span class="token function">calc</span><span class="token punctuation">(</span>100%<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>    <span class="token selector">100%</span> <span class="token punctuation">&#123;</span>        <span class="token comment">/* çˆ¶ç›’å­å®½åº¦å‡å»100% */</span>    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateX</span><span class="token punctuation">(</span><span class="token function">calc</span><span class="token punctuation">(</span>600px - 400%<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><h4 id="ç¼ºé™·">ç¼ºé™·</h4><p>æ‰‹æœºç«¯æ˜¾ç¤ºå­˜åœ¨ç¼ºé™·</p><h3 id="æ·»åŠ EChart">æ·»åŠ EChart</h3><h3 id="å°ä¼˜åŒ–"><strong>å°ä¼˜åŒ–</strong></h3><h4 id="æ·»åŠ Githubå¾½æ ‡">æ·»åŠ Githubå¾½æ ‡</h4><p><span class="label label-primary">Time : 2022 / 4 / 12</span></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220413101346107.png" alt="image-20220413101346107"></p><p>éå¸¸å¥½ç”¨ï¼Œç›´æ¥å»https://shields.io/å³å¯ï¼Œç„¶åå¯¼å…¥åˆ°è‡ªå·± çš„footer.ejsä¸‹å°±è¡Œäº†</p><h4 id="è‡ªå®šä¹‰é¡µé¢æ·»åŠ FancyBoxæ•ˆæœ">è‡ªå®šä¹‰é¡µé¢æ·»åŠ FancyBoxæ•ˆæœ</h4><p><span class="label label-primary">Time : 2022 / 4 / 14</span></p><p>åœ¨postç•Œé¢ä¼šè‡ªåŠ¨åŒ…å«fancyboxçš„divï¼Œä½†è‡ªå®šä¹‰ç•Œé¢ä¸è¡Œï¼Œï¼Œplugin.jsåœ¨ç”Ÿæˆé¡µé¢çš„æ—¶å€™ä¼šå»è¿½åŠ fancyboxã€‚è¿™éƒ¨åˆ†jsä»£ç æˆ‘copyçš„å¾ˆå†—ä½™ï¼Œä¸ä¼šå†™jQueryï¼Œæˆ‘å°±ç›´æ¥copyäº†å‡½æ•°ä½“ï¼Œæ”¹äº†ä¸‹æ¡ä»¶ä¸ºè‡ªå®šä¹‰é¡µé¢çš„å›¾ç‰‡å…ƒç´ ï¼Œç„¶åä¿®å¤äº†ä¸‹å›¾ç‰‡é«˜å®½ä¸å¯¹é½çš„æƒ…å†µ(max-width:100%  è¿½åŠ height:100%)ã€‚è¿™éƒ¨åˆ†ä»£ç æœ‰å¾…ä¼˜åŒ–</p><h4 id="ä½¿hexoæ”¯æŒmdè¡¨æƒ…">ä½¿hexoæ”¯æŒmdè¡¨æƒ…</h4><p><span class="label label-primary">Time : 2022 / 4 / 7</span></p><p>å®ç°Hexoå¯¹markdownçš„è¡¨æƒ…ç¬¦å·çš„æ”¯æŒï¼Œnpmè£…ä»€ä¹ˆhexo-emojiå•¥çš„å°±è¡Œäº†ï¼Œä¸ç„¶ç½‘ç«™æ˜¾ç¤ºğŸ‘ ä¸º: +1 :ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å¨±ä¹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hexo</tag>
      
      <tag>Html</tag>
      
      <tag>CSS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆè¯†Git Hooks</title>
    <link href="/2022/04/04/%E6%B5%85%E5%85%A5Git-Hooks/"/>
    <url>/2022/04/04/%E6%B5%85%E5%85%A5Git-Hooks/</url>
    
    <content type="html"><![CDATA[<h1>åˆè¯†Git Hooks</h1><blockquote><p>æœ€è¿‘å› ä¸ºæƒ³å……åˆ©ç”¨æœåŠ¡å™¨çš„å³æ—¶æœåŠ¡åŠŸèƒ½ï¼Œå¸Œæœ›æŠŠHexoä¸Šçš„æ–‡æ¡£ç›´æ¥è½¬åŒ–æˆPDFæ ¼å¼ï¼Œä¸ç”¨ç”µè„‘ä¸Šæ“ä½œï¼Œç›´æ¥æ‰‹æœºä¸Šé€šè¿‡FTPè·å–å³å¯ã€‚æ‰€ä»¥æœ¬ç¯‡æ¶‰åŠåˆ°ä¸€äº›Linuxç®€å•è„šæœ¬ã€pandocå‘½ä»¤å’Œhexoæ“ä½œã€gitçŸ¥è¯†</p></blockquote><h2 id="èƒŒæ™¯">èƒŒæ™¯</h2><p>å¸Œæœ›èƒ½å¤Ÿé€šè¿‡é’©å­å’ŒGitä»“åº“å°†æˆ‘çš„Hexoåšå®¢çš„mdæ–‡æ¡£åŒæ­¥åˆ°Serverçš„ä»“åº“ä¸­ï¼Œå› ä¸ºhexoéƒ¨ç½²çš„æ–‡ä»¶é¡¹ç›®æ˜¯publicçš„htmlç½‘é¡µè€Œépdfï¼Œæ‰€ä»¥å½“æˆ‘æƒ³è¦å…·ä½“çš„pdfæ—¶ï¼Œå°±ä¸èƒ½é€šè¿‡Serverè·å–ï¼Œè€Œåªèƒ½é€šè¿‡ä¸ªäººç”µè„‘è½¬åŒ–ï¼Œå°±é€ æˆäº†éœ€æ±‚ã€‚</p><h2 id="ä»‹ç»-v7">ä»‹ç»</h2><p>å¦‚åŒHooksæ‰€è¡¨ç¤ºçš„æ„æ€é‚£æ ·ï¼Œå°±åƒä¸€ä¸ªé’©å­æ€æƒ³ï¼Œcommitã€pushç­‰æ“ä½œéƒ½æ˜¯ä¸åŒçš„é’©å­ï¼Œä½ å¯ä»¥é€‰æ‹©åœ¨å‡ºé’©ä¹‹å‰è¿›è¡Œä¸€äº›æ“ä½œï¼Œä¹Ÿå¯ä»¥åœ¨æ‹‰é’©æ—¶å®Œæˆä¸€äº›æ“ä½œã€‚<br>ç›®çš„åœ¨äºï¼šæå‡å¯¹gitä»“åº“ä½¿ç”¨çš„æ•ˆç‡ï¼Œæä¾›ä¸€äº›æ¨¡å—åŒ–ã€å¯åµŒå…¥çš„åŠŸèƒ½æ“ä½œ</p><h3 id="æ¨¡å—-v2">æ¨¡å—</h3><ul><li>pre-commitï¼šæäº¤ä¿¡æ¯ä¹‹å‰è¿›è¡Œï¼Œæ£€æŸ¥å³å°†æäº¤çš„å¿«ç…§ï¼Œæ˜¯å¦æœ‰é—æ¼</li><li>prepare-commit-msgï¼šå¯åŠ¨ä¿¡æ¯ç¼–è¾‘å™¨ä¹‹å‰</li><li>commit-msgï¼šé’©å­æ¥å—ä¸€ä¸ªå‚æ•°</li><li><strong>post-commit</strong>ï¼šé’©å­åœ¨æ•´ä¸ªæäº¤è¿‡ç¨‹å®Œæˆåè¿è¡Œï¼Œä¸æ¥å—ä»»ä½•å‚æ•°ï¼Œä¸€èˆ¬ç”¨äºé€šçŸ¥</li><li>pre-rebaseï¼šå˜åŸºä¹‹å‰</li><li>post-checkout</li><li><strong>pre-push</strong>ï¼šæ›´æ–°äº†è¿œç¨‹å¼•ç”¨ä½†<strong>å°šæœªä¼ é€å¯¹è±¡æ—¶</strong>è°ƒç”¨</li></ul><p><strong>æœåŠ¡ç«¯é’©å­</strong> æœåŠ¡ç«¯å¸¸ç”¨</p><ul><li>pre-receiveï¼šå¤„ç†æ¥è‡ªå®¢æˆ·ç«¯çš„æ¨é€æ“ä½œï¼Œåœ¨æ¥å—å¯¹è±¡ä¹‹å‰è¿›è¡Œ</li><li>updateï¼šä¸ä¸Šç±»ä¼¼ï¼Œä½†å¦‚æœæ¨é€è¿™åŒæ—¶å‘å¤šä¸ªåˆ†æ”¯æ¨é€å†…å®¹ï¼Œpre-receiveåªè¿è¡Œä¸€æ¬¡ï¼Œupdateä¼šä¸ºæ¯ä¸€ä¸ªè¢«æ¨é€çš„åˆ†æ”¯å„è¿è¡Œä¸€æ¬¡ã€‚</li><li><strong>post-receive</strong>ï¼šæŒ‚é’©åœ¨æ•´ä¸ªè¿‡ç¨‹å®Œæˆä»¥åç»“æŸè¿è¡Œï¼Œç”¨æ¥æ›´æ–°å…¶ä»–ç³»ç»ŸæœåŠ¡æˆ–è€…é€šçŸ¥ç”¨æˆ·</li></ul><h2 id="åº”ç”¨">åº”ç”¨</h2><p>åˆè¡·ï¼šhexo -dåæ‰§è¡Œhooksï¼Œå°†blogåŸä»“åº“åŒæ­¥åˆ°Serverä¸­</p><h3 id="é—®é¢˜-v5">é—®é¢˜</h3><ol><li><p>Hexoä»“åº“å¤ªå¤§ï¼Œä¸”æˆ‘åªéœ€è¦Postçš„mdæ–‡ä»¶å°±è¡Œï¼Œæ²¡å¿…è¦å ç”¨å¤šçš„ç©ºé—´</p><p>è§£å†³ï¼šåœ¨_postsæ–‡ä»¶å¤¹ä¸‹å»ºç«‹gitçš„æœ¬åœ°ä»“åº“ï¼Œè®¾ç½®æœåŠ¡ç«¯ä¸Šå¯¹åº”çš„è¿œç¨‹ä»“åº“ä¸ºremoteï¼Œå½“ç„¶è¿˜éœ€è¦è®¾ç½®receive denyCurrentBranch falseã€‚</p></li><li><p>git pushåˆ°æœåŠ¡ç«¯ï¼Œè¿œç¨‹ä»“åº“å…¶å®å®Œå…¨æ˜¯gitæ¥ç®¡çš„æ–‡ä»¶ï¼Œä¸æ˜¯æˆ‘æƒ³è¦çš„æºæ–‡ä»¶å½¢å¼</p><p>æƒ³è¦å¾—åˆ°æºæ–‡ä»¶å½¢å¼ï¼Œéœ€è¦å†æ¬¡cloneæœ¬åœ°ä»“åº“ï¼Œè¿™æ ·ä»gitçš„ä»“åº“ä¸‹å¾—åˆ°æºæ–‡ä»¶ã€‚</p></li><li><p><strong>hexo -g -dæœ¬èº«æ˜¯ä¸æ‰§è¡Œgit å¸¸è§„å‘½ä»¤çš„</strong>ï¼Ÿ</p><ol><li>è¿™é‡Œæ˜¯ä¸ªå‘ç‚¹ï¼Œå†™å¥½è„šæœ¬åæˆ‘å¸¸è¯†åœ¨hooksä¸­å»ºç«‹æˆ‘çš„pre-pushç­‰è„šæœ¬ï¼Œä½†æœªå¾—ä»¥é€šè¿‡hexo -då®ç°ï¼Œä½†hexo -dç¡®å®è§¦å‘äº†è¿œç«¯çš„post-receive hookï¼Œè¯´æ˜ç¡®å®æœ‰æ¥å—å¯¹è±¡ï¼Œä½†æ²¡æœ‰é€šè¿‡gitçš„æœ¬åœ° pushå—ï¼Ÿæ„Ÿè§‰è¿™é‡Œè‡ªå·±çš„ç†è§£å¯èƒ½è¿˜æ˜¯æœ‰é—®é¢˜ï¼Œä½†æ ¹æ®å®éªŒå¾—å‡ºçš„ç»“è®ºä¼¼ä¹å°±æ˜¯è¿™æ ·ã€‚å¯èƒ½hexoç»“åˆäº†gitæœ‰å®ƒè‡ªå·±çš„ä¸€å¥—ç®¡ç†æªæ–½ï¼Œåˆæˆ–è€…å®ƒç»•è¿‡äº†gitçš„å®¢æˆ·ç«¯hookâ€¦</li><li>äºæ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘åˆå›åˆ°äº†æœ€åˆçš„æƒ³æ³•ï¼Œå†™ä¸€ä¸ªè„šæœ¬ï¼Œæ—¢èƒ½hexo -g -d åˆå¯ä»¥åœ¨_postsçš„ä»“åº“ä¸‹å†æ¬¡pushåˆ°è¿œç¨‹åº“ï¼Œä¸è§¦å‘hexo repositoryçš„hookï¼Œè€Œæ˜¯è§¦å‘_postsä»“åº“çš„hooksï¼Œè¿™æ ·ä¹Ÿèƒ½åšåˆ°ä¸å¹²æ‰°åˆ°åŸä»“åº“è€Œå®ç°mdæ–‡æ¡£è½¬ç§»çš„é—®é¢˜</li></ol></li></ol>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åŸºäºWireSharkçš„ç½‘ç»œåˆ†æ</title>
    <link href="/2022/03/30/%E5%9F%BA%E4%BA%8EWireShark%E7%9A%84%E7%BD%91%E7%BB%9C%E5%88%86%E6%9E%90/"/>
    <url>/2022/03/30/%E5%9F%BA%E4%BA%8EWireShark%E7%9A%84%E7%BD%91%E7%BB%9C%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h1>åŸºäºWireSharkçš„ç½‘ç»œåˆ†æ</h1><blockquote><p>ä¸€ç›´å¯¹ç½‘ç»œæŠ“åŒ…è¿™å—å¾ˆæ„Ÿå…´è¶£ï¼Œå¹¶ä¸”WireSharkä¹Ÿä¸€ç›´åƒç°ï¼Œå€Ÿè¿™ä¸ªæœºä¼šé€šè¿‡WireSharkåˆ†æä¸€ä¸‹ä¼ è¾“å±‚å’Œç½‘ç»œå±‚ï¼ˆTCPã€IPï¼‰å…·ä½“åˆ°æ•°æ®åŒ…çš„å°è£…ç»†èŠ‚å’Œå…·ä½“çš„å·¥ä½œç»†èŠ‚</p></blockquote><h2 id="ä»‹ç»-v6">ä»‹ç»</h2><p><strong>WireShark</strong></p><p>å‰ç§°Etherealï¼Œæ˜¯ä¸€ä¸ªç½‘ç»œå°åŒ…åˆ†æè½¯ä»¶ï¼Œæˆªå–ç½‘ç»œå°è£…åŒ…ï¼Œå°½å¯èƒ½è¯¦ç»†åœ°æ˜¾ç¤ºç½‘ç»œå°åŒ…ä¿¡æ¯ å¼€æºå¼€æºå¼€æºï¼</p><h2 id="ç½‘ç»œåˆ†æ">ç½‘ç»œåˆ†æ</h2><h3 id="ä¸‰æ¬¡æ¡æ‰‹">ä¸‰æ¬¡æ¡æ‰‹</h3><p>ä¸»è¦çœ‹ä¼ è¾“å±‚çš„åˆ†æ</p><h4 id="Hello">Hello</h4><p>æŠ¥æ–‡é¦–éƒ¨ç»“æ„åœ¨è¿™é‡Œï¼Œå¯ä»¥ä¸€ä¸€å¯¹ç…§</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210914163318606.png" alt="image-20210914163318606"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220331162210966.png" alt="image-20220331162210966"></p><p>è§£é‡Šä¸€äº›ä¹‹å‰ä¸å¤ªæ‡‚çš„å«ä¹‰ï¼š</p><ul><li>æºç«¯å£å·æ˜¯ä»Linuxè¾ƒé åçš„â€œå®¢æˆ·ç«¯ç«¯å£â€èŒƒå›´éšæœºæä¾›çš„ï¼ˆä¸ºä»€ä¹ˆæœ‰æºç«¯å£ï¼Ÿ-&gt;æ‰¾å¾—åˆ°å›æ¥çš„è·¯ï¼‰ï¼Œåˆ°å“ªå»ï¼Œè‚¯å®šæ˜¯åˆ°ä¸ºHTTPå¼€æ”¾çš„80ç«¯å£ä¸Šã€‚</li><li>åºåˆ—å·ï¼šå®¢æˆ·ç«¯ç³»ç»Ÿéšæœºäº§ç”Ÿçš„32ä½ï¼Œè¿™é‡Œwiresharkä¼˜åŒ–äº†ä¸€ä¸‹ æä¾›äº†ç›¸å¯¹çš„å€¼</li><li>ç¡®è®¤åºåˆ—å·ï¼šä¸º0ï¼Œå› ä¸ºæ˜¯æˆ‘è¯·æ±‚ï¼Œä¸éœ€è¦ç¡®è®¤ä»€ä¹ˆ</li><li>Flagï¼š<ul><li>SYNæ‰“å¼€è¡¨ç¤ºå»ºç«‹è¿æ¥ï¼Œä»…SYNä¸º1çš„åŒ…ä¸ºSYNåŒ…ï¼Œåªæœ‰<strong>æœåŠ¡ç«¯å—åˆ°å®¢æˆ·ç«¯å‘æ¥çš„SYNåŒ…ï¼Œæ‰å¯ä»¥å»ºç«‹è”ç³»</strong></li></ul></li><li>æ¥å—çª—å£å¤§å°ï¼šæŒ‡å®šçª—å£å¤§å°</li><li>æ£€éªŒå’Œï¼šTCPæ•´ä½“æ£€éªŒï¼ˆåŒ…æ‹¬è½½è·ï¼‰[12å­—èŠ‚ä¼ªé¦–éƒ¨]  TCPé¦–éƒ¨æ ¡éªŒå’Œè®¡ç®—ä¸‰éƒ¨åˆ†ï¼šTCPé¦–éƒ¨+TCPæ•°æ®+TCPä¼ªé¦–éƒ¨</li><li><strong>é€‰é¡¹</strong>ï¼š<ul><li>MSSï¼š[é™å®šè½½è·æ•°æ®é•¿åº¦]è®¾ç½®äº†è‡ªå·±çš„MSSå€¼ï¼Œä»¥ä¾¿ä¸æœåŠ¡ç«¯è¿›è¡Œæ²Ÿé€šï¼Œé€‰æ‹©æœ€å°å€¼</li><li>SACKï¼šå…è®¸ä¼˜åŒ–çš„é‡ä¼ æ–¹å¼</li><li>Window Scaleï¼šè¡¨æ˜è‡ªå·±çš„çª—å£æ‰©å¤§å› å­</li></ul></li></ul><h4 id="I-hear-u">I hear u</h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220331165900512.png" alt="image-20220331165900512"></p><p>æœåŠ¡å™¨è¿”å›çš„ï¼Œä»æœåŠ¡ç«¯çš„80ç«¯å£åˆ°å®¢æˆ·ç«¯æŒ‡å®šçš„ç«¯å£ã€‚è¿™é‡ŒSequence Numberæ˜¯æœåŠ¡ç«¯é€‰å®šçš„ï¼Œç¡®è®¤å·æ˜¯åœ¨å®¢æˆ·ç«¯çš„åºåˆ—å·çš„+1ï¼›ç”±äºæ˜¯å¸Œæœ›å»ºç«‹è¿æ¥ï¼Œæ‰€ä»¥SYN=1ï¼Œä¸”è¡¨ç¤ºç¡®è®¤æ”¶åˆ°ä¿¡æ¯ï¼Œæ‰€ä»¥ACK=1ï¼›è¡¨æ˜äº†è‡ªå·±æ”¯æŒçš„æ¥å—çª—å£å¤§å°ï¼ˆè¿™é‡Œ&lt;å®¢æˆ·ç«¯ï¼‰ï¼›è¡¨æ˜äº†è‡ªå·±ä¸åŒçš„MSSã€‚å…¶ä»–ä¿¡æ¯æ„ä¹‰éƒ½ç›¸åŒã€‚ä¹Ÿåœ¨Optionä¸­è¡¨æ˜è‡ªå·±æ˜¯å¦æ”¯æŒSACK</p><h4 id="Letâ€™s-talk">Letâ€™s talk</h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220331170950616.png" alt="image-20220331170950616"></p><p>å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯è¡¨æ˜æˆ‘çŸ¥é“ä½ èƒ½å¬åˆ°æˆ‘äº†</p><p>åºåˆ—å·åœ¨ä¹‹å‰è‡ªå·±å‘çš„åŸæœ‰åŸºç¡€+1ï¼ˆä¸å­¦çš„ä¸åŒï¼Ÿï¼‰ç¡®è®¤å·åœ¨å¯¹æ–¹å‘æ¥çš„åºåˆ—å·åŸºç¡€ä¸ŠåŠ 1ï¼›Window sizeä¸ºæ­£ç¡®çš„factor * sizeå€¼ï¼ˆä¸ºä»€ä¹ˆæ˜¯è¿™ä¸ªå€¼ï¼Ÿï¼‰</p><p><strong>ç†è§£Ghost Byte</strong></p><h3 id="æ­£å¸¸ä¼ è¾“">æ­£å¸¸ä¼ è¾“</h3><p><strong>å‘é€HTTPè¯·æ±‚</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220331171820581.png" alt="image-20220331171820581"></p><p>å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€HTTP GETè¯·æ±‚ï¼Œè¯·æ±‚æŸURLä¸‹çš„èµ„æºï¼›ä»è¿™é‡Œå¼€å§‹å°±æœ‰payloadäº†ï¼›ç¡®è®¤å·ä¸ºä¹‹å‰æœåŠ¡ç«¯å‘æ¥çš„åºåˆ—å· +1ï¼›PSHï¼ˆè¡¨æ˜æ˜¯è¯¥è¯·æ±‚çš„æœ€åä¸€ä¸ªæ•°æ®åŒ…ï¼Œæ–¹ä¾¿é€šçŸ¥åº”ç”¨ç¨‹åºåŠæ—¶ä»ç½‘ç»œç¼“å­˜ä¸­å»æ‹¿æ•°æ®ï¼‰å’ŒACKï¼ˆè¡¨ç¤ºå“åº”ï¼Œæˆ‘æ”¶åˆ°ä½ ä¹‹å‰çš„æ¶ˆæ¯äº†ï¼‰éƒ½æ‰“å¼€ï¼›Window Size é‡‡ç”¨ä¹‹å‰è§„å®šå¥½çš„ï¼ˆä½†æ²¡æœ‰factoräº†ï¼Œä¸ºå•¥ï¼Ÿæ€æ ·èƒ½ç¡®ä¿æœ€ç»ˆä¸ºsize*factor?ï¼‰</p><p><strong>å“åº”</strong></p><p>æœåŠ¡ç«¯å…ˆå›åº”æˆ‘æ”¶åˆ°ä½ HTTPè¯·æ±‚çš„å“åº”ï¼Œåºåˆ—å·åœ¨æœåŠ¡ç«¯ä¹‹å‰å‘é€ç»™å®¢æˆ·ç«¯çš„åŸºç¡€ä¸Š+1ï¼ŒåŒæ—¶è¿˜ä¼šæœ‰window sizeçš„è°ƒæ•´ã€‚ç„¶åå°±å¦èµ·æ•°æ®åŒ…ï¼Œå¼€å§‹å‘æ•°æ®äº†</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220331190932943.png" alt="image-20220331190932943"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œ<strong>ç¡®è®¤å·å’Œåºåˆ—å·éƒ½ä¸å˜</strong>ï¼Œä¸»è¦æ˜¯æœ‰äº†payloadï¼Œå¼€å§‹è´Ÿè½½æ•°æ®ã€‚ä¸”ä¹‹åçš„ä¼ è¾“ä¸­ï¼Œç¡®è®¤å·éƒ½ç­‰äºå¯¹æ–¹çš„åºåˆ—å·+payloadé•¿åº¦</p><p><strong>çª—å£çš„åº”ç”¨</strong></p><p>å‘ç°äº†æœ‰è¶£ä¹‹å¤„<img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220331191642232.png" alt="image-20220331191642232">ï¼Œæ­¤æ—¶ServeråŒæ—¶ä¼ äº†ä¸¤ä¸ªTCP PDUç»™Clientï¼Œä½†Clientåªç”¨äº†ä¸€ä¸ªACKåŒ…å°±è¡¨æ˜å—åˆ°ï¼Œè¿™é‡Œå°±æ¶‰åŠåˆ°TCPçš„çª—å£çŸ¥è¯†äº†</p><p>æœ€ç»ˆåœ¨ä¼ å®Œä¸€æ•´ä¸ªè¯·æ±‚çš„æ•°æ®åŒ…æ—¶ï¼ŒClientè¿”å›æœ€åä¸€ä¸ªæ•°æ®åŒ…çš„ACKåŒ…ï¼Œéšä¹‹Serverå‘Clientä¼ HTTP 200çš„å“åº”åŒ…ï¼Œï¼ˆPSHå’ŒACK = 1ï¼‰<strong>åˆ°è¿™é‡Œï¼Œå¯¹æœåŠ¡å™¨æ¥è¯´ï¼Œæ‰ç®—æ˜¯æŠŠä¸€ä¸ªè¯·æ±‚å“åº”ç»“æŸï¼</strong>ã€‚Clientè¿”å›ACKåŒ…è¡¨ç¤ºæ”¶åˆ°ï¼Œï¼ˆçŒœæµ‹å¯èƒ½ä¼šåœ¨è¿™é‡Œæµè§ˆå™¨ä¼šåˆæ­¥åŠ è½½æ²¡æœ‰css jsç­‰çš„é¡µé¢ï¼‰ã€‚</p><p>ç„¶åClientå¯ä»¥å¼€å§‹å‘é€æ–°çš„HTTPè¯·æ±‚ï¼Œæ¯”å¦‚get cssæ–‡ä»¶ç­‰</p><h4 id="TCP-Stream">TCP Stream</h4><p>åœ¨è¿™é‡Œï¼Œå¯¹ä¸€ä¸ªè¿”å›æ•°æ®é‡è¾ƒå¤§çš„HTTPè¯·æ±‚ï¼ŒWireSharkä¼šæ˜¾ç¤º&quot;TCP segment of a reassembled PDU&quot;ï¼Œè¿™é‡Œå…¶å®å¯¹TCPçš„çŸ¥è¯†è¿˜ä¸å¤ªç†Ÿæ‚‰ã€‚ä»Šå¤©çœ‹äº†ä¸‹å…ˆå‹‰å¼ºè§£é‡Šä¸‹ï¼Œä¸IPåˆ†ç‰‡ä¸åŒï¼Œå› ä¸ºä¸€ä¸ªè¿”å›æ•°æ®é‡å¤§çš„è¯·æ±‚ä¼šæŠŠæ•°æ®ä»TCPå±‚æ‹†åˆ†ï¼Œä»–ä»¬å…·æœ‰ä¸åŒçš„ç¡®è®¤å·å’Œåºåˆ—å·ï¼Œä»¥ç±»ä¼¼æµçš„å½¢å¼æŒç»­è¾¾åˆ°ç›®çš„ç«¯å£ï¼Œå¯åœ¨WireSharké‡Œâ€œFollow TCP Streamsâ€èƒ½å¤Ÿçœ‹åˆ°å®Œæ•´çš„æ•°æ®åŒ…ï¼ˆå¯¹äºä¸€ä¸ªç½‘é¡µè¯·æ±‚ï¼Œå®Œæ•´æ•°æ®å°±æ˜¯ä¸€ä¸ªç½‘é¡µçš„htmlä»£ç ï¼‰ã€‚<br><a href="https://www.wireshark.org/lists/wireshark-users/200805/msg00206.html">ğŸ”— WireSharkçš„å¯¹TCP PDUçš„è§£é‡Š</a>  <a href="https://www.wireshark.org/docs/wsug_html_chunked/ChAdvReassemblySection.html">ğŸ”— What is Packet Reassembly</a></p><p>å¯¹ä¹‹å‰çš„æ•°æ®åŒ…æ¥è¯´ï¼ŒWireSharkä¼šæ ‡æ³¨[Reassembled PDU in frame:xxx]ï¼Œå…¶ä¸­xxxå°±ä»£è¡¨çš„æ˜¯HTTP 200ç­‰å“åº”çš„å›å¤ï¼Œä»£è¡¨è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ•°æ®</p><p><strong>ä¸€ä¸ªACKåŒ…ç¡®è®¤å¤šä¸ªå‘é€åŒ…</strong></p><p>ä¾‹å¦‚è¿™é‡Œä¾¿ç”¨ä¸€ä¸ªACKç¡®è®¤äº†ä¸¤ä¸ªå‘é€çš„åŒ…</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220405130940538.png" alt="image-20220405130940538"></p><h3 id="å¼‚å¸¸æƒ…å†µåˆ†æ">å¼‚å¸¸æƒ…å†µåˆ†æ</h3><h4 id="Sack">Sack</h4><p>ç»“æ„ï¼šåœ¨Optionä¸­ï¼Œ1å­—èŠ‚è¡¨ç¤ºç±»å‹ï¼Œ1å­—èŠ‚è¡¨ç¤ºè¯¥SACKéƒ¨åˆ†å ç”¨å­—èŠ‚é•¿åº¦ï¼Œå‰©ä¸‹çš„å­—èŠ‚åˆ†åˆ«ä¸ºå·¦å³edgeçš„èŒƒå›´ ä¸€èˆ¬æ€»å…±ä¸º10ä¸ªå­—èŠ‚ï¼Œæœ€å¤šæºå¸¦3ä¸ªSACK(ç•™10ä¸ªå­—èŠ‚è¦ç»™TimeStamp)</p><p><strong>è§£é‡Šä¸€ä¸‹æŸäº›æƒ…å†µä¸‹Bytes in flightçš„çŒ›å¢ç°è±¡</strong></p><p>åˆšçœ‹çš„æ—¶å€™ä¸€ç›´è¢«ä¸æŒ‰ æœªè¢«ACKçš„åŒ…é€ æˆçš„Bytes in flightçŒ›å¢ç°è±¡ææ··ï¼Œåˆ†æäº†ä¸€ä¸‹ ã€‚</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220405194323205.png" alt="image-20220405194323205"></p><p>ä¾‹å¦‚è¿™é‡Œï¼Œåœ¨ç»å†ä¸¤æ¬¡Dup ACK åï¼ŒBytes in flightä»4194æ¿€å¢åˆ°50328ï¼Œä¸ºä»€ä¹ˆï¼Ÿä¾æ¬¡åšå‡æ³•ï¼š1122595 - 50328 = 1072267ï¼Œæ­£æ˜¯è€ƒè™‘åˆ°å…¶å®æœ‰æœ€åˆDUP  ACKåŒ…çš„æœ€å°SACKçš„left edgeå€¼ï¼Œè¯´æ˜äº†ä»€ä¹ˆï¼Ÿå…¶å®æ˜¯åˆ°ä¸Šä¸€ä¸ªåŒ…å‘é€çš„Seq + length åˆ° SACK left edgeçš„å·®ï¼Œä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œå®ƒæŠŠæ²¡æœ‰å°šæœªæ¥å—çš„åŒ…ä¹Ÿè€ƒè™‘åœ¨å†…</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220405195326028.png" alt="image-20220405195326028"></p><p>æ¥ä¸‹æ¥ä¹Ÿç±»ä¼¼ï¼Œå°½ç®¡æœ‰ä¸¤ä¸ªSACKï¼Œä½†è¿˜æ˜¯å°†æœ€è¿‘åŒ…çš„Seq+length ä¸æœ€åˆSACKçš„left edgeåšå·®ï¼Œè¡¨æ˜è¿™ä¹‹é—´çš„åŒ…æ²¡æœ‰æ”¶åˆ°ã€‚å°½ç®¡ä¸¤ä¸ªSACKä¹‹é—´çš„åŒ…ã€‚</p><p>è¿™é‡Œå®è·µæ€»ç»“å°±æ˜¯å¦‚æœæœåŠ¡ç«¯åœ¨ä¼ å¤§äºACKçš„å…¶ä»–åŒ…ï¼Œåˆ™å€¼ä¸ºå½“å‰Seq+length - æœ€åˆSACK left edgeï¼›å¦‚æœæ­£åœ¨ä¼ å½“å‰è¦çš„ACKï¼Œåˆ™SACKæœ€å¤§å€¼çš„left edge - Seqä¸è¿‡è¿™é‡Œè¿˜æœªå®Œå…¨ç†è§£</p><p>**å…¶å®å°±æ˜¯Serverå‘é€çš„ï¼Œä½†Clientè¿˜æœªæ¥æ”¶åˆ°çš„æ•°æ®çš„æ€»å’Œï¼Œä¸è¦æå¾—å¤ªå¤æ‚äº† **</p><h4 id="Dup-Packet">Dup Packet</h4><p>TCP Duplicate Packet ï¼šæŒ‡ç¤ºä¸ä¹‹å‰å·²ackçš„åŒ…æœ‰ç›¸åŒçš„åºåˆ—å·å’Œç¡®è®¤å·ï¼Œé€šå¸¸æ˜¯å¸¦æœ‰SACKçš„ã€‚æ¯”å¦‚è¿™é‡Œï¼š</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220405144319645.png" alt="image-20220405144319645"></p><p>Serverçš„637693ã€639091çš„æ•°æ®åŒ…è¿‡å¿«åˆ°è¾¾ï¼ˆä¹‹å‰çš„åŒ…å¯èƒ½å› æ—¶å»¶è¿˜æœªåˆ°è¾¾ï¼‰ï¼Œä½†Clientæ— æ³•æ ¹æ®é¡ºåºæ¥å—è¿™ä¸ªåŒ…ï¼ŒTCPé¡ºåºä¸åŒ¹é…ï¼Œæ‰€ä»¥Clientå†å‘é€ä¸€æ¡ACK åŒ…ï¼Œç¡®è®¤å·å’Œåºåˆ—å·éƒ½ä¸ä¸Šä¸€æ¡ç›¸åŒï¼Œæ‰€ä»¥è¢«æ ‡æ³¨ä¸ºTCP Duplicate ACK (Packet)ã€‚<br>æ›´æœ‰æ„æ€çš„æ˜¯ï¼Œå…¶TCP Optionä¸­å¸¦æœ‰637693-640489çš„SACKï¼Œè¡¨æ˜ä¹‹å‰çš„ä¸¤ä¸ªåŒ…æˆ‘æœ‰äº†ï¼Œä½†æ˜¯é¡ºåºä¸å¯¹ï¼Œè¿˜æ²¡æ¥åˆ°ä»æˆ‘ACKå¼€å§‹çš„åŒ…</p><p>è¿‡å¤šçš„Duplicate PacketæŒ‡æ˜å¯èƒ½å½“å‰ç½‘ç»œä¸¢åŒ…ç‡è¾ƒé«˜</p><h4 id="TCP-Retransmission">TCP Retransmission</h4><p>ä¸€ä¸ªå…¸å‹çš„æ¡ˆä¾‹ï¼š<img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220405151110207.png" alt="image-20220405151110207"></p><p>è¿™é‡Œå°±æ¯”è¾ƒæ¸…æ¥šï¼Œä¹‹å‰ä¼ çš„15379çš„åŒ…Clientä¸€ç›´æ²¡æ¥æ”¶åˆ°ï¼Œç„¶åClientå°±ä¸æ–­çš„ç»™Serverå‘å¸¦æœ‰æ›´æ–°SACKçš„Dup ACK Packetï¼ŒServeråæ¥æ¥æ”¶åˆ°è¿™ä¸ªåŒ…ï¼ŒçŸ¥é“è‡ªå·±ä¹‹å‰å‘çš„15379çš„åŒ…å¯èƒ½lossäº†ï¼Œæ‰€ä»¥é‡æ–°å‘äº†ä¸€ä¸ª15379çš„åŒ…</p><h4 id="Congestion-Control">Congestion Control</h4><p>æ‹¥å¡æ§åˆ¶ï¼š<strong>æœåŠ¡ç«¯</strong>è´Ÿè·è¿‡é‡ï¼Œè¯·æ±‚è¿‡å¤š</p><h4 id="TCP-Keep-Alive">TCP Keep-Alive</h4><p>é•¿è¿æ¥ ä¿æ´»ï¼Œä¸€æ®µæ—¶é—´å†…ä¸€æ–¹æœªå›åº”æˆ–æœªå‘åŒ…ï¼Œå°±ä¼šå‘é€ä¸€ä¸ªKeep-AliveåŒ… æ— è½½è·Seqä¸ä¸Šä¸€ä¸ªåŒ…é‡åˆï¼Œå¦‚æœå¯¹æ–¹åœ¨çº¿ï¼Œå°±ä¼šå›ä¸€ä¸ªåŒ…ï¼Œæ¥ç¡®ä¿è¿æ¥ç»§ç»­</p><h4 id="Window-Size">Window Size</h4><p>é‡åˆ°ä¸€ä¸ªå‘ç‚¹ï¼Œè‡ªå·±ç”¨çš„æ¢¯å­ï¼Œæ‰€ä»¥å»è®¿é—®è‡ªå·±çš„æœåŠ¡å™¨æ—¶ï¼ŒWindow Sizeæ€»æ˜¯1398,å¹¶ä¸”è®¿é—®å…¶ä»–çš„ç½‘ç«™æ—¶ï¼Œä¹Ÿéƒ½æ˜¾ç¤ºçš„æ˜¯ä»æŸä¸€ä¸ªæŒ‡å®šçš„ç½‘ç«™ä¸Šè¿”å›è¿‡æ¥çš„æ•°æ®ï¼Œéš¾æ€ªå»filter hostå´æ‰¾ä¸åˆ°å¯¹åº”çš„æ•°æ®åŒ…ï¼ŒåŸæ¥æ˜¯æˆ‘ä»£ç†çš„é—®é¢˜ï¼Œåæ¥æŠŠä»£ç†æ”¹äº†åº”è¯¥å°±æ²¡æœ‰é—®é¢˜äº†</p><p>ä½†æœ‰æ—¶å€™æœºå™¨æ€§èƒ½å¤ªå¥½ã€ç½‘ç»œ å¤ªå¥½ï¼Œå¯¼è‡´æ— æ³•æ•è·åˆ°Window Fullæƒ…å†µï¼Œå°±éœ€è¦æ‰‹åŠ¨è°ƒæ•´Linux TCPçš„çª—å£å¤§å°ï¼š</p><h5 id="Linuxè®¾ç½®Window-Size">Linuxè®¾ç½®Window Size</h5><ol><li>route -neæŸ¥çœ‹é»˜è®¤è·¯ç”±è¡¨ã€‚</li><li>sudo  route del defaultåˆ é™¤é»˜è®¤è·¯ç”±è¡¨</li><li>sudo route add default gw 172.20.10.1 window xxx dev wlo1ï¼Œå¢åŠ æ–°çš„è·¯ç”±è¡¨ï¼Œå¸¦æœ‰windowçº¦æŸ</li></ol><p>ï¼ˆä¼šå‘ç°ç½‘é¡µçš„åŠ è½½éƒ½å˜æ…¢è®¸å¤šï¼‰è¿˜æœ‰ä¸€äº›æ–¹æ³•æ˜¯ä¸´æ—¶ä¿®æ”¹/etc/sys/netä¸‹çš„æ–‡ä»¶ï¼Œæ²¡è¯•è¿‡æ€•æ”¹é”™ã€‚</p><h3 id="å››æ¬¡æŒ¥æ‰‹">å››æ¬¡æŒ¥æ‰‹</h3><p>ä¸ºäº†ç›´è§‚äº†è§£æŒ¥æ‰‹æƒ…å†µï¼Œä¸å—å…¶ä»–å› ç´ å½±å“ï¼Œè¿™é‡Œæˆ‘é‡‡ç”¨çš„æ˜¯ä»sshæ–­å¼€è¿æ¥çš„æƒ…å†µ</p><p>è¾“å…¥exitåï¼Œæ•²å…¥å›è½¦ï¼ŒClientç»™Serverå‘å›è½¦çš„æ•°æ®åŒ…ï¼ŒServerå‘ç›¸åº”çš„æ•°æ®åŒ…åœ¨terminalä¸­æ˜¾ç¤ºï¼›Clientå‘ackæŠ¥è¡¨ç¤ºå·²ç»æ¥å—</p><p><strong>ç¬¬ä¸€æ¬¡æŒ¥æ‰‹</strong></p><p>Client - &gt; Serverï¼šå®¢æˆ·ç«¯å®Œæˆäº†æ‰€æœ‰è¯·æ±‚ï¼Œè¦æ±‚æ–­å¼€ã€‚FIN å’Œ ACKå‡ç½®ä¸º1ï¼Œç¡®è®¤å·è¿˜æ˜¯å¯¹æ–¹å‘çš„ä¸Šä¸€ä¸ªåŒ…çš„åºåˆ—å·+payload.length</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220331200819661.png" alt="image-20220331200819661"></p><p><strong>ç¬¬äºŒæ¬¡æŒ¥æ‰‹</strong></p><p>Server -&gt; Clientï¼šè¡¨æ˜æˆ‘å·²ç»æ¥æ”¶åˆ°ä½ çš„ç»“æŸè¯·æ±‚ï¼ŒACK=1</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220331220424436.png" alt="image-20220331220424436"></p><p><strong>ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹</strong></p><p><strong>Server-&gt;Client</strong>ï¼šè¡¨æ˜â€œé‚£æˆ‘ä¹Ÿèµ°äº†â€ï¼Œä¸Clientç±»ä¼¼ï¼Œè®¾ç½®FINå’ŒACK=1ï¼Œè¿™æ—¶<strong>ç¡®è®¤å·è¦åœ¨ç¬¬äºŒæ¬¡çš„åŸºç¡€ä¸Š+1</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220331221931572.png" alt="image-20220331221931572"></p><p><strong>ç¬¬å››æ¬¡æŒ¥æ‰‹</strong></p><p>Client -&gt; Serverï¼šå®¢æˆ·ç«¯è¯´æˆ‘ä¹ŸçŸ¥é“ä½ è¦èµ°äº†ï¼Œå‘é€åè¿›å…¥2MSLåï¼Œè¿›å…¥CLOSEDçŠ¶æ€ã€‚Serveræ¥å—åˆ°è¿™ä¸ªæ•°æ®åŒ…æ—¶ï¼Œä¸å†å‘æ•°æ®åŒ…ï¼Œè¿›å…¥CLOSEDçŠ¶æ€</p><div class="note note-primary">            <p>å¯¹å››æ¬¡æŒ¥æ‰‹çš„ç»†èŠ‚åŠåŸç”±  ç§»æ­¥ã€Šè®¡ç½‘ã€‹</p>          </div><h3 id="Telnetè¿‡ç¨‹">Telnetè¿‡ç¨‹</h3><h3 id="SSHè¿‡ç¨‹">SSHè¿‡ç¨‹</h3><h4 id="åŸºäºdockerçš„SSHè¿‡ç¨‹">åŸºäºdockerçš„SSHè¿‡ç¨‹</h4><h3 id="FTPè¿‡ç¨‹">FTPè¿‡ç¨‹</h3><h3 id="ç½‘ç»œæ‹¥å¡æ§åˆ¶åˆ†æ">ç½‘ç»œæ‹¥å¡æ§åˆ¶åˆ†æ</h3><h3 id="DNSè¿‡ç¨‹">DNSè¿‡ç¨‹</h3><h3 id="TLSè¿‡ç¨‹">TLSè¿‡ç¨‹</h3><p><strong>ä¸ºä»€ä¹ˆåœ¨ä¸‰æ¬¡æ¡æ‰‹åä¼šæœ‰Client Hello</strong></p>]]></content>
    
    
    
    <tags>
      
      <tag>Network</tag>
      
      <tag>WireShark</tag>
      
      <tag>TCP/IP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MATLABå…¥é—¨</title>
    <link href="/2022/02/16/MATLAB%E5%85%A5%E9%97%A8/"/>
    <url>/2022/02/16/MATLAB%E5%85%A5%E9%97%A8/</url>
    
    <content type="html"><![CDATA[<h1>MATLABå…¥é—¨</h1><h2 id="åŸºæœ¬å¸¸è¯†">åŸºæœ¬å¸¸è¯†</h2><p>MATLABé»˜è®¤æ•°æ®ç±»å‹æ˜¯double</p><p>Infï¼šæ— é™å¤§ epsï¼š2.2204e-016æ— é™å°</p><p><strong>ä¸åŠ â€œï¼›â€ï¼Œåˆ™ä¼šæ‰“å°å‡ºè¯¥ç­‰å¼çš„ç»“æœå€¼</strong></p><p><strong>Matlabç´¢å¼•ä» 1 å¼€å§‹</strong></p><p><strong>Calling Priority</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220216095307953.png" alt="image-20220216095307953"></p><p>%% ï¼šåŒºåˆ†ä¸€ä¸ªsection</p><p>ä¸€è¡Œæ‰“ä¸å®Œ ç”¨â€¦ å¯ä»¥åœ¨ç¬¬äºŒè¡Œç»§ç»­å†™</p><h3 id="æ•°ç»„">æ•°ç»„</h3><h3 id="æ¡ä»¶è¡¨è¾¾å¼">æ¡ä»¶è¡¨è¾¾å¼</h3><p>æ³¨æ„éƒ½è¦æœ‰endç»“å°¾</p><ul><li>if elseif else</li><li>switch case  <strong>otherwise</strong></li><li>while</li><li>for n = a:increment:c</li></ul><h3 id="å‡½æ•°">å‡½æ•°</h3><p>function [A B] = â€¦è¡¨ç¤ºç»“æœæ˜¯å¤šä¸ªç»“æœ</p><p>function handle</p><div class="code-wrapper"><pre class="language-matlab" data-language="matlab"><code class="language-matlab">f <span class="token operator">=</span> <span class="token operator">@</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>x<span class="token operator">=</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">0.1</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">;</span></code></pre></div><p>ç›¸å½“äºæ˜¯å‡½æ•°æŒ‡é’ˆ fæ˜¯æŒ‡å‘å‡½æ•°exp(-2*x)çš„æŒ‡é’ˆ</p><h3 id="çŸ©é˜µ">çŸ©é˜µ</h3><h4 id="çŸ©é˜µæŸ¥è¯¢"><strong>çŸ©é˜µæŸ¥è¯¢</strong></h4><p>A=[1,2,3;4,5,6;6,7,8],å¯¹äºé€šè¿‡A(x)æŸ¥æ‰¾çŸ©é˜µä¸­çš„æŸä¸ªæ•°ï¼Œæ˜¯æŒ‰ç…§åˆ—ä»ä¸Šè‡³ä¸‹çš„é¡ºåºæ¥çš„ï¼Œè€Œéè¡Œ<br>A([a b c])å¯æŸ¥æ‰¾å¤šä¸ªæ•°<br>A([a b;a c;])å¾—åˆ°çŸ©é˜µ<br>A([a b],[a c]) row a b å’Œ col a cçš„äº¤é›†</p><h4 id="çŸ©é˜µå˜æ¢"><strong>çŸ©é˜µå˜æ¢</strong></h4><p>æ›¿æ¢æŸä¸ªæ•°ï¼šA(r,c)=x<br>ç­‰å·®æ•°åˆ—åº”ç”¨ A=[1:5; 2:3:15;-2:0.5:0]</p><p>å¯¹AçŸ©é˜µï¼ŒA(3,:)=[]å¯å°†è¯¥è¡ŒæŠ¹æ‰ï¼Œè¾¾åˆ°åˆ é™¤çš„æ•ˆæœ</p><h4 id="çŸ©é˜µè¿ç®—"><strong>çŸ©é˜µè¿ç®—</strong></h4><p>A.*Bï¼šç›´ä¹˜ï¼Œç»“æœçŸ©é˜µçš„ï¼ˆi , jï¼‰=A(i,j) * B(i,j)<br>./  .^ï¼šæ•ˆæœåŒä¸Š</p><h4 id="ä¾¿æ·æŒ‡ä»¤">ä¾¿æ·æŒ‡ä»¤</h4><ul><li>eye(n)ï¼šnç»´å•ä½çŸ©é˜µ</li><li>zeros(r,c)ï¼šé›¶çŸ©é˜µ</li><li>ones(r,c)ï¼šå…¨ä¸º1çš„çŸ©é˜µ</li><li>diag([a,b,c])ï¼šå¯¹è§’çŸ©é˜µ</li><li>max(A)ï¼šæ‰¾åˆ°æ¯ä¸ª<strong>col</strong>ä¸­æœ€å¤§çš„æ•°</li><li>sum  min meanï¼ˆæ±‚å¹³å‡ï¼‰åŒä¸Š</li><li>sort(A)ï¼šä¸æ”¹å˜Aï¼Œå¦å¤–åˆ›å»ºä¸€ä¸ªçŸ©é˜µ å¯¹æ¯ä¸ªcolæŒ‰å‡åºæ’åº</li><li>sortrows(A)ï¼šåŸºäºç¬¬ä¸€åˆ—çš„å…ƒç´ æŒ‰å‡åºç»™çŸ©é˜µæ’åºï¼Œæ³¨æ„è¿™é‡Œæ˜¯ä¸€æ•´è¡Œçš„ç§»åŠ¨ï¼Œä¸sortä¸åŒ</li><li>size(A)ï¼šæ±‚row å’Œ colæ•°</li><li>length(A)ï¼šæ±‚rowï¼Œå³vector</li><li>find(A==x)ï¼šæ±‚çŸ©é˜µAä¸­ç­‰äºxçš„ä½ç½®ï¼ˆç´¢å¼•æ–¹å¼è¿”å›ï¼‰</li></ul><h3 id="è¿ç®—ç¬¦">è¿ç®—ç¬¦</h3><p>*<em>ä¸€å®šè¦æ³¨æ„./ .<em>çš„åº”ç”¨ï¼Œè€ƒè™‘å¼•å…¥å‘é‡æ˜¯å¦ä¼šå‡ºé”™</em></em></p><p><strong>â€˜ï¼šâ€™ (Colon)</strong></p><p>ç­‰å·®æ•°åˆ—  A=[1:100] first = 1 end = 100 step = 1<br>A=[1:2:100] first = 1 end = 100 step = 2<br>ä¸å­—ç¬¦æ··ç”¨ str=â€˜aâ€™:2:â€˜zâ€™</p><p>è¡¨å…¨éƒ¨ï¼šA(3,:)è¡¨ç¤ºçŸ©é˜µAçš„row 3çš„å…¨éƒ¨</p><p><strong>~=</strong>ï¼š ç­‰äºï¼=</p><h3 id="å˜é‡">å˜é‡</h3><p>å˜é‡ç±»å‹</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220216182508540.png" alt="image-20220216175259436"></p><p>Matlabç±»å‹è½¬æ¢ é€šè¿‡å‡½æ•°è¿›è¡Œ ä¾‹å¦‚int16(x)</p><h4 id="å­—ç¬¦ä¸²">å­—ç¬¦ä¸²</h4><p>å­—ç¬¦ä¸²è¿æ¥Concat: [s1,s2]</p><p>å­—ç¬¦ä¸²ä¸­å­—ç¬¦çš„æ¯”è¾ƒ str=='aâ€™æ˜¯stræ¯ä¸ªå­—ç¬¦ä¸â€™aâ€™è¿›è¡Œæ¯”è¾ƒï¼Œä¸”str==â€˜aâ€™ä¸â€™aâ€™==stræœ‰ä¸åŒçš„æ„ä¹‰ï¼Œä¸€ä¸ªæ˜¯ä¸€ç»´çš„æ¯”è¾ƒä¸€ä¸ªæ˜¯å¤šç»´çš„æ¯”è¾ƒ</p><p>å­—ç¬¦ä¸²æŸ¥æ‰¾æ›¿æ¢ï¼šstr(str==â€˜lâ€™) = â€˜Lâ€™<br>str=='lâ€™è¿”å›çš„æ˜¯é€»è¾‘ç»“æœï¼Œä¾‹å¦‚11000010ï¼ŒæŒ‡ç¤ºäº†å¯¹åº”çš„ç´¢å¼•ä½ç½®â€”å¤šç´¢å¼•ä½ç½®çš„æŒ‡ç¤º</p><h3 id="ç»“æ„ä½“">ç»“æ„ä½“</h3><p>å¯ç”¨structå‡½æ•°å»å£°æ˜ä¸€ä¸ªstructï¼ˆâ€˜nameâ€™,value,â€˜nameâ€™,value,â€¦ï¼‰ï¼Œ<a href="http://xn--Student-ug4k22bt62ad85bzoyc.name">ä¹Ÿå¯ä»¥ç›´æ¥Student.name</a> = â€¦å£°æ˜</p><p>ç»“æ„ä½“å¤ç”¨ï¼šStudent(2).name  â€¦<br>è¿™æ—¶ï¼ŒStudentå°±ä»å•ä¸ªå˜é‡ï¼Œå˜æˆä¸€ç»´å‘é‡äº†</p><h4 id="ç»“æ„ä½“å‡½æ•°">ç»“æ„ä½“å‡½æ•°</h4><ul><li>rmfield</li><li>setfield</li><li>struct</li><li>sturct2cell</li><li>fieldnames</li><li>getfield</li><li>isfield</li><li>â€¦</li></ul><h3 id="Cell-Array">Cell Array</h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220216175259436.png" alt="image-20220216182508540"></p><p>å£°æ˜ä¸€ä¸ªCell Array</p><div class="code-wrapper"><pre class="language-matlab" data-language="matlab"><code class="language-matlab"><span class="token function">A</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">&#123;</span>xxxx<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token function">A</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">&#123;</span>xxxx<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token function">A</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">&#123;</span>xxxx<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token function">A</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">&#123;</span>xxxxx<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">% ä¹Ÿå¯ä»¥ç”¨è¿™ç§æ–¹å¼A&#123;1,1&#125;=xxxx;</span></code></pre></div><p>æ¯ä¸ªEntryéƒ½æœ‰ä¸€ä¸ªpointeræŒ‡å‘å¯¹åº”çš„æ•°æ®</p><p>æŸ¥çœ‹Cell Arrayä¸­çš„<strong>æ•°æ®ç±»å‹</strong>ï¼šA(1,1)<br>æŸ¥çœ‹Cell Arrayä¸­çš„æ•°æ®å€¼ï¼šA{1,1}</p><h4 id="Function">Function</h4><ul><li>cellï¼šåˆ›å»ºä¸€ä¸ªCell Array</li><li>cell2mat</li><li>cell2struct</li><li>cekkduso</li><li>cellfun</li><li>cellplot</li><li>cellstr</li><li>num2cell</li></ul><h4 id="Multidimension-Array">Multidimension Array</h4><p>ä¸‰ç»´åŠä»¥ä¸Šçš„ç»“æ„ä½“ï¼Œé™¤äº†row å’Œ colå¤–è¿˜æœ‰layerç­‰</p><p>A{1,1,1}=xxx;å£°æ˜ä¸€ä¸ª</p><p>æˆ–è€…ç”¨<strong>cat</strong>è¿æ¥ï¼š</p><p>cat(x,A,B)ï¼šA Bä¸ºè¦è¿æ¥çš„Array<br>xçš„å€¼ä»£è¡¨ä¸åŒçš„ç»´åº¦ï¼š1-&gt;row;2-&gt;col;3-&gt;layer</p><p>é‡å¡‘reshape(A,r,c)ï¼šå°†A Arrayå˜æ¢æˆä¸åŒrow colæ’å¸ƒçš„Array</p><h3 id="è¿›é˜¶">è¿›é˜¶</h3><h4 id="File-Access">File Access</h4><ul><li>save mydata.mat -ascii ï¼šå°†workspaceæ‰€æœ‰dataå­˜å…¥ç›®æ ‡æ–‡ä»¶ï¼Œæä¾›ä¸åŒç¼–ç æ ¼å¼çš„å­˜å…¥</li><li>load(â€˜filenameâ€™,â€˜-asciiâ€™)ï¼šåŠ è½½matæ•°æ®<ul><li>è¿˜å¯ä»¥è¯»å–xlsxæ–‡ä»¶çš„æŒ‡å®šè¡Œåˆ—ï¼Œæ¯”è¾ƒç‰›é€¼</li></ul></li><li>xlswrite(â€˜filename.xlsxâ€™,value,sheetpage,â€˜E2:E4â€™)ï¼šå†™æ•°æ®åˆ°xlsx</li><li>xlsreadï¼šè¯»å–xlsxæ–‡ä»¶ [Score Header]=xlsread(filename)</li></ul><h5 id="File-I-O">File I/O</h5><ul><li>fopen(filename,â€˜râ€™)ï¼šè¿”å›fid</li><li>fclose</li><li>fscanf(fid,type(â€˜%dâ€™),size)</li><li>fprintf(fid,format,value)</li><li>feof(fid)ï¼šæ£€æµ‹æ–‡ä»¶æ˜¯å¦ç»“æŸ<ul><li>while ~feof(fid)å¸¸ç”¨</li></ul></li></ul><h4 id="Graphics">Graphics</h4><p>MATLABä¸ä¼šç›´æ¥é€šè¿‡è¡¨è¾¾å¼ç”»å›¾ï¼Œè€Œæ˜¯é€šè¿‡ç‚¹æ¥ç”»å›¾</p><p><strong>plot</strong></p><p>plot(x,y, format) / plot(y)  formatè¯¦ç»†ä¿¡æ¯æœç´¢linspec</p><p><strong>legend()</strong> ä¸ºæ›²çº¿æ·»åŠ å›¾ä¾‹</p><p><strong>title()</strong> æ·»åŠ æ ‡é¢˜åç§°<br>xlabel()  ylabel()  zlabel()<br>text(0.25ï¼Œ2.5ï¼Œstrï¼Œ â€˜Interpreterâ€™ï¼Œâ€˜latexâ€™) é€šè¿‡LaTexæ˜¾ç¤ºç‰¹æ®Šçš„æ•°å­¦è¡¨è¾¾å¼ å…¶ä¸­str=â€˜$ $xxxxx$ $â€™<br>annotation() æŒ‡ç¤ºç®­å¤´</p><p>axis normal /equal(x yå•ä½é•¿åº¦ä¸€è‡´)/ square(x y æµ‹é‡é•¿åº¦ä¸€æ ·) /tight é™åˆ¶åæ ‡è½´ä¸å›¾åƒçš„è´´åˆç¨‹åº¦</p><p>hold on hold off ä½¿å¾—èƒ½å¤Ÿåœ¨ä¸€ä¸ªFigureé‡Œå±•ç°å¤šä¸ªplotå›¾<br>figure,plot(x,y) ä½¿å¾—ç”»ä¸¤ä¸ªå›¾ï¼Œä½†gcaå’Œgcfå°±æ˜¯æ–°çš„äº†<br>figure(1)  figure(2) æŒ‡å®šä¸åŒçš„figure<br>grid on off æ‰“å¼€ç½‘æ ¼</p><p>åœ¨ä¸€ä¸ªfigureä¸Šç”»å‡ ä¸ªfigureï¼šsubplot(row,col,index);</p><p><strong>Graphical Object</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220216095819976.png" alt="image-20220216203657198"></p><p>Utility functionsï¼š</p><ul><li>gca  ï¼ˆhandle of axesï¼‰</li><li>gcf    (handle of figure)</li><li>allchild</li><li>ancestor</li><li>delete</li><li>findall</li><li>get / set å»è®¾ç½®ä¸åŒpropertyçš„å±æ€§å€¼<ul><li>set(get(gca),â€˜keyâ€™,value)</li></ul></li></ul><h5 id="Save">Save</h5><p><strong>saveæŒ‡ä»¤</strong></p><p>saveas(gcf,â€˜filenameâ€™,â€˜formattypeâ€™)</p><p>é«˜è§£æåº¦  ä½¿ç”¨print</p><h5 id="Advanced">Advanced</h5><p><strong>Logarithm Plots</strong></p><p>semilogx semilogy loglogï¼šä»¥åæ ‡è½´çš„å¯¹æ•°å·®è·æ˜¾ç¤º</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220217102911572.png" alt="image-20220217102911572"></p><div class="code-wrapper"><pre class="language-matlab" data-language="matlab"><code class="language-matlab">x<span class="token operator">=</span><span class="token function">logspace</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>y<span class="token operator">=</span>x<span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">plot</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">set</span><span class="token punctuation">(</span>gca<span class="token punctuation">,</span><span class="token string">'XTick'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'Plot'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">semilogx</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'Semilogx'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">semilogy</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>YData<span class="token operator">=</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'Semilogy'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">loglog</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>YData<span class="token operator">=</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'LogLog'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">set</span><span class="token punctuation">(</span>gca<span class="token punctuation">,</span><span class="token string">'XGrid'</span><span class="token punctuation">,</span><span class="token string">'on'</span><span class="token punctuation">)</span>A<span class="token operator">=</span><span class="token function">get</span><span class="token punctuation">(</span>gca<span class="token punctuation">)</span></code></pre></div><p><strong>plotyy</strong></p><p>ä¸¤ä¸ªyè½´ï¼Œä¸€å·¦ä¸€å³</p><p><strong>Histogram</strong></p><p>hist()  histogram()  ç›´æ–¹å›¾</p><p><strong>Bar Charts</strong></p><p>bar()  bar3() æ¡å½¢å›¾</p><p>Stacked And Horizeontal Bar Charts</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220217103925576.png" alt="image-20220217103925576"></p><p><strong>Pie Charts</strong></p><p>åœ†é¥¼å›¾ pie()</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220217104032664.png" alt="image-20220217104032664"></p><p><strong>Polar Chart</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220217104137982.png" alt="image-20220217104137982"></p><p><strong>Stairs</strong></p><p>é˜¶æ¢¯å›¾ <img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220217104302289.png" alt="image-20220217104302289"></p><p><strong>Stem</strong></p><p>ç¦»æ•£æ•°æ®å›¾<img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220217104342873.png" alt="image-20220217104342873"></p><p><strong>å…¶ä»–çš„å›¾</strong></p><ul><li>BoxPlot ç®±çº¿å›¾</li><li>errorbar</li><li>meshgrid äºŒä¸‰ç»´ç½‘æ ¼å›¾<ul><li><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220217110621149.png" alt="image-20220217110621149"></li><li>æ­é…colorbar</li><li><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220217111801286.png" alt="image-20220217110734864"></li><li>colormapå»ä¼˜åŒ–è‰²è°ƒï¼Œæœ‰ä¸åŒçš„è‰²è°ƒé€‰æ‹©</li></ul></li><li>imagesc</li><li>3D Plot<ul><li>plot3</li><li>meshgrid  : mesh  surfçš„åŒºåˆ«<img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220217110734864.png" alt="image-20220217111801286"></li><li>contourï¼šç±»ä¼¼åœ°ç†ç­‰é«˜çº¿</li><li>è®¾ç½®View Angle<ul><li>view()</li></ul></li><li>sphere åˆ›å»ºçƒé¢<ul><li>shading flat å»æ‰æ›²çº¿</li><li>material shiny ä½¿å¾—å¯¹è±¡å…·æœ‰ç›¸å¯¹äºæ¼«åå°„å’Œç¯å¢ƒå…‰æ›´é«˜çš„é•œé¢åå°„</li><li>axis vis3d off å»æ‰åæ ‡è½´å’Œ3dçš„æ‹–åŠ¨åŠŸèƒ½</li><li>light æ‰“å…‰</li></ul></li></ul></li></ul><h5 id="Draw">Draw</h5><p><strong>Fill</strong></p><p>åœ¨x y ç‚¹ç»„é™å®šçš„åŒºåŸŸå†…å¡«å……</p><div class="code-wrapper"><pre class="language-matlab" data-language="matlab"><code class="language-matlab">t<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">;</span>x<span class="token operator">=</span><span class="token function">sin</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>y<span class="token operator">=</span><span class="token function">cos</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fill</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>axis square off<span class="token punctuation">;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">'STOP'</span><span class="token punctuation">,</span><span class="token string">'Color'</span><span class="token punctuation">,</span><span class="token string">'g'</span><span class="token punctuation">,</span><span class="token string">'FontSize'</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token string">'FontWeight'</span><span class="token punctuation">,</span><span class="token string">'bold'</span><span class="token punctuation">,</span><span class="token operator">'</span>HorizontalAlignm</code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220217105235650.png" alt="image-20220217105235650"></p><h2 id="å‘½ä»¤-v2">å‘½ä»¤</h2><h3 id="Command"><strong>Command</strong></h3><ul><li>whoï¼šæŸ¥çœ‹å˜é‡<ul><li>whosï¼šæŸ¥çœ‹å˜é‡ä»¥åŠByte Type Sizeç­‰ä¿¡æ¯</li></ul></li><li>clear [variable]ï¼šæ¸…æ‰ä¸€ä¸ªVariableï¼Œä¸åŠ åˆ™æ¸…æ¥šæ‰€æœ‰çš„variable</li><li>format [style]ï¼šè®¾ç½®è¾“å‡ºæ ¼å¼<ul><li><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220216203657198.png" alt="image-20220216095819976"></li></ul></li><li>clcï¼šæ¸…å±</li><li>disp()ï¼šæ˜¾ç¤ºå˜é‡çš„å€¼</li><li>prod()ï¼šä¹˜ã€é˜¶ä¹˜</li><li>tic tocï¼šåœ¨éœ€è¦ä¹‹å¤„åŠ ï¼Œè¿”å›ä¸­é—´è¿è¡Œçš„æ—¶é—´</li><li>close allï¼šå…³é—­æ‰€æœ‰figure</li><li>whichï¼ˆï¼‰ï¼šè¿”å›æ–‡ä»¶ä½ç½®</li><li>cat(): Array concatenation</li><li>reshape()</li><li>linspace  logspace()</li><li>randn(1,x)</li></ul><h3 id="Draw-v2">Draw</h3><ul><li>plot(x,y)ï¼šäºŒç»´çº¿å›¾</li></ul><h3 id="å†…ç½®å˜é‡">å†…ç½®å˜é‡</h3><ul><li>inputname å‡½æ•°è¾“å…¥çš„å˜é‡å</li><li>mfilename</li><li>nargin è¾“å…¥å‚æ•°æ•°ç›®</li><li>nargout</li><li>vararginå˜é•¿çš„è¾“å…¥å‚æ•°åˆ—è¡¨</li><li>varargout</li></ul><blockquote><p>å›¾ç‰‡å’Œéƒ¨åˆ†å†…å®¹æ¥è‡ªBç«™<a href="https://www.bilibili.com/video/BV1GJ41137UH?p=4">MATLABæ•™ç¨‹_å°å¤§éƒ­å½¦ç”«ï¼ˆ14è¯¾ï¼‰åŸè§†é¢‘è¡¥æ¡£</a> ä¾µæƒå³åˆ </p></blockquote>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>MATLAB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>unzipä¸arkè§£å‹è¸©å‘</title>
    <link href="/2022/02/15/unzip%E4%B8%8Eark%E8%A7%A3%E5%8E%8B%E7%9A%84%E4%B8%8D%E5%90%8C/"/>
    <url>/2022/02/15/unzip%E4%B8%8Eark%E8%A7%A3%E5%8E%8B%E7%9A%84%E4%B8%8D%E5%90%8C/</url>
    
    <content type="html"><![CDATA[<h1>unzipä¸arkè§£å‹è¸©å‘</h1><blockquote><p>æœ€è¿‘å®‰è£…Linuxç‰ˆæœ¬çš„MATLABæ—¶ï¼Œå¯¹zipå‹ç¼©åŒ…ç›´æ¥é‡‡ç”¨çš„æ˜¯Manjaroå†…ç½®çš„è§£å‹æ–¹å¼Arkï¼Œä½†è§£å‹åå‡ºç°é—®é¢˜ï¼Œæç¤ºfile too short ,ä¸€äº›soæ–‡ä»¶çš„åç§°å‡ºç°é—®é¢˜ï¼Œç»è¿‡æŸ¥è¯åï¼Œæ˜¯ln -s è½¯é“¾æ¥å‡ºç°é—®é¢˜ã€è½¯é“¾æ¥ç›¸å…³è§£é‡Šåœ¨ã€ŠLinuxæ–‡ä»¶ç³»ç»Ÿç†è§£ã€‹æ–‡ç« ä¸­ï¼Œå¯å›é¡¾ä¸€ä¸‹ã€‘ã€‚ä»¥ä¸ºæ˜¯å®˜æ–¹ä¸‹è½½åŒ…ä¸é€‚é…è‡ªå·±å†…æ ¸çš„é—®é¢˜ï¼Œä½†è‡ªå·±ln ä¿®å¤ä¹Ÿä¸è¡Œï¼Œåé€šè¿‡AURä¸­æŸ¥æ‰¾ä¸‹è½½MATLABåˆå¤ªæ…¢äº†ï¼Œæœ€åGoogleä¸€ä¸‹æ‰å‘ç°å¯èƒ½æ˜¯unzipçš„é—®é¢˜ã€‚</p></blockquote><h2 id="åˆæ­¥è¯•éªŒ">åˆæ­¥è¯•éªŒ</h2><p>å…ˆçœ‹ä¸‹unzip -X -Kæ—¶ä¼šåšå“ªäº›äº‹ï¼Ÿ</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220215160643304.png" alt="image-20220215160643304"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220215160741490.png" alt="image-20220215160741490"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220215160826476.png" alt="image-20220215160826476"></p><p>å¯ä»¥çœ‹å‡ºå»ï¼Œunzip inflateä¸€äº›æ–‡ä»¶ï¼Œå¹¶ä¸”è¿›è¡Œäº†ä¸€äº›é“¾æ¥</p><p>è¿™ç‚¹ä¹‹åä¹Ÿå¾—åˆ°äº†éªŒè¯ ls -al</p><p>unzipçš„è§£å‹åæ–‡ä»¶ç»“æœï¼š</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220215161815141.png" alt="image-20220215161815141"></p><p>arkçš„è§£å‹åæ–‡ä»¶ç»“æœï¼š</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220215163432509.png" alt="image-20220215163432509"></p><p>è€Œåœ¨é€šè¿‡manjaroç›´æ¥è§£å‹çš„æ–¹å¼çš„ç›®å½•ä¸‹æ²¡æœ‰è¿™ç§é“¾æ¥ï¼Œéœ€è¦äººå·¥å»é“¾æ¥</p><p>è€ŒManjaroè‡ªå¸¦çš„è§£å‹æ–¹å¼æ˜¯Arkï¼Œä¼¼ä¹ç›´æ¥é€šè¿‡arkè§£å‹zipæ–‡ä»¶ä¸èƒ½ä¿ç•™è§£å‹åçš„é“¾æ¥å¼•ç”¨ä¿¡æ¯ï¼Œå¯¼è‡´æ–‡ä»¶çš„å®‰è£…é—®é¢˜ï¼Œä½†ç”¨unzipå»è§£å‹çš„è¯å°±ä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼Œå¯èƒ½åŸæœ‰çš„zipæ˜¯é€šè¿‡unzipå»zipçš„ï¼Ÿç„¶ååªèƒ½é€šè¿‡unzipå»è§£å‹ï¼Ÿè¿˜æœ‰å¾…è¿›ä¸€æ­¥æ¢ç©¶â€¦</p><h2 id="åç»­å®éªŒ">åç»­å®éªŒ</h2><p>æˆ‘æŠŠè§£å‹å¥½çš„å¸¦æœ‰è½¯é“¾æ¥çš„æ–‡ä»¶å¤¹åˆé€šè¿‡ä¸¤ç§æ–¹å¼å‹ç¼©äº†ä¸€æ¬¡ ï¼Œ å…¶ä¸­zipæ˜¯å¸¦æœ‰ä¿ç•™è½¯é“¾æ¥çš„å‹ç¼©æ–¹å¼çš„ zip -ry â€¦ï¼Œæ‰€ä»¥å†æ¬¡unzipçš„æ—¶å€™è¿˜æ˜¯ä¼šä¿ç•™è½¯é“¾æ¥ï¼ˆå½“ç„¶arkæ–¹å¼è§£å‹è¿˜æ˜¯ä¸ä¼šæœ‰è½¯é“¾æ¥ï¼‰ï¼Œå¯ä»¥æ¨æ–­ä¹‹å‰è¿™ä¸ªzipä¹Ÿæ˜¯é€šè¿‡è¿™ç§å¸¦æœ‰ä¿ç•™è½¯é“¾æ¥çš„å‹ç¼©æ–¹å¼å‹ç¼©çš„ï¼Œè€Œarkæ–¹å¼å‹ç¼©çš„åˆ™æ²¡æœ‰ç‰¹æ€§ï¼ˆæˆ–è€…è¯´æˆ‘è¿˜æ²¡æœ‰æ‰¾åˆ°å¸¦æœ‰ä¿ç•™è½¯é“¾æ¥çš„å‹ç¼©æŒ‡ä»¤ï¼‰</p><h2 id="ç»“è®º">ç»“è®º</h2><p>arkåœ¨è§£å‹ä¸€äº›å¸¦æœ‰è½¯é“¾æ¥çš„å‹ç¼©æ–‡ä»¶æ—¶ï¼Œä¸ä¼šå»ä¸»åŠ¨ä¿ç•™è½¯é“¾æ¥æ¥è§£å‹ï¼Œæ‰€ä»¥å¯èƒ½å‡ºç°é“¾æ¥é—®é¢˜å¯¼è‡´è½¯ä»¶æ— æ³•æ­£å¸¸è¿è¡Œã€‚</p><p>çœ‹äº†è¿™ä¹ˆå¤šä¹‹åè¿˜æ˜¯è¦å°å¿ƒç‚¹ï¼Œå¯¹ä¸€äº›å®‰è£…æ€§è´¨çš„å‹ç¼©æ–‡ä»¶ï¼Œè¿˜æ˜¯çœ‹å®˜æ–¹æ–‡æ¡£å§ï¼Œå®˜æ–¹è¯´å•¥å‘½ä»¤è¿˜æ˜¯å•¥å‘½ä»¤ã€‚<br>ç„¶åarkä¹‹åç¡®å®æ˜¯ä¸å¤ªæ•¢ç”¨äº†ï¼Œè¿˜æ˜¯ç”¨zipå’Œunzipå®‰å¿ƒç‚¹ ğŸ˜†</p>]]></content>
    
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å°†Hexoä»Github Pagesè¿ç§»åˆ°æœåŠ¡å™¨</title>
    <link href="/2022/01/21/%E8%BF%81%E7%A7%BBHexo/"/>
    <url>/2022/01/21/%E8%BF%81%E7%A7%BBHexo/</url>
    
    <content type="html"><![CDATA[<h1>å°†Hexoä»Github Pagesè¿ç§»åˆ°æœåŠ¡å™¨</h1><div class="note note-primary">            <p>æœåŠ¡å™¨ä¸€ç›´ç©ºç€ï¼Œä¹‹å‰Hexoåšå®¢åˆæ­åœ¨Githubä¸Šæœ‰æ—¶å€™ä»æ‰‹æœºä¸Šè®¿é—®å›¾ç‰‡åŠ è½½å¾ˆæ…¢ã€‚ä¸€ç›´æƒ³ç€è¿ç§»åˆ°äº‘æœåŠ¡å™¨ä¸Šï¼Œå¥ˆä½•æ‹–å»¶ç—‡æ™šæœŸï¼Œæ˜¨å¤©ç»ˆäºæ˜¯å¼„å¥½äº†ï¼Œä¸è¿‡è¿˜æ˜¯è¸©äº†ä¸ªç»ˆææ²™å¸å‘</p>          </div><h2 id="æ­¥éª¤">æ­¥éª¤</h2><h3 id="æœåŠ¡å™¨æ–¹é¢">æœåŠ¡å™¨æ–¹é¢</h3><ol><li><p>æŒ‰ç…§å¿…è¦çš„gitå’Œnginx</p></li><li><p>å»ºç«‹hexo éƒ¨ç½²åçš„publicæ–‡ä»¶å¤¹çš„å®é™…ä¿å­˜åœ°å€ (/home/www/hexo)ï¼Œèµ‹äºˆæƒé™</p><div class="code-wrapper"><pre class="language-shell" data-language="shell"><code class="language-shell">chown -R $USER:$USER &#x2F;var&#x2F;www&#x2F;hexochmod -R 755 &#x2F;var&#x2F;www&#x2F;hexo</code></pre></div></li><li><p>ç¼–è¾‘/etc/nginx/nginx.confï¼Œrootæ”¹ä¸ºå®é™…ä¿å­˜åœ°å€</p></li><li><p>åˆ›å»ºblogçš„gitä»“åº“ï¼Œåœ¨ä»“åº“ä¸‹vim /hooks/post-receiveæ·»åŠ ä»¥ä¸Š</p><div class="code-wrapper"><pre class="language-shell" data-language="shell"><code class="language-shell">#!&#x2F;bin&#x2F;bashgit --work-tree&#x3D;&#x2F;var&#x2F;www&#x2F;hexo --git-dir&#x3D;&#x2F;var&#x2F;repo&#x2F;ganahBlog.git checkout -f</code></pre></div><p>æ„Ÿè§‰æ˜¯å»ºç«‹æ˜ å°„å…³ç³»ï¼Ÿ</p><div class="note note-primary">            <p>2022 / 4 /10 å›é¡¾ ï¼šå…¶å®è¿™é‡Œæ˜¯å¹²æ¹¿åˆ†ç¦»ï¼ŒåŒºåˆ†gitå·¥ä½œç›®å½•å’Œä»“åº“æºç ç›®å½•ï¼Œæºç ä¸Šä¼ åˆ°gitå¹¶ä¸æ˜¯ç›´æ¥ä¼ çš„æºç éƒ¨åˆ†ï¼Œè€Œæ˜¯ç®¡ç†åœ¨.gitæ–‡ä»¶ä¸‹ï¼Œgit cloneå»é€šçŸ¥.gitæ–‡ä»¶è¿”å›æŒ‡å®šåˆ†æ”¯çš„æºç </p>          </div><p>èµ‹äºˆæƒé™</p><div class="code-wrapper"><pre class="language-shell" data-language="shell"><code class="language-shell">chmod +x &#x2F;var&#x2F;repo&#x2F;ganahBlog.git&#x2F;hooks&#x2F;post-receive</code></pre></div></li><li><p>é…ç½®åŸŸåï¼Œåœ¨nginxé…ç½®æ–‡ä»¶ä¸­server_nameä¿®æ”¹ä¸€ä¸‹å³å¯</p></li></ol><h3 id="ä¸»æœºæ–¹é¢">ä¸»æœºæ–¹é¢</h3><ol><li>åœ¨hexoçš„å…¨ç«™é…ç½®æ–‡ä»¶ä¸‹ï¼Œä¿®æ”¹deployï¼Œrepoæ”¹æˆï¼šroot@{ipaddress}:{repoaddreess.git}å³å¯</li><li>å»ºç«‹ä¸»æœºå’ŒæœåŠ¡å™¨çš„å…å¯†ç™»å½•ï¼Œä¸»æœºssh-keygen -t rsaï¼Œå†ssh-copy-id root@ipaddr å³å¯ï¼Œè¿™é‡Œè·Ÿå…¬é’¥ç§é’¥æŒ‚é’©äº†å“ˆ</li></ol><h2 id="å·¨å‘">å·¨å‘</h2><p>æ¥äº†æ¥äº†</p><h3 id="1-gitç”¨æˆ·ç®¡ç†">1. gitç”¨æˆ·ç®¡ç†</h3><p>è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯æ–°å»ºgitç”¨æˆ·ï¼Œèµ‹äºˆgitç”¨æˆ·æƒé™ï¼Œç„¶ååœ¨gitç”¨æˆ·ç®¡ç†ä¸‹å»æ“ä½œï¼Œä½†æ˜¯è¿™é‡Œæˆ‘å®é™…deployåhexoçš„å®é™…å‘å¸ƒç›®å½•é‡Œæ²¡æœ‰æ–‡ä»¶ï¼Œæˆ‘æ€€ç–‘æ˜¯æƒé™èµ‹äºˆçš„é—®é¢˜ï¼Œæ¯”å¦‚æ–°å»ºgitç”¨æˆ·æ—¶æƒé™æ²¡ç»™åˆ°ä½ï¼Œç„¶åhexoæ–‡ä»¶çš„æ–‡ä»¶å¯¹gitç”¨æˆ·çš„è¯»å†™çš„æƒé™èµ‹äºˆ</p><h3 id="2-hexoæ–‡ä»¶é…ç½®ä¸æ”¯æŒ">2. hexoæ–‡ä»¶é…ç½®ä¸æ”¯æŒ</h3><p>è¿™é‡Œå·¨å‘ã€‚æˆ‘æœ€å¼€å§‹hexoåœ¨fluidä¸»é¢˜ä¸‹çš„é…ç½®ï¼Œæœ‰ä¸€ä¸ªé€‰é¡¹æ˜¯force-httpsï¼Œå¼ºåˆ¶å‡çº§httpsé“¾æ¥ï¼Œæœ¬æ„æ˜¯å¼ºåˆ¶æ‰€æœ‰é“¾æ¥å‡çº§ä¸º HTTPSï¼ˆé€‚ç”¨äºå›¾ç‰‡ç­‰èµ„æºå‡ºç° HTTP æ··å…¥æŠ¥é”™ï¼‰ï¼Œæˆ‘ä»¥ä¸ºæ²¡äº‹æˆ‘å°±æ‰“å¼€äº†ã€‚</p><p>åå¤´è¿™é‡Œå‘å¸ƒåï¼Œåœ¨æœ¬åœ°èƒ½å¤ŸæˆåŠŸé¢„è§ˆï¼Œä½†deployåˆ°æœåŠ¡å™¨ä¸Šï¼ŒæœåŠ¡å™¨æœ¬èº«æ²¡æœ‰é”™ï¼Œä½†è®¿é—®cssç­‰èµ„æºæŠ¥é”™ï¼Œä½†æˆ‘é€šè¿‡æµè§ˆå™¨è¾“å…¥è·¯å¾„è®¿é—®æœ‰æ—¶å€™èƒ½å¤ŸæˆåŠŸæœ‰æ—¶å€™ä¸èƒ½è®¿é—®æˆåŠŸï¼Œåå¤´æ‰å‘ç°æ˜¯httpå’Œhttpsçš„é—®é¢˜ï¼Œhttpsçš„æ—¶å€™å°±ä¸èƒ½è®¿é—®ï¼Œhttpå°±èƒ½è®¿é—®ï¼Œè¿™ä¹Ÿæ˜¯è¿™é‡Œçš„é—®é¢˜ã€‚åå¤´æŠŠè¿™ä¸ªé€‰é¡¹æ”¹æˆfalseç¬é—´å°±å¥½äº†ã€‚ã€‚ã€‚ã€‚æ‰¾äº†åŠå¤©ï¼Œç¦»å¤§è°±ã€‚<img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/2022-01-20_21-10.png" alt=""></p><div class="note note-success">            <p>æœ€åå†æ ‡è®°ä¸€ä¸‹åšå®¢çš„å†…ã€å¤–å›½è®¿é—®åœ°å€</p><p>Github Pagesï¼š<a href="https://pplong.top">https://pplong.top</a><br>Cloud Tencent(Shanghai)ï¼š<a href="http://www.pplong.top">http://www.pplong.top</a></p>          </div>]]></content>
    
    
    
    <tags>
      
      <tag>Hexo</tag>
      
      <tag>ErrorResolve</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ•°æ®åº“ç³»ç»Ÿæ¦‚æ€»ç»“</title>
    <link href="/2022/01/04/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E6%A6%82%E6%80%BB%E7%BB%93/"/>
    <url>/2022/01/04/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E6%A6%82%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<h1>æ•°æ®åº“ç³»ç»Ÿæ¦‚æ€»ç»“</h1><h2 id="ç»ªè®º">ç»ªè®º</h2><p>æ•°æ®åº“æŠ€æœ¯çš„å››ä¸ªåŸºæœ¬æ¦‚å¿µï¼š æ•°æ®ã€æ•°æ®åº“ã€æ•°æ®åº“ç®¡ç†ç³»ç»Ÿå’Œæ•°æ®åº“ç³»ç»Ÿ</p><p><strong>æ•°æ®</strong>(data)ï¼šæ•°æ®åº“ä¸­å­˜å‚¨çš„åŸºæœ¬å¯¹è±¡ã€‚å®šä¹‰ï¼šæè¿°äº‹åŠ¡çš„ç¬¦å·è®°å½•ï¼Œå¯ä»¥æ˜¯æ•°å­—ä¹Ÿå¯ä»¥æ˜¯æ–‡å­—ã€å›¾å½¢ã€å›¾åƒâ€¦éƒ½å¯ä»¥ç»è¿‡æ•°å­—åŒ–å­˜å‚¨åå­˜å…¥è®¡ç®—æœºã€‚</p><p><strong>æ•°æ®åº“</strong>(DataBase)ï¼šé•¿æœŸå­˜å‚¨åœ¨è®¡ç®—æœºå†…ã€æœ‰ç»„ç»‡çš„ã€å¯å…±äº«çš„å¤§é‡æ•°æ®çš„é›†åˆã€‚æ•°æ®åº“ä¸­çš„æ•°æ®æŒ‰ç…§ä¸€å®šçš„æ•°æ®æ¨¡å‹ç»„ç»‡ã€æè¿°å’Œå­˜å‚¨ï¼Œå…·æœ‰è¾ƒå°çš„å†—ä½™åº¦ã€è¾ƒé«˜çš„æ•°æ®ç‹¬ç«‹æ€§å’Œæ˜“æ‰©å±•æ€§ï¼Œå¯ä¸ºå„ç§ç”¨æˆ·å…±äº«ã€‚<br>ä¸‰ä¸ªç‰¹ç‚¹ï¼š<strong>æ°¸ä¹…å­˜å‚¨ã€æœ‰ç»„ç»‡ã€å¯å…±äº«</strong></p><p><strong>æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ</strong>(DataBase Management System ,DBMS)ï¼šä½äºç”¨æˆ·ä¸æ“ä½œç³»ç»Ÿä¹‹é—´çš„ä¸€å±‚æ•°æ®ç®¡ç†è½¯ä»¶ï¼Œå±äºè®¡ç®—æœºçš„åŸºç¡€è½¯ä»¶ã€‚<br>ä¸»è¦åŠŸèƒ½ï¼š</p><ol><li>æ•°æ®å®šä¹‰ ï¼ˆæä¾›æ•°æ®å®šä¹‰è¯­è¨€DDL[Data Definition Language]ï¼‰</li><li>æ•°æ®ç»„ç»‡ã€å­˜å‚¨å’Œç®¡ç†</li><li>æ•°æ®æ“çºµ ï¼ˆæä¾›æ•°æ®æ“çºµè¯­è¨€ DML[Data Manipulation Language]ï¼‰</li><li>æ•°æ®åº“çš„äº‹åŠ¡ç®¡ç†å’Œè¿è¡Œç®¡ç†</li><li>æ•°æ®åº“çš„å»ºç«‹å’Œç»´æŠ¤åŠŸèƒ½</li><li>å…¶ä»–åŠŸèƒ½</li></ol><p><strong>æ•°æ®åº“ç³»ç»Ÿ</strong>(DataBase System, DBS)ï¼šç”±æ•°æ®åº“ã€æ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€åº”ç”¨ç¨‹åºå’Œæ•°æ®åº“ç®¡ç†å‘˜(DBA) ç»„æˆçš„å­˜å‚¨ã€ç®¡ç†ã€å¤„ç†å’Œç»´æŠ¤æ•°æ®çš„ç³»ç»Ÿ</p><h3 id="æ•°æ®åº“ç®¡ç†æŠ€æœ¯çš„å‘å±•">æ•°æ®åº“ç®¡ç†æŠ€æœ¯çš„å‘å±•</h3><p><strong>1. äººå·¥ç®¡ç†é˜¶æ®µ</strong></p><p>æ•°æ®å¤„ç†æ–¹å¼ï¼šæ‰¹å¤„ç†</p><p>ç¼ºç‚¹ï¼šæ•°æ®ä¸ä¿å­˜ã€åº”ç”¨ç¨‹åºç®¡ç†æ•°æ®ã€æ•°æ®ä¸å…±äº«ã€æ•°æ®ä¸å…·æœ‰ç‹¬ç«‹æ€§</p><p><strong>2. æ–‡ä»¶ç³»ç»Ÿé˜¶æ®µ</strong></p><p>ç‰¹ç‚¹ï¼šæ•°æ®å¯é•¿æœŸä¿å­˜ã€ç”±æ–‡ä»¶ç³»ç»Ÿç®¡ç†æ•°æ®<br>ä¼˜ç‚¹ï¼šæ•°æ®å…±äº«æ€§å·®ã€å†—ä½™åº¦å¤§ã€æ•°æ®ç‹¬ç«‹æ€§å·®</p><p><strong>3. æ•°æ®åº“ç³»ç»Ÿé˜¶æ®µ</strong></p><p>ç‰¹ç‚¹ï¼š</p><ol><li><p>æ•°æ®ç»“æ„åŒ–ï¼ˆä¸æ–‡ä»¶ç³»ç»Ÿçš„<strong>æœ¬è´¨åŒºåˆ«</strong>ï¼‰</p></li><li><p>æ•°æ®çš„å…±äº«æ€§é«˜ã€å†—ä½™åº¦ä½ä¸”æ˜“æ‰©å……</p></li><li><p>æ•°æ®ç‹¬ç«‹æ€§é«˜</p><ol><li>ç‰©ç†ç‹¬ç«‹æ€§ï¼šç”¨æˆ·çš„åº”ç”¨ç¨‹åºä¸æ•°æ®åº“ä¸­æ•°æ®çš„ç‰©ç†å­˜å‚¨æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼ˆç”¨æˆ·ç¨‹åºæ— éœ€äº†è§£ï¼‰</li><li>é€»è¾‘ç‹¬ç«‹æ€§ï¼šç”¨æˆ·çš„åº”ç”¨ç¨‹åºä¸æ•°æ®åº“çš„é€»è¾‘ç»“æ„æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼ˆæ•°æ®çš„é€»è¾‘ç»“æ„æ”¹å˜æ—¶ç”¨æˆ·ç¨‹åºå¯ä»¥ä¸å˜ï¼‰</li></ol></li><li><p>æ•°æ®ç”±æ•°æ®åº“ç®¡ç†ç³»ç»Ÿç»Ÿä¸€ç®¡ç†å’Œæ§åˆ¶</p><p>æ•°æ®åº“ç®¡ç†ç³»ç»Ÿéœ€è¦æä¾›ä»¥ä¸‹å‡ ä¸ªæ–¹é¢çš„æ•°æ®æ§åˆ¶åŠŸèƒ½ï¼š</p><ul><li>æ•°æ®å®‰å…¨æ€§ä¿æŠ¤ï¼šä¿æŠ¤æ•°æ®é˜²æ­¢ä¸åˆæ³•ä½¿ç”¨é€ æˆçš„æ•°æ®æ³„å¯†å’Œç ´å</li><li>æ•°æ®å®Œæ•´æ€§æ£€æŸ¥ï¼šæ•°æ®çš„æ­£ç¡®æ€§ã€æœ‰æ•ˆæ€§ã€ç›¸å®¹æ€§</li><li>å¹¶å‘æ§åˆ¶</li><li>æ•°æ®åº“æ¢å¤</li></ul></li></ol><p>æ•°æ®åº“æ˜¯é•¿æœŸå­˜å‚¨åœ¨è®¡ç®—æœºå†…æœ‰ç»„ç»‡ã€å¤§é‡ã€å…±äº«çš„æ•°æ®é›†åˆï¼Œå¯ä»¥ä¾›å„ç§ç”¨æˆ·å…±äº«ï¼Œæœ‰æœ€å°å†—ä½™åº¦å’Œè¾ƒé«˜çš„æ•°æ®ç‹¬ç«‹æ€§ã€‚DBMSåœ¨æ•°æ®åº“å»ºç«‹ã€è¿è¡Œå’Œç»´æŠ¤æ—¶å¯¹æ•°æ®åº“è¿›è¡ŒåŒæ„æ§åˆ¶ä¿è¯æ•°æ®çš„å®Œæ•´æ€§å’Œå®‰å…¨æ€§ï¼Œå¹¶åœ¨å¤šç”¨æˆ·åŒæ—¶ä½¿ç”¨æ—¶è¿›è¡Œå¹¶å‘æ§åˆ¶ï¼Œåœ¨å‘ç”Ÿæ•…éšœåå¯¹æ•°æ®åº“è¿›è¡Œæ¢å¤</p><p>DBSçš„å‡ºç°è®©ä¿¡æ¯ç³»ç»Ÿä»ä»¥åŠ å·¥æ•°æ®çš„ç¨‹åºä¸ºä¸­å¿ƒè½¬å‘å›´ç»•å…±äº«çš„æ•°æ®åº“ä¸ºä¸­å¿ƒçš„æ–°é˜¶æ®µ</p><h3 id="æ•°æ®æ¨¡å‹">æ•°æ®æ¨¡å‹</h3><p>æ•°æ®æ¨¡å‹ï¼šå¯¹ç°å®ä¸–ç•Œæ•°æ®ç‰¹å¾çš„æŠ½è±¡ã€‚æ˜¯æ•°æ®åº“ç³»ç»Ÿçš„æ ¸å¿ƒå’ŒåŸºç¡€</p><h4 id="ä¸¤ç±»æ•°æ®æ¨¡å‹">ä¸¤ç±»æ•°æ®æ¨¡å‹</h4><p>æ•°æ®æ¨¡å‹åº”æ»¡è¶³çš„ä¸‰æ–¹é¢è¦æ±‚ï¼š</p><ol><li>è¾ƒä¸ºçœŸå®åœ°æ¨¡æ‹Ÿæ˜¾ç¤ºä¸–ç•Œ</li><li>å®¹æ˜“è¢«äººç†è§£</li><li>ä¾¿äºåœ¨è®¡ç®—æœºä¸Šå®ç°</li></ol><p><strong>1. æ¦‚å¿µæ¨¡å‹</strong></p><p>ä¹Ÿæ˜¯ä¿¡æ¯æ¨¡å‹ï¼ŒæŒ‰ç”¨æˆ·çš„è§‚ç‚¹æ¥å¯¹æ•°æ®å’Œä¿¡æ¯å»ºæ¨¡ï¼Œä¸»è¦ç”¨äºæ•°æ®åº“è®¾è®¡</p><p>ä¿¡æ¯ä¸–ç•Œçš„èŠ‚æœ¬æ¦‚å¿µï¼š</p><ol><li>å®ä½“ï¼šå®¢è§‚å­˜åœ¨å¹¶ä¸”å¯ç›¸äº’åŒºåˆ«çš„äº‹ç‰©</li><li>å±æ€§</li><li>ç </li><li>å®ä½“å‹</li><li>å®ä½“é›†</li><li>è”ç³»</li></ol><p>æ¦‚å¿µæ¨¡å‹çš„è¡¨ç¤ºæ–¹æ³•ï¼š å®ä½“è”ç³»æ–¹æ³•(E-Ræ–¹æ³•)</p><p><strong>2. é€»è¾‘æ¨¡å‹å’Œç‰©ç†æ¨¡å‹</strong></p><p>æŒ‰è®¡ç®—æœºç³»ç»Ÿçš„è§‚ç‚¹å¯¹æ•°æ®å»ºæ¨¡ï¼Œä¸»è¦ç”¨äºæ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„å®ç°<br>å…¶ä¸­ç‰©ç†æ¨¡å‹æ˜¯å¯¹æ•°æ®çš„æœ€åº•å±‚æŠ½è±¡ï¼Œæè¿°æ•°æ®åœ¨ç³»ç»Ÿå†…éƒ¨çš„è¡¨ç¤ºæ–¹å¼å’Œå­˜å–æ–¹æ³•ï¼Œç«ç¾ç£ç›˜æˆ–è€…ç£å¸¦ä¸Šçš„å­˜å‚¨æ–¹å¼å’Œå­˜å–æ–¹å¼ï¼Œé¢å‘è®¡ç®—æœºç³»ç»Ÿ</p><p>æ•°æ®æ¨¡å‹æ˜¯æ•°æ®åº“ç³»ç»Ÿçš„æ ¸å¿ƒå’ŒåŸºç¡€</p><h4 id="æ•°æ®æ¨¡å‹çš„ç»„æˆè¦ç´ ">æ•°æ®æ¨¡å‹çš„ç»„æˆè¦ç´ </h4><p>æ•°æ®æ¨¡å‹ç”±ä»¥ä¸‹ä¸‰éƒ¨åˆ†ç»„æˆ</p><ol><li>æ•°æ®ç»“æ„ï¼šæè¿°æ•°æ®åº“çš„ç»„æˆå¯¹è±¡ä»¥åŠå¯¹è±¡ä¹‹é—´çš„è”ç³»</li><li>æ•°æ®å¯¹è±¡ï¼šå¯¹æ•°æ®åº“ä¸­å„ç§å¯¹è±¡çš„ç¤ºä¾‹å…è®¸æ‰§è¡Œçš„æ“ä½œçš„é›†åˆï¼ŒåŒ…æ‹¬æ“ä½œåŠæœ‰å…³çš„æ“ä½œè§„åˆ™</li><li>æ•°æ®çš„å®Œæ•´æ€§çº¦æŸæ¡ä»¶ï¼šä¸€ç»„å®Œæ•´æ€§è§„åˆ™</li></ol><h4 id="å¸¸ç”¨çš„æ•°æ®æ¨¡å‹">å¸¸ç”¨çš„æ•°æ®æ¨¡å‹</h4><ul><li>å±‚æ¬¡æ¨¡å‹<ul><li>æœ€æ—©å‡ºç°</li><li>æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š<ul><li>æœ‰ä¸”åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹æ²¡æœ‰åŒäº²èŠ‚ç‚¹ï¼Œä¸ºæ ¹èŠ‚ç‚¹</li><li>æ ¹ä»¥å¤–çš„å…¶ä»–çš„èŠ‚ç‚¹æœ‰ä¸”åªæœ‰ä¸€ä¸ªåŒäº²èŠ‚ç‚¹</li></ul></li><li>ä¼˜ç‚¹ï¼š<ol><li>æ•°æ®ç»“æ„ç®€å•æ¸…æ™°</li><li>æŸ¥è¯¢æ•ˆç‡é«˜ï¼ˆè®°å½•ä¹‹é—´çš„è”ç³»ç”¨æœ‰å‘è¾¹è¡¨ç¤º ----- æŒ‡é’ˆï¼‰</li><li>æä¾›äº†è‰¯å¥½çš„å®Œæ•´æ€§æ”¯æŒ</li></ol></li><li>ç¼ºç‚¹ï¼š<ol><li>ç°å®ä¸–ç•Œä¸­è®¸å¤šè”ç³»è´¹å±‚æ¬¡ï¼Œä¸é€‚ç”¨å±‚æ¬¡æ¨¡å‹è¡¨ç¤º</li><li>å¦‚æœä¸€ä¸ªèŠ‚ç‚¹å…·æœ‰å¤šä¸ªåŒäº²èŠ‚ç‚¹ï¼Œç”¨å±‚æ¬¡æ¨¡å‹è¡¨ç¤ºåˆ™ååˆ†ç¬¨æ‹™ï¼Œå¼•å…¥å†—ä½™æ•°æ®</li><li>æŸ¥è¯¢å­å¥³èŠ‚ç‚¹å¿…é¡»é€šè¿‡åŒäº²èŠ‚ç‚¹</li><li>ç»“æ„ä¸¥å¯†ï¼Œå±‚æ¬¡å‘½ä»¤è¶‹äºç¨‹åºåŒ–</li></ol></li></ul></li><li>ç½‘çŠ¶æ¨¡å‹<ul><li>è¡¨ç¤ºéæ ‘çŠ¶ç»“æ„çš„ç°å®æ¨¡å‹</li><li>æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š<ul><li>å…è®¸ä¸€ä¸ªä»¥ä¸Šçš„èŠ‚ç‚¹æ— åŒäº²</li><li>ä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥æœ‰å¤šäºä¸€ä¸ªçš„åŒäº²</li></ul></li><li>ç½‘çŠ¶æ¨¡å‹ä¸­å­å¥³èŠ‚ç‚¹ä¸åŒäº²èŠ‚ç‚¹çš„è”ç³»ä¸å”¯ä¸€</li><li>ä¼˜ç‚¹ï¼š<ol><li>ç›´æ¥æè¿°æ˜¾ç¤ºä¸–ç•Œ</li><li>å…·æœ‰è‰¯å¥½çš„æ€§èƒ½ï¼Œå­˜å–æ•ˆç‡é«˜</li></ol></li><li>ç¼ºç‚¹ï¼š<ol><li>ç»“æ„å¤æ‚ï¼Œéšç€ç¯å¢ƒæ‰©å¤§ï¼Œæ•°æ®åº“çš„ç»“æ„å˜å¾—è¶Šæ¥è¶Šå¤æ‚</li><li>ç½‘çŠ¶æ¨¡å‹çš„DDLã€DMLå¤æ‚ï¼Œè¦åµŒå…¥ä¸€ç§é«˜çº§è¯­è¨€ï¼Œç”¨æˆ·ä¸å®¹æ˜“æŒæ¡</li><li>ç”¨æˆ·å¿…é¡»äº†è§£ç³»ç»Ÿç»“æ„çš„ç»†èŠ‚ï¼Œè®°å½•ä¹‹é—´çš„è”ç³»é€šè¿‡å­˜å–è·¯å¾„å®ç°ï¼Œåº”ç”¨ç¨‹åºåœ¨è®¿é—®æ•°æ®æ—¶å¿…é¡»é€‰æ‹©é€‚å½“çš„å­˜å–è·¯å¾„</li></ol></li></ul></li><li>å…³ç³»æ¨¡å‹<ul><li><strong>æœ€é‡è¦</strong>çš„ä¸€ç§æ•°æ®æ¨¡å‹</li><li>è¦æ±‚å…³ç³»å¿…é¡»æ˜¯è§„èŒƒåŒ–çš„ï¼Œå…³ç³»çš„æ¯ä¸€ä¸ªåˆ†é‡å¿…é¡»æ˜¯ä¸€ä¸ªä¸å¯åˆ†çš„æ•°æ®é¡¹</li><li>å…³ç³»æ¨¡å‹ä¸­çš„æ•°æ®æ“ä½œæ˜¯é›†åˆæ“ä½œï¼Œæ“ä½œå¯¹è±¡å’Œæ“ä½œç»“æœéƒ½æ˜¯å…³ç³»</li><li>ä¼˜ç‚¹ï¼š<ol><li>å»ºç«‹åœ¨ä¸¥æ ¼çš„æ•°å­¦æ¦‚å¿µçš„åŸºç¡€ä¸Š</li><li>æ¦‚å¿µå•ä¸€ã€æ•°æ®ç»“æ„ç®€å•æ¸…æ™°ï¼Œæ— è®ºæ˜¯å®ä½“è¿˜æ˜¯å®ä½“ä¹‹é—´çš„è”ç³»éƒ½ç”¨å…³ç³»æ¥è¡¨ç¤ºï¼Œå¯¹æ•°æ®çš„æ£€ç´¢å’Œæ›´æ–°ç»“æœä¹Ÿæ˜¯å…³ç³»</li><li>å­˜å–è·¯å¾„å¯¹ç”¨æˆ·é€æ˜ï¼Œæœ‰æ›´é«˜çš„æ•°æ®ç‹¬ç«‹æ€§ï¼Œæ›´å¥½çš„å®‰å…¨ä¿å¯†æ€§</li></ol></li></ul></li><li>é¢å‘å¯¹è±¡æ•°æ®æ¨¡å‹</li><li>å¯¹è±¡å…³ç³»æ•°æ®æ¨¡å‹</li><li>åŠç»“æ„åŒ–æ•°æ®æ¨¡å‹</li></ul><h3 id="æ•°æ®åº“ç³»ç»Ÿçš„ç»“æ„">æ•°æ®åº“ç³»ç»Ÿçš„ç»“æ„</h3><p>æ¨¡å¼ï¼šæ•°æ®åº“ä¸­å…¨ä½“æ•°æ®çš„é€»è¾‘ç»“æ„å’Œç‰¹å¾çš„æè¿°ï¼Œä»…ä»…è®¾è®¡ å‹ï¼ˆå¯¹ä¸€ç±»æ•°æ®ç»“æ„å’Œå±æ€§çš„è¯´æ˜ï¼‰çš„æè¿°ï¼Œä¸æ¶‰åŠå…·ä½“çš„å€¼ã€‚æ¨¡å¼çš„ä¸€ä¸ªå…·ä½“å€¼æˆä¸ºæ¨¡å¼çš„ä¸€ä¸ªå®ä¾‹ï¼ŒåŒä¸€ä¸ªæ¨¡å¼å¯ä»¥æœ‰å¤šä¸ªå®ä¾‹ã€‚æ¨¡å¼çš„ç›¸å¯¹ç¨³å®šçš„ï¼Œå®ä¾‹æ˜¯ç›¸å¯¹å˜åŠ¨çš„ã€‚æ¨¡å¼ååº”çš„æ˜¯æ•°æ®çš„ç»“æ„åŠå…¶è”ç³»ï¼Œå®ä¾‹ååº”çš„æ˜¯æ•°æ®åº“æŸä¸€æ—¶åˆ»çš„çŠ¶æ€</p><h4 id="æ•°æ®åº“ç³»ç»Ÿçš„ä¸‰çº§æ¨¡å¼ç»“æ„">æ•°æ®åº“ç³»ç»Ÿçš„ä¸‰çº§æ¨¡å¼ç»“æ„</h4><ol><li><p>æ¨¡å¼ï¼ˆschemaï¼‰ï¼š</p><p>ä¹Ÿç§°ä¸ºé€»è¾‘æ¨¡å¼ï¼Œæ˜¯æ•°æ®åº“ä¸­å…¨ä½“æ•°æ®çš„é€»è¾‘ç»“æ„å’Œç‰¹å¾çš„æè¿°ï¼Œæ˜¯æ‰€æœ‰ç”¨æˆ·çš„å…¬å…±æ•°æ®è§†å›¾ã€‚æ˜¯æ•°æ®åº“ç³»ç»Ÿæ¨¡å¼ç»“æ„çš„ä¸­é—´å±‚ã€‚<br>æ¨¡å¼å®é™…ä¸Šæ˜¯æ•°æ®åº“æ•°æ®åœ¨é€»è¾‘çº§ä¸Šçš„è§†å›¾ï¼Œä¸€ä¸ªæ•°æ®åº“åªæœ‰ä¸€ä¸ªæ¨¡å¼ã€‚<br>DBMSæä¾›æ¨¡å¼DDLæ¥ä¸¥æ ¼å®šä¹‰æ¨¡å¼</p></li><li><p>å¤–æ¨¡å¼ï¼ˆexternal schemaï¼‰ï¼š</p><p>ä¹Ÿå«å­æ¨¡å¼ã€ç”¨æˆ·æ¨¡å¼ï¼Œæ˜¯æ•°æ®åº“ç”¨æˆ·èƒ½å¤Ÿçœ‹è§å’Œä½¿ç”¨çš„å±€éƒ¨æ•°æ®çš„é€»è¾‘ç»“æ„å’Œç‰¹å¾çš„æè¿°ï¼Œæ˜¯æ•°æ®åº“ç”¨æˆ·çš„æ•°æ®è§†å›¾ï¼Œæ˜¯ä¸æŸä¸€åº”ç”¨æœ‰å…³çš„æ•°æ®çš„é€»è¾‘è¡¨ç¤º</p><p>æ˜¯æ¨¡å¼çš„å­é›†ï¼Œä¸€ä¸ªæ•°æ®åº“å¯æœ‰å¤šä¸ªå¤–æ¨¡å¼ï¼Œæ˜¯å„ä¸ªç”¨æˆ·çš„æ•°æ®è§†å›¾ã€‚</p></li><li><p>å†…æ¨¡å¼ï¼ˆinternal schemaï¼‰ï¼š</p><p>å­˜å‚¨æ¨¡å¼ï¼Œä¸€ä¸ªæ•°æ®åº“åªæœ‰ä¸€ä¸ªå†…æ¨¡å¼ï¼Œæ˜¯æ•°æ®ç‰©ç†ç»“æ„å’Œå­˜å‚¨æ–¹å¼çš„æè¿°ï¼Œæ˜¯æ•°æ®åœ¨æ•°æ®åº“å†…éƒ¨çš„ç»„ç»‡æ–¹å¼</p></li></ol><p>DBMSåœ¨ä¸‰çº§æ¨¡å¼ä¹‹é—´æä¾›ä¸¤å±‚æ˜ åƒï¼š</p><ol><li><p>å¤–æ¨¡å¼/æ¨¡å¼æ˜ åƒ</p><p>å¯¹æ¯ä¸€ä¸ªå¤–æ¨¡å¼ï¼ŒDBSéƒ½æœ‰ä¸€ä¸ªå¤–æ¨¡å¼/æ¨¡å¼æ˜ åƒï¼Œå®šä¹‰äº†æ”¹å¤–æ¨¡å¼ä¸æ¨¡å¼ä¹‹é—´çš„å¯¹åº”å…³ç³»</p><p>æ¨¡å¼æ”¹å˜æ—¶ï¼Œç”±æ•°æ®åº“ç®¡ç†å‘˜å¯¹å„ä¸ªå¤–æ¨¡å¼/æ¨¡å¼çš„æ˜ åƒåšå‡ºæ”¹å˜ï¼Œå¯ä»¥ä½¿å¾—å¤–æ¨¡å¼ä¿æŒä¸å˜ã€‚åº”ç”¨ç¨‹åºæ˜¯ä¾æ®æ•°æ®çš„å¤–æ¨¡å¼ç¼–å†™çš„ï¼Œä»è€Œåº”ç”¨ç¨‹åºä¸å¿…ä¿®æ”¹ï¼Œä¿è¯äº†æ•°æ®ä¸ç¨‹åºçš„é€»è¾‘ç‹¬ç«‹æ€§ï¼Œå³æ•°æ®çš„é€»è¾‘ç‹¬ç«‹æ€§ã€‚</p></li><li><p>æ¨¡å¼/å†…æ¨¡å¼æ˜ åƒ</p><p>å”¯ä¸€çš„ï¼Œå®šä¹‰äº†æ•°æ®å…¨å±€é€»è¾‘ç»“æ„ä¸å­˜å‚¨ç»“æ„ä¹‹é—´çš„å¯¹åº”å…³ç³»ã€‚å½“æ•°æ®åº“çš„å­˜å‚¨ç»“æ„æ”¹å˜æ—¶ï¼Œç”±æ•°æ®åº“ç®¡ç†å‘˜å¯¹æ¨¡å¼/å†…æ¨¡å¼åšå‡ºç›¸åº”æ”¹å˜ï¼Œå¯ä»¥ä½¿å¾—æ¨¡å¼ä¸å˜ï¼Œä»è€Œåº”ç”¨ç¨‹åºä¹Ÿä¸ç”¨æ”¹å˜ï¼Œä¿è¯äº†æ•°æ®çš„ç‰©ç†ç‹¬ç«‹æ€§</p></li></ol><h3 id="æ•°æ®åº“ç³»ç»Ÿçš„ç»„æˆ">æ•°æ®åº“ç³»ç»Ÿçš„ç»„æˆ</h3><ul><li>ç¡¬ä»¶å¹³å°åŠæ•°æ®åº“</li><li>è½¯ä»¶</li><li>äººå‘˜<ul><li>æ³¨æ„ä¸€ç‚¹ã€‚ç”¨æˆ·åˆ†æˆä¸‰ç±»ï¼šå¶ç„¶ç”¨æˆ·ï¼ˆä¸­é«˜çº§ç®¡ç†äººå‘˜ï¼‰ã€ç®€å•ç”¨æˆ·ï¼ˆæ™®é€šç”¨æˆ·ï¼‰ã€å¤æ‚ç”¨æˆ·ï¼ˆå…·æœ‰é«˜ç§‘å­¦æŠ€æœ¯èƒŒæ™¯çš„äººå‘˜ï¼‰</li></ul></li></ul><h2 id="å…³ç³»æ•°æ®åº“">å…³ç³»æ•°æ®åº“</h2><h3 id="å…³ç³»">å…³ç³»</h3><ul><li><p>åŸŸï¼šä¸€ç»„å…·æœ‰ç›¸åŒæ•°æ®ç±»å‹çš„å€¼çš„é›†åˆ</p></li><li><p>ç¬›å¡å°”ç§¯</p></li><li><p>å…³ç³»ï¼š</p><p>å€™é€‰ç ï¼šå…³ç³»ä¸­çš„æŸä¸€å±æ€§ç»„çš„å€¼èƒ½å”¯ä¸€æ ‡è¯†ä¸€ä¸ªå…ƒç¥–ï¼Œè€Œå…¶è‡ªå·±ä¸èƒ½ï¼Œåˆ™ç§°è¯¥å±æ€§ç»„ä¸ºå€™é€‰ç ã€‚è‹¥ä¸€ä¸ªå…³ç³»æœ‰å¤šä¸ªå€™é€‰ç ï¼Œåˆ™é€‰å®šå…¶ä¸­çš„ä¸€ä¸ªä¸ºä¸»ç ã€‚å€™é€‰ç çš„è¯¸å±æ€§ç§°ä¸ºä¸»å±æ€§ï¼Œä¸åŒ…å«åœ¨ä»»ä½•å€™é€‰ç ä¸­çš„å±æ€§ç§°ä¸ºéä¸»å±æ€§æˆ–è€…éç å±æ€§ã€‚<br>å…¨ç ï¼šå€™é€‰ç åªåŒ…å«ä¸€ä¸ªå±æ€§ï¼Œå…³ç³»æ¨¡å¼çš„æ‰€æœ‰å±æ€§æ˜¯è¿™ä¸ªå…³ç³»æ¨¡å¼çš„å€™é€‰ç </p><p>å…³ç³»çš„ä¸‰ç§ç±»å‹ï¼š</p><ul><li>åŸºæœ¬å…³ç³»</li><li>æŸ¥è¯¢è¡¨</li><li>è§†å›¾è¡¨ï¼šè™šè¡¨ï¼Œä¸å¯¹åº”å®é™…å­˜å‚¨çš„æ•°æ®</li></ul></li></ul><h3 id="å…³ç³»æ¨¡å¼">å…³ç³»æ¨¡å¼</h3><p>å…³ç³»æ¨¡å¼æ˜¯å‹ï¼Œå…³ç³»æ˜¯å€¼ï¼Œå…³ç³»æ¨¡å¼æ˜¯å¯¹å…³ç³»çš„æè¿°</p><h3 id="å…³ç³»æ“ä½œã€">å…³ç³»æ“ä½œã€</h3><h3 id="å…³ç³»å®Œæ•´æ€§">å…³ç³»å®Œæ•´æ€§</h3><p>å…³ç³»æ¨¡å¼ä¸­æœ‰ä¸‰ç±»å®Œæ•´æ€§çº¦æŸï¼šå®ä½“å®Œæ•´æ€§ã€å‚ç…§å®Œæ•´æ€§ã€ç”¨æˆ·å®šä¹‰å®Œæ•´æ€§</p><ol><li>å®ä½“å®Œæ•´æ€§ï¼šè‹¥å±æ€§Aæ˜¯åŸºæœ¬å…³ç³»Rçš„ä¸»å±æ€§ï¼Œåˆ™Aä¸èƒ½å–ç©ºå€¼</li><li>å‚ç…§å®Œæ•´æ€§ï¼šè‹¥å±æ€§Fæ˜¯åŸºæœ¬å…³ç³»Rçš„å¤–ç ï¼Œå®ƒä¸åŸºæœ¬å…³ç³»Sçš„çŒªå—Ksç›¸å¯¹åº”ï¼Œåˆ™å¯¹äºRä¸­æ¯ä¸ªå…ƒç»„åœ¨Fä¸Šçš„å€¼å¿…é¡»ï¼šï¼ˆè°æ˜¯è°çš„å¤–ç ï¼‰<ol><li>æˆ–è€…å–ç©ºå€¼</li><li>æˆ–è€…ç­‰äºSä¸­æŸä¸ªå…ƒç»„çš„ä¸»ç å€¼</li></ol></li><li>ç”¨æˆ·å®šä¹‰å®Œæ•´æ–°ï¼šç”¨æˆ·å®šä¹‰çš„å®Œæ•´æ€§å°±æ˜¯é’ˆå¯¹æŸä¸€å…·ä½“å…³ç³»æ•°æ®åº“çš„çº¦æŸæ¡ä»¶ï¼Œååº”æŸä¸€å…·ä½“åº”ç”¨æ‰€è®¾è®¡çš„æ•°æ®å¿…é¡»æ»¡è¶³çš„è¯­ä¹‰è¦æ±‚</li></ol><h3 id="å…³ç³»ä»£æ•°">å…³ç³»ä»£æ•°</h3><p>æŠ½è±¡çš„æŸ¥è¯¢è¯­è¨€ï¼Œç”¨å¯¹å…³ç³»çš„è¿ç®—æ¥è¡¨è¾¾æŸ¥è¯¢</p><p>å…³ç³»ä»£æ•°çš„è¿ç®—æŒ‰ç…§ä¸è¿ç®—ç¬¦ä¸åŒå¯ä»¥åˆ†ä¸ºä¼ ç»Ÿé›†åˆè¿ç®—å’Œä¸“é—¨çš„å…³ç³»è¿ç®—ã€‚</p><ol><li>ä¼ ç»Ÿé›†åˆè¿ç®—ï¼šå¹¶ã€äº¤ã€å·®ã€ç¬›å¡å°”ç§¯</li><li>ä¸“é—¨çš„å…³ç³»è¿ç®—ï¼šåŒ…æ‹¬ã€æŠ•å½±ã€è¿æ¥ã€é™¤è¿ç®—ç­‰<ul><li>è¿æ¥ï¼šæ³¨æ„è‡ªç„¶è¿æ¥ã€å¤–è¿æ¥ã€å·¦å¤–è¿æ¥ã€å³å¤–è¿æ¥ï¼ˆç¬¦å·å¦‚ä½•è¡¨ç¤ºï¼‰ã€‚æ‚¬æµ®å…ƒç»„æ˜¯å•¥</li><li>é™¤ï¼šç†è§£å¦‚ä½•ç®—</li></ul></li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>æ•°æ®åº“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ—¥è¯­å­¦ä¹ </title>
    <link href="/2022/01/01/%E6%97%A5%E8%AF%AD%E5%AD%A6%E4%B9%A0/"/>
    <url>/2022/01/01/%E6%97%A5%E8%AF%AD%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1>è¶™ã•ã‚“ã®æ—¥æœ¬èªå‹‰å¼·ã™ã‚‹</h1><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104130620.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134333.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134345.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134350.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134354.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134357.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134442.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134447.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134450.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134454.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134457.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134501.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134505.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134509.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134513.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134516.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134523.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134526.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134530.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134533.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134538.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134542.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134542.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134545.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134549.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134552.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134555.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134559.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134602.png" alt=""></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/QQ%E5%9B%BE%E7%89%8720220104134606.png" alt=""></p>]]></content>
    
    
    
    <tags>
      
      <tag>Study</tag>
      
      <tag>Language</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è½¯ä»¶ä½“ç³»æ¶æ„è€ƒè¯•å¤ä¹ </title>
    <link href="/2021/11/10/%E8%BD%AF%E4%BB%B6%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84%E8%80%83%E8%AF%95%E5%A4%8D%E4%B9%A0/"/>
    <url>/2021/11/10/%E8%BD%AF%E4%BB%B6%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84%E8%80%83%E8%AF%95%E5%A4%8D%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1>è½¯ä»¶ä½“ç³»æ¶æ„è€ƒè¯•å¤ä¹ </h1><h2 id="åŸºæœ¬æ¦‚å¿µ-v3">åŸºæœ¬æ¦‚å¿µ</h2><p><strong>è½¯ä»¶ä½“ç³»æ¶æ„</strong>ï¼šè½¯ä»¶ä½“ç³»ç»“æ„æ˜¯å…·æœ‰ä¸€å®šå½¢å¼çš„ç»“æ„åŒ–å…ƒç´ ï¼ŒæŠ½è±¡çš„è®²ï¼Œè½¯ä»¶ä½“ç³»ç»“æ„åŒ…æ‹¬æ„æˆç³»ç»Ÿçš„è®¾è®¡å…ƒç´ çš„æè¿°ï¼Œè®¾è®¡å…ƒç´ çš„äº¤äº’ï¼Œè®¾è®¡å…ƒç´ ç»„åˆçš„æ¨¡å¼ï¼Œä»¥åŠåœ¨è¿™äº›æ¨¡å¼ä¸­çš„çº¦æŸã€‚å…·ä½“çš„è®²ï¼Œ<strong>ä½“ç³»ç»“æ„ = ç»„ä»¶+è¿æ¥ä»¶+çº¦æŸ</strong></p><p><strong>ç»„ä»¶</strong>ï¼šå…·æœ‰æŸç§åŠŸèƒ½çš„<strong>å¯é‡ç”¨çš„è½¯ä»¶æ¨¡å—å•å…ƒ</strong>ï¼Œè¡¨ç¤ºäº†ç³»ç»Ÿä¸­<strong>ä¸»è¦çš„è®¡ç®—å•å…ƒå’Œæ•°æ®å­˜å‚¨</strong>ã€‚</p><p><strong>è¿æ¥ä»¶</strong>ï¼šè¡¨ç¤ºäº†ç»„ä»¶ä¹‹é—´çš„äº¤äº’ï¼Œç®€å•çš„è¿æ¥ä»¶æœ‰ï¼š<strong>ç®¡é“ï¼Œè¿‡ç¨‹è°ƒç”¨ï¼Œäº‹ä»¶å¹¿æ’­</strong>ç­‰ï¼Œå¤æ‚çš„è¿æ¥ä»¶æœ‰ï¼š<strong>å®¢æˆ·-æœåŠ¡å™¨é€šä¿¡åè®®ï¼Œæ•°æ®åº“å’Œåº”ç”¨ä¹‹é—´SQLè¿æ¥</strong>ç­‰ã€‚</p><p><strong>çº¦æŸ</strong>ï¼šè¡¨ç¤ºäº†ç»„ä»¶å’Œè¿æ¥ä»¶çš„<strong>æ‹“æ‰‘é€»è¾‘å’Œçº¦æŸ</strong>ã€‚</p><p><strong>ç®¡é“-è¿‡æ»¤å™¨ï¼š</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211110093740684.png" alt="image-20211110093740684"></p><p>æ¯ä¸ªè¿‡æ»¤å™¨éƒ½æœ‰ä¸€ç»„è¾“å…¥é›†å’Œè¾“å‡ºé›†ã€‚è¿‡æ»¤å™¨ä»ç®¡é“ä¸­è¯»å…¥æ•°æ®æµï¼Œå¯¹è¾“å…¥æµè¿›è¡Œå†…éƒ¨è½¬æ¢å’Œå¢é‡è®¡ç®—ï¼ˆä¸°å¯Œï¼Œç²¾ç‚¼ï¼Œè½¬æ¢ï¼Œèåˆï¼Œåˆ†è§£ï¼‰ï¼Œç„¶åäº§ç”Ÿè¾“å‡ºæ•°æ®æµå¹¶å†™å…¥ç®¡é“ä¸­ã€‚</p><p>ç‰¹ç‚¹ï¼š</p><p>æ¯ä¸ªè¿‡æ»¤å™¨å¿…é¡»æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å®ä½“ï¼šè¿‡æ»¤å™¨ä¹‹é—´æ— éœ€å…±äº«çŠ¶æ€ï¼Œå³filteræ— éœ€çŸ¥é“å…¶è¾“å…¥ç®¡é“å’Œè¾“å‡ºç®¡é“æ‰€è¿æ¥çš„å…¶ä»–è¿‡æ»¤å™¨çš„å­˜åœ¨ï¼Œæ›´ä¸å¿…å…³æ³¨ç›¸é‚»è¿‡æ»¤å™¨çš„å®ç°ç»†èŠ‚ã€‚ä»–ä»…ä»…éœ€è¦å¯¹è¾“å…¥æ•°æ®æµè¿›è¡Œç‰¹å®šçš„å†…éƒ¨è»¢æ¢å’Œå¢é‡è®¡ç®—ï¼Œç­›é€‰å‡ºåˆé€‚çš„æ•°æ®ã€‚<br>æ•°æ®åˆ°æ¥æ˜¯ä¾¿è¢«å¤„ç†ï¼Œä¸æ˜¯æ”¶é›†ç„¶åå¤„ç†ï¼Œå³åœ¨è¾“å…¥è¢«å®Œå…¨æ¶ˆè´¹ä¹‹å‰ï¼Œè¾“å‡ºä¾¿äº§ç”Ÿäº†ã€‚<br>**ç®¡é“æ˜¯å°†æ•°æ®ä»ä¸€ä¸ªè¿‡æ»¤å™¨çš„è¾“å‡ºç«¯ç§»åŠ¨åˆ°å¦ä¸€ä¸ªè¿‡æ»¤å™¨çš„è¾“å…¥ç«¯ï¼Œæ˜¯ä¸€ä¸ªå•å‘æµã€‚**ä¸åŒçš„ç®¡é“ä¸­æµåŠ¨çš„æ•°æ®æµï¼Œå¯èƒ½å…·æœ‰ä¸åŒçš„æ•°æ®æ ¼å¼ã€‚<br>åº”ç”¨ç¤ºä¾‹<br>ç¼–è¯‘å™¨ã€Unixç®¡é“ã€å›¾åƒå¤„ç†ï¼Œä¿¡å·å¤„ç†ï¼Œå£°éŸ³ä¸å›¾åƒå¤„ç†</p><p>ä¼˜ç‚¹å’Œç¼ºç‚¹</p><ul><li><p>ä¼˜ç‚¹ï¼š</p><p>è‰¯å¥½çš„éšè”½æ€§å’Œé«˜å†…èšã€ä½è€¦åˆï¼šå¯ä»¥å°†æ•´ä¸ªç³»ç»Ÿçš„è¾“å…¥è¾“å‡ºè¡Œä¸ºçœ‹æˆå¤šä¸ªè¿‡æ»¤å™¨åŠŸèƒ½çš„ç®€å•åˆæˆã€‚<br>æ”¯æŒåŠŸèƒ½æ¨¡å—çš„é‡ç”¨ï¼šä»»æ„ä¸¤ä¸ªè¿‡æ»¤å™¨åªè¦ç›¸äº’é—´æ‰€ä¼ è¾“çš„æ•°æ®æ ¼å¼ä¸Šè¾¾æˆä¸€è‡´ï¼Œå°±å¯ä»¥è¿æ¥åœ¨ä¸€èµ·<br>ç³»ç»Ÿå®¹æ˜“ç»´æŠ¤å’Œæ‹“å±•ï¼šæ–°çš„è¿‡æ»¤å™¨å®¹æ˜“åŠ å…¥åˆ°ç³»ç»Ÿä¸­ï¼Œæ—§çš„è¿‡æ»¤å™¨ä¹Ÿå¯è¢«æ”¹è¿›çš„è¿‡æ»¤å™¨æ›¿æ¢<br>å…è®¸å¯¹ä¸€äº›å¦‚ååé‡ï¼Œæ­»é” ç­‰å±æ€§è¿›è¡Œåˆ†æ<br>æ”¯æŒå¹¶è¡Œæ‰§è¡Œï¼šæ¯ä¸€ä¸ªè¿‡æ»¤å™¨æ—¢å¯ä»¥ç‹¬ç«‹è¿è¡Œï¼Œä¹Ÿå¯ä¸å…¶ä»–è¿‡æ»¤å™¨å¹¶å‘æ‰§è¡Œã€‚</p></li><li><p>ç¼ºç‚¹ï¼š</p><p>ä¸é€‚åˆå¤„ç†äº¤äº’çš„åº”ç”¨<br>ç³»ç»Ÿæ€§èƒ½ä¸é«˜ï¼Œå¹¶å¢åŠ äº†ç¼–å†™è¿‡æ»¤å™¨çš„å¤æ‚æ€§ï¼šæ•°æ®ä¼ è¾“ç¼ºä¹é€šç”¨æ ‡å‡†ï¼Œæ¯ä¸ªè¿‡æ»¤å™¨ç»å¤§éƒ¨åˆ†æ—¶é—´æ¶ˆè€—åœ¨æ•°æ®æ ¼å¼çš„è§£æï¼Œè½¬æ¢ï¼Œåˆæˆä¸Šã€‚åŒæ ·ä¹Ÿä¸é€‚ç”¨äºå¤§é‡å…±äº«æ•°æ®çš„åº”ç”¨è®¾ç½®ã€‚</p></li></ul><p><strong>è°ƒç”¨-è¿”å›é£æ ¼</strong>ï¼š</p><p><a href="https://blog.csdn.net/qq_42475914/article/details/108087484">https://blog.csdn.net/qq_42475914/article/details/108087484</a></p><p><strong>ä¸ƒç§è½¯ä»¶æ¶æ„æ¨¡å¼</strong></p><p><a href="https://blog.csdn.net/omnispace/article/details/80224942?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522163650884616780271535660%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=163650884616780271535660&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-80224942.pc_search_mgc_flag&amp;utm_term=%E8%BD%AF%E4%BB%B6%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84%E6%A8%A1%E5%BC%8F&amp;spm=1018.2226.3001.4187">è®²è§£</a></p><p><a href="https://blog.csdn.net/qq_41626229/article/details/85930248?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=%E8%BD%AF%E4%BB%B6%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-85930248.pc_search_mgc_flag&amp;spm=1018.2226.3001.4187">2</a></p><ul><li>åˆ†å±‚æ¶æ„</li><li>å¤šå±‚æ¶æ„</li><li>ç®¡é“è¿‡æ»¤å™¨æ¶æ„</li><li>å®¢æˆ·ç«¯æœåŠ¡å™¨æ¶æ„</li><li>æ¨¡å‹è§†å›¾æ§åˆ¶å™¨æ¶æ„</li><li>äº‹ä»¶é©±åŠ¨æ¶æ„</li><li>å¾®æœåŠ¡æ¶æ„</li><li>é»‘æ¿æ¨¡å¼ <a href="https://blog.csdn.net/aodya68040/article/details/102171976?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=%E9%BB%91%E6%9D%BF%E6%A8%A1%E5%BC%8F&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-6-102171976.pc_search_mgc_flag&amp;spm=1018.2226.3001.4187">ä»‹ç»</a></li><li><a href="https://blog.csdn.net/G66565906/article/details/100762744?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522163651249616780262582073%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=163651249616780262582073&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-100762744.pc_search_mgc_flag&amp;utm_term=C2%E9%A3%8E%E6%A0%BC&amp;spm=1018.2226.3001.4187">C2é£æ ¼</a></li></ul><p><a href="https://blog.csdn.net/yuhao22/article/details/105619370">ä¸ƒç§è½¯ä»¶æ¶æ„è®¾è®¡åŸåˆ™</a></p><p><a href="https://blog.csdn.net/qq_37174526/article/details/85078396?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=%E8%BD%AF%E4%BB%B6%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-3-85078396.pc_search_mgc_flag&amp;spm=1018.2226.3001.4187">C/S B/S æ¯”è¾ƒ  ä¸‰å±‚CS  RESTæ¶æ„é£æ ¼ é»‘æ¿æ¨¡å¼</a></p><p><a href="https://blog.csdn.net/thinkingforever/article/details/3160305?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522163650984816780274121579%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=163650984816780274121579&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-3160305.pc_search_mgc_flag&amp;utm_term=%E8%B4%A8%E9%87%8F%E5%B1%9E%E6%80%A7&amp;spm=1018.2226.3001.4187">è´¨é‡å±æ€§</a></p><p>å¯ç”¨æ€§ã€å¯ä¿®æ”¹æ€§ã€æ€§èƒ½ã€å®‰å…¨æ€§ã€å¯æµ‹è¯•æ€§ã€æ˜“ç”¨æ€§</p><p><a href="https://wenku.baidu.com/view/67784e8dba0d4a7303763a14.html">è½¯ä»¶ä½“ç³»ç»“æ„ç»„æˆã€é£æ ¼</a></p><p><a href="https://blog.csdn.net/qq_41800649/article/details/104650410?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522163651135816780366584580%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=163651135816780366584580&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-104650410.pc_search_mgc_flag&amp;utm_term=%E8%BD%AF%E4%BB%B6%E5%8D%B1%E6%9C%BA&amp;spm=1018.2226.3001.4187">è½¯ä»¶å±æœº</a></p><p><a href="https://wenku.baidu.com/view/26a5f0aa910ef12d2af9e779.html?rec_flag=default&amp;fr=Recommend_RelativeDoc-40381,60272,40340,60359-kpdrec_doc_pc_view-67784e8dba0d4a7303763a14&amp;sxts=1636511001147">BS CS ä¸‰å±‚CSçš„åŒºåˆ« ï¼ŒåŠ¨æ€è½¯ä»¶ä½“ç³»æ¶æ„ï¼Œå“ªäº›æ–¹é¢å»è¯„ä¼°è½¯ä»¶ä½“ç³»æ¶æ„</a></p><p><a href="https://blog.csdn.net/qq_40949254/article/details/78852620">4+!è§†å›¾æ¨¡å‹ è½¯ä»¶å±æœº  DSSA SOA</a></p><p><a href="https://blog.csdn.net/m0_37482190/article/details/103774853?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522163651141816780269841231%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=163651141816780269841231&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-103774853.pc_search_mgc_flag&amp;utm_term=%E8%BD%AF%E4%BB%B6%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84&amp;spm=1018.2226.3001.4187">4+1è§†å›¾æ¨¡å‹ SOA</a></p><p><a href="https://baike.baidu.com/item/atam/1652710?fr=aladdin">ATAM æ¶æ„æƒè¡¡åˆ†ææ–¹æ³•</a></p><p>ä»‹ç»ATAMã€‚<br>ä»‹ç»å•†ä¸šåŠ¨æœºï¼›<br>ä»‹ç»ä½“ç³»ç»“æ„ï¼›<br>è¯†åˆ«ä½“ç³»ç»“æ„æ–¹æ³•ï¼›<br>ç”Ÿæˆè´¨é‡å±æ€§æ•ˆç”¨æ ‘ã€‚<br>åˆ†æä½“ç³»ç»“æ„æ–¹æ³•ã€‚<br>å¤´è„‘é£æš´å’Œè®¾å®šåœºæ™¯ä¼˜å…ˆçº§ã€‚<br>åˆ†æä½“ç³»ç»“æ„æ–¹æ³•ï¼›<br>æä¾›è¯„ä¼°ç»“æœï¼›</p><p><a href="https://baike.baidu.com/item/SAAM">SAAM ä½“ç³»ç»“æ„åˆ†ææ–¹æ³•</a></p><p>åœºæ™¯ç”Ÿæˆï¼›<br>ä½“ç³»ç»“æ„æå†™å™è¿°ï¼›<br>åœºæ™¯çš„åˆ†ç±»å’Œä¼˜å…ˆçº§ç¡®å®šã€‚<br>é—´æ¥åœºæ™¯çš„å•ç‹¬è¯„ä¼°ã€‚<br>å¯¹åœºæ™¯å…³è”çš„è¯„ä¼°ã€‚<br>å½¢æˆæ•´ä½“è¯„ä¼°ï¼›</p><p><a href="https://wenku.baidu.com/view/aa0de804e45c3b3567ec8bb5.html">é¢˜ç›®1 ATAMè¡¨è¿° ç®¡é“è¿‡æ»¤å™¨ç‰¹ç‚¹</a></p><p><a href="https://wenku.baidu.com/view/718aa2d0fd4ffe4733687e21af45b307e971f9e1.html?rec_flag=default&amp;fr=Recommend_RelativeDoc-40381,60272,40340,60359-kpdrec_doc_pc_view-aa0de804e45c3b3567ec8bb5&amp;sxts=1636512258928">é¢˜ç›®2</a></p><p><a href="https://wenku.baidu.com/view/d809f7d87ed5360cba1aa8114431b90d6d858903.html?rec_flag=default&amp;fr=Recommend_RelativeDoc-40381,60272,40340,60359-kpdrec_doc_pc_view-a88bf77502768e9951e73889&amp;sxts=1636512350407">é¢˜ç›®3 åè¯è§£é‡Š</a></p><p><a href="https://wenku.baidu.com/view/9249ea5a763231126edb11df.html?rec_flag=default&amp;fr=Recommend_RelativeRecommend-40381,60272,40340,60359-pc_view_otherlike_new-aa0de804e45c3b3567ec8bb5">é¢˜ç›®4 åè¯è§£é‡Šå’Œé—®ç­”</a></p><p><a href="https://wenku.baidu.com/view/5deb7e1ca8114431b90dd8eb.html?fixfr=B0DOSKxVyIS3Ey48HcnErQ%253D%253D&amp;fr=income2-wk_go_search-search">é¢˜ç›®5 åç”»å›¾</a></p><p><a href="https://wenku.baidu.com/view/7cd76ba8cad376eeaeaad1f34693daef5ff71366.html?fixfr=iCEVfdPyN5u2%252BxPnVoVOQA%253D%253D&amp;fr=income10-wk_go_searchX-search">é¢˜ç›®6</a></p><p><a href="https://wenku.baidu.com/view/25e8606300020740be1e650e52ea551811a6c97d.html?fixfr=CwG8HDA9mdQLnjpnRG2brw%253D%253D&amp;fr=income12-wk_go_searchX-search">é¢˜ç›®7 è½¯ä»¶ä½“ç³»æ¶æ„å®šä¹‰ ADD</a></p><p><a href="https://www.docin.com/p-2325692580.html">ç”¨ä¾‹å›¾ç±»å›¾</a></p><p><a href="https://www.doc88.com/p-2334903732994.html?r=1">åç§‘åŸé¢˜</a></p><p>é‡ç‚¹ï¼šBS CS ä¸‰å±‚CS  è´¨é‡å±æ€§   ATAM è¯„ä¼°æ–¹æ³•æ­¥éª¤</p>]]></content>
    
    
    
    <tags>
      
      <tag>Exam</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ•°å­—å›¾åƒå¤„ç†æœŸæœ«å¤ä¹ </title>
    <link href="/2021/11/05/%E6%95%B0%E5%AD%97%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E8%80%83%E8%AF%95%E5%A4%8D%E4%B9%A0/"/>
    <url>/2021/11/05/%E6%95%B0%E5%AD%97%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E8%80%83%E8%AF%95%E5%A4%8D%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1>æ•°å­—å›¾åƒå¤„ç†å¤ä¹ </h1><h2 id="åŸºæœ¬æ¦‚å¿µ">åŸºæœ¬æ¦‚å¿µ</h2><p>å›¾åƒåœ¨æŸç‚¹çš„å¼ºåº¦æˆ–è€…ç°åº¦ï¼šåœ¨ä»»ä½•ä¸€å †ç©ºé—´åæ ‡(x,y)å¤„çš„å¹…å€¼fã€‚å½“xå’Œyå’Œç°åº¦å€¼fæ˜¯æœ‰é™çš„ç¦»æ•£æ•°å€¼æ—¶ï¼Œè¯¥å›¾åƒä¸ºæ•°å­—å›¾åƒ</p><p>å–æ ·ï¼šå¯¹åæ ‡å€¼è¿›è¡Œæ•°å­—åŒ–<br>é‡åŒ–ï¼šå¯¹å¹…å€¼æ•°å­—åŒ–</p><p>å›¾åƒçš„åŠ¨æ€èŒƒå›´ï¼šç³»ç»Ÿä¸­æœ€å¤§å¯åº¦é‡ç°åº¦ä¸æœ€å°å¯æ£€æµ‹ç°åº¦ä¹‹æ¯”ã€‚ä¸Šé™å–å†³äºé¥±å’Œåº¦ï¼Œä¸‹é™å–å†³äºå™ªå£°ï¼ŒåŸºæœ¬ä¸Šï¼ŒåŠ¨æ€èŒƒå›´èƒ½ç”±ç³»ç»Ÿè¡¨ç¤ºçš„æœ€ä½å’Œæœ€é«˜ç°åº¦çº§æ¥ç¡®å®š</p><p>ä¸€å‰¯å›¾åƒä¸ºkæ¯”ç‰¹å›¾åƒï¼šä¸€å¹…å›¾åƒæœ‰2^kä¸ªç°åº¦çº§</p><p>ç°åº¦ï¼šé»‘è‰²è°ƒè¡¨ç¤ºç‰©ä½“ï¼Œé»‘è‰²ä¸ºåŸºå‡†è‰²ï¼Œä¸åŒé¥±å’Œåº¦çš„é»‘è‰²æ¥æ˜¾ç¤ºå›¾åƒã€‚ç°åº¦å€¼0-255è¡¨ç¤ºçš„äº®åº¦ä»æ·±åˆ°æµ…</p><p>HSVæ¨¡å‹</p><ul><li>é¥±å’Œåº¦Satï¼šï¼šè¶…è¿‡è¿™ä¸ªå€¼çš„ç°åº¦çº§å°†ä¼šè¢«å‰ªåˆ‡æ‰è¿™æ ·çš„ä¸€ä¸ªæœ€é«˜å€¼ã€‚åŸè‰²é¥±å’Œåº¦æœ€é«˜ï¼Œé¥±å’Œåº¦é™ä½ï¼Œè‰²å½©å˜å¾—æš—æ·¡åˆ°æ²¡æœ‰å½©ï¼ˆç®€å•ç‚¹ç†è§£å°±æ˜¯é¢œè‰²ä¸­çš„ç°è‰²é‡å«é‡çš„é«˜ä½ï¼‰<br>è‰²å½©ä¸­å«æœ‰å½©è‰²æˆåˆ†å’Œæ¶ˆè‰²æˆåˆ†ï¼ˆç°åº¦ï¼‰çš„æ¯”ä¾‹ã€‚è¿˜æœ‰æ¶ˆè‰²æˆåˆ†å¤šæ—¶ï¼Œè‰²å½©ä¸åŒ…å«ï¼Œè‰²è§‰å¼±ç°åº¦å¤§ï¼Œè‰²å½©æ˜¾å¾—æš—æ·¡ï¼Œè§†è§‰æ•ˆæœå¼±ã€‚</li><li>æ˜åº¦Valï¼šçœ¼ç›å¯¹å…‰æºå’Œç‰©ä½“è¡¨é¢çš„æ•æ„Ÿç¨‹åº¦çš„æ„Ÿè§‰ï¼Œä¸»è¦ç”±å…‰çº¤å¼ºå¼±å†³å®šçš„è§†è§‰ç»éªŒã€‚æŒ‡é¢œè‰²çš„ä»¥å—æˆéƒ½ï¼Œè‰²è°ƒç›¸åŒçš„é¢œè‰²ï¼Œä½†æ˜æš—æˆéƒ½å¯èƒ½ä¸åŒï¼ˆæŒ‡çš„æ˜¯é¢œè‰²ä¸­æ··åˆäº†å¤šå°‘ç™½è‰²æˆ–é»‘è‰²ã€‚ï¼‰<br>å–å†³äºå…‰æºå¼ºåº¦ï¼Œä¸ç‰©ä½“è¡¨é¢çš„åå°„ç³»æ•°ã€‚</li><li>è‰²ç›¸Hueï¼šè‰²å½©çš„ç›¸è²Œï¼ŒæŒ‡å„ç§é¢œè‰²ï¼Œçº¢æ©™é»„ç»¿é’è“ç´«ç­‰ï¼Œä¸è‰²å½©çš„æ•æ„Ÿå¼ºå¼±æ²¡æœ‰å…³ç³»ã€‚</li></ul><p>ç©ºé—´åˆ†è¾¨ç‡ï¼šå›¾åƒä¸­èƒ½å¤Ÿå¯åˆ†è¾¨çš„æœ€å°ç»†èŠ‚çš„åº¦é‡ï¼ˆæ¯å•ä½è·ç¦»çº¿å¯¹æ•°å’Œæ¯å•ä½è·ç¦»ç‚¹æ•°ï¼ˆåƒç´ æ•°ï¼‰æ˜¯æœ€é€šç”¨çš„å•ä½ï¼‰ã€‚ä¾‹å¦‚æ¯è‹±å¯¸ç‚¹æ•°dpi</p><p>ç°åº¦åˆ†è¾¨ç‡ï¼šç°åº¦çº§ä¸­å¯åˆ†è¾¨ä¸­çš„æœ€å°å˜åŒ–</p><p>å¯¹æ¯”åº¦ï¼šä¸€å‰¯å›¾åƒä¸­æ•æ„ŸåŒºåŸŸæœ€äº®çš„ç™½å’Œæœ€æš—çš„é»‘ä¹‹é—´ä¸åŒäº®åº¦å±‚çº§çš„æµ‹é‡ï¼Œå·®å¼‚èŒƒå›´è¶Šå¤§ä»£è¡¨å¯¹æ¯”è¶Šå°ã€‚é«˜çš„å¯¹æ¯”åº¦è®©å›¾åƒæ›´æ¸…æ™°é†’ç›®ï¼Œè‰²å½©æ›´åŠ é²œè‰³</p><p>ç°åº¦å˜æ¢ï¼šä¸€ä¸ªç°åº¦åŒºé—´æ˜ å°„åˆ°å¦ä¸€ä¸ªç°åº¦åŒºé—´çš„å˜æ¢ã€‚ç°åº¦å˜æ¢å¯ä½¿å›¾åƒåŠ¨æ€èŒƒå›´åŠ å¤§ï¼Œå›¾åƒå¯¹æ¯”åº¦æ‰©å±•ï¼Œå›¾åƒæ¸…æ™°ï¼Œç‰¹å¾æ˜æ˜¾ï¼Œæ˜¯å›¾åƒå¢å¼ºçš„é‡è¦æ‰‹æ®µ</p><p>é“¾ç ï¼šç”¨æ›²çº¿èµ·å§‹ç‚¹çš„<a href="https://baike.baidu.com/item/%E5%9D%90%E6%A0%87/85345">åæ ‡</a>å’Œè¾¹ç•Œç‚¹æ–¹å‘ä»£ç æ¥æè¿°æ›²çº¿æˆ–è¾¹ç•Œçš„æ–¹æ³•</p><p>å½¢çŠ¶æ•°ï¼šå½¢çŠ¶æ•°æ˜¯åŸºäº4 é“¾ç çš„è¾¹ç•Œæè¿°ç¬¦ï¼Œå®ƒå®šä¹‰ä¸ºå€¼æœ€å°çš„4 é“¾ç çš„ä¸€é˜¶å·®åˆ†ç ã€‚ç”±äºå½¢çŠ¶æ•°æ¥æºäº4 é“¾ç çš„ä¸€é˜¶å·®åˆ†ç ï¼Œæ‰€ä»¥å®ƒå…·æœ‰ä¸èµ·å§‹ç‚¹æ— å…³ä»¥åŠå¯¹æ—…è½¬90åº¦ä¸æ•æ„Ÿçš„ç‰¹ç‚¹ï¼Œå¯¹ä»»æ„æ—‹è½¬è§’åº¦çš„å½’ä¸€åŒ–ï¼Œé€šå¸¸é‡‡ç”¨çš„æ–¹æ³•æ˜¯å°†ä¸€ä¸ªåæ ‡è½´ä¸è¾¹ç•Œçš„ä¸»è½´å¯¹é½ï¼Œä¸ºäº†ä½¿å…¶å¯¹æ—‹è½¬ä¸æ•æ„Ÿï¼Œåº”å½“å…ˆå°†x è½´æ—‹è½¬è‡³ä¸è¾¹ç•Œçš„ä¸»è½´æ–¹å‘ä¸€è‡´ã€‚</p><p>å›¾åƒï¼šå›¾åƒæ˜¯äººç±»è§†è§‰çš„åŸºç¡€ï¼Œæ˜¯è‡ªç„¶æ™¯ç‰©çš„å®¢è§‚åæ˜ ï¼Œæ˜¯äººç±»è®¤è¯†ä¸–ç•Œå’Œäººç±»æœ¬èº«çš„é‡è¦æºæ³‰ã€‚â€œå›¾â€æ˜¯ç‰©ä½“åå°„æˆ–é€å°„å…‰çš„åˆ†å¸ƒï¼Œâ€œåƒâ€œæ˜¯äººçš„è§†è§‰ç³»ç»Ÿæ‰€æ¥å—çš„å›¾åœ¨äººè„‘ä¸­æ‰€å½¢æˆçš„å°è±¡æˆ–è®¤è¯†ï¼Œ<a href="https://baike.baidu.com/item/%E7%85%A7%E7%89%87/1465692">ç…§ç‰‡</a>ã€ç»˜ç”»ã€å‰ªè´´ç”»ã€åœ°å›¾ã€ä¹¦æ³•ä½œå“ã€æ‰‹å†™æ±‰å­¦ã€ä¼ çœŸã€å«æ˜Ÿäº‘å›¾ã€å½±è§†ç”»é¢ã€Xå…‰ç‰‡ã€è„‘ç”µå›¾ã€<a href="https://baike.baidu.com/item/%E5%BF%83%E7%94%B5%E5%9B%BE/399200">å¿ƒç”µå›¾</a>ç­‰éƒ½æ˜¯å›¾åƒ</p><p><strong>æ•°å­—å›¾åƒ</strong>ï¼šåˆç§°<strong>æ•°ç å›¾åƒ</strong>æˆ–<strong>æ•°ä½å›¾åƒ</strong>ï¼Œæ˜¯äºŒç»´å›¾åƒç”¨æœ‰é™æ•°å­—æ•°å€¼<a href="https://baike.baidu.com/item/%E5%83%8F%E7%B4%A0/95084">åƒç´ </a>çš„è¡¨ç¤ºã€‚ç”±æ•°ç»„æˆ–çŸ©é˜µè¡¨ç¤ºï¼Œå…¶å…‰ç…§ä½ç½®å’Œå¼ºåº¦éƒ½æ˜¯ç¦»æ•£çš„ã€‚æ•°å­—å›¾åƒæ˜¯ç”±æ¨¡æ‹Ÿ<a href="https://baike.baidu.com/item/%E5%9B%BE%E5%83%8F%E6%95%B0%E5%AD%97%E5%8C%96">å›¾åƒæ•°å­—åŒ–</a>å¾—åˆ°çš„ã€ä»¥åƒç´ ä¸ºåŸºæœ¬å…ƒç´ çš„ã€å¯ä»¥ç”¨<a href="https://baike.baidu.com/item/%E6%95%B0%E5%AD%97%E8%AE%A1%E7%AE%97%E6%9C%BA/1531105">æ•°å­—è®¡ç®—æœº</a>æˆ–æ•°å­—ç”µè·¯å­˜å‚¨å’Œå¤„ç†çš„å›¾åƒã€‚</p><p>å›¾åƒæ•°å­—åŒ–ï¼šæ˜¯å°†ç©ºé—´åˆ†å¸ƒå’Œäº®åº¦å–å€¼å†›è¿ç»­åˆ†å¸ƒçš„æ¨¡æ‹Ÿå›¾åƒç»é‡‡æ ·å’Œé‡åŒ–è½¬æ¢æˆè®¡ç®—æœºèƒ½å¤Ÿå¤„ç†çš„æ•°å­—å›¾åƒçš„è¿‡ç¨‹ã€‚</p><h2 id="ç©ºé—´æ»¤æ³¢">ç©ºé—´æ»¤æ³¢</h2><p>ç©ºé—´æ»¤æ³¢ï¼šé‡‡ç”¨æ»¤æ³¢å¤„ç†çš„å½±åƒå¢å¼ºæ–¹æ³•ã€‚èƒ½æ”¹å–„å½±åƒè´¨é‡ï¼ˆå»é™¤é«˜é¢‘å™ªå£°ä¸å¹²æ‰°ã€å½±åƒè¾¹ç¼˜å¢å¼ºç­‰ï¼‰</p><ul><li>ä½é€šæ»¤æ³¢ï¼ˆå¹³æ»‘ï¼‰</li><li>é«˜é€šæ»¤æ³¢ï¼ˆé”åŒ–ï¼‰</li><li>å¸¦é€šæ»¤æ³¢</li></ul><p><strong>å¯¹æ•°å˜æ¢</strong>ï¼šs = clog(1+r),å°†è¾“å…¥ä¸­èŒƒå›´è¾ƒçª„çš„ä½ç°åº¦å€¼æ˜ å°„ä¸ºè¾“å‡ºä¸­è¾ƒå®½èŒƒå›´çš„ç°åº¦å€¼ï¼Œé«˜ç°åº¦å€¼ç›¸åä¼šè¢«å‹ç¼©ã€‚<br>å‹ç¼©åƒç´ å€¼å˜åŒ–è¾ƒå¤§çš„å›¾åƒçš„åŠ¨æ€èŒƒå›´ ---- ä»¥æ­¤å¼ºè°ƒå›¾åƒä½ç°åº¦éƒ¨åˆ†</p><p><strong>ä¼½é©¬å˜æ¢</strong>ï¼šs = c r^y<br>éƒ¨åˆ†yå€¼çš„ä¼½é©¬æ›²çº¿å°†è¾ƒçª„èŒƒå›´çš„æš—è‰²è¾“å…¥å€¼æ˜ å°„ä¸ºè¾ƒå®½èŒƒå›´çš„è¾“å‡ºå€¼ã€‚ä¸å¯¹æ•°å˜æ¢ç±»ä¼¼ï¼ˆyå€¼å¤§åˆ™è¾“å‡ºç°åº¦çº§é«˜ï¼‰<br>æ”¹å˜ä¼½é©¬å€¼ä¼šæ”¹å˜å½©è‰²å›¾åƒä¸­çš„rgbæ¯”ç‡</p><p><strong>åˆ†æ®µçº¿æ€§å˜æ¢å‡½æ•°</strong></p><ul><li>å¯¹æ¯”åº¦æ‹‰ä¼¸</li><li>ç°åº¦çº§åˆ†å±‚</li><li>æ¯”ç‰¹å¹³é¢åˆ†å±‚</li></ul><h3 id="ç›´æ–¹å›¾">ç›´æ–¹å›¾</h3><h4 id="å‡è¡¡åŒ–">å‡è¡¡åŒ–</h4><p>ç›´æ–¹å›¾å‡è¡¡åŒ–ï¼šå¢å¼ºåŠ¨æ€èŒƒå›´åå°çš„å›¾åƒçš„å¯¹æ¯”åº¦ï¼ˆåŸå§‹å›¾åƒç”±äºå…¶ç°åº¦åˆ†å¸ƒå¯èƒ½é›†ä¸­åœ¨è¾ƒçª„çš„åŒºé—´ï¼Œé€ æˆå›¾åƒä¸å¤Ÿæ¸…æ™°ï¼‰<br>å¯¹åœ¨å›¾åƒä¸­åƒç´ ä¸ªæ•°å¤šçš„ç°åº¦å€¼ï¼ˆå³å¯¹ç”»é¢èµ·ä¸»è¦ä½œç”¨çš„ç°åº¦å€¼ï¼‰è¿›è¡Œå±•å®½ï¼Œè€Œå¯¹åƒç´ ä¸ªæ•°å°‘çš„ç°åº¦å€¼ï¼ˆå³å¯¹ç”»é¢ä¸èµ·ä¸»è¦ä½œç”¨çš„ç°åº¦å€¼ï¼‰è¿›è¡Œå½’å¹¶ï¼Œä»è€Œå¢å¤§å¯¹æ¯”åº¦ï¼Œä½¿å›¾åƒæ¸…æ™°ï¼Œè¾¾åˆ°å¢å¼ºçš„ç›®çš„</p><p>ç°åº¦ç›´æ–¹å›¾å¯é‹å‚ä¸€ç»´ç¦»æ•£å‡½æ•°:</p><p>$$h(k) = n_k \space k=0,1,â€¦,L-1$$</p><p>ç°åº¦çº§å‡ºç°çš„ç›¸å¯¹é¢‘ç‡ï¼š</p><p>$$P_r(k) = n_k/N$$Nä»£è¡¨åƒç´ çš„æ€»æ•°</p><p>å‡è¡¡åŒ–æ­¥éª¤ï¼š</p><ol><li>ç»Ÿè®¡ä¸åŒç°åº¦çº§çš„åƒç´ å’Œå’Œæ€»åƒç´ æ•°</li><li>è®¡ç®—åŸå§‹å›¾åƒçš„ç°åº¦åˆ†å¸ƒé¢‘ç‡</li><li>è®¡ç®—åŸå§‹ã«çš„ç°åº¦ç´¯è®¡åˆ†å¸ƒé¢‘ç‡ $$s_i = \sum_{i=0}^k \frac{n_i}{N}$$</li><li>è®¡ç®—ä¸Šä¸€æ­¥ç®—çš„s_iå¹¶è¿›è¡Œ<strong>å››èˆäº”å…¥</strong></li><li>è¿›è¡Œæ˜ å°„</li></ol><p><strong>ç‰¹ç‚¹ï¼š</strong></p><p>å¦‚æœå›¾åƒæ•´ä½“åæš—æˆ–è€…åäº®ï¼Œåˆ™å‡è¡¡åŒ–ä½¿ç”¨ï¼Œä½†å¯¹å¤„ç†çš„æ•°æ®ä¸åŠ é€‰æ‹©ï¼Œå¯èƒ½ä¼šå¹²æ‰°èƒŒæ™¯å¹¶é™ä½æœ‰ç”¨ä¿¡å·çš„å¯¹æ¯”åº¦ã€‚æ­¤å¤–å‡è¡¡åŒ–åå›¾åƒçš„ç°åº¦çº§å‡å°‘ï¼ŒæŸäº›ç»†èŠ‚ä¼šå‡å°‘</p><h4 id="è§„æ ¼åŒ–">è§„æ ¼åŒ–</h4><p>å‡è¡¡åŒ–ä¼˜ç‚¹èƒ½è‡ªåŠ¨å¢å¼ºæ•´ä¸ªå›¾åƒå¯¹æ¯”åº¦(??)ï¼Œä½†å…·ä½“å¢å¼ºä¸å®¹æ˜“æ§åˆ¶</p><p>ç›´æ–¹å›¾åŒ¹é…è¦æ±‚å®ç°ï¼šè¾“å‡ºçš„å›¾åƒå…·æœ‰è§„å®šçš„ç›´æ–¹å›¾çš„å½¢çŠ¶ã€‚</p><p>è¿‡ç¨‹ï¼š</p><ol><li>$$TÂ® = (L-1)\int_0^rp_r(w)dw$$</li><li>$$G(z) = (L-1)\int_0^zp_z(t)dt=s$$</li><li>$$z = G<sup>{-1}[TÂ®]=G</sup>{-1}(s)$$</li><li>ç”¨ç¬¬ä¸€ä¸ªå¼å­è¿›è¡Œå‡è¡¡ï¼Œå›¾åƒçš„åƒç´ å€¼æ˜¯så€¼ï¼Œå¯¹å›¾åƒä¸­å…·æœ‰så€¼çš„æ¯ä¸ªåƒç´ å€¼è¿˜è¡Œz=G^-1(s)</li></ol><h4 id="å±€éƒ¨å‡è¡¡åŒ–">å±€éƒ¨å‡è¡¡åŒ–</h4><h3 id="ç©ºé—´æ»¤æ³¢-v2">ç©ºé—´æ»¤æ³¢</h3><p>å°±æ˜¯ç›´æ¥åœ¨ç°åº¦å€¼ä¸Šï¼Œåšä¸€äº›æ»¤æ³¢æ“ä½œã€‚æ»¤æ³¢ï¼šå°†æŸä¸ªé¢‘ç‡æˆåˆ†æ»¤é™¤ã€‚</p><p>$$g(x,y)=\sum_{s=-a}^a \sum_{t=-b}^bw(s,t)f(x+s,y+t)$$</p><h4 id="å¹³æ»‘æ»¤æ³¢å™¨">å¹³æ»‘æ»¤æ³¢å™¨</h4><ul><li>å¹³å‡æ»¤æ³¢<ul><li>æ»¤æ³¢å™¨èŒƒå›´å†…çš„ç‚¹æ±‚å¹³å‡å€¼ï¼Œä½¿å¾—å›¾åƒå¹³æ»‘æ¶ˆé™¤å™ªå£°</li></ul></li><li>åŠ æƒæ»¤æ³¢<br>$$g(x,y)=\frac{\sum_{s=-a}^a \sum_{t=-b}<sup>bw(s,t)f(x+s,y+t)}{\sum_{s=-a}</sup>a \sum_{t=-b}<br>^bw(s,t)}$$</li></ul><h4 id="ç»Ÿè®¡æ’åºæ»¤æ³¢å™¨">ç»Ÿè®¡æ’åºæ»¤æ³¢å™¨</h4><p>éçº¿æ€§ç©ºé—´æ»¤æ³¢å™¨</p><ul><li>æœ€å¤§å€¼æ»¤æ³¢å™¨</li><li>æœ€å°å€¼æ»¤æ³¢å™¨</li><li>ä¸­å€¼æ»¤æ³¢å™¨ï¼šå–å‡ºæ¤’ç›å™ªå£°</li></ul><h4 id="é”åŒ–æ»¤æ³¢å™¨">é”åŒ–æ»¤æ³¢å™¨</h4><p>çªå‡ºç°åº¦çš„è¿‡æ¸¡éƒ¨åˆ†</p><p>ä¸€é˜¶å¾®åˆ†çš„å›¾åƒé”åŒ–ï¼šæ¢¯åº¦é”åŒ–<br>äºŒé˜¶å¾®åˆ†çš„å›¾åƒé”åŒ–ï¼šæ‹‰æ™®æ‹‰æ–¯é”åŒ–</p><p>ä¸€é˜¶å¾®åˆ†ï¼š</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211105115404043.png" alt="image-20211105115404043"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211105115416045.png" alt="image-20211105115416045"></p><p>Sobelç®—å­ï¼šç”¨ä½œè¾¹ç¼˜æ£€æµ‹ï¼Œè¿ç®—å›¾åƒäº®åº¦å‡½æ•°çš„ç°åº¦è¿‘ä¼¼å€¼</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211105115756505.png" alt="image-20211105115756505"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211105120121886.png" alt="image-20211105120121886"></p><p>$$G = \sqrt{G_x^2 + G_y^2}$$æˆ–è€…$$|G| = |G_x|+|G_y|$$</p><p>äºŒé˜¶å¾®åˆ†ï¼š</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211105114701781.png" alt="image-20211105114701781"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211105115242663.png" alt="image-20211105115242663"></p><h2 id="å½©è‰²å›¾åƒ">å½©è‰²å›¾åƒ</h2><h3 id="é¢œè‰²æ¨¡å‹">é¢œè‰²æ¨¡å‹</h3><p>ä¸‰åŸè‰²æ¯”ä¾‹ç›´æ¥å†³å®šæ··åˆè‰²è°ƒçš„é¥±å’Œåº¦ï¼Œæ··åˆè‰²äº®åº¦ç­‰äºå„åŸè‰²äº®åº¦å’Œ</p><ul><li><p>RGBï¼šç›¸åŠ æ··è‰²æ¨¡å¼ã€‚æ¯ç§é¢œè‰²åˆ†é‡è¶Šå¤šï¼Œå¾—åˆ°çš„é¢œè‰²å°±è¶Šäº®</p></li><li><p>CMYï¼šé’ã€æ´‹çº¢ã€é»„åŠ ä¸Šé»‘è‰² ï¼Œç›¸å‡è‰²ï¼Œå› ä¸ºå®ƒå‡å°‘äº†è§†è§‰ç³»ç»Ÿè¯†åˆ«é¢œè‰²æ‰€éœ€è¦çš„åå°„å…‰ï¼ˆä½œä¸ºRGBçš„äº’è¡¥è‰²å…‰è€Œå­˜åœ¨ï¼Œé€šè¿‡ä»ç™½å…‰ä¸­å‡å»RGBä¸‰åŸè‰²ï¼‰</p></li><li><p>HSIï¼šè‰²è°ƒï¼ˆå…‰æ³¢é¢‘ç‡æœ‰å…³ï¼Œè¡¨ç¤ºäººçš„æ„Ÿå®˜å¯¹ä¸åŒé¢œè‰²çš„æ„Ÿå— ï¼‰é¥±å’Œåº¦ï¼ˆé¢œè‰²çº¯åº¦ï¼ŒåŠ å…¥ç™½å…‰ä¼šç¨€é‡Šé¥±å’Œåº¦ï¼‰ äº®åº¦</p><ul><li>ä½“è‰²è°ƒHç”±è§’åº¦è¡¨ç¤ºï¼Œå®ƒåæ˜ äº†é¢œè‰²æœ€æ¥è¿‘ä»€ä¹ˆæ ·çš„å…‰è°±æ³¢é•¿ï¼Œå³å…‰çš„ä¸åŒé¢œè‰²ã€‚é€šå¸¸å‡å®š0Â°è¡¨ç¤ºçš„é¢œè‰²ä¸ºçº¢è‰²ï¼Œ 120Â°çš„ä¸ºç»¿è‰²ï¼Œ 240Â°çš„ä¸ºè“è‰²ã€‚<br>ä»0Â°åˆ°360Â°çš„è‰²ç›¸è¦†ç›–äº†æ‰€æœ‰å¯è§å…‰è°±çš„å½©è‰²</li><li>é¥±å’Œåº¦Sè¡¨å¾é¢œè‰²çš„æ·±æµ…ç¨‹åº¦ï¼Œé¥±å’Œåº¦è¶Šé«˜ï¼Œé¢œè‰²è¶Šæ·±ã€‚é¥±å’Œåº¦å‚æ•°æ˜¯è‰²ç¯çš„åŸç‚¹ï¼ˆåœ†å¿ƒï¼‰åˆ°å½©è‰²ç‚¹çš„åŠå¾„çš„é•¿åº¦ã€‚åœ¨ç¯çš„è¾¹ç•Œä¸Šçš„é¢œè‰²é¥±å’Œåº¦æœ€é«˜ï¼Œå…¶é¥±å’Œåº¦å€¼ä¸º1ï¼›åœ¨ä¸­å¿ƒçš„é¥±å’Œåº¦ä¸º0ã€‚</li><li>äº®åº¦Iæ˜¯æŒ‡å…‰æ³¢ä½œç”¨äºæ„Ÿå—å™¨æ‰€å‘ç”Ÿçš„æ•ˆåº”ï¼Œå…¶å¤§å°ç”±ç‰©ä½“åå°„ç³»æ•°æ¥å†³å®šï¼Œåå°„ç³»æ•°è¶Šå¤§ï¼Œç‰©ä½“çš„äº®åº¦æ„ˆå¤§ï¼Œåä¹‹æ„ˆå°ã€‚å¦‚æœæŠŠäº®åº¦ä½œä¸ºè‰²ç¯çš„å‚çº¿ï¼Œé‚£ä¹ˆHã€Sã€Iæ„æˆä¸€ä¸ªæŸ±å½¢å½©è‰²ç©ºé—´ã€‚ç°åº¦é˜´å½±æ²¿ç€è½´çº¿è‡ªä¸‹è€Œä¸Šäº®åº¦é€æ¸å¢å¤§ï¼Œç”±åº•éƒ¨çš„é»‘æ¸å˜æˆé¡¶éƒ¨çš„ç™½ã€‚åœ†æŸ±é¡¶éƒ¨çš„åœ†å‘¨ä¸Šçš„é¢œè‰²å…·æœ‰æœ€é«˜äº®åº¦å’Œæœ€å¤§é¥±å’Œåº¦ã€‚</li></ul></li></ul><p>WEBå®‰å…¨è‰²ï¼šwebå®‰å…¨è‰²ï¼Œå°±æ˜¯ç½‘é¡µå®‰å…¨è‰²ã€‚ åå­—è™½ç„¶æœ‰å®‰å…¨ï¼Œä½†æ˜¯å’Œç½‘ç«™çš„å®‰å…¨æ— å…³ã€‚å«è¿™ä¸ªåå­—,æ˜¯å› ä¸ºè¿™äº›è‰²å½©åœ¨ä¸åŒçš„æ˜¾ç¤ºè®¾å¤‡å’Œæ“ä½œç³»ç»Ÿä¸Šè¡¨ç°åŸºæœ¬ä¸€è‡´ã€‚éå®‰å…¨è‰²æ¢ä¸€ä¸ªOSç¯å¢ƒï¼Œé¢œè‰²å°±å¯èƒ½å¤±çœŸã€‚</p><p>å› ä¸ºæˆ‘ä»¬ç”¨çš„å„ç§è®¾å¤‡åŸºæœ¬éƒ½æ˜¯ç”¨RGBæ¨¡å¼è¡¨ç¤ºè‰²å½©ï¼Œç”±Rï¼ˆçº¢ï¼‰ã€Gï¼ˆç»¿ï¼‰ã€Bï¼ˆè“ï¼‰ä¸‰åŸè‰²æ··åˆæˆå„ç§å…¶å®ƒé¢œè‰²ã€‚æŠŠåŸè‰²æŒ‰å…‰å¼ºåˆ’åˆ†è‹¥å¹²è‰²é˜¶ï¼Œå†å„åŸè‰²å–ä¸€ä¸ªè‰²é˜¶æ··åˆå¾—åˆ°å®é™…é¢œè‰²ã€‚ç›®å‰æˆ‘ä»¬çš„PCæŠŠå„ä¸ªåŸºæœ¬è‰²å½©çš„è‰²é˜¶åˆ’åˆ†256é˜¶(00-FF)ï¼ŒRã€Gã€Bæ··åˆå¯å¾—è‰²å½©ä¸º256^3=16777216ç§,å³24ä½çœŸå½©è‰²ã€‚ä½†æ˜¯è¿™24ä½é¢œè‰²ä¸æ˜¯æ‰€æœ‰çš„è®¾å¤‡éƒ½èƒ½æ˜¾ç¤º,æœ‰äº›è®¾å¤‡åªæœ‰256è‰²,æœ‰äº›OSæœ€åå¾—åˆ°çš„é¢œè‰²å’ŒWindowsä¸åŒã€‚å…¶ä¸­æœ‰216ç§é¢œè‰²,åœ¨å‡ ä¹æ‰€æœ‰çš„å½©è‰²ç¯å¢ƒéƒ½èƒ½æ˜¾ç¤º,å°±æ˜¯æ¨èç”¨åœ¨è®¾è®¡ä¸­çš„å®‰å…¨è‰²äº†ã€‚å®ƒçš„æ¥æºå´æ˜¯åœ¨åœ¨256è‰²(8ä½)è€è®¾å¤‡æ—¶ä»£ï¼Œé‚£æ—¶å€™é€‰å®š256ç§é¢œè‰²çš„é€šå¸¸åšæ³•æ˜¯ï¼šåˆ†RGBä¸º6é˜¶å¾—216ç§è‰²å½©ï¼Œå†å¦å¤–é€‰æ‹©40ç§è‰²å½©å‡‘æˆ256è‰²ã€‚216è‰²æ¥è‡ªäºè‰²é˜¶çš„6ç­‰åˆ†,åœ¨å„å‚å•†çš„å®ç°ä¸­éƒ½æ˜¯ä¸€æ ·ï¼Œå…¶å®ƒ40ç§é¢œè‰²ç”±å‚å•†è‡ªå·±é€‰ï¼Œæ‰€ä»¥å„è®¾å¤‡éƒ½ä¸åŒã€‚æˆ‘ä»¬ç°åœ¨çš„256è‰²é˜¶(24ä½)ï¼Œåˆ’åˆ†æ—¶éƒ½åŒ…å«äº†ä»¥å‰çš„216ç§å…¬å…±è‰²ã€‚æŠŠ256åˆ†6ä»½å–16è¿›åˆ¶,å°±æ˜¯ï¼ˆ00ï¼Œ33ï¼Œ66ï¼Œ99ï¼ŒCCï¼ŒFFï¼‰ï¼Œç°åœ¨å–216è‰²å°±æ˜¯å°†è¿™å…­ä¸ªæ•°å­—è¿›è¡Œä»»æ„æ’åˆ—ç»„åˆã€‚å¦‚#0000FFä¸ºçº¯è“ï¼Œåœ¨webè®¾è®¡ä¸­ï¼Œå› ä¸ºå®‰å…¨è‰²éƒ½æ˜¯åŒæ•°ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½æŠŠ6å­—ç¼©å†™æˆ3å­—ï¼Œè¿™æ ·#0000FFå°±æ˜¯#00Fã€‚</p><h3 id="ä¼ªå½©è‰²">ä¼ªå½©è‰²</h3><ul><li>å¯†åº¦åˆ†å±‚ï¼Œç°åº¦çº§ -&gt; å½©è‰²</li><li>ç°åº¦çº§-å½©è‰²å˜æ¢æ³•<ul><li><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211107144418053.png" alt="image-20211107144418053"></li></ul></li><li>é¢‘åŸŸæ»¤æ³¢æ³•<ul><li>è¾“å‡ºçš„å›¾åƒçš„ä¼ªå½©è‰²ä¸ç°åº¦çº§æ— å…‰ï¼Œå–å†³äºç°åº¦å›¾ä¸­ä¸åŒçš„é¢‘ç‡æˆåˆ†</li><li>å¦‚æœä¸ºäº†çªå‡ºå›¾åƒä¸­é«˜é¢‘æˆåˆ†ï¼ˆå³å›¾åƒçš„ç»†èŠ‚ï¼‰è€Œå°†å…¶å˜ä¸ºè“è‰²ï¼Œåˆ™åªéœ€è¦å°†è“é€šé“æ»¤æ³¢å™¨è®¾è®¡æˆé«˜é€šæ»¤æ³¢å™¨ã€‚</li></ul></li></ul><p><strong>RGB-&gt;HSI</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211109093851072.png" alt="image-20211109093851072"></p><p><strong>HSI-&gt;RGB</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211109093902012.png" alt="image-20211109093902012"></p><h2 id="å›¾åƒå‹ç¼©">å›¾åƒå‹ç¼©</h2><p><strong>æœ‰æŸæ— æŸå›¾åƒ</strong></p><p><strong>é©¬èµ«å¸¦æ•ˆåº”</strong></p><p>é©¬èµ«å¸¦æ•ˆåº”ï¼ˆMach band effectï¼‰æ˜¯æŒ‡è§†è§‰çš„<strong>ä¸»è§‚æ„Ÿå—</strong>åœ¨<strong>äº®åº¦æœ‰å˜åŒ–</strong>çš„åœ°æ–¹å‡ºç°<strong>è™šå¹»çš„æ˜äº®æˆ–é»‘æš—çš„æ¡çº¹</strong>ï¼Œé©¬èµ«å¸¦æ•ˆåº”çš„å‡ºç°æ˜¯äººç±»çš„è§†è§‰ç³»ç»Ÿé€ æˆçš„ã€‚<br>ç”Ÿç†å­¦å¯¹é©¬èµ«å¸¦æ•ˆåº”çš„è§£é‡Šæ˜¯ï¼š<strong>äººç±»çš„è§†è§‰ç³»ç»Ÿæœ‰å¢å¼ºè¾¹ç¼˜å¯¹æ¯”åº¦çš„æœºåˆ¶</strong></p><h2 id="å›¾åƒå¹³æ»‘">å›¾åƒå¹³æ»‘</h2><h3 id="å‡å€¼æ»¤æ³¢">å‡å€¼æ»¤æ³¢</h3><h3 id="ä¸­å€¼æ»¤æ³¢">ä¸­å€¼æ»¤æ³¢</h3><h3 id="é«˜é€šæ»¤æ³¢">é«˜é€šæ»¤æ³¢</h3><p><strong>ä¸­å€¼æ»¤æ³¢å’Œå‡å€¼æ»¤æ³¢çš„åŒºåˆ«</strong></p><p>å‡å€¼æ»¤æ³¢ç›¸å½“äºä½é€šæ»¤æ³¢ï¼Œæ˜¯ä¸€ç§çº¿æ€§æ»¤æ³¢å™¨ã€‚æœ‰å°†å›¾åƒæ¨¡ç³ŠåŒ–çš„è¶‹åŠ¿ï¼Œé‡‡ç”¨çº¿æ€§çš„æ–¹æ³•ï¼Œå¹³å‡æ•´ä¸ªçª—å£èŒƒå›´å†…çš„åƒç´ å€¼ã€å¯¹æ¤’ç›å™ªå£°åŸºæœ¬æ— èƒ½ä¸ºåŠ›ã€‚å¯¹é«˜æ–¯å™ªå£°è¡¨ç°è¾ƒå¥½</p><p>ä¸­å€¼æ»¤æ³¢æ˜¯éçº¿æ€§ä½é€šæ»¤æ³¢å™¨ï¼Œä¼˜ç‚¹æ˜¯<strong>å¯ä»¥å¾ˆå¥½çš„è¿‡æ»¤æ‰æ¤’ç›å™ªå£°</strong>ï¼Œç¼ºç‚¹æ˜¯æ˜“é€ æˆå›¾åƒçš„ä¸è¿ç»­æ€§</p><p><strong>æ¤’ç›å™ªå£°</strong></p><p>è„‰å†²å™ªå£°ã€‚éšæœºå‡ºç°çš„ç™½ç‚¹æˆ–è€…é»‘ç‚¹ã€‚æ¤’ç›å™ªå£°çš„æˆå› å¯èƒ½æ˜¯å½±åƒè®¯å·å—åˆ°çªå¦‚å…¶æ¥çš„å¼ºçƒˆå¹²æ‰°è€Œäº§ç”Ÿã€ç±»æ¯”æ•°ä½è½¬æ¢å™¨æˆ–ä½å…ƒä¼ è¾“é”™è¯¯ç­‰ã€‚ä¾‹å¦‚å¤±æ•ˆçš„æ„Ÿåº”å™¨å¯¼è‡´åƒç´ å€¼ä¸ºæœ€å°å€¼ï¼Œé¥±å’Œçš„æ„Ÿåº”å™¨å¯¼è‡´åƒç´ å€¼ä¸ºæœ€å¤§å€¼ã€‚<br>é™¤å»çš„æ–¹å¼æ˜¯ä¸­å€¼æ»¤æ³¢å™¨</p><p><strong>é«˜æ–¯å™ªå£°</strong></p><p>é«˜æ–¯å™ªå£°æ˜¯æŒ‡å®ƒçš„<a href="https://baike.baidu.com/item/%E6%A6%82%E7%8E%87%E5%AF%86%E5%BA%A6%E5%87%BD%E6%95%B0/5021996">æ¦‚ç‡å¯†åº¦å‡½æ•°</a>æœä»<a href="https://baike.baidu.com/item/%E9%AB%98%E6%96%AF%E5%88%86%E5%B8%83/10145793">é«˜æ–¯åˆ†å¸ƒ</a>ï¼ˆå³<a href="https://baike.baidu.com/item/%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83/829892">æ­£æ€åˆ†å¸ƒ</a>ï¼‰çš„ä¸€ç±»å™ªå£°ã€‚å¸¸è§çš„é«˜æ–¯å™ªå£°åŒ…æ‹¬èµ·ä¼å™ªå£°ã€å®‡å®™å™ªå£°ã€çƒ­å™ªå£°å’Œæ•£ç²’å™ªå£°ç­‰ç­‰ã€‚é™¤å¸¸ç”¨æŠ‘åˆ¶å™ªå£°çš„æ–¹æ³•å¤–ï¼Œå¯¹é«˜æ–¯å™ªå£°çš„æŠ‘åˆ¶æ–¹æ³•å¸¸å¸¸é‡‡ç”¨æ•°ç†ç»Ÿè®¡æ–¹æ³•ã€‚</p><p>ç”±äºä¸è‰¯ç…§æ˜å’Œ/æˆ–é«˜æ¸©å¼•èµ·çš„ä¼ æ„Ÿå™¨å™ªå£°ã€‚å¯é€šè¿‡å¹³å‡æ»¤æ³¢ã€ä¸­å€¼æ»¤æ³¢å’Œé«˜æ–¯å¹³æ»‘æ¥æ¶ˆé™¤</p><p><strong>ä¸ºä»€ä¹ˆä¸­å€¼æ»¤æ³¢ç›¸å¯¹å‡å€¼æ»¤æ³¢èƒ½å¾ˆå¥½çš„é™¤å»æ¤’ç›å™ªå£°</strong></p><p>å–ä¸­å€¼ã€‚å¹¶ä¸”å‡å€¼æ»¤æ³¢å®¹æ˜“è®©å›¾åƒå˜å¾—æ¨¡ç³Š</p><p><strong>å¼€è¿ç®—ä¸é—­è¿ç®—</strong></p><p><a href="https://www.cnblogs.com/-wenli/p/11735633.html">https://www.cnblogs.com/-wenli/p/11735633.html</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>IMAGE</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>èŠèŠè¿™ä¸ªå°ç ´ç«™</title>
    <link href="/2021/11/02/%E8%81%8A%E8%81%8A%E8%BF%99%E4%B8%AA%E5%B0%8F%E7%A0%B4%E7%AB%99/"/>
    <url>/2021/11/02/%E8%81%8A%E8%81%8A%E8%BF%99%E4%B8%AA%E5%B0%8F%E7%A0%B4%E7%AB%99/</url>
    
    <content type="html"><![CDATA[<h1>èŠèŠè¿™ä¸ªç«™</h1><h2 id="å’‹æœ‰è¿™ä¸ªæƒ³æ³•ï¼Ÿ">å’‹æœ‰è¿™ä¸ªæƒ³æ³•ï¼Ÿ</h2><p>å…¶å®æœ€å¼€å§‹å»ºç«‹è¿™ä¸ªç«™è¿˜æ˜¯å› ä¸ºå¯¹JavaWebçš„ç—´è¿·ï¼Œé‚£æ—¶å€™ç‰¹åˆ«æƒ³æ­å»ºä¸ªä¸ªäººç½‘ç«™ï¼Œå¤§æ¦‚æ˜¯åœ¨19å¹´æœ«20å¹´åˆçš„æ ·å­ï¼Œç‰¹åˆ«æƒ³è¦æä¸ªè‡ªå·±çš„æœåŠ¡å™¨ï¼Œæ•´ä¸ªè‡ªå·±çš„ä¸ªäººç½‘ç«™ï¼Œ<a href="http://xn--www-i68d52yea459dyo4a7ox.zhaoyunlong.com">ç„¶åæ•´ä¸ªåŸŸåwww.zhaoyunlong.com</a> ï¼Œé‚£å¯å¤ªæ´‹æ°”äº†ã€‚ä¸è¿‡å½“æ—¶å­¦webæ²¡æœ‰å­¦å¤šæ·±ï¼Œä¸çŸ¥é“æ€ä¹ˆå»ºåšå®¢ç½‘ç«™ï¼Œåªè§‰å¾—æ­ä¸ªtomcatå°±å·²ç»å¾ˆç‰›é€¼äº†ã€‚</p><p>åæ¥å¤§äºŒå¶ç„¶é—´çœ‹åˆ°è”åˆ›çš„ä¸€ä½ä¼˜ç§€çš„å­¦é•¿åœ¨ç»„ä¼šåˆ†äº«æ—¶ç”¨äº†è‡ªå·±çš„ç½‘ç«™ï¼Œæˆ‘å°±ç‰¹åˆ«æ¥å…´è¶£ï¼Œå½“æ—¶å°±é—®äº†é—®ä»–æ€ä¹ˆæ­å»ºçš„ï¼Œå½“æ—¶ä»–å°±è¯´äº†ä¸¤ä¸ªè¯ hexoå’Œ githubï¼Œåæ¥å‡­ç€è¿™ä¸¤ä¸ªè¯å°±ç›´æ¥æ”¹å˜äº†æˆ‘ä¹‹åçš„å­¦ä¹ æ¨¡å¼ã€‚æˆ‘å»æœäº†å¾ˆå¤šåšå®¢ï¼Œè¯•ç€å»æ­å»ºäº†åŸºäºgithubçš„hexoåšå®¢ç½‘ç«™ï¼Œå¹¶é…ç½®åˆ°äº†pplong.topã€‚æ„Ÿè§‰ä¸é”™ï¼Œåæ¥é€šè¿‡å›¾åºŠ (-50ï¿¥) å¼•å…¥äº†åœ¨çº¿å›¾ç‰‡ï¼Œèƒ½å¤ŸåŠæ—¶å‘å¸ƒå›¾ç‰‡åœ¨å›¾åºŠä¸Šï¼Œå®ç°äº†åšå®¢çš„å›¾ç‰‡ä¿å­˜æ–¹å¼ï¼Œå†åæ¥æ…¢æ…¢é€šè¿‡ä¸€äº›é…ç½®ï¼Œæäº†çœ‹æ¿å¨˜å’ŒåŠ¨æ€ç‰¹æ•ˆä¹‹ç±»çš„ï¼Œä½†éƒ½æ˜¯åè¯äº†ã€‚</p><p>NexTä¸»é¢˜ä¸€ç›´ä»¥ç®€æ´å’Œå¿«æ·ä¸ºç‰¹ç‚¹ï¼Œæˆ‘ä¹Ÿç”¨äº†è¿™ä¸ªä¸»é¢˜ç”¨äº†å¾ˆä¹…ï¼Œå„ä¸ªæ–¹é¢éƒ½è¿˜ç®—èˆ’å¿ƒã€‚ä¹‹åä¸çŸ¥é“ä¸ºå•¥åˆæƒ³æ¢ä¸»é¢˜äº†ï¼Œè¯•äº†è¯•icarusä¸»é¢˜ï¼ŒæŠ˜è…¾åŠå¤©å¶ç„¶åˆçœ‹åˆ°å®¤å‹çš„Hexoç”¨çš„fluidä¸»é¢˜ï¼Œéå¸¸çš„nice,ä¸»è¦ä»¥å›¾ç‰‡ä¸ºä¸»ï¼Œgalleryå’Œ cover ã€thumbnailç­‰ï¼Œå¢åŠ äº†ä¸€äº›åŠ¨ç”»å…ƒç´ ï¼Œå°±æ˜¯é€¼æ ¼æ¯”nextå¥½äº†ç‚¹ã€‚ç«‹é©¬æ¢ä¸Šï¼Œæ„Ÿè§‰ä¸è¾ï¼Œä¸€äº›ç®€å•çš„é…ç½®ã€æ”¯æŒlatexã€æ”¯æŒå›¾åºŠï¼Œè¿™å°±æ˜¯æˆ‘æƒ³è¦çš„åšå®¢æ­å»ºäº†ã€‚</p><blockquote><p>å…¶å®éš¾çš„ä¸æ˜¯é—®é¢˜æœ¬èº«ï¼Œæ˜¯æˆ‘æ˜¯å¦çœŸæ­£å†³å®šè¦åšè¿™ä»¶äº‹ï¼Œè¦åšå¥½è¿™ä»¶äº‹ã€‚</p></blockquote><p>è¿˜è®°å¾—å½“æ—¶å»ºç«™çš„æ—¶å€™ä¹Ÿæ²¡æƒ³åˆ°è‡ªå·±èƒ½å¤Ÿä¸€ç›´ç»´æŠ¤åˆ°ç°åœ¨ï¼Œå¹¶ä¸”è¿›è¡Œäº†å‡ æ¬¡ä¸»é¢˜æ›´æ¢ï¼Œä¹Ÿæ²¡æœ‰æƒ³åˆ°å½“æ—¶ä»…æœ‰çš„ä¸€ç‰‡Hello-World.mdèƒ½å¤Ÿè¡ç”Ÿå‡ºç°åœ¨è®¸è®¸å¤šå¤šçš„å­¦ä¹ ç¬”è®°ã€‚è·Œè·Œæ’æ’ï¼Œåœ¨å¤§å­¦çš„å‡ å¹´ï¼Œè¿™ä¸ªå°ç ´ç«™ä¹Ÿç®—æ˜¯è§è¯äº†æˆ‘çš„æˆé•¿å§ã€‚æœ‰ä¸€ä¸ªå¥½çš„seedçœŸçš„å¾ˆé‡è¦ï¼Œå½“ç„¶è‡ªå·±ä¹Ÿå¾—æŠŠå¥½çš„æƒ³æ³•ä»˜è¯¸è¡ŒåŠ¨ï¼Œæˆ‘æœ¬æ¥æ˜¯ä¸€ä¸ªå¾ˆæ‡’çš„äººï¼Œå½“æ—¶ä¹Ÿåªæ˜¯ç©ºæœ‰è¿™äº›æƒ³æ³•ï¼Œåªæ˜¯å¹»æƒ³ç€å¦‚æœæˆ‘è¿™æ ·åšäº†ï¼Œé‚£æˆ‘å¯çœŸç‰›é€¼å•Šã€‚ä½†æ˜¯ä¸€ç›´æ²¡æœ‰åšï¼Œå…¶å®ç½‘ä¸Šä¸€æœåˆ°å¤„éƒ½æ˜¯å»ºç«™åšå®¢ï¼Œæ­å»ºhexoåšå®¢çš„æ–¹å¼ä¹Ÿå¾ˆç®€å•ï¼Œç®€å•å‡ æ­¥å°±èƒ½å®Œæˆã€‚æƒ³æ‰¾èµ„æºçš„äººæ°¸è¿œä¸ç¼ºèµ„æºã€‚ä¹Ÿæ˜¯å‘¨å›´å¾ˆä¼˜ç§€çš„äººæä¾›äº†è¿™æ ·çš„ä¾‹å­ï¼Œè®©æˆ‘å°‘èµ°äº†å¼¯è·¯ã€‚æ‰€ä»¥ä¹Ÿè®©æˆ‘æƒ³åˆ°ï¼Œèº«è¾¹æ°¸è¿œä¸ç¼ºä¼˜ç§€çš„äººï¼Œå‘åˆ«äººå¤šå­¦ä¹ ä¸€å®šæ˜¯æœ‰åŠ©è‡ªå·±çš„æˆé•¿çš„ã€‚</p><h2 id="æˆ‘æƒ³å¹²å˜›">æˆ‘æƒ³å¹²å˜›</h2><div class="note note-primary">            <p>è¿™ä¸ªç½‘ç«™ç”¨æ¥è®°å½•è‡ªå·±å­¦ä¹ å„å¤§å·¥å…·ã€ç¼–ç¨‹è¯­è¨€ï¼Œç”šè‡³æ˜¯è€ƒç ”å†…å®¹éƒ½æœ‰è®°å½•ï¼Œæœ‰åŒ…å«å…·ä½“ä½¿ç”¨è¿‡ç¨‹çš„å‚»ç“œè®°å½•ï¼Œä¹Ÿæœ‰å­¦ä¹ è¯­è¨€ã€å†…æ ¸å’Œåº•å±‚çš„é—®é¢˜ï¼Œå­¦ä¹ æ—¶éšæ—¶æƒ³åˆ°çš„é—®é¢˜éƒ½ä¼šè®°å½•ï¼ˆä½†ä¸ä¸€å®šä¼šåŠæ—¶è§£å†³ğŸ˜¢ï¼‰ã€‚å¶å°”ä¹Ÿä¼šè®°å½•ä¸€äº›è‡ªå·±çš„å­¦ä¹ æ„Ÿæ‚Ÿï¼Œå°±å½“åšä¸€ä¸ªå­¦ä¹ çš„é¿é£æ¸¯å§ï¼Œå¸Œæœ›åœ¨è¿™é‡Œç»å¸¸åæ€ã€‚æ¯•ç«Ÿç°åœ¨çš„å­¦ä¹ æ–¹å¼éƒ½å¾ˆåƒç¯‡ä¸€å¾‹</p>          </div><p>å†™äº†å‡ åç¯‡æ€»ç»“åï¼Œè§‰å¾—ç°åœ¨å†™åšå®¢ç¡®å®æ˜¯ä¸€ç§ä¸ä¸€æ ·çš„æ„Ÿå—ï¼Œåæ‚”çš„æ˜¯å½“åˆå­¦Springå’ŒSpringMVCçš„æ—¶å€™å°±å·æ‡’å°±æ²¡å†™ï¼Œå¯¼è‡´åé¢è‡ªå·±ä¹Ÿæ²¡æ·±å…¥ç ”ç©¶åº•å±‚ï¼Œæå¾—æš‘å‡å­¦çš„å…¨éƒ¨éƒ½å¿˜äº†ã€‚å…¶å®è¿˜æ˜¯æ²¡æœ‰è¿‡è„‘å­ï¼Œæ„Ÿè§‰è‡ªå·±å­¦çš„è®¸å¤šéƒ½æ²¡æœ‰è¿‡è„‘å­ï¼Œæœ‰æ—¶å€™è‡ªå·±æ•²å‡ºæ¥åè€Œè¿˜æœ‰åŠ©äºè‡ªå·±è®°å¿†ã€‚è¿˜æ˜¯å­¦çš„ä¸æ·±åˆ»ï¼Œæ²¡æœ‰ç‹¬ç«‹æ€è€ƒï¼Œå¦‚ä½•å­¦ä¼šç‹¬ç«‹æ€è€ƒæ¯”å†™å¥½ä¸€ä¸ªåšå®¢å¾ˆé‡è¦ï¼âœ¨<br>ç°åœ¨å­¦ä¹ å†…æ ¸æ—¶ä¹Ÿè¶Šæ¥è¶Šä½“ä¼šåˆ°å†™åšå®¢çš„å¥½å¤„ï¼Œæœ‰æ—¶å€™çªç„¶æƒ³åˆ°æŸä¸€ä¸ªé—®é¢˜ï¼Œèƒ½å¤Ÿç«‹é©¬åœ¨å¦ä¸€ä¸ªæ¨¡å—ä¸‹è®°å½•ä¸‹æ¥ï¼Œåœ¨è‡ªå·±æœ‰ç©ºçš„æ—¶å€™èƒ½å¤Ÿé›†ä¸­å¤„ç†ä¸€ä¸‹.æœ‰æ—¶å€™è‡ªå·±æƒ³çš„é—®é¢˜å¾ˆè ¢ä¹Ÿå¾ˆæœ‰è¶£ï¼Œç°åœ¨å›è¿‡å¤´æ¥çœ‹ï¼Œç¡®å®æ¯”å½“åˆæƒ³æƒ³ï¼šä¸‹æ¬¡é‡åˆ°è¿™ä¸ªé—®é¢˜æ—¶å†å¤„ç†å¥½å¤šäº†ã€‚</p><h2 id="ä¸€äº›å¸Œæœ›">ä¸€äº›å¸Œæœ›</h2><ul><li>å¸Œæœ›è‡ªå·±èƒ½å¤Ÿä¸€ç›´ä¿æŒå¯¹æŠ€æœ¯çš„çƒ­çˆ±</li><li>å¸Œæœ›è¿™ä¸ªå°ç ´ç«™èƒ½å¤Ÿè¿è¡Œ20å¹´</li><li>å¸Œæœ›ä¿æŒç‹¬ç«‹æ€è€ƒçš„è„‘å­ï¼Œå¸¸æ€è€ƒã€å¸¸åæ€</li></ul><p>ä¸ºè€…å¸¸æˆï¼Œè¡Œè€…å¸¸è‡³ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>Life</tag>
      
      <tag>Thought</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>èŠèŠæœ€è¿‘å­¦ä¹ çš„æ„Ÿå—</title>
    <link href="/2021/11/02/%E8%81%8A%E8%81%8A%E6%9C%80%E8%BF%91%E5%AD%A6%E4%B9%A0%E7%9A%84%E6%84%9F%E5%8F%97/"/>
    <url>/2021/11/02/%E8%81%8A%E8%81%8A%E6%9C%80%E8%BF%91%E5%AD%A6%E4%B9%A0%E7%9A%84%E6%84%9F%E5%8F%97/</url>
    
    <content type="html"><![CDATA[<h1>èŠèŠæœ€è¿‘</h1><p>è¶ç€æœ€è¿‘å¯¹Linuxçš„åŠ²ï¼Œè¿™å‡ å¤©è¶ç€åŒåä¸€ä¹°äº†äº›ä¹¦ï¼Œåå‘å†…æ ¸ç³»ã€‚ç°åœ¨æƒ³æƒ³çœŸçš„æ˜¯æŒºåæ‚”çš„ï¼Œå½“æ—¶å­¦ä¹ æ•°æ®ç»“æ„æ²¡æœ‰å¤ªè®¤çœŸçš„å­¦ä¹ ï¼Œå¯¼è‡´åæ¥çœ‹ä¸€äº›æ•°æ®ç»“æ„éƒ½ä¼šæƒ³åŠå¤©ï¼Œç°åœ¨æƒ³çœ‹Linuxå†…æ ¸ï¼Œå‘ç°æ“ä½œç³»ç»Ÿåˆæ²¡æœ‰å­¦ä¹ å¥½ï¼Œå¯¼è‡´ä¸€äº›åœ°æ–¹éœ€è¦åå¤è¯¢è¯ï¼ŒèŠ±äº†äº›æ—¶é—´ã€‚æˆ‘åœ¨æƒ³ï¼Œä¸ºå•¥å½“æ—¶å°±æ²¡æœ‰è¿™ç§å…´è¶£å»å­¦ä¹ å‘¢ï¼Ÿæ˜æ˜å¾ˆé‡è¦ï¼Œæ˜æ˜å°±ä¸å¯¹åº•å±‚åŸç†çš„ç†è§£æœ‰å¾ˆå¤§å¸®åŠ©ï¼Œä¸ºå•¥å½“æ—¶å°±ä¸å¥½å¥½å­¦å‘¢ï¼Ÿ</p><hr><p>ç°åœ¨æƒ³äº†æƒ³ï¼Œæ„Ÿè§‰è¿˜æ˜¯å½“æ—¶æ²¡æœ‰å…´è¶£å’Œè¢«ä¸€äº›æ‚ä¸ƒæ‚å…«çš„æŠ€æœ¯æ€§çš„ä¸œè¥¿å¸å¼•ä½äº†ã€‚å½“æ—¶ä¼¼ä¹è¿˜æ­£å¼å¼€å§‹ä½¿ç”¨Linuxï¼Œç†è§£è¿˜åœç•™åœ¨Winçš„æ“ä½œç³»ç»Ÿå±‚é¢ã€‚é‚£æˆ‘åˆè½¬è¿‡æ¥æƒ³ï¼Œä¸ºä»€ä¹ˆç°åœ¨å¯¹Linuxå’Œè®¡ç»„è¿™ä¹ˆæ„Ÿå…´è¶£å‘¢ï¼Ÿæ„Ÿè§‰è¿™å‡ å¤©ä¸´è¿‘è€ƒè¯•äº†ï¼Œä½†æ˜¯è‡ªå·±è¿˜æ˜¯æè¿™ä¸€ä¸ªåŠ²çš„çœ‹Linuxå†…æ ¸æºç ï¼ˆä¸»è¦çœ‹çš„è¿˜ä¸æ˜¯éš¾çš„ï¼Œçœ‹åŸºç¡€çš„éƒ½æè¿™ä¸€ä¸ªåŠ²çš„çœ‹ï¼ŒçœŸæœäº†éƒ½â€¦ï¼‰æˆ‘æƒ³ä¸ºå•¥çªç„¶å¯¹Linuxè¿™ä¹ˆæ„Ÿå…´è¶£å‘¢ï¼Ÿæœ¬æ¥ä»¥å‰è¿˜æ˜¯æŒºæ‹’ç»çš„ï¼Œæ¯”å¦‚å•¥ls cp mv æ•²é”®ç›˜ä¸éº»çƒ¦å—ï¼Ÿæˆ‘UIä¸Šéšä¾¿å¦¥å¦¥æ‹½æ‹½å°±OKäº†ï¼Œè¿˜æœ‰å®‰ä¸ªæ–‡ä»¶ï¼Œè¿˜è¦å•¥make make installï¼Œæˆ‘windowsç›´æ¥ä¸€ä¸ªexeç›´æ¥æå®šå•Šã€‚ä¸ºå•¥å‘¢ï¼Ÿè¿™å‡ å¤©æˆ‘æ…¢æ…¢æƒ³äº†æƒ³</p>]]></content>
    
    
    
    <tags>
      
      <tag>Life</tag>
      
      <tag>Thought</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linuxæ–‡ä»¶ç³»ç»Ÿç†è§£</title>
    <link href="/2021/11/01/Linux%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%90%86%E8%A7%A3/"/>
    <url>/2021/11/01/Linux%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%90%86%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<h1>fsæ˜¯å•¥ï¼Ÿæ–‡ä»¶ç³»ç»Ÿï¼Ÿ</h1><blockquote><p>ä¸€ç›´ä¸æ‡‚make rootfs fsæ˜¯å•¥ï¼ŒLinuxæ–‡ä»¶ç³»ç»Ÿæ€ä¹ˆå­˜å‚¨ï¼Œçœ‹äº†ä¸‹åšå®¢æŠ„äº†ä¸€äº›è¯</p></blockquote><h2 id="æ–‡ä»¶ç³»ç»Ÿ-v2">æ–‡ä»¶ç³»ç»Ÿ</h2><h3 id="æ–‡ä»¶ç³»ç»Ÿçš„åŸºæœ¬ç»„æˆ"><strong>æ–‡ä»¶ç³»ç»Ÿçš„åŸºæœ¬ç»„æˆ</strong></h3><p>æ–‡ä»¶ç³»ç»Ÿæ˜¯æ“ä½œç³»ç»Ÿä¸­è´Ÿè´£ç®¡ç†æŒä¹…æ•°æ®çš„å­ç³»ç»Ÿï¼Œè¯´ç®€å•ç‚¹ï¼Œå°±æ˜¯è´Ÿè´£æŠŠç”¨æˆ·çš„æ–‡ä»¶å­˜åˆ°ç£ç›˜ç¡¬ä»¶ä¸­ï¼Œå› ä¸ºå³ä½¿è®¡ç®—æœºæ–­ç”µäº†ï¼Œç£ç›˜é‡Œçš„æ•°æ®å¹¶ä¸ä¼šä¸¢å¤±ï¼Œæ‰€ä»¥å¯ä»¥æŒä¹…åŒ–çš„ä¿å­˜æ–‡ä»¶ã€‚<br>æ–‡ä»¶ç³»ç»Ÿçš„åŸºæœ¬æ•°æ®å•ä½æ˜¯æ–‡ä»¶ï¼Œå®ƒçš„ç›®çš„æ˜¯å¯¹ç£ç›˜ä¸Šçš„æ–‡ä»¶è¿›è¡Œç»„ç»‡ç®¡ç†ï¼Œé‚£ç»„ç»‡çš„æ–¹å¼ä¸åŒï¼Œå°±ä¼šå½¢æˆä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿã€‚<br>Linux æœ€ç»å…¸çš„ä¸€å¥è¯æ˜¯ï¼šã€Œä¸€åˆ‡çš†æ–‡ä»¶ã€ï¼Œä¸ä»…æ™®é€šçš„æ–‡ä»¶å’Œç›®å½•ï¼Œå°±è¿å—è®¾å¤‡ã€ç®¡é“ã€socket ç­‰ï¼Œä¹Ÿéƒ½æ˜¯ç»Ÿä¸€äº¤ç»™æ–‡ä»¶ç³»ç»Ÿç®¡ç†çš„ã€‚</p><p>Linuxæ–‡ä»¶ç³»ç»Ÿå›å‘³æ¯ä¸ªæ–‡ä»¶åˆ†é…ä¸¤ä¸ªæ•°æ®ç»“æ„ï¼š ç´¢å¼•èŠ‚ç‚¹å’Œç›®å½•é¡¹ï¼Œè®°å½•æ–‡ä»¶çš„åŸä¿¡æ¯å’Œç›®å½•å±‚æ¬¡ç»“æ„</p><ul><li>ç´¢å¼•èŠ‚ç‚¹ï¼šindex node â€“ inode ã€‚è®°å½•æ–‡ä»¶çš„å…ƒä¿¡æ¯ã€æ–‡ä»¶å¤§å°ã€è®¿é—®æƒé™ã€åˆ›å»ºæ—¶é—´ã€ä¿®æ”¹æ—¶é—´ã€<strong>æ•°æ®åœ¨ç£ç›˜çš„ä¸­çš„ä½ç½®</strong>â€¦æ˜¯æ–‡ä»¶çš„å”¯ä¸€æ ‡è¯†ï¼Œä¸€ä¸€å¯¹åº”ï¼Œ<strong>å ç”¨ç£ç›˜ç©ºé—´</strong>ã€‚ä¸ºåŠ é€Ÿæ–‡ä»¶çš„è®¿é—®ï¼Œé€šå¸¸ä¼šæŠŠç´¢å¼•èŠ‚ç‚¹åŠ è½½åˆ°å†…å­˜ä¸­</li><li>ç›®å½•é¡¹ï¼š directory entry â€“ dentryï¼Œè®°å½•<strong>æ–‡ä»¶çš„åå­—</strong>ã€<strong>ç´¢å¼•èŠ‚ç‚¹æŒ‡é’ˆ</strong>å’Œå…¶ä»–ç›®å½•é¡¹çš„å±‚çº§å…³ç³»ï¼Œ<strong>å¤šä¸ªç›®å½•é¡¹å…³è”å°±ä¼šå½¢æˆç›®å½•ç»“æ„</strong>ï¼Œä½†ä¸ç´¢å¼•èŠ‚ç‚¹ä¸åŒï¼Œç›®å½•é¡¹æ˜¯<strong>å†…æ ¸ç»´æŠ¤çš„ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œä¸å­˜æ”¾åœ¨ç£ç›˜ï¼Œè€Œæ˜¯åœ¨å†…å­˜ä¸­</strong></li></ul><p>ç›®å½•é¡¹å’Œç´¢å¼•é¡¹çš„å…³ç³»æ˜¯å¤šå¯¹ä¸€<br>ç›®å½•ä¹Ÿæ˜¯æ–‡ä»¶ï¼Œç”¨ç´¢å¼•èŠ‚ç‚¹å”¯ä¸€è¡¨ç¤ºï¼Œä½†åœ¨ç£ç›˜é‡Œä¿å­˜å­ç›®å½•æˆ–è€…æ–‡ä»¶ï¼›è€Œæ™®é€šæ–‡ä»¶åœ¨ç£ç›˜ç¦»ä¿å­˜çš„æ˜¯æ–‡ä»¶æ•°æ®</p><div class="note note-success">            <p>ç›®å½•é¡¹ != ç›®å½•</p><p>ç›®å½•æ˜¯æ–‡ä»¶ï¼ŒæŒä¹…åŒ–åœ¨ç£ç›˜ä¸­ï¼Œç›®å½•é¡¹æ˜¯å†…æ ¸çš„æ•°æ®ç»“æ„ï¼Œç¼“å­˜åœ¨å†…å­˜ä¸­<br>æŸ¥è¯¢ç›®å½•é¢‘ç¹ä»ç£ç›˜è¯» -&gt;æ•ˆç‡ä½-&gt;å†…æ ¸æŠŠå·²ç»åº¦è¿‡çš„ç›®å½•ç”¨ç›®å½•é¡¹æ•°æ®ç»“æ„ç¼“å­˜åœ¨å†…å­˜ä¸­ï¼Œæé«˜fsçš„æ•ˆç‡</p>          </div><h3 id="æ–‡ä»¶æ•°æ®å¦‚ä½•å­˜åœ¨ç£ç›˜ä¸­ï¼Ÿ">æ–‡ä»¶æ•°æ®å¦‚ä½•å­˜åœ¨ç£ç›˜ä¸­ï¼Ÿ</h3><p>ç£ç›˜è¯»æœ€å°å•ä½æ˜¯æ‰‡åŒº â€”512B ï¼Œå¦‚æœæ¯æ¬¡éƒ½å†™è¿™ä¹ˆå°çš„å•ä½ï¼Œåˆ™æ•ˆç‡å¾ˆä½<br>æ‰€ä»¥fsæŠŠå¤šä¸ªæ‰‡åŒºç»„æˆä¸€ä¸ªé€»è¾‘å¿«ï¼Œæ¯æ¬¡è¯»å†™çš„æœ€å°å•ä½å°±æ˜¯é€»è¾‘å—ï¼ˆæ•°æ®å—ï¼‰ã€‚Linuxä¸­é€»è¾‘å—å¤§å°ä¸º4KB,æé«˜äº†ç£ç›˜è¯»å†™æ•ˆç‡</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211101145853363.png" alt="image-20211101145853363"></p><p>ç£ç›˜æ ¼å¼åŒ–æ—¶ï¼Œåˆ†æˆä¸‰ä¸ªå­˜å‚¨åŒºåŸŸï¼š</p><ul><li>è¶…çº§å—ï¼Œå­˜å‚¨fsçš„è¯¦ç»†ä¿¡æ¯ï¼Œå—ä¸ªæ•°ã€å—å¤§å°ã€ç©ºé—²å—ã€‚fsæŒ‚è½½æ—¶åŠ è½½åˆ°å†…å­˜</li><li>ç´¢å¼•èŠ‚ç‚¹åŒºï¼šå­˜å‚¨ç´¢å¼•èŠ‚ç‚¹ã€‚æ–‡ä»¶è¢«è®¿é—®æ—¶åŠ è½½åˆ°å†…å­˜ä¸­</li><li>æ•°æ®å—åŒºï¼šå­˜å‚¨æ–‡ä»¶æˆ–è€…ç›®å½•æ•°æ®</li></ul><h3 id="VFS">VFS</h3><p>å‰æï¼šfsç±»å‹ å¤šï¼Œoså¸Œæœ›å¯¹ç”¨æˆ·æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ï¼Œä¸€ä¸ªä»£ç†äººã€‚â€œæ²¡æœ‰ä»€ä¹ˆé—®é¢˜æ˜¯åŠ ä¸€å±‚è§£å†³ä¸äº†çš„â€ã€‚äºæ˜¯ç”¨æˆ·å±‚ä¸oså±‚ä¹‹é—´å°±åŠ äº†ä¸€å±‚ï¼Œå«<strong>è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ VFS</strong></p><p>VFSå®šä¹‰äº†ä¸€ç»„æ‰€æœ‰fséƒ½æ”¯æŒçš„æ•°æ®ç»“æ„å’Œæ ‡å‡†æ¥å£ï¼Œç¨‹åºå‘˜ä¸éœ€è¦äº†è§£æ‰€æ¬²æ–‡ä»¶ç³»ç»Ÿçš„å·¥ä½œåŸç†ï¼Œåªéœ€è¦çŸ¥é“VFSæä¾›çš„APIå°±è¡Œ</p><p>åˆæƒ³åˆ°äº†ä»Šå¤©è¯»å†…æ ¸çš„è®¾è®¡å’Œå®ç°ä¸­çš„è¯</p><blockquote><p>â€œæä¾›æœºåˆ¶ï¼Œè€Œä¸æ˜¯ç­–ç•¥ã€‚â€</p></blockquote><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211101150611713.png" alt="image-20211101150611713"></p><p>æ ¹æ®å­˜å‚¨ä½ç½®ä¸åŒï¼Œfså¯åˆ†ä¸ºä¸‰ç±»ï¼š</p><ul><li>ç£ç›˜çš„fsï¼Œæ•°æ®ç›´æ¥å­˜å‚¨åœ¨ç£ç›˜ä¸­ ä¾‹å¦‚Ext2/3/4ã€XFS</li><li>å†…å­˜çš„fsï¼Œæ•°æ®ä¸å­˜åœ¨ç£ç›˜ï¼Œè€Œæ˜¯åœ¨å†…å­˜ä¹‹ä¸Š /proc å’Œ/sysçš„fséƒ½å±äºè¿™ä¸€ç±»ï¼Œè¯»å†™è¿™ç±»æ–‡ä»¶ï¼Œå®é™…ä¸Šæ˜¯è¯»å†™å†…æ ¸ä¸­å…ˆå…³çš„æ•°æ®</li><li>ç½‘ç»œfsï¼Œç”¨æ¥è®¿é—®å…¶ä»–è®¡ç®—æœºä¸»æœºæ•°æ®çš„æ–‡ä»¶ç³»ç»Ÿï¼Œæ¯”å¦‚NFSã€SMBç­‰</li></ul><p><strong>fsé¦–å…ˆè¦æŒ‚åœ¨åˆ°æŸä¸ªç›®å½•æ‰èƒ½æ­£å¸¸ä½¿ç”¨ï¼Œæ¯”å¦‚Linuxåœ¨å¯åŠ¨æ—¶ä¼šæŠŠç³»ç»Ÿæ–‡ä»¶æŒ‚åœ¨åˆ°æ ¹ç›®å½•</strong></p><h3 id="æ–‡ä»¶æè¿°ç¬¦">æ–‡ä»¶æè¿°ç¬¦</h3><p>æ„Ÿè§‰æœ‰ç‚¹åƒpcb/task_structä¸€æ ·çš„ä¸œè¥¿</p><p>osä¼šè·Ÿè¸ªè¿›ç¨‹æ‰“å¼€çš„æ‰€æœ‰æ–‡ä»¶ï¼Œosä½<strong>æ¯ä¸ªè¿›ç¨‹</strong>ç»´æŠ¤ä¸€ä¸ªæ‰“å¼€æ–‡ä»¶è¡¨ï¼Œæ–‡ä»¶è¡¨ç¦»çš„æ¯ä¸€é¡¹éƒ½æ˜¯æ–‡ä»¶æè¿°ç¬¦</p><p>$$è¿›ç¨‹ \xrightarrow{1 \space \space n}æ–‡ä»¶è¡¨\xrightarrow{1 \space \space n}æ–‡ä»¶æè¿°ç¬¦ $$</p><blockquote><p>è¿™é‡Œæˆ‘è¿˜æ²¡å­¦åˆ°Linuxå†…æ ¸å±‚é¢çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œä¼°è®¡ä»¥åä¼šçœ‹åˆ°ï¼Œå…ˆæ’ä¸ªçœ¼</p></blockquote><p>åŒ…å«æ–‡ä»¶æŒ‡é’ˆã€<strong>æ–‡ä»¶æ‰“å¼€è®¡æ•°å™¨</strong>ã€æ–‡ä»¶ç£ç›˜ä½ç½®ã€è®¿é—®æƒé™â€¦</p><p>fsåŸºæœ¬æ“ä½œå•ä½æ˜¯æ•°æ®å—</p><h3 id="æ–‡ä»¶çš„å­˜å‚¨æ–¹å¼">æ–‡ä»¶çš„å­˜å‚¨æ–¹å¼</h3><h4 id="è¿ç»­ç©ºé—´å­˜æ”¾">è¿ç»­ç©ºé—´å­˜æ”¾</h4><p>æ–‡ä»¶çš„æ•°æ®è¿ç»­å‘å­˜æ”¾åœ¨ç£ç›˜ä¸­ï¼Œç´§å¯†ç›¸è”ï¼Œè¯»å–æ•°æ®æ•ˆç‡é«˜ï¼ˆä¸å› ä¸ºä¸€æ¬¡ç£ç›˜å¯»é“å°±å¯ä»¥è¯»å‡ºæ•´ä¸ªæ–‡ä»¶ï¼‰</p><p>å‰æï¼šå¿…é¡»çŸ¥é“ä¸€ä¸ªæ–‡ä»¶çš„å¤§å°ï¼Œè¿™æ ·fsæ‰ä¼šæ ¹æ®æ–‡ä»¶çš„é˜¿æ™“åœ¨ç£ç›˜ä¸Šæ‰¾åˆ°ä¸€å—è¿ç»­çš„ç©ºé—´åˆ†é…ç»™æ–‡ä»¶ã€‚æ–‡ä»¶å¤´éœ€è¦æŒ‡å®šèµ·å§‹å—ä½ç½®å’Œé•¿åº¦ã€‚</p><p><strong>ä½†æ˜¯ï¼Œæ–‡ä»¶å¦‚ä½•æ‰©å®¹ï¼Ÿï¼Ÿï¼Ÿ</strong></p><p>é—®é¢˜ï¼š<strong>å¯¼è‡´ç£ç›˜ç©ºé—´ç¢ç‰‡</strong>å’Œ<strong>æ–‡ä»¶é•¿åº¦ä¸æ˜“æ‰©å±•</strong>ï¼ˆæœ‰JVMåƒåœ¾æ¸…ç†å†…å‘³äº†ï¼‰</p><h4 id="éè¿ç»­ç©ºé—´å­˜æ”¾">éè¿ç»­ç©ºé—´å­˜æ”¾</h4><ol><li><p>é“¾è¡¨æ–¹å¼</p><p>ç¦»æ•£çš„ã€ä¸è¿ç»­çš„ -&gt; æ¶ˆé™¤äº†ç£ç›˜ç¢ç‰‡ä¸”æ–‡ä»¶é•¿åº¦å¯åŠ¨æ€æ‰©å±•</p><ol><li><p>éšå¼é“¾è¡¨</p><p>æ–‡ä»¶å¤´åŒ…å«ç¬¬ä¸€å—å’Œæœ€åä¸€å—çš„ä½ç½®ï¼Œæ¯ä¸ªæ•°æ®å—éƒ½æœ‰ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€å—çš„ä½ç½®ï¼ˆåˆç†ï¼‰</p><p>é—®é¢˜ï¼š</p><ul><li>æ— æ³•ç›´æ¥è®¿é—®æ•°æ®å—ï¼Œåªèƒ½é€šè¿‡æŒ‡é’ˆé¡ºåºè®¿é—®ï¼Œä¸èƒ½æ ¹æ®ç´¢å¼•ç›´æ¥è®¿é—®ï¼ˆé“¾è¡¨æœ¬èº«å°±å­˜åœ¨çš„é—®é¢˜ï¼Œå¦‚æœä½ åªå‘è¯»ä¸€ä¸ªæ–‡ä»¶çš„ä¸€ç‚¹å†…å®¹ï¼Œé‚£å¿…é¡»è¦æŠŠå®ƒä¹‹å‰çš„å†…å®¹éƒ½è¿‡ä¸€éï¼‰</li><li>æ•°æ®å—æŒ‡é’ˆæ¶ˆè€—äº†ä¸€å®šçš„ç©ºé—´åˆ†é…idç¨³å®šæ€§äº¤å‰ï¼Œå¯èƒ½å¯¼è‡´é“¾è¡¨ä¸­çš„æŒ‡é’ˆä¸¢å¤±è€Œå¯¼è‡´æ–‡ä»¶æ•°æ®ä¸¢å¤±(???)</li></ul></li><li><p>æ˜¾ç¤ºé“¾æ¥</p><p>æŠŠç”¨äºè¿æ¥æ–‡ä»¶å„ä¸ªæ•°æ®å—çš„æŒ‡é’ˆï¼Œæ˜¾ç¤ºçš„å­˜æ”¾åœ¨å†…å­˜çš„ä¸€å¼ é“¾è¡¨ï¼ˆ<strong>æ–‡ä»¶åˆ†é…è¡¨ â€“ File Allocation Table FAT</strong>ï¼‰é‡Œï¼Œè¯¥è¡¨åœ¨æ•´ä¸ªç£ç›˜ä¸­ä»…è®¾ç½®ä¸€å¼ ï¼Œæ¯ä¸ªè¡¨é¡¹å­˜æ”¾è¿æ¥æŒ‡é’ˆï¼ŒæŒ‡å‘ä¸‹ä¸€ä¸ªæ•°æ®å—å·ï¼ˆç£ç›˜ä¸­è¿™ä¹ˆå¤šæ–‡ä»¶å•Šï¼Ÿæ˜¯å¦æ•°æ®é‡è¿‡å¤§ï¼Ÿè¿˜æ˜¯è¯´æ˜¯åŠ¨æ€åŠ è½½ç±»å‹ï¼Ÿï¼‰</p><p><strong>ä¸å¤ªæ‡‚æ˜¯æ€ä¹ˆå­˜çš„ï¼Œæ¯ä¸€ä¸ªå—éƒ½è¦åœ¨è¡¨ä¸­æœ‰è®°å½•ï¼Ÿè¿™ç§æ–¹å¼ä¸‹ï¼Œä¸€ä¸ªæ•°æ®å—åªèƒ½åˆ†é…ç»™ä¸€ä¸ªæ–‡ä»¶å—ï¼Œæ„Ÿè§‰ä¸åˆç†å•Šï¼Ÿï¼Ÿï¼Ÿ</strong></p><p>ï¼ˆç­”ï¼šç ´æ¡ˆäº†å®¶äººä»¬ï¼Œ<strong>ä¸€ä¸ªé€»è¾‘å—åªèƒ½å­˜æ”¾ä¸€ä¸ªæ–‡ä»¶å†…å®¹ï¼Œæ— è®ºè¿™ä¸ªæœ‰å¤šå°</strong>ï¼Œæš‚æ—¶å¯¹ext2æ¥è¯´æ˜¯çš„ï¼Œå¯ä»¥é€šè¿‡stat filenameæ¥æŸ¥çœ‹ï¼‰</p><p>ç‰¹ç‚¹ï¼š</p><ul><li>æŸ¥æ‰¾è¿‡ç¨‹åœ¨å†…å­˜ä¸­è¿›è¡Œï¼Œé€Ÿåº¦å¿«ï¼Œå‡å°‘äº†ç£ç›˜IO</li><li>ç¼ºç‚¹ï¼šä¸é€‚ç”¨äºå¤§ç£ç›˜â€”&gt; åŸºäºå†…å­˜</li></ul></li></ol></li><li><p>ç´¢å¼•æ–¹å¼</p><p>é“¾è¡¨ä¸èƒ½ç›´æ¥æœ‰æ•ˆçš„è®¿é—®</p><p><strong>ä¸ºæ¯ä¸ªæ–‡ä»¶</strong>åˆ›å»ºäº†ä¸€ä¸ª<strong>ç´¢å¼•æ•°æ®å—</strong>ï¼Œé‡Œé¢å­˜æ”¾çš„æ˜¯æŒ‡å‘æ–‡ä»¶æ•°æ®å—çš„<strong>åˆ—è¡¨æŒ‡é’ˆ</strong></p><p>æ–‡ä»¶å¤´éœ€è¦åŒ…å«æŒ‡å‘ç´¢å¼•æ•°æ®å—çš„æŒ‡é’ˆ</p><ul><li>æ–‡ä»¶çš„åˆ›å»ºã€å¢ç¼©æ–¹ä¾¿</li><li>ä¸ä¼šæœ‰ç¢ç‰‡é—®é¢˜</li><li>æ”¯æŒé¡ºåºè¯»å†™å’Œéšæœºè¯»å†™</li></ul><p>é—®é¢˜ï¼š</p><ul><li>å­˜åœ¨ç£ç›˜ä¸­ï¼Œé¢å¤–çš„å¼€é”€</li></ul><p>å¦‚æœä¸€ä¸ªæ–‡ä»¶å¾ˆå¤§ï¼Œä»¥è‡³äºä¸€ä¸ªæ•°æ®å—æ”¾ä¸ä¸‹ç´¢å¼•ä¿¡æ¯ï¼Œé‚£è¦å¦‚ä½•å¤„ç†å¤§æ–‡ä»¶çš„å­˜æ”¾ï¼Ÿ â€” ç»„åˆæ–¹å¼</p><p><strong>é“¾å¼ç´¢å¼•å—</strong></p><p>åœ¨ç´¢å¼•æ•°æ®å—ä¸­æµå‡ºä¸€ä¸ªå­˜æ”¾ä¸‹ä¸€ä¸ªç´¢å¼•æ•°æ®å—çš„æŒ‡é’ˆï¼Œå½“è¿™ä¸ªç´¢å¼•æ•°æ®å—çš„ä¿¡æ¯ç”¨å®Œäº†ï¼Œå°±å¯ä»¥æ‰¾åˆ°ä¸‹ä¸€ä¸ªç´¢å¼•æ•°æ®å—çš„ä¿¡æ¯ã€‚ä½†ä¹Ÿå­˜åœ¨ä¹‹å‰é“¾è¡¨çš„é—®é¢˜ï¼ŒæŒ‡é’ˆæŸåä¼šå¯¼è‡´åé¢çš„æ•°æ®é”™è¯¯</p><p><strong>å¤šçº§ç´¢å¼•å—</strong></p><p>ç´¢å¼•+ç´¢å¼•ï¼Œé€šè¿‡ä¸€ä¸ªç´¢å¼•å—æ¥æ”¾å¤šä¸ªç´¢å¼•æ•°æ®å—</p><p><img src="/home/pplong/.config/Typora/typora-user-images/image-20211101154444120.png" alt="image-20211101154444120"></p></li></ol><p><strong>æ—©æœŸUnixçš„fs</strong></p><p>æ ¹æ®æ–‡ä»¶æ‰€éœ€çš„æ•°æ®å—æ•°ç›®é˜ˆå€¼ï¼Œé€šè¿‡ä¸åŒæ–¹å¼å­˜æ”¾ã€‚<br>æ–‡ä»¶å¤´åˆ™å¯èƒ½åŒ…å« 10ã€11ã€12ã€13ä¸ªæŒ‡é’ˆ</p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL3hpYW9saW5jb2Rlci9JbWFnZUhvc3QvJUU2JTkzJThEJUU0JUJEJTlDJUU3JUIzJUJCJUU3JUJCJTlGLyVFNiU5NiU4NyVFNCVCQiVCNiVFNyVCMyVCQiVFNyVCQiU5Ri9Vbml4JTIwJUU1JUE0JTlBJUU3JUJBJUE3JUU3JUI0JUEyJUU1JUJDJTk1LnBuZw?x-oss-process=image/format,png" alt=""></p><h3 id="ç©ºé—²ç©ºé—´ç®¡ç†">ç©ºé—²ç©ºé—´ç®¡ç†</h3><p>è¦å­˜ä¸€ä¸ªæ•°æ®å—ï¼Œåˆ™æ”¾åœ¨ç£ç›˜ä¸Šçš„å“ªä¸ªä½ç½®ï¼Ÿ</p><h4 id="ç©ºé—²è¡¨æ³•">ç©ºé—²è¡¨æ³•</h4><p>ä¸ºæ‰€æœ‰ç©ºé—´å»ºç«‹ä¸€å¼ è¡¨ï¼Œå†…å®¹åŒ…æ‹¬ç©ºé—²å»çš„ç¬¬ä¸€ä¸ªå—å·å’Œç©ºé—²åŒºçš„å—çš„ä¸ªæ•°ï¼ˆè¿ç»­åˆ†é…æ–¹å¼ï¼‰</p><p>è¿™ç§æ–¹æ³•ä»…å½“æœ‰å°‘é‡çš„ç©ºé—²åŒºæ—¶æ‰æœ‰è¾ƒå¥½çš„æ•ˆæœã€‚å› ä¸ºï¼Œå¦‚æœå­˜å‚¨ç©ºé—´ä¸­æœ‰ç€å¤§é‡çš„å°çš„ç©ºé—²åŒºï¼Œåˆ™ç©ºé—²è¡¨å˜å¾—å¾ˆå¤§ï¼Œè¿™æ ·æŸ¥è¯¢æ•ˆç‡ä¼šå¾ˆä½ã€‚å¦å¤–ï¼Œè¿™ç§åˆ†é…æŠ€æœ¯é€‚ç”¨äºå»ºç«‹è¿ç»­æ–‡ä»¶ã€‚</p><h4 id="ç©ºé—²é“¾è¡¨æ³•">ç©ºé—²é“¾è¡¨æ³•</h4><p>ç©ºé—²å—ä¸­æœ‰æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªç©ºé—²å—ã€‚åªéœ€è¦åœ¨ä¸»å­˜ä¸­ä¿å­˜ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ç¬¬ä¸€ä¸ªç©ºé—²å—</p><p>ç®€å•ï¼Œä½†ä¸èƒ½éšæœºè®¿é—®ï¼Œæ•ˆç‡ä½ï¼ŒIOå¤šï¼Œä¸é€‚åˆå¤§å‹æ–‡ä»¶ç³»ç»Ÿ</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211101155216951.png" alt="image-20211101155216951"></p><h4 id="ä½å›¾æ³•">ä½å›¾æ³•</h4><p>åˆ©ç”¨äºŒè¿›åˆ¶çš„ä¸€ä½è¡¨ç¤ºç£ç›˜ä¸­çš„ä¸€ä¸ªç›˜å—æƒ…å†µï¼Œæ‰€æœ‰çš„ç›˜å—éƒ½æœ‰ä¸€ä¸ªäºŒè¿›åˆ¶ä½ä¸ä¹‹å¯¹åº”ã€‚0è¡¨ç¤ºç©ºé—²ï¼Œ1è¡¨ç¤ºåˆ†é…</p><p>Linux fsé‡‡ç”¨</p><h3 id="fsç»“æ„">fsç»“æ„</h3><p>æ•°æ®å—çš„ä½å›¾æ˜¯æ”¾åœ¨ç£ç›˜å—é‡Œçš„ï¼Œå‡è®¾æ˜¯æ”¾åœ¨ä¸€ä¸ªå—é‡Œï¼Œä¸€ä¸ªå— 4Kï¼Œæ¯ä½è¡¨ç¤ºä¸€ä¸ªæ•°æ®å—ï¼Œå…±å¯ä»¥è¡¨ç¤º 4 * 1024 * 8 = 2^15 ä¸ªç©ºé—²å—ï¼Œç”±äº 1 ä¸ªæ•°æ®å—æ˜¯ 4K å¤§å°ï¼Œé‚£ä¹ˆæœ€å¤§å¯ä»¥è¡¨ç¤ºçš„ç©ºé—´ä¸º 2^15 * 4 * 1024 = 2^27 ä¸ª byteï¼Œä¹Ÿå°±æ˜¯ 128Mã€‚ã˜é€šè¿‡ä¸€ä¸ªå—çš„ä½å›¾+ä¸€ç³»åˆ—çš„å—æœ€å¤§ä¹Ÿå°±è¡¨ç¤º128Mçš„æ–‡ä»¶ï¼Œå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜</p><p><strong>å—ç»„</strong></p><p>Nä¸ªå—ç»„ --&gt; Nå¤§çš„æ–‡ä»¶</p><p>Linux Ext2:</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211101155902200.png" alt="image-20211101155902200"></p><ul><li>å¼•å¯¼å—ï¼šç³»ç»Ÿå¯åŠ¨æ—¶æ¥å¼•å¯¼</li><li>è¶…çº§å—ï¼šæ–‡ä»¶çš„é‡è¦ä¿¡æ¯ï¼Œinodeæ€»ä¸ªæ•°ã€å—æ€»ä¸ªæ•°</li><li>å—ç»„æè¿°ç¬¦ï¼šæ–‡ä»¶ç³»ç»Ÿä¸­å„ä¸ªå—ç»„çš„çŠ¶æ€ï¼ˆå—ç»„ä¸­ç©ºé—²å¿«å’Œinodeçš„æ•°ç›®ï¼‰</li><li>æ•°æ®ä½å›¾+inodeä½å›¾ï¼šè¡¨ç¤ºå¯¹åº”çš„æ•°æ®å—æˆ–inodeæ˜¯å¦ç©ºé—²</li><li>inodeåˆ—è¡¨ï¼šåŒ…å«äº†å­å—ç»„ä¸­çš„æ‰€æœ‰inodeï¼Œinodeç”¨äºä¿å­˜æ–‡ä»¶ç³»ç»Ÿä¸­ä¸å„ä¸ªæ–‡ä»¶å’Œç›®å½•ç›¸å…³çš„æ•°æ®</li><li>æ•°æ®å—â€¦</li></ul><h3 id="ç›®å½•çš„å­˜å‚¨æ–¹å¼">ç›®å½•çš„å­˜å‚¨æ–¹å¼</h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211101160219286.png" alt="image-20211101160219286"></p><p>é€šå¸¸ï¼Œç¬¬ä¸€é¡¹æ˜¯ã€Œ<code>.</code>ã€ï¼Œè¡¨ç¤ºå½“å‰ç›®å½•ï¼Œç¬¬äºŒé¡¹æ˜¯ã€Œ<code>..</code>ã€ï¼Œè¡¨ç¤ºä¸Šä¸€çº§ç›®å½•ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ä¸€é¡¹ä¸€é¡¹çš„æ–‡ä»¶åå’Œ inodeã€‚<br>å¯ä»¥ç”¨vimæ‰“å¼€ï¼Œè‡ªæµ‹åå‘ç°æ¯ä¸€è¡Œéƒ½æ˜¯å…¶ä¸‹æ–‡ä»¶çš„åå­—ï¼ˆä¼¼ä¹åªè¯»ï¼‰</p><p>ä¿å­˜ç›®å½•çš„æ ¼å¼ä¸ºå“ˆå¸Œè¡¨ --&gt; æé«˜æŸ¥æ‰¾æ•ˆç‡ï¼Œä½†éœ€è¦é¿å…å“ˆå¸Œå†²çª</p><h3 id="è½¯é“¾æ¥ç¡¬é“¾æ¥">è½¯é“¾æ¥ç¡¬é“¾æ¥</h3><h4 id="ç¡¬é“¾æ¥">ç¡¬é“¾æ¥</h4><p>å¤šä¸ªç›®å½•é¡¹ä¸­çš„ç´¢å¼•èŠ‚ç‚¹æŒ‡å‘åŒä¸€ä¸ªæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯æŒ‡å‘åŒä¸€ä¸ªinodeã€‚ç”±äºinodeæ— æ³•è·¨è¶Šfsï¼Œæ¯ä¸ªfséƒ½æœ‰è‡ªå·±çš„inodeçš„æ•°æ®ç»“æ„å’Œåˆ—è¡¨ï¼Œæ‰€ä»¥hard linkä¸èƒ½cross fs.ç”±äº<strong>å¤šä¸ªç›®å½•é¡¹éƒ½æŒ‡å‘ä¸€ä¸ªinode</strong>ï¼Œæ‰€ä»¥åªæœ‰åˆ é™¤æ–‡ä»¶çš„æ‰€æœ‰ç¡¬é“¾æ¥å’Œæºæ–‡ä»¶æ—¶ï¼Œç³»ç»Ÿæ‰ä¼šå½»åº•åˆ é™¤è¯¥æ–‡ä»¶ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ<strong>æ–‡ä»¶åœ¨ç£ç›˜ä¸­åªæœ‰ä¸€æ¬¡å¤åˆ¶ï¼Œç£ç›˜ç©ºé—´å ç”¨å°</strong><br>ä¸èƒ½å¯¹æ–‡ä»¶å¤¹è¿›è¡Œç¡¬é“¾æ¥ï¼Œç›®çš„å¯¹è±¡ä¸èƒ½æ˜¯å·²ç»å­˜åœ¨çš„æ–‡ä»¶</p><p>æºå°±æ˜¯æˆ‘ã€æˆ‘å°±æ˜¯æº  ln 123.txt 1234.txt</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211101160922007.png" alt="image-20211101160922007"></p><h4 id="è½¯é“¾æ¥">è½¯é“¾æ¥</h4><p>ç›¸å½“äºé‡æ–°åˆ›å»ºäº†ä¸€ä¸ªæ–‡ä»¶ï¼Œæœ‰<strong>ç‹¬ç«‹çš„inode</strong>ï¼Œä½†æ–‡ä»¶çš„å†…å®¹å´æ˜¯å¦ä¸€ä¸ªæ–‡ä»¶çš„è·¯å¾„ã€‚å¯ä»¥è·¨fsã€‚åˆ é™¤æºæ–‡ä»¶åå°±å˜æˆäº†æ­»é“¾æ¥ï¼Œä¸èƒ½ä½¿ç”¨ã€‚é‡æ–°åˆ›å»ºè¯¥ç›®å½•çš„æ–‡ä»¶åï¼Œèƒ½å¤Ÿé‡æ–°ä½¿ç”¨ã€‚ç›®çš„å¯¹è±¡ä¸èƒ½æ˜¯å·²ç»å­˜åœ¨çš„æ–‡ä»¶</p><p>æºå°±æ˜¯æˆ‘ã€æˆ‘å°±æ˜¯æº  ln -s 123.txt 1234.txt</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211101161026563.png" alt="image-20211101161026563"></p><p><strong>ç–‘é—®ï¼šä¸ºå•¥ç¡¬è½¯é“¾æ¥ä¼šå ç”¨ç›¸åŒå¤§å°çš„ç©ºé—´ï¼Ÿï¼Ÿï¼Ÿï¼Ÿä¸æ˜¯ç¡¬é“¾æ¥åœ¨ç£ç›˜ä¸­åªæœ‰ä¸€ä¸ªå¤‡ä»½å—ä¸”è½¯é“¾æ¥åªæ˜¯æ•°æ®å—å˜æˆåœ°å€å—ï¼Ÿä¸ºå•¥ï¼Ÿ</strong></p><p>ä¸¾ä¸ªæ —å­ï¼š</p><p>è¿™é‡Œ123.txtæ˜¯æºæ–‡ä»¶ã€12345.txtæ˜¯ç¡¬é“¾æ¥ã€1234.txtæ˜¯è½¯è¿æ¥</p><ol><li>åˆ é™¤123.txt,è½¯é“¾æ¥æ— æ³•ä½¿ç”¨ï¼Œç¡¬é“¾æ¥ç…§å¸¸ç”¨</li><li>æ¢å¤123.txtï¼Œéƒ½å¯ä»¥ä½¿ç”¨ï¼Œä½†ç¡¬é“¾æ¥æ— åŠ¨äºè¡·ï¼Œå·²ç»å¤±æ•ˆäº†</li></ol><h3 id="æ–‡ä»¶IO">æ–‡ä»¶IO</h3><ul><li><p>ç¼“å†²ä¸éç¼“å†²IO</p><ul><li>ç¼“å†²ï¼šåˆ©ç”¨çš„æ˜¯æ ‡å‡†åº“çš„ç¼“å­˜å®ç°æ–‡ä»¶çš„åŠ é€Ÿè®¿é—®ï¼Œè€Œæ ‡å‡†åº“å†é€šè¿‡ç³»ç»Ÿè°ƒç”¨è®¿é—®æ–‡ä»¶<ul><li>ä¾‹å¦‚printfçš„æ¢è¡Œè¾“å‡º</li></ul></li><li>éç¼“å†²ï¼šç›´æ¥ç”¨ç³»ç»Ÿè°ƒç”¨è®¿é—®æ–‡ä»¶è€Œä¸ç»è¿‡æ ‡å‡†åº“ç¼“å­˜</li></ul></li><li><p>ç›´æ¥ä¸éç›´æ¥IOï¼ˆå†…æ ¸ï¼šæˆ‘ä¸å¹²æ‰°ï¼‰</p><ul><li>ç›´æ¥ï¼šä¸ä¼šå‘ç”Ÿå†…æ ¸ç¼“å­˜å’Œç”¨æˆ·ç¨‹åºä¹‹é—´æ•°æ®å¤åˆ¶ï¼Œè€Œæ˜¯ç›´æ¥ç»è¿‡fsè®¿é—®ç£ç›˜</li><li>éç›´æ¥ï¼šè¯»æ“ä½œæ—¶ï¼Œæ•°æ®ä»å†…æ ¸ç¼“å­˜ä¸­æ‹·è´ç»™ç”¨æˆ·ç¨‹åºï¼Œå†™æ“ä½œæ—¶ï¼Œæ•°æ®ä»ç”¨æˆ·ç¨‹åºæ‹·è´ç»™å†…æ ¸ç¼“å­˜ï¼Œå†<strong>ç”±å†…æ ¸å†³å®š</strong>ä»€ä¹ˆæ—¶å€™å†™å…¥æ•°æ®åˆ°ç£ç›˜</li></ul></li><li><p>é˜»å¡ä¸éé˜»å¡IO åŒæ­¥ä¸éåŒæ­¥IO</p><ul><li><p>é˜»å¡ï¼šç”¨æˆ·æ‰§è¡Œreadï¼Œçº¿ç¨‹é˜»å¡ï¼Œç­‰å¾…å†…æ ¸æ•°æ®å‡†å¤‡å¥½åï¼Œå¹¶æŠŠæ•°æ®ä»å†…æ ¸ç¼“å†²åŒºæ‹·è´åˆ°åº”ç”¨ç¨‹åºçš„ç¼“å†²åŒºåï¼Œreadæ‰ä¼šè¿”å›ï¼ˆç­‰å¾…ï¼šå†…æ ¸æ•°æ®å‡†å¤‡å¥½ + æ•°æ®ä»å†…æ ¸æ€æ‹·è´åˆ°ç”¨æˆ·æ€ï¼‰</p></li><li><p>éé˜»å¡ï¼šreadåœ¨æ•°æ®æœªå‡†å¤‡å¥½çš„æƒ…å†µä¸‹ç«‹å³è¿”å›ï¼Œèƒ½ç»§ç»­æ‰§è¡Œï¼Œæ­¤æ—¶åº”ç”¨ç¨‹åºä¸æ–­è½®è®­å†…æ ¸ï¼ŒçŸ¥é“æ•°æ®å‡†å¤‡å¥½ï¼Œå†…æ ¸å°†æ•°æ®æ‹·è´åˆ°åº”ç”¨ç¨‹åºç¼“å†²åŒºï¼Œreadè°ƒç”¨èƒ½è·å¾—ç»“æœ</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211101161653344.png" alt="image-20211101161653344"></p><p>è§£å†³å‚»ä¹ä¹çš„è½®è®­æ–¹å¼ï¼š <strong>IOå¤šè·¯å¤ç”¨</strong> â€“ ç±»ä¼¼é€šçŸ¥</p><p>å®é™…ä¸Šï¼Œæ— è®ºæ˜¯é˜»å¡ I/Oã€éé˜»å¡ I/Oï¼Œè¿˜æ˜¯åŸºäºéé˜»å¡ I/O çš„å¤šè·¯å¤ç”¨éƒ½æ˜¯åŒæ­¥è°ƒç”¨ã€‚å› ä¸ºå®ƒä»¬åœ¨ read è°ƒç”¨æ—¶ï¼Œå†…æ ¸å°†æ•°æ®ä»å†…æ ¸ç©ºé—´æ‹·è´åˆ°åº”ç”¨ç¨‹åºç©ºé—´ï¼Œè¿‡ç¨‹éƒ½æ˜¯éœ€è¦ç­‰å¾…çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ª<strong>è¿‡ç¨‹æ˜¯åŒæ­¥</strong>çš„ï¼Œå¦‚æœå†…æ ¸å®ç°çš„æ‹·è´æ•ˆç‡ä¸é«˜ï¼Œread è°ƒç”¨å°±ä¼šåœ¨è¿™ä¸ªåŒæ­¥è¿‡ç¨‹ä¸­ç­‰å¾…æ¯”è¾ƒé•¿çš„æ—¶é—´ã€‚</p></li><li><p>å¼‚æ­¥IOï¼šå‘èµ·aio_readå ç«‹å³è¿”å›ï¼Œå†…æ ¸è‡ªåŠ¨å°†æ•°æ®è¿›è¡Œæ‹·è´ï¼Œæ‹·è´è¿‡ç¨‹å¼‚æ­¥è¿›è¡Œ</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211101162010300.png" alt="image-20211101162010300"></p></li></ul></li></ul><p>æ€»ç»“ä¸€ä¸‹ï¼šIOåˆ†ä¸ºä¸¤ä¸ªè¿‡ç¨‹</p><ol><li>æ•°æ®å‡†å¤‡</li><li>æ•°æ®ä»å†…æ ¸ç©ºé—´æ‹·è´åˆ°ç”¨æˆ·è¿›ç¨‹ç¼“å†²åŒº</li></ol><p>é˜»å¡IOé˜»å¡åœ¨1\2ï¼Œéé˜»å¡IOé˜»å¡åœ¨2 â€”éƒ½æ˜¯åŒæ­¥IO<br>å¼‚æ­¥IO 1ã€2éƒ½ä¸ä¼šé˜»å¡</p><p>ä¾‹å­</p><blockquote><p>é˜»å¡ I/O å¥½æ¯”ï¼Œä½ å»é¥­å ‚åƒé¥­ï¼Œä½†æ˜¯é¥­å ‚çš„èœè¿˜æ²¡åšå¥½ï¼Œç„¶åä½ å°±ä¸€ç›´åœ¨é‚£é‡Œç­‰å•Šç­‰ï¼Œç­‰äº†å¥½é•¿ä¸€æ®µæ—¶é—´ç»ˆäºç­‰åˆ°é¥­å ‚é˜¿å§¨æŠŠèœç«¯äº†å‡ºæ¥ï¼ˆæ•°æ®å‡†å¤‡çš„è¿‡ç¨‹ï¼‰ï¼Œä½†æ˜¯ä½ è¿˜å¾—ç»§ç»­ç­‰é˜¿å§¨æŠŠèœï¼ˆå†…æ ¸ç©ºé—´ï¼‰æ‰“åˆ°ä½ çš„é¥­ç›’é‡Œï¼ˆç”¨æˆ·ç©ºé—´ï¼‰ï¼Œç»å†å®Œè¿™ä¸¤ä¸ªè¿‡ç¨‹ï¼Œä½ æ‰å¯ä»¥ç¦»å¼€ã€‚</p><p>éé˜»å¡ I/O å¥½æ¯”ï¼Œä½ å»äº†é¥­å ‚ï¼Œé—®é˜¿å§¨èœåšå¥½äº†æ²¡æœ‰ï¼Œé˜¿å§¨å‘Šè¯‰ä½ æ²¡ï¼Œä½ å°±ç¦»å¼€äº†ï¼Œè¿‡å‡ ååˆ†é’Ÿï¼Œä½ åˆæ¥é¥­å ‚é—®é˜¿å§¨ï¼Œé˜¿å§¨è¯´åšå¥½äº†ï¼Œäºæ˜¯é˜¿å§¨å¸®ä½ æŠŠèœæ‰“åˆ°ä½ çš„é¥­ç›’é‡Œï¼Œè¿™ä¸ªè¿‡ç¨‹ä½ æ˜¯å¾—ç­‰å¾…çš„ã€‚</p><p>åŸºäºéé˜»å¡çš„ I/O å¤šè·¯å¤ç”¨å¥½æ¯”ï¼Œä½ å»é¥­å ‚åƒé¥­ï¼Œå‘ç°æœ‰ä¸€æ’çª—å£ï¼Œé¥­å ‚é˜¿å§¨å‘Šè¯‰ä½ è¿™äº›çª—å£éƒ½è¿˜æ²¡åšå¥½èœï¼Œç­‰åšå¥½äº†å†é€šçŸ¥ä½ ï¼Œäºæ˜¯ç­‰å•Šç­‰ï¼ˆselect è°ƒç”¨ä¸­ï¼‰ï¼Œè¿‡äº†ä¸€ä¼šé˜¿å§¨é€šçŸ¥ä½ èœåšå¥½äº†ï¼Œä½†æ˜¯ä¸çŸ¥é“å“ªä¸ªçª—å£çš„èœåšå¥½äº†ï¼Œä½ è‡ªå·±çœ‹å§ã€‚äºæ˜¯ä½ åªèƒ½ä¸€ä¸ªä¸€ä¸ªçª—å£å»ç¡®è®¤ï¼Œåé¢å‘ç° 5 å·çª—å£èœåšå¥½äº†ï¼Œäºæ˜¯ä½ è®© 5 å·çª—å£çš„é˜¿å§¨å¸®ä½ æ‰“èœåˆ°é¥­ç›’é‡Œï¼Œè¿™ä¸ªæ‰“èœçš„è¿‡ç¨‹ä½ æ˜¯è¦ç­‰å¾…çš„ï¼Œè™½ç„¶æ—¶é—´ä¸é•¿ã€‚æ‰“å®Œèœåï¼Œä½ è‡ªç„¶å°±å¯ä»¥ç¦»å¼€äº†ã€‚</p><p>å¼‚æ­¥ I/O å¥½æ¯”ï¼Œä½ è®©é¥­å ‚é˜¿å§¨å°†èœåšå¥½å¹¶æŠŠèœæ‰“åˆ°é¥­ç›’é‡Œåï¼ŒæŠŠé¥­ç›’é€åˆ°ä½ é¢å‰ï¼Œæ•´ä¸ªè¿‡ç¨‹ä½ éƒ½ä¸éœ€è¦ä»»ä½•ç­‰å¾…ã€‚<br>åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/qq_34827674/article/details/107992414">https://blog.csdn.net/qq_34827674/article/details/107992414</a> by å°æ—coding</p></blockquote><p>æœ¬ç¯‡åšå®¢ä¸»è¦èªŠæŠ„ via <a href="https://blog.csdn.net/qq_34827674/article/details/107992414">ä¸€å£æ°”ææ‡‚ã€Œæ–‡ä»¶ç³»ç»Ÿã€ï¼Œå°±é è¿™ 25 å¼ å›¾äº†</a> by å°æ—codingã€‚ä¾µæƒå³åˆ </p><h2 id="ä½™ç•™é—®é¢˜">ä½™ç•™é—®é¢˜</h2><h3 id="æ‰‡åŒº">æ‰‡åŒº</h3><h3 id="inodeå¦‚ä½•å­˜å‚¨ï¼Œdentryå¦‚ä½•åŠ¨æ€åŠ è½½çš„">inodeå¦‚ä½•å­˜å‚¨ï¼Œdentryå¦‚ä½•åŠ¨æ€åŠ è½½çš„</h3>]]></content>
    
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>File System</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LinuxæŒ‡ä»¤</title>
    <link href="/2021/11/01/Linux%E6%8C%87%E4%BB%A4/"/>
    <url>/2021/11/01/Linux%E6%8C%87%E4%BB%A4/</url>
    
    <content type="html"><![CDATA[<h1>LinuxæŒ‡ä»¤</h1><h2 id="ls">ls</h2><ul><li>-i æŸ¥çœ‹inodeå·</li><li>-ll size+æƒé™</li><li>-lh åŒä¸Šï¼Œä»¥ä¸åŒå­˜å‚¨å•ä½æ˜¾ç¤º</li></ul><h2 id="stat">stat</h2><ul><li>filename æŸ¥çœ‹æŸä¸ªæ–‡ä»¶çš„inodeä¿¡æ¯</li></ul><h2 id="System">System</h2><h3 id="fh">fh</h3><p>ç£ç›˜ç›¸å…³ä¿¡æ¯</p><ul><li>-hï¼šæŸ¥çœ‹ç”µè„‘ä¸ŠæŒ‚è½½çš„åˆ†åŒºçš„å¤§å°</li></ul><h2 id="Process">Process</h2><h3 id="ps"><strong>ps</strong></h3><ul><li>-A ï¼šæ‰€æœ‰è¿›ç¨‹</li><li>-a ï¼šåŒä¸€ç»ˆç«¯ä¸‹çš„æ‰€æœ‰è¿›ç¨‹</li><li>-u ï¼šæ˜¾ç¤ºæŒ‡å®šç”¨æˆ·çš„æ‰€æœ‰è¿›ç¨‹</li><li>ps e ï¼šæ˜¾ç¤ºæ¯ä¸ªç¨‹åºä½¿ç”¨çš„ç¯å¢ƒå˜é‡</li><li>ps fï¼š ä½¿ç”¨ASCIIå­—ç¬¦æ˜¾ç¤ºæ ‘çŠ¶ç»“æ„</li><li>-e ï¼š ä¸-AæŒ‡ä»¤ä¸€æ ·</li><li>-x ï¼šæ˜¾ç¤ºæ‰€æœ‰ç¨‹åºï¼Œä¸æŒ‰ç…§ç»ˆç«¯æœºåŒºåˆ†</li><li>-auï¼šæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯</li><li>-auxï¼šæ˜¾ç¤ºæ‰€æœ‰åŒ…å«å…¶ä»–ä½¿ç”¨è€…çš„è¡Œç¨‹<ul><li>USER: è¡Œç¨‹æ‹¥æœ‰è€…</li><li>PID: pid</li><li>%CPU: å ç”¨çš„ CPU ä½¿ç”¨ç‡</li><li>%MEM: å ç”¨çš„è®°å¿†ä½“ä½¿ç”¨ç‡</li><li>VSZ: å ç”¨çš„è™šæ‹Ÿè®°å¿†ä½“å¤§å°</li><li>RSS: å ç”¨çš„è®°å¿†ä½“å¤§å°</li><li>TTY: ç»ˆç«¯çš„æ¬¡è¦è£…ç½®å·ç  (minor device number of tty)</li><li>STAT: è¯¥è¡Œç¨‹çš„çŠ¶æ€:<ul><li>D: ä¸å¯ä¸­æ–­çš„é™æ­¢</li><li>R: æ­£åœ¨æ‰§è¡Œä¸­</li><li>S: é™æ­¢çŠ¶æ€</li><li>T: æš‚åœæ‰§è¡Œ</li><li>Z: ä¸å­˜åœ¨ä½†æš‚æ—¶æ— æ³•æ¶ˆé™¤</li><li>W: æ²¡æœ‰è¶³å¤Ÿçš„è®°å¿†ä½“åˆ†é¡µå¯åˆ†é…</li><li>&lt;: é«˜ä¼˜å…ˆåºçš„è¡Œç¨‹</li><li>N: ä½ä¼˜å…ˆåºçš„è¡Œç¨‹</li><li>L:  æœ‰äº›é¡µè¢«é”è¿›å†…å­˜</li><li>l å¤šè¿›ç¨‹çš„</li><li>+ ä½äºåå°çš„è¿›ç¨‹ç»„ï¼›</li></ul></li><li>START: è¡Œç¨‹å¼€å§‹æ—¶é—´</li><li>TIME: æ‰§è¡Œçš„æ—¶é—´</li><li>COMMAND:æ‰€æ‰§è¡Œçš„æŒ‡ä»¤</li></ul></li><li>-ef ï¼šæ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ä¿¡æ¯ï¼ŒåŒ…æ‹¬å‘½ä»¤è¡Œï¼ˆä¸grep è¿ç”¨æ¥æŸ¥æ‰¾ç‰¹å®šè¿›ç¨‹ï¼‰</li><li>-eoï¼šè‡ªå®šä¹‰æ˜¾ç¤ºï¼Œåé¢è·Ÿå‚æ•°å,</li></ul><blockquote><p>pså·¥å…·æ ‡è¯†è¿›ç¨‹çš„5ç§çŠ¶æ€ç :<br>D ä¸å¯ä¸­æ–­ uninterruptible sleep (usually IO)<br>R è¿è¡Œ runnable (on run queue)<br>S ä¸­æ–­ sleeping<br>T åœæ­¢ traced or stopped<br>Z åƒµæ­» a defunct (â€zombieâ€) process  (è¿›ç¨‹å·²ç»ˆæ­¢, ä½†è¿›ç¨‹æè¿°ç¬¦å­˜åœ¨, ç›´åˆ°çˆ¶è¿›ç¨‹è°ƒç”¨wait4()ç³»ç»Ÿè°ƒç”¨åé‡Šæ”¾)</p></blockquote><p>pstree -pï¼šä»¥æ ‘ç»“æ„æ˜¾ç¤ºè¿›ç¨‹<br>pstree -apnh ï¼šæ˜¾ç¤ºè¿›ç¨‹é—´çš„å…³ç³»</p><h3 id="kill">kill</h3><ul><li>kill ï¼Œç³»ç»Ÿå‘é€sigtermä¿¡å·ç»™ç¨‹åºï¼Œç¨‹åºå—åˆ°åå¯èƒ½ç«‹å³åœæ­¢ã€å¯èƒ½é‡Šæ”¾ç›¸åº”èµ„æºååœæ­¢ã€å¯èƒ½ç»§ç»­è¿è¡Œ</li><li>kill -9ï¼Œç³»ç»Ÿå‘é€çš„æ˜¯SIGKILLï¼Œå³exitä¿¡å·ï¼Œä¸ä¼šè¢«ç³»ç»Ÿé˜»å¡ï¼Œç›´æ¥æ€æ‰ç¨‹åº</li><li>kill -15ï¼Œå‘é€ä¿¡å·ç»™ç¨‹åºï¼Œç¨‹åºæ ¹æ®è‡ªå·±æƒ…å†µé€‰æ‹©åœæ­¢æ—¶é—´ï¼ˆç¨‹åºåœ¨ç­‰å¾…IOï¼Œå°±ä¸èƒ½ç«‹é©¬åœæ­¢ï¼‰</li><li>-CONT ç»§ç»­æš‚åœçš„è¿›ç¨‹</li><li>-STOP æš‚åœè¿›ç¨‹</li></ul><h3 id="-v5">&amp;</h3><p>å°†è¿›ç¨‹æ”¾åœ¨åå°è¿è¡Œï¼Œå¹¶è¿”å›ä¸€ä¸ªidå·ã€‚ä½†å…³é—­å½“å‰ä¼šè¯æˆ–ç»ˆç«¯åï¼Œå°±ä¼šåœæ­¢æ‰§è¡Œ</p><h3 id="nohup">nohup</h3><p>è®©è¿›ç¨‹åœ¨åå°æ‰§è¡Œï¼Œå¹¶ä¸”å…³é—­å½“å‰ç»ˆç«¯ï¼Œè¿›ç¨‹ä¹Ÿä¼šç»§ç»­æ‰§è¡Œï¼Œé€‚åˆæœåŠ¡å™¨è¿›è¡Œçš„æ“ä½œã€‚ä½†å…³é—­ç»ˆç«¯åï¼Œåœ¨å¦ä¸€ä¸ªç»ˆç«¯é‡Œçœ‹ä¸åˆ°jobs -lå½“å‰çš„ä¿¡æ¯ã€‚å¹¶ä¸”è¾“å‡ºåœ¨ç»ˆç«¯çš„ä¿¡æ¯ä¼šæ˜¾ç¤ºåœ¨å½“å‰ç›®å½•ä¸‹çš„nohup.txtä¸­</p><h3 id="fg-bg-jobs">fg\bg\jobs</h3><ul><li>fg pidï¼šå°†ä¸€ä¸ªåœ¨åå°æš‚åœçš„å‘½ä»¤ï¼Œå˜æˆåœ¨<strong>å‰å°</strong>ç»§ç»­æ‰§è¡Œ</li><li>bg pidï¼šå°†ä¸€ä¸ªåœ¨åå°æš‚åœçš„å‘½ä»¤ï¼Œå˜æˆåœ¨<strong>åå°</strong>ç»§ç»­æ‰§è¡Œã€‚<ul><li>ä½†æ˜¯ä¾‹å¦‚è¿›ç¨‹æœ‰echoè¾“å‡ºæ—¶ï¼Œä¼šè¾“å‡ºåˆ°å½“å‰çš„ç»ˆç«¯ã€‚</li></ul></li><li>jobsï¼šæ˜¾ç¤ºå½“å‰æœ‰å¤šå°‘åœ¨åå°è¿è¡Œçš„å‘½ä»¤ï¼ˆä»…åœ¨å½“å‰ç»ˆç«¯å¯åŠ¨çš„ï¼‰<ul><li>-l ï¼šæ˜¾ç¤ºpid</li></ul></li></ul><p>ctrl+zï¼šå°†ä¸€ä¸ªæ­£åœ¨å‰å°æ‰§è¡Œçš„å‘½ä»¤æ”¾åˆ°åå°ï¼Œå¹¶ä½¿å…¶æš‚åœ</p><h2 id="IO">IO</h2><h3 id="echo">echo</h3><ul><li>-e èƒ½è¯†åˆ«è½¬ä¹‰å­—ç¬¦ï¼ˆ\nç­‰ï¼‰</li></ul><h3 id="printf">printf</h3><h2 id="File">File</h2><h3 id="chmod">chmod</h3><p>change mode: æ§åˆ¶ç”¨æˆ·å¯¹æ–‡ä»¶çš„å‘½ä»¤<br>Linuxçš„æ–‡ä»¶è°ƒç”¨æƒé™åˆ†ä¸ºä¸‰çº§ï¼šOwner \ Group \ Other User</p><p>r-w-x : Read-Write-Execute</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220404123127379.png" alt="image-20220404123127379"></p><p>åªæœ‰æ–‡ä»¶æ‰€æœ‰è€…Ownerå’Œè¶…çº§ç”¨æˆ·å¯ä»¥ä¿®æ”¹å¯ä»¥ä¿®æ”¹æ–‡ä»¶å’Œç›®å½•çš„æƒé™ï¼Œä¹Ÿèƒ½å¤Ÿä½¿ç”¨å…«è¿›åˆ¶ä¿®æ”¹æƒé™</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220404123230668.png" alt="image-20220404123230668"></p><ul><li>uï¼šè¡¨ç¤ºæ–‡ä»¶çš„æ‹¥æœ‰è€…</li><li>gï¼šè¡¨ç¤ºä¸è¯¥æ–‡ä»¶æ‹¥æœ‰è€…æ‰€å±çš„åŒä¸€ä¸ªç¾¤ä½“</li><li>oï¼šè¡¨ç¤ºå…¶ä»–äºº</li><li>aï¼šè¡¨ç¤ºä¸‰è€…éƒ½æ˜¯</li><li>+ï¼šå¢åŠ æƒé™ - å–æ¶ˆæƒé™  = å”¯ä¸€è®¾å®šæƒé™</li><li>-Rï¼šå¯¹ç›®å½•ä¸‹çš„æ–‡ä»¶ä¸å­ç›®å½•é€’å½’è¿›è¡Œæ“ä½œçš„</li></ul><p>ä½†æ˜¯æœ‰ä¸€ä¸ªå¥‡æ€ªçš„ç°è±¡ï¼Œæˆ‘æŠŠä¸€ä¸ªæ–‡ä»¶è®¾ç½®ä¸ºä¸å¯è¯»ä¸å¯å†™ï¼Œç„¶åæˆ‘å¯¹æ–‡ä»¶å¼ºåˆ¶è¿›è¡Œä¿®æ”¹ wq!ä¿å­˜ï¼Œç„¶åæ¢å¤æƒé™å»æŸ¥çœ‹ï¼Œå‘ç°æ•°æ®éƒ½æ”¹å˜ä¸ºå¼ºåˆ¶ä¿®æ”¹çš„æ•°æ®äº†</p><h3 id="mv">mv</h3><h3 id="cp">cp</h3><h3 id="find">find</h3><ul><li>-name  â€œfilenameâ€ ï¼š&quot; * xxxx * &quot;<ul><li>! -name æ‰¾åˆ°æ–‡ä»¶åå­—ä¸æ˜¯xxxç»“å°¾çš„</li></ul></li></ul><h2 id="Network">Network</h2><h3 id="ssh">ssh</h3><h3 id="scp">scp</h3><h3 id="netstat">netstat</h3><ul><li>-l ï¼šæ˜¾ç¤ºç›‘å¬ç«¯å£</li><li>-aï¼šæ˜¾ç¤ºæ‰€æœ‰ç«¯å£</li></ul><h3 id="ifconfig">ifconfig</h3><p>æ˜¾ç¤ºå’Œé…ç½®ç½‘å¡çš„ç½‘ç»œå‚æ•°ï¼Œå¯ä»¥è®¾ç½®MTUã€‚</p><h3 id="route">route</h3><p>æ˜¾ç¤ºå¹¶è®¾ç½®é™æ€è·¯ç”±è¡¨</p><ul><li>-nï¼šä¸æ‰§è¡ŒDNSåå‘æŸ¥æ‰¾ï¼Œç›´æ¥æ˜¾ç¤ºæ•°å­—å½¢å¼çš„IPåœ°å€</li><li>-eï¼šnetstatæ ¼å¼æ˜¾ç¤ºè·¯ç”±è¡¨</li><li>-vï¼šè¯¦ç»†ä¿¡æ¯æ˜¾ç¤º</li></ul><p>åˆ é™¤è·¯ç”±è®°å½•<br>sudo route del default / (or xxxxx)</p><p>å¢åŠ é»˜è®¤è·¯ç”±è®°å½•ï¼ˆ0.0.0.0ï¼‰<br>sudo route add default gw 172.20.10.1 window 2796 dev wlo1</p>]]></content>
    
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Shell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Qemu+GDBè°ƒè¯•Linuxå†…æ ¸</title>
    <link href="/2021/10/30/%E8%B0%83%E8%AF%95Linux%E5%86%85%E6%A0%B8/"/>
    <url>/2021/10/30/%E8%B0%83%E8%AF%95Linux%E5%86%85%E6%A0%B8/</url>
    
    <content type="html"><![CDATA[<h1>Qemu+GDBè°ƒè¯•linuxå†…æ ¸</h1><blockquote><p>åœ¨å­¦ä¹ Linuxå†…æ ¸çš„æ—¶å€™ï¼Œæƒ³çœ‹ä¸€ä¸‹å†…éƒ¨æ˜¯å¦‚ä½•æ‰§è¡ŒCè¯­è¨€ä»£ç çš„ï¼Œèƒ½ä¸èƒ½æ·±å…¥å…·ä½“çš„å†…æ ¸æºç å±‚é¢ï¼Œå°±åƒAndroidæºç ä¸€æ ·ï¼Œæˆ–è€…Javaçš„jdkæºç ã€‚ç»è¿‡æœç´¢åï¼Œå‘ç°è¿˜æ˜¯å¾ˆå›°éš¾ï¼Œè¿™ç‚¹è®©æˆ‘è¿˜æ˜¯æ¯”è¾ƒåƒæƒŠã€‚å¯èƒ½æ˜¯Cæœ¬æ¥å°±æ˜¯åŸºäºLinuxçš„æŸä¸€å†…æ ¸ï¼Ÿæ‰€ä»¥è¦è°ƒè¯•ç³»ç»Ÿå±‚é¢çš„è°ƒç”¨çš„è¯éå¸¸å›°éš¾ï¼Œéœ€è¦ä¸€äº›ä»¿çœŸå’Œæ¨¡æ‹Ÿçš„æ‰‹æ®µã€‚è¿™é‡Œæˆ‘æœç´¢åˆ°çš„å·¥å…·æ–¹æ³•æ˜¯é€šè¿‡qemu + gdb + vscode + vmå®Œæˆçš„</p></blockquote><p>å·¥å…·ï¼š è™šæ‹Ÿæœº with Ubuntu 20.04 ã€vmwareã€qemuã€gdb</p><ol><li><p>ç¢Ÿä¸­è°ä¹‹æˆ‘åœ¨Linuxä¸Šè£…è™šæ‹Ÿæœºè£…Linux<br>é¦–å…ˆå®‰è£…ä¸€ä¸‹è™šæ‹Ÿæœºï¼Œï¼ˆVMware Workstationå±…ç„¶åœ¨AURä¸Šæœ‰ï¼Œéå¸¸å¥½ç”¨ï¼‰ï¼Œé€‰æ‹©çš„æ˜¯Ubuntu 20.04ã€‚å½“ç„¶ éœ€è¦è£…ä¸€ä¸‹vm-toolsã€‚å½“ç„¶è¿™é‡Œè¿˜æ˜¯æœ‰ç‚¹é—®é¢˜ï¼Œæœ€å¼€å§‹è£…ç¬¬ä¸€æ¬¡çš„æ—¶å€™å‡ºç°äº†ï¼Œvm-toolsè£…äº†æ— æ³•ä½¿ç”¨ã€NAT ï¼ˆåæ¥å¸è½½é‡è£…äº†ä¸€ä¸ªvmå°±å¥½äº†ï¼‰ã€‚</p></li><li><p>é€‰æ‹©ä¸€ä¸ªLinuxå†…æ ¸ä¸‹è½½ï¼Œç”¨çš„æœ€æ–°stable 5.14.15ï¼Œç›´æ¥åˆš.</p><ol><li>aptå®‰è£…ä¸€äº›ç¼–è¯‘çš„å¿…å¤‡æ’ä»¶ bison flex build-essential ç­‰</li><li>sudo make menuconfig ã€‚ï¼ˆè®°å¾—é€‰æ‹©å…è®¸è°ƒè¯•ï¼‰</li><li>sudo make -j 8 ã€‚è¿™é‡Œå¦‚æœæŠ¥é”™ï¼Œä»€ä¹ˆ No rule to make target â€˜debian/canonical-certs.pemï¼Œå°±æŠŠmake menuconfigç”Ÿæˆçš„.configæ–‡ä»¶ä¿®æ”¹ä¸€ä¸‹ï¼ŒCONFIG_SYSTEM_TRUSTED_KEYSç­‰å€¼ä¸ºdebian/canonical-certs.pemçš„keyçš„valueå€¼éƒ½æ”¹ä¸ºç©ºï¼Œ å°±å¯ä»¥äº†</li><li>make modules_install</li><li>make install</li></ol></li><li><p>è¿™é‡Œå®‰è£…å®Œåç¬¬ä¸€æ¬¡æœ‰ç‚¹æ’æ›²ï¼Œä¸ºäº†ä¿®æ”¹é»˜è®¤çš„å¯åŠ¨å†…æ ¸ï¼ŒæŠŠgrubæ”¹ç‚¸äº†ï¼Œå½“æ—¶æŠŠ/etc/default/grubçš„default æ”¹æˆä¸€ä¸ªæ•°å­—äº†ï¼Œå¯¼è‡´å¼€å¯ç›´æ¥å¯åŠ¨memtest86.åæ¥é€šè¿‡bootå¯åŠ¨ä¹Ÿä¸è¡Œï¼Œç›´æ¥remakeäº†(è™šæ‹ŸæœºçœŸå¥½)ã€‚åæ¥å‘ç°éœ€è¦å…ˆé€šè¿‡grep submenu /boot/grub/grub.cfgæ‰¾åˆ°submenu,ä¿®æ”¹defaultä¸ºå½¢å¼â€™Debian GNU/Linux, with Linux 4.7.0-1-amd64â€™ç„¶åupdate-grubä¼šæç¤ºä½ ç”¨è¿™ä¸ªæ–¹å¼â€™gnulinux-4.7.0-1-amd64-advanced-65c9af03-3d9b-411c-99b2-a9ada0961a40â€™ï¼Œç„¶åå°±å¯ä»¥åŠ›ã€‚<br>è¿™é‡Œæˆ‘æƒ³çš„æ˜¯å¼€æœºå¼¹å‡ºå†…æ ¸é€‰æ‹©ç”»é¢ï¼Œåæ¥æŸ¥è¯ï¼Œåœ¨ubuntuä¸Šå¯åŠ¨æ—¶shiftèƒ½è¿›å…¥é€‰æ‹©ç•Œé¢ï¼ˆé›€æ°ä¸é”™ï¼‰</p></li><li><p>æœ¬æœºvscodeå®‰è£…ssh remote  qemu-system-x86 gdbå¹¶æ·»åŠ gdbè®¾ç½®</p><div class="code-wrapper"><pre class="language-shell" data-language="shell"><code class="language-shell">&#123;    &quot;version&quot;: &quot;0.2.0&quot;,    &quot;configurations&quot;: [        &#123;            &quot;name&quot;: &quot;kernel-debug&quot;,            &quot;type&quot;: &quot;cppdbg&quot;,            &quot;request&quot;: &quot;launch&quot;,            &quot;miDebuggerServerAddress&quot;: &quot;127.0.0.1:1234&quot;,            &quot;program&quot;: &quot;$&#123;workspaceFolder&#125;&#x2F;vmlinux&quot;,            &quot;args&quot;: [],            &quot;stopAtEntry&quot;: false,            &quot;cwd&quot;: &quot;$&#123;workspaceFolder&#125;&quot;,            &quot;environment&quot;: [],            &quot;externalConsole&quot;: false,            &quot;logging&quot;: &#123;                &quot;engineLogging&quot;: false            &#125;,            &quot;MIMode&quot;: &quot;gdb&quot;,        &#125;    ]&#125;</code></pre></div></li><li><p>ç„¶åè¿›å…¥åˆ°è™šæ‹Ÿæœºå†…æ ¸ä»£ç ï¼Œè™šæ‹Ÿæœºéšä¾¿ç¼–å†™ä¸€ä¸ªcæŒ‡ä»¤ï¼Œç„¶åmake rootfsï¼ˆè¿™é‡Œæ˜¯å•¥æ„æ€ï¼Œæ–‡ä»¶ç³»ç»Ÿç©ºé—´ï¼Ÿï¼‰qemu-system-x86_64 -kernel â€¦/â€¦/arch/x86/boot/bzImage -initrd â€¦/rootfs.img -append nokaslr -S -sï¼Œè¿›å…¥åˆ°qemuç­‰å¾…è°ƒè¯•ç•Œé¢</p></li><li><p>vscodeç›´æ¥start debugging å°±å¯ä»¥å’¯</p></li></ol><p><strong>å‚è€ƒ</strong></p><p><a href="https://wenfh2020.com/2021/06/23/vscode-gdb-debug-linux-kernel/">vscode + gdb è¿œç¨‹è°ƒè¯• linux å†…æ ¸æºç </a></p><p><a href="https://blog.csdn.net/ibless/article/details/82349507">Linuxå†…æ ¸ç¼–è¯‘</a></p>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>C</tag>
      
      <tag>è°ƒè¯•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ·±å…¥Linux fork()å‡½æ•°</title>
    <link href="/2021/10/28/%E6%B7%B1%E5%85%A5Linux-fork-%E5%87%BD%E6%95%B0/"/>
    <url>/2021/10/28/%E6%B7%B1%E5%85%A5Linux-fork-%E5%87%BD%E6%95%B0/</url>
    
    <content type="html"><![CDATA[<h1>æ·±å…¥ç†è§£Linux çº¿ç¨‹å‡½æ•°</h1><blockquote><p>åœ¨è¯»ã€ŠLinuxå†…æ ¸è®¾è®¡ä¸å®ç°ã€‹æ—¶å¯¹Linuxè¿›ç¨‹å®ç°éå¸¸æ„Ÿå…´è¶£ï¼Œå¹¶ä¸”ä¹‹å‰å°±ä¸€ç›´æƒ³äº†è§£ä¸€ä¸‹åŸç†ã€‚äºæ˜¯è¿˜æ˜¯æŠ½ç©ºæ·±å…¥äº†ä¸€ä¸‹ã€‚æƒ³ç»“åˆä¸€ä¸‹æ–°ç‰ˆæœ¬å’Œæ—§ç‰ˆæœ¬çš„å®ç°å·®å¼‚ï¼Œæ‰€å‚è€ƒçš„æºç ç‰ˆæœ¬æ˜¯2.6.32.20å’Œ5.14.15</p></blockquote><h2 id="fork-v2">fork</h2><h3 id="ä¸€äº›ä¾‹å­">ä¸€äº›ä¾‹å­</h3><p>forkè°ƒç”¨ä¸€æ¬¡ï¼Œèƒ½å¤Ÿè¿”å›ä¸¤æ¬¡ã€‚åœ¨å­è¿›ç¨‹ä¸­è¿”å›0ï¼Œçˆ¶è¿›ç¨‹ä¸­è¿”å›å­è¿›ç¨‹çš„id</p><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">fork_test_1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"program begin with pid%6d  ppid%6d \n"</span><span class="token punctuation">,</span><span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getppid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">pid_t</span> id<span class="token punctuation">;</span>    <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    id <span class="token operator">=</span> <span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    count <span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token comment">// sleep(1);</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"this is son process, pid %6d ppid %6d\n"</span><span class="token punctuation">,</span><span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">getppid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"forkid is %d\n"</span> <span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"count is %d\n"</span> <span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">></span> <span class="token number">0</span> <span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"this is father process, pid %6d ppid %6d\n"</span><span class="token punctuation">,</span><span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">getppid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"forkid is %d\n"</span> <span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"count is %d\n"</span> <span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"program end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/**    program begin with pid  5071  ppid  2930     this is father process, pid   5071 ppid   2930    forkid is 5072    count is 1    program endthis is son process, pid   5072 ppid   5071    forkid is 0    count is 1    program end    Process finished with exit code 0**/</span></code></pre></div><p>è¿™é‡Œæœ‰ä¸€ä¸ªå¾ˆæœ‰è¶£çš„ç°è±¡ï¼šå¦‚æœæŠŠæœ€å¼€å§‹çš„printf(â€œâ€¦\nâ€) æ¢è¡Œç¬¦å»æ‰ï¼Œåˆ™ä¼šåœ¨å­è¿›ç¨‹ä¸­ä¹Ÿçœ‹åˆ°ç›¸å…³çš„å­—ç¬¦è¾“å‡ºã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿforkä¸æ˜¯åªç®¡forkåçš„ä»£ç å—ï¼Ÿ<br>è¿™é‡Œè¦ç†è§£ï¼Œforkæ‹·è´çš„æ˜¯æ•´ä¸ªè¿›ç¨‹é™¤ä¸€äº›ç‰¹æ®Šå˜é‡çš„æ•°æ®ï¼Œprintfåœ¨æ²¡æœ‰æ¢è¡Œç¬¦åŠ å…¥æ—¶ï¼Œä¸ä¼šflushå…¶ç¼“å†²åŒºå†…çš„å­—ç¬¦ï¼Œæ“ä½œç³»ç»Ÿä»…ä»…æ˜¯æŠŠå†…å®¹å½“é“äº†stdoutçš„ç¼“å†²é˜Ÿåˆ—ä¸­ï¼Œæ²¡æœ‰å®é™…çš„å†™åˆ°å±å¹•ä¸Šï¼Œå³ç¼“å†²åŒºä¸­è¿˜æœ‰æ•°æ®ã€‚è¿™æ—¶å€™forkæ—¶ï¼Œä¹Ÿå°±æŠŠæ­¤éƒ¨åˆ†çš„æ•°æ®æ‹·è´è¿›å»äº†ï¼Œ<s>åœ¨ä¸‹æ¬¡printæ—¶ï¼Œå°±ä¼šé¡ºå¸¦æŠŠç¼“å†²åŒºçš„æ•°æ®æ‰“å°å‡ºæ¥</s>ï¼ˆæµ‹è¯•åï¼Œæ²¡æœ‰printä¹Ÿä¼šæ‰“å°å‡ºï¼Œå¯èƒ½å’Œç³»ç»Ÿæ§åˆ¶çš„printæ‰“å°æ—¶æœºæœ‰å…³ï¼‰ã€‚<br>æ­¤å¤„å¯ä»¥ç»§ç»­æ‰©å±•ç†è§£ Cè¯­è¨€ä¸­printfçš„ç¼“å†²æœºåˆ¶</p><blockquote><p>è¡¥å……ï¼š è¿™é‡Œå¯ä»¥ç ”ç©¶ä¸€ä¸‹è¿™ä¸ªä»£ç <br>printf(â€œhhhhâ€); sleep(10);<br>printf(â€œhhh\nâ€);sleep(19);<br>èƒ½å¤Ÿæ›´å¥½çš„ç†è§£ç¼“å†²</p></blockquote><p>è¿˜æœ‰ä¸€ç‚¹ï¼šå¦‚æœå–æ¶ˆæ‰æ³¨é‡Šéƒ¨åˆ†çš„è¯ï¼Œå³å­è¿›ç¨‹ç­‰å¾…çˆ¶è¿›ç¨‹æ‰§è¡Œä¸€æ®µæ—¶é—´ã€‚ä½†çˆ¶è¿›ç¨‹æ‰§è¡Œå®Œåï¼Œå­è¿›ç¨‹å°±ä¸ä¼šå†æ‰§è¡Œäº†(è¿™é‡Œæ˜¯çˆ¶è¿›ç¨‹æ­»äº†æ‰€æœ‰å­è¿›ç¨‹ä¹Ÿä¼šè·Ÿç€æ­»å—ï¼Ÿ) ----ä¸ä¼š (èƒ½å¤Ÿé€šè¿‡ps -efçœ‹åˆ°)<br>å­¤å„¿è¿›ç¨‹ï¼šçˆ¶è¿›ç¨‹é€€å‡ºåï¼Œå­è¿›ç¨‹è¿˜åœ¨è¿è¡Œã€‚å°†è¢«initè¿›ç¨‹æ‰€æ”¶å…»</p><p>è¿˜æœ‰ä¸€ç‚¹ï¼šå¦‚æœcountæ˜¯å…¨å±€å˜é‡ï¼Œç»“æœä¹Ÿæ˜¯ä¸€æ ·çš„ï¼ˆå…¨å±€å˜é‡ä¹Ÿä¼šè¢«æ‹·è´ï¼‰</p><p>å†æ¥çœ‹ä¸€æ®µä»£ç </p><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">fork_test_2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"program begin with pid%6d  ppid%6d \n"</span><span class="token punctuation">,</span><span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getppid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">pid_t</span> id<span class="token punctuation">;</span>    <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    count <span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span><span class="token number">2</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        id <span class="token operator">=</span> <span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"this is son process, pid %6d ppid %6d\n"</span><span class="token punctuation">,</span><span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">getppid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"forkid is %d\n"</span> <span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">></span> <span class="token number">0</span> <span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"this is father process, pid %6d ppid %6d\n"</span><span class="token punctuation">,</span><span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">getppid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"forkid is %d\n"</span> <span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"program end\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>ç»“æœå¯ä»¥è‡ªè¡ŒéªŒè¯</p><div class="code-wrapper"><pre class="language-shell" data-language="shell"><code class="language-shell">program begin with pid  7056  ppid  2930 this is father process, pid   7056 ppid   2930forkid is 7057this is son process, pid   7057 ppid   7056forkid is 0this is father process, pid   7056 ppid   2930forkid is 7058program endthis is son process, pid   7058 ppid   7056forkid is 0program endthis is father process, pid   7057 ppid   7056forkid is 7059program endthis is son process, pid   7059 ppid   7057forkid is 0program endProcess finished with exit code 0</code></pre></div><p>ä»ç»“æœæ¥çœ‹ï¼Œä¼¼ä¹æ€»æ˜¯åå‘å…ˆè¿›è¡Œçˆ¶è¿›ç¨‹çš„å‡½æ•°ï¼Œå†æ‰§è¡Œå­è¿›ç¨‹çš„å‡½æ•°ï¼Ÿï¼ˆçŒœæµ‹ä¹Ÿå¯èƒ½æ˜¯å› ä¸ºä¸ºå­è¿›ç¨‹åˆ’åˆ†åœ°å€æ—¶çˆ¶è¿›ç¨‹å°±å·²ç»åœ¨runäº†ï¼Ÿï¼‰</p><p>çœ‹ä¸€ä¸‹è¿™æ®µä»£ç ï¼Œæœ€ç»ˆæœ‰å¤šå°‘ä¸ªçº¿ç¨‹ï¼Ÿï¼Ÿç»“æœæ˜¯20ä¸ªï¼Œå¯ä»¥ç”¨è¿›ç¨‹äºŒå‰æ ‘çš„æ–¹æ³•å†æ¨ä¸€ä¸‹</p><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"+/n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><h2 id="å†…æ ¸æ€">å†…æ ¸æ€</h2><p><strong>ç†è§£ä¸ºä½•è¦æœ‰å†…æ ¸æ€ï¼Ÿ</strong></p><p>å®‰å…¨ã€å¯æ§ã€‚åœ¨è¿›è¡Œç³»ç»Ÿè°ƒç”¨ã€é‡åˆ°å¼‚å¸¸ã€å¤–å›´è®¾å¤‡ä¸­æ–­å‘ç”Ÿçš„æ—¶å€™ç­‰ï¼Œè¿›ç¨‹éœ€è¦ä»ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€å®ç°ä¸€ä¸ªå†…é™·ã€‚æ­¤æ—¶æ‰§è¡Œä»£ç ä¼šä½¿ç”¨åˆ°å½“å‰è¿›ç¨‹çš„å†…æ ¸æ ˆ</p><h3 id="task-struct">task_struct</h3><p>æ¯ä¸ªè¿›ç¨‹éƒ½è¦å†…æ ¸ä¸­æœ‰ä¸€ä¸ªè¿›ç¨‹æ§åˆ¶å—ï¼ˆPCBï¼‰æ¥ç»´æŠ¤è¿›ç¨‹ç›¸å…³çš„ä¿¡æ¯ï¼Œ<strong>task_struct</strong>å°±æ˜¯è¿™æ ·çš„ç»“æ„ä½“ã€‚</p><p>ä¸€äº›é‡è¦çš„æˆå‘˜å±æ€§:</p><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c"><span class="token comment">// kernel 5.14.15</span><span class="token comment">// taskçš„å¯èƒ½çŠ¶æ€</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TASK_RUNNING</span><span class="token expression"><span class="token number">0x0000</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TASK_INTERRUPTIBLE</span><span class="token expression"><span class="token number">0x0001</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TASK_UNINTERRUPTIBLE</span><span class="token expression"><span class="token number">0x0002</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">__TASK_STOPPED</span><span class="token expression"><span class="token number">0x0004</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">__TASK_TRACED</span><span class="token expression"><span class="token number">0x0008</span></span></span><span class="token comment">/* Used in tsk->exit_state: */</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">EXIT_DEAD</span><span class="token expression"><span class="token number">0x0010</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">EXIT_ZOMBIE</span><span class="token expression"><span class="token number">0x0020</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">EXIT_TRACE</span><span class="token expression"><span class="token punctuation">(</span>EXIT_ZOMBIE <span class="token operator">|</span> EXIT_DEAD<span class="token punctuation">)</span></span></span><span class="token comment">/* Used in tsk->state again: */</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TASK_PARKED</span><span class="token expression"><span class="token number">0x0040</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TASK_DEAD</span><span class="token expression"><span class="token number">0x0080</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TASK_WAKEKILL</span><span class="token expression"><span class="token number">0x0100</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TASK_WAKING</span><span class="token expression"><span class="token number">0x0200</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TASK_NOLOAD</span><span class="token expression"><span class="token number">0x0400</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TASK_NEW</span><span class="token expression"><span class="token number">0x0800</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TASK_STATE_MAX</span><span class="token expression"><span class="token number">0x1000</span></span></span><span class="token comment">/* Convenience macros for the sake of set_current_state: */</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TASK_KILLABLE</span><span class="token expression"><span class="token punctuation">(</span>TASK_WAKEKILL <span class="token operator">|</span> TASK_UNINTERRUPTIBLE<span class="token punctuation">)</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TASK_STOPPED</span><span class="token expression"><span class="token punctuation">(</span>TASK_WAKEKILL <span class="token operator">|</span> __TASK_STOPPED<span class="token punctuation">)</span></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TASK_TRACED</span><span class="token expression"><span class="token punctuation">(</span>TASK_WAKEKILL <span class="token operator">|</span> __TASK_TRACED<span class="token punctuation">)</span></span></span><span class="token keyword">struct</span> <span class="token class-name">task_struct</span> <span class="token punctuation">&#123;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">CONFIG_THREAD_INFO_IN_TASK</span></span><span class="token keyword">struct</span> <span class="token class-name">thread_info</span>thread_info<span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> <span class="token keyword">int</span>cpu<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>    <span class="token keyword">unsigned</span> <span class="token keyword">int</span>__state<span class="token punctuation">;</span> <span class="token comment">// è¿›ç¨‹çŠ¶æ€</span><span class="token keyword">void</span><span class="token operator">*</span>stack<span class="token punctuation">;</span> <span class="token comment">// æŒ‡å‘å†…æ ¸æ ˆçš„æŒ‡é’ˆ</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span>flags<span class="token punctuation">;</span> <span class="token comment">// è¿›ç¨‹å·ï¼Œforkæ—¶ç»™å‡º</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span>ptrace<span class="token punctuation">;</span> <span class="token comment">// è¢«ç”¨æ¥æ§åˆ¶å­è¿›ç¨‹çš„è¿è¡Œ(æ–­ç‚¹è°ƒè¯•),ä¸º0æ—¶ä»£è¡¨ä¸éœ€è¦è¢«è¿½è¸ª</span>    <span class="token class-name">pid_t</span>pid<span class="token punctuation">;</span> <span class="token comment">// è¿›ç¨‹æ ‡è¯†ç¬¦</span><span class="token class-name">pid_t</span>tgid<span class="token punctuation">;</span> <span class="token comment">// çº¿ç¨‹ç»„æ ‡è¯†ç¬¦ï¼ˆUnixå¸Œæœ›åŒä¸€ç»„çº¿ç¨‹å…·æœ‰ç›¸åŒçš„pidï¼Œä¸é¢†å¤´çº¿ç¨‹å…·æœ‰ç›¸åŒçš„pidï¼‰</span><span class="token keyword">int</span>prio<span class="token punctuation">;</span> <span class="token comment">// åŠ¨æ€ä¼˜å…ˆçº§</span><span class="token keyword">int</span>static_prio<span class="token punctuation">;</span> <span class="token comment">// ä¿å­˜é™æ€ä¼˜å…ˆçº§</span><span class="token keyword">int</span>normal_prio<span class="token punctuation">;</span> <span class="token comment">// å´ç»é™æ€ä¼˜å…ˆçº§å’Œè°ƒåº¦ç­–ç•¥</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span>rt_priority<span class="token punctuation">;</span> <span class="token comment">// ä¿å­˜å®æ—¶ä¼˜å…ˆçº§</span>    <span class="token keyword">unsigned</span> <span class="token keyword">int</span>policy<span class="token punctuation">;</span> <span class="token comment">// è¿›ç¨‹çš„è°ƒåº¦ç­–ç•¥(sched_normal sched_fifo....)</span><span class="token keyword">struct</span> <span class="token class-name">list_head</span>tasks<span class="token punctuation">;</span> <span class="token comment">// æŒ‡å‘è¿è¡Œé˜Ÿåˆ—çš„æŒ‡é’ˆ</span><span class="token keyword">struct</span> <span class="token class-name">mm_struct</span><span class="token operator">*</span>mm<span class="token punctuation">;</span> <span class="token comment">// è¿›ç¨‹å†…å­˜ç®¡ç†ä¿¡æ¯</span><span class="token keyword">struct</span> <span class="token class-name">mm_struct</span><span class="token operator">*</span>active_mm<span class="token punctuation">;</span><span class="token keyword">int</span>exit_state<span class="token punctuation">;</span><span class="token keyword">int</span>exit_code<span class="token punctuation">;</span> <span class="token comment">// åªæœ‰è¿›ç¨‹ç»ˆæ­¢æ—¶ï¼Œæ‰ä¼šè¾¾åˆ°è¿™é‡Œ</span><span class="token keyword">int</span>exit_signal<span class="token punctuation">;</span>    <span class="token keyword">int</span>pdeath_signal<span class="token punctuation">;</span> <span class="token comment">// çˆ¶è¿›ç¨‹ç»ˆæ­¢æ—¶å‘å­è¿›ç¨‹å‘é€çš„ä¿¡å·</span>    <span class="token comment">/* Real parent process: */</span><span class="token keyword">struct</span> <span class="token class-name">task_struct</span> __rcu<span class="token operator">*</span>real_parent<span class="token punctuation">;</span> <span class="token comment">// æŒ‡å‘æ“ä½œç³»ç»Ÿæ‰§è¡Œè¿›ç¨‹çš„çˆ¶è¿›ç¨‹ï¼ˆäº²ç”Ÿçˆ¶äº²ï¼‰ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™æŒ‡å‘initè¿›ç¨‹</span><span class="token comment">/* Recipient of SIGCHLD, wait4() reports: */</span><span class="token keyword">struct</span> <span class="token class-name">task_struct</span> __rcu<span class="token operator">*</span>parent<span class="token punctuation">;</span> <span class="token comment">// æŒ‡å‘å½“å‰è¿›ç¨‹çš„çˆ¶è¿›ç¨‹ï¼ˆå¯èƒ½æ˜¯ç»§çˆ¶ï¼‰ï¼Œå½“å½“å‰è¿›ç¨‹ç»ˆæ­¢æ—¶ï¼Œéœ€è¦å‘å®ƒå‘é€wait4()ä¿¡å·</span>    <span class="token keyword">struct</span> <span class="token class-name">list_head</span>children<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">list_head</span>sibling<span class="token punctuation">;</span> <span class="token comment">// åŒçº§çº¿ç¨‹</span><span class="token keyword">struct</span> <span class="token class-name">task_struct</span><span class="token operator">*</span>group_leader<span class="token punctuation">;</span> <span class="token comment">// è¿›ç¨‹ç»„çš„é¢†å¤´è¿›ç¨‹</span>    <span class="token keyword">struct</span> <span class="token class-name">pid</span><span class="token operator">*</span>thread_pid<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">files_struct</span><span class="token operator">*</span>files<span class="token punctuation">;</span> <span class="token comment">// æ‰“å¼€æ–‡ä»¶çš„ä¿¡æ¯æŒ‡é’ˆ</span><span class="token keyword">struct</span> <span class="token class-name">signal_struct</span><span class="token operator">*</span>signal<span class="token punctuation">;</span>    <span class="token keyword">struct</span> <span class="token class-name">thread_struct</span>thread<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><h3 id="thread-info">thread_info</h3><p>å¯¹çº¿ç¨‹ä¸åŒçš„ä¸€ä¸ªä¿¡æ¯æè¿°ï¼Œçº¿ç¨‹æè¿°ç¬¦</p><p>linuxå†…æ ¸ä¸ºæ¯ä¸ªè¿›ç¨‹éƒ½æä¾›äº†ä¸€ä¸ªå†…æ ¸æ ˆã€‚linuxå†…æ ¸æ”¯æŒä¸åŒä½“ç³»ï¼Œä½†ä¸åŒä½“ç³»å¯èƒ½è¿›ç¨‹éœ€è¦å­˜å‚¨çš„ä¿¡æ¯ä¸åŒï¼ˆåé¢ä¼šæåˆ°ï¼‰ï¼Œåˆ™éœ€è¦ä¸€ç§é€šç”¨çš„æ–¹å¼ï¼Œå°†ä½“ç³»ç»“æ„ç›¸å…³çš„éƒ¨åˆ†å’Œæ— å…³çš„éƒ¨åˆ†åŒºåˆ†ã€‚ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆä¼šæœ‰task_structå’Œthread_infoã€‚<br>task_structæä¾›äº†ä¸€ç§é€šç”¨çš„æ–¹å¼æ¥æè¿°è¿›ç¨‹ã€‚<br>thread_infoä½¿å¾—ç‰¹å®šä½“ç³»éœ€è¦è®¿é—®çš„é‚£éƒ¨åˆ†è¿›ç¨‹çš„æ•°æ®ï¼Œèƒ½<strong>é€šè¿‡thread_infoæ¥æ‰¾åˆ°task_struct</strong></p><h4 id="ç»“æ„-v3">ç»“æ„</h4><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c"><span class="token comment">// kernel 2.6.32.20</span><span class="token keyword">struct</span> <span class="token class-name">thread_info</span> <span class="token punctuation">&#123;</span><span class="token keyword">struct</span> <span class="token class-name">task_struct</span><span class="token operator">*</span>task<span class="token punctuation">;</span><span class="token comment">/* main task structure */</span><span class="token keyword">struct</span> <span class="token class-name">exec_domain</span><span class="token operator">*</span>exec_domain<span class="token punctuation">;</span><span class="token comment">/* execution domain */</span>__u32flags<span class="token punctuation">;</span><span class="token comment">/* low level flags */</span>__u32status<span class="token punctuation">;</span><span class="token comment">/* thread synchronous flags */</span>__u32cpu<span class="token punctuation">;</span><span class="token comment">/* current CPU */</span><span class="token keyword">int</span>preempt_count<span class="token punctuation">;</span><span class="token comment">/* 0 => preemptable,   &lt;0 => BUG */</span><span class="token class-name">mm_segment_t</span>addr_limit<span class="token punctuation">;</span><span class="token keyword">struct</span> <span class="token class-name">restart_block</span>    restart_block<span class="token punctuation">;</span><span class="token keyword">void</span> __user<span class="token operator">*</span>sysenter_return<span class="token punctuation">;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token keyword">int</span>uaccess_err<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></code></pre></div><h4 id="thread-union">thread_union</h4><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c"><span class="token comment">// on linux-5.14.15</span><span class="token keyword">union</span> thread_union <span class="token punctuation">&#123;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">CONFIG_ARCH_TASK_STRUCT_ON_STACK</span></span>       <span class="token keyword">struct</span> <span class="token class-name">task_struct</span> task<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">CONFIG_THREAD_INFO_IN_TASK</span></span>       <span class="token keyword">struct</span> <span class="token class-name">thread_info</span> thread_info<span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>       <span class="token keyword">unsigned</span> <span class="token keyword">long</span> stack<span class="token punctuation">[</span>THREAD_SIZE<span class="token operator">/</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">// on linux 2.6.32.20</span><span class="token keyword">union</span> thread_union <span class="token punctuation">&#123;</span><span class="token keyword">struct</span> <span class="token class-name">thread_info</span> thread_info<span class="token punctuation">;</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> stack<span class="token punctuation">[</span>THREAD_SIZE<span class="token operator">/</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></code></pre></div><p>åœ¨ç‰©ç†å†…å­˜ä¸­å­˜æ”¾ä¸¤ç§æ•°æ®ç»“æ„çš„æ–¹å¼ï¼š</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211028202934914.png" alt="image-20211028202934914"></p><p>é‡‡ç”¨è”åˆä½“çš„æ–¹å¼ï¼Œæ‰€ä»¥thread_infoåœ¨æ ˆé¡¶å¯ç†è§£ã€‚ä»ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€æ—¶ï¼Œè¿›ç¨‹çš„å†…æ ¸æ ˆæ€»æ˜¯ç©ºçš„ï¼Œå› æ­¤espå¯„å­˜å™¨æŒ‡å‘è¿™ä¸ªæ ˆçš„é¡¶ç«¯</p><p>ç³»ç»Ÿçš„currentæŒ‡é’ˆæŒ‡å‘äº†å½“å‰è¿è¡Œè¿›ç¨‹çš„thread_union</p><h4 id="current-thread-info">current_thread_info</h4><p>è·å–å½“å‰CPUä¸Šæ­£è¿è¡Œçš„è¿›ç¨‹ã€‚é€šå¸¸ä¿å­˜åœ¨ä¸€ä¸ªç‰¹åˆ«çš„å¯„å­˜å™¨ä¸­(esp)</p><p>current_thread_info</p><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c"><span class="token comment">// æ—©æœŸç‰ˆæœ¬ return (struct thread_info *)(sp &amp; ~(THREAD_SIZE - 1));</span><span class="token comment">// å› ä¸ºä¸éœ€è¦å¯¹64ä½å¤„ç†å™¨æ”¯æŒï¼Œæ‰€ä»¥ç®€å•å±è”½æ‰espçš„ä½13ä½æœ‰æ•ˆå­—ç¬¦å°±è¡Œ(ä¸ºå•¥ï¼Ÿ)->stackå 8Kä¸¤é¡µ .äºŒè¿›åˆ¶çš„è¡¨ç¤ºä¸º0000 0000 0000 0000 0010 0000 0000 0000ã€‚</span><span class="token operator">~</span><span class="token punctuation">(</span>THREAD_SIZE<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>çš„ç»“æœåˆšå¥½ä¸º<span class="token number">1111</span> <span class="token number">1111</span> <span class="token number">1111</span> <span class="token number">1111</span> <span class="token number">1110</span> <span class="token number">0000</span> <span class="token number">0000</span> <span class="token number">0000</span><span class="token keyword">static</span> <span class="token keyword">inline</span> <span class="token keyword">struct</span> <span class="token class-name">thread_info</span> <span class="token operator">*</span><span class="token function">current_thread_info</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">struct</span> <span class="token class-name">thread_info</span> <span class="token operator">*</span>ti<span class="token punctuation">;</span>ti <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">percpu_read_stable</span><span class="token punctuation">(</span>kernel_stack<span class="token punctuation">)</span> <span class="token operator">+</span>      KERNEL_STACK_OFFSET <span class="token operator">-</span> THREAD_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> ti<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><h4 id="get-current">get_current</h4><p>è·å–task_struct å®è´¨ä¸Šå°±æ˜¯thread_info-&gt;taskã€‚currentè·å–çš„å½“å‰çº¿ç¨‹å¯¹è±¡å…¶å®æ˜¯ä¸€ä¸ªåä¸ºcurrent_taskçš„percpuå˜é‡ã€‚é€šè¿‡this_cpu_read_stableæ–¹æ³•ï¼Œ<strong>è·å–å±äºå½“å‰cpuçš„current_task</strong>ã€‚</p><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c"><span class="token comment">// kernel 2.6.32.20</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">__ASSEMBLY__</span></span><span class="token keyword">struct</span> <span class="token class-name">task_struct</span><span class="token punctuation">;</span><span class="token function">DECLARE_PER_CPU</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">task_struct</span> <span class="token operator">*</span><span class="token punctuation">,</span> current_task<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä¸ºå¤„ç†å™¨åˆ›å»ºä¸€ä¸ªtypeç±»å‹ï¼Œåä¸ºnameçš„å˜é‡</span><span class="token keyword">static</span> __always_inline <span class="token keyword">struct</span> <span class="token class-name">task_struct</span> <span class="token operator">*</span><span class="token function">get_current</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   <span class="token keyword">return</span> <span class="token function">percpu_read_stable</span><span class="token punctuation">(</span>current_task<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">percpu_read_stable</span><span class="token expression"><span class="token punctuation">(</span>var<span class="token punctuation">)</span><span class="token function">percpu_from_op</span><span class="token punctuation">(</span></span><span class="token string">"mov"</span><span class="token expression"><span class="token punctuation">,</span> per_cpu__</span><span class="token punctuation">##</span><span class="token expression">var<span class="token punctuation">,</span></span><span class="token punctuation">\</span>       <span class="token string">"p"</span> <span class="token expression"><span class="token punctuation">(</span><span class="token operator">&amp;</span>per_cpu__</span><span class="token punctuation">##</span><span class="token expression">var<span class="token punctuation">)</span><span class="token punctuation">)</span></span></span><span class="token comment">/*#define percpu_from_op(op, var, constraint)\(&#123;\typeof(var) ret__;\switch (sizeof(var)) &#123;\case 1:\asm(op "b "__percpu_arg(1)",%0"\    : "=q" (ret__)\    : constraint);\break;\case 2:\asm(op "w "__percpu_arg(1)",%0"\    : "=r" (ret__)\    : constraint);\break;\case 4:\asm(op "l "__percpu_arg(1)",%0"\    : "=r" (ret__)\    : constraint);\break;\case 8:\asm(op "q "__percpu_arg(1)",%0"\    : "=r" (ret__)\    : constraint);\break;\default: __bad_percpu_size();\&#125;\ret__;\&#125;)*/</span> <span class="token comment">// x86-64ä¸‹ = asm(movl "%%gs:%P1","%0" : "=r" (var) :"p" (&amp;(var)) </span></code></pre></div><p><strong>çªå‘å…¶æƒ³</strong></p><p>æä¸€ä¸ªè°ƒè¯•linuxæºä»£ç çš„å·¥å…· ï¼ŒæŸ¥äº†ä¸‹ remote ssh+vscodeæ¥æï¼Œæ„Ÿè§‰ä¸é”™</p><p>â˜ï¸ ä»¥ä¸Šå·²ç»å®Œæˆï¼Œè¯¦è§ã€ŠQemu+gdb+vscodeè°ƒè¯•å†…æ ¸ã€‹ğŸ‘</p><h2 id="ä¸€äº›é—®é¢˜-v6">ä¸€äº›é—®é¢˜</h2><p><strong>ç–‘é—®ï¼Ÿ getpidåœ¨å“ªä¸ªæ–‡ä»¶ï¼Ÿåªæœ‰å¤´æ–‡ä»¶çš„å£°æ˜å•Šï¼Œæ²¡æœ‰æ‰¾åˆ°å…·ä½“ä»£ç ï¼Ÿ</strong></p><p><strong>ia64 x86ç­‰æ¶æ„ï¼Ÿ</strong></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>æ·±å…¥C/C++</title>
    <link href="/2021/10/27/%E6%B7%B1%E5%85%A5C-C/"/>
    <url>/2021/10/27/%E6%B7%B1%E5%85%A5C-C/</url>
    
    <content type="html"><![CDATA[<h1>æ·±å…¥C / C++</h1><h2 id="ä¸€äº›é—®é¢˜-v5">ä¸€äº›é—®é¢˜</h2><h3 id="å¦‚ä½•åœ¨Cä¸­ä½¿ç”¨æ±‡ç¼–ä»£ç ï¼Ÿ">å¦‚ä½•åœ¨Cä¸­ä½¿ç”¨æ±‡ç¼–ä»£ç ï¼Ÿ</h3><h3 id="å®åˆ°åº•æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ">å®åˆ°åº•æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ</h3><p>é¢„ç¼–è¯‘å—ï¼Ÿ</p><p>é¢„å¤„ç†å‘½ä»¤ï¼ˆä»¥#å¼€å¤´çš„éƒ½æ˜¯é¢„å¤„ç†å‘½ä»¤ï¼‰</p><p>ä¼˜ç‚¹ï¼š</p><ol><li>æ–¹ä¾¿ç¨‹åºä¿®æ”¹ï¼Œåœ¨ç¼–è¯‘æœŸé—´ä¼šè¢«æ›¿æ¢ï¼ˆè€Œå…¨å±€å˜é‡éœ€è¦åœ¨è¿è¡Œæ—¶æ‰è¢«ï¼‰<ul><li>è¿è¡Œä¸­æ²¡æœ‰å®è¿™ä¸ªæ¦‚å¿µï¼Œä»…ä»…æ˜¯å†…å®¹</li><li>å®å®šä¹‰èµ‹å€¼åä¸èƒ½è¢«ä¿®æ”¹</li></ul></li><li>é«˜æ•ˆã€‚</li></ol><p>ç¼ºç‚¹ï¼š</p><ol><li>å ç”¨ç¼–è¯‘æ—¶é—´</li><li>æºç¨‹åºå±•å¼€åå¾ˆé•¿</li></ol><p><a href="https://blog.csdn.net/imgosty/article/details/81901183">Cè¯­è¨€ä¸­å®å®šä¹‰çš„ä½¿ç”¨</a></p><h3 id="EOFæ˜¯ä»€ä¹ˆ">EOFæ˜¯ä»€ä¹ˆ</h3>]]></content>
    
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>C</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linuxå†…æ ¸å­¦ä¹ </title>
    <link href="/2021/10/25/Linux%E5%86%85%E6%A0%B8%E5%AD%A6%E4%B9%A0/"/>
    <url>/2021/10/25/Linux%E5%86%85%E6%A0%B8%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1>Linuxå­¦ä¹ </h1><blockquote><p>â€œå·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨â€</p><p>ä»å¤§äºŒä»¥æ¥ä¸€ç›´åœ¨ç”¨manjaro ï¼Œä»åŸæ¥çš„æä¸ºä¸é€‚åº”åˆ°ç°åœ¨ç”¨èµ·æ¥ååˆ†â€œèˆ’å¿ƒâ€ï¼ŒLinuxç¡®å®ç»™æˆ‘ä¸€ç§æ›´é«˜æ•ˆã€æ›´ç®€æ´çš„æ“ä½œæ–¹å¼ã€‚åœ¨å¤§äºŒäº†è§£ä¸€å®šçš„æ“ä½œç³»ç»Ÿç»„æˆåŸç†æ—¶ï¼Œä¹Ÿå¯¹Linuxç³»ç»Ÿçš„å†…æ ¸æ„æˆäº§ç”Ÿäº†å…´è¶£ï¼Œå¯¹fork mallocç­‰å‡½æ•°åªçŸ¥å…¶ä¹‰è€Œä¸çŸ¥å…¶æ„ã€‚å¸Œæœ›èƒ½å¤Ÿé€šè¿‡æ­¤ç¯‡åšå®¢ç³»ç»Ÿçš„å­¦ä¹ ï¼Œä»Linuxå†…æ ¸å±‚é¢å»ç†è§£æ“ä½œç³»ç»Ÿçš„ç»„æˆåŸç†ã€‚å¯¹Linuxæœ‰ä¸€ä¸ªå…¨å±€çš„è§‚å¿µï¼Œæ›´å¥½åœ°ä½¿ç”¨Linuxç³»ç»Ÿ</p></blockquote><h2 id="å†å²">å†å²</h2><h3 id="Unix">Unix</h3><p>ä»ä¸€ä¸ªå¤±è´¥çš„å¤šç”¨æˆ·æ“ä½œç³»ç»ŸMulticsè¡ç”Ÿè€Œæ¥</p><p>BSDï¼šåŠ å·å¤§å­¦ä¼¯å…‹åˆ©åˆ†æ ¡çš„æ¼”åŒ–åˆ†æ”¯</p><p>ä¼˜ç‚¹ï¼š</p><ul><li>ç®€æ´ã€‚æä¾›å‡ ç™¾ä¸ªç³»ç»Ÿè°ƒç”¨</li><li>å¤§éƒ¨åˆ†æ–‡ä»¶è¢«å½“åšæ–‡ä»¶æ¥å¯¹å¾…ï¼Œä½¿å¾—å¯ç”¨åŒä¸€å¥—ç›¸åŒçš„ç³»ç»Ÿè°ƒç”¨æ¥å£å¯å¯¹æ•°æ®å’Œè®¾å¤‡è¿›è¡Œæ“ä½œ</li><li>å†…æ ¸å’Œç›¸å…³çš„ç³»ç»Ÿå·¥å…·è½¯ä»¶é€šè¿‡Cè¯­è¨€ç¼–å†™ï¼Œæ˜“ç§»æ¤</li><li>åˆ›å»ºè¿›ç¨‹éå¸¸è¿…é€Ÿï¼Œ<strong>ä¸€æ¬¡æ‰§è¡Œä¿è´¨ä¿é‡åœ°å®Œæˆä¸€ä¸ªä»»åŠ¡</strong></li><li>ç®€å•è€Œç¨³å®šçš„è¿›ç¨‹é—´é€šä¿¡å…ƒè¯­ï¼Œä¿è¯è¿™äº›å•ä¸€ç›®çš„çš„ç®€å•ç¨‹åºå¯ä»¥æ–¹ä¾¿çš„ç»„åˆåœ¨ä¸€èµ·</li></ul><h3 id="Linux">Linux</h3><p>1991å¹´ by Linus Torvaldsï¼Œä¸èƒ½éšå¿ƒæ‰€æ¬²åœ°ä½¿ç”¨Unixã€‚</p><p>ç±»Unixç³»ç»Ÿï¼Œä½†ä¸æ˜¯Unixã€‚å°½ç®¡Linuxå€Ÿé‰´äº†Unixçš„è®¸å¤šè®¾è®¡å¹¶ä¸”å®ç°äº†Unixçš„APIï¼Œä½†Linuxæ²¡æœ‰åƒå…¶ä»–Unixå˜ç§é‚£æ ·ç›´æ¥ä½¿ç”¨Unixçš„æºä»£ç ã€‚ä½†æ²¡æœ‰æŠ›å¼ƒUnixçš„è®¾è®¡ç›®æ ‡å¹¶ä¸”ä¿è¯äº†åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£çš„ä¸€è‡´æ€§ã€‚</p><p><strong>Linuxå’ŒUnixåŒºåˆ«</strong></p><ul><li>Unixå†…æ ¸æ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„é™æ€å¯æ‰§è¡Œåº“ï¼Œå¿…é¡»ä»¥å·¨å¤§ã€å•ç‹¬çš„å¯æ‰§è¡Œå—çš„å½¢å¼åœ¨ä¸€ä¸ªå•ç‹¬çš„åœ°å€ç©ºé—´ä¸­è¿è¡Œã€‚éœ€è¦ç¡¬ä»¶æä¾›é¡µæœºåˆ¶ç®¡ç†å†…å­˜ã€‚</li></ul><p><strong>å•å†…æ ¸å’Œå¾®å†…æ ¸</strong></p><p>å•å†…æ ¸ï¼Œå†…æ ¸ä»æ•´ä½“ä¸Šä½œä¸ºä¸€ä¸ªå•ç‹¬çš„å¤§è¿‡ç¨‹æ¥å®ç°ï¼Œè¿è¡Œåœ¨ä¸€ä¸ªå•ç‹¬çš„åœ°å€ç©ºé—´ä¸Šã€‚ï¼ˆé€šå¸¸ä»¥å•ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„å½¢å¼å­˜æ”¾åœ¨ç£ç›˜ä¸­ï¼‰æ‰€æœ‰çš„å†…æ ¸æœåŠ¡éƒ½åœ¨è¿™æ ·çš„ä¸€ä¸ªå¤§å†…æ ¸åœ°å€ç©ºé—´å…è®¸ã€‚å†…æ ¸å¯ä»¥ç›´æ¥è°ƒç”¨å‡½æ•°ï¼Œç®€å•ä¸”é«˜æ€§èƒ½ã€‚å¤§å¤šæ•°Unixç³»ç»Ÿè®¾è®¡ä¸ºå•æ¨¡å—</p><p>å¾®å†…æ ¸ï¼ŒåŠŸèƒ½è¢«åˆ’åˆ†æˆå¤šä¸ªç‹¬ç«‹çš„è¿‡ç¨‹ï¼Œæ¯ä¸ªè¿‡ç¨‹å«åšä¸€ä¸ªæœåŠ¡å™¨ã€‚æ‰€æœ‰æœåŠ¡å™¨éƒ½ä¿æŒç‹¬ç«‹å¹¶è¿è¡Œåœ¨å„è‡ªçš„åœ°å€ç©ºé—´ä¸Šï¼Œä¸èƒ½ç›´æ¥è¿›è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œéœ€è¦é€šè¿‡æ¶ˆæ¯ä¼ é€’å¤„ç†å¾®å†…æ ¸é€šä¿¡ï¼ˆè¿›ç¨‹é—´é€šä¿¡IPCï¼‰ã€‚å„ä¸ªæœåŠ¡å™¨ä¹‹é—´é€šè¿‡IPCæœºåˆ¶äº’é€šæ¶ˆæ¯ï¼Œäº’æ¢æœåŠ¡ã€‚å„è‡ªç‹¬ç«‹èƒ½æœ‰æ•ˆé¿å…ä¸€ä¸ªæœåŠ¡å™¨å¤±æ•ˆå¯¼è‡´å…¨ç›˜éƒ½ä¸èƒ½ç”¨çš„ç°è±¡</p><p>Linuxä¹Ÿæ˜¯ä¸€ä¸ªå•å†…æ ¸ï¼Œå†…æ ¸è¿è¡Œåœ¨å•ç‹¬çš„å†…æ ¸åœ°å€ç©ºé—´ï¼Œä¸è¿‡é‡‡ç”¨äº†æ¨¡å—åŒ–è®¾è®¡ã€æŠ¢å å¼å†…æ ¸ã€å†…æ ¸çº¿ç¨‹ä»¥åŠåŠ¨æ€è£…è½½å†…æ ¸æ¨¡å—ã€‚è¿˜èƒ½è®©æ‰€æœ‰åŠŸèƒ½è¿è¡Œåœ¨å†…æ ¸æ€ï¼Œç›´æ¥è°ƒç”¨å‡½æ•°è€Œæ— éœ€æ¶ˆæ¯ä¼ é€’ã€‚</p><ul><li><p>æ”¯æŒåŠ¨æ€åŠ è½½å†…æ ¸æ¨¡å—ï¼Œèƒ½å¤Ÿåœ¨éœ€è¦çš„æ—¶å€™åŠ¨æ€å¸è½½å’ŒåŠ è½½éƒ¨åˆ†å†…æ ¸ä»£ç ï¼ˆéè€¦åˆçš„éƒ¨åˆ†å—ï¼Ÿï¼‰</p></li><li><p>æ”¯æŒå¯¹ç§°å¤šå¤„ç†(SMP)æœºåˆ¶</p></li><li><p>å†…æ ¸å¯ä»¥æŠ¢å ã€‚å…è®¸åœ¨å†…æ ¸è¿è¡Œçš„ä»»åŠ¡ä¼˜å…ˆæ‰§è¡Œçš„èƒ½åŠ›ï¼ˆè€Œå¤§å¤šæ•°Unixå†…æ ¸ä¸æ”¯æŒï¼‰</p></li><li><p>å†…æ ¸å¹¶ä¸åŒºåˆ†çº¿ç¨‹å’Œå…¶ä»–çš„ä¸€èˆ¬è¿›ç¨‹ã€‚è¿›ç¨‹åªæ˜¯å…¶ä¸­çš„ä¸€äº›å…±äº«èµ„æºç½¢äº†</p></li><li><p>æä¾›è®¾å¤‡ç±»çš„é¢å‘å¯¹è±¡çš„è®¾å¤‡æ¨¡å‹ã€çƒ­æ’äº‹ä»¶ã€ç”¨æˆ·æ§ä»¶çš„è®¾å¤‡æ–‡ä»¶ç³»ç»Ÿsysfs</p></li><li><p>å¿½ç•¥äº†Unixä¸­ç±»ä¼¼STREAMSçš„ä¸€äº›ç‰¹æ€§</p></li></ul><p><strong>Linuxçš„å†…æ ¸ç‰ˆæœ¬</strong></p><p>ä¸»ç‰ˆæœ¬å· . ä»ç‰ˆæœ¬å· . ä¿®è®¢ç‰ˆæœ¬å· (. ç¨³å®šç‰ˆæœ¬å·)<br>ä»ç‰ˆæœ¬å·æ˜¯å¶æ•° -&gt; å†…æ ¸æ˜¯ç¨³å®šç‰ˆ    å¥‡æ•° -&gt; å¼€å‘ç‰ˆ</p><h2 id="-v4"></h2><h2 id="å¼€å§‹">å¼€å§‹</h2><h3 id="æºç -v2">æºç </h3><p>å†…æ ¸æºç ä¸€èˆ¬åœ¨/usr/src/linuxä¸­</p><h4 id="ç»“æ„-v2">ç»“æ„</h4><p><img src="https://img-blog.csdn.net/20170302212637409?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMDQ0NzIzNA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="img"></p><h4 id="ç¼–è¯‘-v2">ç¼–è¯‘</h4><h3 id="å†…æ ¸å¼€å‘çš„ç‰¹ç‚¹">å†…æ ¸å¼€å‘çš„ç‰¹ç‚¹</h3><ul><li>ä¸èƒ½è®¿é—®Cåº“å’Œæ ‡å‡†çš„Cå¤´æ–‡ä»¶ï¼ˆåŒ…å«Cåº“æ•ˆç‡å¤ªä½ä¸‹ï¼‰</li><li>ç¼–ç¨‹æ—¶éœ€è¦ç”¨GNU C</li><li>å†…æ ¸ç¼–ç¨‹éš¾ä»¥æ‰§è¡Œæµ®ç‚¹è¿ç®—</li><li>æ—¶åˆ»æ³¨æ„åŒæ­¥å’Œå¹¶å‘</li><li>ç¼ºä¹åƒç”¨æˆ·ç©ºé—´ä¸€æ ·çš„å†…å­˜ä¿æŠ¤æœºåˆ¶</li></ul><p><strong>å¤´æ–‡ä»¶</strong></p><p>æŒ‡å†…æ ¸çš„å¤´æ–‡ä»¶</p><p>åŸºæœ¬çš„å¤´æ–‡ä»¶åœ¨include ç›®å½•ä¸­<br>ä½“ç³»ç»“æ„ç›¸å…³çš„åœ¨arch/{spec_arch}/include/asmç›®å½•ä¸­</p><p><strong>GNU C</strong></p><p>Linuxå†…æ ¸ç”¨Cè¯­è¨€ç¼–å†™ã€‚</p><p><strong>gcc</strong>ï¼šç”±GUNå¼€å‘çš„ç¼–è¯‘å™¨ï¼ˆåˆè¡·æ˜¯ä½GNU OSç¼–å†™ä¸€æ¬¾ç¼–è¯‘å™¨ï¼‰ï¼ŒåŸåæ˜¯GNU C Compilerï¼Œåªèƒ½å¤„ç†Cè¯­è¨€ï¼Œä½†æ‰©å±•ä½å¯å¤„ç†C++ã€Javaã€goç­‰ï¼Œæ”¹åä¸ºGNUç¼–è¯‘å™¨å¥—ä»¶ï¼ˆGNU Compiler Collectionï¼‰ï¼Œå‡ ä¹æ‰€æœ‰çš„GCCéƒ½ç”±Cç¼–å†™ï¼Œå…¶ä¸­Cç¼–è¯‘å™¨æ—¢å¯ä»¥ç¼–è¯‘å†…æ ¸ä¹Ÿå¯ä»¥ç¼–è¯‘Linuxç³»ç»Ÿç”¨Cå†™çš„ä»£ç </p><div class="note note-success">            <p>ä»€ä¹ˆæ˜¯å†…è”å‡½æ•°ï¼Ÿ</p>          </div><p>ä¸€ç§ç¼–ç¨‹è¯­è¨€ç»“æ„ï¼Œç”¨æ¥å»ºè®®ç¼–è¯‘å™¨å¯¹ä¸€äº›ç‰¹æ®Šå‡½æ•°è¿›è¡Œå†…è”æ‰©å±•ã€‚ï¼ˆåœ¨å¥½åƒå‘¢ä¸ªç³»çš„æ¯ä¸ªè°ƒç”¨ç‚¹ä¸Šâ€œå†…è”åœ°â€å±•å¼€ï¼‰<br>ä¾‹å¦‚</p><div class="code-wrapper"><pre class="language-c++" data-language="c++"><code class="language-c++">inline int max(int a, int b)&#123; return a &gt; b ? a : b;&#125;&#x2F;&#x2F; åˆ™è°ƒç”¨ï¼š cout&lt;&lt;max(a, b)&lt;&lt;endl;&#x2F;&#x2F; åœ¨ç¼–è¯‘æ—¶å±•å¼€ä¸ºï¼š cout&lt;&lt;(a &gt; b ? a : b)&lt;&lt;endl;inline void Foo(int x, int y);   &#x2F;&#x2F; inline ä»…ä¸å‡½æ•°å£°æ˜æ”¾åœ¨ä¸€èµ· ä¸èµ·ä½œç”¨(å¯¹C++)</code></pre></div><p>ä¼˜ç‚¹ï¼š å‡½æ•°ä½“æ¯”è¾ƒå°æ—¶ï¼Œå†…è”å‡½æ•°è®©ç›®æ ‡ä»£ç æ›´åŠ é«˜æ•ˆã€‚<br>ç¼ºç‚¹ï¼š æ»¥ç”¨å†…è”å¯¼è‡´ç›®æ ‡ä»£ç é‡æˆ–å¢æˆ–å‡</p><p>æœ‰äº›å‡½æ•°å³ä½¿å£°æ˜ä¸ºinlineä½†ä¸ä¸€å®šä¼šè¢«ç¼–è¯‘å™¨å†…è”ï¼ˆé€’å½’å‡½æ•°å’Œè™šå‡½æ•°ï¼‰</p><h2 id="è¿›ç¨‹ç®¡ç†">è¿›ç¨‹ç®¡ç†</h2><h3 id="è¿›ç¨‹">è¿›ç¨‹</h3><p>è¿›ç¨‹æ˜¯å¤„äºæ‰§è¡Œå™¨çš„ç¨‹åºï¼šä¸€æ®µå¯æ‰§è¡Œçš„ä»£ç +æ‰“å¼€çš„æ–‡ä»¶+æŒ‚èµ·çš„ä¿¡å·+å†…æ ¸å†…éƒ¨æ•°æ®+å¤šä¸ªæ‰§è¡Œçº¿ç¨‹+å¤„ç†å™¨çŠ¶æ€+ä¸€ä¸ªæˆ–å¤šä¸ªå…·æœ‰å†…å­˜æ˜ å°„çš„å†…å­˜åœ°å€ç©ºé—´â€¦<br>æ‰§è¡Œçº¿ç¨‹ï¼šè¿›ç¨‹ä¸­æ´»åŠ¨çš„å¯¹è±¡ï¼Œæ¯ä¸ªçº¿ç¨‹æœ‰ç‹¬ç«‹çš„PCã€è¿›ç¨‹æ ˆå’Œä¸€ç»„è¿›ç¨‹å¯„å­˜å™¨ï¼Œ<strong>å†…æ ¸è°ƒåº¦çš„å¯¹è±¡æ˜¯çº¿ç¨‹</strong><br>ç¨‹åºæœ¬èº«ä¸æ˜¯è¿›ç¨‹ï¼Œè¿›ç¨‹æ˜¯å¤„äºæ‰§è¡Œå™¨çš„ç¨‹åºä»¥åŠç›¸å…³èµ„æºçš„æ€»ç§°ã€‚ï¼ˆä¸€ä¸ªç¨‹åºå¯èƒ½æœ‰å¤šä¸ªè¿›ç¨‹ï¼Œå¹¶ä¸”è¿›ç¨‹é—´å¯èƒ½è¿›è¡Œæ•°æ®å…±äº«ï¼‰</p><p>è¿›ç¨‹æä¾›ä¸¤ç§è™šæ‹Ÿæœºåˆ¶ï¼šè™šæ‹Ÿå¤„ç†å™¨å’Œè™šæ‹Ÿå†…å­˜ï¼Œç»™è¿›ç¨‹ä¸€ç§åœ¨ç‹¬å å¤„ç†å™¨çš„å‡è±¡(å®é™…å¯èƒ½æ˜¯å¤šä¸ªè¿›ç¨‹ä½¿ç”¨åŒä¸€ä¸ªå¤„ç†å™¨)</p><h4 id="è¿›ç¨‹æè¿°ç¬¦ä¸ä»»åŠ¡ç»“æ„">è¿›ç¨‹æè¿°ç¬¦ä¸ä»»åŠ¡ç»“æ„</h4><p>å†…æ ¸æŠŠè¿›ç¨‹çš„åˆ—è¡¨å­˜æ”¾åœ¨ä»»åŠ¡é˜Ÿåˆ—çš„åŒå‘å¾ªç¯é“¾è¡¨ä¸­ï¼Œé“¾è¡¨ä¸­çš„æ¯ä¸€é¡¹éƒ½æ˜¯ä¸€ä¸ªtask_structï¼ˆè¿™ä¸ªç»“æ„ä½“æ¯”è¾ƒå¤§ï¼‰ åŒ…å«äº†å†…æ ¸ç®¡ç†ä¸€ä¸ªè¿›ç¨‹æ‰€éœ€è¦çš„ä¿¡æ¯ã€‚Linuxé€šè¿‡slabåˆ†é…å™¨åˆ†é…task_structç»“æ„ï¼ˆèƒ½è¾¾åˆ°å¯¹è±¡å¤ç”¨å’Œç¼“å­˜ç€è‰²çš„ç›®çš„ï¼‰</p><p>2.6ä»¥å‰çš„å†…æ ¸ï¼Œtask_structæ”¾åœ¨è¿›ç¨‹å†…æ ¸æ ˆçš„å¾®ç«¯ï¼Œï¼ˆä¸ºäº†è®©åƒx86é‚£æ ·å¯„å­˜å™¨è¾ƒå°‘çš„ç¡¬ä»¶ç»“æ„ä½“ç³»é€šè¿‡æ ˆæŒ‡é’ˆå°±èƒ½è®¡ç®—ä»–çš„ä½ç½®ï¼‰ï¼›ç°åœ¨ä½¿ç”¨slabåˆ†é…å™¨åŠ¨æ€ç”Ÿæˆtask_structï¼Œç§©åºåœ¨æ ˆåº•æˆ–è€…æ ˆé¡¶åˆ›å»ºæ–°çš„ç»“æ„thread_infoï¼ˆå¯¹è¿›ç¨‹çš„ä¸€ä¸ªç®€ä»‹ï¼Ÿï¼‰<br>è®¿é—®ä»»åŠ¡é€šå¸¸è¦è·å¾—æŒ‡å‘å…¶task_structçš„æŒ‡é’ˆï¼Œä½†å¤§éƒ¨åˆ†å¤„ç†è¿›ç¨‹çš„ä»£ç éƒ½æ˜¯ç›´æ¥é€šè¿‡task_structè¿›è¡Œã€‚é€šè¿‡currentå®æŸ¥æ‰¾å½“å‰æ­£åœ¨è¿è¡Œè¿›ç¨‹çš„structã€‚ç¡¬ä»¶ä½“ç³»ä¸åŒï¼Œå®çš„å®ç°ä¸åŒã€‚</p><ul><li>æœ‰çš„ç¡¬ä»¶ä½“ç³»ç»“æ„èƒ½æ‹¿å‡ºä¸“é—¨çš„å¯„å­˜å™¨æ¥å­˜æ”¾å½“å‰è¿›ç¨‹çš„task_structæŒ‡é’ˆ</li><li>æœ‰äº›x86çš„ä½“ç³»æ¶æ„ï¼Œå¯„å­˜å™¨å°‘ï¼Œåªèƒ½åœ¨å†…æ ¸æ ˆçš„å¾®ç«¯åˆ›å»ºthread_infoï¼Œé€šè¿‡è®¡ç®—åç§»é—´æ¥çš„èµµtask_struct</li></ul><p>é€šè¿‡é¢„åˆ†é…å’Œé‡å¤ä½¿ç”¨task_structèƒ½é¿å…åŠ¨æ€åˆ†é…å’Œé‡Šæ”¾å¸¦æ¥çš„èµ„æºæ¶ˆè€— â€”&gt; è¿›ç¨‹çš„å¿«é€Ÿåˆ›å»º</p><p>PIDï¼šå”¯ä¸€çš„è¿›ç¨‹æ ‡è¯†ç¬¦ (/proc/sys/kernel/pid_max å¯ä¿®æ”¹ç³»ç»Ÿä¸­å­˜åœ¨è¿›ç¨‹çš„æœ€å¤§æ•°ç›®)</p><h4 id="è¿›ç¨‹çš„çŠ¶æ€">è¿›ç¨‹çš„çŠ¶æ€</h4><ul><li>TASK_RUNINGï¼šè¿›ç¨‹å¯æ‰§è¡Œã€‚è¦ä¹ˆæ­£åœ¨æ‰§è¡Œï¼Œè¦ä¹ˆåœ¨è¿è¡Œé˜Ÿåˆ—ä¸­ç­‰å¾…æ‰§è¡Œï¼ˆè¿›ç¨‹åœ¨ç”¨æˆ·ç©ºé—´ä¸­æ‰§è¡Œçš„å”¯ä¸€å¯èƒ½çŠ¶æ€ï¼‰</li><li>TASK_INTERRUPTIBLEï¼šè¿›ç¨‹æ­£åœ¨ç¡çœ ï¼Œè¢«é˜»å¡ï¼Œç­‰å¾…æŸäº›æ¡ä»¶è¾¾æˆã€‚ä¼šå› ä¸ºæ¥æ”¶åˆ°ä¿¡å·è€Œè€Œæå‰è¢«å”¤é†’</li><li>TASK_UNINTERRUPTIBLEï¼šæ¥æ”¶åˆ°ä¿¡å·ä¹Ÿä¸ä¼šè¢«å”¤é†’ã€‚å¯¹ä¿¡å·ä¸ä½œå‡ºå“åº”</li><li>__TASK_TRACEDï¼šè¢«å…¶ä»–è¿›ç¨‹è·Ÿè¸ªçš„è¿›ç¨‹ï¼ˆå¯¹è°ƒè¯•è¿›ç¨‹è¿›è¡Œè·Ÿè¸ªï¼‰</li><li>__TASK_STOPPEDï¼šè¿›ç¨‹åœæ­¢æ‰§è¡Œï¼›è¿›ç¨‹æ²¡æœ‰æŠ•å…¥è¿è¡Œä¹Ÿä¸èƒ½æŠ•å…¥è¿è¡Œï¼ˆæ¥æ”¶åˆ°SIGSTOPã€SIGTSTPã€SITTINã€SIGTTOUä¿¡å·æ—¶ï¼‰ã€‚è°ƒè¯•æœŸé—´æ¥æ”¶åˆ°ä»»ä½•ä¿¡å·éƒ½ä¼šè¿›å…¥è¿™ç§çŠ¶æ€</li></ul><p><strong>è®¾ç½®å½“å‰è¿›ç¨‹çŠ¶æ€</strong><br>set_task_state(task, state) --&gt; task-&gt;state = newstate; å¹¶å¯èƒ½ä¼šè®¾ç½®å†…å­˜å±éšœæ¥å¼ºåˆ¶å…¶ä»–å¤„ç†å™¨è¿›è¡Œé‡æ–°æ’åº</p><h4 id="è¿›ç¨‹å®¶æ—æ ‘">è¿›ç¨‹å®¶æ—æ ‘</h4><p>æ‰€æœ‰è¿›ç¨‹éƒ½æ˜¯PID = 1çš„è¿›ç¨‹åä»£ï¼Œå†…æ ¸åœ¨ç³»ç»Ÿå¯åŠ¨çš„æœ€åé˜¶æ®µå¯åŠ¨initè¿›ç¨‹ã€‚</p><p>æ¯ä¸ªtask_structæœ‰çˆ¶è¿›ç¨‹çš„æŒ‡é’ˆã€childrençš„å­è¿›ç¨‹é“¾è¡¨</p><p>é€šè¿‡pstree -p å¯è§‚å¯Ÿåˆ°è¿™ç§ç°è±¡</p><div class="note note-success">            <p>parentå’Œrealparentçš„åŒºåˆ«ï¼Ÿ</p>          </div><h4 id="åˆ›å»ºè¿›ç¨‹">åˆ›å»ºè¿›ç¨‹</h4><p><strong>å†™æ—¶æ‹·è´</strong></p><p>ä¼ ç»Ÿfork()ç›´æ¥æŠŠæ‰€æœ‰çš„èµ„æºå¤åˆ¶ç»™æ–°åˆ›å»ºçš„è¿›ç¨‹  â€“ æ•ˆç‡åœ°ä¸‹ï¼Œå¦‚æœæ–°è¿›ç¨‹è¦æ‰§è¡Œä¸€ä¸ªæ–°çš„æ˜ åƒï¼Œé‚£ä¹‹å‰çš„æ‹·è´éƒ½æ²¡ç”¨ã€‚<br>Linux forké‡‡ç”¨å†™æ—¶æ‹·è´è¿›è¡Œï¼Œå†…æ ¸å¹¶ä¸å¤åˆ¶æ•´ä¸ªè¿›ç¨‹çš„åœ°å€ç©ºé—´ï¼Œè€Œæ˜¯è®©çˆ¶å­è¿›ç¨‹å…±äº«åŒä¸€ä¸ªæ‹·è´ã€‚åªæœ‰åœ¨éœ€è¦å†™å…¥æ—¶ï¼Œæ•°æ®æ‰ä¼šè¢«å¤åˆ¶ï¼Œä»è€Œè®©å„è‡ªè¿›ç¨‹æœ‰å„è‡ªçš„æ‹·è´ã€‚forkçš„å®é™…å¼€é”€å°±æ˜¯å¤åˆ¶çˆ¶è¿›ç¨‹çš„é¡µè¡¨ä»¥åŠç»™å­è¿›ç¨‹åˆ›å»ºå”¯ä¸€çš„è¿›ç¨‹æè¿°ç¬¦ï¼Œé¿å…æ‹·è´å¤§é‡æ ¹æœ¬å°±ä¸ä¼šè¢«ä½¿ç”¨çš„æ•°æ®ã€‚</p><h5 id="fork">fork</h5><p>é€šè¿‡æ‹·è´å½“å‰ä»Šæ™¨åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œçˆ¶å­è¿›ç¨‹çš„åŒºåˆ«ä»…ä»…åœ¨PID PPID å’ŒæŸäº›èµ„æºç»Ÿè®¡é‡</p><p>fork vfork __clone() åº“å‡½æ•°æ ¹æ®å„è‡ªå‚æ•°è°ƒç”¨ â€”â€”&gt; clone() â€”&gt;do_fork() â€”&gt;copy_process()</p><p>copy_processå®Œæˆäº†åˆ›å»ºä¸­çš„å¤§éƒ¨åˆ†å·¥ä½œ</p><p>æµç¨‹ï¼š</p><h5 id="exec">exec</h5><p>è´Ÿè´£è¯»å–å¯æ‰§è¡Œæ–‡ä»¶å¹¶å°†å…¶è½½å…¥åœ°å€ç©ºé—´å¼€å§‹è¿è¡Œ</p><h5 id="vfork">vfork</h5><p>ä»…ä»…ä¸æ‹·è´çˆ¶è¿›ç¨‹çš„é¡µè¡¨é¡¹ã€‚å­è¿›ç¨‹ä½œä¸ºçˆ¶è¿›ç¨‹çš„ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹åœ¨å®ƒçš„åœ°å€ç©ºé—´è¿è¡Œï¼Œçˆ¶è¿›ç¨‹è¢«é˜»å¡ï¼Œç›´åˆ°å­è¿›ç¨‹é€€å‡ºæˆ–è€…æ‰§è¡Œexec()æ—¶</p><h4 id="å¯¹forkçš„ä¸€äº›æ·±å…¥æ¢ç©¶">å¯¹forkçš„ä¸€äº›æ·±å…¥æ¢ç©¶</h4><p>è¯¦è§æ–‡ç«  ã€Šæ·±å…¥Linux fork()å‡½æ•°ã€‹</p><p><strong>ä¸ºå•¥Manjaroæ²¡æœ‰includeæ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”/usr/includeä¸‹çš„sched.hæ²¡æœ‰task_structå®šä¹‰ï¼Œä½†linuxå†…æ ¸æºæ–‡ä»¶å°±æœ‰ï¼Ÿ</strong></p><p>äº²æµ‹ï¼Œè¿™ä¸ªtask_structç»“æ„ä½“ç›¸å½“çš„é•¿ï¼Œæœ‰å¾ˆå¤šçš„ifdefä¸‹çš„structå®šä¹‰ï¼ˆé€‚é…ä¸åŒçš„æ¶æ„å—ï¼Ÿï¼‰</p><h3 id="çº¿ç¨‹-v2">çº¿ç¨‹</h3><h4 id="æ¦‚è¿°-v3">æ¦‚è¿°</h4><p>çº¿ç¨‹æœºåˆ¶ï¼šæä¾›äº†åŒä¸€ç¨‹åºå†…å…±äº«å†…å­˜åœ°å€ç©ºé—´è¿è¡Œçš„ä¸€ç»„çº¿ç¨‹ï¼Œåœ¨å¤šå¤„ç†å™¨ç¯å¢ƒä¸‹ï¼Œèƒ½ä¿è¯çœŸæ­£çš„å¹¶è¡Œå¤„ç†ã€‚çˆ¶å­ä¿©å…±äº«åœ°å€ç©ºé—´ã€æ–‡ä»¶èµ„æºç³»ç»Ÿã€æ–‡ä»¶æè¿°ç¬¦å’Œä¿¡å·å¤„ç†ç¨‹åºã€‚æœ¬è´¨ä»ç„¶æ˜¯çº¿ç¨‹ï¼Œ</p><div class="note note-primary">            <p>Windowsä¸‹ï¼Œåœ¨å•®åˆä¸­ä¸“é—¨æä¾›äº†æ”¯æŒçº¿ç¨‹çš„æœºåˆ¶ï¼ŒæŠŠçº¿ç¨‹å«åšâ€œè½»é‡çº§è¿›ç¨‹â€(è€Œåœ¨Linuxä¸­ï¼Œè¿›ç¨‹æœ¬èº«å·²ç»è¶³å¤Ÿè½»é‡)ã€‚çº¿ç¨‹è¢«æŠ½è±¡æˆä¸€ç§æ¶ˆè€—èµ„æºè¾ƒå°‘ã€è¿è¡Œè¿…é€Ÿçš„æ‰§è¡Œå•å…ƒï¼Œé€šå¸¸æœ‰ä¸€ä¸ªåŒ…å«æŒ‡å‘nä¸ªä¸åŒçº¿ç¨‹çš„æŒ‡é’ˆçš„è¿›ç¨‹æè¿°ç¬¦ï¼Œçº¿ç¨‹æœ¬èº«æœ‰ç‹¬ç«‹çš„ç»“æ„ã€‚<br>ä½†Linuxä¸‹å°±æ²¡æœ‰ç‹¬ç«‹çš„ç»“æ„ï¼Œä»…ä»…å¤ç”¨task_structï¼Œå»ºç«‹å››ä¸ªè¿›ç¨‹æ—¶ï¼ŒæŒ‡å®šä»–ä»¬å…±äº«æŸäº›èµ„æº</p>          </div><h4 id="ä¸€äº›æ“ä½œæ–¹å¼">ä¸€äº›æ“ä½œæ–¹å¼</h4><p>pthread_createï¼Œ</p><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span><span class="token operator">*</span> <span class="token function">thread_fun</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span> arg<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> i <span class="token punctuation">;</span>    i <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span> arg<span class="token punctuation">;</span>    <span class="token class-name">pthread_t</span>  id <span class="token operator">=</span> <span class="token function">pthread_self</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">pid_t</span> pid <span class="token operator">=</span> <span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"cur thread %d  thread_self is %lu\n"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"cur thread &amp;%d pid is %d\n"</span><span class="token punctuation">,</span>i<span class="token punctuation">,</span> pid<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">pthread_t</span>  id <span class="token operator">=</span> <span class="token function">pthread_self</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">pid_t</span> pid <span class="token operator">=</span> <span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"cur thread_self is %lu\n"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"cur oud is %d\n"</span><span class="token punctuation">,</span> pid<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">pthread_t</span> tid_1<span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token function">pthread_create</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>tid_1<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> thread_fun<span class="token punctuation">,</span> <span class="token operator">&amp;</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>å¯ä»¥éªŒè¯ï¼Œçº¿ç¨‹å†…éƒ¨pidéƒ½æ˜¯ç›¸åŒçš„ï¼Œä½†pthread_selfä¸åŒ</p><p>æœ‰ä¸ªé—®é¢˜ï¼Œè¿›ç¨‹é€€å‡ºåçº¿ç¨‹ä¼šé€€å‡ºå—ï¼Ÿï¼ˆæ„Ÿè§‰ä¸ä¼šï¼Œå› ä¸ºä¹Ÿæ˜¯çº¿ç¨‹ï¼Œä¼šè¢«åˆ†é…åˆ°å…¶ä»–è¿›ç¨‹åä¸‹ï¼Ÿï¼‰</p><p>è¿˜æœ‰ä¸ºä»€ä¹ˆåœ¨clionä¸­pthread_create ä¸èƒ½ç›´æ¥ä¼ void * ç±»å‹ï¼Ÿg++å•ç‹¬ç¼–è¯‘å°±å¯ä»¥ï¼Ÿ</p><p><strong>å¯å…±äº«å…¨å±€æ•°æ®</strong></p><ul><li>pthread_exitï¼Œé€€å‡ºå•ä¸ªçº¿ç¨‹.ä¸èƒ½ä½¿ç”¨exitï¼Œä¼šä½¿å¾—æ•´ä¸ªè¿›ç¨‹é€€å‡ºï¼ˆè·Ÿpidç›¸å…³ï¼Ÿï¼‰ï¼ˆä»…åœ¨çº¿ç¨‹å†…éƒ¨ä½¿ç”¨ï¼‰</li><li>pthread_join(othread_t pthread,void ** retval)ï¼Œç­‰å¾…ä¸€ä¸ªçº¿ç¨‹çš„ç»“æŸã€‚å½“å‰è¿›ç¨‹å°±ä¼šstuckã€‚æˆåŠŸåˆ™è¿”å›0<ul><li>retval:å­˜å‚¨çº¿ç¨‹ç»“æŸçŠ¶æ€<ul><li>å¦‚æœthreadçº¿ç¨‹é€šè¿‡returnè¿”å›ï¼Œretvalæ‰€æŒ‡å‘çš„å•å…ƒé‡Œå­˜æ”¾çš„æ˜¯threadçº¿ç¨‹å‡½æ•°çš„è¿”å›å€¼ã€‚</li><li>å¦‚æœthreadçº¿ç¨‹è¢«åˆ«çš„çº¿ç¨‹è°ƒç”¨pthread_cancelå¼‚å¸¸ç»ˆæ­¢æ‰ï¼Œretvalæ‰€æŒ‡å‘çš„å•å…ƒé‡Œå­˜æ”¾çš„æ˜¯å¸¸æ•°PTHREAD_CANCELEDã€‚</li><li>å¦‚æœthreadçº¿ç¨‹æ˜¯è‡ªå·±è°ƒç”¨pthread_exitç»ˆæ­¢çš„ï¼Œretvalæ‰€æŒ‡å‘çš„å•å…ƒå­˜æ”¾çš„æ˜¯ä¼ ç»™pthread_exitçš„å‚æ•°ã€‚</li><li>å¦‚æœå¯¹threadçº¿ç¨‹çš„ç»ˆæ­¢çŠ¶æ€ä¸æ„Ÿå…´è¶£ï¼Œå¯ä»¥ä¼ NULLç»™retvalå‚æ•°ã€‚</li></ul></li></ul></li><li>pthread_cancelï¼Œæ€æ­»çº¿ç¨‹<ul><li>å¦‚æœçº¿ç¨‹åœ¨sleepåˆ™ä¼šç­‰åˆ°sleepåå†cancel</li><li>å¦‚æœä¸€ç›´æ˜¯whileçš„çŠ¶æ€ï¼Œåˆ™<ul><li>æœ‰pthread_testcancel(),åˆ™å°±åœ¨å½“å‰å¤„cancelã€‚ä¼šè‡ªè¡Œè®¾ç½®<strong>å–æ¶ˆç‚¹</strong></li><li>å¦‚æœæ²¡æœ‰ï¼Œåˆ™ç³»ç»Ÿè‡ªå·±åˆ¤æ–­ä»€ä¹ˆæ—¶å€™ä¼šcancelï¼Œå¯èƒ½whileä¼šæ‰§è¡Œå¤šæ¬¡åcancel</li></ul></li></ul></li><li>pthread_detachï¼šçº¿ç¨‹åˆ†ç¦»ã€‚<ul><li>çº¿ç¨‹ä¸»åŠ¨ä¸ä¸»æ§çº¿ç¨‹æ–­å¼€å…³ç³»ï¼Œçº¿ç¨‹ç»“æŸåï¼Œé€€å‡ºçŠ¶æ€ä¸ç”±å…¶ä»–çº¿ç¨‹è·å–ï¼Œè€Œæ˜¯è‡ªå·±é‡Šæ”¾ã€‚ä¸èƒ½ä½¿ç”¨pthread_joinç­‰å¾…å®ƒçš„ç»ˆæ­¢çŠ¶æ€ï¼ˆçº¿ç¨‹ä¸€æ—¦ç»ˆæ­¢å°±ç«‹åˆ»å›æ”¶å®ƒå ç”¨çš„å­—çœ¼ï¼Œè€Œä¸ä¿ç•™ç»ˆæ­¢è£…å¡«ï¼‰</li><li>ä¸ä¼šäº§ç”Ÿåƒµå°¸è¿›ç¨‹</li></ul></li></ul><p><strong>å†…æ ¸çº¿ç¨‹</strong></p><p>ç‹¬ç«‹è¿è¡Œåœ¨å†…æ ¸ç©ºé—´çš„æ ‡å‡†è¿›ç¨‹ï¼ŒåŒºåˆ«åœ¨ä¸å†…æ ¸çº¿ç¨‹æ²¡æœ‰ç‹¬ç«‹çš„åœ°å€ç©ºé—´ã€‚åªåœ¨å†…æ ¸ç©ºé—´è¿è¡Œï¼Œä»ä¸ä¼šåˆ‡æ¢åˆ°å†…æ ¸ç©ºé—´ã€‚å¯ä»¥è¢«è°ƒåº¦å’ŒæŠ¢å ã€‚å†…æ ¸çº¿ç¨‹åªèƒ½ç”±å†…æ ¸çº¿ç¨‹åˆ›å»º</p><h2 id="è¿›ç¨‹è°ƒåº¦">è¿›ç¨‹è°ƒåº¦</h2><h3 id="æ¦‚è¿°-v4">æ¦‚è¿°</h3><p><strong>å®æ—¶è¿›ç¨‹å’Œæ™®é€šè¿›ç¨‹</strong></p><table><thead><tr><th>äº¤äº’å¼è¿›ç¨‹(interactive process)</th><th>æ­¤ç±»è¿›ç¨‹ç»å¸¸ä¸ç”¨æˆ·è¿›è¡Œäº¤äº’, å› æ­¤éœ€è¦èŠ±è´¹å¾ˆå¤šæ—¶é—´ç­‰å¾…é”®ç›˜å’Œé¼ æ ‡æ“ä½œ. å½“æ¥å—äº†ç”¨æˆ·çš„è¾“å…¥å, è¿›ç¨‹å¿…é¡»å¾ˆå¿«è¢«å”¤é†’, å¦åˆ™ç”¨æˆ·ä¼šæ„Ÿè§‰ç³»ç»Ÿååº”è¿Ÿé’</th><th>shell, æ–‡æœ¬ç¼–è¾‘ç¨‹åºå’Œå›¾å½¢åº”ç”¨ç¨‹åº</th></tr></thead><tbody><tr><td>æ‰¹å¤„ç†è¿›ç¨‹(batch process)</td><td>æ­¤ç±»è¿›ç¨‹ä¸å¿…ä¸ç”¨æˆ·äº¤äº’, å› æ­¤ç»å¸¸åœ¨åå°è¿è¡Œ. å› ä¸ºè¿™æ ·çš„è¿›ç¨‹ä¸å¿…å¾ˆå¿«ç›¸åº”, å› æ­¤å¸¸å—åˆ°è°ƒåº¦ç¨‹åºçš„æ€ æ…¢</td><td>ç¨‹åºè¯­è¨€çš„ç¼–è¯‘ç¨‹åº, æ•°æ®åº“æœç´¢å¼•æ“ä»¥åŠç§‘å­¦è®¡ç®—</td></tr><tr><td>å®æ—¶è¿›ç¨‹(real-time process)</td><td>è¿™äº›è¿›ç¨‹ç”±å¾ˆå¼ºçš„è°ƒåº¦éœ€è¦, è¿™æ ·çš„è¿›ç¨‹ç»ä¸ä¼šè¢«ä½ä¼˜å…ˆçº§çš„è¿›ç¨‹é˜»å¡. å¹¶ä¸”ä»–ä»¬çš„å“åº”æ—¶é—´è¦å°½å¯èƒ½çš„çŸ­</td><td>è§†é¢‘éŸ³é¢‘åº”ç”¨ç¨‹åº, æœºå™¨äººæ§åˆ¶ç¨‹åºä»¥åŠä»ç‰©ç†ä¼ æ„Ÿå™¨ä¸Šæ”¶é›†æ•°æ®çš„ç¨‹åº</td></tr></tbody></table><p>ä¸åŒåˆ†ç±»é‡‡ç”¨ä¸åŒçš„è°ƒåº¦ç­–ç•¥</p><ul><li>å¯¹äºå®æ—¶è¿›ç¨‹ï¼Œé‡‡ç”¨FIFOæˆ–è€…Round Robinçš„è°ƒåº¦ç­–ç•¥.</li><li>å¯¹äºæ™®é€šè¿›ç¨‹ï¼Œåˆ™<strong>éœ€è¦åŒºåˆ†äº¤äº’å¼å’Œæ‰¹å¤„ç†å¼çš„ä¸åŒ</strong>ã€‚ä¼ ç»ŸLinuxè°ƒåº¦å™¨æé«˜äº¤äº’å¼åº”ç”¨çš„ä¼˜å…ˆçº§ï¼Œä½¿å¾—å®ƒä»¬èƒ½æ›´å¿«åœ°è¢«è°ƒåº¦ã€‚è€ŒCFSå’ŒRSDLç­‰æ–°çš„è°ƒåº¦å™¨çš„æ ¸å¿ƒæ€æƒ³æ˜¯â€å®Œå…¨å…¬å¹³â€ã€‚è¿™ä¸ªè®¾è®¡ç†å¿µä¸ä»…å¤§å¤§ç®€åŒ–äº†è°ƒåº¦å™¨çš„ä»£ç å¤æ‚åº¦ï¼Œè¿˜å¯¹å„ç§è°ƒåº¦éœ€æ±‚çš„æä¾›äº†æ›´å®Œç¾çš„æ”¯æŒ.</li></ul><h3 id="è°ƒåº¦å™¨">è°ƒåº¦å™¨</h3><p>æœ€å¼€å§‹æ˜¯Onçš„è°ƒåº¦ç®—æ³•ï¼ˆæ¯æ¬¡ä¼šéå†æ‰€æœ‰ä»»åŠ¡ï¼Œæ‰€ä»¥æ˜¯Onï¼‰ â€”&gt; Linux 2.5 : O(1) â€”&gt; Linux 2.6 - now CFS</p><p>è°ƒåº¦å™¨å¯ä»¥ç”¨ä¸€ç§æˆ–è€…å¤šç§è°ƒåº¦ç­–ç•¥</p><table><thead><tr><th>è°ƒåº¦å™¨ç±»</th><th>æè¿°</th><th>è°ƒåº¦ç­–ç•¥</th></tr></thead><tbody><tr><td>stop_sched_class</td><td>ä¼˜å…ˆçº§æœ€é«˜çš„çº¿ç¨‹ï¼Œä¼šä¸­æ–­æ‰€æœ‰å…¶ä»–çº¿ç¨‹ï¼Œä¸”ä¸ä¼šè¢«å…¶ä»–ä»»åŠ¡æ‰“æ–­<br/>ä½œç”¨<br/>1.å‘ç”Ÿåœ¨cpu_stop_cpu_callback è¿›è¡Œcpuä¹‹é—´ä»»åŠ¡migration<br/>2.HOTPLUG_CPUçš„æƒ…å†µä¸‹å…³é—­ä»»åŠ¡</td><td>æ— , ä¸éœ€è¦è°ƒåº¦æ™®é€šè¿›ç¨‹</td></tr><tr><td>dl_sched_class</td><td>é‡‡ç”¨EDFæœ€æ—©æˆªè‡³æ—¶é—´ä¼˜å…ˆç®—æ³•è°ƒåº¦å®æ—¶è¿›ç¨‹</td><td>SCHED_DEADLINE</td></tr><tr><td>rt_sched_class</td><td>é‡‡ç”¨æä¾› Roound-Robinç®—æ³•æˆ–è€…FIFOç®—æ³•è°ƒåº¦å®æ—¶è¿›ç¨‹<br/>å…·ä½“è°ƒåº¦ç­–ç•¥ç”±è¿›ç¨‹çš„task_struct-&gt;policyæŒ‡å®š</td><td>SCHED_FIFO, SCHED_RR</td></tr><tr><td>fair_sched_clas</td><td>é‡‡ç”¨CFSç®—æ³•è°ƒåº¦æ™®é€šçš„éå®æ—¶è¿›ç¨‹</td><td>SCHED_NORMAL, SCHED_BATCH</td></tr><tr><td>idle_sched_class</td><td>é‡‡ç”¨CFSç®—æ³•è°ƒåº¦idleè¿›ç¨‹, æ¯ä¸ªcupçš„ç¬¬ä¸€ä¸ªpid=0çº¿ç¨‹ï¼šswapperï¼Œæ˜¯ä¸€ä¸ªé™æ€çº¿ç¨‹ã€‚è°ƒåº¦ç±»å±äºï¼šidel_sched_classï¼Œæ‰€ä»¥åœ¨psé‡Œé¢æ˜¯çœ‹ä¸åˆ°çš„ã€‚ä¸€èˆ¬è¿è¡Œåœ¨å¼€æœºè¿‡ç¨‹å’Œcpuå¼‚å¸¸çš„æ—¶å€™åšdump</td><td>SCHED_IDLE</td></tr></tbody></table><p><strong>è°ƒåº¦å®ä½“</strong></p><p>è°ƒåº¦ä½“ä¸é™äºè°ƒåº¦è¿›ç¨‹ï¼Œè¿˜å¯ä»¥è°ƒåº¦æ›´å¤§çš„å®ä½“ï¼ˆç»„è°ƒåº¦ï¼‰</p><table><thead><tr><th>è°ƒåº¦å®ä½“</th><th><strong>åç§°</strong></th><th><strong>æè¿°</strong></th><th>å¯¹åº”è°ƒåº¦å™¨ç±»</th></tr></thead><tbody><tr><td>sched_dl_entity</td><td>DEADLINEè°ƒåº¦å®ä½“</td><td>é‡‡ç”¨EDFç®—æ³•è°ƒåº¦çš„å®æ—¶è°ƒåº¦å®ä½“</td><td>dl_sched_class</td></tr><tr><td>sched_rt_entity</td><td>RTè°ƒåº¦å®ä½“</td><td>é‡‡ç”¨Roound-Robinæˆ–è€…FIFOç®—æ³•è°ƒåº¦çš„å®æ—¶è°ƒåº¦å®ä½“</td><td>rt_sched_class</td></tr><tr><td>sched_entity</td><td>CFSè°ƒåº¦å®ä½“</td><td>é‡‡ç”¨CFSç®—æ³•è°ƒåº¦çš„æ™®é€šéå®æ—¶è¿›ç¨‹çš„è°ƒåº¦å®ä½“</td><td>fair_sched_class</td></tr></tbody></table><p>è°ƒåº¦å™¨æœ‰ä¸åŒçš„è¿è¡Œé˜Ÿåˆ—</p><h2 id="ä¸€äº›é—®é¢˜-v2">ä¸€äº›é—®é¢˜</h2><h3 id="Unixå’ŒLinuxåˆ°åº•å•¥å…³ç³»ï¼Ÿ"><strong>Unixå’ŒLinuxåˆ°åº•å•¥å…³ç³»ï¼Ÿ</strong></h3><h3 id="GNU-GPL">GNU GPL</h3><h3 id="GCCä¸æ˜¯ç”¨Cç¼–è¯‘çš„å—ï¼Ÿç”¨Cç¼–è¯‘çš„ç¼–è¯‘å™¨å»ç¼–è¯‘C">GCCä¸æ˜¯ç”¨Cç¼–è¯‘çš„å—ï¼Ÿç”¨Cç¼–è¯‘çš„ç¼–è¯‘å™¨å»ç¼–è¯‘C???</h3><p><strong>ä¸ºä»€ä¹ˆä¸€äº›linuxå¯ä»¥è®¿é—®windowsç£ç›˜ä½†åè¿‡æ¥å´ä¸è¡Œï¼Ÿ</strong></p><h3 id="fsæ˜¯å•¥ï¼Ÿæ–‡ä»¶ç³»ç»Ÿï¼Ÿ">fsæ˜¯å•¥ï¼Ÿæ–‡ä»¶ç³»ç»Ÿï¼Ÿ</h3><h4 id="æ–‡ä»¶ç³»ç»Ÿ">æ–‡ä»¶ç³»ç»Ÿ</h4><p><strong>æ–‡ä»¶ç³»ç»Ÿçš„åŸºæœ¬ç»„æˆ</strong><br>æ–‡ä»¶ç³»ç»Ÿæ˜¯æ“ä½œç³»ç»Ÿä¸­è´Ÿè´£ç®¡ç†æŒä¹…æ•°æ®çš„å­ç³»ç»Ÿï¼Œè¯´ç®€å•ç‚¹ï¼Œå°±æ˜¯è´Ÿè´£æŠŠç”¨æˆ·çš„æ–‡ä»¶å­˜åˆ°ç£ç›˜ç¡¬ä»¶ä¸­ï¼Œå› ä¸ºå³ä½¿è®¡ç®—æœºæ–­ç”µäº†ï¼Œç£ç›˜é‡Œçš„æ•°æ®å¹¶ä¸ä¼šä¸¢å¤±ï¼Œæ‰€ä»¥å¯ä»¥æŒä¹…åŒ–çš„ä¿å­˜æ–‡ä»¶ã€‚<br>æ–‡ä»¶ç³»ç»Ÿçš„åŸºæœ¬æ•°æ®å•ä½æ˜¯æ–‡ä»¶ï¼Œå®ƒçš„ç›®çš„æ˜¯å¯¹ç£ç›˜ä¸Šçš„æ–‡ä»¶è¿›è¡Œç»„ç»‡ç®¡ç†ï¼Œé‚£ç»„ç»‡çš„æ–¹å¼ä¸åŒï¼Œå°±ä¼šå½¢æˆä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿã€‚<br>Linux æœ€ç»å…¸çš„ä¸€å¥è¯æ˜¯ï¼šã€Œä¸€åˆ‡çš†æ–‡ä»¶ã€ï¼Œä¸ä»…æ™®é€šçš„æ–‡ä»¶å’Œç›®å½•ï¼Œå°±è¿å—è®¾å¤‡ã€ç®¡é“ã€socket ç­‰ï¼Œä¹Ÿéƒ½æ˜¯ç»Ÿä¸€äº¤ç»™æ–‡ä»¶ç³»ç»Ÿç®¡ç†çš„ã€‚</p><p>Linuxæ–‡ä»¶ç³»ç»Ÿå›å‘³æ¯ä¸ªæ–‡ä»¶åˆ†é…ä¸¤ä¸ªæ•°æ®ç»“æ„ï¼š ç´¢å¼•èŠ‚ç‚¹å’Œç›®å½•é¡¹ï¼Œè®°å½•æ–‡ä»¶çš„åŸä¿¡æ¯å’Œç›®å½•å±‚æ¬¡ç»“æ„</p><ul><li>ç´¢å¼•èŠ‚ç‚¹ï¼šè®°å½•æ–‡ä»¶çš„å…ƒä¿¡æ¯</li></ul><h3 id="Linuxæœ‰äº‹åŠ¡è¿™ä¸ªæ¦‚å¿µå—ï¼Ÿ">Linuxæœ‰äº‹åŠ¡è¿™ä¸ªæ¦‚å¿µå—ï¼Ÿ</h3><h3 id="printkæ˜¯ä»€ä¹ˆ">printkæ˜¯ä»€ä¹ˆ</h3><p>æ¯”printfå¤šäº†ä¸ªæ—¥å¿—çº§åˆ«ï¼Œç±»ä¼¼Androidçš„Log.e Log.wâ€¦ï¼Œå½“æ—¥å¿—çº§åˆ«çš„æ•°å€¼å°äºæ§åˆ¶å°çº§åˆ«(<strong>è¶Šå°è¶Šç®¡ç”¨</strong>)ï¼Œä¿¡æ¯æ‰ä¼šåœ¨æ§åˆ¶å°æ‰“å°å‡ºæ¥ã€‚ä¹Ÿå¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼ç›´æ¥æŸ¥çœ‹å‘½ä»¤</p><ul><li>dmesgå‘½ä»¤æ‰“å°</li><li>cat /proc/kmsgæ‰“å°</li></ul><p>ä½¿ç”¨æ—¶æ˜¯printk(level â€œxxxxxâ€);</p><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> console_printk<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>DEFAULT_CONSOLE_LOGLEVEL<span class="token punctuation">,</span><span class="token comment">/* console_loglevel 7*/</span>DEFAULT_MESSAGE_LOGLEVEL<span class="token punctuation">,</span><span class="token comment">/* default_message_loglevel 4*/</span>MINIMUM_CONSOLE_LOGLEVEL<span class="token punctuation">,</span><span class="token comment">/* minimum_console_loglevel 1*/</span>DEFAULT_CONSOLE_LOGLEVEL<span class="token punctuation">,</span><span class="token comment">/* default_console_loglevel 7*/</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></code></pre></div><p>å››ç§ä¸åŒçš„consoleçº§åˆ«â˜ï¸</p><p>å…«ç§ä¸åŒçš„æ—¥å¿—çº§åˆ«ğŸ‘‡æŒ‰ç…§ç´§æ€¥å’Œä¸¥é‡ç¨‹åº¦æ’åº</p><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span><span class="token macro-name">KERN_EMERG</span><span class="token string">"&lt;0>"</span><span class="token comment">/* system is unusable*/</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span><span class="token macro-name">KERN_ALERT</span><span class="token string">"&lt;1>"</span><span class="token comment">/* action must be taken immediately*/</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span><span class="token macro-name">KERN_CRIT</span><span class="token string">"&lt;2>"</span><span class="token comment">/* critical conditions*/</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span><span class="token macro-name">KERN_ERR</span><span class="token string">"&lt;3>"</span><span class="token comment">/* error conditions*/</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span><span class="token macro-name">KERN_WARNING</span><span class="token string">"&lt;4>"</span><span class="token comment">/* warning conditions*/</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span><span class="token macro-name">KERN_NOTICE</span><span class="token string">"&lt;5>"</span><span class="token comment">/* normal but significant condition*/</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span><span class="token macro-name">KERN_INFO</span><span class="token string">"&lt;6>"</span><span class="token comment">/* informational*/</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span><span class="token macro-name">KERN_DEBUG</span><span class="token string">"&lt;7>"</span><span class="token comment">/* debug-level messages*/</span></span></code></pre></div><h3 id="asmlinkageå‰ç¼€å•¥æ„æ€ï¼Ÿ">asmlinkageå‰ç¼€å•¥æ„æ€ï¼Ÿ</h3><h2 id="å‚è€ƒä¹¦ç›®">å‚è€ƒä¹¦ç›®</h2><p>ã€ŠLinuxå†…æ ¸è®¾è®¡ä¸å®ç°ã€‹(ç¬¬ä¸‰ç‰ˆ)</p><h2 id="æ–¹æ³•æ–‡ä»¶ç´¢å¼•">æ–¹æ³•æ–‡ä»¶ç´¢å¼•</h2><table><thead><tr><th>æ–‡ä»¶å</th><th>åŠŸèƒ½</th><th>å‡½æ•°\ç»“æ„ä½“ä¸¾ä¾‹</th></tr></thead><tbody><tr><td>kernel/fork.c</td><td>è¿›ç¨‹åˆ›å»º</td><td>copy_process</td></tr><tr><td>include/linux/sched.c</td><td>è¿›ç¨‹ç»“æ„</td><td>task_struct</td></tr><tr><td></td><td></td><td></td></tr></tbody></table>]]></content>
    
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>C</tag>
      
      <tag>è™šæ‹Ÿæœº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®¡ç®—æœºç»„æˆåŸç†</title>
    <link href="/2021/10/25/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/"/>
    <url>/2021/10/25/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/</url>
    
    <content type="html"><![CDATA[<h1>è®¡ç®—æœºç»„æˆåŸç†</h1><h2 id="è¿ç®—æ–¹æ³•ä¸è¿ç®—å™¨">è¿ç®—æ–¹æ³•ä¸è¿ç®—å™¨</h2><h3 id="åŸºæœ¬è¿ç®—">åŸºæœ¬è¿ç®—</h3><p><strong>ä½è¿ç®—</strong></p><p>&amp; | ~ ^ï¼šå¯ç›´æ¥é‡‡ç”¨é€»è¾‘é—¨å®ç°ï¼Œè¿ç®—å»¶è¿Ÿä¸ºä¸€çº§é—¨ç”µè·¯å»¶è¿Ÿ</p><p><strong>é€»è¾‘è¿ç®—</strong></p><p>&amp;&amp; || ! ï¼š éæ•°å€¼è¿ç®—ï¼Œæ“ä½œæ•°åªèƒ½æ˜¯0æˆ–è€…1 --&gt; é€»è¾‘è¿ç®—ç¿»è¯‘æˆæ±‡ç¼–è¯­è¨€æ—¶ä¸ä¼šå¯¹åº”å…·ä½“çš„è¿ç®—æŒ‡ä»¤ï¼Œè€Œæ˜¯å˜æˆç›¸åº”çš„ç¨‹åºåˆ†æ”¯ç»“æ„(cmp \ je)</p><p><strong>ç§»ä½è¿ç®—</strong></p><p>&lt;&lt; &gt;&gt; : 2x 4x x/16ç­‰éƒ½ä¼šè½¬æ¢æˆç›¸åº”çš„ç§»ä½è¿ç®— è€Œéä¹˜é™¤æ³•è¿ç®—</p><ul><li>å¯¹å›ºå®šä½æ•°çš„ç§»ä½è¿ç®—ï¼Œä¸éœ€è¦é€»è¾‘å™¨ä»¶ï¼Œåªéœ€è¦å¯¹åŸæœ‰æ•°æ®è¿›è¡Œé‡æ’å³å¯</li><li>å¯¹å¯å˜å‚æ•°çš„ç§»ä½è¿ç®—ï¼Œå¯å°†å¯å˜ç§»ä½è¿ç®—æŒ‰æƒå€¼åˆ†è§£æˆkï¼ˆä½ç§»æ•°ï¼‰ä¸ªå›ºå®šä¸ªæ•°çš„ç§»ä½è¿ç®— ----&gt; <strong>æ¡¶å‹ç§»ä½å™¨</strong><ul><li>çº¯ç»„åˆé€»è¾‘ç”µè·¯ï¼Œç”¨kä¸ªäºŒè·¯é€‰æ‹©å™¨ä¸²è”æ„æˆã€‚kä¸ªäºŒè¿›åˆ¶ä½åˆ†åˆ«è¿æ¥åˆ°kä¸ªäºŒè·¯é€‰æ‹©å™¨çš„é€‰æ‹©æ§åˆ¶ç«¯</li><li>éœ€è¦kä¸ªäºŒè·¯é€‰æ‹©å™¨çš„æ—¶é—´å»¶è¿Ÿï¼Œä¸€ä¸ªäºŒè·¯é€‰æ‹©å™¨éœ€è¦2çº§åŸºæœ¬é—¨ç”µè·¯å»¶è¿Ÿ</li></ul></li></ul><p><em>ç§»ä½æ“ä½œçš„åŸç†</em></p><p><strong>ç®—æœ¯è¿ç®—</strong></p><p>Â±*/ï¼š</p><p>Cè¯­è¨€ä¸­çš„å˜é‡ x å¸¸é‡ä»¥åŠå˜é‡ / å¸¸é‡é€šå¸¸ä¼šè¢«ç¼–è¯‘å™¨ä¼˜åŒ–ï¼Œå¸¸é‡ä¹˜æ³•ä¼šè¢«æ›´å¿«çš„ç§»ä½æŒ‡ä»¤å’Œç®—æ•°åŠ å‡è¿ç®—æŒ‡ä»¤æ›¿ä»£ã€‚é™¤æ³•è¢«å¸¸é‡ä¹˜æ³•å’Œç§»ä½æŒ‡ä»¤çš„ç»„åˆæ›¿ä»£</p><h3 id="å®šç‚¹åŠ å‡æ³•è¿ç®—">å®šç‚¹åŠ å‡æ³•è¿ç®—</h3><p>å‚è€ƒCSAPPï¼Œåç§‘ä¹¦ä¸­ä¹Ÿæœ‰ä¹ é¢˜</p><h4 id="æº¢å‡ºæ£€æµ‹">æº¢å‡ºæ£€æµ‹</h4><h4 id="é€»è¾‘å®ç°">é€»è¾‘å®ç°</h4><h5 id="å…¨åŠ å™¨">å…¨åŠ å™¨</h5><p>3ä¸ªè¾“å…¥ï¼š è¦åŠ çš„ä¸¤ä¸ªä½æ•° X Yã€æ˜¯å¦æœ‰æ¥è‡ªä½ä½çš„è¿›ä½ C_{i}<br>2ä¸ªè¾“å‡ºï¼š æ˜¯å¦æœ‰é«˜ä½çš„è¿›ä½C_{i}ã€ç›¸åŠ çš„ç»“æœS_{i}</p><p>$$S_{i}=  X_{i} \bigoplus Y_{i} \bigoplus C_{i}$$</p><p>é«˜ä½è¿›ä½è¾“å‡ºçš„ä¸¤ç§è¡¨è¾¾æ–¹å¼ï¼š</p><p>$$C_{i}=  X_{i}Y_{i} + (X_{i} + Y_{i})C_{i}$$</p><p>$$C_{i}=  X_{i}Y_{i} + (X_{i} \bigoplus Y_{i})C_{i} $$</p><p>å¼€é”€ä¸åŒï¼š</p><ul><li>â‘ å¼ï¼š3ä¸ªä¸¤è¾“å…¥ä¸é—¨ã€1ä¸ªä¸‰è¾“å…¥æˆ–é—¨ã€2ä¸ªä¸¤è¾“å…¥å¼‚æˆ–é—¨</li><li>â‘¡å¼ï¼š2ä¸ªä¸¤è¾“å…¥ä¸é—¨ã€1ä¸ªä¸¤è¾“å…¥æˆ–é—¨ã€2ä¸ªä¸¤è¾“å…¥å¼‚æˆ–é—¨ï¼Œæˆæœ¬ä½ï¼Œå»¶è¿Ÿé«˜</li></ul><p>æ³¨æ„è¿™é‡Œä¸»è¦æ˜¯$$C_{i+1}$$çš„è¿ç®—åŒºåˆ«</p><p><strong>åŠåŠ å™¨</strong></p><p>æ²¡æœ‰è¿›ä½è¾“å…¥ã€å†…éƒ¨é€»è¾‘åªæœ‰ä¸€ä¸ªå¼‚æˆ–é—¨æ¥äº§ç”Ÿåˆæ•°ï¼Œä¸€ä¸ªä¸é—¨äº§ç”Ÿè¿›ä½è¾“å‡º</p><p>$$S_i = X_i \bigoplus Y_i$$     $$C_{i+1} = X_iY_i$$</p><p>åŠåŠ å™¨é€šå¸¸ç”¨äºæ²¡æœ‰è¿›ä½è¾“å…¥çš„æƒ…å†µï¼Œä»¥å‡å°‘ä¸å¿…è¦çš„ç¡¬ä»¶å¼€é”€ï¼Œæ—¶é—´å»¶è¿Ÿä¸º3T</p><h5 id="å¤šè¡Œä¸²è¡ŒåŠ æ³•å™¨">å¤šè¡Œä¸²è¡ŒåŠ æ³•å™¨</h5><p>nä¸ªå…¨åŠ å™¨çš„è¿›ä½é“¾ä¸²è”å¾—åˆ°nä½ä¸²è¡ŒåŠ æ³•å™¨ ----&gt; è¡Œæ³¢è¿›ä½åŠ æ³•å™¨</p><p>é«˜ä½çš„å…¨åŠ å™¨å¿…é¡»ç­‰å¾…ä½ä½è¿›ä½åæ‰èƒ½å¼€å§‹è¿ç®—ã€‚ä½†Så’ŒCçš„è¿ç®—<s>æ˜¯å¹¶è¡Œçš„</s>ï¼Œ<s>äº’ä¸ç­‰å¾…</s>çš„æœ‰ç¬¦å·ã€æ— ç¬¦å·è¿ç®—å‡å¯</p><ul><li>æ— ç¬¦å·çš„åŠ æ³•ï¼šæº¢å‡ºæ£€æµ‹ä¿¡å· $$C_n$$</li><li>æœ‰ç¬¦å· æº¢å‡ºæ£€æµ‹ï¼šoverflow,æœ€é«˜æ•°å€¼ä½è¿›ä½å’Œç¬¦å·ä½è¿›ä½å¼‚æˆ–å¾—åˆ°</li></ul><h5 id="å¯æ§åŠ å‡æ³•ç”µè·¯">å¯æ§åŠ å‡æ³•ç”µè·¯</h5><p>$$[X]_è¡¥ - [Y]_è¡¥ = [X-Y]_è¡¥ = [X]_è¡¥ + [-Y]_è¡¥$$</p><p>Yçš„æ‰€æœ‰ä½ä¸Subä¿¡å·è¿›è¡Œå¼‚æˆ–åé€å…¥ Sub = 1æ—¶ï¼Œåˆ™é€å…¥çš„æ˜¯Yçš„åç ï¼Œå¹¶ä¸”Subä¹Ÿå®ç°äº†æœ«å°¾+1çš„å–åæ“ä½œ</p><h5 id="å…ˆè¡Œè¿›ä½åŠ æ³•å™¨-CLA">å…ˆè¡Œè¿›ä½åŠ æ³•å™¨(CLA)</h5><p>nä½ä¸²è¡ŒåŠ æ³•ç”µè·¯é«˜ä½çš„è¿ç®—ä»¥æ¥ä¸ä½ä½è¿›ä½è¾“å…¥ï¼Œå…¨åŠ å™¨å¹¶ä¸èƒ½å¹¶è¡Œè¿è¡Œï¼Œä½å®½è¾ƒå¤§æ—¶æ€§èƒ½å·®</p><p>æ›¿æ¢ï¼š $$G_i = X_iY_i$$     $$P_i= X_i \bigoplus Y_i$$<br>Gi = 1æ—¶ï¼ŒCi+1ä¸€å®šä¸º1 ---- Giï¼šè¿›ä½ç”Ÿæˆå‡½æ•°<br>Pi = 1ï¼ŒCiæ‰èƒ½ä¼ é€’åˆ°è¿›ä½è¾“å‡ºCi+1â€”Piï¼šè¿›ä½ä¼ é€’å‡½æ•°<br>æœ€ç»ˆæœ‰ï¼š</p><p>$$G_n = G_{n-1} + P_{n-1}G_{n-2} + â€¦ + P_{n-1}P_{n-2}â€¦P_2P_1P_0C_0$$</p><p>æ ¹æ®å…¬å¼åˆ©ç”¨æ¬§å† é¢å¤–çš„ç»„åˆé€»è¾‘ç”µè·¯<strong>æå‰</strong>äº§ç”Ÿå„ä½è¿ç®—åŠ æ³•æ‰€éœ€è¦çš„æ‰€æœ‰è¿›ä½è¾“å…¥ï¼Œå†åˆ©ç”¨$$S_i = P_i \bigoplus C_i$$è¿›è¡Œä¸€çº§å¼‚æˆ–é—¨è¿ç®—å¯å¾—åˆ°æœ€ç»ˆçš„å’Œæ•°ï¼Œnè¶Šå¤§ï¼Œæ—¶é—´å»¶è¿Ÿä¹Ÿå¤§ï¼Œé€šå¸¸æŒ‰ç…§4ä½ä¸€ç»„è¿›è¡Œå…ˆè¡Œè¿›ä½ï¼ˆå…ˆè¡Œè¿›ä½ç”µè·¯ä½æ•°è¶Šå¤šã€æ‰‡å…¥ç³»æ•°è¶Šå¤§ã€åˆ¶é€ éš¾åº¦è¶Šå¤§ï¼‰</p><p><strong>å¹¶è¡ŒåŠ æ³•å™¨</strong></p><p>4ä½å…ˆè¡Œè¿›ä½ç”µè·¯ + ç”ŸæˆGPçš„ä¸é—¨å¼‚æˆ–é—¨ç”µè·¯ + 4ä¸ªå¼‚æˆ–é—¨ = 4ä½å¿«é€ŸåŠ æ³•å™¨ï¼ˆå¹¶è¡ŒåŠ æ³•å™¨ï¼‰</p><div class="note note-primary">            <p><em>å¦‚ä½•æ„å»ºæ›´å¤§ä½å®½çš„åŠ æ³•å™¨ç”µè·¯ï¼Ÿ</em></p><p>å¤šä¸ªå¿«é€ŸåŠ æ³•å™¨çš„è¿›ä½é“¾ä¸²è”ï¼ˆä½†ç»„é—´ä»ç„¶æ˜¯ä¸²è¡Œè®¡ç®—ï¼‰ã€‚å¯ä»¥è€ƒè™‘å°†4ä¸ª4ä½å¿«é€ŸåŠ æ³•å™¨è¾“å‡ºçš„æˆç»„è¿›ä½ç”Ÿæˆã€ä¼ é€’å‡½æ•°å’ŒC0è¿æ¥åˆ°å…ˆè¡Œè¿›ä½ç”µè·¯çš„è¾“å…¥ç«¯ï¼Œäº§ç”Ÿ4ä¸ªè¿›ä½ä¿¡å·ï¼Œå†å¯¹å¯¹åº”ä¿¡å·è¿æ¥åˆ°ç›¸åº”çš„å¿«é€ŸåŠ æ³•å™¨çš„è¿›ä½è¾“å…¥ç«¯å³å¯æ„æˆ16ä½ç»„å†…å¹¶è¡Œè¿›ä½ã€ç»„é—´å¹¶è¡Œè¿›ä½çš„å¿«é€ŸåŠ æ³•å™¨</p>          </div><h4 id="è¡¥ç åŠ å‡æ³•">è¡¥ç åŠ å‡æ³•</h4><div class="note note-info">            <p>ä¸»è¦ç†è§£ä»åŸç åˆ°è¡¥ç çš„ä¼˜åŒ–è¿‡ç¨‹</p>          </div><p>ä¸€ç§è¡¥ç è¯ç”Ÿçš„æ€è·¯ï¼Œè®¾ a(known) + b(unknown) = 0ï¼Œæ ¹æ®è¿›ä½è§„åˆ™æ¥æ±‚bï¼Œæœ€ç»ˆè¯ç”Ÿäº†è¡¥ç </p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220405102442407.png" alt="image-20220405102442407"></p><p><strong>è¡¥ç åŠ å‡æ³•çš„å¥½å¤„</strong></p><p>èƒ½å¤Ÿè®©è®¡ç®—æœºé€šè¿‡åŠ æ³•ä¹Ÿèƒ½è¿ç®—å‡ºæœ‰æ­£è´Ÿæ•°å’Œè¿›ä½æ—¶çš„æ­£ç¡®ç»“æœï¼Œæ–¹ä¾¿è®¡ç®—ã€‚è€Œä¸ç”¨é€šè¿‡åŸç è¿ç®—åå†å¤æ‚çš„åˆ¤æ–­å¤§å°ã€‚å¹¶ä¸”ä¹Ÿå¯ä»¥åªç”¨åŠ æ³•å™¨å®ç°åŠ å‡æ³•</p><p>çŸ¥è¯†ï¼š</p><ul><li>~a = -a -1;</li><li>å½“æˆ‘é€šè¿‡åŠ æ³•è®¡ç®—å‡ºä¸€ä¸ªè´Ÿæ•°çš„è¡¥ç æ—¶ï¼Œæˆ‘å¦‚ä½•ç¡®å®šå®ƒçš„åŸç çš„è¡¨ç¤ºæ•°å€¼ã€‚æŒ‰ç…§è¡¥ç çš„è§„åˆ™å€’æ¨ï¼Œå…ˆå‡1å†å–å</li></ul><p>æ‰€æœ‰å°±æœ‰å¯¹signed int = (1 &gt;&gt; 31) - 1ï¼Œå…¶æ•°å€¼ç­‰äº -(1&gt;&gt;31)ï¼Œå…¶å®ç†è§£åº”è¯¥ä»ä½çš„æ–¹å¼å…ˆç†è§£ï¼Œç„¶åå†è½¬åŒ–åˆ°å…·ä½“çš„è¡¨ç¤ºå½¢å¼æœ‰ä¸åŒçš„å–å€¼ï¼Œå¦‚æœæ˜¯unsigned intåˆ™ä¸ºåŸå€¼</p><h3 id="å®šç‚¹ä¹˜æ³•è¿ç®—">å®šç‚¹ä¹˜æ³•è¿ç®—</h3><ul><li>å¤šä½åŠ æ³•å™¨å¾ªç¯ç´¯åŠ ï¼Œç¡¬ä»¶å¼€é”€å°ä½†éœ€è¦æ—¶åºç”µè·¯æ§åˆ¶ï¼Œéœ€è¦å¤šä¸ªæ—¶é’Ÿå‘¨æœŸæ‰èƒ½å¾—åˆ°è¿ç®—ç»“æœ</li><li>åŠ æ³•å™¨é˜µåˆ—æ„æˆçš„çº¯ç»„åˆé€»è¾‘ç”µè·¯ï¼Œç¡¬ä»¶å¼€é”€å¤§ä½†åªéœ€è¦ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸ</li></ul><h4 id="åŸç ä¹˜æ³•">åŸç ä¹˜æ³•</h4><p>åŸºæœ¬ç´¯åŠ æ ¸å¿ƒå…¬å¼ï¼š $$P_{i+1} = (P_i + y_{n-1}|x|)2^{-1}$$</p><p>ä¸¤ä¸ªnä½æ•°å‚åŠ ä¹˜æ³•è¿ç®—éœ€è¦ næ¬¡åŠ æ³•å’Œnæ¬¡ç§»ä½æ“ä½œï¼Œéœ€è¦é•¿åº¦2nçš„ç§¯å¯„å­˜å™¨ï¼Œ<strong>ç¬¦å·ä½å•ç‹¬å‚åŠ è¿ç®—</strong></p><ul><li>éœ€è¦å¤šè¾“å…¥å…¨åŠ å™¨ â€”&gt; åŸºäºFAçš„å¾ªç¯ç´¯åŠ 0æˆ–è¢«ä¹˜æ•°</li><li>ä¸åŒä½éƒ¨åˆ†å·¦ç§»æ¬¡æ•°ä¸åŒ â€”&gt; å³ç§»éƒ¨åˆ†ç§¯  ä¹˜æ•°å¯„å­˜å™¨</li><li>éœ€è¦é•¿åº¦ä¸º2nçš„ç§¯å¯„å­˜å™¨ â€”&gt; ä»éƒ¨åˆ†ç§¯å’Œä¹˜æ•°å¯„å­˜å™¨å–ç»“æœ</li></ul><p>**åŒæ­¥é€»è¾‘å³ç§»ï¼š**P yæ‹¼æ¥åœ¨ä¸€èµ·è¿›è¡Œé€»è¾‘å³ç§»</p><p>æ ¸å¿ƒæ˜¯ç†è§£ä¸ºä»€ä¹ˆä¼šå°†yå’ŒPæ”¾åœ¨ä¸€èµ·ï¼Œè¿›è¡ŒåŒæ­¥é€»è¾‘å³ç§»ï¼šå…¬å¼+ä¾¿æ·</p><h4 id="è¡¥ç ä¹˜æ³•">è¡¥ç ä¹˜æ³•</h4><p>$$[x*y]_è¡¥ = [x]_è¡¥ * (0.Y_1Y_2Y_3â€¦Y_n) - Y_0 * [X]_è¡¥$$</p><p>å±•å¼€åå¯å¾—ï¼š $$[X * Y]<em>è¡¥ = [X]<em>è¡¥ * \sum</em>{i=0}^n (y</em>{i+1} - y_{i})2^{-i}$$</p><ul><li>i=næ—¶ï¼Œy_n+1 = 0</li><li>yn+1æ˜¯å“ªä¸ªå¯„å­˜å™¨ï¼Ÿ åœ¨ä¹˜æ•°å¯„å­˜å™¨Yåå¢åŠ ä¸€ä½ï¼Œä¸ºäº†ä¹˜æ³•æŒ‰ç…§è§„åˆ™è¿›è¡Œ</li><li>ç®—æ•°å³ç§»çš„å¯¹è±¡æœ‰å“ªäº›ï¼Ÿ   éƒ¨åˆ†ç§¯å’Œä¹˜æ•°å¯„å­˜å™¨</li></ul><p><strong>ç¬¦å·ä½å‚åŠ è¿ç®—</strong></p><ol><li><p><strong>Boothç®—æ³•</strong></p></li><li><p><strong>è¡¥ç ä¸€ä½ä¹˜æ³•ç®—æ³•</strong></p><p>é€»è¾‘å·¦ç§»ã€é€»è¾‘å³ç§»</p></li></ol><h4 id="ä¹˜æ³•è¿ç®—å™¨è®¾è®¡">ä¹˜æ³•è¿ç®—å™¨è®¾è®¡</h4><p><strong>åŸç ä¸€ä½ä¹˜æ³•</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211025135856404.png" alt="image-20211025135856404"></p><p><strong>è¡¥ç ä¸€ä½ä¹˜æ³•</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211025142032069.png" alt="image-20211025142032069"></p><ul><li>éœ€è¦æ—¶åºæ§åˆ¶(A-&gt; ALUâ€¦)</li><li>éœ€è¦å¤šæ¬¡å¾ªç¯ç´¯åŠ </li></ul><p><strong>é˜µåˆ—ä¹˜æ³•å™¨</strong></p><p>ä¸é—¨é˜µåˆ—+FAé˜µåˆ—</p><p><strong>åŸç é˜µåˆ—ä¹˜æ³•å™¨</strong></p><p>åŸç†ï¼š</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211025141255448.png" alt="image-20211025141255448"></p><p>å…·ä½“å®ç°ï¼š ï¼ˆæ‰‹å·¥ä¹˜æ³•ï¼‰</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211025140622036.png" alt="image-20211025140622036"></p><p>æ¯ä¸€è¡Œéƒ½æ˜¯ä¸²è¡Œè¿›ä½åŠ æ³•å™¨  ï¼Œæ”¹è¿›åï¼ˆæ‰“ç ´ä¸²è¡Œè¿›ä½é“¾ï¼‰</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211025140828023.png" alt="image-20211025140828023"></p><p>é€Ÿåº¦æ›´å¿«ï¼ŒåŒçº§çš„FAä¸å­˜åœ¨ä¸²è¡Œè¿›ä½äº†ï¼Œä½†éœ€è¦ å¢åŠ ä¸€è¡Œï¼Œå¤„ç†æœ€åä¸€è¡ŒFAçš„è¿›ä½å…³ç³»</p><p><strong>è¡¥ç é˜µåˆ—ä¹˜æ³•å™¨è®¾è®¡</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211025142135047.png" alt="image-20211025142135047"></p><p>ç®—å‰æ±‚è¡¥å’Œç®—åæ±‚è¡¥</p><h3 id="å®šç‚¹æ•°é™¤æ³•">å®šç‚¹æ•°é™¤æ³•</h3><p>æ‰‹å·¥é™¤æ³•æ€ä¹ˆç®— ----&gt; å¯ç¤ºï¼šé™¤æ³•è¿ç®—å¯é€šè¿‡å‡æ³•å®ç°</p><p>å­˜åœ¨é—®é¢˜ï¼š</p><ul><li>é™¤æ•°å³ç§»æ¬¡æ•°å¯èƒ½å¾ˆå¤š</li><li>éœ€è¦é•¿åº¦ä¸º2nçš„å¯„å­˜å™¨ä¿å­˜ä½™æ•°</li><li>å¦‚ä½•åˆ¤æ–­æ¯æ­¥æ˜¯å¦<strong>å¤Ÿå‡</strong><ul><li>ä½™æ•°ä¸ºæ­£æ—¶ï¼Œå•†1ï¼Œå°†ä½™æ•°å·¦ç§»1ä½ï¼Œå†ä¸é™¤æ•°åšæ¯”è¾ƒ</li><li>ä½™æ•°ä¸ºè´Ÿï¼Œä¸å¤Ÿå‡ï¼Œå•†0ã€‚åŠ é™¤æ•°æ¥æ¢å¤æˆåŸæ¥çš„å€¼ï¼Œå°†ä½™æ•°å·¦ç§»ä¸€ä½å¹¶åšæ¯”è¾ƒ</li></ul></li></ul><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211025143233972.png" alt="image-20211025143233972"></p><p>æ³¨æ„ï¼šæœ€ç»ˆç®—å‡ºæ¥çš„ä½™æ•°æ˜¯ç»è¿‡å·¦ç§»æ”¹å˜çš„ï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œç›¸åº”ä½æ•°å³ç§»æ¥è¿˜åŸ</p><p>ç¼ºç‚¹ï¼šè¿ç®—æ­¥æ•°ä¸èƒ½åœ¨è¿ç®—ä¹‹å‰å°±ç¡®å®šï¼ˆæ¥æºï¼šæ¢å¤ä½™æ•°çš„æ¬¡æ•°æ— æ³•ç¡®å®šï¼‰</p><p><strong>åŠ å‡äº¤æ›¿æ³•ï¼ˆä¸æ¢å¤ä½™æ•°æ³•ï¼‰</strong></p><p>ä½™æ•°&lt; 0 æ—¶ä¸éœ€è¦æ¢å¤ï¼Œä»ç„¶å·¦ç§»ï¼Œåªæ˜¯å†åŠ ä¸ŠY,ç»“æœæ˜¯å’Œæ¢å¤ä½™æ•°æ˜¯ä¸€æ ·çš„</p><p>è¿‡ç¨‹ç®€å•ã€è¿ç®—æ­¥æ•°å›ºå®š(???)</p><p><strong>ç”µè·¯å›¾</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211025143922168.png" alt="image-20211025143922168"></p><h4 id="é˜µåˆ—é™¤æ³•">é˜µåˆ—é™¤æ³•</h4><p><strong>å¯æ§åˆ¶åŠ /å‡å•å…ƒ CAS</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211025144253229.png" alt="image-20211025144253229"></p><p>é€»è¾‘åŠŸèƒ½ï¼š</p><p>$$ S_i = A_i \bigoplus (B_i \bigoplus P) \bigoplus C_i$$</p><p>$$ C_{i+1} = (A_i + C_i) (B_i \bigoplus P) + A_i C_i$$</p><p>P=0æ—¶å®ç°åŠ æ³•åŠŸèƒ½ï¼ŒP=1æ—¶å®ç°å‡æ³•åŠŸèƒ½</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211025144819745.png" alt="image-20211025144819745"></p><ul><li>ç¬¬ä¸€æ­¥ä¸€å®šæ˜¯å‡æ³• P=1ï¼Œåé¢åˆ™å–å†³äºæ¯ä¸€æ­¥çš„å•†</li><li>æœ€å·¦è¾¹çš„CASçš„è¿›ä½è¾“å‡ºæ˜¯å•†ï¼Œä¸”æœ¬ä½å•†å†³å®šä¸‹ä¸€æ­¥æ˜¯åŠ æ“ä½œè¿˜æ˜¯å‡æ“ä½œ</li><li>æ¯æ‰§è¡Œå®Œä¸€æ­¥é™¤æ³•ï¼Œé™¤æ•°å°±å³ç§»ä¸€ä½ï¼ˆæ‰‹å·¥é™¤æ³•ï¼‰ï¼ˆCASç”µè·¯éƒ½å‘å³åç§»ä¸€åˆ—ï¼Œé—´æ¥å®ç°äº†ä½™æ•°çš„å·¦ç§»ï¼‰</li></ul><h3 id="æµ®ç‚¹è¿ç®—">æµ®ç‚¹è¿ç®—</h3><p>è§„æ ¼åŒ–æµ®ç‚¹æ•°ï¼Œå°†æ•°æ®çš„è¡¨ç¤ºèŒƒå›´å’Œç²¾ç¡®åº¦ç»Ÿä¸€</p><p>è§„æ ¼åŒ–çš„æµ®ç‚¹æ•°è¡¥ç å½¢å¼ å°¾æ•°å½¢å¼ä¸ºï¼š<br>00.1xxxxã€11.0xxxxx(æœ€é«˜æœ‰æ•ˆæ•°æ®ä½ä¸ç¬¦å·ä½ä¸èƒ½ç›¸åŒ)</p><ul><li>ç»“æœä¸º00.0xxxxxæˆ–è€…11.1xxxx,éœ€è¦<strong>å·¦è§„æ ¼åŒ–</strong>ï¼Œå°†å°¾æ•°å‘å·¦ç§»åŠ¨ï¼Œæ¯ç§»åŠ¨ä¸€æ¬¡ï¼Œé˜¶ç -1ï¼ŒçŸ¥é“æ»¡è¶³è¦æ±‚</li><li>å°¾æ•°ç»“æœä¸º01.xxxxæˆ–è€…10.xxxxxï¼Œè¡¨æ˜å°¾æ•°æ±‚å’Œç»“æœ&gt;1ï¼Œä»…éœ€æ‰§è¡Œ<strong>ä¸€æ¬¡å³ç§»</strong>ï¼Œé˜¶ç +1å³å¯</li></ul><p>$$x = 2^{Ex}* Mx$$             $$ y = 2^{Ey} * My$$<br>$$x + y = (2^{Ex - Ey} * Mx + My )* 2^{Ey}$$</p><p>æ­¥éª¤ï¼š</p><ol><li>å¯¹é˜¶<ol><li>æ±‚é˜¶å·®Ex + (- Ey)</li><li>å³ç§»é˜¶ç å°çš„æµ®ç‚¹æ•°çš„å°¾æ•°å¹¶åŒæ­¥å¢åŠ å…¶é˜¶ç ï¼Œç›´åˆ°ä¸¤æ•°é˜¶ç ç›¸ç­‰</li></ol></li><li>å°¾æ•°åŠ å‡</li><li>ç»“æœè§„æ ¼åŒ–</li><li>èˆå…¥ï¼šå³ç§»è§„æ ¼è¯çš„åŒæ—¶å¯èƒ½ä¸¢å¤±ä¸€äº›ä½ä½çš„æ•°å€¼ä½ï¼Œä¸ºæé«˜ç²¾åº¦ï¼Œå¯é‡‡ç”¨<ol><li>0èˆ1å…¥ï¼šè‹¥å³ç§»å‡ºçš„æœ€é«˜ä½æ˜¯1ï¼Œåˆ™åœ¨æœ€ä½ä½åŠ 1</li><li>æ’ç½®1ï¼šåªè¦æ•°å­—ä½1è¢«ç§»èµ°ï¼Œå°±å°†æœ€å1ä½æ’ç½®1</li></ol></li><li>æº¢å‡ºå¤„ç†ï¼š<ol><li>é˜¶ç ä¸Šæº¢ï¼šé˜¶ç çš„ç¬¦å·ä½ä¸º01</li><li>é˜¶ç ä¸‹æº¢ï¼šé˜¶ç çš„ç¬¦å·ä½ä¸º10</li></ol></li></ol><p>æµ®ç‚¹ä¹˜æ³•å’Œé™¤æ³•éƒ½å¤§åŒå°å¼‚</p><h2 id="å­˜å‚¨å™¨ç³»ç»Ÿ">å­˜å‚¨å™¨ç³»ç»Ÿ</h2><h3 id="å­˜å‚¨å™¨æ¦‚è¿°">å­˜å‚¨å™¨æ¦‚è¿°</h3><p>**å­˜å‚¨å•å…ƒï¼š**å­˜å‚¨å™¨ä¸­çš„æœ€å°å­˜å‚¨å•ä½ â€“ å­˜å‚¨å…ƒ</p><p>**MOSï¼š**åœºæ•ˆåº”ç®¡ã€‚é‡‘å±+æ°§åŒ–ç‰©+åŠå¯¼ä½“åœºæ•ˆåº”æ™¶ä½“ç®¡</p><h4 id="åˆ†ç±»">åˆ†ç±»</h4><p><strong>æŒ‰ç…§å­˜å‚¨ä»‹è´¨åˆ†ç±»</strong></p><ul><li><p>ç£å­˜å‚¨å™¨ï¼šç£æ€§ææ–™åšä»‹è´¨ï¼Œåˆ©ç”¨ç£åŒ–å•å…ƒå‰©ç£çš„ä¸åŒç£åŒ–æ–¹å‘æ¥å­˜å‚¨æ•°æ®0 å’Œ 1.ä½“ç§¯å¤§ã€å­˜å‚¨é€Ÿåº¦æ…¢ã€å•ä½å®¹é‡æˆæœ¬ä½</p></li><li><p>åŠå¯¼ä½“å­˜å‚¨å™¨ï¼š</p><ul><li><p>åŒæå‹å­˜å‚¨å™¨ï¼š TTLã€ECL</p></li><li><p>é‡‘å±æ°§åŒ–ç‰©åŠå¯¼ä½“å­˜å‚¨å™¨ï¼šMOSå­˜å‚¨å™¨</p><ul><li>é™æ€MOSå­˜å‚¨å™¨ SRAM</li><li>åŠ¨æ€MOSå­˜å‚¨å™¨ DRAM</li></ul><p>å­˜å‚¨ä½“ç§¯å°ï¼Œå­˜å‚¨é€Ÿåº¦å¿«ï¼Œå•ä½å®¹é‡æˆæœ¬é«˜</p></li></ul></li><li><p>å…‰å­˜å‚¨å™¨ï¼š åˆ©ç”¨ä»‹è´¨çš„å…‰å­¦ç‰¹æ€§ï¼ˆCD-ROM DVD-ROMï¼‰ä»¥åˆ»ç—•å½¢å¼å°†æ•°æ®å­˜åœ¨ç›˜é¢ï¼Œç”¨æ¿€å…‰æŸç…§å°„ç›˜é¢ï¼Œé ä¸åŒçš„åå°„ç‡æ¥è¯»ä¿¡æ¯</p><ul><li>ç£å…‰ç›˜ï¼šæ¿€å…‰+çƒ­è¾…åŠ©ç£åŒ–çš„æ–¹å¼ï¼Œæ ¹æ®åå°„å…‰çš„åæŒ¯æ–¹å‘ä¸åŒè¯»ä¿¡æ¯</li></ul></li></ul><p><strong>æŒ‰ç…§å­˜å–æ–¹å¼åˆ†ç±»</strong></p><ul><li>éšæœºå­˜å‚¨å™¨ï¼šRAMï¼ŒæŒ‰ç…§åœ°å€éšæœºè¯»å†™æ•°æ®å­˜å‚¨å•å…ƒï¼Œå­˜å–è®¿é—®æ—¶é—´ä¸å­˜å‚¨å•å…ƒçš„ä½ç½®æ— å…³ã€‚ç°åœ¨å¤§é‡çš„åŠå¯¼ä½“å­˜å‚¨å™¨éƒ½æ˜¯RAM</li><li>é¡ºåºå­˜å‚¨å™¨ï¼šSAMï¼Œå­˜å‚¨å•å…ƒçš„å†…å®¹åªèƒ½ä¾åœ°å€é¡ºåºè®¿é—®ï¼Œ<strong>è®¿é—®é€Ÿåº¦ä¸å­˜å‚¨å•å…ƒçš„ä½ç½®æœ‰å…³</strong>çš„å­˜å‚¨å™¨ï¼ˆç£å¸¦å­˜å‚¨ï¼‰</li><li>ç›´æ¥å­˜å‚¨å™¨ï¼š DAMï¼Œä¸å¿…ç»è¿‡é¡ºåºæœç´¢å°±èƒ½åœ¨å­˜å‚¨å™¨ä¸­ç›´æ¥å­˜å–ä¿¡æ¯ï¼Œå…·æœ‰RAMå’ŒSAMçš„ç‰¹æ€§ï¼ˆç£ç›˜å­˜å‚¨å™¨ï¼‰ã€‚ç”±äºç£ç›˜å­˜åœ¨æœºæ¢°å¯»é“å’Œæ—‹è½¬å»¶è¿Ÿï¼Œå› æ­¤æ•°æ®è®¿é—®æ—¶é—´å’Œç£å¤´ä¸ç›®æ ‡æ‰‡åŒºçš„è·ç¦»æœ‰å…³</li></ul><p><strong>æŒ‰ç…§ä¿¡æ¯çš„å¯æ”¹å†™æ€§</strong></p><ul><li>è¯»å†™å­˜å‚¨å™¨ï¼šæ—¢èƒ½è¯»å‡ºåˆèƒ½å†™å…¥ä¿¡æ¯</li><li>åªè¯»å­˜å‚¨å™¨ï¼šROM</li></ul><p><strong>æŒ‰ç…§åŠŸèƒ½å’Œå­˜å–é€Ÿåº¦åˆ†ç±»</strong></p><ul><li>å¯„å­˜å™¨å­˜å‚¨å™¨ï¼ˆCPUç±»ï¼‰</li><li>é«˜é€Ÿç¼“å†²å­˜å‚¨å™¨ï¼š åœ¨å¯„å­˜å™¨å’Œé©»æ‘ä¹‹é—´çš„é«˜é€Ÿå°å®¹é‡å­˜å‚¨å™¨ï¼Œå­˜æ”¾CPUå³å°†æˆ–è€…ç»å¸¸è¦ä½¿ç”¨çš„æŒ‡ä»¤å’Œæ•°æ®ã€‚é‡‡ç”¨é™æ€RAMæ„æˆ</li><li>ä¸»å­˜å‚¨å™¨ï¼šCPUä¸­é™¤äº†å¯„å­˜å™¨ä¹‹å¤–å”¯ä¸€èƒ½ç›´æ¥è®¿é—®çš„å­˜å‚¨å™¨ï¼Œå­˜æ”¾æ‰§è¡Œå’Œæ•°æ®ã€‚CPUé€šè¿‡ä¸»å­˜åœ°å€ç›´æ¥ã€éšæœºåœ°è¯»å†™å­˜å‚¨å™¨ã€‚ä¸»å­˜ä¸€èˆ¬ç”±åŠå¯¼ä½“æ„æˆï¼Œå¯èƒ½è¿˜åŒ…æ‹¬ç¡¬ä»¶ç«¯å£å’ŒBIOS</li><li>å¤–å­˜å‚¨å™¨ï¼š å®¹é‡å¤§ã€é€Ÿåº¦ä½ã€‚å­˜æ”¾å½“å‰æš‚æ—¶ä¸å‚ä¸è¿è¡Œçš„ç¨‹åºä¸æ•°æ®</li></ul><p>å­˜å‚¨å™¨å¸¦å®½ï¼š å•ä½æ—¶é—´å†…å­˜å‚¨å™¨èƒ½ä¼ è¾“çš„ä¿¡æ¯é‡ ï¼ˆä½/ç§’ å­—èŠ‚/ç§’ï¼‰</p><h4 id="å­˜å‚¨ç³»ç»Ÿå±‚æ¬¡ç»“æ„">å­˜å‚¨ç³»ç»Ÿå±‚æ¬¡ç»“æ„</h4><h4 id="ä¸»å­˜çš„åŸºæœ¬ç»“æ„">ä¸»å­˜çš„åŸºæœ¬ç»“æ„</h4><p>ä¸»å­˜æ˜¯æœºå™¨æŒ‡ä»¤ç›´æ¥æ“ä½œçš„å­˜å‚¨å™¨ï¼Œé‡‡ç”¨ä¸»å­˜åœ°å€è¿›è¡Œéšæœºè®¿é—®</p><ul><li>åœ°å€è¯‘ç å™¨æ¥æ”¶åˆ°æ¥è‡ªCPUçš„nä½åœ°å€ä¿¡å·ï¼Œç»è¿‡è¯‘ç ã€é©±åŠ¨åäº§ç”Ÿ2^næ ¹åœ°å€è¯‘ç ä¿¡å·ï¼Œæ¯ä¸€æ ¹åœ°å€è¯‘ç ä¿¡å·è¿æ¥ä¸€ä¸ªå­˜å‚¨å•å…ƒ</li><li>æ•°æ®å¯„å­˜å™¨æ°¸è¿œæ˜¯å­˜å–å°†è¦é€èµ°æˆ–è€…é€æ¥çš„æ•°æ®</li><li>è¯»å†™æ§åˆ¶ç›¸å½“äºä¸€ä¸ªç½‘å…³ï¼Œäº§ç”Ÿè¯»å†™çš„ä¿¡å·</li></ul><h4 id="ä¸»å­˜ä¸­çš„æ•°æ®å­˜æ”¾">ä¸»å­˜ä¸­çš„æ•°æ®å­˜æ”¾</h4><p><strong>å­˜å‚¨å­—é•¿ï¼š</strong> ä¸»å­˜çš„ä¸€ä¸ªå­˜å‚¨å•å…ƒæ‰€å­˜å‚¨çš„äºŒè¿›åˆ¶ä½æ•°<br><strong>æ•°æ®å­—é•¿ï¼ˆå­—é•¿ï¼‰ï¼š</strong> è®¡ç®—æœºä¸€æ¬¡èƒ½å¤„ç†çš„äºŒè¿›åˆ¶æ•°çš„ä½æ•°<br><strong>å­˜å‚¨å­—é•¿å’Œæ•°æ®å­—é•¿å¯ä»¥ä¸åŒ</strong></p><p>(ç½‘ä¸Šè¯´æ•°æ®å­—é•¿æ˜¯è®¡ç®—æœºæ•°æ®å­˜å‚¨æ‰€å ç”¨çš„ä½æ•°ï¼Œæœºå™¨å­—é•¿æ˜¯CPUä¸€æ¬¡èƒ½å¤„ç†æ•°æ®çš„ä½æ•°)</p><p><strong>åœ°å€è®¿é—®æ¨¡å¼</strong></p><p>ä¸»å­˜æŒ‰ç…§å­—èŠ‚è¿›è¡Œç¼–å€ï¼Œå¯ä»¥é€šè¿‡å­—èŠ‚åœ°å€ã€åŠå­—åœ°å€ã€å­—åœ°å€ï¼ˆå­—èŠ‚åœ°å€çš„é€»è¾‘å³ç§»ï¼‰æ¥è¿›è¡Œè®¿é—®</p><p><strong>å¤§ç«¯å°ç«¯</strong></p><p>ä¸åŒçš„è®¿é—®é¡ºåºå¯¼è‡´è®¿é—®çš„æ•°æ®å®Œå…¨ä¸åŒ</p><ul><li>å°ç«¯ï¼š å­˜å‚¨å™¨çš„ä½å­—èŠ‚åœ°å€å•å…ƒå­˜æ”¾çš„æ•°æ®çš„ä½å­—èŠ‚<ul><li>ä¸»æµå¤„ç†å™¨é‡‡ç”¨</li></ul></li><li>å¤§ç«¯ï¼š å­˜å‚¨å™¨çš„ä½å­—èŠ‚åœ°å€å•å…ƒå­˜æ”¾çš„æ•°æ®çš„é«˜å­—èŠ‚</li></ul><p><strong>æ•°æ®çš„è¾¹ç•Œå¯¹é½</strong></p><p>ä¸€ä¸ªå¤šå­—èŠ‚å˜é‡åˆ†å¸ƒåœ¨ä¸åŒçš„å­—å­˜å‚¨å•å…ƒä¸­ï¼Œè®¿é—®æ”¹å˜é‡å°±éœ€è¦å¤šä¸ªå­˜å‚¨å‘¨æœŸ</p><ul><li>dwæ•°æ®èµ·å§‹åœ°å€çš„æœ€æœ«3ä½ä¸º000ï¼Œåœ°å€æ˜¯8çš„æ•´æ•°å€</li><li>wæ•°æ®èµ·å§‹åœ°å€æœ€æœ«ä¸¤ä½ä¸º00.åœ°å€æ˜¯4çš„æ•´æ•°å€</li><li>åŠå­—æ ‘å…¶å®åœ°å€çš„æœ€ä½ä¸€ä½æ˜¯0ï¼Œåœ°å€æ˜¯2çš„æ•´æ•°å€</li><li>å•å­—èŠ‚æ•°æ®ä¸å­˜åœ¨è¾¹ç•Œå¯¹é½é—®é¢˜</li></ul><p>ä»¥ç©ºé—´æ¢æ—¶é—´ï¼Œ<a href="https://blog.csdn.net/lgouc/article/details/8235471">ç†è§£ä¸ºä»€ä¹ˆéœ€è¦å†…å­˜å¯¹é½</a></p><h3 id="åŠå¯¼ä½“å­˜å‚¨å™¨">åŠå¯¼ä½“å­˜å‚¨å™¨</h3><p>å­˜å–é€Ÿåº¦å¿«ï¼Œä½“ç§¯å°ï¼Œæ€§èƒ½å¥½  åˆ†ä¸ºRAMå’ŒROMå­˜å‚¨å™¨</p><p>ä½œä¸ºå­˜å‚¨å•å…ƒç”µè·¯ï¼Œéœ€è¦å…·å¤‡ï¼š</p><ul><li>å…·æœ‰ä¸¤ç§ç¨³å®šçŠ¶æ€</li><li>çŠ¶æ€ç»å¤–éƒ¨ä¿¡å·æ§åˆ¶å¯ç›¸äº’è½¬æ¢</li><li>ç»æ§åˆ¶åèƒ½è¯»å‡ºå…¶ä¸­çš„ä¿¡æ¯</li><li>ä¿¡æ¯èƒ½é•¿æœŸä¿å­˜</li></ul><p><strong>6ç®¡MOSå­˜å‚¨å•å…ƒ</strong></p><p><strong>å­˜å‚¨å•å…ƒæ‰©å±•</strong></p><h4 id="é™æ€MOSå­˜å‚¨å™¨">é™æ€MOSå­˜å‚¨å™¨</h4><p>ä¸€ç»´è¡Œæ‰©å±•ï¼š å•è¯‘ç ç»“æ„<br>äºŒç»´è¡Œåˆ—æ‰©å±•ï¼š åŒè¯‘ç ç»“æ„ï¼Œä¸¤ä¸ªæ–¹å‘è®¾ç½®n/2è·¯è¾“å…¥è¯‘ç å™¨ã€‚è¾“å‡ºä¿¡å·å°‘å¾ˆå¤šï¼ˆä¸ºå•¥ï¼Ÿï¼‰ï¼Œè¯‘ç ç”µè·¯æˆæœ¬é™ä½</p><p>è¯‘ç å™¨ï¼ˆæœ€å°é¡¹å‘ç”Ÿå™¨ï¼‰ï¼šç»„åˆé€»è¾‘ç”µè·¯ï¼Œå°†nä½äºŒè¿›åˆ¶ä¿¡å·è¾“å…¥ç¿»è¯‘æˆ2^nä¸ªè¾“å‡ºä¿¡å·ï¼Œæ¯ä¸ªè¾“å‡ºä¿¡å·éƒ½æ˜¯nä½è¾“å…¥çš„æœ€å°é¡¹</p><p><strong>ç»“æ„</strong></p><h4 id="åŠ¨æ€MOSå­˜å‚¨å™¨">åŠ¨æ€MOSå­˜å‚¨å™¨</h4><p>SRAMå­˜å‚¨å¯†åº¦ä½ï¼Œå³ä½¿å­˜å‚¨å•å…ƒä¸å†™å…¥ï¼Œä¹Ÿä¼šæœ‰ç”µæµï¼ŒåŠŸè€—å¤§</p><ol><li><p><strong>å•ç®¡DMOSå­˜å‚¨å•</strong></p><p>ä¸€ä¸ªMOSç®¡+ ä¸€ä¸ªç”µå®¹</p><p>ç¼ºé™·ï¼š</p><ol><li>DRAMåˆ©ç”¨å­˜å‚¨ç”µå®¹çš„ç”µè·è¡¨ç¤ºæ•°æ®ï¼Œé‡å‘ç‚¹è¿‡ç¨‹æ…¢ï¼Œå¯¼è‡´äº†è¯»å†™é€Ÿåº¦æ¯”SRAMå•å…ƒæ…¢</li><li>å­˜å‚¨ç”µå®¹çš„å®¹é‡æ¯”å¯„ç”Ÿç”µå®¹å°ä¸€ä¸ªå®¹é‡çº§ï¼ŒäºŒè€…è¿›è¡Œç”µè·é‡åˆ†é…äº§ç”Ÿçš„ç”µæµååˆ†å¾®å¼±ï¼Œéœ€è¦çµæ•çš„å·®åˆ†æ”¾å¤§å™¨æ£€æµ‹ã€‚è¯»æ“ä½œå¯èƒ½å¯¼è‡´ç”µè·å‡å°‘ï¼Œç ´ååŸæœ‰æ•°æ®ï¼Œä¸ºé¿å…æ•°æ®ä¸¢å¤±ï¼Œè¯»å‡ºåä¼šå°†æ•°æ®é‡æ–°å†™å…¥â€”æ•°æ®æ¢å¤</li><li>æ•°æ®æ¢å¤ä»¥åŠè¯»å‡ºä¿¡å·æ”¾å¤§çš„é€»è¾‘ç”±å†ç”Ÿæ”¾å¤§ç”µè·¯å®ç°ï¼Œæ¯ç»„åˆ—çº¿ä¸Šå…±äº«</li><li>ç”µå®¹çš„ç”µè·ä¼šé€æ¸æ³„éœ²ï¼Œæ•°æ®åªèƒ½ä¿å­˜è¾ƒçŸ­æ—¶é—´ã€‚éœ€è¦ç±»ä¼¼è¯»æ“ä½œçš„æ–¹å¼å¯¹å­˜å‚¨å•å…ƒè¡¥å……ç”µè·â€”åˆ·æ–°----ä¸ºä»€ä¹ˆå«DRAM</li></ol></li><li><p><strong>å¦‚ä½•åˆ·æ–°</strong></p><p>æœ€å¤§åˆ·æ–°å‘¨æœŸï¼š ä¿¡æ¯å­˜å‚¨åˆ°æ•°æ®ä¸¢å¤±ä¹‹å‰çš„æ—¶é—´é—´éš”<br>åˆ·æ–°å‘¨æœŸï¼šå­˜å‚¨å™¨å®é™…å®Œæˆä¸¤æ¬¡åˆ·æ–°çš„é—´éš”ï¼ˆ2ms 4ms 8ms/â€¦ï¼‰</p><p>åŠ¨æ€å­˜å‚¨å™¨æŒ‰è¡Œè¿›è¡Œåˆ·æ–°ï¼Œä¸ºå‡å°‘åˆ·æ–°å‘¨æœŸï¼Œå¯å‡å°‘å­˜å‚¨çŸ©é˜µçš„è¡Œæ•°ã€å¢åŠ åˆ—æ•°ï¼Œåªéœ€è¦ç»™å‡ºè¡Œåœ°å€å³å¯</p><p>åˆ·æ–°æ—¶DRAMä¸èƒ½å“åº”CPUçš„è®¿é—®ï¼Œä¸‰ç§è§£å†³æ–¹å¼</p><ul><li>é›†ä¸­åˆ·æ–°<ul><li>è¯»å†™æ“ä½œæœŸé—´ä¸å—åˆ·æ–°æ“ä½œçš„å½±å“ï¼Œå­˜å‚¨å™¨é€Ÿåº¦å¿«</li><li>å­˜åœ¨è¾ƒé•¿çš„æ—¶é—´æ­»åŒºï¼Œåœ¨é›†ä¸­åˆ·æ–°çš„nä¸ªè¯»å†™å‘¨æœŸå†…ï¼ŒCPUéƒ½ä¸èƒ½è®¿é—®å­˜å‚¨å™¨</li></ul></li><li>åˆ†æ•£åˆ·æ–°<ul><li>åˆ’åˆ†å­˜å‚¨å‘¨æœŸï¼Œå‰æ®µæ—¶é—´æ¥è¯»å†™ åç«¯æ—¶é—´æ¥åˆ·æ–°ï¼ˆç±»ä¼¼å¾®æ—¶éš™å†åˆ†ï¼‰ï¼Œåˆ™è¿‡nä¸ªtså°±å¯ä»¥å®Œå…¨åˆ·æ–°ï¼Œåœ¨ä¸€ä¸ªåˆ·æ–°é—´éš”å†…èƒ½è¿›è¡Œå¤šæ¬¡åˆ·æ–°</li><li>ä¸å­˜åœ¨æ­»åŒº</li><li>åˆ·æ–°è¿‡äºé¢‘ç¹ï¼Œå½±å“ç³»ç»Ÿé€Ÿç‡</li></ul></li><li>å¼‚æ­¥åˆ·æ–°<ul><li>é›†ä¸­åˆ·æ–°+åˆ†æ•£åˆ·æ–°</li><li>xè¡Œçš„åˆ·æ–°å¹³å‡åˆ†æ•£åœ¨åˆ·æ–°é—´éš”å†…ï¼Œæ¯ä¸ªä¸€æ®µæ—¶é—´åˆ·æ–°ä¸€è¡Œï¼Œå°†åˆ·æ–°é—´éš”çš„æœ€å0.5usæ¥åˆ·æ–°</li><li>å……åˆ†åˆ©ç”¨2msæ—¶é—´ï¼Œä¿æŒäº†ç³»ç»Ÿçš„å‘Šè¯‰ç‰¹æ€§</li></ul></li></ul></li></ol><h4 id="åªè¯»å­˜å‚¨å™¨">åªè¯»å­˜å‚¨å™¨</h4><ul><li>æ©è†œå¼ROM MROMï¼šæŠŠ0 1 ä¿¡æ¯å­˜å‚¨åœ¨æ©è†œå›¾å½¢ä¸­ï¼ŒèŠ¯ç‰‡å®Œæˆåå„å­˜å‚¨ä½çŠ¶æ€è¢«å›ºå®šï¼Œä¸èƒ½ä¿®æ”¹ã€‚çµæ´»æ€§å·®å¯é æ€§é«˜</li><li>å¯ç¼–ç¨‹ROM PROM ï¼šç”¨æˆ·å¯å†™ä¸€æ¬¡ï¼Œé‡‡ç”¨ç†”ä¸ä»£æ›¿å¼€å…³ï¼Œå­˜å‚¨å™¨å‡ºå‚æ—¶æ¯ä¸ªå­˜å‚¨å•å…ƒçš„ç†”ä¸éƒ½æ˜¯è¿æ¥çŠ¶æ€ï¼Œå­˜å‚¨æ•°æ®å…¨ä¸º0.å¯åˆ©ç”¨ç¼–ç¨‹å™¨è¿›è¡Œä¸€æ¬¡æ”¹å†™ï¼Œå¯é€šè¿‡è¾…åŠ©ç”µè·¯æœ‰é€‰æ‹©åœ°å°†æŸäº›å­˜å‚¨å•å…ƒçš„ç†”ä¸é«˜å‹ç†”æ–­ï¼Œå†å†™å…¥æ•°æ®1<ul><li>é™¤ç†”ä¸å‹ï¼Œè¿˜æœ‰é‡‡ç”¨åå‘äºŒæç®¡çš„PROM,é»˜è®¤çŠ¶æ€ä¸å¯¼é€šï¼Œé»˜è®¤æ•°æ®ä¸º1ï¼Œæ”¹å†™æ—¶é‡‡ç”¨é«˜å‹å°†å…¶æ°¸ä¹…æ€§å‡»ç©¿ï¼Œå¯¼é€šæ•°æ®ä¸º0.</li></ul></li><li>å¯æ“¦é™¤å¯ç¼–ç¨‹ROM EPROMï¼šå¯å¤šæ¬¡å†™å…¥ï¼Œå¯æ“¦é™¤è¿›è¡Œé‡å†™<ul><li>æµ®ç½®æ …ï¼šMOSç®¡çš„æ …æåŸ‹å…¥SiO2ä¸­ä¸”æµ®ç©ºä¸å¤–ç•Œç»ç¼˜ã€‚</li><li>åˆ©ç”¨æµ®ç½®æ …MOSç®¡çš„å¯¼é€šå’Œæˆªæ­¢çŠ¶æ€å­˜å‚¨æ•°æ®ï¼Œåˆå§‹æ— ç”µè·ï¼ŒMOSç®¡æˆªæ­¢ï¼›å†™å…¥æ—¶åœ¨æºçº§å’Œæ¼çº§åŠ ä¸Šç¼–ç¨‹ç”µå‹ï¼ŒMOSç®¡åœ¨é«˜å‹ä½œç”¨ä¸‹è¢«å‡»ç©¿ã€‚é«˜å‹æ’¤å‡ºåï¼Œæµ®ç½®æ …æœ‰ç»ç¼˜å±‚ä¿å«ï¼Œç”µè·æ— æ³•æ³„éœ²ï¼Œæµ®ç½®æ …å¸¦ç”µ,MOSç®¡å¯¼é€šï¼Œä¿¡æ¯å­˜å…¥</li><li>æ“¦é™¤ï¼šç´«å¤–çº¿ç…§å°„ï¼Œå½¢æˆå…‰å¯¼ç°è±¡ï¼Œæµ®ç½®æ …ä¸Šç”µè·å®Œå…¨æ³„éœ²ã€‚æ‰€æœ‰å•å…ƒå›åˆ°åˆå§‹çŠ¶æ€</li></ul></li><li>ç”µå¯æ“¦é™¤å¯ç¼–ç¨‹ROM EEPROMï¼šåœ¨æµ®ç½®æ …ä¸Šæ–¹å¢åŠ äº†æ§åˆ¶æ …æï¼Œå†™å…¥æ–¹å¼ä¸EPROMç›¸åŒã€‚<ul><li>æ“¦é™¤æ—¶ä¸éœ€è¦ç´«å¤–çº¿ç…§å°„çŸ³è‹±ç»ç’ƒï¼Œåªéœ€è¦å°†æ§åˆ¶æ …æåŠ ä¸Šé«˜ç”µå¹³å°±å¯ä»¥å°†æµ®ç½®æ …çš„ç”µè·æ³„éœ²æ‰</li><li>å¯ä»¥ç²¾å‡†åœ°åˆ é™¤æŸä¸€å­˜å‚¨å•å…ƒ</li></ul></li><li>é—ªå­˜ Flash Memoryï¼šå¿«é€Ÿæ“¦å†™ã€éæ˜“å¤±æ€§å­˜å‚¨å™¨ã€‚ä¸EEPROMç»“æ„ç›¸ä¼¼ã€‚é—ªå­˜çš„å·¥ä½œæ–¹å¼åŒ…æ‹¬è¯»å·¥ä½œæ–¹å¼ã€ç¼–ç¨‹å·¥ä½œæ–¹å¼ã€æ“¦é™¤å·¥ä½œæ–¹å¼å’ŒåŠŸè€—ä¸‹é™æ–¹å¼ï¼Œç¼–ç¨‹å’Œæ“¦é™¤æ–¹å¼é‡‡ç”¨å†™å‘½ä»¤åˆ°å‘½ä»¤å¯„å­˜å™¨çš„æ–¹æ³•æ¥è¿›è¡Œã€‚</li></ul><h3 id="ä¸»å­˜çš„ç»„ç»‡å’Œä¸CPUçš„è¿æ¥">ä¸»å­˜çš„ç»„ç»‡å’Œä¸CPUçš„è¿æ¥</h3><p>å•ç‰‡å­˜å‚¨èŠ¯ç‰‡çš„å®¹é‡æœ‰é™ï¼Œé€šå¸¸éœ€è¦å°†å¤šç¯‡å­˜å‚¨èŠ¯ç‰‡æŒ‰ç…§ä¸€å®šæ–¹å¼ç»„ç»‡å¹¶ä¸CPUè¿æ¥ã€‚</p><h4 id="å­˜å‚¨å™¨çš„æ‰©å±•">å­˜å‚¨å™¨çš„æ‰©å±•</h4><ol><li><p><strong>ä½æ‰©å±•</strong></p><p>å­—é•¿æ‰©å±•ã€æ•°æ®æ€»çº¿æ‰©å±•</p><p>å½“å­˜å‚¨èŠ¯ç‰‡çš„æ•°æ®æ€»çº¿ä½å®½ &lt; CPUæ•°æ®æ€»çº¿ä½å®½æ—¶é‡‡ç”¨</p><p>å°†æ‰€æœ‰å­˜å‚¨èŠ¯ç‰‡çš„<strong>åœ°å€çº¿ã€è¯»å†™æ§åˆ¶çº¿</strong>å¹¶è”åˆ†åˆ«ä¸<strong>CPUçš„åœ°å€çº¿å’Œè¯»å†™æ§åˆ¶çº¿</strong>è¿æ¥ï¼Œå­˜å‚¨èŠ¯ç‰‡çš„<strong>æ•°æ®çº¿å’ŒCPUæ•°æ®çº¿</strong>è¿æ¥ï¼›æ‰€æœ‰èŠ¯ç‰‡çš„<strong>ç‰‡é€‰æ§åˆ¶çº¿</strong>å¹¶è”åä¸**CPUçš„è®¿å­˜è¯·æ±‚ä¿¡å·MERQ#**è¿æ¥</p></li><li><p><strong>å­—æ‰©å±•</strong></p><p>å®¹é‡æ‰©å±•ã€åœ°å€æ€»çº¿æ‰©å±•</p><p>å­˜å‚¨èŠ¯ç‰‡çš„å­˜å‚¨å®¹é‡ä¸èƒ½æ»¡è¶³å­˜å‚¨å™¨å¯¹å­˜å‚¨å®¹é‡çš„è¦æ±‚æ—¶é‡‡ç”¨ã€‚</p><p>å°†æ‰€æœ‰<strong>å­˜å‚¨èŠ¯ç‰‡çš„æ•°æ®çº¿ã€è¯»å†™æ§åˆ¶çº¿</strong>å„è‡ªå¹¶è”ï¼Œåˆ†åˆ«ä¸<strong>CPUçš„æ•°æ®çº¿å’Œè¯»å†™æ§åˆ¶çº¿</strong>è¿æ¥</p></li><li><p><strong>å­—ä½åŒæ—¶æ‰©å±•</strong></p><p>å­˜å‚¨èŠ¯ç‰‡çš„æ•°æ®ä½å®½å’Œå­˜å‚¨å®¹é‡å‡ä¸èƒ½æ»¡è¶³å­˜å‚¨å™¨çš„æ•°æ®ä½å’Œå­˜å‚¨æ€»å®¹é‡æ—¶é‡‡ç”¨</p><p>å…ˆä½æ‰©å±• â€“ åå­—æ‰©å±•</p></li></ol><h3 id="å¹¶è¡Œä¸»å­˜ç³»ç»Ÿ">å¹¶è¡Œä¸»å­˜ç³»ç»Ÿ</h3><p>å¦‚ä½•é€šè¿‡å‘è§‰å­˜å‚¨ç³»ç»Ÿçš„å¹¶è¡Œæ€§æ¥æé«˜å­˜å–é€Ÿåº¦</p><ol><li><p>åŒç«¯å£å­˜å‚¨å™¨</p><p>ä¸€ä¸ªå­˜å‚¨å™¨æœ‰ä¸¤ç»„ç›¸äº’ç‹¬ç«‹çš„ç«¯å£ï¼Œæ¯ä¸ªç«¯å£å¯ä»¥ç‹¬ç«‹åœ°è¿›è¡Œè¯»å†™æ“ä½œ</p><p>ç‰¹ç‚¹ï¼š</p><ol><li><p>å¹¶è¡Œè¯»å†™</p><p>ä¸åŒç«¯å£ä½¿ç”¨å„è‡ªçš„åœ°å€çº¿ã€æ•°æ®çº¿å’Œæ§åˆ¶çº¿å¯¹å­˜å‚¨å™¨ä¸­çš„ä¸åŒå­˜å‚¨å•å…ƒè¿›è¡ŒåŒæ—¶è¯»å†™</p></li><li><p>å†²çªå¤„ç†</p><p>ä¸¤ä¸ªç«¯å£åœ°å€ç›¸åŒæ—¶ä¼šå‘ç”Ÿè¯»å†™å†²çª ï¼Œè§£å†³ ----&gt; æ¯ä¸ªç«¯å£è®¾ç½®æ ‡å¿— $$\overline {BUSY}$$,ç”±åˆ¤æ–­é€»è¾‘å†³å®šå“ªä¸ªç«¯å£æœ‰é™è¿›è¡Œè¯»å†™æ“ä½œï¼Œå¦ä¸€ä¸ªç«¯å£çš„æ ‡å¿—è®¾ç½®ä¸º0ï¼ˆä½ç”µå¹³ï¼‰ä»¥å»¶è¿Ÿå¯¹å­˜å‚¨å™¨çš„è®¿é—®ã€‚ä¼˜å…ˆç«¯å£çš„æ“ä½œå®Œæˆåï¼Œè¢«å»¶è¿Ÿç«¯å£çš„æ ‡å¿—ä¼šå¤ä½</p><p>æ•ˆç‡ä¸èƒ½å®é™…æé«˜ä¸¤å€ ----&gt; å†²çªè®¿é—®ä¸èƒ½é¿å…</p></li></ol></li><li><p>å•ä½“å¤šå­—å­˜å‚¨å™¨</p><p>ç±»ä¼¼ä½æ‰©å±•æ–¹å¼ã€‚å¤šä¸ªå­˜å‚¨æ¨¡å—å…±äº«åœ°å€æ€»çº¿ï¼ŒæŒ‰åŒä¸€åœ°å€å¹¶è¡Œè®¿é—®ä¸åŒå­˜å‚¨æ¨¡å—çš„åŒæ„å•å…ƒï¼Œä¸€ä¸ªå­˜å‚¨å‘¨æœŸå†…è®¿é—®å¤šä¸ªå­˜å‚¨å­—ã€‚</p><p>å¸¸ç”¨ï¼š <strong>å¤šé€šé“å†…å­˜æŠ€æœ¯</strong> ï¼ˆè”åŠ¨æ¨¡å¼ï¼‰ï¼š<br>ä¸¤æ¡å®Œå…¨ç›¸åŒçš„64ä½å†…å­˜å…±äº«åœ°å€æ€»çº¿å’Œç‰‡é€‰ä¿¡å·çº¿ï¼Œ åŒä¸€æ—¶åˆ»ä¸¤æ ¹å†…å­˜å¹¶å‘å·¥ä½œï¼Œå„è‡ª<strong>è®¿é—®åŒä¸€åœ°å€å•å…ƒ</strong>ä¸­çš„64ä½æ•°æ®ï¼ˆæ€»å…±128ä½ï¼‰å¹¶é€å…¥å†…å­˜æ§åˆ¶å™¨ã€‚ï¼ˆè¦æ±‚ä¸¤æ ¹å†…å­˜çš„å®¹é‡ã€æ—¶åºã€é¢‘ç‡å¿…é¡»å®Œå…¨ä¸€è‡´ï¼ˆä¹¦ä¸­æœ‰å›¾ï¼Œéå¸¸å¸®åŠ©ç†è§£ï¼‰ï¼‰</p><p><strong>éè”åŠ¨æ¨¡å¼</strong>ï¼šå†…å­˜æ§åˆ¶å™¨é€šè¿‡ç‹¬ç«‹çš„ç‰‡é€‰ä¿¡å·ã€åœ°å€æ€»çº¿ã€è¯»å†™æ§åˆ¶çº¿è¿æ¥ä¸¤æ ¹å†…å­˜ï¼Œæ•°æ®æ€»çº¿é¡µæ˜¯ç‹¬ç«‹çš„ä¸¤æ¡64ä½æ€»æƒ³çˆ±ä½ ã€‚å†…å­˜å¯ä»¥å¹¶å‘å·¥ä½œï¼Œä½†<strong>äºŒè€…åœ°å€ã€è¯»å†™å‘½ä»¤ä¸å¿…åŒæ­¥</strong>ã€‚åªéœ€è¦é¢‘ç‡ç›¸åŒ</p></li><li><p>å¤šä½“äº¤å‰å­˜å‚¨å™¨</p><p>å¤šä¸ªå®¹é‡å’Œå­˜å–é€Ÿåº¦ç›¸åŒçš„å­˜å‚¨æ¨¡å—æ„æˆ</p><ol><li><p>é«˜ä½å¤šä½“äº¤å‰ï¼ˆé¡ºåºç¼–å€æ¨¡å¼ï¼‰</p><p>ç›®çš„ï¼šæ‰©å……å­˜å‚¨å™¨å®¹é‡ï¼Œä¸å­˜å‚¨å™¨å­—æ‰©å±•å®Œå…¨ç›¸åŒã€‚ç”¨é«˜ä½åœ°å€è¯‘ç äº§ç”Ÿç‰‡é€‰ä¿¡å·ï¼Œé€‰æ‹©ä¸åŒçš„å­˜å‚¨æ¨¡å—ï¼›ä½ä½åœ°å€ç›´æ¥é€‰æ‹©å­˜å‚¨æ¨¡å—å†…çš„ä¸åŒå­˜å‚¨å•å…ƒ</p><p>ç‰¹ç‚¹ï¼š</p><ul><li>ç›¸é‚»åœ°å€åœ¨åŒä¸€å­˜å‚¨ä½“å†…</li><li>ä¸åŒå­˜å‚¨ä½“ä¸­çš„åœ°å€ä¸ç›¸é‚»</li><li>åŒä¸€å­˜å‚¨ä½“çš„åœ°å€å•å…ƒæ˜¯è¿ç»­çš„ï¼Œç¨‹åºæ‰§è¡Œè¿‡ç¨‹åŸºæœ¬æ˜¯å¯¹åŒæ„å­˜å‚¨æè®¿é—®é¢‘ç¹ï¼Œè€Œå…¶ä»–å­˜å‚¨æåŸºæœ¬ç©ºé—²ï¼Œæ— æ³•å®ç°å¤šä¸ªå­˜å‚¨ä½“çš„å¹¶è¡Œå·¥ä½œ</li></ul><p>egï¼šè®¡ç®—æœºå†…å­˜æ’æ§½å¯æ‰©å±•æ€§</p></li><li><p>ä½ä½äº¤å‰æ–¹å¼ï¼ˆäº¤å‰ç¼–å€æ¨¡å¼ï¼‰</p><p>ä½ä½åœ°å€è¯‘ç è¿›è¡Œç‰‡é€‰ï¼Œé«˜ä½åœ°å€é€‰æ‹©å­˜å‚¨æ¨¡å—å†…çš„ä¸åŒå­˜å‚¨å•å…ƒ</p><p>ç‰¹ç‚¹ï¼š</p><ul><li>ç›¸é‚»çš„åœ°å€å¤„åœ¨ä¸åŒçš„å­˜å‚¨ä½“å†…</li><li>åŒä¸€å­˜å‚¨ä½“ä¸­çš„å­—ä½“ä¸ç›¸é‚»</li><li>é€‚åˆçªå‘çš„é¡ºåºè®¿é—®æ¨¡å¼</li><li>é¡ºåºè®¿é—®æ—¶ï¼Œå„å­˜å‚¨æ¨¡å—æŒ‰ç…§æµæ°´çº¿çš„æ–¹å¼è½®æµå­˜å–</li></ul><p>ä¸ºæé«˜é¡ºåºè®¿é—®æ—¶ä¸ªå­˜å‚¨æ¨¡å—çš„å¹¶è¡Œæ€§ï¼Œä¸ªå­˜å‚¨æ¨¡å—å‡å…·æœ‰å„è‡ªç‹¬ç«‹çš„åœ°å€å¯„å­˜å™¨ã€æ•°æ®å¯„å­˜å™¨å’Œè¯»å†™æ§åˆ¶ç”µè·¯ã€‚</p></li></ol></li></ol><p>è®¡ç®—ä¸åŒæ¡ä»¶ä¸‹è¯»å–å­—æ‰€éœ€è¦çš„æ—¶é—´å’Œå¸¦å®½ â€” ä¹¦ä¸­P.121</p><div class="note note-success">            <p>å­˜å‚¨æ—¶é—´å’Œå­˜å‚¨å‘¨æœŸçš„åŒºåˆ«</p><p>å­˜å‚¨æ—¶é—´ï¼šCPUè¯»å†™å†…å­˜å†…æ•°æ®çš„è¿‡ç¨‹æ—¶é—´ï¼ˆå‘å‡ºå‘½ä»¤åˆ°æ¥å—æ•°æ®ï¼‰<br>å­˜å‚¨å‘¨æœŸï¼šè¿ç»­å¯åŠ¨ä¸¤æ¬¡è¯»æˆ–å†™æ“ä½œé”éœ€é—´éš”çš„æœ€å°æ—¶é—´ï¼ˆä¸¤æ¬¡å­˜å‚¨æ—¶é—´+æ¢å¤æ—¶é—´ï¼‰</p>          </div><h3 id="é«˜é€Ÿç¼“å†²å­˜å‚¨å™¨">é«˜é€Ÿç¼“å†²å­˜å‚¨å™¨</h3><h4 id="cache">cache</h4><p>SRAMé€Ÿåº¦å¿«ä½†å®¹é‡æœ‰é™ï¼Œæˆæœ¬é«˜åŠŸè€—å¤§ã€‚ ä¸ºè¿›ä¸€æ­¥æå‡CPUè®¿é—®ä¸»å­˜çš„æ€§èƒ½ â€” åœ¨CPUå’Œä¸»å­˜é—´å¢åŠ éšè—çš„å°å®¹é‡å¿«é€Ÿçš„SRAM<br>å°†ä¸»å­˜ä¸­ç»å¸¸è®¿é—®æˆ–è€…å³å°†è®¿é—®çš„æ•°æ®å‰¯æœ¬è°ƒåº¦åˆ°å°å®¹é‡çš„SRAMä¸­ï¼Œä½¿å¾—å¤§éƒ¨åˆ†æ•°æ®è®¿é—®éƒ½èƒ½åœ¨cacheä¸­è¿›è¡Œï¼ˆä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºCPUæ‰§è¡Œçš„ç¨‹åºå…·æœ‰è¾ƒå¼ºçš„ç¨‹åºå±€éƒ¨æ€§ï¼‰</p><p><strong>ç¨‹åºå±€éƒ¨æ€§</strong></p><p>ç¨‹åºåœ¨æ‰§è¡Œæ—¶å‘ˆç°å±€éƒ¨è§„å¾‹æ€§ï¼ˆä¸€æ®µæ—¶é—´å†…ï¼Œç¨‹åºçš„æ‰§è¡Œä»…é™äºç¨‹åºä¸­çš„ä¸€éƒ¨åˆ†ï¼Œæ‰§è¡Œæ‰€éœ€çš„æ‰§è¡Œå’Œæ•°æ®é¡µå±€é™äºæŸä¸ªå­˜å‚¨åŒºåŸŸå†…ï¼‰</p><ul><li>ç©ºé—´å±€éƒ¨æ€§ï¼šä¸€æ—¦ç¨‹åºè®¿é—®äº†æŸä¸ªå­˜å‚¨å•å…ƒï¼Œå…¶é™„è¿‘çš„å­˜å‚¨å•å…ƒé¡µå³å°†è¢«è®¿é—®ï¼ˆä»£ç ã€æ•°ç»„ã€ç»“æ„ä½“ã€å…¨å±€å˜é‡ï¼‰</li><li>æ—¶é—´å±€éƒ¨æ€§ï¼šç¨‹åºè®¿é—®ä¸€ä¸ªå­˜å‚¨ä½ç½®ï¼Œè¯¥ä½ç½®åœ¨æœªæ¥å¯èƒ½è¢«å¤šæ¬¡è®¿é—®ï¼ˆå¾ªç¯ç»“æ„ï¼‰</li></ul><h5 id="æ¦‚å¿µ-v8">æ¦‚å¿µ</h5><p>ä¸ä¸»å­˜ä¸€æ ·ï¼Œè¢«åˆ†ä¸ºå¤šä¸ªæ•°æ®å—ï¼Œæ•°æ®å—åˆåŒ…å«å¤šä¸ªå­—ã€‚åˆ’åˆ†ä¸ºå—åœ°å€å’Œå—å†…åç§»åœ°å€ï¼ˆä¸»å­˜å—åœ°å€å­—æ®µ&gt;cacheå—åœ°å€å­—æ®µï¼Œå—å†…åç§»æ˜¯ç›¸åŒçš„ï¼‰</p><p>CPUé€šè¿‡å­—èŠ‚åœ°å€è®¿é—®cacheå…ˆåˆ¤æ–­æ•°æ®æ˜¯å¦åœ¨cacheä¸­ï¼Œå¦‚æœåœ¨ï¼Œåˆ™<strong>æ•°æ®å‘½ä¸­</strong>ï¼›<br>æ•°æ®ä¸åœ¨ï¼Œ<strong>æ•°æ®ç¼ºå¤±</strong>ï¼Œç¼ºå¤±æ—¶çš„è®¿é—®æ—¶é—´å«<strong>ç¼ºå¤±è¡¥å¿</strong>ï¼ˆåŒ…æ‹¬æ•°æ®æŸ¥æ‰¾tã€ä¸»å­˜è®¿é—®tã€cacheè®¿é—®tï¼‰ï¼Œç›¸é‚»æ•°æ®ä¹Ÿä¼šéšç€æ•°æ®å—ä¸€èµ·åŠ è½½åˆ°cacheä¸­</p><h5 id="è¯»å†™æµç¨‹">è¯»å†™æµç¨‹</h5><p><strong>è¯»</strong></p><p>CPUéœ€è¦è®¿é—®ä¸»å­˜æ—¶ï¼Œå…ˆä»¥ä¸»å­˜åœ°å€RAä¸­çš„ä¸»å­˜å—åœ°å€ä¸ºå…³é”®å­—åœ¨æŸ¥æ‰¾è¡¨ä¸­æŸ¥æ‰¾ï¼Œèƒ½æŸ¥åˆ°åˆ™å‘½ä¸­</p><p><strong>å†™</strong></p><p>ä»¥ä¸»å­˜å­—èŠ‚åœ°å€WAä¸­çš„ä¸»å­˜å—åœ°å€ä¸ºå…³é”®å­—åœ¨æŸ¥æ‰¾è¡¨ä¸­è¿›è¡Œæ•°æ®æŸ¥æ‰¾ï¼Œå…ˆå†™åˆ°cacheå†å†™åˆ°ä¸»å­˜<br><strong>è„æ•°æ®</strong>ï¼šcacheä¸­æ•°æ®å’Œä¸»å­˜ä¸­åŸå§‹æ•°æ®ä¸ä¸€è‡´ç°è±¡</p><ul><li>å†™å›ç­–ç•¥ï¼šä¸å†å†™å…¥åˆ°ä¸»å­˜ï¼Œå“åº”é€Ÿåº¦æœ€å¿«ï¼Œä½†äº§ç”Ÿä¸ä¸€è‡´æ€§ã€‚æ¯ä¸ªcacheè¡Œè¦é…ç½®ä¸€ä¸ªä¿®æ”¹ä½ï¼ˆ<strong>è„ä½</strong>ï¼‰ã€‚å½“æŸè¡Œè¦è¢«æ›¿æ¢æ—¶ï¼Œæ£€æµ‹æ˜¯å¦è„ä½ä¸º1ï¼Œæ˜¯åˆ™ä¼šå†™å…¥åˆ°å†…å­˜ä¸­å†æ›¿æ¢</li><li>å†™ç©¿ç­–ç•¥ï¼šå†™å›åˆ°ä¸»å­˜ä¸­ï¼Œæ…¢é€Ÿ</li></ul><p>æ•°æ®ç¼ºå¤±æ—¶ï¼š</p><ul><li>å†™åˆ†é…æ³•ï¼šå°†WAå¯¹åº”çš„æ•°æ®å—è½½å…¥åˆ°cacheä¸­ï¼Œåœ¨è¿›è¡Œå’Œå†™å‘½ä¸­ä¸€è‡´çš„ç­–ç•¥ã€‚</li><li>å¦å¤–çš„ï¼šæ•°æ®ç›´æ¥å†™å…¥æ…¢é€Ÿçš„ä¸»å­˜ä¸­</li></ul><p><strong>å…³é”®æŠ€æœ¯</strong></p><ol><li>æ•°æ®æŸ¥æ‰¾</li><li>åœ°å€æ˜ å°„</li><li>æ›¿æ¢ç­–ç•¥</li><li>å†™å…¥ç­–ç•¥</li></ol><p><strong>ç›¸è”å­˜å‚¨å™¨CAM</strong></p><p>æŒ‰å†…å®¹è¿›è¡Œè®¿é—®çš„å­˜å‚¨å™¨ï¼Œç”¨äºå­˜æ”¾æŸ¥æ‰¾è¡¨ KVå½¢å¼ã€‚ç”¨äºcacheçš„å¿«é€ŸæŸ¥æ‰¾</p><p>æ‰€æœ‰å­˜å‚¨å•å…ƒçš„keyå­—æ®µåŒæ—¶ä¸CAMçš„è¾“å…¥æ£€ç´¢å…³é”®å­—è¿›è¡Œå¹¶å‘æ¯”è¾ƒã€‚æ¯ä¸ªå­˜å‚¨å•å…ƒéƒ½å¯¹åº”ä¸€ä¸ªç‹¬ç«‹çš„æ¯”è¾ƒå™¨ï¼Œç¡¬ä»¶æˆæœ¬é«˜ï¼Œå®¹é‡ä¸€èˆ¬è¾ƒå°</p><h5 id="åœ°å€æ˜ å°„">åœ°å€æ˜ å°„</h5><p>ä¸»å­˜åœ°å€ç©ºé—´æ˜ å°„åˆ°cacheçš„åœ°å€ç©ºé—´,ä¸‰ç§æ–¹å¼ï¼š</p><ol><li><p>å…¨ç›¸è”ï¼šå„ä¸»å­˜å—å¯æ˜ å°„åˆ°cacheçš„ä»»æ„æ•°æ®å—</p><p>(ä¸»å­˜)ä¸€å¯¹å¤š(cache)ï¼Œæ–°çš„ä¸»å­˜å—å¯ä»¥åœ¨å•Šå…¥é“cacheä¸­çš„ä»»æ„ç©ºä½ç½®ã€‚<br>åˆ©ç”¨ç‡æœ€é«˜ã€æŸ¥æ‰¾æˆæœ¬é«˜ï¼Œéœ€è¦CAMæä¾›å¿«é€ŸæŸ¥æ‰¾åŠŸèƒ½</p><p>éœ€è¦è®°å½•ç›¸å…³æ ‡è®°ï¼šä¸»å­˜å—åœ°å€æ ‡è®°ã€æœ‰æ•ˆä½ã€è„æ•°æ®æ ‡å¿—ä½â€¦   â€”cacheæ§½ä¸­ï¼ˆcacheæœ‰å¤šå°‘ä¸ªæ•°æ®å—å°±å¯¹åº”å¤šå°‘ä¸ªcacheæ§½ï¼‰</p><p>æ•°æ®æŸ¥æ‰¾æ—¶ç›´æ¥å°†ä¸»å­˜å—åœ°å€å’Œæ‰€æœ‰cacheè¡Œä¸­çš„æ ‡è®°å­—æ®µä¸»å­˜å—åœ°å€è¿›è¡Œå¹¶å‘æ¯”è¾ƒ</p><p>cacheå‰¯æœ¬ç¼“å†²åŒºå®¹é‡ = n x 2^wå­—èŠ‚  å®é™…å®¹é‡ä¸º n * (1+s+8*2^w)ä½(s :tag, w: offset)</p><p>å®ç°ï¼š</p><p>ä¸»å­˜åœ°å€è¢«åˆ’åˆ†ä½(tag,offset)ï¼Œtagä»£è¡¨ä¸»å­˜å—åœ°å€ã€‚æ¯”è¾ƒæ—¶tagä¸æ‰€æœ‰èˆªçš„æ ‡è®°å­—æ®µtagè¿›è¡Œå¤šè·¯å¹¶å‘æ¯”è¾ƒ</p><p><strong>ç‰¹ç‚¹ï¼š</strong></p><ol><li>cacheåˆ©ç”¨ç‡é«˜</li><li>cacheå†²çªç‡ä½</li><li>æŸ¥æ‰¾æ—¶è¦å¹¶å‘æ¯”è¾ƒæŸ¥æ‰¾è¡¨çš„æ‰€æœ‰é¡¹ï¼Œç¡¬ä»¶æˆæœ¬é«˜ï¼Œé€‚åˆå°å®¹é‡cache</li><li>cacheæ»¡è½½æ—¶æ›¿æ¢ç®—æ³•å¤æ‚</li></ol></li><li><p>ç›´æ¥ç›¸è”ï¼šä¸»å­˜å—åªèƒ½æ˜ å°„åˆ°cacheä¸­çš„å›ºå®šå—</p><p>æ¯ä¸ªä¸»å­˜åœ°å€åªèƒ½æ˜ å°„åˆ°cacheä¸­çš„å›ºå®šè¡Œ</p><p>cacheè¡Œå·i = ä¸»å­˜å—å· j mod (cacheè¡Œæ•°n)</p><p>ä¸»å­˜åœ°å€å¯ç»†åˆ†ä¸ºï¼šåŒºåœ°å€tagã€åŒºå†…è¡Œç´¢å¼•indexã€å—å†…åç§»offset</p><p>cacheå®é™…å®¹é‡n * ï¼ˆ1 + s -r + 8 * 2^wï¼‰ä½ï¼ˆè¡Œæ•°ä½rï¼ŒåŒºåœ°å€æœ‰s-rä½ï¼‰</p><p>é€šè¿‡indexå­—æ®µå¯å¿«é€Ÿè®¿é—®å¯¹åº”cacheè¡Œçš„æ ‡è®°ä¸æ ‡å¿—å­—æ®µï¼Œå¦‚æœ<strong>æ ‡è®°å­—æ®µæœ‰æ•ˆ</strong>ä¸”<strong>ä¸ä¸»å­˜åœ°å€ä¸­çš„åŒºåœ°å€ç›¸åŒ</strong>ï¼Œå°±å‘½ä¸­ã€‚æŸ¥æ‰¾è¡¨ä¸éœ€è¦å­˜æ”¾åœ¨ç›¸è”å­˜å‚¨å™¨ä¸­</p><p>å®ç°ï¼š</p><p>ä¸»å­˜åœ°å€è¢«åˆ’åˆ†ä¸º (tag index offset)</p><p><strong>ç‰¹ç‚¹ï¼š</strong></p><ol><li>cacheåˆ©ç”¨ç‡ä½ï¼Œå¯èƒ½æœ‰å†²çª</li><li>cacheæœªæ»¡ä¹Ÿå¯èƒ½å‘ç”Ÿæ•°æ®å†²çª</li><li>æŸ¥æ‰¾æ—¶åªéœ€è¦æ ¹æ®indexè®¿é—®å¯¹åº”cacheè¡Œçš„tagæ¯”è¾ƒï¼Œä¸€ä¸ªæ¯”è¾ƒå™¨å³å¯ï¼Œç¡¬ä»¶æˆæœ¬ä½ï¼ˆå› ä¸ºä¸éœ€è¦å¹¶å‘æ¯”è¾ƒäº†ï¼‰ï¼Œé€‚åˆå¤§å®¹é‡cacheä½¿ç”¨</li><li>ä¸éœ€è¦ä½¿ç”¨å¤æ‚çš„æ›¿æ¢ç®—æ³•</li></ol><p>ç›¸åº”ä¾‹é¢˜ ï¼š P.130(è¿˜æŒºå¤šçš„ï¼Œå»ºè®®å¥½å¥½çœ‹ä¸€ä¸‹)</p></li><li><p>ç»„ç›¸è”ï¼šä¸»å­˜å¿«åªèƒ½æ˜ å°„åˆ°cacheå›ºå®šç»„ä¸­çš„ä»»æ„å—</p><p>å‰ä¸¤ç§æ–¹å¼çš„æŠ˜ä¸­ï¼Œæ—¢èƒ½æé«˜å‘½ä¸­ç‡ï¼Œåˆèƒ½é™ä½ç¡¬ä»¶çš„å¼€é”€ï¼ˆå…¨ç›¸è”åœ¨ç»„å†…è¿›è¡Œæ¯”è¾ƒï¼Œéœ€è¦Kä¸ªæ¯”è¾ƒå™¨ï¼‰</p><p>å°†cacheåˆ†æˆå›ºå®šå¤§å°çš„ç»„ï¼Œæ¯ç»„kè¡Œï¼ˆk-è·¯ç»„ç›¸è”ï¼‰ã€‚ä¸»å­˜æ•°æ®å—é¦–å…ˆå…ˆé‡‡ç”¨ç›´æ¥ç›¸è”æ˜ å°„çš„æ–¹å¼å®šä½åˆ°å›ºå®šçš„ç»„ï¼Œç„¶åç”¨å…¨ç›¸è”æ˜ å°„æ–¹å¼æ˜ å°„åˆ°ç»„å†…çš„ä»»ä½•ä¸€ä¸ªcacheè¡Œã€‚</p><p>cacheç»„å· = ä¸»å­˜å—å· mod(cacheç»„æ•°)</p><p>å®ç°ï¼š</p><p>ä¸»å­˜åœ°å€è¢«åˆ’åˆ†ä½(tag ç»„ç´¢å¼•index offset)</p><p>cacheå®¹é‡ = 2 n * (1+s-d+8* 2^w)ä½</p><p>æ•°æ®æ·˜æ±°åœ¨æŒ‡å®šçš„ç»„å†…é€‰æ‹©cacheè¡Œè¿›è¡Œæ·˜æ±°</p></li></ol><h5 id="åº”ç”¨-v2">åº”ç”¨</h5><p><strong>åˆ†ç¦»cache</strong></p><p>æŒ‡ä»¤å’Œæ•°æ®ä¸åœ¨åŒä¸€ä¸ªcacheä¸­ç»Ÿä¸€cacheï¼šæŒ‡ä»¤å’Œæ•°æ®éƒ½åœ¨cacheä¸­ï¼Œï¼Œä½†æ‰§è¡Œéƒ¨ä»¶å­˜å–æ•°æ®æ—¶ï¼ŒæŒ‡ä»¤é¢„å–éƒ¨ä»¶åˆè¦ä»ç»Ÿä¸€cacheè¯»æŒ‡ä»¤ï¼Œä¸¤è€…ä¼šå‘ç”Ÿå†²çª</p><p><strong>å¤šçº§cache</strong></p><p>ä¸€çº§cache L1: cacheå’Œå¤„ç†å™¨é›†æˆåœ¨åŒä¸€èŠ¯ç‰‡å†…ï¼Œå‡å°‘å¯¹ç‰‡å¤–æ€»çº¿çš„è®¿é—®ã€‚å®¹é‡è¾ƒå°<br>äºŒçº§cache L2: ä¸»å­˜å’ŒCPUä¹‹é—´ï¼ˆL1cacheå®¹é‡å° 8 K, L2-- 256KB~1MBï¼‰</p><h4 id="æ›¿æ¢ç®—æ³•">æ›¿æ¢ç®—æ³•</h4><ol><li><p>FIFOï¼š</p><p>éœ€è¦è®°å½•æ¯ä¸ªcacheè¡Œè½½å…¥cacheçš„æ—¶é—´æˆ³ï¼Œå¼€é”€å°</p></li><li><p>LFUï¼šLast Frequently Used</p><p>æ¯è¡Œå¿…é¡»è®¾ç½®æ·˜æ±°è®¡æ•°å™¨ï¼Œå¯èƒ½å› ä¸ºæ—¶åºé—®é¢˜è€Œæ·˜æ±°ä½¿ç”¨å¢é•¿ç‡è¾ƒé«˜çš„cacheè¡Œ</p></li><li><p>LRUï¼šLast Recently Used</p><p>æ¯è¡Œè®¾ç½®è®¡æ•°å™¨ï¼Œæ¯å‘½ä¸­ä¸€è¡Œï¼Œå¯¹åº”çš„è®¡æ•°å™¨æ¸…é›¶ï¼Œå…¶ä»–è¡Œçš„è®¡æ•°å™¨+1.ä½¿å¾—cacheæœ‰è¾ƒé«˜çš„å‘½ä¸­ç‡</p><p>éš¾ç‚¹ï¼šå¿«é€Ÿæ¯”è¾ƒå¤šè¡Œè®¡æ•° â€” äºŒè·¯çº§è”cache,ä¸€ä¸ªä¸»å­˜å¿«åªèƒ½åœ¨ç‰¹å®šç»„çš„ä¸¤è¡Œä¸­å­˜æ”¾ï¼ˆäºŒé€‰ä¸€ï¼‰</p></li><li><p>éšæœºæ›¿æ¢</p></li></ol><h3 id="è™šæ‹Ÿå­˜å‚¨å™¨">è™šæ‹Ÿå­˜å‚¨å™¨</h3><h4 id="åŸç†-v5">åŸç†</h4><p>é‡‡ç”¨cacheæé«˜äº†CPUå¯¹ä¸»å­˜çš„è®¿é—®é€Ÿåº¦é—®é¢˜ï¼Œä½†ä¸èƒ½è§£å†³ä¸»å­˜å®¹é‡ä¸è¶³çš„é—®é¢˜<br>è™šæ‹Ÿå­˜å‚¨å™¨å¤„äºâ€œä¸»å­˜-ç¼“å­˜â€å±‚æ¬¡ï¼Œé€šè¿‡å¢åŠ éƒ¨åˆ†è½¯ä»¶å’Œç¡¬ä»¶ï¼Œä½¿å¾—èµ‹å­˜å’Œä¸»å­˜æ„æˆä¸€ä¸ªæ•´ä½“ï¼Œå°±åƒä¸€ä¸ªå•ä¸€çš„ä¸»å­˜å¯ä¾›CPUç›´æ¥è®¿é—®ã€‚ç¨‹åºå‘˜å¯ç”¨è™šæ‹Ÿå­˜å‚¨å™¨æä¾›çš„è™šæ‹Ÿåœ°å€è¿›è¡Œå˜æˆï¼Œä¸å†å—ä¸»å­˜å¤§å°çš„é™åˆ¶ã€‚</p><p>åˆ©ç”¨ç¨‹åºçš„å±€éƒ¨æ€§ï¼Œé‡‡ç”¨æŒ‰éœ€åŠ è½½çš„æ–¹å¼åŠ è½½ä»£ç å’Œæ•°æ®ã€‚åŠ è½½ç¨‹åºæ—¶ä¸ç›´æ¥åŠ è½½å…¥ä¸»å­˜ä¸­ï¼Œè€Œä»…åœ¨ç›¸åº”çš„è™šæ‹Ÿåœ°å€è½¬æ¢è¡¨ä¸­ç™»è®°è™šæ‹Ÿåœ°å€å¯¹åº”çš„ç£ç›˜åœ°å€ã€‚ç¨‹åºæ‰§è¡Œç—…è®¿é—®è™šæ‹Ÿåœ°å€å¯¹åº”çš„ç¨‹åºå’Œæ•°æ®æ—¶ï¼Œäº§ç”Ÿç¼ºé¡µå¼‚å¸¸ï¼Œå°†çœŸæ­£çš„ç¨‹åºå’Œä»£ç è½½å…¥</p><p><strong>åœ°å€æ˜ å°„</strong></p><p>è™šæ‹Ÿå­˜å‚¨å™¨ä¸­ä¸‰ç§ç©ºé—´åœ°å€</p><ol><li>è™šæ‹Ÿåœ°å€ç©ºé—´ï¼šç¼–å†™ç¨‹åºçš„åœ°å€ç©ºé—´</li><li>ä¸»å­˜åœ°å€ç©ºé—´ï¼šç‰©ç†åœ°å€ç©ºé—´ï¼ˆå®åœ°å€ç©ºé—´ï¼‰</li><li>è¾…å­˜åœ°å€ç©ºé—´ï¼šç£ç›˜å­˜å‚¨å™¨åœ°å€ç©ºé—´</li></ol><p>åœ°å€æ˜ å°„ï¼šå°†è™šæ‹Ÿåœ°å€ç©ºé—´æ˜ å°„åˆ°ä¸»å­˜ç©ºé—´ï¼Œå°†è®¿é—®çš„å†…å®¹æŒ‰ç…§æŸç§è§„åˆ™ä»è¾…å­˜è£…å…¥ä¸»å­˜å¹¶åœ¨è™šã€å®åœ°å€é—´å»ºç«‹è”ç³»<br>åœ°å€è½¬æ¢ï¼šç¨‹åºè¢«è£…å…¥ä¸»å­˜å®é™…è¿è¡Œæ—¶ï¼ŒæŠŠè™šåœ°å€è½¬æ¢æˆå®åœ°å€æˆ–è€…ç£ç›˜åœ°å€ï¼Œè®©CPUä»ä¸»å­˜æˆ–ç£ç›˜ä¸­è¯»å–ä¿¡æ¯</p><p>åœ¨è™šå­˜ç³»ç»Ÿä¸­è¿è¡Œç¨‹åºæ—¶ï¼ŒCPUä»¥è™šæ‹Ÿåœ°å€è®¿é—®ä¸»å­˜ï¼Œä½¿ç”¨MMUï¼ˆå­˜å‚¨ç®¡ç†æ§åˆ¶éƒ¨ä»¶ï¼‰æ‰¾å‡ºè™šåœ°å€å’Œå®åœ°å€ä¹‹é—´çš„å…³ç³»ï¼Œå¹¶åˆ¤æ–­è¿™ä¸ªè™šåœ°å€å¯¹åº”çš„å†…å®¹æ˜¯å¦åœ¨ä¸»å­˜ä¸­ï¼Œå¦‚æœåœ¨åˆ™é€šè¿‡MMUå°†è™šæ‹Ÿåœ°å€è½¬åŒ–ä¸ºç‰©ç†åœ°å€ï¼›å¦‚æœä¸åœ¨ï¼Œåˆ™æŠŠåŒ…å«è¿™ä¸ªå­—çš„ä¸€é¡µæˆ–ä¸€ä¸ªç¨‹åºæ®µè°ƒå…¥ä¸»å­˜</p><p>æ ¹æ®è™šæ‹Ÿå­˜å‚¨å™¨å¯¹ä¸»å­˜é€»è¾‘ç»“æ„åˆ’åˆ†çš„ç²’åº¦ï¼Œè™šå­˜å¯åˆ†ä¸ºé¡µå¼ã€æ®µå¼ã€æ®µé¡µå¼è™šå­˜</p><h4 id="é¡µå¼è™šæ‹Ÿå­˜å‚¨å™¨">é¡µå¼è™šæ‹Ÿå­˜å‚¨å™¨</h4><p>ä»¥é¡µä½é€»è¾‘ç»“æ„åˆ’åˆ†ä½ ä¿¡æ¯ä¼ é€å•ä½çš„è™šæ‹Ÿå­˜å‚¨å™¨ã€‚<br>è™šæ‹Ÿç©ºé—´å’Œä¸»å­˜ç©ºé—´ è¢«åˆ’åˆ†æˆå›ºå®šå¤§å°çš„é¡µï¼ˆå¸¸è§4KBï¼‰</p><p><strong>è™šæ‹Ÿåœ°å€åˆ’åˆ†</strong></p><p>è™šæ‹Ÿåœ°å€ = è™šæ‹Ÿé¡µå· VPN + è™šæ‹Ÿé¡µåç§» VPO<br>ç‰©ç†åœ°å€ = ç‰©ç†é¡µå· PPN + ç‰©ç†é¡µåç§» PPO<br>(VPN &gt; PPN å–å†³äºè™šæ‹Ÿç©ºé—´å’Œä¸»å­˜ç©ºé—´çš„å®¹é‡ï¼Œ VPO = PPO å†³å®šé¡µé¢å¤§å°)</p><p><strong>é¡µè¡¨</strong></p><p>è™šå®åœ°å€çš„è½¬æ¢é€šè¿‡<strong>é¡µè¡¨</strong>è¿›è¡Œï¼šä¸€å¼ ä¿å­˜è™šæ‹Ÿé¡µå·VPNå’Œç‰©ç†é¡µå·PPNå¯¹åº”çš„å…³ç³»çš„æŸ¥æ‰¾è¡¨ï¼Œç”±è‹¥å¹²ä¸ªè¡¨é¡¹ç»„æˆçš„æ•°ç»„ã€‚<br>ä»¥VPNä½œä¸ºç´¢å¼•ï¼Œæ¯ä¸ªè¡¨é¡¹åŒ…æ‹¬æœ‰æ•ˆä½å’Œç‰©ç†é¡µå·ï¼Œè¿˜åŒ…æ‹¬ä¿®æ”¹ä½ã€ä½¿ç”¨ä½ã€æƒé™ä½ç­‰â€¦</p><p>ç£ç›˜åˆ†ä¸ºäº¤æ¢åˆ†åŒºå’Œæ•°æ®åˆ†åŒºï¼Œäº¤æ¢åˆ†åŒºç”¨äºå­˜æ”¾ä¸»å­˜é¡µé¢æ¢å‡ºçš„åŠ¨æ€ä¿®æ”¹æ•°æ®ï¼Œæ•°æ®åˆ†åŒºç”¨äºå­˜å‚¨ç”¨æˆ·ç¨‹åºå’Œæ•°æ®ï¼Œä¸»å­˜å’Œç£ç›˜ä¸¤éƒ¨åˆ†ç©ºé—´åˆå¹¶æ„æˆè™šæ‹Ÿåœ°å€ç©ºé—´</p><p><strong>é¡µè¡¨å¸¸é©»å†…å­˜</strong>ï¼Œå¹¶å°†è™šæ‹Ÿåœ°å€ä¸­çš„è™šæ‹Ÿé¡µå·ä½œä¸ºç´¢å¼•æ¥è®¿é—®ã€‚æ¯ä¸ªè™šæ‹Ÿé¡µå¯¹åº”ä¸€ä¸ªé¡µè¡¨é¡¹ï¼Œ</p><p>ç”±äºæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ç‹¬ç«‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œå› æ­¤æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸€å¼ å®Œæ•´çš„é¡µè¡¨ï¼ˆé¡µè¡¨å±äºè¿›ç¨‹æ§åˆ¶ä¿¡æ¯ï¼Œå­˜æ”¾åœ¨è¿›ç¨‹åœ°å€ç©ºé—´çš„å†…æ ¸åŒºä¸­ï¼‰ã€‚é¡µè¡¨åœ¨ä¸»å­˜çš„é¦–åœ°å€è®°å½•åœ¨<strong>é¡µè¡¨åŸºå€å¯„å­˜å™¨PTB</strong>Rä¸­ï¼Œè¿›ç¨‹åˆ‡æ¢æ—¶åªéœ€è¦åˆ‡æ¢PTBRçš„å€¼å°±å¯ä»¥å®ç°é¡µè¡¨çš„å¿«é€Ÿåˆ‡æ¢ã€‚</p><blockquote><p>VAï¼šè™šæ‹Ÿåœ°å€<br>PAï¼šç‰©ç†åœ°å€<br>PTEï¼šé¡µè¡¨é¡¹<br>PTEAï¼šé¡µè¡¨é¡¹åœ°å€</p></blockquote><p>é¡µè¡¨é¡¹çš„æœ‰æ•ˆä½ = 1 -&gt; å½“å‰é¡µçš„æ•°æ®åœ¨ä¸»å­˜ä¸­ï¼Œç›´æ¥åˆ©ç”¨PPNå’ŒVPOç”Ÿæˆç‰©ç†åœ°å€ï¼Œè®¿é—®ä¸»å­˜æ•°æ®<br>æœ‰æ•ˆä½ = 0 -&gt; å¯¹åº”è™šæ‹Ÿé¡µå¯èƒ½æš‚æœªåˆ†é…é¡µï¼›ä¹Ÿå¯èƒ½å¯¹åº”é¡µåœ¨ç£ç›˜ä¸­ï¼Œè®¿é—®é¡µä¼šè§¦å‘ç¼ºé¡µå¼‚å¸¸ï¼Œç”±æ“ä½œç³»ç»Ÿçš„ç¼ºé¡µå¼‚å¸¸å¤„ç†ç¨‹åºè´Ÿè´£å°†ç£ç›˜çš„å¯¹åº”é¡µè½½å…¥åˆ°ä¸»å­˜ä¸­ï¼Œå¹¶æ›´æ–°é¡µè¡¨é¡¹ã€‚ï¼ˆä¹¦ä¸­æœ‰å›¾å’Œä¾‹é¢˜ P.141ï¼‰</p><p>VPN+PTBR -&gt; é¡µè¡¨ä¸»å­˜ä¸­ä½ç½® â€“ &gt; PPN  PPN + (VPOâ€“&gt;PPO) = PA</p><h4 id="è™šå­˜çš„è®¿é—®æµç¨‹">è™šå­˜çš„è®¿é—®æµç¨‹</h4><p>ä¹¦ä¸­è¯¦è§£ P.142</p><p><strong>ç»“åˆcacheçš„è™šå­˜å™¨è®¿é—®æµç¨‹</strong></p><p>é¡µè¡¨çš„éƒ¨åˆ†æ•°æ®å—å¯èƒ½ä¼šä½œä¸ºå¸¸ç”¨çš„çƒ­æ•°æ®è°ƒåº¦åˆ°cacheä¸­</p><p>æœ€ä½³æƒ…å†µï¼š2æ¬¡cacheè®¿é—®ï¼ˆæ•°æ®å’Œé¡µè¡¨éƒ½åœ¨cacheä¸­å‘½ä¸­ï¼‰<br>æœ€åæƒ…å†µï¼š2æ¬¡ä¸»å­˜è®¿é—®+ç£ç›˜è®¿é—®ï¼ˆé¡µè¡¨æ•°æ®å‡æœªå‘½ä¸­ä¸”ç¼ºé¡µï¼‰</p><p><strong>åˆ©ç”¨TLBåŠ é€Ÿç»­å­˜å™¨åœ°å€è½¬æ¢</strong></p><p>cacheç¼“å­˜éƒ¨åˆ†å¸¸è®¿é—®çš„é¡µè¡¨å—çš„æ•°æ®ç²’åº¦å¤ªå¤§ï¼Œå¹¶ä¸èƒ½å……åˆ†åˆ©ç”¨è™šæ‹Ÿå­˜å‚¨å™¨è®¿é—®çš„å±€éƒ¨æ€§ã€‚<br>ä¸ºäº†è¿›ä¸€æ­¥é™ä½è™šæ‹Ÿå­˜å‚¨å™¨åœ°å€è½¬æ¢çš„ç¡¬ä»¶å¼€é”€ï¼Œå¤„ç†å™¨éƒ½ç»´æŠ¤ä¸€ä¸ª<strong>è½¬æ¢æ—è·¯ç¼“å†²åŒº</strong>(TLBï¼Œä¸€ä¸ªè¾ƒå°çš„cache)ï¼Œç”¨äº<strong>ç¼“å†²ç»å¸¸è®¿é—®çš„PTE</strong>ã€‚é‡‡ç”¨å…¨ç›¸è”å’Œç»„ç›¸è”ï¼Œéšæœºæ›¿æ¢ç®—æ³•ã€‚</p><p>é‡‡ç”¨ç»„ç›¸è”cacheçš„åœ°å€åˆ’åˆ†æ–¹æ³•ï¼Œè™šé¡µå·åˆ’åˆ†æˆTLBæ ‡è®°å’ŒTLBç´¢å¼•ï¼Œä¾¿äºå¿«é€Ÿåˆ¤æ–­è®¿é—®çš„é¡µé¢æ˜¯å¦åœ¨ä¸»å­˜ä¸­ï¼Œæ ‡è®°å­—æ®µæ˜¯TLBT<br>VPN = TLBT + TLBI  + VPO<br>é‡‡ç”¨å…¨ç›¸è”çš„æ˜ å°„ï¼Œåˆ™TLBè¡¨é¡¹ä¸­çš„æ ‡è®°å­—æ®µå°±æ˜¯VPNï¼Œ</p><p>TLBç¦»CPUæ›´è¿‘ï¼Œè®¿é—®é€Ÿåº¦æ›´å¿«ï¼Œå°†TLBç§°ä¸ºå¿«è¡¨ï¼Œæ ¹æ®å†…å®¹è®¿é—®ï¼Œä¸»å­˜çš„é¡µè¡¨å«æ…¢è¡¨ï¼Œæ ¹æ®åœ°å€è®¿é—®ã€‚</p><p>è¿›è¡Œåœ°å€è½¬æ¢æ—¶ï¼Œä¼šåŒæ—¶æŸ¥è¯¢å—è¡¨å’Œæ…¢è¡¨</p><h4 id="CPUè®¿å­˜è¿‡ç¨‹">CPUè®¿å­˜è¿‡ç¨‹</h4><p>æ“ä½œç³»ç»Ÿå¼•å¯¼å®Œæˆä¹‹å‰ â€” CPUåªèƒ½ä»¥åœ°å€è®¿é—®ä¸»å­˜<br>å¼•å¯¼å®Œæˆåâ€“è¿›å…¥ä¿æŠ¤æ¨¡å¼ï¼Œåªèƒ½ç”¨è™šåœ°å€è®¿é—®ä¸»å­˜</p><p>ä¹¦ä¸­P.145æœ‰å…·ä½“å›¾</p><p><strong>ä¹¦åä¹ é¢˜éå¸¸é‡è¦ï¼Œæ³¨æ„è¿™ç« çš„æ¦‚å¿µè§£é‡Š</strong></p><h2 id="æŒ‡ä»¤ç³»ç»Ÿ">æŒ‡ä»¤ç³»ç»Ÿ</h2><h3 id="æ¦‚è¿°-v5">æ¦‚è¿°</h3><p>æŒ‡ä»¤ï¼šç”¨æˆ·ä½¿ç”¨è®¡ç®—æœºä¸è®¡ç®—æœºæœ¬èº«è¿è¡Œçš„åŸºæœ¬åŠŸèƒ½å•ä½<br>æœºå™¨æŒ‡ä»¤ï¼šè®¡ç®—æœºç¡¬ä»¶ä¸è½¯ä»¶çš„ç•Œé¢ï¼Œç”¨æˆ·æ“ä½œå’Œä½¿ç”¨è®¡ç®—æœºç¡¬ä»¶çš„æ¥å£</p><p>ä¸€æ¡é«˜çº§è¯­è¨€ â€”&gt; å¤šæ¡æœºå™¨æŒ‡ä»¤<br>ä¸€æ¡æ±‡ç¼–è¯­è¨€ â€”&gt;(ä¸€èˆ¬)ä¸€æ¡æœºå™¨æŒ‡ä»¤<br>ä¸€æ¡æœºå™¨æŒ‡ä»¤ â€”&gt; å¤šæ¡å¾®æŒ‡ä»¤</p><p>æŒ‡ä»¤ç³»ç»Ÿåº”è¯¥æ»¡è¶³çš„æ¡ä»¶ï¼š</p><ul><li>å®Œå¤‡æ€§</li><li>è§„æ•´æ€§ï¼šå¯¹ç§°æ€§+å‡é½æ€§ã€‚å¯„å­˜å™¨å’Œå­˜å‚¨å•å…ƒå¯ä»¥è¢«åŒç­‰å¯¹å¾…ï¼Œæ‰€æœ‰å¿—æ—å¯ä»¥ä½¿ç”¨å„ç§å¯»å€æ–¹å¼ï¼›æŒ‡ä»¤ç³»ç»Ÿæä¾›ä¸åŒæ•°æ®ç±»å‹çš„æ”¯æŒ</li><li>æœ‰æ•ˆæ€§</li><li>å…¼å®¹æ€§</li><li>å¯æ‰©å±•æ€§ï¼šæŒ‡ä»¤æ ¼å¼çš„æ“ä½œç é¢„ç•™ä¸€å®šçš„ç¼–ç ç©ºé—´ ï¼Œæ–¹ä¾¿æ‰©å±•æŒ‡ä»¤</li></ul><h3 id="æŒ‡ä»¤æ ¼å¼">æŒ‡ä»¤æ ¼å¼</h3><p><strong>æŒ‡ä»¤å­—é•¿</strong>ï¼šä¸€æ¡æŒ‡ä»¤ä¸­çš„äºŒè¿›åˆ¶ä½æ•°</p><ul><li>å®šé•¿æŒ‡ä»¤ç³»ç»Ÿï¼š<ul><li>ç»“æ„ç®€å•ï¼Œæ–¹ä¾¿ç¡¬ä»¶å®ç°ï¼Œæœ‰åˆ©äºCPUå–æŒ‡ä»¤ã€è¯‘ç å’ŒæŒ‡ä»¤é¡ºåºå¯»å€</li><li>å¹³å‡é•¿åº¦åé•¿ï¼Œå†—ä½™çŠ¶æ€å¤šï¼Œä¸æ–¹ä¾¿æ‰©å±•</li></ul></li><li>å˜é•¿æŒ‡ä»¤ç³»ç»Ÿï¼š<ul><li>ç»“æ„çµæ´»ã€é•¿åº¦å¯å˜ï¼Œå†—ä½™çŠ¶æ€å°‘ï¼Œå¯æ‰©å±•æ€§å¥½</li><li>å–æŒ‡ä»¤å¯èƒ½æ¶‰åŠå¤šæ¬¡è®¿å­˜æ“ä½œï¼Œä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€å¿…é¡»åœ¨æŒ‡ä»¤è¯‘ç å®Œæˆåæ‰èƒ½ç¡®å®šï¼Œå¢åŠ ç¡¬ä»¶è®¾è®¡éš¾åº¦(Intel x86)</li></ul></li></ul><p>æŒ‡ä»¤å¯åˆ†ä¸ºï¼šåŠå­—é•¿(CPUè®¿é—®1æ¬¡å¯è¯»å–2æ¡)ã€å•å­—é•¿(CPU1æ¬¡è®¿é—®1æ¡)ã€å¤šå­—é•¿ã€‚<br>é•¿åº¦è¶Šå¤§ï¼Œå ç”¨ä¸»å­˜ç©ºé—´å¤§ï¼Œè®¿é—®æ—¶é—´é•¿</p><h4 id="æŒ‡ä»¤åœ°å€ç ">æŒ‡ä»¤åœ°å€ç </h4><p>æŒ‡ä»¤å¯åˆ†ä¸ºï¼š</p><ol><li><p>ä¸‰åœ°å€æŒ‡ä»¤</p><p>**åŒç›®è¿ç®—ï¼š**å…·æœ‰ä¸¤ä¸ªæ“ä½œå¯¹è±¡çš„è¿ç®—ã€‚ä¸¤ä¸ªæºæ“ä½œæ•°+ä¸€ä¸ªç›®çš„æ“ä½œæ•°<br>$$A_3 \leftarrow (A_1)OP(A_2)$$</p><p>3åœ°å€ç å¾ˆå°‘ç”¨å­˜å‚¨å•å…ƒçš„åœ°å€ç ï¼Œä¸€èˆ¬3ä¸ªæ“ä½œæ•°éƒ½æ˜¯å¯„å­˜å™¨</p></li><li><p>åŒåœ°å€æŒ‡ä»¤</p><p>$$ A_1 \leftarrow (A_1)OP(A_2)$$</p><p>å¯åˆ†ä¸ºï¼š</p><ul><li>RR(å¯„å­˜å™¨-å¯„å­˜å™¨)å‹</li><li>RS(å¯„å­˜å™¨-å­˜å‚¨å™¨)å‹</li><li>SS(å­˜å‚¨å™¨-å­˜å‚¨å™¨)å‹</li></ul></li><li><p>å•åœ°å€æŒ‡ä»¤</p><ol><li><p>å•ç›®è¿ç®—ç±»æŒ‡ä»¤<br>$$ A_1 \leftarrow OP(A_1)$$</p></li><li><p>éšå«æ“ä½œæ•°æ˜¯åŒç›®è¿ç®—ç±»æŒ‡ä»¤</p><p>$$ A_1 \leftarrow (AC)OP(A_1)$$</p><p>ä¸€ä¸ªæ“ä½œæ•°éšå«äºCPUçš„æŸä¸ªå¯„å­˜å™¨</p></li></ol></li><li><p>é›¶åœ°å€æŒ‡ä»¤</p><p>åªæœ‰æ“ä½œç å­—æ®µæ²¡æœ‰åœ°å€å­—æ®µã€‚ç±»ä¼¼å•åœ°å€æŒ‡ä»¤ï¼Œä¹Ÿæœ‰ä¸¤ç§æ–¹å¼</p><ol><li>wait ret halt nopä¸éœ€è¦ä»»ä½•æ“ä½œæ•°</li><li>éšå«æ“ä½œæ•°æŒ‡ä»¤</li></ol></li></ol><h4 id="æŒ‡ä»¤æ“ä½œç ">æŒ‡ä»¤æ“ä½œç </h4><ol><li><p>å®šé•¿æ“ä½œç ï¼Œå®šé•¿ä¼˜ç‚¹åŒä¸Šã€‚</p></li><li><p>å˜é•¿æ“ä½œç ï¼Œä¼˜ç‚¹åŒä¸Šã€‚</p><p>å¯é‡‡ç”¨æ‰©å±•æ“ä½œç æŠ€æœ¯æ¥å®ç°å˜é•¿æ›¹ç»„å¥½å—ï¼Œæ“ä½œç çš„é•¿åº¦éšåœ°å€ç æ•°ç›®å‡å°‘è€Œå¢åŠ ã€‚ä¹¦ä¸­æœ‰å›¾é¢˜P.157</p></li></ol><h3 id="å¯»å€æ–¹å¼">å¯»å€æ–¹å¼</h3><p>æŒ‡ä»¤å­˜æ”¾åœ¨ä¸»å­˜ä¸­</p><p><strong>æŒ‡ä»¤æ•°å¯»å€æ–¹å¼</strong></p><ol><li><p>é¡ºåºå¯»å€</p><p>æŒ‡ä»¤åœ¨ä¸»å­˜ä¸­ å¾€å¾€æŒ‰åºæ’æ”¾</p></li><li><p>è·³è·ƒå¯»å€</p><p>ç¨‹åºå‡ºç°åˆ†æ”¯æˆ–è½¬ç§»æ—¶ï¼Œè¦æ”¹å˜æ‰§è¡Œé¡ºåºã€‚å³ä¸‹ä¸€æ¡çš„æŒ‡ä»¤ä¸ä¸€å®šèƒ½é€šè¿‡PC+1æ¥å–åˆ°</p><p>ä¾‹å¦‚ï¼šæ— æ¡ä»¶è·³è½¬æŒ‡ä»¤å’Œæ¡ä»¶è·³è½¬è‡³é›¶</p></li></ol><p><strong>æ“ä½œæ•°å¯»å€æ–¹å¼</strong></p><p>æ“ä½œæ•°æ¥æºï¼š</p><ol><li>ç›´æ¥æ¥è‡ªæŒ‡ä»¤åœ°å€å­—æ®µï¼Ÿ</li><li>å­˜æ”¾åœ¨å¯„å­˜å™¨ä¸­</li><li>å­˜æ”¾åœ¨å­˜å‚¨å™¨ä¸­</li></ol><p>å°†åœ°å€ç å­—æ®µç»†åˆ†ä¸ºå¯»å€æ–¹å¼å­—æ®µI å’Œåœ°å€å­—æ®µD , ä¾‹å¦‚å•åœ°å€æŒ‡ä»¤å¯åˆ’åˆ†ä¸º</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027093000063.png" alt="image-20211027093000063"></p><ol><li><p>ç«‹å³å¯»å€</p><p>Iè¡¨ç¤ºç«‹å³å¯»å€çš„ç¼–ç ï¼ŒDå­—æ®µæ˜¯æ“ä½œæ•°æœ¬èº«ã€‚æ“ä½œæ•°å’ŒæŒ‡ä»¤åŒè¿›é€€ï¼Œå–æŒ‡ä»¤æ—¶æ“ä½œæ•°éšç€æŒ‡ä»¤ä¸€èµ·è¢«é€åˆ°CPUçš„æŒ‡ä»¤å¯„å­˜å™¨ä¸­ï¼Œæ‰§è¡ŒæŒ‡ä»¤æ—¶ç›´æ¥ä»æ‰§è¡Œå¯„å­˜å™¨è·å–æ“ä½œæ•°</p><p>å–æ“ä½œæ•°å¿«ï¼Œä½†å½¢å¼åœ°å€å­—æ®µDä½å®½æœ‰é™ï¼Œæ“ä½œæ•°èƒ½è¡¨ç¤ºçš„èŒƒå›´æœ‰é™ï¼Œä¸€èˆ¬ç”¨äºå˜é‡èµ‹åˆå€¼</p><p>MOV EAX, 2008H</p></li><li><p>ç›´æ¥å¯»å€</p><p>æ“ä½œæ•°åœ¨ä¸»å­˜ä¸­ï¼Œæ“ä½œæ•°åœ°å€ç”±Dç›´æ¥ç»™å‡º</p><p>ç›´è§‚ï¼Œä¸éœ€è¦è®¡ç®—å°±å¯ç›´æ¥ä»æŒ‡ä»¤ä¸­è·å¾—æ“ä½œæ•°æœ‰æ•ˆåœ°å€</p><p>ä½†å¯»å€èŒƒå›´å—é™äºæŒ‡ä»¤ä¸­ç›´æ¥åœ°å€çš„äºŒè¿›åˆ¶ä½æ•°ï¼Œæ•°æ®åœ°å€å­˜åœ¨æŒ‡ä»¤ä¸­ã€ç¨‹åºå’Œæ•°æ®åœ¨å†…å­˜ä¸­çš„å­˜æ”¾ä½ç½®å—åˆ°é™åˆ¶</p><p>MOV EAX , [2008H]</p></li><li><p>å¯„å­˜å™¨å¯»å€</p><p>Dè¡¨ç¤ºå¯„å­˜å™¨çš„ç¼–å·</p><p>MOV EAX,ECX</p></li><li><p>é—´æ¥å¯»å€</p><p>Dç»™å‡ºçš„æ˜¯æ“ä½œæ•°çš„é—´æ¥åœ°å€ã€‚åœ°å€æŒ‡å‘çš„ä¸»å­˜å•å…ƒä¸­çš„å†…å®¹æ‰æ˜¯æ“ä½œæ•°çš„æœ‰æ•ˆåœ°å€</p><p>MOV EAX , @2008H;</p><ul><li>è§£å†³äº†ç›´æ¥å¯»å€æ–¹å¼å¯»å€èŒƒå›´å—é™çš„é—®é¢˜ï¼Œèƒ½ç”¨è¾ƒçŸ­çš„åœ°å€ç è®¿é—®è¾ƒå¤§çš„ä¸»å­˜ç©ºé—´</li><li>çµæ´»ï¼Œæ“ä½œæ•°åœ°å€æ”¹å˜ä¸éœ€è¦æ”¹å˜æŒ‡ä»¤ä¸­çš„å½¢å¼åœ°å€ï¼Œåªéœ€è¦æ”¹å˜å…¶æŒ‡å‘çš„ä¸»å­˜å•å…ƒå†…å®¹å³å¯</li></ul><p>ä½†å–æ“ä½œæ•°æ—¶éœ€è¦ä¸¤æ¬¡è®¿é—®ä¸»å­˜ï¼Œé™ä½äº†æŒ‡ä»¤çš„æ‰§è¡Œé€Ÿåº¦</p></li><li><p>å¯„å­˜å™¨é—´æ¥å¯»å€</p><p>æ“ä½œæ•°åœ°å€å­˜æ”¾åœ¨å¯„å­˜å™¨ä¸­ï¼Œå®é™…æ“ä½œæ•°åœ¨ä¸»å­˜ä¸­ï¼ˆå¯„å­˜å™¨æŒ‡å‘ä¸»å­˜çš„åœ°å€ï¼‰<br>åªéœ€è¦ä¸€æ¬¡è®¿é—®ä¸»å­˜ï¼Œè¿˜å¯ä»¥æ‰©å……å¯»å€èŒƒå›´<br>MOV AL,[EBX]</p></li><li><p>ç›¸å¯¹å¯»å€</p><p>æŠŠPCçš„å†…å®¹(ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€)åŠ ä¸ŠæŒ‡ä»¤çš„å½¢å¼åœ°å€D,å½¢æˆæ“ä½œæ•°çš„æœ‰æ•ˆåœ°å€</p><p>æ•°æ®æœ‰æ•ˆåœ°å€ EA = PC + D ï¼Œå–æŒ‡ä»¤æ—¶PCçš„å€¼ä¼šä¿®æ”¹ï¼Œè€Œè®¡ç®—æ“ä½œæ•°çš„æœ‰æ•ˆåœ°å€åœ¨æŒ‡ä»¤è¯‘ç åˆ†ææˆ–æ‰§è¡Œé˜¶æ®µå®Œæˆï¼Œæ‰€ä»¥æœ‰EA = PC + 1 + Dï¼Ÿï¼Ÿï¼Ÿ</p><ul><li>åªéœ€è¦ç¡®å®šç¨‹åºå†…éƒ¨æ“ä½œæ•°ä¸æŒ‡ä»¤ä¹‹é—´çš„ç›¸å¯¹è·ç¦»ï¼Œæ— éœ€çŸ¥é“æ“ä½œæ•°åœ¨ä¸»å­˜çš„ç»å¯¹åœ°å€</li><li>åˆ†æ”¯è½¬ç§»ç±»æŒ‡ä»¤ï¼Œå®ç°ç›¸å¯¹è·³è½¬è½¬ç§»ï¼Œæœ‰åˆ©äºç¨‹åºåœ¨ä¸»å­˜ä¸­çµæ´»å®šä½</li></ul></li><li><p>å˜å€å¯»å€</p><p>æŒ‡å®šä¸€ä¸ªå¯„å­˜å™¨ç”¨æ¥å­˜æ”¾å˜åŒ–çš„åœ°å€ ï¼Œå«å˜å€å¯„å­˜å™¨ã€‚å½¢å¼å­—æ®µDå¢åŠ å˜å€å¯„å­˜å™¨å­—æ®µX ã€‚X +D å°±ä¸ºæ“ä½œæ•°çš„æœ‰æ•ˆåœ°å€<br>å˜å€å¯„å­˜å™¨æä¾›ä¿®æ”¹é‡ï¼ŒæŒ‡ä»¤æä¾›åŸºå‡†é‡ï¼ˆæŒ‡ä»¤æ‰§è¡Œè¿‡ä¸­ï¼ŒXå¯„å­˜å™¨å†…å®¹å¯å˜ï¼ŒDå†…å®¹ä¸å¯å˜ï¼‰</p><p>ç”¨äºå¯¹çº¿æ€§è¡¨ç±»çš„æ•°ç»„å…ƒç´ è¿›è¡Œé‡å¤è®¿é—®</p><p>é¢å‘ç”¨æˆ·ï¼Œè§£å†³ç¨‹åºå¾ªç¯é—®é¢˜</p><p>MOV EAX ï¼Œ 32[ESI]</p></li><li><p>åŸºå€å¯»å€</p><p>æŒ‡å®šä¸€ä¸ªå¯„å­˜å™¨æ¥å­˜æ”¾åŸºåœ°å€ï¼Œæˆä¸ºåŸºå€å¯„å­˜å™¨B.æŒ‡ä»¤Då­˜æ”¾å˜åŒ–çš„åœ°å€å€¼ã€‚ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­Bä¸å¯æ”¹å˜ï¼ŒDå¯æ”¹å˜</p><p>CPUå†…æœ‰ä¸“é—¨çš„åŸºå€å¯„å­˜å™¨(EBX EBP)ã€‚è‹¥åŸºå€æ˜¯EBX,åˆ™æ“ä½œæ•°åœ¨æ•°æ®æ®µï¼Œæ˜¯EBPï¼Œåˆ™æ“ä½œæ•°åœ¨å †æ ˆæ®µ</p><ul><li>é¢å‘ç³»ç»Ÿï¼Œç”¨äºç¨‹åºçš„é‡å®šä½ï¼ˆæ¯ä¸ªç”¨æˆ·ç¨‹åºä¸å†²çªï¼ˆç¼–ç¨‹ç¯å¢ƒå’Œå®é™…ç¯å¢ƒï¼‰ï¼‰</li><li>æ‰©å±•å¯»å€ç©ºé—´ï¼ˆåŸºå€å¯„å­˜å™¨ä½æ•°å¤§ï¼‰</li></ul><p><strong>åç§»å¯»å€</strong>ï¼šç›¸å¯¹å¯»å€ã€å˜å€å¯»å€ã€åŸºå€å¯»å€ï¼ˆä»¥æŸå¯„å­˜å™¨çš„å†…å®¹ä¸æŒ‡ä»¤ä¸­çš„å½¢å¼åœ°å€å­—æ®µä¹‹å’Œä½œä¸ºæœ‰æ•ˆåœ°å€ï¼‰</p></li><li><p>å †æ ˆå¯»å€</p><ol><li><p>å­˜å‚¨å™¨å †æ ˆ</p><p><strong>åœ¨å†…å­˜ç©ºé—´ä¸­å¼€è¾Ÿå †æ ˆåŒº</strong></p><p>è®¡ç®—æœºæ™®éé‡‡ç”¨ï¼Œè®¾ç½®å †æ ˆæŒ‡é’ˆå¯„å­˜å™¨SPæŒ‡å‘æ ˆé¡¶å•å…ƒï¼Œ</p></li><li><p>å¯„å­˜å™¨å †æ ˆ</p><p><strong>å°†å¯„å­˜å™¨ä½œä¸ºå †æ ˆ</strong></p><ul><li>å¯„å­˜å™¨å †æ ˆæ ˆé¡¶è§„å®šï¼Œå­˜å‚¨å™¨å †æ ˆæ ˆé¡¶éšç€æ ˆæ“ä½œè€Œç§»åŠ¨</li><li>è¿›è¡Œå †æ ˆæ“ä½œï¼Œå¯„å­˜å™¨å †æ ˆæ•°æ®ç§»åŠ¨ï¼Œå­˜å‚¨å™¨å †æ ˆæ•°æ®ä¸ç§»åŠ¨ï¼ˆå †æ ˆæ˜¯å›ºå®šçš„ï¼Œæ•°æ®æ˜¯æ´»çš„ï¼‰</li><li>å¯„å­˜å™¨å †æ ˆé€Ÿåº¦å—ï¼Œå®¹é‡æœ‰é™</li><li>å¯„å­˜å™¨å †æ ˆå¿…é¡»é‡‡ç”¨ä¸“ç”¨å †æ ˆæŒ‡ä»¤è¿›è¡Œæ§åˆ¶</li></ul></li></ol></li><li><p>å…¶ä»–å¯»å€</p><ol><li>å˜å€+é—´æ¥å¯»å€</li><li>é—´æ¥+å˜å€å¯»å€</li><li>ç›¸å¯¹+é—´æ¥å¯»å€</li></ol></li></ol><h3 id="æŒ‡ä»¤ç±»å‹">æŒ‡ä»¤ç±»å‹</h3><ol><li>ç®—æ•°é€»è¾‘è¿ç®—æŒ‡ä»¤</li><li>ç§»ä½æ“ä½œæŒ‡ä»¤</li><li>æ•°æ®ä¼ é€æŒ‡ä»¤</li><li>å †æ ˆæ“ä½œæŒ‡ä»¤</li><li>å­—ç¬¦ä¸²å¤„ç†æŒ‡ä»¤</li><li>ç¨‹åºæ§åˆ¶æŒ‡ä»¤<ol><li>è½¬ç§»æŒ‡ä»¤ ï¼ˆæœ‰æ— æ¡ä»¶ï¼‰</li><li>å¾ªç¯æ§åˆ¶æŒ‡ä»¤</li><li>å­ç¨‹åºè°ƒç”¨ä¸è¿”å›æŒ‡ä»¤</li></ol></li><li>è¾“å…¥è¾“å‡ºæŒ‡ä»¤</li><li>å…¶ä»–</li></ol><h3 id="æŒ‡ä»¤æ ¼å¼è®¾è®¡">æŒ‡ä»¤æ ¼å¼è®¾è®¡</h3><h3 id="CISC-RISC">CISC RISC</h3><p>CISCï¼šå¤æ‚æŒ‡ä»¤é›†è®¡ç®—æœº<br>RISCï¼šç²¾ç®€æŒ‡ä»¤é›†è®¡ç®—æœºï¼ˆ80 -20 ï¼‰</p><p>ç›®çš„å’Œç‰¹ç‚¹ çœ‹ä¹¦ P.168</p><p><strong>ä¸åŒæ“ä½œç³»ç»Ÿä¸­çš„æŒ‡ä»¤æ ¼å¼</strong>ï¼Œä¹¦ä¸­æœ‰</p><h2 id="ä¸­å¤®å¤„ç†å™¨">ä¸­å¤®å¤„ç†å™¨</h2><p>CPUä¸Šç”µå¤ä½åå‘¨è€Œå¤å§‹åœ°å–æŒ‡ä»¤ã€æ‰§è¡ŒæŒ‡ä»¤å·¥ä½œã€‚<br>å…·å¤‡åŠŸèƒ½ï¼š</p><ol><li>ç¨‹åºæ§åˆ¶</li><li>æ“ä½œæ§åˆ¶ã€‚äº§ç”ŸæŒ‡ä»¤æ‰§è¡Œè¿‡ç¨‹ä¸­éœ€è¦çš„æ“ä½œæ§åˆ¶ä¿¡å·ï¼Œä»¥æ§åˆ¶æ‰§è¡Œéƒ¨ä»¶æŒ‰æŒ‡ä»¤è§„å®šçš„æ“ä½œæ­£å¸¸è¿è¡Œï¼ˆæ‰§è¡ŒåŠ æ³•æŒ‡ä»¤è¿ç®—ï¼ŒCPUå¿…é¡»ç”Ÿæˆè¿ç®—å™¨çš„è¿ç®—é€‰æ‹©æ§åˆ¶ä¿¡å·ï¼‰</li><li>æ—¶åºæ§åˆ¶ã€‚ä¸¥æ ¼æ§åˆ¶æ¯ä¸ªæ“ä½œæ§åˆ¶ä¿¡å·çš„å¼€å§‹æ—¶é—´å’ŒæŒç»­æ—¶é—´</li><li>æ•°æ®åŠ å·¥ã€‚å¯¹æ•°æ®è¿›è¡Œç®—æ•°ã€é€»è¾‘è¿ç®—</li><li>ä¸­æ–­å¤„ç†ã€‚å“åº”å†…éƒ¨å¼‚å¸¸å’Œå¤–éƒ¨ä¸­æ–­è¯·æ±‚(è¿ç®—å¼‚å¸¸ã€ç¼ºé¡µã€å¤–éƒ¨è®¾å¤‡ä¸­æ–­)</li></ol><h3 id="ç»„æˆ">ç»„æˆ</h3><p><strong>ä¸»è¦å¯„å­˜å™¨</strong></p><ol><li><p>ç¨‹åºè®¡æ•°å™¨ PCï¼š</p><p>ä¿å­˜<strong>å°†è¦æ‰§è¡Œçš„æŒ‡ä»¤çš„å­—èŠ‚åœ°å€</strong>ï¼ŒIntelx86å«æŒ‡ä»¤æŒ‡é’ˆå¯„å­˜å™¨IP.</p><p><strong>PCä½å®½ä¸ä¸»å­˜åœ°å€æ€»çº¿ä½å®½ç›¸åŒ</strong></p><p>CPUå–æŒ‡ä»¤ï¼Œåˆ©ç”¨PCçš„å†…å®¹ä½œä¸ºåœ°å€è®¿é—®ä¸»å­˜ï¼Œå¹¶å°†ä¸»å­˜å–å‡ºçš„æŒ‡ä»¤å­—é€å…¥æŒ‡ä»¤å¯„å­˜å™¨ä¸­ï¼Œç—…ä¿®æ”¹PCçš„å€¼ä»¥å½¢æˆä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ã€‚</p></li><li><p>(å­˜å‚¨å™¨)åœ°å€å¯„å­˜å™¨ ARï¼š</p><p>ä¿å­˜CPUè®¿é—®ä¸»å­˜çš„å•å…ƒåœ°å€ï¼Œæ— è®ºCPUæ˜¯å–æ“ä½œè¿˜æ˜¯å­˜æ•°æ®ï¼Œéƒ½è¦å°†è®¿é—®åœ°å€é€å…¥ARä¸­ã€‚<br><strong>ä½å®½å’Œä¸»å­˜åœ°å€æ€»çº¿ä½å®½ç›¸åŒ</strong>ï¼ŒARå¹¶éå¿…é¡»ï¼Œå¯å°†è®¿å­˜åœ°å€åŠ è½½åˆ°åœ°å€æ€»çº¿ä¸Šå®ç°</p></li><li><p>(å­˜å‚¨å™¨)æ•°æ®å¯„å­˜å™¨ DRï¼š</p><p>å­˜æ”¾ä»ä¸»å­˜ä¸­è¯»å‡ºçš„æ•°æ®æˆ–è€…å‡†å¤‡å†™å…¥ä¸»å­˜çš„æ•°æ®ï¼ˆcacheï¼Ÿï¼‰</p><p><strong>æ•°æ®ä½å®½ä¸æœºå™¨å­—é•¿ç›¸åŒ</strong>ï¼Œå¹¶éå¿…é¡»</p></li><li><p>æŒ‡ä»¤å¯„å­˜å™¨ IRï¼š</p><p><strong>ä¿å­˜å½“å‰æ­£åœ¨æ‰§è¡Œçš„æŒ‡ä»¤</strong>ï¼ˆè€Œéåœ°å€ï¼‰</p><p>ä½å®½å’ŒæŒ‡ä»¤å­—ç›¸åŒï¼ŒæŒ‡ä»¤å­—ç”±æŒ‡ä»¤è¯‘ç å™¨IDç¿»è¯‘æˆè‹¥å¹²ä¸ªæŒ‡ä»¤è¯‘ç ä¿¡å·ï¼ˆæ¯ä¸ªä¿¡å·è¡¨ç¤ºä¸€æ¡ä¸åŒæŒ‡ä»¤ï¼ŒåŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªä¿¡å·æœ‰æ•ˆï¼‰<br>æŒ‡ä»¤å­—ä¸­çš„åœ°å€ç éƒ¨åˆ†ç”±åœ°å€ç”Ÿæˆé€»è¾‘å¯¹å¯»å€æ–¹å¼è¿›è¡Œè¯‘ç å¹¶ç”Ÿæˆç›®æ ‡åœ°å€æˆ–æ•°æ®ï¼Œæ ¹æ®å¯»å€æ–¹å¼çš„ä¸åŒå°†ç›®æ ‡åœ°å€é€å…¥ç¨‹åºè®¡æ•°å™¨PCã€ARå’Œè¿ç®—éƒ¨ä»¶ä¸­ ï¼ˆï¼Ÿï¼Ÿï¼Ÿï¼‰</p><p>å¹¶éå¿…é¡»</p></li><li><p>é€šç”¨å¯„å­˜å™¨ç»„ GR</p><p>è¿ç®—å™¨å†…éƒ¨çš„è‹¥å¹²å¯„å­˜å™¨ â€” å¯„å­˜å™¨å †ã€‚</p></li><li><p>ç¨‹åºçŠ¶æ€å­—å¯„å‡ºå»ä½  PSW/PSR</p><p>ä¿å­˜ç”±ç®—æ•°è¿ç®—æŒ‡ä»¤ã€é€»è¾‘è¿ç®—æŒ‡ä»¤ã€æµ‹è¯•æŒ‡ä»¤ç­‰å»ºç«‹çš„å„ç§æ¡ä»¶æ ‡å¿—ã€‚(è¿›ä½æ ‡å¿—ã€æº¢å‡ºæ ‡å¿—ã€ç»“æœä¸ºè´Ÿæ•°ã€é›¶æ ‡å¿—)ã€‚è¿˜å¯ä¿å­˜ä¸­æ–­å’Œç³»ç»Ÿå·¥ä½œçš„çŠ¶æ€ä¿¡æ¯ï¼Œæ–¹ä¾¿CPUåŠæ—¶äº†è§£è®¡ç®—æœºè¿è¡ŒçŠ¶æ€</p></li></ol><p><strong>æ“ä½œæ§åˆ¶å™¨</strong></p><p>æ¥å—æŒ‡ä»¤è¯‘ç å™¨IDé€æ¥çš„æŒ‡ä»¤è¯‘ç ä¿¡æ¯ï¼Œä¸æ—¶åºä¿¡å·ã€æ¡ä»¶ä»¥åŠçŠ¶æ€ä¿¡æ¯è¿›è¡Œç»„åˆï¼Œå½¢æˆå„ç§å…·æœ‰ä¸¥æ ¼æ—¶é—´å…ˆåé¡ºåºçš„æ“ä½œæ§åˆ¶ä¿¡å·ï¼ˆå¾®æ“ä½œæ§åˆ¶ä¿¡å·åºåˆ—  â€” æ§åˆ¶æµï¼‰ï¼Œè¿æ¥åˆ°è®¡ç®—æœºå„åŠŸèƒ½éƒ¨ä»¶çš„æ§åˆ¶ç«¯ã€‚</p><p>æŒ‰ç…§æ—¶é—´å…ˆåæ‰“å¼€æˆ–å…³é—­æŸäº›ç‰¹å®šçš„çº¿è·¯</p><p><strong>æ—¶åºäº§ç”Ÿå™¨</strong></p><p>å¯¹å®ŒæˆæŒ‡ä»¤è€Œæ‰§è¡Œçš„å¾®æ“ä½œæ§åˆ¶ä¿¡å·è¿›è¡Œæ—¶é—´è°ƒåˆ¶ï¼Œä¸¥æ ¼è§„å®šå„ä¿¡å·çš„äº§ç”Ÿæ—¶é—´å’ŒæŒç»­æ—¶é—´</p><p>æ ¹æ®æ—¶åºè°ƒåˆ¶æ–¹æ³•ä¸åŒï¼Œæ“ä½œæ§åˆ¶å™¨åˆ†ä¸ºï¼š</p><ul><li>ç¡¬å¸ƒçº¿æ§åˆ¶å™¨ã€‚é‡‡ç”¨æ—¶åºé€»è¾‘å®ç°ï¼ŒæŒ‰ç…§åŒæ­¥æ—¶åºç”µè·¯è®¾è®¡æ–¹æ³•è®¾è®¡ï¼Œç¡¬æ—¶åº</li><li>å¾®ç¨‹åºæ§åˆ¶å™¨ã€‚é‡‡ç”¨ç¨‹åºå­˜å‚¨é€»è¾‘å®ç°ï¼Œè½¯æ—¶åº</li></ul><h3 id="æŒ‡ä»¤å‘¨æœŸ">æŒ‡ä»¤å‘¨æœŸ</h3><p>æŒ‡ä»¤å‘¨æœŸï¼šå°†ä¸€æ¡æŒ‡ä»¤ä»å–å‡ºåˆ°æ‰§è¡Œå®Œæˆæ‰€éœ€è¦çš„æ—¶é—´</p><p>é˜¶æ®µï¼š</p><ol><li><p>å–æŒ‡å‘¨æœŸ</p><p>CPUä»¥PCçš„å†…å®¹ä½åœ°å€ä»ä¸»å­˜ä¸­å–å‡ºæŒ‡ä»¤ï¼Œå¹¶è®¡ç®—åç»­æŒ‡ä»¤çš„åœ°å€<br>ï¼ˆå¯¹äºå˜é•¿æŒ‡ä»¤ï¼Œéœ€è¦ç»è¿‡æŒ‡ä»¤è¯‘ç å¾—åˆ°å®é™…å­—èŠ‚é•¿åº¦åæ‰èƒ½è®¡ç®—å¹¶ä¿®æ”¹PCçš„å€¼ï¼‰</p></li><li><p>è¯‘ç ã€å–æ“ä½œæ•°å‘¨æœŸ</p><p>å¯¹æŒ‡ä»¤å¯„å­˜å™¨çš„æŒ‡ä»¤å­—è¿›è¡ŒæŒ‡ä»¤è¯‘ç ï¼Œè¯†åˆ«æŒ‡ä»¤ç±»å‹ã€‚ï¼ˆéƒ¨åˆ†å®ç°å°†è¯‘ç é˜¶æ®µåˆ’åˆ†åˆ°å–æŒ‡å‘¨æœŸä¸­ï¼‰</p><p>æ ¹æ®æŒ‡ä»¤åœ°å€ç ç”Ÿæˆçš„æ“ä½œæ•°æœ‰æ•ˆåœ°å€ï¼ˆç”±å¯»å€æ–¹å¼å†³å®šï¼‰ï¼Œè®¿é—®ç›¸åº”çš„å¯„å­˜å™¨å’Œä¸»å­˜å•å…ƒã€‚</p><p>å¯¹äºé—´æ¥å¯»å€ï¼Œè¿˜éœ€è¦åŠ å…¥è®¿å­˜å‘¨æœŸï¼ˆé—´å€åœ°å€ï¼‰æ‰èƒ½å¾—åˆ°æ“ä½œæ•°çš„åœ°å€</p></li><li><p>æ‰§è¡Œå‘¨æœŸ</p><p>æ§åˆ¶å™¨å‘ALUåŠæ•°æ®é€šè·¯ä¸­çš„å…¶ä»–ç›¸å…³éƒ¨ä»¶å‘é€æ“ä½œæ§åˆ¶æŒ‡ä»¤ï¼Œå¯¹å·²ç»å–å‡ºçš„æ“ä½œæ•°è¿›è¡ŒåŠ å·¥å¤„ç†ï¼Œå¹¶å°†å¤„ç†çš„çŠ¶æ€ä¿¡æ¯è®°å½•åˆ°PSWä¸­</p></li><li><p>å†™å›å‘¨æœŸ</p><p>å°†è¿ç®—ç»“æœå†™å›åˆ°ç›®çš„å¯„å­˜å™¨æˆ–å­˜å‚¨å™¨ä¸­ï¼Œå¯èƒ½éœ€è¦å¤šä¸ªæ—¶é’Ÿå‘¨æœŸ</p></li></ol><p>è¿˜å¯èƒ½æœ‰ä¸­æ–­å‘¨æœŸã€æ€»çº¿å‘¨æœŸã€IOå‘¨æœŸç­‰</p><p>ä¾¿äºåŒæ­¥ï¼Œå°†<strong>æŒ‡ä»¤å‘¨æœŸåˆ’åˆ†æˆè‹¥å¹²ä¸ªæœºå™¨å‘¨æœŸ</strong>ï¼ˆCPUå‘¨æœŸï¼‰<br><strong>æœºå™¨å‘¨æœŸ</strong>ï¼šä»ä¸»å­˜ä¸­å–å‡ºä¸€ä¸ªå­˜å‚¨å­—æ‰€éœ€è¦çš„æœ€çŸ­æ—¶é—´<br><strong>æ—¶é’Ÿå‘¨æœŸ</strong>ï¼šä¹Ÿç§°ä¸ºæŒ¯è¡å‘¨æœŸï¼Œå®šä¹‰ä¸ºæ—¶é’Ÿè„‰å†²çš„å€’æ•°ï¼Œ<strong>æ˜¯è®¡ç®—æœºä¸­æœ€åŸºæœ¬çš„ã€æœ€å°çš„æ—¶é—´å•ä½</strong>ã€‚</p><p>æ¯ä¸ªæœºå™¨å‘¨æœŸåˆåŒ…å«è‹¥å¹²ä¸ªæ—¶é’Ÿå‘¨æœŸ</p><p>æŒ‡ä»¤å‘¨æœŸçš„æœºå™¨å‘¨æœŸæ•°å’Œæ¯ä¸ªæœºå™¨å‘¨æœŸåŒ…å«çš„æ—¶é’Ÿå‘¨æœŸæ•°ä¸ä¸€å®šå›ºå®š</p><p><strong>å¯„å­˜å™¨ä¼ é€è¯­è¨€ RTL</strong></p><p>æ¯æ¡æŒ‡ä»¤çš„æ‰§è¡Œè¿‡ç¨‹éƒ½å¯åˆ†è§£ä¸ºä¸€ç»„æ“ä½œåºåˆ—ï¼Œè¿›è€Œåˆ†è§£ä¸ºä¸€ç»„å¾®æ“ä½œåºåˆ—ã€‚<br><strong>æ“ä½œ</strong>ï¼šåŠŸèƒ½éƒ¨ä»¶çº§çš„åŠ¨ä½œ<br><strong>å¾®æ“ä½œ</strong>ï¼šæŒ‡ä»¤åºåˆ—ä¸­æœ€åŸºæœ¬ã€ä¸å¯å†åˆ†çš„åŠ¨ä½œ</p><h1>ä¸€äº›é—®é¢˜</h1><h3 id="CPUå¤šå°‘ä½æŒ‡ä»€ä¹ˆï¼Ÿåœ°å€æ€»çº¿ã€æ•°æ®æ€»çº¿èƒ½å¸¦æ¥å“ªäº›å½±å“"><strong>CPUå¤šå°‘ä½æŒ‡ä»€ä¹ˆï¼Ÿåœ°å€æ€»çº¿ã€æ•°æ®æ€»çº¿èƒ½å¸¦æ¥å“ªäº›å½±å“</strong></h3><p>å¤šå°‘ä½CPUä»£è¡¨çš„æ˜¯ä¸€æ¬¡èƒ½å¤Ÿä»å¤„ç†å¤šå°‘ä½çš„æ•°æ®ï¼Œåœ°å€æ€»çº¿ ï¼= ä½æ•°</p><ul><li>åœ°å€æ€»çº¿ï¼šCPUçš„å¯»å€èƒ½åŠ›ï¼Œå†³å®šäº†å¯ç›´æ¥å¯»å€çš„å†…å­˜ç©ºé—´å¤§å°</li><li>æ§åˆ¶æ€»çº¿ï¼šä¼ é€æ§åˆ¶ä¿¡å·å’Œæ—¶åºä¿¡å·ï¼ˆè¯»å†™ä¿¡å·ã€ç‰‡é€‰ä¿¡å·ã€ä¸­æ–­å“åº”ä¿¡å·ï¼‰</li><li>æ•°æ®æ€»çº¿ï¼šæ•°æ®ä¼ é€èƒ½åŠ›ã€‚CPU-&gt;å†…å­˜/IO å†…å­˜/IO -&gt;CPUå‡å¯ï¼ŒåŒå‘ä¸‰æ€å½¢</li></ul><h3 id="64ä½å’Œ32ä½CPUçš„å®è´¨åŒºåˆ«ï¼Ÿ"><strong>64ä½å’Œ32ä½CPUçš„å®è´¨åŒºåˆ«ï¼Ÿ</strong></h3><p>64 ä½ CPU æ˜¯æŒ‡ CPU å†…éƒ¨çš„<strong>é€šç”¨å¯„å­˜å™¨</strong>çš„å®½åº¦ä¸º 64 æ¯”ç‰¹ï¼Œæ”¯æŒæ•´æ•°çš„ 64 æ¯”ç‰¹å®½åº¦çš„ç®—æœ¯ä¸é€»è¾‘è¿ç®—</p><ul><li>æ•°æ®å¤„ç†èƒ½åŠ›å¢å¼ºï¼š64 ä½ CPU é€šç”¨å¯„å­˜å™¨çš„ä½å®½å¢åŠ ä¸€å€ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€ 64 ä½ CPU å¯ä»¥ä¸€æ¬¡æ€§å¤„ç† 64bit çš„æ•´å½¢æ•°æ®ï¼›</li><li>å†…å­˜å¯»å€èƒ½åŠ›å¢å¼ºï¼šå¦‚æœæ˜¯ 32 ä½ CPU çš„è¯ï¼Œå®ƒçš„åœ°å€æ€»çº¿æœ€å¤šä¸ä¼šè¶…è¿‡ 32ï¼Œé‚£ä¹ˆå®ƒæ‰€èƒ½è¾¾åˆ°çš„å¯»å€èŒƒå›´ä¹Ÿå°±ä¸ä¼šè¶…è¿‡ 2 çš„ 32 æ¬¡æ–¹å­—èŠ‚ï¼ˆå­˜å‚¨å•å…ƒä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ï¼Œä¹Ÿå°±æ˜¯ 4GBï¼Œè€Œå¦‚æœæ˜¯ 64 ä½å¤„ç†å™¨çš„è¯ï¼Œå®ƒæ‰€èƒ½è¾¾åˆ°çš„å¯»å€èŒƒå›´<strong>ç†è®ºä¸Š</strong>å°±ä¼šæ˜¯ 2 çš„ 64 æ¬¡æ–¹å­—èŠ‚ï¼ˆä¸Šäº¿ GBï¼‰ã€‚</li></ul><div class="note note-success">            <p>ä¸€èˆ¬å¤„ç†å™¨å¤šå°‘ä½æ˜¯æŒ‡é€šç”¨å¯„å­˜å™¨çš„é•¿åº¦ï¼Œå½“ç„¶æ•°æ®çº¿éœ€è¦ä¸ä¹‹ç›¸åŒï¼›åœ°å€çº¿åˆ™ä¸éœ€è¦ä¸ä¹‹ç›¸ç­‰ï¼Œå¥½æ¯” intel 64 ä½å¤„ç†å™¨åˆ™æ˜¯ 40 ä½åœ°å€æ€»çº¿ï¼Œæœ€å¤§æ”¯æŒ 1TB çš„å†…å­˜å¯»å€ã€‚</p>          </div><p>æ³¨æ„äº†ï¼Œ64ä½æ“ä½œç³»ç»Ÿåªèƒ½è¿è¡Œåœ¨64ä½CPUä¸Š</p><p><strong>64ä½CPUè£…äº†32ä½æ“ä½œç³»ç»Ÿåå¯»å€èƒ½åŠ›ä¸ºä»€ä¹ˆæ˜¯4GB</strong></p><p>32ä½æ“ä½œç³»ç»Ÿæ²¡æœ‰å¯¹åº”çš„64ä½çš„å¯»å€æŒ‡ä»¤ï¼Œä¸èƒ½æä¾›4GBä»¥ä¸Šçš„é€»è¾‘åœ°å€</p><h3 id="GPUå’ŒCPUçš„åŒºåˆ«"><strong>GPUå’ŒCPUçš„åŒºåˆ«</strong></h3><p>CPUéœ€è¦å¾ˆå¼ºçš„<strong>é€šç”¨æ€§</strong>æ¥å¤„ç†å„ç§ä¸åŒçš„æ•°æ®ç±»å‹ï¼ŒåŒæ—¶åˆè¦é€»è¾‘åˆ¤æ–­åˆä¼šå¼•å…¥å¤§é‡çš„åˆ†æ”¯è·³è½¬å’Œä¸­æ–­çš„å¤„ç†ã€‚è¿™äº›éƒ½ä½¿å¾—CPUçš„å†…éƒ¨ç»“æ„å¼‚å¸¸å¤æ‚ã€‚</p><p>è€ŒGPUé¢å¯¹çš„åˆ™æ˜¯<strong>ç±»å‹é«˜åº¦ç»Ÿä¸€çš„</strong>ã€<strong>ç›¸äº’æ— ä¾èµ–</strong>çš„å¤§è§„æ¨¡æ•°æ®å’Œä¸éœ€è¦è¢«æ‰“æ–­çš„<strong>çº¯å‡€çš„è®¡ç®—ç¯å¢ƒ</strong>ã€‚</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211026212402274.png" alt="image-20211026212402274"></p><p>GPUé‡‡ç”¨äº†æ•°é‡ä¼—å¤šçš„è®¡ç®—å•å…ƒå’Œè¶…é•¿çš„æµæ°´çº¿ï¼Œä½†åªæœ‰éå¸¸ç®€å•çš„æ§åˆ¶é€»è¾‘å¹¶çœå»äº†Cacheã€‚<br>CPUä¸ä»…è¢«Cacheå æ®äº†å¤§é‡ç©ºé—´ï¼Œè€Œä¸”è¿˜æœ‰æœ‰å¤æ‚çš„æ§åˆ¶é€»è¾‘å’Œè¯¸å¤šä¼˜åŒ–ç”µè·¯ï¼Œç›¸æ¯”ä¹‹ä¸‹è®¡ç®—èƒ½åŠ›åªæ˜¯CPUå¾ˆå°çš„ä¸€éƒ¨åˆ†</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211026212600405.png" alt="image-20211026212600405"></p><p>**Cache, local memoryï¼š CPU &gt; GPU **<br><strong>Threads(çº¿ç¨‹æ•°): GPU &gt; CPU</strong><br>Registers: GPU &gt; CPU  å¤šå¯„å­˜å™¨å¯ä»¥æ”¯æŒéå¸¸å¤šçš„Thread,threadéœ€è¦ç”¨åˆ°register,threadæ•°ç›®å¤§ï¼Œregisterä¹Ÿå¿…é¡»å¾—è·Ÿç€å¾ˆå¤§æ‰è¡Œã€‚<br>SIMD Unit(å•æŒ‡ä»¤å¤šæ•°æ®æµ,ä»¥åŒæ­¥æ–¹å¼ï¼Œåœ¨åŒä¸€æ—¶é—´å†…æ‰§è¡ŒåŒä¸€æ¡æŒ‡ä»¤): GPU &gt; CPUã€‚</p><ul><li>CPUæ—¶å»¶ä½ï¼šæœ‰å¼ºå¤§çš„ALUï¼ˆç®—æœ¯è¿ç®—å•å…ƒï¼‰,å®ƒå¯ä»¥åœ¨å¾ˆå°‘çš„æ—¶é’Ÿå‘¨æœŸå†…å®Œæˆç®—æœ¯è®¡ç®—ã€‚æ—¶é’Ÿå‘¨æœŸçš„é¢‘ç‡éå¸¸é«˜ã€‚å¤æ‚çš„é€»è¾‘æ§åˆ¶å•å…ƒå¯ä»¥ç¡®ä¿å½“ç¨‹åºå«æœ‰å¤šä¸ªåˆ†æ”¯çš„æ—¶å€™ï¼Œå®ƒé€šè¿‡æä¾›åˆ†æ”¯é¢„æµ‹çš„èƒ½åŠ›æ¥é™ä½å»¶æ—¶ã€‚</li><li>GPUåŸºäºå¤§çš„ååé‡è®¾è®¡ï¼šGPUçš„ç‰¹ç‚¹æ˜¯æœ‰<strong>å¾ˆå¤šçš„ALU</strong>å’Œå¾ˆå°‘çš„cache. ç¼“å­˜çš„ç›®çš„ä¸æ˜¯ä¿å­˜åé¢éœ€è¦è®¿é—®çš„æ•°æ®çš„ï¼Œè¿™ç‚¹å’ŒCPUä¸åŒï¼Œè€Œæ˜¯ä¸ºthreadæé«˜æœåŠ¡çš„ã€‚å¦‚æœæœ‰å¾ˆå¤šçº¿ç¨‹éœ€è¦è®¿é—®åŒä¸€ä¸ªç›¸åŒçš„æ•°æ®ï¼Œç¼“å­˜ä¼šåˆå¹¶è¿™äº›è®¿é—®ï¼Œç„¶åå†å»è®¿é—®dramï¼ˆå› ä¸ºéœ€è¦è®¿é—®çš„æ•°æ®ä¿å­˜åœ¨dramä¸­è€Œä¸æ˜¯cacheé‡Œé¢ï¼‰ï¼Œè·å–æ•°æ®åcacheä¼šè½¬å‘è¿™ä¸ªæ•°æ®ç»™å¯¹åº”çš„çº¿ç¨‹ï¼Œè¿™ä¸ªæ—¶å€™æ˜¯æ•°æ®è½¬å‘çš„è§’è‰²ã€‚ä½†æ˜¯ç”±äºéœ€è¦è®¿é—®dramï¼Œè‡ªç„¶ä¼šå¸¦æ¥å»¶æ—¶çš„é—®é¢˜ã€‚</li></ul><p>CPUæ“…é•¿é€»è¾‘æ§åˆ¶ï¼Œä¸²è¡Œçš„è¿ç®—ã€‚å’Œé€šç”¨ç±»å‹æ•°æ®è¿ç®—ä¸åŒï¼ŒGPUæ“…é•¿çš„æ˜¯å¤§è§„æ¨¡å¹¶å‘è®¡ç®—</p><p>GPUå¤§éƒ¨åˆ†å·¥ä½œè®¡ç®—é‡å¤§ï¼Œæ²¡å•¥æŠ€æœ¯å«é‡ï¼Œé‡å¤å¾ˆå¤šæ¬¡ã€‚å¹¶è¡Œè®¡ç®—ï¼ˆæµæ°´çº¿ï¼Œæ— æ³•å•ç‹¬å·¥ä½œï¼Œå¿…é¡»ç”±cpuæ§åˆ¶ï¼‰</p><p>å‚è€ƒ <a href="https://www.zhihu.com/question/19903344">çŸ¥ä¹</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>è€ƒç ”</tag>
      
      <tag>è®¡ç®—æœºåŸç†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸€äº›ç‚¹å­</title>
    <link href="/2021/10/16/%E4%B8%80%E4%BA%9B%E7%82%B9%E5%AD%90/"/>
    <url>/2021/10/16/%E4%B8%80%E4%BA%9B%E7%82%B9%E5%AD%90/</url>
    
    <content type="html"><![CDATA[<h1>ä¸€äº›ç‚¹å­</h1><h2 id="ç”µå½±å°è¯åå°">ç”µå½±å°è¯åå°</h2><div class="note note-info">            <p>123ss3dsdaaaaa</p>          </div><p class="note note-primary">æ ‡ç­¾</p><p>ä¸ºhexo fluidçš„é¦–é¡µtextæ•´ä¸ªåå°ï¼Œèƒ½å¤Ÿéšæœºæä¾›ç”µå½±å°è¯ã€‚æä¸Šæ—¥ç¨‹ï¼<br>ç±»ä¼¼å‚è€ƒï¼š ä¸€è¨€<br>123123<br>123123<br>123123123</p>]]></content>
    
    
    
    <tags>
      
      <tag>æƒ³æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>opencvå­¦ä¹ </title>
    <link href="/2021/10/15/opencv%E5%AD%A6%E4%B9%A0/"/>
    <url>/2021/10/15/opencv%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1>Opencvå­¦ä¹ </h1><span id="more"></span><h2 id="å®‰è£…ç¯å¢ƒ">å®‰è£…ç¯å¢ƒ</h2><ol><li><p>pip</p></li><li><p>anaconda</p></li><li><p>numpy</p></li><li><p>pycharmæˆ–è€…vscode</p><p>è¿™é‡Œæˆ‘ä½¿ç”¨vscodeå’Œanacondaè‡ªå¸¦çš„IDE spyderéƒ½æœ‰ä¸€å®šé—®é¢˜ï¼ŒåŸå› è¦ä¹ˆæ˜¯æ²¡æœ‰é€‰æ‹©å¥½é€‚å½“çš„Interpreterè¦ä¹ˆæ˜¯æ²¡æœ‰åœ¨å½“å‰ç»ˆç«¯ä¸‹pip install opencv-pythonã€‚</p><p>ä½¿ç”¨</p><p>ä½¿ç”¨pycharmåï¼Œç›´æ¥åœ¨terminalä¸­install opencv-pythonï¼Œç„¶åå†å»settingsä¸­æ›´æ”¹intepreterçš„ç¼–è¯‘å™¨ï¼Œæ¢æˆopencv-pythonå°±è§£å†³é—®é¢˜</p></li></ol><h2 id="æŒ‡ä»¤-v2">æŒ‡ä»¤</h2><h3 id="ç”»å›¾">ç”»å›¾</h3><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">canvas <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">"uint8"</span><span class="token punctuation">)</span> <span class="token comment"># æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</span></code></pre></div><p>dtypeä¸ºä»€ä¹ˆæ˜¯uint8ï¼Ÿ</p><p>np.random.randint sizeæŒ‡å®šä¸º3ï¼Œä¸ºä»€ä¹ˆä¸èƒ½ç”Ÿæˆä¸‰ä¸ªæ•°ç»„</p><p><strong>å°ä¾‹å­ï¼šç‚¹å‡»éšæœºäº§ç”Ÿåœ†</strong></p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> cv2<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token comment"># å½“é¼ æ ‡æŒ‰ä¸‹æ—¶å˜ä¸ºTrue</span>drawing<span class="token operator">=</span><span class="token boolean">False</span><span class="token comment"># å¦‚æœmode ä¸ºtrue ç»˜åˆ¶çŸ©å½¢ã€‚æŒ‰ä¸‹'m' å˜æˆç»˜åˆ¶æ›²çº¿ã€‚</span>mode<span class="token operator">=</span><span class="token boolean">True</span>ix<span class="token punctuation">,</span>iy<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token comment"># åˆ›å»ºå›è°ƒå‡½æ•°</span><span class="token keyword">def</span> <span class="token function">draw_circle</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>flags<span class="token punctuation">,</span>param<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">global</span> ix<span class="token punctuation">,</span>iy<span class="token punctuation">,</span>drawing<span class="token punctuation">,</span>mode    <span class="token comment"># å½“æŒ‰ä¸‹å·¦é”®æ˜¯è¿”å›èµ·å§‹ä½ç½®åæ ‡</span>    <span class="token keyword">if</span> event<span class="token operator">==</span>cv2<span class="token punctuation">.</span>EVENT_LBUTTONDOWN<span class="token punctuation">:</span>        drawing<span class="token operator">=</span><span class="token boolean">True</span>        ix<span class="token punctuation">,</span>iy<span class="token operator">=</span>x<span class="token punctuation">,</span>y    <span class="token comment"># å½“é¼ æ ‡å·¦é”®æŒ‰ä¸‹å¹¶ç§»åŠ¨æ˜¯ç»˜åˆ¶å›¾å½¢ã€‚event å¯ä»¥æŸ¥çœ‹ç§»åŠ¨ï¼Œflag æŸ¥çœ‹æ˜¯å¦æŒ‰ä¸‹</span>    <span class="token keyword">elif</span> event<span class="token operator">==</span>cv2<span class="token punctuation">.</span>EVENT_MOUSEMOVE <span class="token keyword">and</span> flags<span class="token operator">==</span>cv2<span class="token punctuation">.</span>EVENT_FLAG_LBUTTON<span class="token punctuation">:</span>        <span class="token keyword">if</span> drawing<span class="token operator">==</span><span class="token boolean">True</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> mode<span class="token operator">==</span><span class="token boolean">True</span><span class="token punctuation">:</span>                cv2<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span>img<span class="token punctuation">,</span><span class="token punctuation">(</span>ix<span class="token punctuation">,</span>iy<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                r<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token operator">-</span>ix<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token operator">+</span><span class="token punctuation">(</span>y<span class="token operator">-</span>iy<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                cv2<span class="token punctuation">.</span>circle<span class="token punctuation">(</span>img<span class="token punctuation">,</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token comment"># å½“é¼ æ ‡æ¾å¼€åœæ­¢ç»˜ç”»ã€‚</span>    <span class="token keyword">elif</span> event<span class="token operator">==</span>cv2<span class="token punctuation">.</span>EVENT_LBUTTONUP<span class="token punctuation">:</span>        <span class="token keyword">if</span> mode<span class="token operator">==</span><span class="token boolean">True</span><span class="token punctuation">:</span>            cv2<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span>img<span class="token punctuation">,</span><span class="token punctuation">(</span>ix<span class="token punctuation">,</span>iy<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            cv2<span class="token punctuation">.</span>circle<span class="token punctuation">(</span>img<span class="token punctuation">,</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>img<span class="token operator">=</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">,</span><span class="token number">512</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>cv2<span class="token punctuation">.</span>namedWindow<span class="token punctuation">(</span><span class="token string">'image'</span><span class="token punctuation">)</span>cv2<span class="token punctuation">.</span>setMouseCallback<span class="token punctuation">(</span><span class="token string">'image'</span><span class="token punctuation">,</span>draw_circle<span class="token punctuation">)</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'image'</span><span class="token punctuation">,</span>img<span class="token punctuation">)</span>    k<span class="token operator">=</span>cv2<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">0xFF</span>    <span class="token keyword">if</span> k<span class="token operator">==</span><span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'m'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        mode<span class="token operator">=</span><span class="token keyword">not</span> mode    <span class="token keyword">elif</span> k<span class="token operator">==</span><span class="token number">27</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>cv2<span class="token punctuation">.</span>destroyAllWindows<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div><h3 id="å›¾åƒå¤„ç†">å›¾åƒå¤„ç†</h3><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># å›¾åƒalphaå åŠ </span>dst<span class="token operator">=</span>cv2<span class="token punctuation">.</span>addWeighted<span class="token punctuation">(</span>img1<span class="token punctuation">,</span><span class="token number">0.7</span><span class="token punctuation">,</span>img2<span class="token punctuation">,</span><span class="token number">0.3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token comment"># resizeå›¾ç‰‡</span>img1<span class="token operator">=</span>cv2<span class="token punctuation">.</span>resize<span class="token punctuation">(</span>img1<span class="token punctuation">,</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span>height<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># åŠ äº®ã€å‡æš—å›¾ç‰‡</span>cv2<span class="token punctuation">.</span>add<span class="token punctuation">(</span>img<span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">)</span>cv2<span class="token punctuation">,</span>substract<span class="token punctuation">(</span>img<span class="token punctuation">.</span><span class="token number">8</span><span class="token operator">-</span><span class="token punctuation">)</span></code></pre></div>]]></content>
    
    
    
    <tags>
      
      <tag>Study</tag>
      
      <tag>Visual</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Pythonå­¦ä¹ </title>
    <link href="/2021/10/15/Python%E5%AD%A6%E4%B9%A0/"/>
    <url>/2021/10/15/Python%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1>Pythonå­¦ä¹ </h1><blockquote><p>å†…å¿ƒå¾ˆå•çº¯ï¼š80%æƒ³å­¦çˆ¬è™« + 10%æƒ³å­¦æ•°æ®å¤„ç† + 10%åç«¯æ­å»º</p></blockquote><h2 id="å…¥é—¨-v2">å…¥é—¨</h2><h3 id="è¯­æ³•åŸºç¡€">è¯­æ³•åŸºç¡€</h3><p><strong>æ ‡è¯†ç¬¦</strong></p><p>ä»¥ä¸‹åˆ’çº¿å¼€å¤´çš„æ ‡è¯†ç¬¦æ˜¯æœ‰ç‰¹æ®Šæ„ä¹‰çš„ã€‚ä»¥å•ä¸‹åˆ’çº¿å¼€å¤´ <strong>_foo</strong> çš„ä»£è¡¨ä¸èƒ½ç›´æ¥è®¿é—®çš„ç±»å±æ€§ï¼Œéœ€é€šè¿‡ç±»æä¾›çš„æ¥å£è¿›è¡Œè®¿é—®ï¼Œä¸èƒ½ç”¨ <strong>from xxx import *</strong> è€Œå¯¼å…¥ã€‚</p><span id="more"></span><p>ä»¥åŒä¸‹åˆ’çº¿å¼€å¤´çš„ <strong>__foo</strong> ä»£è¡¨ç±»çš„ç§æœ‰æˆå‘˜ï¼Œä»¥åŒä¸‹åˆ’çº¿å¼€å¤´å’Œç»“å°¾çš„ <strong>__ foo __</strong> ä»£è¡¨ Python é‡Œç‰¹æ®Šæ–¹æ³•ä¸“ç”¨çš„æ ‡è¯†ï¼Œå¦‚ <strong>__ init __()</strong> ä»£è¡¨ç±»çš„æ„é€ å‡½æ•°ã€‚</p><p><strong>æœ€å¤§åŒºåˆ«: {}</strong></p><p>Pythonä»£ç å—ä¸ç”¨{}æ¥æ§åˆ¶é€»è¾‘åˆ¤æ–­ï¼Œä½¿ç”¨ç¼©è¿›è¡Œæ¥å†™æ¨¡å—</p><p>pythonå¯¹æ ¼å¼çš„è¦æ±‚ååˆ†ä¸¥æ ¼,ç©ºç™½ä¹Ÿæ˜¯ç¨‹åºä»£ç çš„ä¸€éƒ¨åˆ†</p><p>ç¼©è¿›è¡Œçš„ç©ºæ ¼å¯å˜ï¼Œä½†æ‰€æœ‰ä»£ç å—çš„è¯­å¥å¿…é¡»åŒ…å«ç›¸åŒçš„ç¼©è¿›ç©ºç™½æ•°é‡ï¼ˆæ²¡æœ‰ä¸¥æ ¼ç¼©è¿›æ—¶ï¼Œæ‰§è¡Œæ—¶ä¼šæŠ¥é”™ï¼‰</p><p>å¦‚æœè¦ä½¿ç”¨å¤šè¡Œæ¥è¡¨ç¤ºä¸€è¡Œçš„è¯ï¼Œéœ€è¦ä»¥ \ æ¥è¡¨ç¤º</p><p><strong>å¼•å·</strong></p><p>Pythonä¹Ÿå¯ä»¥ç”¨â€™ â€™  , &quot; &quot; ,â€œâ€&quot; â€œâ€&quot;æ¥è¡¨ç¤ºå­—ç¬¦ä¸²ã€‚æœŸæœŸä¸­ä¸‰å¼•å·å¯ä»¥ç”±å¤šè¡Œç»„æˆ</p><p><strong>æ³¨é‡Š</strong></p><p>pythonç”¨# æ¥è¡¨ç¤ºå•è¡Œæ³¨é‡Šã€‚</p><p>ç”¨â€™â€˜â€™ xxx â€˜â€™â€™  æˆ–è€… â€œâ€&quot; xxx â€œâ€&quot;æ¥è¡¨ç¤ºå¤šè¡Œæ³¨é‡Š</p><p><strong>è¾“å‡º</strong></p><p>printçš„è¾“å‡ºé»˜è®¤æ˜¯æ¢è¡Œçš„ï¼Œå¦‚æœéœ€è¦ä¸æ¢è¡Œéœ€è¦åœ¨å˜é‡çš„æœ«å°¾åŠ  ,</p><p><strong>èµ‹å€¼</strong></p><p>pythonå¯ä»¥ä¸ºå¤šä¸ªå˜é‡åŒæ—¶èµ‹å€¼</p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">a<span class="token operator">=</span>b<span class="token operator">=</span>c<span class="token operator">=</span><span class="token number">1</span><span class="token comment"># è¿™ç§èµ‹å€¼æ–¹å¼å°±ç¦»è°±</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'john'</span><span class="token comment"># æ¯”è¾ƒæœ‰è¶£çš„ç°è±¡ ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œä¼šæ‰“å°å‡ºaçš„ç»“æœ</span><span class="token comment"># å¯èƒ½è·Ÿpythonå¯¹è±¡åˆ›å»ºæœ‰å…³ç³»</span>a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>b <span class="token operator">=</span> a<span class="token keyword">del</span> a<span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span></code></pre></div><h3 id="æ•°æ®ç±»å‹">æ•°æ®ç±»å‹</h3><p>Pythonä¸­åŒä¸€ä¸ªå˜é‡å¯ä»¥åå¤èµ‹å€¼ï¼Œå¹¶ä¸”å¯ä»¥æ˜¯<strong>ä¸åŒç±»å‹çš„</strong></p><ul><li><p>numbers æ•°å­—</p><ul><li><p>ä¸å¯å˜ï¼Œå¦‚æœæ”¹å˜ä¸€ä¸ªæ•°å­—ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡</p></li><li><p>æŒ‡å®šä¸€ä¸ªå€¼æ—¶ï¼Œä¸€ä¸ªnumberå¯¹è±¡å°±è¢«åˆ›å»º</p></li><li><p>å¯é€šè¿‡delè¯­å¥åˆ é™¤ä¸€äº›å¯¹è±¡çš„å¼•ç”¨</p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">del</span> x<span class="token punctuation">,</span>b</code></pre></div></li><li><p>pythonæ”¯æŒå››ç§ç±»å‹çš„æ•°å­—ç±»å‹int long float <strong>complex(å¤æ•°)</strong></p></li></ul></li><li><p>string</p><ul><li><p>å­—ç¬¦ä¸²åˆ—è¡¨æœ‰ä¸¤ç§å–å€¼é¡ºåºï¼Œå·¦åˆ°å³å’Œå³åˆ°å·¦</p><ul><li>å·¦åˆ°å³  0å¼€å§‹</li><li>å³åˆ°å·¦  æœ€å·¦è¾¹æ˜¯-1ï¼Œæœ€å³è¾¹æ˜¯ -str.length</li></ul></li><li><p>ä»å­—ç¬¦ä¸²ä¸­è·å–ä¸€æ®µå­å­—ç¬¦ã€‚s[startIndex:endIndex] ä¸€æ ·æ˜¯å·¦é—­å³å¼€å½¢å¼ï¼Œä¸å†™endIndexç›¸å½“äºä¸€ç›´åˆ°æœ«å°¾ã€‚è¿˜å¯ä»¥æœ‰ä¸€ä¸ªå‚æ•°ä»£è¡¨æ­¥é•¿[startIndex:endIndex:interval]ã€‚<strong>æ­¥é•¿ä¸º1å°±æ˜¯æ­£å¸¸é€‰å–</strong></p></li><li><p>å­—ç¬¦ä¸²é‡å¤ å¯ä»¥ç”¨* è¡¨ç¤ºï¼Œç±»ä¼¼ä¹˜æ³•; å­—ç¬¦ä¸²åŠ æ³•ç”¨ +</p></li><li><p>python<strong>ä¸æ”¯æŒå•å­—ç¬¦ç±»å‹</strong>ï¼</p></li><li><p>ä½¿ç”¨unicodeå­—ç¬¦ä¸²  a = uâ€™Hello\u0020Worldâ€™</p></li><li><p><a href="https://www.runoob.com/python/python-strings.html">å¯¹å­—ç¬¦ä¸²çš„æ“ä½œå‡½æ•°</a></p></li><li><p>å­—ç¬¦ä¸²æ ¼å¼åŒ–</p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span> <span class="token string">"My name is %s  age is %d"</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token string">'zara'</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span></code></pre></div><p>æ ¼å¼åŒ–ç¬¦å·</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211015195043962.png" alt="image-20211015195043962"></p></li></ul></li><li><p>list</p><ul><li>ç”¨[ ]æ ‡è¯† åˆ—è¡¨ï¼Œåˆ—è¡¨ä¸­ä¹Ÿå¯ä»¥ç”¨[]æ¥è¿›è¡Œåˆ‡å‰²</li><li>åˆ—è¡¨çš„å…ƒç´ å¯ä»¥å¤šç§å¤šæ ·</li><li>list = [] list.append ;  del list[2]æ¥åˆ é™¤</li><li>æˆªå–ï¼š name[0:i]ï¼Œå·¦é—­åˆå¼€</li><li><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220419214955397.png" alt="image-20220419214955397"></li></ul></li><li><p>tupleï¼ˆå…ƒç»„ï¼‰</p><ul><li><p>ç±»ä¼¼Listï¼Œå…ƒç»„å†…ç”¨**( )**æ ‡è¯†ï¼ˆä¹Ÿå¯ä»¥ç›´æ¥ç”¨é€—å·åˆ›å»ºï¼Œä¸ç”¨()ï¼‰ã€‚<strong>ä¸èƒ½äºŒæ¬¡èµ‹å€¼</strong>ï¼Œç›¸å½“äºåªè¯»åˆ—è¡¨-&gt;ä»£ç æ›´å®‰å…¨</p></li><li><p>ä¸€æ ·å¯ä»¥ç”¨[]å»è¿›è¡Œå–å€¼æ“ä½œ</p></li><li><p>å…ƒç»„çš„å€¼ä¸èƒ½ä¿®æ”¹ï¼Œä½†å¯ä»¥å¯¹å…ƒç»„è¿›è¡Œç»„åˆ å³ a = b+cï¼ˆäº§ç”Ÿæ–°çš„å…ƒç»„ï¼‰ï¼Œå¯ä»¥æ˜¯ä¸åŒç±»å‹çš„å…ƒç»„ç»„åˆï¼›è¿˜å¯ä»¥tupleä¸­åŒ…å«listï¼Œå› ä¸ºåªæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œæ‰€ä»¥listå°±å¯ä»¥ä¿®æ”¹äº†</p></li><li><p>ä¸€äº›æ¯”è¾ƒéªšçš„æ“ä½œç¬¦<img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220419215449198.png" alt="image-20220419215449198"></p></li><li><p>å…ƒç»„ä¸­çš„å…ƒç´ ä¸èƒ½è¢«delæ‰ï¼Œå¦åˆ™ä¼šå¼•ç”¨ç±»å‹æ‰¾ä¸åˆ°çš„é”™è¯¯</p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">x <span class="token operator">=</span> <span class="token string">'a'</span>a <span class="token operator">=</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">del</span> a<span class="token comment"># æŠ¥é”™</span><span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span></code></pre></div></li><li><p>å¦‚ä½•ç†è§£å…ƒç»„ï¼Ÿ</p></li><li><p>å…ƒç»„ä¸­åªåŒ…å«ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œéœ€è¦åœ¨å…ƒç´ åé¢æ·»åŠ é€—å·ï¼Œå¦åˆ™ä¼šè®¤ä¸ºå°±æ˜¯ä¸€ä¸ªå…ƒç´ ï¼ˆè¿™æ˜¯å› ä¸ºæ‹¬å· () æ—¢å¯ä»¥è¡¨ç¤ºå…ƒç»„ï¼ˆtupleï¼‰ï¼Œåˆå¯ä»¥è¡¨ç¤ºæ•°å­¦å…¬å¼ä¸­çš„å°æ‹¬å·ï¼Œè¿™å°±äº§ç”Ÿäº†æ­§ä¹‰ï¼‰</p></li><li><p>opencvä¸­np.random.randintæ€ä¹ˆä¸èƒ½ä½¿ç”¨è¿™ä¸ªï¼Ÿ</p></li></ul></li><li><p>dictionary å­—å…¸</p><ul><li><p>æ— åºï¼Œç±»ä¼¼Map</p></li><li><p>ç±»å‹å¯ä»¥ä¸åŒï¼›åŒä¸€ä¸ªé”®ä¸èƒ½è¢«èµ‹å€¼ä¸¤æ¬¡ï¼ˆåªæœ‰åé¢çš„å€¼ä¼šè¢«è®°ä½ï¼‰</p></li><li><p>Keyå€¼å¿…é¡»ä¸å¯å˜ï¼Œå¯ä»¥æ˜¯æ•°å­—ã€å­—ç¬¦ä¸²ã€å…ƒç»„ï¼Œä½†å°±æ˜¯ä¸èƒ½æ˜¯åˆ—è¡¨</p></li><li><table><thead><tr><th>æ–¹æ³•å’Œå‡½æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>len(dict)</td><td>è®¡ç®—å­—å…¸å…ƒç´ ä¸ªæ•°</td></tr><tr><td>str(dict)</td><td>è¾“å‡ºå­—å…¸å¯æ‰“å°çš„å­—ç¬¦ä¸²è¡¨ç¤º</td></tr><tr><td>type(variable)</td><td>è¿”å›è¾“å…¥çš„å˜é‡ç±»å‹ï¼Œå¦‚æœå˜é‡æ˜¯å­—å…¸å°±è¿”å›å­—å…¸ç±»å‹</td></tr><tr><td>dict.clear()</td><td>åˆ é™¤å­—å…¸å†…æ‰€æœ‰å…ƒç´ </td></tr><tr><td>dict.copy()</td><td>è¿”å›ä¸€ä¸ªå­—å…¸çš„æµ…å¤åˆ¶</td></tr><tr><td>dict.values()</td><td>ä»¥åˆ—è¡¨è¿”å›å­—å…¸ä¸­çš„æ‰€æœ‰å€¼</td></tr><tr><td>popitem()</td><td>éšæœºè¿”å›å¹¶åˆ é™¤å­—å…¸ä¸­çš„ä¸€å¯¹é”®å’Œå€¼</td></tr><tr><td>dict.items()</td><td>ä»¥åˆ—è¡¨è¿”å›å¯éå†çš„(é”®, å€¼) å…ƒç»„æ•°ç»„</td></tr></tbody></table></li><li></li></ul>  <div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">x <span class="token operator">=</span> <span class="token string">'a'</span>a <span class="token operator">=</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token builtin">map</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>x<span class="token punctuation">:</span><span class="token string">'name'</span><span class="token punctuation">&#125;</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># ä¸ä¼šæŠ¥é”™</span>x <span class="token operator">=</span> <span class="token string">'b'</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># æŠ¥é”™ï¼Œxå¿…é¡»ä¸å¯å˜</span></code></pre></div>  <div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">tinydict <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'name'</span> <span class="token punctuation">:</span> <span class="token string">'runoob'</span> <span class="token punctuation">,</span> <span class="token string">'code'</span> <span class="token punctuation">:</span> <span class="token number">3123</span><span class="token punctuation">,</span> <span class="token string">'dept'</span> <span class="token punctuation">:</span> <span class="token string">'sisds'</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">print</span><span class="token punctuation">(</span>tinydict<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>tinydict<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div></li><li><p>set:</p><ul><li>åˆ›å»ºsetï¼Œä»¥æ•°ç»„çš„å½¢å¼ï¼Œset([1,2,3])</li><li>ä¸¤ä¸ªsetå¯ä»¥åšæ•°å­¦æ„ä¹‰ä¸Šçš„äº¤ã€å¹¶ã€å·®é›† &amp; |  -</li></ul></li></ul><p><strong>æ—¶é—´å’Œæ—¥æœŸ</strong></p><p>timeæ¨¡å—</p><ul><li>time.time() : å½“å‰æ—¶é—´æˆ³ã€‚1970åˆ°2038</li><li>æ—¶é—´å…ƒç»„ ã€‚è¯¦ç»†çš„æ•°æ®ç»“æ„ã€‚time.localtime(time.time())<img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211015203004563.png" alt="image-20211015203004563"></li><li>æ ¼å¼åŒ–æ—¶é—´  time.asctime(time.localtime(time.time())).;<br>æˆ–è€…time.strftime(format[, t ])  ä¾‹å¦‚print time.strftime(â€œ%Y-%m-%d %H:%M:%Sâ€, time.localtime())<ul><li>%y ä¸¤ä½æ•°çš„å¹´ä»½è¡¨ç¤ºï¼ˆ00-99ï¼‰</li><li>%Y å››ä½æ•°çš„å¹´ä»½è¡¨ç¤ºï¼ˆ000-9999ï¼‰</li><li>%m æœˆä»½ï¼ˆ01-12ï¼‰</li><li>%d æœˆå†…ä¸­çš„ä¸€å¤©ï¼ˆ0-31ï¼‰</li><li>%H 24å°æ—¶åˆ¶å°æ—¶æ•°ï¼ˆ0-23ï¼‰</li><li>%I 12å°æ—¶åˆ¶å°æ—¶æ•°ï¼ˆ01-12ï¼‰</li><li>%M åˆ†é’Ÿæ•°ï¼ˆ00-59ï¼‰</li><li>%S ç§’ï¼ˆ00-59ï¼‰</li><li>%a æœ¬åœ°ç®€åŒ–æ˜ŸæœŸåç§°</li><li>%A æœ¬åœ°å®Œæ•´æ˜ŸæœŸåç§°</li><li>%b æœ¬åœ°ç®€åŒ–çš„æœˆä»½åç§°</li><li>%B æœ¬åœ°å®Œæ•´çš„æœˆä»½åç§°</li><li>%c æœ¬åœ°ç›¸åº”çš„æ—¥æœŸè¡¨ç¤ºå’Œæ—¶é—´è¡¨ç¤º</li><li>%j å¹´å†…çš„ä¸€å¤©ï¼ˆ001-366ï¼‰</li><li>%p æœ¬åœ°A.M.æˆ–P.M.çš„ç­‰ä»·ç¬¦</li><li>%U ä¸€å¹´ä¸­çš„æ˜ŸæœŸæ•°ï¼ˆ00-53ï¼‰æ˜ŸæœŸå¤©ä¸ºæ˜ŸæœŸçš„å¼€å§‹</li><li>%w æ˜ŸæœŸï¼ˆ0-6ï¼‰ï¼Œæ˜ŸæœŸå¤©ä¸ºæ˜ŸæœŸçš„å¼€å§‹</li><li>%W ä¸€å¹´ä¸­çš„æ˜ŸæœŸæ•°ï¼ˆ00-53ï¼‰æ˜ŸæœŸä¸€ä¸ºæ˜ŸæœŸçš„å¼€å§‹</li><li>%x æœ¬åœ°ç›¸åº”çš„æ—¥æœŸè¡¨ç¤º</li><li>%X æœ¬åœ°ç›¸åº”çš„æ—¶é—´è¡¨ç¤º</li><li>%Z å½“å‰æ—¶åŒºçš„åç§°</li><li>%% %å·æœ¬èº«</li></ul></li><li>è·å–æŸæœˆæ—¥å†  calendaræ¨¡å—  calendar.month(year,month)</li></ul><p><strong>æ•°æ®ç±»å‹è½¬æ¢</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220419214323823.png" alt="image-20220419214323823"></p><h3 id="æ§åˆ¶å‡½æ•°">æ§åˆ¶å‡½æ•°</h3><ul><li><p>if:  elif:  else:</p><ul><li>å¯ä»¥æœ‰æ‹¬å·ã€‚å¿…é¡»æœ‰å¼•å·  <strong>:</strong></li><li>0 å’Œ None å’Œ ç©ºï¼ˆæ•°ç»„ å…ƒç¥– å­—ç¬¦ä¸²ï¼ˆâ€œâ€ï¼‰ï¼‰ä¸º false  é0 å’ŒNotNoneä¸ºTrue</li><li><strong>ifçš„æ¡ä»¶åˆ¤æ–­ä¸ºand or è€Œä¸æ˜¯&amp;&amp; ||</strong></li></ul></li><li><p>å¾ªç¯è¯­å¥</p><ul><li><p>for:</p><ul><li>pyä¸­æ²¡æœ‰for(int i = 0; i &lt; x; i++)çš„è¯­æ³•ï¼å¯ä»¥æ­é…for i in range(number)æ¥ä½¿ç”¨ï¼Œrangeä¹Ÿå¯ä»¥å®ç°æ­¥é•¿é€’å¢</li><li>å½“ç„¶continue å’Œ breakè¯­å¥éƒ½å¯ä»¥ç”¨</li><li><strong>passè¯­å¥</strong>: ä¸åšä»»ä½•äº‹æƒ…ï¼Œåšå ä½è¯­å¥ï¼ˆå®šä½ä¸€ä¸ªç©ºå‡½æ•°æ—¶ç¨‹åºä¼šæŠ¥é”™ï¼Œå½“æ²¡æœ‰æƒ³å¥½å†…å®¹å°±å¯ä»¥å¡«è¿™ä¸ªï¼‰</li></ul></li><li><p>while:</p></li><li><p>for else / while elseï¼šelseä¸­çš„è¯­å¥ä¼šåœ¨<strong>å¾ªç¯æ­£å¸¸å®Œæˆåæ‰§è¡Œ</strong>ï¼Œè€Œä¸æ˜¯é€šè¿‡breakä¸­æ–­çš„</p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">:</span>        <span class="token keyword">break</span><span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"aaa"</span><span class="token punctuation">)</span><span class="token comment"># print nothing!</span></code></pre></div></li></ul></li></ul><h3 id="è¿ç®—ç¬¦-v2">è¿ç®—ç¬¦</h3><p>a**b :  è¿”å›xçš„yæ¬¡å¹‚</p><p>a//b ï¼šå–æ•´æ•°-è¿”å›å•†çš„æ•´æ•°éƒ¨åˆ†.</p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token number">9</span> <span class="token operator">//</span> <span class="token number">2</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span><span class="token operator">-</span><span class="token number">9</span> <span class="token operator">//</span>  <span class="token number">2</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">;</span><span class="token comment"># æ³¨æ„ï¼Œæ˜¯å‘ä¸‹å–æ•´</span></code></pre></div><p><strong>é€»è¾‘è¿ç®—ç¬¦</strong></p><p>è¿˜å¯ä»¥ç”¨and or   not(notè¿”å›å¸ƒå°”å€¼)</p><p><strong>æˆå‘˜è¿ç®—ç¬¦</strong></p><p>in     not inï¼Œ æ˜¯å¦åœ¨ä¸€ä¸ªåºåˆ—ä¸­</p><p><strong>èº«ä»½è¿ç®—ç¬¦</strong></p><p>is  is notï¼šåˆ¤æ–­ä¸¤ä¸ªæ ‡è¯†ç¬¦æ˜¯å¦å¼•ç”¨è‡ªä¸€ä¸ªå¯¹è±¡ã€‚<br>x is y , å¦‚æœå¼•ç”¨çš„æ˜¯åŒä¸€å¯¹è±¡åˆ™è¿”å›true</p><hr><p><strong>is å’Œ == çš„åŒºåˆ«</strong></p><ul><li>is åˆ¤æ–­ä¸¤ä¸ªå˜é‡å¼•ç”¨å¯¹è±¡</li><li>== ç”¨äºåˆ¤æ–­å¼•ç”¨å˜é‡çš„å€¼æ˜¯å¦ç›¸ç­‰</li></ul><p><strong>ä¼˜å…ˆçº§</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211015192639987.png" alt="image-20211015192639987"></p><h3 id="å‡½æ•°-v2">å‡½æ•°</h3><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">sum</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token string">"Defint Sum"</span> <span class="token comment"># ç¬¬ä¸€è¡Œå­—ç¬¦ä¸²ç”¨äºå¯¹æ–¹æ³•è¿›è¡Œè§£é‡Š</span>    <span class="token keyword">return</span> a <span class="token operator">+</span>b</code></pre></div><p>ç‹¬ç‰¹çš„ä¼ å‚æ–¹å¼(æ–¹æ³•ä½œä¸ºå‚æ•°)</p><p><strong>ä¸ºä»€ä¹ˆä¼ å‚ä¸èƒ½1920/4 ï¼Œåªèƒ½480?</strong></p><p><strong>å‡½æ•°å¯ä»¥è¿”å›å¤šä¸ªç»“æœï¼è¿™å¯¹æˆ‘æ¥è¯´æ˜¯ä¸å¯æ¥å—çš„</strong>ï¼Œæ­¤æ—¶è¿”å›çš„ä¸ºå…ƒç»„ï¼ï¼ˆå› ä¸ºå…ƒç»„å¯ä»¥ç›´æ¥ç”±é€—å·åˆ›å»ºï¼‰</p><h4 id="å‚æ•°">å‚æ•°</h4><p><strong>è¿‡æ»¤å‡½æ•°ä¼ å‚ç±»å‹</strong></p><p>isinstance(param_name, (tuple)(param_type))ï¼Œtupleä»£è¡¨çš„æ˜¯ä¸€ç³»åˆ—ç¬¦å·è¦æ±‚çš„æ•°æ®ç±»å‹çš„å…ƒç»„</p><p><strong>pythonä¸­å˜é‡æ²¡æœ‰ç±»å‹ï¼Œpythonä¸­ä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡</strong></p><p>a=[1,2,3]  a=â€œRunoobâ€ aä»…ä»…æ˜¯ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼ˆæŒ‡é’ˆï¼‰ï¼Œå¯ä»¥æ˜¯Listå¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æ˜¯Stringå¯¹è±¡</p><p><strong>å…³é”®è¯å‚æ•°å’Œé»˜è®¤å€¼å‚æ•°</strong></p><p>voidA(str, age = 15)    è°ƒç”¨â€”&gt; voidA(str=â€˜asdcâ€™)ï¼ˆageé»˜è®¤æ˜¯15ï¼‰ï¼Œä½†åªèƒ½åœ¨æœ«å°¾å£°æ˜é»˜è®¤å‚æ•°è€Œä¸èƒ½åœ¨å¼€å¤´å£°æ˜ã€‚<br>å…³é”®å€¼å‚æ•°å°±ç›´æ¥å£°æ˜x=â€¦å°±è¡Œäº†</p><ul><li><p>ä¸€ä¸ªå‘ç‚¹ï¼šé»˜è®¤å€¼çš„è®¾ç½®å¿…é¡»æ˜¯ä¸å¯å˜çš„ç±»å‹ï¼Œä¾‹å¦‚å¦‚ä¸‹çš„ä»£ç å°±ä¼šæ®‹ç”Ÿé”™è¯¯çš„ç»“æœï¼Œè®©äºŒæ¬¡è°ƒç”¨åçš„bçš„å€¼åœ¨åˆšè°ƒç”¨æ—¶å°±ä¸ä¸€è‡´</p></li><li><div class="code-wrapper"><pre><code class="language-python">def a(a, b=[]):    print(b)    return bb = a(1)b.append(&quot;123&quot;)print(a(1))# []  ['123']   ['123']<pre class="language-none"><code class="language-none">  * å¦‚ä½•åªæ¥å—å…³é”®å­—å‚æ•°ï¼Ÿåœ¨æƒ³è¦æ¥å—çš„åé¢å‚æ•°å‰åŠ ä¸Š*ï¼Œä¾‹å¦‚functionA(a, * ,b,c)ï¼Œåˆ™b,céƒ½åªèƒ½ä»¥å…³é”®å­—å‚æ•°ä¼ å‚**ä¸å®šé•¿å‚æ•°**def functionA(a,b,c , *vartuple) åŠ æ˜Ÿå·çš„å˜é‡åä¼šå­˜æ”¾æ‰€æœ‰æœªå‘½åçš„å˜é‡å‚æ•°ï¼Œè°ƒç”¨æ—¶å¯ä»¥è¿™æ ·functionA(a,b,c,d,e,f,g)ä¹Ÿå¯ä»¥é‡‡ç”¨å…³é”®å­—å‚æ•°çš„æ–¹æ³•ï¼Œæ­¤æ—¶ä¸º **vartupleï¼Œå¯ä»¥è¿™æ ·è°ƒç”¨functionA(a,b,c,hobby&#x3D;(d,e,f))#### ä¼ å€¼é—®é¢˜&#96;&#96;&#96;pythondef sum2(a):    a &#x3D; 100    return aa &#x3D; 10d &#x3D; sum2(a)print(a)# print 10  not 100</code></pre></div></code></pre></li></ul><p><strong>å¯æ›´æ”¹(mutable)ä¸ä¸å¯æ›´æ”¹(immutable)å¯¹è±¡</strong></p><p>åœ¨ python ä¸­ï¼Œstrings, tuples, å’Œ numbers æ˜¯ä¸å¯æ›´æ”¹çš„å¯¹è±¡ï¼Œè€Œ list,dict ç­‰åˆ™æ˜¯å¯ä»¥ä¿®æ”¹çš„å¯¹è±¡ã€‚</p><ul><li>**ä¸å¯å˜ç±»å‹ï¼š**å˜é‡èµ‹å€¼ <strong>a=5</strong> åå†èµ‹å€¼ <strong>a=10</strong>ï¼Œè¿™é‡Œå®é™…æ˜¯æ–°ç”Ÿæˆä¸€ä¸ª int å€¼å¯¹è±¡ 10ï¼Œå†è®© a æŒ‡å‘å®ƒï¼Œè€Œ 5 è¢«ä¸¢å¼ƒï¼Œä¸æ˜¯æ”¹å˜açš„å€¼ï¼Œç›¸å½“äºæ–°ç”Ÿæˆäº†aã€‚</li><li>**å¯å˜ç±»å‹ï¼š**å˜é‡èµ‹å€¼ <strong>la=[1,2,3,4]</strong> åå†èµ‹å€¼ <strong>la[2]=5</strong> åˆ™æ˜¯å°† list la çš„ç¬¬ä¸‰ä¸ªå…ƒç´ å€¼æ›´æ”¹ï¼Œæœ¬èº«laæ²¡æœ‰åŠ¨ï¼Œåªæ˜¯å…¶å†…éƒ¨çš„ä¸€éƒ¨åˆ†å€¼è¢«ä¿®æ”¹äº†ã€‚</li></ul><p>python å‡½æ•°çš„å‚æ•°ä¼ é€’ï¼š</p><ul><li>**ä¸å¯å˜ç±»å‹ï¼š**ç±»ä¼¼ c++ çš„å€¼ä¼ é€’ï¼Œå¦‚ æ•´æ•°ã€å­—ç¬¦ä¸²ã€å…ƒç»„ã€‚å¦‚funï¼ˆaï¼‰ï¼Œä¼ é€’çš„åªæ˜¯açš„å€¼ï¼Œæ²¡æœ‰å½±å“aå¯¹è±¡æœ¬èº«ã€‚æ¯”å¦‚åœ¨ <strong>funï¼ˆaï¼‰å†…éƒ¨ä¿®æ”¹ a çš„å€¼ï¼Œåªæ˜¯ä¿®æ”¹å¦ä¸€ä¸ªå¤åˆ¶çš„å¯¹è±¡</strong>ï¼Œä¸ä¼šå½±å“ a æœ¬èº«ã€‚</li><li>**å¯å˜ç±»å‹ï¼š**ç±»ä¼¼ c++ çš„å¼•ç”¨ä¼ é€’ï¼Œå¦‚ åˆ—è¡¨ï¼Œå­—å…¸ã€‚å¦‚ funï¼ˆlaï¼‰ï¼Œåˆ™æ˜¯å°† la çœŸæ­£çš„ä¼ è¿‡å»ï¼Œä¿®æ”¹åfunå¤–éƒ¨çš„laä¹Ÿä¼šå—å½±å“</li></ul><p>**åœ¨ Python ä¸­ï¼Œå­—ç¬¦ä¸²ï¼Œæ•´å½¢ï¼Œæµ®ç‚¹å‹ï¼Œtuple æ˜¯ä¸å¯æ›´æ”¹çš„å¯¹è±¡ï¼Œè€Œ list ï¼Œ dict ç­‰æ˜¯å¯ä»¥æ›´æ”¹çš„å¯¹è±¡ã€‚**a =  10å°±æ˜¯å…ˆç”Ÿæˆæ•´å‹å¯¹è±¡10 ï¼Œç„¶å <strong>a æŒ‡å‘ è¿™ä¸ªæ•´å‹å¯¹è±¡</strong>ï¼›è€Œlist = [1,2,3,4], åˆ™listæŒ‡å‘çš„æ˜¯liståœ°å€ï¼Œè€Œa[2] = 5å¹¶ä¸æ˜¯å°†aé‡æ–°æŒ‡å‘ï¼Œè€Œæ˜¯ç›´æ¥æ”¹å˜listä¸­çš„å…ƒç´ å€¼</p><p><strong>åŒ¿åå‡½æ•°</strong></p><p>lamda p1,p2â€¦ :  express</p><div class="code-wrapper"><pre class="language-none"><code class="language-none">sum &#x3D; lambda arg1, arg2,.. : arg1;</code></pre></div><h4 id="ä¸€äº›å‡½æ•°"><strong>ä¸€äº›å‡½æ•°</strong></h4><ul><li>å¦‚æœåœ¨å‡½æ•°å†…éƒ¨è°ƒç”¨ locals()ï¼Œè¿”å›çš„æ˜¯æ‰€æœ‰èƒ½åœ¨è¯¥å‡½æ•°é‡Œè®¿é—®çš„å‘½åã€‚</li><li>å¦‚æœåœ¨å‡½æ•°å†…éƒ¨è°ƒç”¨ globals()ï¼Œè¿”å›çš„æ˜¯æ‰€æœ‰åœ¨è¯¥å‡½æ•°é‡Œèƒ½è®¿é—®çš„å…¨å±€åå­—ã€‚</li><li>dirå‡½æ•°</li><li>reload é‡æ–°åŠ è½½æŸä¸ªæ¨¡å—</li></ul><h3 id="è¿­ä»£å™¨">è¿­ä»£å™¨</h3><p>åªè¦æ˜¯å¯è¿­ä»£çš„å¯¹è±¡ï¼Œä¸ç®¡æœ‰æ²¡æœ‰ä¸‹æ ‡ï¼Œéƒ½å¯ä»¥è¿­ä»£ã€‚å¦‚æœæ˜¯åµŒå¥—çš„å¯è¿­ä»£ï¼Œåˆ™<strong>è¿˜å¯ä»¥è¿›è¡Œå¤šå…ƒçš„è¿­ä»£</strong>ï¼Œæ ¹æ®å…ƒç´ ä¸ªæ•°åˆ¤æ–­æ˜¯å¤–å±‚è¿˜æ˜¯å†…å±‚ï¼</p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token string">'abc'</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token keyword">for</span> x<span class="token punctuation">,</span> y <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token keyword">for</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'v'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token comment"># åŒæ—¶è¿­ä»£å¤šä¸ªåºåˆ— zip()</span><span class="token builtin">list</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>list2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token keyword">for</span> x<span class="token punctuation">,</span> y <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">,</span> list2<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">' $'</span><span class="token punctuation">)</span><span class="token comment"># zipå‡½æ•°è¿˜å¯ä»¥ç”Ÿæˆdict</span><span class="token builtin">dict</span> <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>keys<span class="token punctuation">,</span>values<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div><p>å¯ç”¨iter(x)åˆ›å»ºè¿­ä»£å™¨ï¼Œnext(iter)è¡¨ç¤ºä¸‹ä¸€ä¸ªå…ƒç´ </p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token builtin">list</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token builtin">iter</span> <span class="token operator">=</span> <span class="token builtin">iter</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">iter</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span></code></pre></div><p><strong>Listç”Ÿæˆå¼</strong></p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># å¿«é€Ÿåˆ›å»ºList</span><span class="token builtin">list</span> <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment"># æˆ–ä½¿ç”¨è¡¨è¾¾å¼ï¼š [expr for i in arr if condition]</span><span class="token comment"># condition == Trueæ—¶æ‰åŠ å…¥</span>list1<span class="token operator">=</span><span class="token punctuation">[</span>x <span class="token operator">*</span> x <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token comment"># åµŒå¥—forå¾ªç¯ï¼Œå·¦(å¤–å¾ªç¯) -> å³(å†…å¾ªç¯)</span>list1<span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>x<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>y<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment"># [(1, 1), (1, 2), (1, 3), (1, 4), (1, 5), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (3, 1), (3, 2), (3, 3), (3, 4), (3, 5)]</span></code></pre></div><h4 id="ç”Ÿæˆå™¨"><strong>ç”Ÿæˆå™¨</strong></h4><p>éœ€æ±‚ï¼šå¦‚æœåˆ›å»ºä¸€ä¸ª10000ä¸‡ä¸ªå…ƒç´ çš„åˆ—è¡¨ï¼Œä½†æˆ‘åªè®¿é—®å‡ ä¸ªå€¼ï¼Œé‚£å…ƒç´ å€¼å°±è¢«æµªè´¹äº†ï¼Œæ€æ ·èƒ½èŠ‚çœç©ºé—´ï¼Ÿ</p><p><strong>ç”Ÿæˆå™¨ï¼šä¸€è¾¹å¾ªç¯ä¸€è¾¹è®¡ç®—çš„æœºåˆ¶</strong>ã€‚åˆ—è¡¨ä¸­çš„å…ƒç´ å¯ä»¥æ ¹æ®ç®—æ³•æ¨å‡ºï¼Œåœ¨ å¾ªç¯çš„è¿‡ç¨‹ä¸­ä¸æ–­æ¨ç®—åç»­çš„å…ƒç´ ï¼ŒèŠ‚çœå¤§é‡ç©ºé—´ã€‚</p><p>Pythonä¸­ä½¿ç”¨yieldå‡½æ•°çš„éƒ½å«ç”Ÿæˆå™¨generatorï¼Œç”Ÿæˆå™¨æ˜¯è¿”å›è¿­ä»£å™¨çš„å‡½æ•°</p><p>åˆ›å»ºç”Ÿæˆå™¨ï¼šåˆ—è¡¨ç”Ÿæˆæ—¶çš„[]æ”¹ä¸º().ç”Ÿæˆå™¨å¹¶ä¸çœŸæ­£åˆ›å»ºæ•°å­—åˆ—è¡¨ï¼Œ è€Œæ˜¯è¿”å›ä¸€ä¸ªç”Ÿæˆå™¨ï¼Œè¿™ä¸ªç”Ÿæˆå™¨åœ¨æ¯æ¬¡è®¡ç®—å‡ºä¸€ä¸ªæ¡ç›®åï¼ŒæŠŠè¿™ä¸ªæ¡ç›®â€œäº§ç”Ÿâ€ ( yield ) å‡ºæ¥ã€‚ç”Ÿæˆå™¨è¡¨è¾¾å¼ä½¿ç”¨å»¶æ—¶èµ‹å€¼ï¼Œåªæœ‰åœ¨æ£€ç´¢æ—¶æ‰èµ‹å€¼ã€‚ç”Ÿæˆå™¨è¿”å›çš„è¿­ä»£å™¨åªèƒ½ä½¿ç”¨ä¸€æ¬¡ï¼Œå¹¶æ²¡æœ‰æŠŠæ‰€æœ‰çš„å€¼å­˜åœ¨å†…å­˜ä¸­ï¼Œè€Œæ˜¯<strong>åœ¨è¿è¡Œæ—¶ç”Ÿæˆå€¼</strong>ã€‚ä½ é€šè¿‡éå†æ¥ä½¿ç”¨å®ƒä»¬ï¼Œè¦ä¹ˆç”¨ä¸€ä¸ªâ€œforâ€å¾ªç¯ï¼Œè¦ä¹ˆå°†å®ƒä»¬ä¼ é€’ç»™ä»»æ„å¯ä»¥è¿›è¡Œè¿­ä»£çš„å‡½æ•°å’Œç»“æ„</p><p>ç”Ÿæˆå™¨çš„æœ€å¥½çš„åº”ç”¨åº”è¯¥æ˜¯ï¼šä½ ä¸æƒ³åŒä¸€æ—¶é—´å°†æ‰€æœ‰è®¡ç®—å‡ºæ¥çš„å¤§é‡ç»“æœé›†åˆ†é…åˆ°å†…å­˜å½“ä¸­ï¼Œç‰¹åˆ«æ˜¯ç»“æœé›†é‡Œè¿˜åŒ…å«å¾ªç¯ã€‚å› ä¸ºè¿™æ ·ä¼šè€—å¾ˆå¤§çš„èµ„æº</p><p><strong>å‡½æ•°ä¸­ä½¿ç”¨</strong>ï¼šYield().æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œé‡åˆ°yieldå°±ä¸­æ–­ï¼ˆå¹¶è¿”å›å…¶ä¸­å€¼ï¼Ÿï¼‰ï¼Œä¸‹æ¬¡è°ƒç”¨æ—¶ï¼Œä»ä¸­æ–­çš„yieldå‡½æ•°ä¸­ç»§ç»­æ‰§è¡Œã€‚æ³¨æ„å¯¹é”™è¯¯è¿›è¡Œæ•è·</p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">odd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span> <span class="token punctuation">(</span> <span class="token string">'step 1'</span> <span class="token punctuation">)</span>    <span class="token keyword">yield</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token punctuation">(</span> <span class="token string">'step 2'</span> <span class="token punctuation">)</span>    <span class="token keyword">yield</span> <span class="token punctuation">(</span> <span class="token number">3</span> <span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token punctuation">(</span> <span class="token string">'step 3'</span> <span class="token punctuation">)</span>    <span class="token keyword">yield</span> <span class="token punctuation">(</span> <span class="token number">5</span> <span class="token punctuation">)</span>o <span class="token operator">=</span> odd<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span> <span class="token builtin">next</span><span class="token punctuation">(</span> o <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span> <span class="token builtin">next</span><span class="token punctuation">(</span> o <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span> <span class="token builtin">next</span><span class="token punctuation">(</span> o <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token comment"># step 1 1 step 2 3 step 3 5</span><span class="token comment"># ä½†å¦‚æœç»§ç»­print( next( o ) )å°±ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥é€šå¸¸åœ¨ generator å‡½æ•°ä¸­éƒ½è¦å¯¹é”™è¯¯è¿›è¡Œæ•è·</span></code></pre></div><h3 id="é¢å‘å¯¹è±¡">é¢å‘å¯¹è±¡</h3><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Obj</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    var1 <span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">def</span> <span class="token function">funA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span>Obj<span class="token punctuation">.</span>funA<span class="token punctuation">(</span><span class="token punctuation">)</span> Obj<span class="token punctuation">.</span>var1</code></pre></div><p><strong>å‡å¯ç›´æ¥é€šè¿‡ç±»åç›´æ¥è°ƒç”¨æ–¹æ³•å’Œå±æ€§</strong>ï¼ˆä¼¼ä¹ä¸èƒ½åœ¨ç±»ä¸­ç”¨lambdaå®šä¹‰å‡½æ•°ï¼Ÿï¼‰</p><p><strong>ç±»æ–¹æ³•ä¸­å¦‚ä½•ä½¿ç”¨ç±»çš„å±æ€§</strong></p><p>ä¸èƒ½ç›´æ¥åœ¨æ–¹æ³•ä¸­è°ƒç”¨ç±»çš„å±æ€§ï¼Œæ¯”å¦‚è¦æ·»åŠ æ³¨é‡Š@classmethod å¹¶ä¸”ä¼ å…¥clså˜é‡ï¼ˆåå­—å¯ä»¥è‡ªå·±å–ï¼‰ï¼Œæ‰èƒ½é€šè¿‡clså»ä½¿ç”¨å±æ€§ã€‚<br>å¹¶ä¸”å¯ä»¥é€šè¿‡clsåŠ¨æ€åœ°<strong>åœ¨å†…éƒ¨</strong>ä¸ºç±»æ·»åŠ å±æ€§æˆ–ä¿®æ”¹å±æ€§ï¼Œé€šè¿‡ClassA.varX = â€¦å¯ä»¥<strong>åœ¨å¤–éƒ¨</strong>åŠ¨æ€æ·»åŠ å±æ€§</p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Obj</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    var1 <span class="token operator">=</span> <span class="token number">1</span>    <span class="token decorator annotation punctuation">@classmethod</span>    <span class="token keyword">def</span> <span class="token function">funA</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>cls<span class="token punctuation">.</span>var1<span class="token punctuation">)</span>        cls<span class="token punctuation">.</span>var2 <span class="token operator">=</span> <span class="token string">'123'</span>Obj<span class="token punctuation">.</span>funA<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>Obj<span class="token punctuation">.</span>var2<span class="token punctuation">)</span>Obj<span class="token punctuation">.</span>var3 <span class="token operator">=</span> <span class="token number">123</span><span class="token comment"># print 1 123</span></code></pre></div><h4 id="ç±»çš„å®ä¾‹åŒ–"><strong>ç±»çš„å®ä¾‹åŒ–</strong></h4><p>a = ClassA()ï¼Œå¦‚æœåªä½¿ç”¨å®ä¾‹åŒ–çš„å¯¹è±¡ï¼Œåˆ™ä¸ç”¨åŠ @classmethodæ³¨è§£ï¼Œä½†æ–¹æ³•ä¸­ä½¿ç”¨å±æ€§éœ€è¦é€šè¿‡ä¼ å…¥selfæ¥ä½¿ç”¨</p><p>ç±»çš„æ–¹æ³•çš„é‡å†™</p><p>å¦‚ä¸‹ï¼šç±»çš„æ–¹æ³•ã€å±æ€§æ”¹å˜ä¼šå½±å“å¯¹è±¡çš„æ–¹æ³•ã€å±æ€§ï¼Œä½†å¯¹è±¡çš„å±æ€§æ”¹å˜ï¼Œä¸ä¼šå½±å“ç±»çš„å±æ€§ï¼Œä¸”<strong>å¯¹è±¡çš„æ–¹æ³•ä¸èƒ½é‡å†™</strong>ï¼Œè¿™é‡Œæ¯”è¾ƒæœ‰è¶£çš„ä¸€ç‚¹æ˜¯ï¼Œæˆ‘æƒ³åœ¨é‡å†™ç±»çš„æ–¹æ³•ä¸­ä½¿ç”¨å…¶å±æ€§ï¼ˆé€šè¿‡å¤–éƒ¨æˆ–è€…å†…éƒ¨ï¼‰ï¼Œéƒ½ä¸è¡Œï¼Œå› ä¸ºæ²¡æœ‰æ³¨è§£çš„åŸæ•…ï¼Œä¸èƒ½åœ¨æ²¡æœ‰æ³¨è§£çš„æƒ…å†µä¸‹ç›´æ¥åœ¨æ–¹æ³•ä¸­è®¿é—®ç±»å˜é‡</p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Obj</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    var1 <span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">def</span> <span class="token function">funA</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>var1<span class="token punctuation">)</span>a <span class="token operator">=</span> Obj<span class="token punctuation">(</span><span class="token punctuation">)</span>a<span class="token punctuation">.</span>funA<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">funAB</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span> <span class="token string">"123"</span><span class="token punctuation">)</span>    <span class="token comment"># print(self.var1 + "123")</span>    <span class="token comment"># print(Obj.var1 + "123")</span>    <span class="token comment"># print(a.var1 + "123")</span>Obj<span class="token punctuation">.</span>funA <span class="token operator">=</span> funABa<span class="token punctuation">.</span>funA<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div><h4 id="åˆå§‹åŒ–ä¸é”€æ¯">åˆå§‹åŒ–ä¸é”€æ¯</h4><p><code>__init__(self)</code>å°±æ˜¯åˆå§‹åŒ–çš„å‡½æ•°</p><p><code>__def__(self)</code>è¡¨ç¤ºç±»åœ¨é”€æ¯æ—¶æ‰€åšçš„æ“ä½œ</p><h4 id="è®¿é—®æ§åˆ¶">è®¿é—®æ§åˆ¶</h4><p>ä»¥ä¸‹åˆ’çº¿å¼€å¤´çš„æ ‡è¯†ç¬¦æ˜¯æœ‰ç‰¹æ®Šæ„ä¹‰çš„ã€‚ä»¥å•ä¸‹åˆ’çº¿å¼€å¤´ <strong>_foo</strong> çš„<strong>ä»£è¡¨</strong>ä¸èƒ½ç›´æ¥è®¿é—®çš„ç±»å±æ€§ï¼ˆè¿™åªæ˜¯ä¸€ç§è§„å®šï¼Œå®é™…ä¸Šæ˜¯å¯è®¿é—®åˆ°çš„ï¼‰ï¼Œéœ€é€šè¿‡ç±»æä¾›çš„æ¥å£è¿›è¡Œè®¿é—®ï¼Œä¸èƒ½ç”¨ <strong>from xxx import *</strong> è€Œå¯¼å…¥ã€‚</p><p>ä»¥åŒä¸‹åˆ’çº¿å¼€å¤´çš„ <strong>__foo</strong> ä»£è¡¨ç±»çš„ç§æœ‰æˆå‘˜ï¼Œä»¥åŒä¸‹åˆ’çº¿å¼€å¤´å’Œç»“å°¾çš„ <strong>__ foo __</strong> ä»£è¡¨ Python é‡Œç‰¹æ®Šæ–¹æ³•ä¸“ç”¨çš„æ ‡è¯†ï¼Œå¦‚ <strong>__ init __()</strong> ä»£è¡¨ç±»çš„æ„é€ å‡½æ•°ã€‚</p><p><strong>dir(class)</strong>ï¼šè·å–ç›¸åº”å¯¹è±¡çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•åçš„åˆ—è¡¨ï¼š</p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">dir</span><span class="token punctuation">(</span>Father<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>Father<span class="token punctuation">.</span>_Father__var1<span class="token punctuation">)</span><span class="token comment"># ['_Father__var1', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__']</span></code></pre></div><p>èµ·å§‹ç§æœ‰å±æ€§ç†è®ºä¸Šä¹Ÿæ˜¯å¯ä»¥è®¿é—®çš„ï¼Œå› ä¸ºpythonæ„é€ æ—¶ï¼Œåªæ˜¯å°†å…¶è½¬åŒ–äº†åå­—ä¸ºï¼š<code>_Class__varX</code>ï¼Œä¸€æ ·å¯ä»¥ç›´æ¥é€šè¿‡è°ƒç”¨è¿™ä¸ªå±æ€§æ¥è®¿é—®ã€‚æ–¹æ³•çš„ç§æœ‰ç±»åˆ«ä¸å…¶ç›¸åŒã€‚å¼ºè°ƒä¸€ç‚¹ï¼š<strong>æ²¡æœ‰å®è´¨ä¸Šçš„ç§æœ‰æ–¹æ³•ã€‚ä¸€åˆ‡éƒ½æ˜¯é ç¨‹åºå‘˜è‡ªè§‰éµå®ˆ Python çš„ç¼–ç¨‹è§„èŒƒ</strong></p><p>åŒæ—¶ä¸€ä¸ªç±»åˆ›å»ºæ—¶ï¼Œä¼šæœ‰é™„å¸¦çš„æ–¹æ³•ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤º</p><h4 id="ç»§æ‰¿">ç»§æ‰¿</h4><p>å£°æ˜ç±»æ—¶åœ¨æ‹¬å·ä¸­å†™ï¼Œå¯ä»¥ç»§æ‰¿å¤šä¸ªç±»ï¼Œçˆ¶ç±»ä¸­æ–¹æ³•ç›¸åŒæ—¶ä¸”åœ¨å­ç±»ä¸­æœªæŒ‡å®šæ—¶ï¼Œä»å·¦è‡³å³æœç´¢</p><p>ä¸€ç‚¹æ¯”è¾ƒæœ‰æ„æ€çš„åœ°æ–¹ï¼šå¦‚æœé‡å†™äº†å­ç±»çš„åˆå§‹åŒ–æ–¹æ³•å¦‚ä¸‹ï¼Œé‚£ä¹ˆåœ¨åˆå§‹åŒ–å­ç±»æ—¶ï¼Œ<strong>ä¸ä¼šè°ƒç”¨çˆ¶ç±»çš„åˆå§‹åŒ–æ–¹æ³•</strong>ï¼Œè¿™ä¸åœ¨Javaä¸­æ˜¯ä¸åŒçš„ï¼ŒJavaä¸­ä¼šå±‚æ¬¡åœ°è°ƒç”¨åˆå§‹åŒ–æ–¹æ³•ï¼ˆå¯èƒ½å’Œç±»åŠ è½½æœºåˆ¶æœ‰å…³ç³»ï¼‰ã€‚éœ€è¦æ˜¾ç¤ºçš„é€šè¿‡superæ¥è°ƒç”¨çˆ¶ç±»çš„åˆå§‹åŒ–æ–¹æ³•ã€‚åŒæ ·ï¼Œé€šè¿‡è®¿é—®ç±»çš„å‚æ•°ä¹Ÿä¸ä¼šè§¦å‘ç±»çš„initæ–¹æ³•</p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Father</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Father init"</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">Son</span><span class="token punctuation">(</span>Father<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token builtin">super</span><span class="token punctuation">(</span>Son<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Son init"</span><span class="token punctuation">)</span>    <span class="token keyword">pass</span>son <span class="token operator">=</span> Son<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># super(type, obj) -> bound super object; requires isinstance(obj, type)</span></code></pre></div><p>isinstance(obj, class)åˆ¤æ–­å¯¹è±¡æ˜¯å¦å±äºæŸä¸ªç±»ï¼ˆåŒ…æ‹¬çˆ¶ç±»ï¼‰</p><h3 id="æ¨¡å—">æ¨¡å—</h3><p>ä¸€ä¸ªpyæ–‡ä»¶</p><ul><li>åŒç›®å½•ä¸‹ç›´æ¥import xxx å°±è¡Œï¼Œä½¿ç”¨æ—¶é€šè¿‡xxx.functionå»è°ƒç”¨</li><li>ä¸åŒç›®å½• import <a href="http://dir1.dir2.xxx">dir1.dir2.xxx</a> è°ƒç”¨æ–¹å¼ä¹Ÿå¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼è°ƒç”¨<ul><li>å¯ä»¥ç”¨asæ¥alias</li></ul></li></ul><p>from xxx import method æ¥å¯¼å…¥æŸæ¨¡å—çš„æŒ‡å®šfunction</p><p>ä¸€ä¸ªPyæ¨¡å—çš„åŒ…å«å…³ç³»ï¼šå˜é‡ã€å‡½æ•°ã€ç±»ï¼ˆå˜é‡ã€å‡½æ•°ï¼‰</p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># ä¸åŒçš„å¼•ç”¨æ–¹å¼æœ‰ä¸åŒçš„å†™æ³•ï¼Œå¯¼å…¥æŒ‡å®šçš„åŒ…</span><span class="token keyword">from</span> utils <span class="token keyword">import</span> UtilssUtilss<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">import</span> utilsutils<span class="token punctuation">.</span>Utilss<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">from</span> sys <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">print</span><span class="token punctuation">(</span>version<span class="token punctuation">)</span></code></pre></div><p><strong>ä¸»æ¨¡å—ã€éä¸»æ¨¡å—</strong>ï¼š</p><p>å¦‚æœä¸€ä¸ªæ¨¡å—è¢«ç›´æ¥ä½¿ç”¨ï¼Œè€Œæ²¡æœ‰è¢«åˆ«äººè°ƒç”¨ï¼Œæˆ‘ä»¬ç§°è¿™ä¸ªæ¨¡å—ä¸ºä¸»æ¨¡å—ï¼Œå¦‚æœä¸€ä¸ªæ¨¡å—è¢«åˆ«äººè°ƒç”¨ï¼Œåˆ™è¿™ä¸ªæ¨¡å—ä¸ºéä¸»æ¨¡å—ã€‚-&gt; <code>__name__</code>åˆ¤æ–­å½“å‰æ¨¡å—æ˜¯å¦æ˜¯ä¸»æ¨¡å—ï¼Œè¿™ç‚¹å¾ˆé‡è¦ï¼ˆæ„Ÿè§‰è¯´æ˜ä»£ç ä¸æ˜¯æ‹¼æ¥åœ¨ä¸€èµ·çš„ï¼Ÿæˆ–è€…æ˜¯ä¸»æ¨¡å—ä»£ç æ˜¯æœ‰ç•Œé™çš„ï¼‰</p><p><strong>åŒ…</strong></p><p>æ¥é¿å…æ¨¡å—åç›¸åŒçš„æƒ…å†µï¼Œæ¯ä¸ªå±‚æ¬¡çš„åŒ…å¿…é¡»æœ‰ä¸ª<code>__init__</code>æ¨¡å—æ¥è¾¨è¯†ä»–æ˜¯ä¸€ä¸ªåŒ…ï¼Œ<strong>åœ¨æ¨¡å—ä¸­å¯¼å…¥åŒ…æ—¶ä¼šæ‰§è¡Œå…¶ä¸‹çš„<code>__init__</code>æ–‡ä»¶çš„ä»£ç </strong></p><p>ç‰¹æ®Šå˜é‡<code>__xxx__</code>æ¥æ ‡æ³¨ç‰¹æ®Šä¿¡æ¯</p><p><strong>è·¯å¾„</strong></p><p>å½“ä½ å¯¼å…¥ä¸€ä¸ªæ¨¡å—ï¼ŒPython è§£æå™¨å¯¹æ¨¡å—ä½ç½®çš„æœç´¢é¡ºåºæ˜¯ï¼š</p><ul><li>1ã€å½“å‰ç›®å½•</li><li>2ã€å¦‚æœä¸åœ¨å½“å‰ç›®å½•ï¼ŒPython åˆ™æœç´¢åœ¨ shell å˜é‡ PYTHONPATH ä¸‹çš„æ¯ä¸ªç›®å½•ã€‚</li><li>3ã€å¦‚æœéƒ½æ‰¾ä¸åˆ°ï¼ŒPythonä¼šå¯Ÿçœ‹é»˜è®¤è·¯å¾„ã€‚UNIXä¸‹ï¼Œé»˜è®¤è·¯å¾„ä¸€èˆ¬ä¸º/usr/local/lib/python/</li></ul><h3 id="MagicMethod">MagicMethod</h3><p><code>__xx__</code>çš„æ–¹æ³•éƒ½ç§°ä¸ºmagic method</p><ul><li><code>__new__</code>ï¼šåˆ›å»ºç±»å¹¶è¿”å›è¿™ä¸ªç±»çš„å®ä¾‹</li><li><code>__init__</code>ï¼šå°†ä¼ å…¥çš„å‚æ•°æ¥åˆå§‹åŒ–è¯¥å®ä¾‹ï¼Œåˆ›å»ºå®ä¾‹æ—¶newä¸€å®šä¼šè¢«è°ƒç”¨ä½†initå´ä¸ä¸€å®š</li><li><code>__getattr__</code>ï¼š è¯•å›¾è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨å±æ€§æ—¶ï¼Œå¯ä»¥å¯¹å…¶é‡å®šå‘æˆ–è­¦å‘Š</li><li><code>__setattr__</code>ï¼šç±»ä¼¼</li><li><code>__delattr_</code></li><li><code>__getattribute__</code>ï¼šä¸getatträ¸åŒç‚¹åœ¨äºï¼Œä¸ç®¡æ–¹æ³•æ˜¯å¦å­˜åœ¨ï¼Œåªè¦è°ƒç”¨å°±ä¼šè§¦å‘è¿™ä¸ªå‡½æ•°ï¼Œã€‚ä»¥ä¸Šå‡ ä¸ªå‡½æ•°éƒ½è¦é¿å…<strong>æ— é™é€’å½’çš„æƒ…å†µ</strong></li><li><code>__get__</code></li><li><code>__set__</code></li></ul><p>Pythonè¿˜èƒ½é€šè¿‡é‡å†™æ¯”è¾ƒè¿ç®—ç¬¦çš„é­”æœ¯æ–¹æ³•æ¥å®ç°ä»æ“ä½œç¬¦å·ä¸Šçš„æ–¹æ³•é‡å†™</p><h3 id="IO-v2">IO</h3><ul><li>raw_input</li><li>input ã€‚å¯ä»¥æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼ï¼</li><li>print()å¯ä»¥é€šè¿‡seq å’Œ endæ¥æ·»åŠ è¾“å‡ºçš„å‰ã€åé™„åŠ å­—ç¬¦ä¸²(endé»˜è®¤ä¸ºæ¢è¡Œ)</li></ul><h4 id="æ–‡ä»¶">æ–‡ä»¶</h4><ul><li><p>close : File å¯¹è±¡çš„ closeï¼ˆï¼‰æ–¹æ³•åˆ·æ–°ç¼“å†²åŒºé‡Œä»»ä½•è¿˜æ²¡å†™å…¥çš„ä¿¡æ¯ï¼Œå¹¶å…³é—­è¯¥æ–‡ä»¶ï¼Œè¿™ä¹‹åä¾¿ä¸èƒ½å†è¿›è¡Œå†™å…¥ã€‚</p><p>å½“ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡çš„å¼•ç”¨è¢«é‡æ–°æŒ‡å®šç»™å¦ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼ŒPython ä¼šå…³é—­ä¹‹å‰çš„æ–‡ä»¶ã€‚ç”¨ closeï¼ˆï¼‰æ–¹æ³•å…³é—­æ–‡ä»¶æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¹ æƒ¯ã€‚</p></li></ul><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211017145546394.png" alt="image-20211017145546394"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211017160648689.png" alt="image-20211017160648689"></p><p>å½“ç„¶ï¼Œå¦‚æœlinuxçš„æ–‡ä»¶æƒé™ä¸ä¹‹ä¸å…¼å®¹ï¼Œåˆ™openæ—¶ä¼šæŠ¥é”™</p><div class="note note-primary">            <p><strong>open çš„ buffering æ€ä¹ˆå¤±æ•ˆï¼Ÿæ²¡æœ‰flushä¹Ÿèƒ½å¤Ÿå†™è¿›å»ï¼Ÿ</strong></p><p>æœ‰å¯èƒ½æ˜¯åœ¨writeçš„è¿‡ç¨‹ä¸­ç¨‹åºä¸­æ–­</p>          </div><div class="note note-light">            <p><strong>del file å’Œ file.closeæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</strong></p>          </div><div class="note note-success">            <p><strong>å¦‚æœä¿®æ”¹ä¸€ä¸ªimportçš„æ–‡ä»¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</strong></p>          </div><h3 id="å¼‚å¸¸-v3">å¼‚å¸¸</h3><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">try</span><span class="token punctuation">:</span>xxx<span class="token keyword">except</span> <span class="token punctuation">:</span> <span class="token comment"># ä»»ä½•å¼‚å¸¸éƒ½å¯</span><span class="token keyword">except</span> name<span class="token punctuation">:</span><span class="token keyword">except</span> name<span class="token punctuation">,</span>data<span class="token punctuation">:</span><span class="token keyword">except</span> name<span class="token punctuation">,</span>name2<span class="token punctuation">,</span>name3<span class="token punctuation">:</span><span class="token keyword">else</span> <span class="token punctuation">:</span>    xxx<span class="token keyword">finally</span><span class="token punctuation">:</span>    xxx</code></pre></div><p>æ‰‹åŠ¨è§¦å‘å¼‚å¸¸<br>raise exception,args,traceback</p><p>è‡ªå®šä¹‰å¼‚å¸¸</p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Networkerror</span><span class="token punctuation">(</span>RuntimeError<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> arg<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>args <span class="token operator">=</span> arg</code></pre></div><h2 id="è¿›é˜¶-v3">è¿›é˜¶</h2><h3 id="çº¿ç¨‹-v3">çº¿ç¨‹</h3><p>threadï¼šç”¨äºä½çº§æ¨¡å—ã€åº•å±‚æ“ä½œã€‚threadingï¼šåº”ç”¨çº§åˆ«å¼€å‘</p><p>è°ƒç”¨æ–¹å¼ï¼Œæ–°åˆ›å»ºç±»å¹¶ç»§æ‰¿threading.Threadè¿™ä¸ªç±»ï¼Œé‡å†™funæ–¹æ³•ï¼Œé€šè¿‡threadx.startè°ƒç”¨ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨åˆ›å»ºæ—¶target=æ¥æŒ‡å®šrunå‡½æ•°</p><p><strong>join</strong>è®©å½“å‰çº¿ç¨‹ç­‰å¾…è°ƒç”¨çº¿ç¨‹æ‰§è¡Œå®Œæ¯•åï¼Œå†æ‰§è¡Œå½“å‰çº¿ç¨‹çš„ä¸‹ä¸€æ®µä»£ç </p><h4 id="é”-v2">é”</h4><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python">lock <span class="token operator">=</span> threading<span class="token punctuation">.</span>lock<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># è·å–é”</span>lock<span class="token punctuation">.</span>aquire<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># çº¿ç¨‹ä¸­è·å–é”</span>lock<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># çº¿ç¨‹ä¸­é‡Šæ”¾é”</span><span class="token comment"># è·å–é‡å…¥é” lock = threading.RLock()</span></code></pre></div><h4 id="Condition-v2">Condition</h4><h4 id="çº¿ç¨‹é€šä¿¡-v2">çº¿ç¨‹é€šä¿¡</h4><h4 id="çº¿ç¨‹æ± ">çº¿ç¨‹æ± </h4><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> concurrent<span class="token punctuation">.</span>futures <span class="token keyword">import</span> ThreadPoolExecutor<span class="token keyword">def</span> <span class="token function">fn</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">&#123;</span>name<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token keyword">with</span> ThreadPoolExecutor<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token keyword">as</span> t<span class="token punctuation">:</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            t<span class="token punctuation">.</span>submit<span class="token punctuation">(</span>fn<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f'çº¿ç¨‹</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'done in main'</span><span class="token punctuation">)</span></code></pre></div><p>withåçš„è¯­å¥ä¼šç­‰åˆ°withå†…éƒ¨ï¼Œå³çº¿ç¨‹æ± æ‰€æœ‰çº¿ç¨‹æ‰§è¡Œå®Œæ¯•å†æ‰§è¡Œ</p><h4 id="è„æ•°æ®">è„æ•°æ®</h4><p>ä¼¼ä¹ä¸å­˜åœ¨è„æ•°æ®çš„é—®é¢˜ï¼Ÿ</p><div class="code-wrapper"><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> threading<span class="token keyword">global</span> ii <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">def</span> <span class="token function">funcA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">global</span> i    <span class="token keyword">for</span> a <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        i <span class="token operator">+=</span> <span class="token number">1</span><span class="token keyword">class</span> <span class="token class-name">MyThread</span><span class="token punctuation">(</span>threading<span class="token punctuation">.</span>Thread<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>        funcA<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    threads <span class="token operator">=</span> <span class="token punctuation">[</span>MyThread<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> a <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> a <span class="token keyword">in</span> threads<span class="token punctuation">:</span>        a<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token comment"># print(1000000)</span></code></pre></div><h4 id="åç¨‹">åç¨‹</h4><p>åŸå› ï¼šç¨‹åºé˜»å¡(eg: IO sleep() )æµªè´¹äº†å¤§é‡æ—¶é—´ã€‚å¦‚ä½•èƒ½è®©IOæ“ä½œæ—¶èƒ½æŠŠCPUæ‹¿æ¥å»åšå…¶ä»–çš„ä¸€äº›ä»»åŠ¡ï¼Ÿ</p><p>å¾®è§‚ä¸Šï¼šä¸€ä¸ªä»»åŠ¡ä¸€ä¸ªä»»åŠ¡çš„åˆ‡æ¢ï¼Œåˆ‡æ¢æ¡ä»¶ï¼ˆIOæ“ä½œï¼‰</p><p><strong>å…³é”®è¯ async</strong></p><p>ç¨‹åºä¸­å‡ºç°åŒæ­¥æ“ä½œï¼Œåˆ™å¼‚æ­¥æ“ä½œä¾¿ç»ˆæ­¢<br>time.sleep --&gt; asynio.sleep --&gt;<strong>awaitå…³é”®è¯è¡¨ç¤º æŒ‚èµ·</strong></p><p><strong>æ³¨æ„ç‚¹ï¼šd = async_func()å¹¶ä¸æ˜¯å»æ‰§è¡Œä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œè€Œæ˜¯å¾—åˆ°è¿™ä¸ªå‡½æ•°çš„åç¨‹å¯¹è±¡ã€‚ç„¶åé€šè¿‡runæˆ–è€…waitè·‘èµ·æ¥</strong></p><p><strong>awaitè¦è·Ÿåœ¨å¼‚æ­¥å‡½æ•°å†…ï¼Œè€Œä¸èƒ½åœ¨ä¸»å‡½æ•°ä¸­ï¼Œä¸”ä¸€èˆ¬æ˜¯æŒ‚èµ·åç¨‹å¯¹è±¡</strong></p><div class="note note-primary">            <p>Python3.11åå°†removeæ‰é€šè¿‡asyncio.wait()å»æ‰§è¡Œä¸€ç»„åç¨‹å¯¹è±¡çš„è¡Œä¸ºï¼Œéœ€è¦å°†æ¯ä¸ªåç¨‹å¯¹è±¡åŒ…è£…ä¸ºTaskå¯¹è±¡ï¼šasyncio.create_task(func())</p>          </div><h2 id="ä¸€äº›é—®é¢˜-v3">ä¸€äº›é—®é¢˜</h2><p><strong>ä¸ºä»€ä¹ˆä¼šæœ‰virtual env?</strong></p><p>yesp</p>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Study</tag>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Dockerå­¦ä¹ </title>
    <link href="/2021/10/14/Docker%E5%AD%A6%E4%B9%A0/"/>
    <url>/2021/10/14/Docker%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1>Dockerå­¦ä¹ æ—¥è®°</h1><h2 id="åŸºç¡€">åŸºç¡€</h2><span id="more"></span><!--toc--><h3 id="å‘½ä»¤">å‘½ä»¤</h3><ul><li>docker attach [id]  è¿›å…¥åˆ°æ­£åœ¨è¿è¡Œçš„å®¹å™¨.æœ¬æœºçš„è¾“å…¥ç›´æ¥è¾“åˆ°å®¹å™¨ä¸­ï¼Œå®¹å™¨çš„è¾“å‡ºä¼šç›´æ¥æ˜¾ç¤ºåœ¨æœ¬æœºçš„å±å¹•ä¸Š</li><li>docker run<ul><li>-i ä»¥äº¤äº’æ¨¡å¼è¿è¡Œ</li><li>-d åå°è¿è¡Œå®¹å™¨</li><li>-t ä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯</li><li>-p    ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£          -P éšæœºåˆ¶å®šç«¯å£</li><li>â€“name</li><li>-v</li><li>â€“volumes-from</li></ul></li><li>docker rm id åˆ é™¤å®¹å™¨<ul><li>-f force delete</li></ul></li><li>docker images</li><li>docker exec åœ¨è¿è¡Œçš„å®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤</li><li>docker volumn æŸ¥çœ‹å·ä¿¡æ¯<ul><li>ls   æŸ¥çœ‹æ‰€æœ‰å·æƒ…å†µ</li><li>create</li><li>inspect æŸ¥çœ‹ç‰¹å®švolumeçš„ä¿¡æ¯</li><li>rm</li></ul></li><li>docker build é€šè¿‡dockerfileæ–¹å¼åˆ›å»ºå®¹å™¨<ul><li>-f dockerfileæ–‡ä»¶è·¯å¾„ï¼ˆå¦‚æœæ˜¯Dockerfileçš„è¯å°±ä¸ç”¨åŠ è¿™ä¸ªäº†ï¼‰</li><li>-t é•œåƒå</li></ul></li><li>docker push å‘å¸ƒé•œåƒ</li><li>docker history</li><li>docker save</li><li>docker load</li><li>docker inspect<ul><li>id</li></ul></li><li>docker network<ul><li>ls</li><li>rm</li><li>inspect</li><li>connect [network] [container(can be name)] æŠŠä¸€ä¸ªå®¹å™¨è¿æ¥åˆ°ä¸€ä¸ªç½‘ç»œ</li><li>create</li></ul></li></ul><h3 id="comité•œåƒ">comité•œåƒ</h3><p>docker commit -m=â€œxxxxâ€</p><p>æäº¤å®¹å™¨ç§°ä¸ºä¸€ä¸ªæ–°çš„å‰¯æœ¬ï¼Œæˆ‘è‡ªå·±åšçš„ï¼Œæˆ‘è§‰å¾—å¥½ç”¨æƒ³è¦ä¿å­˜ä¸‹æ¥</p><p>docker commit -a=â€œxxxâ€ [id] [name]:[tag]</p><p><strong>Tomcatæ‹·è´æ¬¢è¿é¡µé¢åˆ°webapps</strong></p><p>cp -r webapps.dist/* webapps</p><p>è¿™é‡Œæ‹·è´è¿›å»åä¸ç”¨é‡å¯éƒ½å¯ä»¥åœ¨é¡µé¢è®¿é—®</p><h2 id="å·">å·</h2><h3 id="å®¹å™¨æ•°æ®å·">å®¹å™¨æ•°æ®å·</h3><p>ä¸€ç§æ•°æ®å…±äº«æŠ€æœ¯ã€‚</p><p>å®¹å™¨åˆ é™¤ï¼Œæ•°æ®å¦‚æœåœ¨å®¹å™¨ä¸­ï¼Œé‚£æ•°æ® ä¹Ÿä¼šæ¶ˆå¤±ï¼Œåˆ™çœŸå®æ•°æ®ä¸åº”åœ¨ç›¸åŒå®¹å™¨ä¸­ï¼Œä¸¤è€…åº”è¯¥æœ‰ä¸€ç§æ˜ å°„å…³ç³»ã€‚</p><h4 id="æŒ‚è½½æ–¹å¼">æŒ‚è½½æ–¹å¼</h4><h5 id="å‘½ä»¤æ–¹å¼æŒ‚è½½">å‘½ä»¤æ–¹å¼æŒ‚è½½</h5><ol><li><p><strong>æŒ‡å®šè·¯å¾„æŒ‚è½½</strong></p><p>docker run -v ä¸»æœºç›®å½•:å®¹å™¨ç›®å½•</p><p>docker inspect idæŸ¥çœ‹å®¹å™¨æƒ…å†µ</p><div class="code-wrapper"><pre class="language-shell" data-language="shell"><code class="language-shell">&quot;Mounts&quot;: [            &#123;                &quot;Type&quot;: &quot;bind&quot;,                # ä¸»æœºå†…                &quot;Source&quot;: &quot;&#x2F;home&#x2F;tempFile&quot;,                # dockerå®¹å™¨å†…åœ°å€                &quot;Destination&quot;: &quot;&#x2F;home&quot;,                &quot;Mode&quot;: &quot;&quot;,                &quot;RW&quot;: true,                &quot;Propagation&quot;: &quot;rprivate&quot;            &#125;        ],</code></pre></div><p>æ­¤æ—¶åœ¨å®¹å™¨å†…è¯¥ç›®å½•ä¸‹çš„æ“ä½œï¼Œéƒ½ç›¸å½“äºåœ¨ä¸»æœºå†…çš„è¯¥ç›®å½•ä¸‹è¿›è¡Œçš„æ“ä½œã€‚åˆ é™¤å®¹å™¨ï¼Œä½†ä¸»æœºå†…çš„æ–‡ä»¶ä¸ä¼šæ¶ˆå¤±</p><p><strong>åŒæ­¥Mysql</strong></p><div class="code-wrapper"><pre class="language-shell" data-language="shell"><code class="language-shell"># åˆ›å»ºå®¹å™¨docker run -d -p 3310:3306 -v &#x2F;home&#x2F;mysql&#x2F;conf:&#x2F;etc&#x2F;mysql&#x2F;conf.d -v &#x2F;home&#x2F;mysql&#x2F;data:&#x2F;var&#x2F;lib&#x2F;mysql -e MYSQL_ROOT_PASSWORD&#x3D;Zyl2000215 --name mysql01 mysql:8.0.26# å¯ä»¥ç›´æ¥ä»è¿œç¨‹è®¿é—®</code></pre></div></li><li><p><strong>åŒ¿åæŒ‚è½½</strong></p><p>DRIVER    VOLUME NAME<br>local     d7e224fbb90a257812018ad044398007014d08293674b8fc9266fe22b1773c8b(åŒ¿åæŒ‚è½½çš„åç§°)</p><p>-v æ—¶åªå†™äº†å®¹å™¨å†…éƒ¨çš„è·¯å¾„ï¼Œæ²¡æœ‰å†™å®¹å™¨å¤–éƒ¨çš„è·¯å¾„ï¼ˆéšä¾¿æ‰¾ä¸ªåœ°æ–¹æŒ‚äº†ï¼‰</p></li><li><p><strong>å…·åæŒ‚è½½</strong></p><p>-v [volumnj_name]:/xxx/xxx</p><p>DRIVER    VOLUME NAME<br>local     specific-name(åŒ¿åæŒ‚è½½çš„åç§°)</p><p>é€šè¿‡docker volume inspect xxxxæŸ¥çœ‹</p><p>æ”¾åœ¨docker/volumesä¸­</p></li></ol><p><strong>åœ¨å®¹å™¨è·¯å¾„ååŠ :rw å’Œ :ro æ”¹å˜è¯»å†™çš„æƒé™</strong></p><ul><li>roï¼šåªèƒ½ä»å¤–éƒ¨ï¼ˆä¸»æœºï¼‰æ”¹å˜ï¼Œå®¹å™¨å†…éƒ¨ä¸å¾—æ›´æ”¹</li><li>rwï¼šé»˜è®¤</li></ul><h5 id="DockerFileæŒ‚è½½">DockerFileæŒ‚è½½</h5><p><strong>DockerFile</strong></p><p>ä¸€æ®µå‘½ä»¤è„šæ­¥</p><div class="code-wrapper"><pre class="language-shell" data-language="shell"><code class="language-shell"># ç¤ºä¾‹è„šæœ¬FROM centos# ç”Ÿæˆæ•°æ®å·ç›®å½•ï¼ŒåŒ¿åæŒ‚è½½VOLUME [&quot;volume01&quot;,&quot;volumn02&quot;]CMD echo &quot;---end---&quot;CMD &#x2F;bin&#x2F;bash</code></pre></div><div class="code-wrapper"><pre class="language-shell" data-language="shell"><code class="language-shell">docker build -f dockerfile1 -t zyl&#x2F;centos .# æ³¨æ„è¿™ä¸ª . # è¿è¡Œç»“æœSending build context to Docker daemon  2.048kBStep 1&#x2F;4 : FROM centos ---&gt; 5d0da3dc9764Step 2&#x2F;4 : VOLUME [&quot;volume01&quot;,&quot;volumn02&quot;] ---&gt; Running in 8c219faef7d6Removing intermediate container 8c219faef7d6 ---&gt; 905dfeb79eb6Step 3&#x2F;4 : CMD echo &quot;---end---&quot; ---&gt; Running in 4996222c5daeRemoving intermediate container 4996222c5dae ---&gt; 0876105c0d1bStep 4&#x2F;4 : CMD &#x2F;bin&#x2F;bash ---&gt; Running in 719ba2d3806aRemoving intermediate container 719ba2d3806a ---&gt; ffa50b1fdb37Successfully built ffa50b1fdb37Successfully tagged zyl&#x2F;centos:latest</code></pre></div><h3 id="æ•°æ®å·å®¹å™¨">æ•°æ®å·å®¹å™¨</h3><p>å¤šä¸ªmysqlåŒæ­¥æ•°æ®ï¼ˆå­ã€çˆ¶å®¹å™¨é—´çš„æŒ‚è½½ï¼‰</p><p>â€“volumes-from [main_instance]ã€‚å¯ä»¥åµŒå¥—çš„æŒ‚è½½</p><p>æ­¤æ—¶ä¸»æœºmainå’Œä¸»æœºthisçš„volumeå°±ä¼šåŒæ­¥äº†</p><p>åˆ é™¤mainï¼Œdocker02å’Œdocker03è¿˜æ˜¯å¯ä»¥è®¿é—®volumeä¸‹çš„æ–‡ä»¶(ä½†è¿™é‡Œçš„å‰ææ˜¯ï¼Œæ˜ å°„çš„æ˜¯çœŸå®ä¸»æœºä¸‹çš„ç›®å½•ï¼Œä¸»æœºä¸‹çš„ç›®å½•è¿˜æ²¡åˆ é™¤)[è¿™é‡Œè¿˜ä¸æ˜¯å¾ˆæ¸…æ¥š]</p><p>æ•°æ®å·å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸä¸€ç›´æŒç»­åˆ°æ²¡æœ‰å®¹å™¨ä½¿ç”¨ä¸ºæ­¢</p><p><strong>å¤šä¸ªmysqlå®ç°æ•°æ®å…±äº«</strong></p><h3 id="DockerFile">DockerFile</h3><p>ä¸€æ®µå‘½ä»¤è„šæœ¬</p><p>æ¯”å¦‚ä½ æƒ³è¦ä¸€ä¸ªcentos + jdk + mysqlâ€¦</p><h4 id="æŒ‡ä»¤">æŒ‡ä»¤</h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211015110209785.png" alt="image-20211015110209785"></p><ul><li>æ¯ä¸ªå…³é”®å­—éƒ½<strong>å¿…é¡»</strong>æ˜¯å¤§å†™å­—æ¯</li><li>æŒ‡ä»¤æ˜¯é¡ºåºæ‰§è¡Œçš„</li><li>#è¡¨ç¤ºæ³¨é‡Š</li><li><strong>æ¯ä¸ªæŒ‡ä»¤éƒ½ä¼šåˆ›å»ºæäº¤ä¸€ä¸ªæ–°çš„é•œåƒå±‚</strong></li></ul><p><strong>CMD å’Œ ENTRYPOINTçš„åŒºåˆ«</strong></p><ul><li>CMD [â€œlsâ€,â€œ-aâ€] ï¼Œdockerfileåœ¨è¿™ç§æ–¹å¼åï¼Œé€šè¿‡docker run  id å†å»<strong>è¿½åŠ </strong> -l æ“ä½œå°±ä¼šæŠ¥é”™ï¼Œå› ä¸ºå®ƒä¼šæ›¿æ¢æ‰CMDçš„å‘½ä»¤</li><li>å¦‚æœç”¨ENTRYPOINT[â€œlsâ€,â€œ-aâ€] åˆ™ä¸ä¼šå‡ºç°ä¸Šè¿°é—®é¢˜</li></ul><h4 id="æ„å»ºè¿‡ç¨‹">æ„å»ºè¿‡ç¨‹</h4><p>99%é•œåƒæ˜¯ä»åŸºç¡€é•œåƒæ¥çš„ scratch</p><div class="code-wrapper"><pre class="language-dockerfile" data-language="dockerfile"><code class="language-dockerfile">FROM centosMAINTAINER zyl&lt;401177923@qq.com&gt;ENV MYPATH &#x2F;usr&#x2F;localWORKDIR $MYPATH# å¸¦vimå’Œnet-toolsRUN yum -y install vimRUN yum -y install net-tools# æš´éœ²80ç«¯å£EXPOSE 80CMD echo$MYPATHCMD echo &quot;build finished&quot;CMD &#x2F;bin&#x2F;bash</code></pre></div><p>è¿”å›å†…å®¹</p><div class="code-wrapper"><pre class="language-shell" data-language="shell"><code class="language-shell"># æ³¨æ„å‘½ä»¤æœ€åè¿˜æœ‰ä¸ª .# docker build -f tarDockerFile -t imagename .Sending build context to Docker daemon  2.048kBStep 1&#x2F;10 : FROM centos ---&gt; 5d0da3dc9764Step 2&#x2F;10 : MAINTAINER zyl&lt;401177923@qq.com&gt; ---&gt; Running in 4d6110c861e7Removing intermediate container 4d6110c861e7 ---&gt; 0ac892083934Step 3&#x2F;10 : ENV MYPATH &#x2F;usr&#x2F;local ---&gt; Running in 8c0c8833003dRemoving intermediate container 8c0c8833003d ---&gt; 75e64bad3a9eStep 4&#x2F;10 : WORKDIR $MYPATH ---&gt; Running in 2e111cca4927Removing intermediate container 2e111cca4927 ---&gt; 03809e35e5a5Step 5&#x2F;10 : RUN yum -y install vim ---&gt; Running in 444473f309e6CentOS Linux 8 - AppStream                       14 MB&#x2F;s | 9.3 MB     00:00    CentOS Linux 8 - BaseOS                         3.2 MB&#x2F;s | 7.5 MB     00:02    CentOS Linux 8 - Extras                          19 kB&#x2F;s |  10 kB     00:00    Dependencies resolved.&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; Package             Arch        Version                   Repository      Size&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Installing: vim-enhanced        x86_64      2:8.0.1763-15.el8         appstream      1.4 MInstalling dependencies: gpm-libs            x86_64      1.20.7-17.el8             appstream       39 k vim-common          x86_64      2:8.0.1763-15.el8         appstream      6.3 M vim-filesystem      noarch      2:8.0.1763-15.el8         appstream       48 k which               x86_64      2.21-12.el8               baseos          49 kTransaction Summary&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Install  5 PackagesTotal download size: 7.8 MInstalled size: 30 MDownloading Packages:(1&#x2F;5): gpm-libs-1.20.7-17.el8.x86_64.rpm        1.3 MB&#x2F;s |  39 kB     00:00    (2&#x2F;5): vim-filesystem-8.0.1763-15.el8.noarch.rp 3.2 MB&#x2F;s |  48 kB     00:00    (3&#x2F;5): vim-enhanced-8.0.1763-15.el8.x86_64.rpm   20 MB&#x2F;s | 1.4 MB     00:00    (4&#x2F;5): which-2.21-12.el8.x86_64.rpm             931 kB&#x2F;s |  49 kB     00:00    (5&#x2F;5): vim-common-8.0.1763-15.el8.x86_64.rpm     45 MB&#x2F;s | 6.3 MB     00:00    --------------------------------------------------------------------------------Total                                           8.8 MB&#x2F;s | 7.8 MB     00:00     warning: &#x2F;var&#x2F;cache&#x2F;dnf&#x2F;appstream-02e86d1c976ab532&#x2F;packages&#x2F;gpm-libs-1.20.7-17.el8.x86_64.rpm: Header V3 RSA&#x2F;SHA256 Signature, key ID 8483c65d: NOKEY                                                                                 CentOS Linux 8 - AppStream                      257 kB&#x2F;s | 1.6 kB     00:00    Importing GPG key 0x8483C65D: Userid     : &quot;CentOS (CentOS Official Signing Key) &lt;security@centos.org&gt;&quot;                                          Fingerprint: 99DB 70FA E1D7 CE22 7FB6 4882 05B5 55B3 8483 C65D                                                     From       : &#x2F;etc&#x2F;pki&#x2F;rpm-gpg&#x2F;RPM-GPG-KEY-centosofficial                                                          Key imported successfullyRunning transaction checkTransaction check succeeded.Running transaction testTransaction test succeeded.Running transaction  Preparing        :                                                        1&#x2F;1   Installing       : which-2.21-12.el8.x86_64                               1&#x2F;5   Installing       : vim-filesystem-2:8.0.1763-15.el8.noarch                2&#x2F;5   Installing       : vim-common-2:8.0.1763-15.el8.x86_64                    3&#x2F;5   Installing       : gpm-libs-1.20.7-17.el8.x86_64                          4&#x2F;5   Running scriptlet: gpm-libs-1.20.7-17.el8.x86_64                          4&#x2F;5   Installing       : vim-enhanced-2:8.0.1763-15.el8.x86_64                  5&#x2F;5   Running scriptlet: vim-enhanced-2:8.0.1763-15.el8.x86_64                  5&#x2F;5   Running scriptlet: vim-common-2:8.0.1763-15.el8.x86_64                    5&#x2F;5   Verifying        : gpm-libs-1.20.7-17.el8.x86_64                          1&#x2F;5   Verifying        : vim-common-2:8.0.1763-15.el8.x86_64                    2&#x2F;5   Verifying        : vim-enhanced-2:8.0.1763-15.el8.x86_64                  3&#x2F;5   Verifying        : vim-filesystem-2:8.0.1763-15.el8.noarch                4&#x2F;5   Verifying        : which-2.21-12.el8.x86_64                               5&#x2F;5 Installed:  gpm-libs-1.20.7-17.el8.x86_64         vim-common-2:8.0.1763-15.el8.x86_64      vim-enhanced-2:8.0.1763-15.el8.x86_64 vim-filesystem-2:8.0.1763-15.el8.noarch  which-2.21-12.el8.x86_64             Complete!Removing intermediate container 444473f309e6 ---&gt; 78cb874e438dStep 6&#x2F;10 : RUN yum -y install net-tools ---&gt; Running in 7311bbbb2557Last metadata expiration check: 0:00:08 ago on Fri Oct 15 03:20:15 2021.Dependencies resolved.&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; Package         Architecture Version                        Repository    Size&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Installing: net-tools       x86_64       2.0-0.52.20160912git.el8       baseos       322 kTransaction Summary&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Install  1 PackageTotal download size: 322 kInstalled size: 942 kDownloading Packages:net-tools-2.0-0.52.20160912git.el8.x86_64.rpm   2.1 MB&#x2F;s | 322 kB     00:00    --------------------------------------------------------------------------------Total                                           554 kB&#x2F;s | 322 kB     00:00     Running transaction checkTransaction check succeeded.Running transaction testTransaction test succeeded.Running transaction  Preparing        :                                                        1&#x2F;1   Installing       : net-tools-2.0-0.52.20160912git.el8.x86_64              1&#x2F;1   Running scriptlet: net-tools-2.0-0.52.20160912git.el8.x86_64              1&#x2F;1   Verifying        : net-tools-2.0-0.52.20160912git.el8.x86_64              1&#x2F;1 Installed:  net-tools-2.0-0.52.20160912git.el8.x86_64                                     Complete!Removing intermediate container 7311bbbb2557 ---&gt; d853a514f23dStep 7&#x2F;10 : EXPOSE 80 ---&gt; Running in 4c11e9c9381bRemoving intermediate container 4c11e9c9381b ---&gt; 4e1f8eeab200Step 8&#x2F;10 : CMD echo$MYPATH ---&gt; Running in 4e657781cf01Removing intermediate container 4e657781cf01 ---&gt; f59d25947e4cStep 9&#x2F;10 : CMD echo &quot;build finished&quot; ---&gt; Running in c91b3f839631Removing intermediate container c91b3f839631 ---&gt; b0dc3c46d320Step 10&#x2F;10 : CMD &#x2F;bin&#x2F;bash ---&gt; Running in 8633f3644184Removing intermediate container 8633f3644184 ---&gt; ea1d45e0166bSuccessfully built ea1d45e0166bSuccessfully tagged zylcentos:1.0</code></pre></div><p><strong>å®ä¾‹ï¼šTomcaté•œåƒ</strong></p><ol><li><p>å‡†å¤‡ï¼štomcat + jdkå‹ç¼©åŒ…</p></li><li><p>ç¼–å†™dockerfile</p><div class="code-wrapper"><pre class="language-dockerfile" data-language="dockerfile"><code class="language-dockerfile">FROM centosMAINTAINER zyl&lt;401177923@qq.com&gt;# ADDå¯ä»¥è‡ªåŠ¨è§£å‹  åé¢è·ŸæŒ‡å®šè·¯å¾„ADD jdk-8u202-linux-x64.tar.gz &#x2F;usr&#x2F;local&#x2F;ADD apache-tomcat-8.5.72.tar.gz &#x2F;usr&#x2F;local&#x2F;RUN yum -y install vimENV MYPATH &#x2F;usr&#x2F;localWORKDIR $MYPATHENV JAVA_HOME &#x2F;usr&#x2F;local&#x2F;jdk1.8.0_202ENV CLASSPATH $JAVA_HOME&#x2F;lib&#x2F;dt.jar:$JAVA_HOME&#x2F;lib&#x2F;tools.jarENV CATALINA_HOME &#x2F;usr&#x2F;local&#x2F;apache-tomcat-8.5.72ENV CATALINA_BASE &#x2F;usr&#x2F;local&#x2F;apache-tomcat-8.5.72ENV PATH $PATH:$JAVA_HOME&#x2F;bin:$CATALINA_HOME&#x2F;lib:$CATALINA_HOME&#x2F;binEXPOSE 8080CMD &#x2F;usr&#x2F;local&#x2F;apache-tomcat-8.5.72&#x2F;bin&#x2F;startup.sh &amp;&amp; tail -F &#x2F;usr&#x2F;local&#x2F;apache-tomcat-8.5.72&#x2F;bin&#x2F;logs&#x2F;catalina.out# docker run -d -p 9090:8080 --name zylstomcat -v &#x2F;home&#x2F;zyl&#x2F;zyltomcat&#x2F;test:&#x2F;usr&#x2F;local&#x2F;apache-tomcat-8.5.72&#x2F;webapps&#x2F;test -v &#x2F;home&#x2F;zyl&#x2F;zyltomcat&#x2F;tomcatlogs&#x2F;:&#x2F;usr&#x2F;local&#x2F;apache-tomcat-8.5.72&#x2F;logs zyltomcat# å½“ç„¶ ä¸»æœºæœåŠ¡å™¨éœ€è¦å¯¹å¤–æš´éœ²9090ç«¯å£</code></pre></div></li></ol><h2 id="å‘å¸ƒ">å‘å¸ƒ</h2><p>æœåŠ¡å™¨ä¸Šæäº¤</p><p>docker ç™»å½•</p><div class="code-wrapper"><pre class="language-shell" data-language="shell"><code class="language-shell">docker login -u ssss -password xxx# å½“ç„¶ï¼Œè¿™é‡Œå­˜çš„æ˜¯MD5æˆ–è€…æ˜¯å…¶ä»–æ•£åˆ—åçš„å¯†ç docker push imagename zyltomcat:1.0 # æœ€å¥½é™„å¸¦ç‰ˆæœ¬å·# pushé•œåƒé—®é¢˜ ï¼š æ²¡æœ‰tagThe push refers to repository [docker.io&#x2F;library&#x2F;zyltomcat]tag does not existdocker tag 7235ec815853 zyltomcat:1.0</code></pre></div><p><strong>å‘å¸ƒåˆ°é˜¿é‡Œäº‘</strong></p><p>å®˜ç½‘éƒ½æœ‰</p><p><strong>é•œåƒæ‰“åŒ…æˆtar å’Œ åŠ è½½</strong></p><p>docker save   docker load</p><h2 id="Dockerç½‘ç»œ">Dockerç½‘ç»œ</h2><p>æ ¸å¿ƒï¼šLinuxè™šæ‹ŸåŒ–ç½‘ç»œæŠ€æœ¯</p><h3 id="Docker0">Docker0</h3><div class="code-wrapper"><pre class="language-shell" data-language="shell"><code class="language-shell">ip a æŸ¥çœ‹ç½‘ç»œä¿¡æ¯[root@VM-4-4-centos ~]# ip a# æœ¬æœºåœ°å€1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000    link&#x2F;loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00    inet 127.0.0.1&#x2F;8 scope host lo       valid_lft forever preferred_lft forever    inet6 ::1&#x2F;128 scope host        valid_lft forever preferred_lft forever# é˜¿é‡Œäº‘å†…ç½‘åœ°å€2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000    link&#x2F;ether 52:54:00:c3:15:52 brd ff:ff:ff:ff:ff:ff    inet 10.0.4.4&#x2F;22 brd 10.0.7.255 scope global noprefixroute eth0       valid_lft forever preferred_lft forever    inet6 fe80::5054:ff:fec3:1552&#x2F;64 scope link noprefixroute        valid_lft forever preferred_lft forever# dockeråœ°å€# Bç±»ç½‘ç»œï¼Œå®¹çº³6ä¸‡å¤šä¸ªå­ç½‘3: docker0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN group default     link&#x2F;ether 02:42:ad:16:e9:c5 brd ff:ff:ff:ff:ff:ff    inet 172.17.0.1&#x2F;16 brd 172.17.255.255 scope global docker0       valid_lft forever preferred_lft forever    inet6 fe80::42:adff:fe16:e9c5&#x2F;64 scope link        valid_lft forever preferred_lft forever</code></pre></div><p>å¯åŠ¨ä¸€ä¸ªtomcatå®¹å™¨åï¼Œä¸»æœºip a,å¢åŠ äº†ä¸€ä¸ªç½‘å¡</p><div class="code-wrapper"><pre class="language-shell" data-language="shell"><code class="language-shell"># ä¸»æœºå†…çš„ã€‚å¹¶ä¸”æ³¨æ„è¿™é‡Œçš„inetå’Œdocker0çš„inetç½‘æ®µæ˜¯ç›¸åŒçš„ï¼68: eth0@if69: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default     link&#x2F;ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid 0    inet 172.17.0.2&#x2F;16 brd 172.17.255.255 scope global eth0       valid_lft forever preferred_lft forever# å®¹å™¨å†…çš„69: vethfcd0557@if68: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue master docker0 state UP group default     link&#x2F;ether b2:7e:eb:e8:24:aa brd ff:ff:ff:ff:ff:ff link-netnsid 0    inet6 fe80::b07e:ebff:fee8:24aa&#x2F;64 scope link        valid_lft forever preferred_lft forever# ä¸¤è€…æ˜¯å¯¹ç§°çš„</code></pre></div><p>é€šè¿‡å®¹å™¨å¢åŠ çš„ç½‘å¡ï¼Œéƒ½æ˜¯ä¸€å¯¹çš„ã€‚<br>evth-pairï¼Œå°±æ˜¯ä¸€å †è™šæ‹Ÿè®¾å¤‡æ¥å£ï¼Œæˆå¯¹å‡ºç°ï¼Œä¸€ç«¯æ¥åè®®ï¼Œä¸€æ®µå½¼æ­¤ç›¸è¿ã€‚å……å½“æ¡¥æ¢ï¼Œè¿æ¥å„ç§è™šæ‹Ÿç½‘ç»œè®¾å¤‡</p><p>docker å¦‚ä½•å¤„ç†å®¹å™¨è®¿é—®ç½‘ç»œï¼Ÿä¸»æœºèƒ½å¦pinåˆ°å®¹å™¨å†…çš„ipåœ°å€</p><p>æ­¤è¿‡ç¨‹ä¸­å¦‚æœå®¹å™¨å†…æ²¡æœ‰ip a æŒ‡ä»¤ï¼Œéœ€è¦é€šè¿‡aptå®‰è£…iproute2<br>æ²¡æœ‰pingï¼Œéœ€è¦å®‰è£…iputils-ping</p><p>veth-pair</p><ul><li>ipä¸»æœºèƒ½å¦pinåˆ°å®¹å™¨å†…çš„ipåœ°å€ï¼Ÿèƒ½</li><li>å®¹å™¨èƒ½å¦pingåˆ°ä¸»æœº(è¿™é‡Œç”¨çš„å†…ç½‘åœ°å€)ï¼Ÿèƒ½</li><li>å®¹å™¨pinå®¹å™¨èƒ½å¦piné€šï¼Ÿ</li></ul><h4 id="åŸç†-v2"><strong>åŸç†</strong></h4><ol><li>æ¯å¯åŠ¨ç»™ä¸€ä¸ªdockerå®¹å™¨ï¼Œdockerå°±ä¼šç»™å®¹å™¨åˆ†é…ä¸€ä¸ªip</li><li>åªè¦å®‰è£…äº†dockerï¼Œå°±ä¼šæœ‰ä¸€ä¸ªç½‘å¡docker0 â€” æ¡¥æ¥æ¨¡å¼ ----<strong>veth-pair</strong>æŠ€æœ¯</li><li>dockerä¸­æ‰€æœ‰çš„ç½‘ç»œæ¥å£éƒ½æ˜¯<strong>è™šæ‹Ÿ</strong>çš„ï¼Œè™šæ‹Ÿçš„è½¬å‘æ•ˆç‡é«˜</li></ol><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211021165235597.png" alt="image-20211021165235597"></p><p>tomcat01 ä¸ 02 å¹¶ä¸æ˜¯ç›´æ¥é€šä¿¡ï¼Œè€Œæ˜¯é€šè¿‡docker0å»è·¯ç”±ã€‚é€šè¿‡è¡¨ç»“æ„è®°å½•æˆ–è€…å¹¿æ’­çš„æ–¹å¼</p><h3 id="Veth-PairæŠ€æœ¯">Veth-PairæŠ€æœ¯</h3><h3 id="Link">Link</h3><p>é€šè¿‡nameå»pingå¯¹åº”çš„å®¹å™¨</p><div class="code-wrapper"><pre class="language-shell" data-language="shell"><code class="language-shell">docker run -d -P --name tomcat03 --link tomcat01 tomcat</code></pre></div><p>è¿™æ ·tomcat03èƒ½å¤Ÿpingé€š02ï¼Œä½†02pingä¸é€š03</p><p>docker network inspect bridgeid</p><div class="code-wrapper"><pre class="language-shell" data-language="shell"><code class="language-shell">[root@VM-4-4-centos ~]# docker network inspect 9be3892efc4c\[    &#123;        &quot;Name&quot;: &quot;bridge&quot;,        &quot;Id&quot;: &quot;9be3892efc4c9f1c47f9340dd9a10326e11d913a1a955176009bd3819912636c&quot;,        &quot;Created&quot;: &quot;2021-09-23T19:22:22.607525017+08:00&quot;,        &quot;Scope&quot;: &quot;local&quot;,        &quot;Driver&quot;: &quot;bridge&quot;,        &quot;EnableIPv6&quot;: false,        &quot;IPAM&quot;: &#123;            &quot;Driver&quot;: &quot;default&quot;,            &quot;Options&quot;: null,            &quot;Config&quot;: [                &#123;                    &quot;Subnet&quot;: &quot;172.17.0.0&#x2F;16&quot;,                    &quot;Gateway&quot;: &quot;172.17.0.1&quot;                &#125;            ]        &#125;,        &quot;Internal&quot;: false,        &quot;Attachable&quot;: false,        &quot;Ingress&quot;: false,        &quot;ConfigFrom&quot;: &#123;            &quot;Network&quot;: &quot;&quot;        &#125;,        &quot;ConfigOnly&quot;: false,        &quot;Containers&quot;: &#123;            &quot;a65b9eb65fd41e0321e26b7f0b73a55a45edf40016714d1108a39bea1388482a&quot;: &#123;                &quot;Name&quot;: &quot;tomcat02&quot;,                &quot;EndpointID&quot;: &quot;58a1eda21ee378bfd8c325d685ea44bc924cdca8c6a32f700d1020ffec6bfe3b&quot;,                &quot;MacAddress&quot;: &quot;02:42:ac:11:00:03&quot;,                &quot;IPv4Address&quot;: &quot;172.17.0.3&#x2F;16&quot;,                &quot;IPv6Address&quot;: &quot;&quot;            &#125;,            &quot;d7679b70e668b7403f0da46845b967ad5135a35a4b6fbfa4549da49462ed3b4c&quot;: &#123;                &quot;Name&quot;: &quot;tomcat01&quot;,                &quot;EndpointID&quot;: &quot;5f9452a5850efcc7abf8f3bdf2c9300c5fab48f410d8b32357e2cfe84433b33f&quot;,                &quot;MacAddress&quot;: &quot;02:42:ac:11:00:02&quot;,                &quot;IPv4Address&quot;: &quot;172.17.0.2&#x2F;16&quot;,                &quot;IPv6Address&quot;: &quot;&quot;            &#125;        &#125;,        &quot;Options&quot;: &#123;            &quot;com.docker.network.bridge.default_bridge&quot;: &quot;true&quot;,            &quot;com.docker.network.bridge.enable_icc&quot;: &quot;true&quot;,            &quot;com.docker.network.bridge.enable_ip_masquerade&quot;: &quot;true&quot;,            &quot;com.docker.network.bridge.host_binding_ipv4&quot;: &quot;0.0.0.0&quot;,            &quot;com.docker.network.bridge.name&quot;: &quot;docker0&quot;,            &quot;com.docker.network.driver.mtu&quot;: &quot;1500&quot;        &#125;,        &quot;Labels&quot;: &#123;&#125;    &#125;]</code></pre></div><p>åœ¨åˆ›å»ºtomcat03åï¼Œå¯ä»¥åœ¨docker Inspectä¸­çœ‹åˆ°</p><p>â€œLinksâ€: [â€œ/tomcat02:/tomcat03/tomcat02â€]</p><p>åŒæ—¶ï¼Œä¹Ÿåœ¨tomcat03çš„hostsä¸­å‘ç°</p><div class="code-wrapper"><pre class="language-shell" data-language="shell"><code class="language-shell">root@779098da59a7:&#x2F;usr&#x2F;local&#x2F;tomcat# cat &#x2F;etc&#x2F;hosts127.0.0.1       localhost::1     localhost ip6-localhost ip6-loopbackfe00::0 ip6-localnetff00::0 ip6-mcastprefixff02::1 ip6-allnodesff02::2 ip6-allrouters# è¿™é‡Œï¼Œç›´æ¥æŠŠtomcat02å†™æ­»åœ¨è¿™é‡Œï¼Œç”šè‡³åŒ…æ‹¬äº†idå’Œname172.17.0.3      tomcat02 a65b9eb65fd4# è¿™é‡Œå°±æ˜¯03çš„id172.17.0.4      779098da59a7</code></pre></div><h3 id="è‡ªå®šä¹‰ç½‘è·¯">è‡ªå®šä¹‰ç½‘è·¯</h3><p><strong>æ¡¥æ¥æ¨¡å¼</strong>ï¼šbridgeï¼ˆé»˜è®¤ï¼‰ï¼Œè½¬å‘</p><p><strong>none</strong>ï¼šä¸é…ç½®ç½‘ç»œ</p><p><strong>host</strong>ï¼šå’Œå®¿ä¸»æœºå…±äº«ç½‘ç»œ</p><p>ç›´æ¥å¯åŠ¨çš„å‘½ä»¤ï¼Œå…¶å®æœ‰é»˜è®¤çš„æŒ‡ä»¤ï¼ˆâ€“net bridgeï¼‰</p><ol><li>åˆ›å»º<br>docker network create --driver bridge --subnet 192.168.0.0/24 --gateway 192.168.0.1 zylnet,å°±åˆ›å»ºåˆ°networkä¸­å»äº†ã€‚å½“ç„¶ï¼Œä¹Ÿä¼šåœ¨ä¸»æœºå†…åˆ›å»ºè¿™ä¸ªç½‘å¡ï¼ˆç±»ä¼¼docker0ï¼‰</li><li>è¿™æ—¶å€™åˆ›å»ºçš„å®¹å™¨ï¼Œå¦‚æœæŒ‡å®šè¿™ä¸ªç½‘ç»œï¼Œé‚£å…¶ipéƒ½é‡‡ç”¨ä¸Šè¿°çš„åœ°å€</li><li><strong>å¯ä»¥ä¸ç”¨ä½¿ç”¨linkç›´æ¥æ¥pingåå­—</strong>ï¼ˆè‡ªå®šä¹‰çš„ç½‘ç»œèƒ½å¤Ÿå¸®æˆ‘ä»¬ç»´æŠ¤å¥½å¯¹åº”å…³ç³»ï¼‰<ul><li>ä¸ºå•¥å•Šï¼Ÿ</li></ul></li></ol><h3 id="ç½‘ç»œè¿é€š">ç½‘ç»œè¿é€š</h3><p>åŒä¸€ä¸»æœºä¸‹çš„ä¸åŒç½‘ç»œï¼Œæ¯”å¦‚docker0 çš„tomcatå’Œå¦å¤–ä¸€ä¸ªç½‘å¡çš„tomcatï¼ˆåœ¨ä¸åŒçš„ç½‘æ®µäº†ï¼‰</p><div class="note note-info">            <p>èƒ½å¤Ÿè®¿é—®ä¸åŒç½‘æ®µçš„ipå—ï¼Ÿ</p><p><strong>ä¸èƒ½</strong></p>          </div><p>è§£å†³æ–¹æ³•ï¼š</p><p><strong>ä¸€ä¸ªå®¹å™¨ä¸¤ä¸ªIP</strong></p><p>docker network connect æŠŠä¸€ä¸ªå®¹å™¨è¿æ¥åˆ°ä¸€ä¸ªç½‘ç»œ<br>å°±æ˜¯æŠŠtomcat01 æ”¾åˆ°äº†å¦ä¸€ä¸ªç½‘ç»œä¸‹</p><p><strong>è¯å®</strong></p><p>é€šè¿‡docker network inspect zylnetï¼Œå¯ä»¥çœ‹åˆ°ï¼Œ</p><p>å¯¹tomcat-01,ï¼ˆè¢«è¿æ¥çš„containerï¼‰</p><div class="code-wrapper"><pre class="language-shell" data-language="shell"><code class="language-shell">root@005986ed8954:&#x2F;usr&#x2F;local&#x2F;tomcat# ip a1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000    link&#x2F;loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00    inet 127.0.0.1&#x2F;8 scope host lo       valid_lft forever preferred_lft forever79: eth0@if80: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default     link&#x2F;ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid 0    inet 172.17.0.2&#x2F;16 brd 172.17.255.255 scope global eth0       valid_lft forever preferred_lft forever# è¿™é‡ŒæŠŠzylnetçš„é…ç½®ä¹ŸåŠ ä¸Šäº†81: eth1@if82: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default     link&#x2F;ether 02:42:c0:a8:00:04 brd ff:ff:ff:ff:ff:ff link-netnsid 0    inet 192.168.0.4&#x2F;24 brd 192.168.0.255 scope global eth1       valid_lft forever preferred_lft forever</code></pre></div><p>ä¹Ÿå¯ä»¥åœ¨tomcat-01çš„hostsæ–‡ä»¶ä¸­å‘ç°ï¼Œæ·»åŠ äº† æ–°ç½‘æ®µä¸‹åˆ†é…çš„æ–°çš„ipåœ°å€ï¼Œä¹Ÿèµ‹ç»™äº†è¿™ä¸ªå®¹å™¨id</p><div class="code-wrapper"><pre class="language-shell" data-language="shell"><code class="language-shell">172.17.0.2      005986ed8954192.168.0.4     005986ed8954</code></pre></div><p>è¿™æ—¶å€™ï¼Œä¸¤å°å®¹å™¨éƒ½å¯ä»¥é€šè¿‡æœ¬ç½‘æ®µä¸­çš„ipã€åå­—å»äº’pingï¼Œä½†æ˜¯<br>é€šè¿‡pingå¤–æ¥ä¸»æœºçš„åŸç½‘æ®µ172.xxx.xx.xxï¼Œæ˜¯pingä¸åˆ°çš„ï¼ˆå¯ä»¥ç†è§£ï¼‰</p><h2 id="åŸç†-v3">åŸç†</h2><h3 id="æ¦‚å¿µ-v3">æ¦‚å¿µ</h3><p>è™šæ‹Ÿæœºï¼šæ¨¡æ‹Ÿç³»ç»Ÿï¼Œåœ¨è½¯ä»¶å±‚é¢ä¸Šé€šè¿‡æ¨¡æ‹Ÿç¡¬ä»¶çš„è¾“å…¥å’Œè¾“å‡ºï¼Œè®©è™šæ‹Ÿæœºçš„æ“ä½œç³»ç»Ÿå¾—ä»¥è¿è¡Œåœ¨æ²¡æœ‰ç‰©ç†ç¡¬ä»¶çš„ç¯å¢ƒä¸­ï¼Œèƒ½å¤Ÿæ¨¡æ‹Ÿç¡¬ä»¶çš„è¾“å…¥è¾“å‡ºï¼ˆæ¯”å¦‚ASçš„emulatorå°±æ˜¯è¿™æ ·ï¼‰</p><ul><li>ä¸€èˆ¬æ¥è¯´è™šæ‹Ÿæœºä¼šæœ‰è‡ªå·±çš„kernelã€è‡ªå·±çš„ç¡¬ä»¶ï¼Œè™šæ‹Ÿæœºå¼€æœºæ—¶éœ€è¦å¼€æœºè‡ªæ£€ã€å¯åŠ¨kernelã€ç”¨æˆ·è¿›ç¨‹ç­‰ï¼Œååˆ†æ…¢</li><li>å¦‚æœ<strong>è™šæ‹Ÿæœºå’Œå®¿ä¸»æœºçš„kernelæ˜¯ä¸€è‡´</strong>çš„ï¼Œå°±ä¸éœ€è¦åšç¡¬ä»¶è¾“å…¥è¾“å‡ºçš„æ¬è¿å·¥  ---- æ“ä½œç³»ç»Ÿå±‚è™šæ‹ŸåŒ– ---- å®¹å™¨</li></ul><div class="note note-primary">            <p>Dockerå®¹å™¨æœ‰è‡ªå·±çš„å†…æ ¸å—ï¼Ÿ</p><p>æ²¡æœ‰ï¼Œdockerå’Œå®¿ä¸»æœºå…±äº«kernel</p>          </div><h3 id="å¸¦å…¥">å¸¦å…¥</h3><p>Linuxå¯åŠ¨æµç¨‹ä¸­çš„æ­¥éª¤</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211024230125804.png" alt="image-20211024230125804"></p><h2 id="ä¸€äº›é—®é¢˜">ä¸€äº›é—®é¢˜</h2><p><strong>docker run  attach  execçš„åŒºåˆ«</strong></p><p><strong>docker push ç›¸åŒå±‚çš„æ—¶å€™ä¼šæ€ä¹ˆåšï¼Ÿ</strong></p><p>ç›²çŒœï¼šä¸ä¼šå¯¹æ¯”ç›¸åŒçš„ï¼Œå› ä¸ºå¦‚æœè¦å¯¹æ¯”æ˜¯å¦idç›¸åŒæ—¶ï¼Œåˆ™è¦èŠ±è´¹å¾ˆå¤šæ—¶é—´ï¼Ÿ</p><p><strong>èƒ½åœ¨Macå’ŒWindowså¹³å°ä¸‹è·‘dockerçš„åŸå› </strong></p><h2 id="å®è·µ">å®è·µ</h2><h3 id="åˆ›å»ºå…è®¸SSHçš„CentOSå®¹å™¨">åˆ›å»ºå…è®¸SSHçš„CentOSå®¹å™¨</h3><p>Dockerfile</p><div class="code-wrapper"><pre class="language-dockerfile" data-language="dockerfile"><code class="language-dockerfile">FROM centos:7ENV container dockerRUN (cd &#x2F;lib&#x2F;systemd&#x2F;system&#x2F;sysinit.target.wants&#x2F;; for i in *; do [ $i &#x3D;&#x3D; \systemd-tmpfiles-setup.service ] || rm -f $i; done); \rm -f &#x2F;lib&#x2F;systemd&#x2F;system&#x2F;multi-user.target.wants&#x2F;*;\rm -f &#x2F;etc&#x2F;systemd&#x2F;system&#x2F;*.wants&#x2F;*;\rm -f &#x2F;lib&#x2F;systemd&#x2F;system&#x2F;local-fs.target.wants&#x2F;*; \rm -f &#x2F;lib&#x2F;systemd&#x2F;system&#x2F;sockets.target.wants&#x2F;*udev*; \rm -f &#x2F;lib&#x2F;systemd&#x2F;system&#x2F;sockets.target.wants&#x2F;*initctl*; \rm -f &#x2F;lib&#x2F;systemd&#x2F;system&#x2F;basic.target.wants&#x2F;*;\rm -f &#x2F;lib&#x2F;systemd&#x2F;system&#x2F;anaconda.target.wants&#x2F;*;# Official Resolution AboveENV MYPATH &#x2F;usr&#x2F;localWORKDIR $MYPATH# å¸¦vimå’Œnet-toolsRUN yum -y install vimRUN yum -y install net-toolsRUN yum -y install httpdRUN yum -y sudosystemctl enable httpd.service# æš´éœ²80ç«¯å£EXPOSE 80EXPOSE 22VOLUME [ &quot;&#x2F;sys&#x2F;fs&#x2F;cgroup&quot; ]CMD [&quot;&#x2F;usr&#x2F;sbin&#x2F;init&quot;]# docker build --rm -t dockerfile# docker run -d --name centos7-net-test01 -p 50044:22 -p 50043:80 -p 50042:8080 --privileged&#x3D;true centos:centos7 &#x2F;usr&#x2F;sbin&#x2F;init# docker exec -it centos7-net-test01 &#x2F;bin&#x2F;bash# yum install -y openssh-clients openssh-server# passwd æ·»åŠ å¯†ç </code></pre></div><p><strong>â€“privileged=true é¿å…æ— æ³•Systemctlå»å¯åŠ¨æœåŠ¡</strong></p><p>å¼€ç‰¹æƒã€‚å› ä¸ºDockerçš„ç†å¿µæ˜¯åœ¨å®¹å™¨é‡Œé¢ä¸è¿›è¡Œåå°æœåŠ¡ï¼Œå®¹å™¨æœ¬èº«å°±æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ä¸»è¿›ç¨‹ã€‚è€ŒSystemctléœ€è¦ç‰¹æƒå»è®¿é—®linuxå†…æ ¸ï¼Œè€Œå®¹å™¨å¹¶éä¸€ä¸ªå®Œæ•´çš„æ“ä½œç³»ç»Ÿï¼Œåªæ˜¯ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿã€‚å› æ­¤å®¹å™¨çš„è®¾è®¡åŸåˆ™ï¼š<strong>ä¸€ä¸ªå®¹å™¨é‡Œè¿è¡Œä¸€ä¸ªå‰å°æœåŠ¡</strong></p><p><strong>éœ€è¦æ˜ å°„ç«¯å£æŠŠå®¹å™¨å†…ç«¯å£æ˜ å°„åˆ°ä¸»æœºä¸‹ï¼Œæ‰èƒ½é€šè¿‡ä¸»æœºçš„ipï¼Œé¢„åˆ†é…çš„ç«¯å£å·æ¥è®¿é—®</strong></p><p><strong>centoså®‰è£…openssh-server</strong></p><p>yum install openssh-serverï¼Œ/etc/ssh/sshd å¼€å¯Port 22 Addressç­‰ï¼Œå¼€å¯PermitRootLoginâ€¦å¼€å¯PermitPasswordAuthenticate.ï¼Œå¼€å¯sshdæœåŠ¡ systemctl start sshd.</p><p><strong>åŠ¨æ€æ˜ å°„ç«¯å£åˆ°å®¹å™¨</strong></p><p>å…ˆæš‚åœdockeræœåŠ¡systemctl stop docker</p><p>æ‰¾åˆ°/var/lib/docker/containers/idxxxxx/config.v2.json æ·»åŠ </p><div class="code-wrapper"><pre class="language-json" data-language="json"><code class="language-json"><span class="token property">"ExposedPorts"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"22/tcp"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token property">"80/tcp"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token property">"8080/tcp"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token property">"Ports"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"22/tcp"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token property">"HostIp"</span><span class="token operator">:</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span><span class="token property">"HostPort"</span><span class="token operator">:</span><span class="token string">"50044"</span><span class="token punctuation">&#125;</span></code></pre></div><p>æ‰¾åˆ°åŒç›®å½•ä¸‹/hostjson  æ·»åŠ </p><div class="code-wrapper"><pre class="language-json" data-language="json"><code class="language-json"><span class="token property">"PortBindings"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"22/tcp"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token property">"HostIp"</span><span class="token operator">:</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token property">"HostPort"</span><span class="token operator">:</span><span class="token string">"50044"</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token property">"80/tcp"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token property">"HostIp"</span><span class="token operator">:</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token property">"HostPort"</span><span class="token operator">:</span><span class="token string">"50043"</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token property">"8080/tcp"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token property">"HostIp"</span><span class="token operator">:</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token property">"HostPort"</span><span class="token operator">:</span><span class="token string">"50042"</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></code></pre></div><p>å†å¼€å¯æœåŠ¡ï¼ŒæŒ‰ç†è¯´å°±å¯ä»¥åŠ¨æ€æ˜ å°„ï¼ˆæœªéªŒè¯ï¼‰</p>]]></content>
    
    
    
    <tags>
      
      <tag>Tool</tag>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é—®é¢˜ç›’å­</title>
    <link href="/2021/10/09/%E9%97%AE%E9%A2%98%E7%9B%92%E5%AD%90/"/>
    <url>/2021/10/09/%E9%97%AE%E9%A2%98%E7%9B%92%E5%AD%90/</url>
    
    <content type="html"><![CDATA[<h1>å­¦ä¹ ç–‘æƒ‘</h1><blockquote><p>é¿å…è‡ªå·±å¿˜è®°ï¼Œå»ºä¸ªåˆé›†ã€‚å­¦ä¹ æ—¶æ‰€æœ‰çš„ç–‘æƒ‘å’ŒåŸç†æ¢ç©¶éƒ½åœ¨è¿™å„¿å•¦</p></blockquote><!--toc--><h2 id="ç½‘ç»œ">ç½‘ç»œ</h2><h3 id="SSH-SFTPåŸç†">SSH SFTPåŸç†</h3><h3 id="SHA-RSAè¿‡ç¨‹">SHA \ RSAè¿‡ç¨‹</h3><h3 id="SCPåŸºäºSFTPå—">SCPåŸºäºSFTPå—</h3><h2 id="æ ¼å¼">æ ¼å¼</h2><h3 id="JPEGåˆ†æ">JPEGåˆ†æ</h3><h2 id="æ•°æ®ç»“æ„-v2">æ•°æ®ç»“æ„</h2><p><strong>æµ®ç‚¹å‹åˆ°åº•æ˜¯ä»€ä¹ˆ</strong>ï¼Ÿ</p><p><strong>Randomçš„seedç©¶ç«Ÿæ˜¯å•¥ï¼Ÿ</strong></p><span id="more"></span><h2 id="å¸¸è¯†">å¸¸è¯†</h2><h3 id="æ—¶åŒº-9-00æ˜¯å•¥æ„æ€ï¼Ÿ"><strong>æ—¶åŒº+9:00æ˜¯å•¥æ„æ€ï¼Ÿ</strong></h3><blockquote><p>æ­£å¼çš„æ—¶åŒºåŒ…æ‹¬24ä¸ªæ—¶åŒºï¼Œæ¯ä¸ªæ—¶åŒºç”±ä¸€ä¸ªè‹±æ–‡å­—æ¯è¡¨ç¤ºï¼Œæ¯ä¸ªç»åº¦15Â°ä¸ºä¸€ä¸ªæ—¶åŒºï¼Œæ¯ä¸ªæ—¶åŒºæœ‰ä¸€æ¡ä¸­å¤®å­åˆçº¿ã€‚è§„å®šç›¸é‚»çš„æ—¶åŒºç›¸å·®1å°æ—¶ã€‚</p><p>ä½†ä¸€ä¸ªå›½å®¶å¯èƒ½åŒæ—¶è·¨è¶Šå¤šä¸ªæ—¶åŒºï¼Œæ¯”å¦‚ä¸­å›½è·¨è¶Šäº†5ä¸ªæ—¶åŒºï¼Œä½†ä¸ºäº†æ–¹ä¾¿ï¼Œè¿˜æ˜¯æŒ‰ç…§ä¸œå…«æ—¶åŒºçš„æ ‡å‡†ï¼ˆä»¥åŒ—äº¬æ—¶é—´ä¸ºå‡†ï¼‰</p></blockquote><div class="note note-info">            <p><strong>å†å²</strong></p><p>1884å¹´ åç››é¡¿å¬å¼€å›½é™…ç»åº¦ä¼šè®®ï¼Œè§„å®šå…¨çƒåˆ’åˆ†24ä¸ªæ—¶åŒºã€‚è‹±å›½ï¼ˆæ ¼æ—å°¼æ²»å¤©æ–‡å°ï¼‰ä¸ºä¸­æ—¶åŒºï¼ˆé›¶æ—¶åŒºï¼‰ï¼Œä¸œ1-12åŒºï¼Œè¥¿1-12åŒºï¼ˆä¸œè¥¿12åŒºä¸ºä¸€ä¸ªåŒºï¼‰ã€‚ä¸œè¥¿12åŒºåœ¨ä¸¤è¾¹ä¹‹é—´å„è·¨åº¦7.5åº¦è€Œè¿æ¥ã€‚æ¯ä¸ªæ—¶åŒºçš„ä¸­å¤®ç»çº¿ä¸Šçš„æ—¶é—´å°±æ˜¯è¿™ä¸ªæ—¶åŒºç»Ÿä¸€é‡‡ç”¨çš„æ—¶é—´ï¼Œå«åŒºæ—¶</p>          </div><div class="note note-primary">            <p><strong>å¸¸è¯†</strong></p><p>UTC+8ï¼šä¸­å›½ã€æ–°åŠ å¡ï¼›<br>UTC+9ï¼šæ—¥æœ¬ã€éŸ©å›½<br>UTC-5ã€UTC-6ï¼šç¾å›½ã€åŠ æ‹¿å¤§</p>          </div><h3 id="å­—ç¬¦å’Œå­—èŠ‚åˆ°åº•æ€ä¹ˆåŒºåˆ†çš„å‘¢ï¼Ÿ"><strong>å­—ç¬¦å’Œå­—èŠ‚åˆ°åº•æ€ä¹ˆåŒºåˆ†çš„å‘¢ï¼Ÿ</strong></h3><p>å­—èŠ‚ï¼ŒåŸºæœ¬çš„æ•°æ®é‡å•ä½ï¼Œä¸€å­—èŠ‚ = 8 ä½<br>å­—ç¬¦æ˜¯è®¡ç®—æœºä¸­ä½¿ç”¨çš„å­—æ¯ã€æ•°å­—ã€å­—å’Œç¬¦å·</p><ul><li>ASCII ç ä¸­ï¼Œä¸€ä¸ªè‹±æ–‡å­—æ¯ï¼ˆä¸åˆ†å¤§å°å†™ï¼‰ä¸ºä¸€ä¸ªå­—èŠ‚ï¼Œä¸€ä¸ªä¸­æ–‡æ±‰å­—ä¸ºä¸¤ä¸ªå­—èŠ‚ã€‚</li><li>UTF-8 ç¼–ç ä¸­ï¼Œä¸€ä¸ªè‹±æ–‡å­—ä¸ºä¸€ä¸ªå­—èŠ‚ï¼Œä¸€ä¸ªä¸­æ–‡ä¸ºä¸‰ä¸ªå­—èŠ‚ã€‚</li><li>Unicode ç¼–ç ä¸­ï¼Œä¸€ä¸ªè‹±æ–‡ä¸ºä¸€ä¸ªå­—èŠ‚ï¼Œä¸€ä¸ªä¸­æ–‡ä¸ºä¸¤ä¸ªå­—èŠ‚ã€‚</li><li>ç¬¦å·ï¼šè‹±æ–‡æ ‡ç‚¹ä¸ºä¸€ä¸ªå­—èŠ‚ï¼Œä¸­æ–‡æ ‡ç‚¹ä¸ºä¸¤ä¸ªå­—èŠ‚ã€‚ä¾‹å¦‚ï¼šè‹±æ–‡å¥å· <strong>.</strong> å 1ä¸ªå­—èŠ‚çš„å¤§å°ï¼Œä¸­æ–‡å¥å· **ã€‚**å 2ä¸ªå­—èŠ‚çš„å¤§å°ã€‚</li><li>UTF-16 ç¼–ç ä¸­ï¼Œä¸€ä¸ªè‹±æ–‡å­—æ¯å­—ç¬¦æˆ–ä¸€ä¸ªæ±‰å­—å­—ç¬¦å­˜å‚¨éƒ½éœ€è¦ 2 ä¸ªå­—èŠ‚ï¼ˆUnicode æ‰©å±•åŒºçš„ä¸€äº›æ±‰å­—å­˜å‚¨éœ€è¦ 4 ä¸ªå­—èŠ‚ï¼‰ã€‚</li><li>UTF-32 ç¼–ç ä¸­ï¼Œä¸–ç•Œä¸Šä»»ä½•å­—ç¬¦çš„å­˜å‚¨éƒ½éœ€è¦ 4 ä¸ªå­—èŠ‚ã€‚</li></ul><p>å¯¹å„ç§ç¼–ç æ ¼å¼çš„è§£é‡Š</p><ul><li><p>ASCIIï¼Œç¾å›½ä¿¡æ¯äº¤æ¢æ ‡å‡†ä»£ç </p><ul><li>æ ‡å‡†ASCIIç ï¼Œä½128ä½</li><li>æ‰©å±•ASCIIç ï¼Œé«˜128ä½ï¼Œå…è®¸å°†æ¯ä¸ªå­—ç¬¦çš„ç¬¬8ä½ç”¨äºç¡®å®šé™„åŠ çš„128ä¸ªç‰¹æ®Šç¬¦å·å­—ç¬¦ã€å›¾å½¢ç¬¦å·</li></ul></li><li><p>Unicode ä¸‡å›½ç ã€å•ä¸€ç ã€‚å„å›½åˆä½œå¼€å‘ï¼Œä¸ºæ¯ç§è¯­è¨€çš„æ¯ä¸€ä¸ªå­—ç¬¦è®¾ç½®äº†å”¯ä¸€çš„ç¼–ç  ã€‚Unicodeç”¨æ•°å­—0-0x10FFFF(1114112ä¸ªä½ç½®)æ¥æ˜ å°„è¿™äº›å­—ç¬¦</p><ul><li>Unicodeçš„å­¦åæ˜¯&quot;Universal Multiple-Octet Coded Character Set&quot;ï¼Œç®€ç§°ä¸ºUCSã€‚</li><li>ç°åœ¨ç”¨çš„æ˜¯UCS-2ï¼Œå³2ä¸ªå­—èŠ‚ç¼–ç ï¼Œè€ŒUCS-4æ˜¯ä¸ºäº†é˜²æ­¢å°†æ¥2ä¸ªå­—èŠ‚ä¸å¤Ÿç”¨æ‰å¼€å‘çš„ã€‚</li></ul></li><li><p>UTF ï¼š UCS Transformation Formatçš„ç¼©å†™ï¼Œå¯ä»¥ç¿»è¯‘æˆUnicodeå­—ç¬¦é›†è½¬æ¢æ ¼å¼ï¼Œï¼Œå³æ€æ ·å°†Unicodeå®šä¹‰çš„æ•°å­—è½¬æ¢æˆç¨‹åºæ•°æ®</p><ul><li><p>ä¾‹å¦‚ï¼Œâ€œæ±‰å­—â€å¯¹åº”çš„æ•°å­—æ˜¯0x6c49å’Œ0x5b57ï¼Œè€Œç¼–ç çš„ç¨‹åºæ•°æ®æ˜¯ï¼š</p><p>BYTE data_utf8[] = {0xE6, 0xB1, 0x89, 0xE5, 0xAD, 0x97}; // UTF-8ç¼–ç ï¼Œä»¥å…«å­—èŠ‚å¯¹Unicodeè¿›è¡Œç¼–ç ,å¯ä»¥å¤šè¾¾4ä¸ªå­—èŠ‚ï¼Œæœ‰å¯¹åº”çš„ç¼–ç è§„åˆ™</p><p>WORD data_utf16[] = {0x6c49, 0x5b57}; // <a href="https://baike.baidu.com/item/UTF-16/9032026">UTF-16</a>ç¼–ç </p><p>DWORD data_utf32[] = {0x6c49, 0x5b57}; // <a href="https://baike.baidu.com/item/UTF-32/734460">UTF-32</a>ç¼–ç </p></li></ul></li></ul><h3 id="æ•²å›è½¦ååˆ°åº•å¢åŠ äº†æ˜¯ä¸¤ä¸ªå­—ç¬¦è¿˜æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼Ÿ"><strong>æ•²å›è½¦ååˆ°åº•å¢åŠ äº†æ˜¯ä¸¤ä¸ªå­—ç¬¦è¿˜æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼Ÿ</strong></h3><p>å…ˆé™„ä¸€å¼ ASCIIè¡¨</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211021150922618.png" alt="image-20211021150922618"></p><p>UTF-8ä¸­æ•²å›è½¦æ¢è¡Œæ˜¯ 0a è€Œä¸æ˜¯å›è½¦0d</p><h4 id="å›è½¦å’Œæ¢è¡Œ">å›è½¦å’Œæ¢è¡Œ</h4><ul><li>å›è½¦ï¼ˆCRâ€“Carriage Return,\rï¼‰ï¼šå°†å…‰æ ‡ç§»åŠ¨åˆ°å½“å‰è¡Œçš„å¼€å¤´</li><li>æ¢è¡Œï¼ˆLRâ€“Line Feed,\nï¼‰ï¼šå°†å…‰æ ‡å‚ç›´ç§»åŠ¨åˆ°ä¸‹ä¸€è¡Œ</li></ul><p>ä¸åŒæ“ä½œç³»ç»Ÿä¸‹çš„å«ä¹‰ï¼š<br>\n:  UNIX ç³»ç»Ÿè¡Œæœ«ç»“æŸç¬¦<br>\r\n: window ç³»ç»Ÿè¡Œæœ«ç»“æŸç¬¦(æ„Ÿè§‰è¿™ä¸ªä»åŸç†ä¸Šæ¥è¯´æ›´åŠ åˆç†)<br>\r:  MAC OS ç³»ç»Ÿè¡Œæœ«ç»“æŸç¬¦</p><div class="note note-primary">            <p>ç»å¸¸é‡åˆ°çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯ï¼ŒUnix/Macç³»ç»Ÿä¸‹çš„æ–‡ä»¶åœ¨Windowsé‡Œæ‰“å¼€çš„è¯ï¼Œæ‰€æœ‰æ–‡å­—ä¼šå˜æˆä¸€è¡Œï¼›è€ŒWindowsé‡Œçš„æ–‡ä»¶åœ¨Unix/Macä¸‹æ‰“å¼€çš„è¯ï¼Œåœ¨æ¯è¡Œçš„ç»“å°¾å¯èƒ½ä¼šå¤šå‡ºä¸€ä¸ª^Mç¬¦å·ã€‚</p>          </div><h4 id="è½¯å›è½¦å’Œç¡¬å›è½¦">è½¯å›è½¦å’Œç¡¬å›è½¦</h4><ul><li>è½¯å›è½¦ï¼šæŒ‰å›è½¦äº§ç”Ÿçš„ï¼Œæ¢è¡Œçš„åŒæ—¶è¿›è¡Œæ®µè½åˆ†å‰²</li><li>è½¯å›è½¦ï¼Œshift+enterï¼Œæ¢è¡Œä¸æ¢æ®µ(ç±»ä¼¼Markdownä¸­çš„)</li></ul><h2 id="æ“ä½œç³»ç»Ÿ">æ“ä½œç³»ç»Ÿ</h2><h3 id="Linux-v2">Linux</h3><p><strong>ifconfigæ˜¯å•¥ï¼Ÿnet-toolsåŒ…å«äº†å•¥ï¼Ÿ</strong></p><p><strong>ä¸ºä»€ä¹ˆmanjaroå¯ä»¥è®¿é—®windowsçš„æ–‡ä»¶ä½†windowså´ä¸è¡Œï¼Ÿ</strong></p><p><strong>Linux shellä¸Šçªç„¶ä¸­æ–­æ“ä½œæ˜¯äº‹åŠ¡ç±»å‹å—ï¼Ÿ</strong></p><p><strong>sshè¿œç¨‹ä¸¤ä¸ªç«¯å£å®‰è£…è½¯ä»¶ï¼Œä¼šå…ˆç­‰ä¸€ä¸ªå®‰è£…å¥½äº†ï¼Œå†è¿›è¡Œå¦ä¸€ä¸ªç«¯å£ä¸Šè½¯ä»¶çš„å®‰è£…</strong></p><h3 id="å…¶ä»–-v3">å…¶ä»–</h3><h4 id="64ä½ã€32ä½æ“ä½œåˆ°åº•æœ‰å•¥åŒºåˆ«ï¼Ÿ"><strong>64ä½ã€32ä½æ“ä½œåˆ°åº•æœ‰å•¥åŒºåˆ«ï¼Ÿ</strong></h4><p>è§è®¡ç®—æœºç»„æˆåŸç† â€œä¸€äº›é—®é¢˜å¤„â€</p><p><strong>GPUã€CPUçš„åŒºåˆ«ï¼Ÿ</strong></p><p>è§è®¡ç®—æœºç»„æˆåŸç†</p><h4 id="æ–‡ä»¶æ˜¯å¦‚ä½•è¢«å‹ç¼©çš„ï¼Ÿ">æ–‡ä»¶æ˜¯å¦‚ä½•è¢«å‹ç¼©çš„ï¼Ÿ</h4><h2 id="è¯­è¨€">è¯­è¨€</h2><h3 id="C">C</h3><h4 id="EOFæŒ‡çš„æ˜¯å•¥ï¼Ÿ">EOFæŒ‡çš„æ˜¯å•¥ï¼Ÿ</h4><h2 id="æ‚ä¸ƒæ‚å…«">æ‚ä¸ƒæ‚å…«</h2><p><strong>GIthubçš„ä¸œè¥¿éƒ½å­˜åœ¨å“ªå„¿äº† ï¼Œè¿™ä¹ˆå¤šäººéƒ½å¯ä»¥å…è´¹ä¸Šä¼ ä¸”ä¸é™åˆ¶å¤§å°é‚£å­˜å‚¨ç¡¬ç›˜å¾—æœ‰å¤šå°‘ï¼Ÿ</strong></p><p>Github2018å¹´å±…ç„¶è¢«å¾®è½¯æ”¶è´­äº†ã€‚  å¾®è½¯çš„äº’è¡¥å“ç­–ç•¥</p><p>ä»»ä½•åœ¨å¸‚åœºä¸­çš„äº§å“ã€æœåŠ¡æˆ–è€…è½¯ä»¶å…¶å®éƒ½å­˜åœ¨ç›¸å¯¹åº”çš„æ›¿ä»£å“ï¼ˆSubstitutesï¼‰å’Œäº’è¡¥å“ï¼ˆComplementï¼‰</p><ol><li>**æ›¿ä»£å“ï¼ˆSubstitutesï¼‰**æŒ‡çš„æ˜¯å½“ç”¨æˆ·è§‰å¾—ä½ çš„äº§å“ä»·æ ¼å¤ªè´µè€Œè€ƒè™‘å…¶ä»–çš„å…¶ä»–äº§å“ï¼Œæ¯”å¦‚çŒªè‚‰å°±æ˜¯ç‰›è‚‰çš„æ›¿ä»£å“ï¼Œå¦‚æœä½ æ˜¯å–çŒªè‚‰çš„ï¼Œå½“ç‰›è‚‰ä»·æ ¼ä¸Šæ¶¨çš„æ—¶å€™ï¼Œå¾ˆå¤šç”¨æˆ·å°±ä¼šæ¥ä¹°çŒªè‚‰ä»£æ›¿ï¼Œä½ çš„é”€é‡å°±ä¼šä¸Šå‡ã€‚</li><li>**äº’è¡¥å“ï¼ˆComplementï¼‰**æŒ‡çš„æ˜¯è·Ÿä½ çš„äº§å“ä¸€èµ·è´­ä¹°çš„ç›¸äº’è¡¥å……çš„äº§å“ï¼Œæ¯”å¦‚æ±½æ²¹å°±æ˜¯æ±½è½¦çš„äº’è¡¥å“ï¼Œå…¸å‹çš„ä¾‹å­æ¯”å¦‚æ“ä½œç³»ç»Ÿå’Œç”µè„‘ç¡¬ä»¶ä¹Ÿæ˜¯äº’è¡¥å“ï¼Œå½“ç”µè„‘çš„ä»·æ ¼ä¸‹é™çš„æ—¶å€™ï¼Œæ“ä½œç³»ç»Ÿçš„é”€é‡å°±ä¼šä¸Šå‡ã€‚</li></ol><p>å¯¹äºå…¬å¸è€Œè¨€ï¼Œä¸»è¦çš„æˆ˜ç•¥æ–¹å‘å°±æ˜¯å°½å¯èƒ½åœ°è®©è‡ªèº«æ ¸å¿ƒäº§å“ç›¸å¯¹åº”çš„<strong>äº’è¡¥å“çš„ä»·æ ¼é™ä½</strong>ï¼Œå¦‚æœä½ æœ‰èƒ½åŠ›è®©äº’è¡¥å“çš„ä»·æ ¼é™ä½ï¼Œä½ å°†èƒ½è·å¾—æ›´å¤šé”€é‡å’Œæ”¶å…¥å¹¶äº«å—ç”±äºäº’è¡¥å“å—ä¼—æ‰©å¤§å¸¦æ¥çš„æ›å…‰å’Œçƒ­åº¦ã€‚</p><p>å¾®è½¯æ”¹åéƒ¨ä»Šå¹´åˆå°† TSVS æ›´åä¸ºâ€œAzure DevOpsâ€ è¿›è¡ŒåŒ…è£…ä¸æ¨å‡ºã€‚GitHub - Azure Devops - Microsoft Azure çš„è·¯å¾„é€æ¸æ˜äº†ã€‚GitHub ä¸æˆ‘ä»¬é¢„æƒ³çš„ä¸€èˆ¬ï¼Œåœ¨å¾®è½¯çš„ä½“ç³»é‡Œæˆä¸ºå…¶ä¸‹æ¸¸äº§å“çš„äº’è¡¥å“ï¼ˆComplementï¼‰ã€‚</p><p><strong>DevOpsæ˜¯å•¥ï¼Ÿ</strong></p><p>DevOps æ˜¯å¼€å‘ (Dev) å’Œè¿è¥ (Ops) çš„å¤åˆè¯ï¼Œå®ƒå°†äººã€æµç¨‹å’ŒæŠ€æœ¯ç»“åˆèµ·æ¥ï¼Œä¸æ–­åœ°ä¸ºå®¢æˆ·æä¾›ä»·å€¼ã€‚DevOps å¯¹å›¢é˜Ÿæ„å‘³ç€ä»€ä¹ˆï¼ŸDevOps ä½¿ä»¥å‰å­¤ç«‹çš„è§’è‰²ï¼ˆå¼€å‘ã€IT è¿è¥ã€è´¨é‡å·¥ç¨‹å’Œå®‰å…¨ï¼‰å¯ä»¥åè°ƒå’Œåä½œï¼Œä»¥ç”Ÿäº§æ›´å¥½ã€æ›´å¯é çš„äº§å“ã€‚é€šè¿‡é‡‡ç”¨ DevOps æ–‡åŒ–ã€åšæ³•å’Œå·¥å…·ï¼Œå›¢é˜Ÿèƒ½å¤Ÿæ›´å¥½åœ°å“åº”å®¢æˆ·éœ€æ±‚ï¼Œå¢å¼ºå¯¹æ‰€æ„å»ºåº”ç”¨ç¨‹åºçš„ä¿¡å¿ƒï¼Œæ›´å¿«åœ°å®ç°ä¸šåŠ¡ç›®æ ‡ã€‚</p><p>ä¸ªäººæ„Ÿè§‰æ˜¯å¤§è§„æ¨¡çš„é›†ä¸­è¿ç»´+å¼€å‘+æµ‹è¯•ä¸€ç«™å¼å¹³å°</p><h1>ç”Ÿæ´»å¸¸è¯†</h1><h2 id="æ”¿æ²»">æ”¿æ²»</h2><h3 id="è´¸æ˜“é€†å·®"><strong>è´¸æ˜“é€†å·®</strong></h3><p>å›½å®¶æˆ–è€…åœ°åŒºåœ¨ä¸€å®šæ—¶æœŸå†…è¿›å£é¢ &gt; å‡ºå£é¢çš„ç°è±¡ï¼Œè¡¨æ˜å·²è¿‡å¯¹å¤–è´¸æ˜“å¤„äºä¸åˆ©çš„åœ°ä½ï¼ˆèµ„æœ¬å¤–æµã€å¤–å€ºå¢åŠ ï¼‰</p><ul><li>è´¸æ˜“é»‘å­—ã€è´¸æ˜“é¡ºå·®ï¼šå‡€å‡ºå£ä¸ºæ­£å€¼</li><li>è´¸æ˜“èµ¤å­—ã€è´¸æ˜“é€†å·®ï¼šå‡€å‡ºå£ä¸ºè´Ÿå€¼</li></ul><p><strong>è§£æ</strong></p><p>å¦‚æœä¸€ä¸ªå›½å®¶ç»å¸¸å‡ºç°<a href="https://baike.baidu.com/item/%E8%B4%B8%E6%98%93%E8%B5%A4%E5%AD%97">è´¸æ˜“èµ¤å­—</a>ç°è±¡ï¼Œä¸ºäº†è¦æ”¯ä»˜<a href="https://baike.baidu.com/item/%E8%BF%9B%E5%8F%A3">è¿›å£</a>çš„å€ºåŠ¡ï¼Œå¿…é¡»è¦åœ¨å¸‚åœºä¸Šå–å‡º<a href="https://baike.baidu.com/item/%E6%9C%AC%E5%B8%81">æœ¬å¸</a>ä»¥è´­ä¹°ä»–å›½çš„è´§å¸æ¥æ”¯ä»˜<a href="https://baike.baidu.com/item/%E5%87%BA%E5%8F%A3">å‡ºå£</a>å›½çš„å€ºåŠ¡ï¼Œè¿™æ ·ï¼Œ<a href="https://baike.baidu.com/item/%E5%9B%BD%E6%B0%91%E6%94%B6%E5%85%A5">å›½æ°‘æ”¶å…¥</a>ä¾¿ä¼šæµå‡ºå›½å¤–ï¼Œä½¿å›½å®¶ç»æµè¡¨ç°è½¬å¼±ã€‚æ”¿åºœè‹¥è¦æ”¹å–„è¿™ç§çŠ¶å†µï¼Œå°±å¿…é¡»è¦æŠŠå›½å®¶çš„<a href="https://baike.baidu.com/item/%E8%B4%A7%E5%B8%81%E8%B4%AC%E5%80%BC">è´§å¸è´¬å€¼</a>ï¼Œå› ä¸ºå¸å€¼ä¸‹é™ï¼Œå³å˜ç›¸æŠŠå‡ºå£å•†å“ä»·æ ¼é™ä½ï¼Œå¯ä»¥æé«˜å‡ºå£äº§å“çš„ç«äº‰èƒ½åŠ›ã€‚å› æ­¤ï¼Œå½“è¯¥å›½å¤–è´¸<a href="https://baike.baidu.com/item/%E8%B5%A4%E5%AD%97">èµ¤å­—</a>æ‰©å¤§æ—¶ï¼Œå°±ä¼šåˆ©æ·¡è¯¥å›½è´§å¸ï¼Œä»¤è¯¥å›½è´§å¸ä¸‹è·Œï¼›åä¹‹ï¼Œå½“å‡ºç°å¤–è´¸ç›ˆä½™æ—¶ï¼Œåˆ™æ˜¯åˆ©å¥½è¯¥ç§è´§å¸çš„ã€‚å› æ­¤ï¼Œå›½é™…è´¸æ˜“çŠ¶å†µæ˜¯å½±å“<a href="https://baike.baidu.com/item/%E5%A4%96%E6%B1%87%E6%B1%87%E7%8E%87">å¤–æ±‡æ±‡ç‡</a>ååˆ†é‡è¦çš„å› ç´ ã€‚</p><p><strong>è§‚ç‚¹ï¼š</strong></p><p><strong>è´¸æ˜“é¡ºå·®æœªå¿…éƒ½æ˜¯å¥½ç»“æœ</strong></p><ul><li>å¸¦æ¥è´¸æ˜“äº‰ç«¯</li><li>å¢åŠ å¤–æ±‡å‚¨å¤‡ï¼Œä½†å…¶å®æ˜¯èµ„æºæœªè¢«å……åˆ†åˆ©ç”¨</li><li>æŒç»­çš„é¡ºå·®å°†å¯¼è‡´äººæ°‘å¸å‡å€¼ï¼Œè¿›è€Œå¯¼è‡´èµ„æœ¬å‡€æµå…¥å¢åŠ ï¼Œè¿›ä¸€æ­¥å¯¼è‡´äººæ°‘å¸å‡å€¼çš„å‹åŠ›ï¼ˆåˆ©äºè¿›å£ï¼Œä¸åˆ©äºå‡ºå£ï¼Œæ¶æ€§å¾ªç¯ï¼‰</li><li>è½¬åŒ–ä¸ºè´§å¸å¤§é‡æŠ•å…¥çš„å‹åŠ›ï¼Œæˆä¸ºé€šè´§è†¨èƒ€ç‡ä¸Šå‡çš„å› ç´ </li></ul><p><strong>è´¸æ˜“é€†å·®ä¸ä¸€å®šæ˜¯åçš„</strong></p><ul><li>é€‚å½“é€†å·®åˆ©äºç¯èŠ‚çŸ­æœŸè´¸æ˜“çº çº·</li><li>é€†å·® = æŠ•èµ„è´­ä¹°ç”Ÿäº§æ€§è®¾å¤‡ï¼Œå¦‚æœæŠ•èµ„å¾—å½“ï¼Œèƒ½å¤Ÿæé«˜ç”Ÿäº§èƒ½åŠ›</li><li>å‡å°‘äººæ°‘å¸å‡å€¼çš„é¢„æœŸï¼Œå‡ç¼“èµ„æœ¬å‡€æµå…¥çš„é€Ÿåº¦</li><li>çŸ­æœŸçš„é€†å·®åˆ©äºç¼“è§£é€šè´§è†¨èƒ€çš„å‹åŠ›</li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>æ€»ç»“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®¡ç®—æœºç½‘ç»œ</title>
    <link href="/2021/09/18/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"/>
    <url>/2021/09/18/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/</url>
    
    <content type="html"><![CDATA[<h1>è®¡ç®—æœºç½‘ç»œå­¦ä¹ </h1><hr><h2 id="è®¡ç®—æœºç½‘ç»œå’Œå› ç‰¹ç½‘">è®¡ç®—æœºç½‘ç»œå’Œå› ç‰¹ç½‘</h2><span id="more"></span><!--toc--><h2 id="åº”ç”¨å±‚">åº”ç”¨å±‚</h2><h3 id="åº”ç”¨å±‚åè®®åŸç†">åº”ç”¨å±‚åè®®åŸç†</h3><h4 id="åº”ç”¨ç ”å‘ä¸»è¦ä½¿ç”¨çš„ä¸¤ç§ä¸»æµä½“ç³»ç»“æ„ï¼š"><strong>åº”ç”¨ç ”å‘ä¸»è¦ä½¿ç”¨çš„ä¸¤ç§ä¸»æµä½“ç³»ç»“æ„ï¼š</strong></h4><ul><li>å®¢æˆ·-æœåŠ¡å™¨ä½“ç³»ç»“æ„<ul><li>å®¢æˆ·ä¹‹é—´ä¸ç›´æ¥é€šä¿¡</li><li>æœåŠ¡å™¨å…·æœ‰å›ºå®šçš„ã€å‘¨çŸ¥çš„åœ°å€ï¼ˆIPåœ°å€ï¼‰</li><li>å¤§å‹åº”ç”¨éœ€é…å¤‡æ•°æ®ä¸­å¿ƒæ¥å¤„ç†è¯·æ±‚</li><li>(Webã€FTPã€ç”µå­é‚®ä»¶)</li></ul></li><li>å¯¹ç­‰(P2P)ä½“ç³»ç»“æ„<ul><li>å¯¹ä½äºæ•°æ®ä¸­å¿ƒçš„ä¸“ç”¨æœåŠ¡å™¨æœ‰æœ€å°çš„ä¾èµ–</li><li>åº”ç”¨ç¨‹åºåœ¨é—´æ–­è¿æ¥çš„ä¸»æœºå¯¹ï¼ˆå¯¹ç­‰æ–¹ï¼‰ä¹‹é—´<strong>ç›´æ¥é€šä¿¡</strong></li><li>è‡ªæ‰©å±•æ€§ï¼Œåœ¨P2Pæ–‡ä»¶å…±äº«åº”ç”¨ä¸­ï¼Œå°½ç®¡æ¯ä¸ªå¯¹ç­‰æ–¹éƒ½ç”±äºè¯·æ±‚æ–‡ä»¶äº§ç”Ÿäº†å·¥ä½œè´Ÿè½½ï¼Œä½†æ¯ä¸ªå¯¹ç­‰æ–¹é€šè¿‡å‘å…¶ä»–å¯¹ç­‰æ–¹åˆ†å‘æ–‡ä»¶ä¹Ÿä¸ºç³»ç»Ÿå¢åŠ äº†æœåŠ¡èƒ½åŠ›ã€‚</li><li>ä¸éœ€è¦åºå¤§çš„æœåŠ¡å™¨åŸºç¡€è®¾ç½®å’ŒæœåŠ¡å¸¦å®½</li><li>ï¼ˆBitTorrentã€è¿…é›·â€¦ï¼‰</li></ul></li></ul><h4 id="è¿›ç¨‹é€šä¿¡">è¿›ç¨‹é€šä¿¡</h4><p>è¿›è¡Œé€šä¿¡çš„å®é™…ä¸Šæ˜¯è¿›ç¨‹è€Œä¸æ˜¯ç¨‹åº</p><p>ä¸¤ä¸ªä¸åŒç«¯ç³»ç»Ÿä¸Šçš„è¿›ç¨‹ï¼Œé€šè¿‡è·¨è¶Šè®¡ç®—æœºç½‘ç»œäº¤æ¢<strong>æŠ¥æ–‡</strong>è€Œç›¸äº’é€šä¿¡</p><h5 id="å®¢æˆ·å’ŒæœåŠ¡å™¨è¿›ç¨‹">å®¢æˆ·å’ŒæœåŠ¡å™¨è¿›ç¨‹</h5><p>ä¸¤ä¸ªè¿›ç¨‹ä¸€ä¸ªä¸ºå®¢æˆ· ï¼Œå¦ä¸€ä¸ªä¸ºæœåŠ¡å™¨ã€‚</p><p>å®šä¹‰ï¼šåœ¨ä¸€å¯¹è¿›åŸä¹‹é—´çš„é€šä¿¡ä¼šè¯åœºæ™¯ä¸­ï¼Œå‘èµ·é€šè¯çš„è¿›ç¨‹è¢«æ ‡è¯†ä¸º<strong>å®¢æˆ·</strong>ï¼Œå†å›è¯å¼€å§‹æ—¶ç­‰å¾…è”ç³»çš„è¿›ç¨‹æ˜¯<strong>æœåŠ¡å™¨</strong></p><h5 id="è¿›ç¨‹ä¸è®¡ç®—æœºç½‘ç»œä¹‹é—´çš„æ¥å£">è¿›ç¨‹ä¸è®¡ç®—æœºç½‘ç»œä¹‹é—´çš„æ¥å£</h5><p>è¿›ç¨‹é€šè¿‡ä¸€ä¸ªå«<strong>å¥—æ¥å­—</strong>çš„è½¯ä»¶æ¥å£å‘ç½‘ç»œå‘é€æŠ¥æ–‡å’Œä»ç½‘ç»œæ¥å—æŠ¥æ–‡</p><p>å¥—æ¥å­—æ˜¯åŒä¸€å° ä¸»æœºå†…åº”ç”¨å±‚ä¸ä¼ è¾“å±‚ä¹‹é—´çš„æ¥å£ï¼Œä¹Ÿç§°ä¸º<strong>åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£</strong></p><h5 id="è¿›ç¨‹å¯»å€">è¿›ç¨‹å¯»å€</h5><p>å‘é‚®ä»¶éœ€è¦çŸ¥é“ç›®çš„åœ°å€</p><ol><li>ä¸»æœºçš„åœ°å€</li><li>åœ¨ç›®çš„ä¸»æœºä¸­æŒ‡å®šæ¥æ”¶è¿›ç¨‹çš„æ ‡è¯†ç¬¦</li></ol><p>å› ç‰¹ç½‘ä¸­ï¼Œä¸»æœºç”±IPåœ°å€æ ‡è¯†ï¼Œè¿˜å¿…é¡»åˆ¶å®šè¿è¡Œåœ¨æ¥å—ä¸»æœºä¸Šçš„æ¥æ”¶è¿›ç¨‹ï¼šç›®çš„åœ°ç«¯å£å·(port number)</p><h5 id="å¯ä¾›åº”ç”¨ç¨‹åºä½¿ç”¨çš„ä¼ è¾“æœåŠ¡">å¯ä¾›åº”ç”¨ç¨‹åºä½¿ç”¨çš„ä¼ è¾“æœåŠ¡</h5><ol><li><strong>å¯é æ•°æ®ä¼ è¾“</strong></li></ol><p>ç¡®ä¿ç”±åº”ç”¨ç¨‹åºä¸€æ®µå‘é€çš„æ•°æ®æ­£ç¡®å®Œå…¨åœ°äº¤ä»˜ç»™è¯¥åº”ç”¨ç¨‹åºçš„å¦ä¸€ç«¯</p><ol start="2"><li><strong>ååé‡</strong></li></ol><p>ååé‡ï¼šå‘é€è¿›ç¨‹èƒ½å¤Ÿå‘æ¥å—è¿›ç¨‹äº¤ä»˜æ¯”ç‰¹çš„é€Ÿç‡</p><p>è¿è¾“åè®®ç¡®ä¿å¯ç”¨ååé‡æ€»æ˜¯ä¸ºè‡³å°‘  r æ¯”ç‰¹ / s</p><p>åº”ç”¨äºå¸¦å®½æ•æ„Ÿåº”ç”¨</p><ol start="3"><li><strong>å®šæ—¶</strong></li></ol><p>è¦æ±‚æ•°æ®äº¤ä»˜æœ‰ä¸¥æ ¼çš„æ—¶é—´é™åˆ¶</p><ol start="4"><li><strong>å®‰å…¨æ€§</strong></li></ol><h4 id="å› ç‰¹ç½‘æä¾›çš„è¿è¾“æœåŠ¡">å› ç‰¹ç½‘æä¾›çš„è¿è¾“æœåŠ¡</h4><ol><li><p>TCPæœåŠ¡</p><ul><li><p>é¢å‘è¿æ¥æœåŠ¡</p><ul><li><p>ä¸‰æŒ¥å››æ¡ï¼Œå»ºç«‹TCPè¿æ¥ï¼Œå…¨åŒå·¥ã€æ‹¥å¡æ§åˆ¶</p></li><li><p>TCPåŠ å¼ºç‰ˆï¼›å®‰å…¨å¥—æ¥å­—å±‚ SSL (Secure Sockets Layer)ï¼Œæä¾›äº†å…³é”®çš„è¿›ç¨‹åˆ°è¿›ç¨‹çš„å®‰å…¨æ€§æœåŠ¡</p><p>SSLåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ç›¸å½“äºä¸­é—´äºº  å‘é€æ–¹æ•°æ®ä»ï¼š è¿›ç¨‹â€“&gt;SSLâ€“&gt;TCP</p></li></ul></li><li><p>å¯é æ•°æ®ä¼ è¾“æœåŠ¡</p></li></ul><p>TCPå’ŒUDPéƒ½æ²¡æœ‰ä»»ä½•åŠ å¯†æœºåˆ¶ï¼Œå‘é€è¿›ç¨‹ä¼ è¿›å¥—æ¥å­—çš„æ•°æ®ä¸ç»ç½‘ç»œä¼ é€åˆ°ç›®çš„è¿›ç¨‹çš„æ•°æ®ç›¸åŒ</p></li><li><p>UDPæœåŠ¡</p><p>ä¸å¯é ä¼ è¾“ï¼Œæ•°æ®å¯èƒ½ä¹±åºåˆ°è¾¾ï¼Œä¸ä¿è¯é€Ÿç‡</p></li><li><p>å› ç‰¹ç½‘è¿è¾“åè®®æ‰€ä¸æä¾›çš„æœåŠ¡</p><p>ä¸æä¾›ä»»ä½•å®šæ—¶å’Œå¸¦å®½ä¿è¯</p></li></ol><h4 id="åº”ç”¨å±‚åè®®">åº”ç”¨å±‚åè®®</h4><p>å¦‚ä½•æ„é€ æŠ¥æ–‡ï¼ŸæŠ¥æ–‡ä½•æ—¶å‘é€ï¼Ÿ</p><h3 id="Webå’ŒHTTP">Webå’ŒHTTP</h3><p>Webçš„åº”ç”¨å±‚åè®®æ˜¯è¶…æ–‡æœ¬ä¼ è¾“åè®® ï¼ŒHTTP</p><p>Webé¡µé¢æ˜¯ç”±å¯¹è±¡ç»„æˆçš„ï¼Œä¸€ä¸ªå¯¹è±¡åªæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œå¤šæ•°Webæ–‡ä»¶åŒ…å«ä¸€ä¸ªHTMLåŸºæœ¬æ–‡ä»¶å’Œå‡ ä¸ªå¼•ç”¨å¯¹è±¡</p><h4 id="æŒç»­è¿æ¥å’ŒéæŒç»­è¿æ¥"><strong>æŒç»­è¿æ¥å’ŒéæŒç»­è¿æ¥</strong></h4><p>æ‰€æœ‰çš„è¯·æ±‚å’Œç›¸åº”æ˜¯å¦ç»è¿‡ç›¸åŒçš„TCPè¿æ¥å‘é€</p><p>Httpä¸¤ç§è¿æ¥æ–¹å¼éƒ½èƒ½ä½¿ç”¨ï¼Œé»˜è®¤ä½¿ç”¨æŒç»­è¿æ¥</p><ol><li><p>éæŒç»­è¿æ¥</p><p>P.66 ä¾‹å­</p><p>å¾€è¿”æ—¶é—´ RTTï¼šä¸€ä¸ªçŸ­åˆ†ç»„ä»å®¢æˆ·åˆ°æœåŠ¡å™¨ç„¶åå†è¿”å›å®¢æˆ·æ‰€èŠ±è´¹çš„æ—¶é—´</p><p>ç¼ºç‚¹ï¼š</p></li><li><p>å¿…é¡»ä¸ºæ¯ä¸ªè¯·æ±‚çš„å¯¹è±¡å»ºç«‹å’Œç»´æŠ¤ä¸€ä¸ªå…¨æ–°çš„è¿æ¥ï¼ˆå®¢æˆ·å’ŒæœåŠ¡å™¨ä¸­éƒ½è¦åˆ†é…TCPçš„ç¼“å†²åŒºï¼Œç»™æœåŠ¡å™¨å¸¦æ¥è´Ÿæ‹…ï¼‰</p></li><li><p>æ¯ä¸ªå¯¹è±¡è¦ç»å—ä¸¤å€RTTçš„äº¤ä»˜æ—¶å»¶ï¼ˆä¸€ä¸ªç”¨äºåˆ›å»ºTCPï¼Œå¦ä¸€ä¸ªç”¨äºè¯·æ±‚å’Œæ¥å—å¯¹è±¡ï¼‰</p></li><li><p>æŒç»­è¿æ¥</p><p>TCPè¿æ¥æ‰“å¼€åï¼Œåç»­çš„è¯·æ±‚å’Œå“åº”æŠ¥æ–‡èƒ½å¤Ÿé€šè¿‡ç›¸åŒçš„è¿æ¥è¿›è¡Œä¼ é€</p></li></ol><h4 id="HTTPæŠ¥æ–‡æ ¼å¼">HTTPæŠ¥æ–‡æ ¼å¼</h4><p><strong>è¯·æ±‚æŠ¥æ–‡</strong></p><p><img src="/opt/Hexo/source/_posts/C:%5CUsers%5C40117%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210909161630008.png" alt="image-20210909161630008"></p><p>é¦–éƒ¨è¡Œã€è¯·æ±‚è¡Œã€å®ä½“ä½“</p><p>å®ä½“ä½“ï¼ˆemtity bodyï¼‰ POSTæŠ¥æ–‡ä¸­ç”¨æˆ·åœ¨è¡¨å•å­—æ®µè¾“å…¥çš„å€¼</p><p><strong>å“åº”æŠ¥æ–‡</strong></p><p>åˆå§‹çŠ¶æ€è¡Œ ï¼šåè®®/ç‰ˆæœ¬å­—æ®µ  çŠ¶æ€ç  çŠ¶æ€ä¿¡æ¯</p><p>é¦–éƒ¨è¡Œ</p><p>å®ä½“ä½“ï¼ˆæŠ¥æ–‡çš„ä¸»è¦æˆåˆ†ï¼‰</p><p><a href="https://blog.csdn.net/banana960531/article/details/85621865?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522163117576216780271516167%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=163117576216780271516167&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-85621865.first_rank_v2_pc_rank_v29&amp;utm_term=%E5%B8%B8%E8%A7%81%E7%8A%B6%E6%80%81%E7%A0%81&amp;spm=1018.2226.3001.4187">å¸¸è§çŠ¶æ€ç </a></p><h4 id="ç”¨æˆ·å’ŒæœåŠ¡å™¨çš„äº¤äº’cookie">ç”¨æˆ·å’ŒæœåŠ¡å™¨çš„äº¤äº’cookie</h4><p>4ä¸ªéƒ¨ç½²ï¼š</p><ol><li>HTTPç›¸åº”æŠ¥æ–‡æœ‰cookieé¦–éƒ¨è¡Œ</li><li>HTTPè¯·æ±‚æŠ¥æ–‡ä¸­æœ‰cookieé¦–éƒ¨è¡Œ</li><li>ç”¨æˆ·ç«¯ç³»ç»Ÿä¿ç•™cookieæ–‡ä»¶ï¼ˆæµè§ˆå™¨ï¼‰</li><li>Webç«™ç‚¹ä¾¯ä¸¹æ•°æ®åº“ä¿å­˜</li></ol><p>Webç«™ç‚¹å¸Œæœ›è¯†åˆ«ç”¨æˆ·ï¼ŒæŠŠå†…å®¹ä¸ç”¨æˆ·èº«ä»½è”ç³»èµ·æ¥ p70ä¾‹å­ï¼šè´­ç‰©ç½‘ç«™è®°å½•åŠ å…¥è´­ç‰©è½¦çš„ç‰©å“ï¼ˆç”šè‡³åœ¨æœªç™»å½•çš„æƒ…å†µä¸‹ï¼‰</p><h4 id="Webç¼“å­˜">Webç¼“å­˜</h4><p>Webç¼“å­˜ä¹Ÿå«ä»£ç†æœåŠ¡å™¨ï¼Œä¿å­˜æœ€è¿‘è¯·æ±‚è¿‡çš„å¯¹è±¡çš„å‰¯æœ¬</p><p>é€šè¿‡Webç¼“å­˜è¯·æ±‚ç½‘é¡µï¼š</p><ol><li>åˆ›å»ºä¸€ä¸ªåˆ°Webç¼“å­˜å™¨çš„TCPï¼Œå‘ç¼“å­˜å™¨ä¸­çš„å¯¹è±¡å‘é€ä¸€ä¸ªHTTPè¯·æ±‚</li><li>ç¼“å­˜å™¨è¿›è¡Œæ£€æŸ¥ï¼Œæ˜¯å¦æœ¬åœ°æœ‰ç›¸åº”å¯¹è±¡çš„å‰¯æœ¬ï¼Œè‹¥æœ‰åˆ™ç”¨HTTPå“åº”æŠ¥æ–‡è¿”å›è¯¥å¯¹è±¡ã€‚å¦‚æœæ²¡æœ‰ï¼Œå°±æ‰“å¼€ä¸€ä¸ªä¸è¿™ä¸ªå¯¹è±¡çš„åˆå§‹æœåŠ¡å™¨ï¼ˆåŸå§‹åœ°å€ï¼‰çš„TCPè¿æ¥ï¼Œå¹¶åœ¨è¿™ä¸ªç¼“å­˜å™¨åˆ°æœåŠ¡å™¨çš„TCPè¿æ¥ä¸Šå‘é€ä¸€ä¸ªå¯¹è¯¥å¯¹è±¡çš„HTTPè¯·æ±‚ï¼Œæ”¶åˆ°è¯·æ±‚åï¼Œåˆå§‹æœåŠ¡å™¨å‘è¯¥Webç¼“å­˜å™¨å‘é€å…·æœ‰è¯¥å¯¹è±¡çš„HTTPå“åº”</li><li>ç¼“å­˜å™¨æ”¶åˆ°è¯¥å¯¹è±¡æ—¶ï¼Œåœ¨æœ¬åœ°å­˜å‚¨ä¸€ä»½å‰¯æœ¬ï¼Œå¹¶å‘å®¢æˆ·çš„æµè§ˆå™¨ç”¨HTTPå“åº”æŠ¥æ–‡å‘é€è¯¥å‰¯æœ¬</li></ol><p>æ­¤è¿‡ç¨‹ä¸­WebæœåŠ¡å™¨æ—¢æ˜¯æœåŠ¡å™¨åˆæ˜¯å®¢æˆ·</p><p>eg: ä¸æ ¡å›­ç½‘è¿æ¥æœ‰å…³ï¼Œæ¶‰åŠåˆ°<strong>å†…å®¹åˆ†å‘ç½‘ç»œCDN</strong></p><p>ä¼˜ç‚¹ï¼š</p><ol><li>å‡å°‘å¯¹å®¢æˆ·è¯·æ±‚çš„å“åº”æ—¶é—´ï¼ŒWebæœåŠ¡å™¨è¿…é€Ÿå°†è¯¥å¯¹è±¡äº¤ä»˜ç»™ç”¨æˆ·</li><li>å‡å°‘ä¸€ä¸ªæœºæ„çš„æ¥å…¥é“¾è·¯åˆ°å› ç‰¹ç½‘çš„é€šä¿¡ï¼Œå‡å°‘äº†é€šä¿¡é‡å°±ä¸å¿…æ€¥äºå¢åŠ å¸¦å®½ï¼Œå› æ­¤é™ä½äº†è´¹ç”¨</li></ol><p>æ€è€ƒ: ç¼“å­˜å™¨å­˜å‚¨çš„HTTPå“åº”å¯¹è±¡æ˜¯å¦è¿‡æ—¶æ€ä¹ˆåˆ¤æ–­ï¼Ÿ</p><p>HTTPå…è®¸ç¼“å­˜å™¨è¯å®ä»–çš„å¯¹è±¡æ˜¯æœ€æ–°çš„ï¼š æ¡ä»¶GETæ–¹æ³•ã€‚</p><ol><li>å¦‚æœè¯·æ±‚æŠ¥æ–‡ä½¿ç”¨GETæ–¹æ³•</li><li>è¯·æ±‚æŠ¥æ–‡ä¸­åŒ…å«&quot;If-Modified-Since&quot;é¦–éƒ¨è¡Œ</li></ol><p>åˆ™è¿™ä¸ªæŠ¥æ–‡å°±æ˜¯ä¸€ä¸ªæ¡ä»¶GETè¯·æ±‚æŠ¥æ–‡</p><p>è¿‡äº†å¾ˆä¹…å»è¯·æ±‚ç¼“å­˜å™¨ä¸­çš„å¯¹è±¡æ—¶ï¼Œä¼šå†å‘ä¸€æ¡æ¡ä»¶GETè¯·æ±‚æŠ¥æ–‡æ‰§è¡Œæœ€æ–°æ£€æŸ¥</p><p>If-Modified-Sinceï¼šå…¶å€¼è¡¨ç¤ºä¹‹å‰æœ€è¿‘ä¸€æ¬¡æœåŠ¡å™¨å“åº”æ—¶é—´ï¼ˆä»…å½“åœ¨æŒ‡å®šæ—¥æœŸä¹‹åè¯¥å¯¹è±¡è¢«ä¿®æ”¹æ‰å‘é€æ–°çš„ï¼‰</p><p>å¦‚æœæ²¡æœ‰è¢«ä¿®æ”¹ï¼š æœåŠ¡å™¨å‘é€å“åº”æŠ¥æ–‡ï¼ŒçŠ¶æ€è¡Œä¸º 304ï¼ŒçŠ¶æ€ä¿¡æ¯ï¼šNot Modifiedï¼Œä»¥æ­¤å‘ŠçŸ¥ç¼“å­˜å™¨</p><h4 id="å› ç‰¹ç½‘ä¸­çš„ç”µå­é‚®ä»¶">å› ç‰¹ç½‘ä¸­çš„ç”µå­é‚®ä»¶</h4><p>ä¸‰ä¸ªç»„æˆéƒ¨åˆ†ï¼šç”¨æˆ·ä»£ç†ã€é‚®ä»¶æœåŠ¡å™¨ã€ç®€å•é‚®ä»¶ä¼ è¾“åè®®SMTP</p><p>SMTPï¼šï¼šå› ç‰¹ç½‘ç”µå­é‚®ä»¶çš„æ ¸å¿ƒ</p><p>é‡‡ç”¨7æ¯”ç‰¹ASCIIç æ ¼å¼</p><p>SMTPä¸€èˆ¬ä¸é€‚ç”¨ä¸­é—´é‚®ä»¶æœåŠ¡å™¨å‘é€é‚®ä»¶ï¼Œä¸€èˆ¬æ˜¯ä¸¤ä¸ªæœåŠ¡å™¨ç›´è¿ï¼Œè¿æ¥æ–¹å¼ï¼šTCP</p><p><strong>HTTPå’ŒSMTP</strong></p><ul><li>éƒ½æ˜¯ä»ä¸€å°ä¸»æœºå‘å¦å¤–ä¸€å°ä¸»æœºå‘é€æ–‡ä»¶</li><li>éƒ½ä½¿ç”¨æŒç»­è¿æ¥</li></ul><p>HTTPï¼šWebæœåŠ¡å™¨å‘Webå®¢æˆ·ä¼ é€æ–‡ä»¶ï¼Œæ˜¯ä½¿ç”¨<strong>æ‹‰åè®®</strong>ï¼Œç”±å‘æ¥æ”¶æ–‡ä»¶çš„æœºå™¨å‘èµ·çš„ã€‚å¤„ç†ï¼ˆæ–‡æœ¬å’Œå›¾åƒæ—¶ï¼Œå°†æ¯ä¸ªå¯¹è±¡å°è£…åˆ°è‡ªå·±çš„HTTPå“åº”æŠ¥æ–‡ä¸­ï¼‰</p><p>SMTPï¼šä¸€ä¸ªé‚®ä»¶æœåŠ¡å™¨å‘å¦ä¸€ä¸ªé‚®ä»¶æœåŠ¡å™¨ä¼ é€æ–‡ä»¶ï¼Œä½¿ç”¨<strong>æ¨åè®®</strong>ï¼Œç”±æƒ³å‘é€æ–‡ä»¶çš„æœºå™¨å‘èµ·çš„ã€‚å¤„ç†ï¼ˆæ–‡æœ¬å’Œå›¾åƒæ—¶ï¼Œå°†æ‰€æœ‰æŠ¥æ–‡å¯¹è±¡æ”¾åœ¨ä¸€ä¸ªæŠ¥æ–‡ä¸­ï¼‰</p><h5 id="é‚®ä»¶æŠ¥æ–‡æ ¼å¼">é‚®ä»¶æŠ¥æ–‡æ ¼å¼</h5><p>RFC 5322å®šä¹‰</p><p>æ¯ä¸ªé¦–éƒ¨å¿…é¡»åŒ…å«ä¸€ä¸ªFromå’Œä¸€ä¸ªToé¦–éƒ¨è¡Œç„¶åæ˜¯å¯é€‰é¦–éƒ¨è¡Œ + ä¸€ä¸ªç©ºç™½è¡Œ+æŠ¥æ–‡ä½“</p><h5 id="é‚®ä»¶è®¿é—®åè®®">é‚®ä»¶è®¿é—®åè®®</h5><p>Aliceä»£ç† â€”(SMTP) &gt; Aliceé‚®ä»¶æœåŠ¡å™¨  â€”(SMTP)&gt; Bobé‚®ä»¶æœåŠ¡å™¨ â€”(pop3\imap\http)&gt; Bobä»£ç†</p><p>é¿å…äº†æˆ‘ç»™ä½ å‘é‚®ä»¶æ—¶ä½ ä¸åœ¨ï¼Œæ¥å—ä¸åˆ°çš„é—®é¢˜</p><p>æœ€åä¸€æ­¥ä¸æ˜¯SMTPæ˜¯å› ä¸ºSMTPæ˜¯æ¨åè®®è€Œä¸æ˜¯æ‹‰åè®®</p><blockquote><p>POP3: Post Offical Prootocol --Version 3 ç¬¬ä¸‰ç‰ˆçš„é‚®å±€åè®®</p><p>IMAP : Internet Mail Access Protocol å› ç‰¹ç½‘é‚®ä»¶è®¿é—®åè®®</p></blockquote><p><strong>POP3</strong></p><p>å½“å®¢æˆ·æ‰“å¼€ä¸€ä¸ªåˆ°é‚®ä»¶æœåŠ¡å™¨ç«¯å£110ä¸Šçš„TCPè¿æ¥æ—¶ï¼ŒPOP3å°±å¼€å§‹å“¦å·¥ä½œäº†</p><p>ä¸‰ä¸ªé˜¶æ®µï¼šç‰¹è®¸ã€äº‹åŠ¡å¤„ç†å’Œæ›´æ–°</p><ul><li>ç‰¹è®¸ï¼šæ˜æ–‡å½¢å¼ç”¨æˆ·åå’Œå£ä»¤é‰´åˆ«ç”¨æˆ·</li><li>äº‹åŠ¡å¤„ç†ï¼šç”¨æˆ·ä»£ç†å–å›æŠ¥æ–‡ï¼Œå¹¶ä¸”è¿˜å¯ä»¥å¯¹æŠ¥æ–‡åšåˆ é™¤æ ‡è®°ã€å–æ¶ˆæŠ¥æ–‡åˆ é™¤æ ‡è®°ã€è·å–é‚®ä»¶çš„ç»Ÿè®¡ä¿¡æ¯ç­‰</li><li>æ›´æ–°ï¼šç»“æŸPOP3ä¼šè¯</li></ul><p>æ­£å¸¸ +OK é”™è¯¯-ERR</p><p>å¯é…ç½®çš„ä¸¤ç§æ–¹å¼ï¼šä¸‹è½½å¹¶åˆ é™¤ã€ä¸‹è½½å¹¶ä¿å­˜</p><p><strong>IMAP</strong></p><p>POP3åè®®æ²¡æœ‰ç»™ç”¨æˆ·æä¾›ä»»ä½•åˆ›å»ºè¿œç¨‹æ–‡ä»¶å¤¹å¹¶ä¸ºæŠ¥æ–‡æŒ‡æ´¾æ–‡ä»¶å¤¹çš„æ–¹æ³•</p><p>æŠŠæ¯ä¸ªæŠ¥æ–‡äºä¸€ä¸ªæ–‡ä»¶å¤¹è”ç³»èµ·æ¥æŠ¥æ–‡ç¬¬ä¸€æ¬¡åˆ°è¾¾æœåŠ¡å™¨æ—¶ï¼Œä»–ä¸æ”¶ä»¶äººçš„INBOXæ–‡ä»¶å¤¹ç›¸å…³è”ï¼Œä¸”è¿˜å…·æœ‰å…è®¸ç”¨æˆ·ä»£ç†è·å–æŠ¥æ–‡æŸäº›éƒ¨åˆ†çš„å‘½ä»¤</p><p><strong>åŸºäºWebçš„ç”µå­ä»£ç†é‚®ä»¶</strong></p><p>ç›®å‰ä¸»æµã€‚ç”¨æˆ·ä»£ç†æ˜¯æ™®é€šçš„æµè§ˆå™¨ï¼Œä¸è¿œç¨‹é‚®ç®±çš„é€šä¿¡é€šè¿‡HTTPè¿›è¡Œã€‚</p><p>ä»£ç†åˆ°é‚®ä»¶æœåŠ¡å™¨æ˜¯HTTPï¼Œä½†é‚®ä»¶æœåŠ¡å™¨å’Œé‚®ä»¶æœåŠ¡å™¨ä¹‹é—´çš„æ¥å‘é‚®ä»¶è¿˜æ˜¯SMTP</p><p><strong>æ€è€ƒï¼š å¦‚ä»Šçš„mailé‚®ç®±å¦‚ä½•è¿›è¡Œlistçš„ï¼Ÿ</strong></p><h4 id="DNSï¼šå› ç‰¹ç½‘çš„ç›®å½•æœåŠ¡">DNSï¼šå› ç‰¹ç½‘çš„ç›®å½•æœåŠ¡</h4><p>æ ¸å¿ƒï¼š Unique ID  â€”&gt; Unique Name       IPåœ°å€----&gt;ä¸»æœºå</p><p>DNSæ˜¯ï¼š</p><ul><li>ä¸€ä¸ªç”±åˆ†å±‚çš„ DNSæœåŠ¡å™¨å®ç°çš„åˆ†å¸ƒå¼æ•°æ®åº“</li><li>ä¸€ä¸ªä½¿å¾—ä¸»æœºèƒ½å¤ŸæŸ¥è¯¢åˆ†å¸ƒå¼æ•°æ®åº“çš„åº”ç”¨å±‚åè®®</li></ul><p>DNSæœåŠ¡å™¨é€šå¸¸æ˜¯è¿è¡ŒBINDè½¯ä»¶çš„UNIXæœºå™¨ï¼ŒDNSåè®®è¿è¡Œåœ¨UDPä¹‹ä¸Šï¼Œä½¿ç”¨53ç«¯å£</p><p>DNSåè®®ï¼šåº”ç”¨å±‚åè®®</p><p>é™¤äº†è¿›è¡Œä¸»æœºååˆ°IPåœ°å€çš„è½¬æ¢å¤–ï¼ŒDNSè¿˜æä¾›ï¼š</p><ol><li>è·å¾—ä¸»æœºåˆ«åå¯¹åº”çš„è§„èŒƒä¸»æœºåä»¥åŠä¸»æœºIPåœ°å€</li><li>ç”µå­é‚®ä»¶åº”ç”¨ç¨‹åºå¯ä»¥è°ƒç”¨DNSï¼Œå¯¹æä¾›ä¸»æœºåˆ«åè¿›è¡Œè§£æï¼Œè·å¾—è¯¥ä¸»æœºçš„è§„èŒƒä¸»æœºååŠå…¶IPåœ°å€</li><li>è´Ÿè½½åˆ†é…DNSåœ¨æ‰€æœ‰å†—ä½™çš„WebæœåŠ¡å™¨ä¹‹é—´å¾ªç¯åˆ†é…è´Ÿè½½(IPåœ°å€é›†)</li></ol><h5 id="å·¥ä½œåŸç†">å·¥ä½œåŸç†</h5><p>åº”ç”¨ç¨‹åº----&gt;DNSå®¢æˆ·ç«¯----&gt;å‘ç½‘ç»œå‘é€DNSæŸ¥è¯¢æŠ¥æ–‡ï¼ˆUDP 53ç«¯å£ï¼‰â€”&gt;ç”¨æˆ·ä¸»æœºæ”¶åˆ°DNSå›ç­”æŠ¥æ–‡â€”&gt;æ˜ å°„åˆ°å¯¹åº”çš„åº”ç”¨ç¨‹åº</p><p>å¯ä»¥ç†è§£ä¸ºDNSæ˜¯ä¸€ä¸ªæä¾›ç®€å•ç›´æ¥è½¬æ¢çš„é»‘ç›’å­ï¼Œä½†å†…éƒ¨é€»è¾‘ååˆ†å¤æ‚</p><p><strong>ä¸ºä»€ä¹ˆä¸è®¾ç½®å•ä¸€ã€é›†ä¸­çš„DNSæœåŠ¡å™¨ï¼Ÿ</strong></p><p>å•ç‚¹æ•…éšœã€é€šä¿¡å®¹é‡ã€è¿œè·ç¦»é›†ä¸­å¼æ•°æ®åº“ã€ç»´æŠ¤</p><p>æ‰€ä»¥ï¼ŒDNSä¸é‡‡ç”¨è¿™ç§æ–¹å¼ï¼ŒDNSå®åˆ™æ˜¯ä¸€ä¸ª<strong>å› ç‰¹ç½‘å®ç°åˆ†å¸ƒå¼æ•°æ®åº“</strong>çš„ç²¾å½©æ¡ˆä¾‹</p><ol><li><p>åˆ†å±‚å¼ã€å±‚æ¬¡æ•°æ®åº“</p><p>DNSä½¿ç”¨å¤§é‡çš„DNSæœåŠ¡å™¨ï¼Œä»¥å±‚æ¬¡æ–¹å¼ç»„ç»‡ï¼Œåˆ†å¸ƒåœ¨å…¨ä¸–ç•ŒèŒƒå›´å†…ï¼Œæ²¡æœ‰ä¸€å°æœåŠ¡å™¨æ‹¥æœ‰å› ç‰¹ç½‘ä¸Šæ‰€æœ‰ä¸»æœºçš„æ˜ å°„ã€‚ä¸‰ç§ç±»å‹ï¼Œå®¢æˆ·è‡ªé¡¶åˆ°åº•çš„æ‰¾</p><ul><li><p><strong>æ ¹DNSæœåŠ¡å™¨</strong></p><p>æä¾›TLDæœåŠ¡å™¨çš„IPåœ°å€ï¼Œ400å¤šä¸ªæ ¹åŸŸåæœåŠ¡å™¨</p></li><li><p><strong>é¡¶çº§åŸŸDNSæœåŠ¡å™¨  TLD</strong></p><p>æ¯ä¸ªé¡¶çº§åŸŸï¼ˆcom\org\edu\netâ€¦ï¼‰ã€å›½å®¶é¡¶çº§åŸŸï¼ˆukã€frâ€¦ï¼‰éƒ½æœ‰TLDæœåŠ¡å™¨</p><p>æä¾›æƒå¨DNSæœåŠ¡å™¨çš„IPåœ°å€</p></li><li><p><strong>æƒå¨DNSæœåŠ¡å™¨</strong></p><p>å› ç‰¹ç½‘ä¸Šå…·æœ‰å…¬å…±å¯è®¿é—®ä¸»æœºï¼ˆWebæœåŠ¡å™¨é¢é‚®ä»¶æœåŠ¡å™¨ï¼‰çš„ç»„ç»‡æœºæ„å¿…é¡»æä¾›å…¬å…±å¯è®¿é—®çš„DNSè®°å½•ï¼Œå°†ä¸»æœºåæ˜ å°„ä¸ºIPåœ°å€ï¼Œè¢«æƒå¨DNSæœåŠ¡å™¨æ”¶è—</p></li></ul><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰<strong>æœ¬åœ°DNSæœåŠ¡å™¨</strong>ï¼š</p><p>æ¯ä¸ªISPéƒ½æœ‰ä¸€å°æœ¬åœ°DNSæœåŠ¡å™¨ï¼Œä¸»æœºä¸æŸä¸ªISPè¿æ¥æ—¶ï¼ŒISPæä¾›ä¸€å°ä¸»æœºçš„IPåœ°å€ï¼Œè¯¥ä¸»æœºå…·æœ‰ä¸€å°æˆ–å¤šå°å…¶æœ¬åœ°DNSæœåŠ¡å™¨çš„IPåœ°å€ï¼ˆé€šè¿‡DHCPï¼‰ã€‚æœ¬åœ°DNSæœåŠ¡å™¨ä¸€èˆ¬é‚»è¿‘æœ¬ä¸»æœºã€‚åœ¨ä¸»æœºå‘å‡ºDNSè¯·æ±‚æ—¶ï¼Œå…ˆå‘é€åˆ°DNSæœ¬åœ°æœåŠ¡å™¨ï¼ˆä»£ç†ä½œç”¨ï¼‰ï¼Œç„¶åå†ä¸‹å‘åˆ°DNSæœåŠ¡å™¨å±‚æ¬¡ç»“æ„ï¼ˆå•ç‹¬æ¥æ”¶ä¸‰ç±»æœåŠ¡å™¨å“åº”ï¼‰ã€‚</p><p>ä½†è¿™ç§æ–¹å¼å¾ˆå¤æ‚ï¼ŒæŸ¥è¯¢ä¸€ä¸ªä¸»æœºIPåœ°å€ï¼Œéœ€è¦å‘é€4åˆ†æŸ¥è¯¢æŠ¥æ–‡å’Œæ¥æ”¶4ä»½å›åº”æŠ¥æ–‡ã€‚ï¼ˆè§£å†³ï¼šDNSç¼“å­˜ï¼‰</p><p>æŸ¥è¯¢åˆ†ä¸º<strong>é€’å½’æŸ¥è¯¢</strong>å’Œ<strong>è¿­ä»£æŸ¥è¯¢</strong></p><p>é€’å½’æŸ¥è¯¢ï¼šä»¥è‡ªå·±çš„åä¹‰è¯·æ±‚ æ¥è·å¾—æ˜ å°„ï¼ˆé€šå¸¸ï¼š ä»è¯·æ±‚ä¸»æœºåˆ°æœ¬åœ°DNSæœåŠ¡å™¨çš„æŸ¥è¯¢ï¼‰</p><p>è¿­ä»£æŸ¥è¯¢ï¼šå›ç­”ç›´æ¥è¿”å›ç»™è‡ªå·±</p></li><li><p>DNSç¼“å­˜</p><p>ç›®çš„ï¼šæ”¹å–„æ—¶å»¶æ€§èƒ½å¹¶å‡å°‘åœ¨å› ç‰¹ç½‘åˆ°å¤„ä¼ è¾“çš„DNSæŠ¥æ–‡æ•°é‡</p><p>å½“æŸDNSæœåŠ¡å™¨æ¥æ”¶åˆ°DNSå›ç­”æ—¶ï¼Œä¼šå°†æ˜ å°„ç¼“å­˜åœ¨æœ¬åœ°å­˜å‚¨å™¨ä¸­ã€‚ä½†ç”±äºä¸»æœºå’Œä¸»æœºåäºIPåœ°å€é—´çš„æ˜ å°„ä¸æ˜¯æ°¸ä¹…çš„ï¼ŒDNSæœåŠ¡å™¨åœ¨ä¸€æ®µæ—¶é—´åï¼ˆé€šå¸¸2å¤©ï¼‰å°†ä¸¢å¼ƒç¼“å­˜</p></li><li><p><strong>DNSè®°å½•å’ŒæŠ¥æ–‡</strong></p><p>èµ„æºè®°å½•(Resource Record , RR),æä¾›äº†ä¸»æœºååˆ°IPåœ°å€çš„æ˜ å°„ï¼Œæ¯ä¸ªDNSå›ç­”æŠ¥æ–‡åŒ…å«äº†ä¸€ä¸ªæˆ–å¤šä¸ªRRã€‚</p><p>å†…å®¹ï¼š (name,value,type,ttl)</p><p>TTL: è¯¥è®°å½•çš„ç”Ÿå­˜æ—¶é—´ï¼Œå†³å®šäº†RRåº”å½“ä»ç¼“å­˜ä¸­åˆ é™¤çš„æ—¶é—´ã€‚</p><p>ä¾‹å¦‚ï¼š</p><ul><li>Type = A, Nameæ˜¯ä¸ªä¸»æœºåï¼Œ Valueæ˜¯ä¸»æœºåå¯¹åº”çš„IPåœ°å€ã€‚</li><li>Type = NSï¼Œ Nameæ˜¯ä¸ªåŸŸï¼ŒValueæ˜¯ä¸ªçŸ¥é“å¦‚ä½•è·å¾—è¯¥åŸŸä¸­ä¸»æœºIPåœ°å€çš„æƒå¨DNSæœåŠ¡å™¨çš„ä¸»æœºåï¼Œç”¨äºæ²¿ç€æŸ¥è¯¢é“¾æ¥è·¯ç”±DNSæŸ¥è¯¢</li><li>Type = CNAMEï¼ŒValueæ˜¯åˆ«åä¸ºNameçš„ä¸»æœºå¯¹åº”çš„è§„èŒƒä¸»æœºåï¼Œèƒ½å¤Ÿå‘æŸ¥è¯¢çš„ä¸»æœºæä¾›ä¸€ä¸ªä¸»æœºåå¯¹åº”çš„è§„èŒƒä¸»æœºå</li><li>Type = MXï¼ŒValueæ˜¯ä¸ªåˆ«åä¸ºNameçš„é‚®ä»¶æœåŠ¡å™¨çš„è§„èŒƒä¸»æœºåï¼ŒMXè®°å½•å…è®¸é‚®ä»¶æœåŠ¡å™¨ä¸»æœºåå…·æœ‰ç®€å•çš„åˆ«åï¼Œä¸€ä¸ªå…¬å¸çš„é‚®ä»¶æœåŠ¡å™¨å’Œå…¶ä»–æœåŠ¡å™¨ï¼ˆWebï¼‰å¯ä»¥ä½¿ç”¨ç›¸åŒçš„åˆ«åï¼Œä½†è¯·æ±‚çš„è®°å½•ä¸åº”ç›¸åŒã€‚</li></ul><ol><li><p>DNSæŠ¥æ–‡</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210911111330446.png" alt="image-20210911111330446"></p><p>å‰12å­—èŠ‚ï¼šé¦–éƒ¨åŒºåŸŸ</p><p>æ ‡è¯†ç¬¦ï¼š16bit æ ‡è¯†æŸ¥è¯¢/å›ç­”æŠ¥æ–‡ã€æƒå¨æ ‡å¿—ã€æ˜¯å¦é€’å½’æŸ¥è¯¢ã€é€’å½’å¯ç”¨</p><p>æŸ¥è¯¢é—®é¢˜åŒºåŸŸ  ï¼šåŒ…å«æ­£åœ¨è¿›è¡Œçš„æŸ¥è¯¢ä¿¡æ¯ã€‚åŒ…æ‹¬ï¼šæ­£åœ¨è¢«æŸ¥è¯¢çš„ä¸»æœºåã€æ­£è¢«è¯¢é—®çš„é—®é¢˜ç±»å‹(A\NS\MSâ€¦)</p><p>å›ç­”åŒºåŸŸ ï¼šå¯¹æœ€åˆè¯·æ±‚çš„åå­—çš„RRã€‚å¯ä»¥åŒ…å«å¤šä¸ªRRï¼Œå› æ­¤<strong>ä¸€ä¸ªä¸»æœºåèƒ½å¤Ÿæœ‰å¤šæ¡IPåœ°å€</strong></p><p>æƒå¨åŒºåŸŸï¼šåŒ…å«å…¶ä»–æƒå¨æœåŠ¡å™¨çš„è®°å½•</p><p>é™„åŠ åŒºåŸŸï¼šåŒ…å«å…¶ä»–è®°å½•ã€‚ä¾‹å¦‚ä¸€ä¸ªMXè¯·æ±‚çš„å›ç­”æŠ¥æ–‡çš„å›ç­”åŒºåŸŸåŒ…å«ä¸€æ¡RRï¼Œæä¾›é‚®ä»¶æœåŠ¡å™¨çš„è§„èŒƒä¸»æœºåã€‚åˆ™é™„åŠ åŒºåŸŸåˆ™åŒ…å«ä¸€ä¸ªç±»å‹Açš„è®°å½•ï¼Œæä¾›ç”¨äºè¯¥é‚®ä»¶æœåŠ¡å™¨çš„è§„èŒƒä¸»æœºåçš„IPåœ°å€</p></li><li><p>åœ¨DNSæ•°æ®åº“ä¸­æ’å…¥è®°å½•</p><p>æ³¨å†Œç™»è®°æœºæ„ï¼šå•†ä¸šå®ä½“ï¼ŒéªŒè¯åŸŸåçš„å”¯ä¸€æ€§ï¼Œå°†åŸŸåè¾“å…¥DNSæ•°æ®åº“</p><p>å½“ä½ æ³¨å†Œç™»è®°æœºæ„æ³¨å†ŒåŸŸåæ—¶ï¼Œéœ€è¦æä¾›åŸºæœ¬å’Œè¾…åŠ©æƒå¨DNSæœåŠ¡å™¨çš„åå­—å’ŒIPåœ°å€æ²¡æ³¨å†Œç™»è®°æœºæ„å°†ç¡®ä¿å°†ä¸€ä¸ªNSç±»å‹å’Œä¸€ä¸ªç±»å‹Açš„è®°å½•è¾“å…¥TLDæœåŠ¡å™¨</p></li></ol></li></ol><h5 id="DNSçš„è„†å¼±æ€§">DNSçš„è„†å¼±æ€§</h5><ol><li><p>åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡(DDoS) å¸¦å®½æ´ªæ³›æ”»å‡»</p><p>æ”»å‡»è€…å‘æ¯ä¸ªDNSæ ¹æœåŠ¡å™¨å‘é€å¤§é‡åˆ†ç»„ï¼Œä½¿å¾—å¤§å¤šæ•°åˆæ³•DNSæ°¢æ°”çƒå¾—ä¸åˆ°å›ç­”ã€‚ï¼ˆä½†è®¸å¤šæ ¹æœåŠ¡å™¨æœ‰åˆ†ç»„è¿‡æ»¤å™¨çš„ä¿æŠ¤ï¼Œé…ç½®çš„åˆ†ç»„è¿‡æ»¤å™¨é˜»æŒ¡äº†æ‰€æœ‰æŒ‡å‘è·ŸæœåŠ¡å™¨çš„ICMP pingæŠ¥æ–‡ï¼‰å¹¶ä¸”å¤§å¤šæ•°æœ¬åœ°DNSæœåŠ¡å™¨ä¹Ÿç¼“å­˜äº†TLDæœåŠ¡å™¨çš„åœ°å€ï¼Œä½¿å¾—è¿™äº›è¯·æ±‚é€šå¸¸ç»•è¿‡äº†DNSæ ¹æœåŠ¡å™¨</p><p>æ›´æœ‰æ•ˆçš„æ”»å‡»ï¼šå‘TLDæœåŠ¡å™¨å‘é€å¤§é‡çš„DNSè¯·æ±‚ï¼Œè¿‡æ»¤æŒ‡å‘DNSæœåŠ¡å™¨çš„DNSè¯·æ±‚å°†æ›´ä¸ºå›°éš¾ï¼Œå¹¶ä¸”TLDæœåŠ¡å™¨ä¸å®¹æ˜“ç»•è¿‡ï¼ˆå¯é€šè¿‡DNSæœåŠ¡å™¨ ç¼“å­˜æŠ€æœ¯ éƒ¨åˆ†ç¼“è§£ï¼‰</p></li><li><p>ä¸­é—´äººæ”»å‡»</p><p>æˆªè·è¯·æ±‚- ä¼ªé€ </p></li><li><p>æ¯’å®³æ”»å‡»</p><p>å‘DNSæœåŠ¡å™¨å‘é€ä¼ªé€ çš„å›ç­”ï¼Œä½¿æœåŠ¡å™¨ç¼“å­˜ä¸­æ¥æ”¶ä¼ªé€ çš„è®°å½•ã€‚</p></li></ol><h4 id="P2Pæ–‡ä»¶åˆ†å‘">P2Pæ–‡ä»¶åˆ†å‘</h4><p>C-Sä½“ç³»ï¼šåˆ†å‘ä¸€ä¸ªå¤§æ–‡ä»¶ï¼š æœåŠ¡å™¨è¦å•ç‹¬å‘æ¯ä¸ªå¯¹ç­‰æ–¹å‘é€è¯¥æ–‡ä»¶çš„å‰¯æœ¬ï¼Œè´Ÿè½½å¤§ï¼Œæ¶ˆè€—å¤§é‡æœåŠ¡å™¨å¸¦å®½</p><p>P2Pï¼šæ¯ä¸ªå¯¹ç­‰æ–¹èƒ½å¤Ÿå‘å…¶ä»–ä»»ä½•å¯¹ç­‰æ–¹é‡æ–°åˆ†å‘ä»–å·²ç»æ”¶åˆ°çš„è¯¥æ–‡ä»¶çš„ä»»ä½•éƒ¨åˆ†ï¼Œåœ¨åˆ†å‘è¿‡ç¨‹ä¸­ååŠ©åˆ°æœåŠ¡å™¨</p><p>æµè¡Œçš„P2Pæ–‡ä»¶åˆ†å‘åè®®ï¼š BitTorrent</p><ol><li><p>æ‰©å±•æ€§</p><p>P94ï¼Œå®é™…è¿ç®—æ¯”è¾ƒä¸¤ç§ä½“ç³»çš„ä¼ è¾“æ–‡ä»¶é€Ÿç‡ã€‚</p><p>C-Sï¼Œéšç€åˆ†å‘æ•°é‡Nå¢å¤§ï¼Œå‘ˆç°çº¿æ€§ï¼ŒP2Péçº¿æ€§ä¸”å¢é•¿è¶‹åŠ¿è¶Šæ¥è¶Šå°ï¼ˆæœ‰è¶‹è¿‘å€¼ï¼‰</p><p>æ‰©å±•æ€§çš„ç›´æ¥æˆå› ï¼š å¯¹ç­‰æ–¹é™¤äº†æ˜¯Bitçš„æ¶ˆè´¹è€…è¿˜æ˜¯ä»–ä»¬çš„é‡æ–°åˆ†å‘è€…</p></li><li><p>BitTorrent</p><p>å‚ä¸ä¸€ä¸ªç‰¹å®šæ–‡ä»¶åˆ†å‘çš„æ‰€æœ‰å¯¹ç­‰æ–¹çš„é›†åˆç§°ä¸ºä¸€ä¸ªæ´ªæµtorrent.åœ¨ä¸€ä¸ªæ´ªæµä¸­çš„å¯¹ç­‰æ–¹å½¼æ­¤ä¸‹è½½ç­‰é•¿åº¦çš„æ–‡ä»¶å—(chunk)</p><p>æ¯ä¸ªæ´ªæµå…·æœ‰ä¸€ä¸ª<strong>è¿½è¸ªå™¨</strong>ï¼Œæ¯ä¸ªå¯¹ç­‰æ–¹åŠ å…¥æŸæ´ªæµæ—¶ï¼Œå®ƒå‘è¿½è¸ªå™¨æ³¨å†Œè‡ªå·±ã€‚å‘¨æœŸæ€§é€šçŸ¥è¿½è¸ªå™¨å®ƒä»ç„¶åœ¨æ´ªæµä¸­ã€‚è¿½è¸ªå™¨æœ‰ä¸€å¼ è¡¨ï¼Œæœ‰æ‰€æœ‰å¯¹ç­‰æ–¹çš„IPåœ°å€ï¼Œå…¶ä¸­å¯¹ç­‰æ–¹æƒ³è¦ä¸‹è½½æ—¶ï¼Œåˆ™è¿½è¸ªå™¨éšæœºçš„ä»è¿™å¼ è¡¨ä¸­é€‰æ‹©ä¸€ä¸ªå­é›†ï¼Œå‘ç»™å®ƒã€‚ä¸»æœºåˆ™è¯•å›¾ä¸è¿™å¼ åˆ—è¡¨ä¸Šçš„å¯¹ç­‰æ–¹åˆ›å»ºå¹¶è¡Œçš„TCPè¿æ¥ã€‚ä¸»æœºå·²ç»è¯·æ±‚äº†Lä¸ªå—åˆ—è¡¨ï¼Œæ­¤åï¼Œå°†å¯¹æ²¡æœ‰çš„å—è¿›è¡Œè¯·æ±‚ã€‚</p><p>å¦‚ä½•çŸ¥é“å®ƒçš„é‚»å±…æœ‰å“ªäº›å—ï¼Ÿ</p><ol><li>å®ƒè¯¥ä»ä»¤å±…è¯·æ±‚å“ªäº›å—ï¼Ÿ</li><li>åº”å½“å‘å“ªäº›å‘å®ƒè¯·æ±‚å—çš„é‚»å±…å‘é€å—ï¼Ÿ</li></ol><p>è§£å†³ä»¥ä¸Šé—®é¢˜ï¼Œä½¿ç”¨<strong>æœ€ç¨€ç¼ºä¼˜å…ˆæŠ€æœ¯</strong>ã€‚é’ˆå¯¹å®ƒæ²¡æœ‰çš„å—åœ¨é‚»å±…ä¸­å†³å®šæœ€ç¨€ç¼ºçš„å—ï¼ˆå“ªäº›åœ¨é‚»å±…ä¸­å‰¯æœ¬æ•°é‡æœ€å°‘çš„å—ï¼‰ï¼Œå¹¶é¦–å…ˆè¯·æ±‚æœ€ç¨€ç¼ºçš„å—ã€‚ï¼ˆç›®çš„ï¼šå‡è¡¡åˆ†é…æ´ªæµä¸­çš„æ¯ä¸ªå—ï¼‰</p><p>é€‰æ‹©äº¤æ¢æ•°æ®çš„ä¼´ä¾£ï¼šæœ€é«˜é€Ÿç‡å‰å››ä¸ªã€éšæœºé€‰æ‹©å…¶ä¸­ä¸€ä¸ªï¼Œæ¯30sé‡æ–°é€‰æ‹©</p><p>å…³äºP2Pè¿˜æœ‰å¾ˆå¤šæœ‰è¶£çš„æœºåˆ¶ï¼š</p><p><em>éšæœºä¼˜å…ˆé€‰æ‹©ã€æ®‹å±€æ¨¡å‹ã€åæ€ æ…¢ï¼ŒåæœŸå¯æ…¢æ…¢äº†è§£</em></p></li></ol><h4 id="è§†é¢‘æµå’Œå†…å®¹åˆ†å‘ç½‘">è§†é¢‘æµå’Œå†…å®¹åˆ†å‘ç½‘</h4><ol><li><p>å› ç‰¹ç½‘è§†é¢‘</p><p>åŸºç¡€ï¼šå…ˆå½•å¥½ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸­</p></li><li><p>HTTPæµå’ŒDASH</p><p>ç»HTTPçš„åŠ¨æ€é€‚åº”æ€§æµï¼ˆDynamic Adaptive Streamming over HTTPï¼‰ï¼šæ ¹æ®ç”¨æˆ·å¯ç”¨å¸¦å®½å¤§å°å˜åŒ–ï¼Œé€‰æ‹©ä¸åŒçš„æ¯”ç‰¹ç‡ï¼Œå¯¹åº”äºä¸åŒçš„è§†é¢‘è´¨é‡</p></li><li><p><strong>å†…å®¹åˆ†å‘ç½‘</strong></p><p>ä¸ºäº†åº”å¯¹å…¨ä¸–ç•Œç”¨æˆ·åˆ†å‘å·¨é‡è§†é¢‘æ•°æ®çš„å›°éš¾ï¼Œå¤§éƒ¨åˆ†å…¬å¸ä½¿ç”¨å†…å®¹åˆ†å‘ç½‘ï¼ˆContent Distribution Network , CDNï¼‰</p><p>CDNç®¡ç†åˆ†å¸ƒåœ¨å¤šä¸ªåœ°æ–¹çš„æœåŠ¡å™¨ï¼Œåœ¨æœåŠ¡å™¨ä¸­å­˜å‚¨éŸ³è§†é¢‘ çš„å‰¯æœ¬ï¼Œè¯•å›¾å°†æ¯ä¸ªç”¨æˆ·è¯·æ±‚å®šå‘åˆ°ä¸€ä¸ªå°†æä¾›æœ€å¥½çš„ç”¨æˆ·ä½“éªŒCDNä½ç½®ã€‚</p><p>ä¸“ç”¨CDNæˆ–ç¬¬ä¸‰æ–¹CDN</p></li></ol><h5 id="CDN">CDN</h5><p>å¸¸é‡‡ç”¨ä¸¤ç§ä¸åŒçš„æœåŠ¡å™¨å®‰ç½®åŸåˆ™ï¼š</p><ul><li><p>æ·±å…¥ï¼š é€šè¿‡åœ¨éåŠå…¨çƒçš„æ¥å…¥ISPä¸­éƒ¨ç½²æœåŠ¡å™¨é›†ç¾¤ï¼Œæ¥æ·±å…¥åˆ°ISPçš„æ¥å…¥ç½‘ä¸­(Akamai)ã€‚</p><div class="code-wrapper"><pre class="language-none"><code class="language-none">  ç›®çš„æ˜¯é è¿‘ç«¯ç”¨æˆ·ï¼Œå‡å°‘ç«¯ç”¨æˆ·å’ŒCDNé›†ç¾¤ä¹‹é—´çš„é“¾è·¯å’Œè·¯ç”±å™¨æ•°é‡ï¼Œæ”¹å–„æ—¶å»¶å’Œååé‡ã€‚é«˜åº¦åˆ†å¸ƒã€‚</code></pre></div></li><li><p>é‚€è¯·åšå®¢ï¼šåœ¨å°‘é‡å…³é”®ä½ç½®å»ºé€ å¤§é›†ç¾¤æ¥â€œé‚€è¯·ISPåšå®¢â€ï¼Œè¿™äº›CDNé€šå¸¸å°†ä»–ä»¬çš„é›†ç¾¤æ”¾åœ¨å› ç‰¹ç½‘äº¤æ¢ç‚¹ï¼ˆIXPï¼‰ã€‚è¾ƒä½å¼€é”€ã€ç»´æŠ¤ï¼Œè¾ƒé«˜æ—¶å»¶ä¸”è¾ƒä½ååé‡ã€‚</p></li></ul><h6 id="CDNæ“ä½œ">CDNæ“ä½œ</h6><p>å¦‚ä½•è§¦å‘ï¼Ÿ</p><p>æµè§ˆå™¨æ£€ç´¢åˆ°ä¸€ä¸ªç‰¹å®šçš„è§†é¢‘ï¼ˆURLï¼‰ï¼ŒCDNæˆªè·è¯¥è¯·æ±‚æ¥ç¡®å®šé€‚åˆç”¨äºè¯¥å®¢æˆ·CDNçš„æœåŠ¡å™¨é›†ç¾¤ï¼Œå°†å®¢æˆ·è¯·æ±‚é‡æ–°å®šå‘åˆ°è¯¥æœåŠ¡å™¨çš„æŸå°æœºå™¨ã€‚</p><p>æˆªè·æ–¹æ³•ï¼Ÿ</p><p>å¤§å¤šæ•°CDNåˆ©ç”¨DNSæˆªè·å’Œé‡å®šå‘è¯·æ±‚ã€‚é€šè¿‡è§†é¢‘çš„é“¾æ¥å‘é€DNSè¯·æ±‚åï¼Œè¯·æ±‚åˆ°è§†é¢‘ç½‘ç«™çš„æƒå¨DNSæœåŠ¡å™¨ï¼Œæ­¤æ—¶å¹¶ä¸è¿”å›IPåœ°å€ï¼Œè€Œæ˜¯CDNåŸŸçš„ä¸»æœºåï¼Œæ­¤æ—¶å†å‘é€çš„æ˜¯cdnçš„dnsè¯·æ±‚ï¼Œæœ€ç»ˆè¿”å›cdnæœåŠ¡å™¨çš„IPåœ°å€ã€‚</p><h6 id="é›†ç¾¤é€‰æ‹©ç­–ç•¥">é›†ç¾¤é€‰æ‹©ç­–ç•¥</h6><p><strong>~ ï¼šä»»ä½•CDNéƒ¨ç½²çš„æ ¸å¿ƒï¼ŒåŠ¨æ€åœ°å°†å®¢æˆ·å®šå‘åˆ°CDNä¸­çš„æŸä¸ªæœåŠ¡å™¨é›†ç¾¤æˆ–æ•°æ®ä¸­å¿ƒçš„æœºåˆ¶ï¼ˆå¾—çŸ¥ç”¨æˆ·IPåœ°å€åï¼Œé€‰æ‹©é€‚å½“çš„é›†ç¾¤ï¼‰</strong></p><ul><li><p>åœ°ç†ä¸Šæœ€ä¸ºé‚»è¿‘ç­–ç•¥ã€‚å°†IPåœ°å€æ˜ å°„åˆ°ä¸€ä¸ªåœ°ç†ä½ç½®ã€‚</p><p>å¯¹å¤§å¤šæ•°ç”¨æˆ·æœ‰æ•ˆï¼Œä½†é…ç½®äº†è¿œç¨‹DNSçš„å’Œä¸€äº›ç‰¹æ®Šæƒ…å†µï¼ˆåœ°ç†æœ€é‚»è¿‘ä¸ä»£è¡¨æ˜¯æœ€è¿‘çš„é›†ç¾¤ï¼‰å°±ä¸ç†æƒ³</p></li><li><p>CDNé€šè¿‡é›†ç¾¤å’Œå®¢æˆ·ä¹‹é—´çš„æ—¶å»¶å’Œä¸¢åŒ…æ€§èƒ½æ‰§è¡Œå‘¨æœŸæ€§çš„å®æ—¶æµ‹é‡ã€‚ï¼ˆå‘¨æœŸæ€§åœ°å‘æ‰€æœ‰LDNSå‘é€æ¢æµ‹åˆ†ç»„ï¼ˆpingæŠ¥æ–‡æˆ–DNSè¯·æ±‚ï¼‰ï¼Œç¼ºç‚¹ï¼šè®¸å¤šLDNSè¢«é…ç½®ä¸ºä¸ä¼šå“åº”è¿™äº›æ¢æµ‹ï¼‰ã€‚</p></li></ul><p>ä¸€äº›å¤§å‹è§†é¢‘ç½‘ç«™CDNå¤„ç†æ–¹å¼ï¼š</p><p>Netflex Youtube çœ‹çœ‹ï¼ˆCDN+P2Pï¼‰</p><h4 id="å¥—æ¥å­—ç¼–ç¨‹">å¥—æ¥å­—ç¼–ç¨‹</h4><p>æ¯ä¸ªè¿›ç¨‹å¥½æ¯”æ˜¯ä¸€åº§æˆ¿å­ï¼Œè¿›ç¨‹çš„å¥—æ¥å­—å¥½æ¯”æ˜¯ä¸€æ‰‡é—¨ï¼Œåº”ç”¨ç¨‹åºä½äºä¸€ä¾§ï¼Œè¿è¾“å±‚ä½äºå¦ä¸€ä¾§ã€‚åº”ç”¨ç¨‹åºå¼€å‘è€…åœ¨å¥—æ¥å­—çš„åº”ç”¨å±‚ä¸€ä¾§å¯ä»¥æ§åˆ¶æ‰€æœ‰ä¸œè¥¿ï¼Œä½†æ— æ³•æ§åˆ¶è¿è¾“å±‚ä¸€ä¾§ã€‚</p><p>ä¸€ä¸ªè¿›ç¨‹å…·æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå¥—æ¥å­—ï¼Œä¸€ä¸ªå¥—æ¥å­—å¯¹åº”ä¸€ä¸ªç«¯å£å·</p><h2 id="ä¼ è¾“å±‚">ä¼ è¾“å±‚</h2><h3 id="æ¦‚è¿°ï¼š">æ¦‚è¿°ï¼š</h3><p>è¿è¾“å±‚åè®®ä¸ºè¿è¡Œåœ¨ä¸åŒä¸»æœºä¸Šçš„åº”ç”¨ç¨‹åºä¹‹é—´æä¾›äº†<strong>é€»è¾‘é€šä¿¡</strong>åŠŸèƒ½ã€‚è¿è¾“å±‚åè®®åœ¨ç«¯ç³»ç»Ÿä¸­è€Œä¸æ˜¯åœ¨è·¯ç”±å™¨ä¸­å®ç°ã€‚</p><h4 id="è¿è¾“å±‚å’Œç½‘ç»œå±‚çš„å…³ç³»">è¿è¾“å±‚å’Œç½‘ç»œå±‚çš„å…³ç³»</h4><p>ç½‘ç»œå±‚æä¾›äº†ä¸»æœºä¹‹é—´çš„é€»è¾‘é€šä¿¡ï¼Œè¿è¾“å±‚ä¸ºè¿è¡Œåœ¨ä¸åŒä¸»æœºä¸Šçš„<strong>è¿›ç¨‹</strong>ä¹‹é—´æä¾›äº†é€»è¾‘é€šä¿¡ã€‚</p><p>ï¼ˆä¹¦ä¸­æœ‰ä¸ªç‰¹åˆ«å¥½çš„ä¾‹å­ï¼ŒP. 123ï¼ˆå¿«é€’å…¬å¸ï¼šç½‘ç»œå±‚åè®®  å¿«é€’ç‚¹ï¼šè¿è¾“å±‚åè®®ï¼‰ï¼‰</p><p>è¿è¾“å±‚åè®®å—é™äºç½‘ç»œå±‚åè®®çš„æœåŠ¡æ¨¡å‹ï¼Œå³ä½¿<strong>ç½‘ç»œå±‚ä¸èƒ½ä¿è¯åè®®æ˜¯å¦å¯é ï¼Œè¿è¾“å±‚ä¹Ÿèƒ½æä¾›å¯é çš„æ•°æ®ä¼ è¾“æœåŠ¡</strong></p><h4 id="å› ç‰¹ç½‘è¿è¾“å±‚æ¦‚è¿°">å› ç‰¹ç½‘è¿è¾“å±‚æ¦‚è¿°</h4><p>å› ç‰¹ç½‘ä¸¤ç§è¿è¾“å±‚ï¼š</p><ul><li>UDP  ï¼ˆç”¨æˆ·æ•°æ®åè®®ï¼‰ ä¸å¯é ã€æ— è¿æ¥</li><li>TCP ï¼ˆä¼ è¾“æ§åˆ¶åè®®ï¼‰ å¯é ã€é¢å‘è¿æ¥</li></ul><p>ä¸€èˆ¬ ï¼š è¿è¾“å±‚åˆ†ç»„ / TCPçš„è¿è¾“å±‚åˆ†ç»„ / UDPåˆ†ç»„ï¼šæŠ¥æ–‡æ®µ   UDPçš„è¿è¾“å±‚åˆ†ç»„ï¼šæ•°æ®æŠ¥</p><p>å› ç‰¹ç½‘çš„ç½‘ç»œå±‚åè®® ï¼š IPï¼Œç½‘é™…åè®®ï¼Œä¸ºä¸»æœºä¹‹é—´æä¾›é€»è¾‘é€šä¿¡ã€‚â€œå°½åŠ›è€Œä¸ºäº¤ä»˜æœåŠ¡â€ï¼Œä¸ç¡®ä¿æŠ¥æ–‡æ®µçš„äº¤ä»˜ï¼Œä¿è¯æŒ‰åºäº¤ä»˜ï¼Œä¸ä¿è¯æŠ¥æ–‡æ®µä¸­æ•°æ®çš„å®Œæ•´æ€§ã€‚IPä¹Ÿè¢«ç§°ä¸º<strong>ä¸å¯é æœåŠ¡</strong></p><p><strong>TCPå’ŒUDPçš„åŸºæœ¬è´£ä»»</strong>ï¼šå°†ä¸¤ä¸ªç«¯ç³»ç»Ÿé—´IPçš„äº¤ä»˜æœåŠ¡æ‰©å±•ä¸ºè¿è¡Œåœ¨ç«¯ç³»ç»Ÿä¸Šçš„ä¸¤ä¸ªè¿›ç¨‹ä¹‹é—´çš„äº¤ä»˜æœåŠ¡ã€‚</p><p>è¿™ä¸ªè¿‡ç¨‹ä¹Ÿæˆä¸ºè¿è¾“å±‚çš„<strong>å¤šè·¯å¤ç”¨</strong>ä¸<strong>å¤šè·¯åˆ†è§£</strong></p><h3 id="å¤šè·¯å¤ç”¨">å¤šè·¯å¤ç”¨</h3><h3 id="æ— è¿æ¥è¿è¾“ï¼šUDP">æ— è¿æ¥è¿è¾“ï¼šUDP</h3><p>å…¸å‹çš„UDPåº”ç”¨å±‚åè®®çš„ä¾‹å­ï¼šDNSã€‚å› ä¸ºUDPä¸ä¼šå¼•å…¥å»ºç«‹è¿æ¥çš„æ—¶å»¶ã€‚8å­—èŠ‚å¼€å¤´</p><p><strong>UDPçš„ç¼ºé™·</strong></p><p>è¿è¡Œåœ¨UDPä¸Šçš„å¤šåª’ä½“åº”ç”¨æ˜¯æœ‰äº‰è®®çš„ã€‚å¦‚æœæ¯ä¸ªäººéƒ½å¯åŠ¨æµå¼æé«˜æ¯”ç‰¹ç‡è§†é¢‘è€Œä¸æ˜¯ç”¨ä»»ä½•æ‹¥å¡æ§åˆ¶çš„æŠ€æœ¯ï¼Œå°±ä¼šä½¿å¾—è·¯ç”±å™¨æœ‰å¤§é‡çš„åˆ†ç»„æº¢å‡ºã€‚ä»¥è‡³äºéå¸¸å°‘çš„UDPåˆ†ç»„èƒ½æˆåŠŸåœ°ä¼ è¾“ã€‚å†µä¸”ï¼Œå¼•å‘çš„é«˜ä¸¢åŒ…ç‡å°†å¼•èµ·TCPå‘é€æ–¹å› æ‹¥å¡æ§åˆ¶è€Œå¤§å¤§å‡å°å‘é€é€Ÿç‡ã€‚</p><p>UDPä¸­ç¼ºä¹æ‹¥å¡æ§åˆ¶èƒ½å¤Ÿå¯¼è‡´UDPå‘é€æ–¹å’Œæ¥æ”¶æ–¹ä¹‹é—´çš„é«˜ä¸¢åŒ…ç‡ï¼Œå¹¶ä¸”æŒ¤å®TCPä¼šè¯ã€‚</p><p>å½“ç„¶ï¼Œä¸€äº›UDPçš„åº”ç”¨æ˜¯å¯èƒ½å®ç°å¯é æ€§ä¼ è¾“çš„ï¼šåœ¨åº”ç”¨ç¨‹åºè‡ªèº«ä¸­å»ºç«‹å¯é æ€§æœºåˆ¶å®Œæˆã€‚</p><h4 id="UDPæŠ¥æ–‡æ®µ">UDPæŠ¥æ–‡æ®µ</h4><p><img src="/opt/Hexo/source/_posts/C:%5CUsers%5C40117%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210913191503252.png" alt="image-20210913191503252"></p><h4 id="UDPæ£€éªŒå’Œ">UDPæ£€éªŒå’Œ</h4><p>ç›®çš„ï¼šæä¾›å·®é”™æ£€éªŒåŠŸèƒ½ï¼Œæ£€éªŒå’Œç¡®å®šå…šUDPæŠ¥æ–‡æ®µä»æºåˆ°è¾¾ç›®çš„åœ°ç§»åŠ¨æ—¶ï¼Œå…¶ä¸­çš„æ¯”ç‰¹æ˜¯å¦å‘é€å˜åŒ–</p><p>å¦‚ä½•äº§ç”Ÿï¼šå‘é€æ–¹çš„UDPå¯¹æŠ¥æ–‡æ®µä¸­æ‰€æœ‰16æ¯”ç‰¹å­—çš„å’Œè¿›è¡Œ<strong>åç </strong>è¿ç®—ï¼Œæ±‚å’Œæ—¶é‡åˆ°ä»»ä½•æº¢å‡ºé—®é¢˜éƒ½è¢«å›å·ã€‚</p><p>åªæ˜¯æ£€æµ‹ï¼Œä¸èƒ½ä¿®å¤</p><h3 id="å¯é æ•°æ®ä¼ è¾“åŸç†">å¯é æ•°æ®ä¼ è¾“åŸç†</h3><p>å¯é æ•°æ®ä¼ è¾“åè®®ä¸‹å±‚æ¯åè®®ä¹Ÿè®¸æ˜¯ä¸å¯é çš„ â€” &gt; å¸¦æ¥å›°éš¾ã€‚</p><h4 id="æ„é€ å¯é æ•°æ®ä¼ è¾“åè®®">æ„é€ å¯é æ•°æ®ä¼ è¾“åè®®</h4><ol><li><p>ç»å®Œå…¨å¯é ä¿¡é“çš„å¯é æ•°æ®ä¼ è¾“ï¼šrdt1.0</p><p>æœ€ç®€å•æƒ…å†µï¼šåº•å±‚ä¿¡é“æ˜¯å®Œå…¨å¯é çš„ï¼Œæ¥æ”¶ç«¯ä¸éœ€è¦æä¾›ä»»ä½•åé¦ˆä¿¡æ¯ç»™å‘é€æ–¹</p><p>æœ‰é™çŠ¶æ€æœºï¼ˆFSM Finite-State Machineï¼‰</p></li><li><p>ç»å…·æœ‰æ¯”ç‰¹å·®é”™ä¿¡é“çš„å¯é ä¼ è¾“</p><p>è‚¯å®šç¡®è®¤ï¼ˆACKï¼‰ã€å¦å®šç¡®è®¤ï¼ˆNAKï¼‰</p><p>è‡ªåŠ¨é‡ä¼ è¯·æ±‚ï¼ˆAutomatic Repeat reQuestï¼ŒARQï¼‰</p><p>ARQéœ€è¦çš„å¦å¤–ä¸‰ç§åè®®å¤„ç†å­˜åœ¨æ¯”ç‰¹å·®é”™çš„é—®é¢˜ï¼š</p><ul><li>å·®é”™æ£€æµ‹</li><li>æ¥æ”¶æ–¹åé¦ˆ ACKã€NAK</li><li>é‡ä¼ </li></ul><p>åœç­‰ï¼ˆstop-and-waitï¼‰åè®®ï¼Œä»…å½“æ¥æ”¶åˆ°ACKå¹¶ä¸”ç¦»å¼€æ”¹çŠ¶æ€æ—¶æ‰èƒ½å‘ç”Ÿå…¶ä»–äº‹ä»¶ã€‚</p><p>ä½†æ˜¯å¦‚æœACKã€NAKåˆ†ç»„å—æŸè¯¥æ€ä¹ˆåŠï¼Ÿ</p><p>è§£å†³é—®é¢˜ï¼šåœ¨æ•°æ®åˆ†ç»„ä¸­æ·»åŠ æ–°å­—æ®µï¼Œè®©å‘é€æ–¹å¯¹æ•°æ®åˆ†ç»„è¿›è¡Œç¼–å·ï¼Œå³å°†å‘é€æ•°æ®åˆ†ç»„çš„åºå·æ”¾åœ¨è¯¥å­—æ®µã€‚</p></li><li><p>ç»å…·æœ‰æ¯”ç‰¹å·®é”™å“¦çš„ä¸¢åŒ…ä¿¡é“çš„å¯é æ•°æ®ä¼ è¾“ï¼šrdt3.0</p><p>é™¤åŸæœ¬é—®é¢˜å¤–è¿˜éœ€å…³æ³¨ï¼šæ€æ ·æ£€æµ‹ä¸¢åŒ…ä»¥åŠå‘ç”Ÿä¸¢åŒ…æ—¶è¯¥åšä»€ä¹ˆï¼Ÿ</p><p>å‘é€æ–¹éœ€è¦ç­‰å¾…å¤šä¹…æ‰èƒ½ç¡®å®šå·²ä¸¢å¤±äº†å“ªäº›ï¼Ÿï¼ˆè€å¿ƒæ˜¯æœ‰é™åº¦çš„ï¼‰</p><p>è‡³å°‘éœ€è¦ç­‰å¾…ï¼šå‘é€æ–¹ä¸æ¥å—æ–¹çš„å¾€è¿”æ—¶å»¶+æ¥æ”¶æ–¹å¤„ç†ä¸€ä¸ªåˆ†ç»„çš„æ‰€éœ€æ—¶é—´ã€‚</p><p>ä¸ºäº†å®ç°åŸºäºæ—¶é—´çš„é‡ä¼ æœºåˆ¶ï¼Œå¼•å…¥äº†<strong>å€’è®¡æ•°å®šæ—¶å™¨</strong>ï¼Œåœ¨ä¸€ä¸ªç»™å®šçš„æ—¶é—´è¿‡æœŸåï¼Œå¯ä¸­æ–­å‘é€æ–¹ã€‚</p><p>rdt3.0 â€” æ¯”ç‰¹äº¤æ›¿åè®®ï¼ˆåˆ†ç»„åºå·åœ¨0å’Œ1ä¹‹é—´æ›¿æ¢ï¼‰</p><p>æ€§èƒ½ä½</p></li><li><p>æ”¹è¿›çš„rdt3.0  æµæ°´çº¿åè®®</p><p>rdt3.0æ€§èƒ½é—®é¢˜çš„æ ¸å¿ƒåœ¨äºå…¶æ˜¯ä¸€ä¸ªåœç­‰åè®®ï¼Œå‘è¿™ä¸ªä¸€ä¸ªæŠ¥æ–‡æ®µçš„åæˆ‘åªèƒ½ç­‰å¾…æ¥æ”¶æ–¹å‘æ¥çš„ACKï¼Œç­‰å¾…çš„æ—¶é—´å¤§é‡è¢«æµªè´¹æ‰ã€‚</p><p>ä¸ºä»€ä¹ˆå«æµæ°´çº¿ï¼Ÿ è®¸å¤šä»å‘é€æ–¹å‘æ¥æ”¶æ–¹è¾“é€çš„åˆ†ç»„å¯ä»¥çœ‹æˆæ˜¯å¡«å……åˆ°ä¸€æ¡æµæ°´çº¿ä¸­</p><p>è¦æ±‚ï¼š</p><ul><li>å¿…é¡»å¢åŠ åºå·èŒƒå›´ã€‚ä¼ è¾“çš„åˆ†ç»„å¿…é¡»æœ‰å”¯ä¸€çš„åºå·</li><li>å‘é€æ–¹æ¥æ”¶æ–¹å¯èƒ½ä¼šç¼“å­˜å¤šä¸ªåˆ†ç»„ï¼Œåœ¨æœ€åº•ä¸‹æ–°éƒ½ä½ åº”å½“ç¼“å†²é‚£äº›å·²å‘é€ä½†æ²¡æœ‰ç¡®è®¤çš„åˆ†ç»„</li><li>æ•°æ®ä¼ è¾“åè®®å¦‚ä½•å¤„ç†ä¸¢å¤±ã€æŸåã€å»¶æ—¶å¤§çš„åˆ†ç»„ã€‚è§£å†³æµæ°´çº¿çš„å·®é”™æ¢å¤çš„ä¸¤ç§åŸºæœ¬æ–¹æ³•ï¼š<ul><li>å›é€€Næ­¥ï¼ˆGo-Back-Nï¼ŒGBNï¼‰</li><li>é€‰æ‹©é‡ä¼ ï¼ˆSelective Repeatï¼ŒSRï¼‰</li></ul></li></ul></li></ol><h4 id="å›é€€Næ­¥">å›é€€Næ­¥</h4><p>å…è®¸å‘é€æ–¹å‘é€å¤šä¸ªåˆ†ç»„è€Œä¸éœ€ç­‰å¾…ç¡®è®¤ï¼Œå—é™äº  åœ¨æµæ°´çº¿ä¸­æœªç¡®è®¤çš„åˆ†ç»„æ•°ä¸èƒ½è¶…è¿‡æŸä¸ªæœ€å¤§å€¼ã€‚</p><p>å·²è¢«å‘é€ä½†è¿˜æœªè¢«ç¡®è®¤çš„åˆ†ç»„çš„è®¸å¯åºå·èŒƒå›´å¯ä»¥è¢«çœ‹æˆæ˜¯ä¸€ä¸ªåœ¨åºå·èŒƒå›´å†…é•¿åº¦ä¸ºNçš„<strong>çª—å£</strong></p><p>å› æ­¤GBNä¹Ÿå¸¸è¢«æˆä¸º<strong>æ»‘åŠ¨çª—å£åè®®</strong></p><p>ä¸‰ç§æƒ…å†µï¼šå‘é€ã€æ”¶åˆ°ACKã€è¶…æ—¶</p><p>GBNä¸­ï¼Œæ¥æ”¶æ–¹ä¸¢å¼ƒæ‰€æœ‰å¤±åºåˆ†ç»„ã€‚å› ä¸ºæ•°æ®å¿…é¡»æŒ‰åºäº¤ä»˜ï¼Œä½†æ¥æ”¶æ–¹å¯ä»¥ç¼“å­˜æå‰åˆ°æ¥çš„åˆ†ç»„ã€‚å‘é€æ–¹éœ€è¦ç»´æŠ¤çª—å£çš„ä¸Šä¸‹ä¾¿æ· å’Œnextseqnumåœ¨çª—å£çš„ä½ç½®ï¼Œæ¥æ”¶æ–¹éœ€è¦ç»´æŠ¤ä¸‹ä¸€ä¸ªæŒ‰åºæ¥æ”¶çš„åˆ†ç»„çš„åºå·ã€‚</p><p>ç¼ºç‚¹ï¼šå½“çª—å£é•¿åº¦å’Œå¸¦å®½æ—¶å»¶ç§¯éƒ½å¾ˆå¤§æ—¶ï¼Œå•ä¸ªåˆ†ç»„çš„å·®é”™èƒ½å¤Ÿå¼•èµ·GBNé‡ä¼ å¤§é‡åˆ†ç»„ï¼Œè®¸å¤šåˆ†ç»„æ ¹æœ¬æ²¡å¿…è¦é‡ä¼ ã€‚</p><h4 id="é€‰æ‹©é‡ä¼ ">é€‰æ‹©é‡ä¼ </h4><p>SRåè®®é€šè¿‡è®©å‘é€æ–¹ä»…é‡ä¼ é‚£äº›å®ƒæ€€ç–‘åœ¨æ¥æ”¶æ–¹å‡ºé”™çš„åˆ†ç»„è€Œé¿å…äº†ä¸å¿…è¦çš„é‡ä¼ ã€‚</p><p>ä¸‰è€…å…·ä½“å·®åˆ«ï¼Œ<a href="https://blog.csdn.net/hjl_heart/article/details/88218012?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_title~default-1.no_search_link&amp;spm=1001.2101.3001.4242">CSDNæˆ³è¿™é‡Œ</a>ï¼Œ<a href="https://www.bilibili.com/video/BV1Wz4y1S7L3?from=search&amp;seid=5367526131040405021&amp;spm_id_from=333.337.0.0">Bç«™è®²è§£</a>ï¼Œ<a href="https://www.bilibili.com/video/BV1HJ411w77K?from=search&amp;seid=10888591370497029891&amp;spm_id_from=333.337.0.0">æ¹–ç§‘å¤§ç‰ˆæœ¬-å›é€€Nå¸§</a>ï¼Œ<a href="https://www.bilibili.com/video/BV1nJ411u74k?from=search&amp;seid=8259728890129923825&amp;spm_id_from=333.337.0.0">æ¹–ç§‘å¤§ç‰ˆæœ¬é€‰æ‹©é‡ä¼ </a></p><h3 id="é¢å‘è¿æ¥çš„è¿è¾“ï¼šTCP">é¢å‘è¿æ¥çš„è¿è¾“ï¼šTCP</h3><h4 id="TCPè¿æ¥">TCPè¿æ¥</h4><p>ä¸ºä»€ä¹ˆæ˜¯é¢å‘è¿æ¥çš„ï¼š å‘é€æ•°æ®å‰ï¼Œä¸¤ä¸ªè¿›ç¨‹å¿…é¡»â€œæ¡æ‰‹â€ï¼Œå‘é€é¢„å¤‡æŠ¥æ–‡æ®µï¼Œå»ºç«‹ç¡®ä¿æ•°æ®ä¼ è¾“çš„å‚æ•°</p><p>Vinton Cerf å’ŒRobert Kahnå‘æ˜äº†TCP/IPåè®®ï¼ˆTransmission Control Protocol / Internet Protocolï¼Œä¼ è¾“æ§åˆ¶åè®®/ç½‘é™…åè®®ï¼‰ è·å¾—â€œACMå›¾çµå¥–â€</p><p>å»ºç«‹TCPè¿æ¥åï¼Œå®¢æˆ·è¿›ç¨‹é€šè¿‡å¥—æ¥å­—ä¼ é€’æ•°æ®ï¼Œä¸€æ—¦æ•°æ®é€šè¿‡äº†è¿™æ‰‡é—¨ï¼Œåˆ™å°±ç”±å®¢æˆ·ä¸­çš„TCPæ§åˆ¶äº†ï¼ŒTCPå°†æ•°æ®å¼•å¯¼è¿›å‘é€ç¼“å­˜ä¸­ã€‚ä¸æ–­åœ°ä»ç¼“å­˜ä¸­æ‹¿å»æ•°æ®ï¼Œå¹¶å°†å…¶æŠ•é€’åˆ°ç½‘ç»œå±‚</p><ul><li><p>æä¾›å…¨åŒå·¥æœåŠ¡  full-duplex service</p></li><li><p>TCPè¿æ¥æ˜¯ç‚¹å¯¹ç‚¹ï¼šå•ä¸ªå‘é€æ”¾å’Œå•ä¸ªæ¥æ”¶æ–¹ä¹‹é—´å»ºç«‹è¿æ¥</p></li><li><p>TCPå¯ä»å‘é€ç¼“å­˜ä¸­å–å‡ºå¹¶æ”¾å…¥æŠ¥æ–‡æ®µçš„æ•°æ®æ•°é‡å—é™äºæœ€å¤§æŠ¥æ–‡é•¿åº¦ï¼ˆMaximum segment Size ï¼ŒMSSï¼‰</p><p>MSSé€šå¸¸æ ¹æ®æœ€åˆç¡®å®šçš„ç”±æœ¬åœ°å‘é€ä¸»æœºå‘é€çš„æœ€å¤§é“¾è·¯å±‚å¸§é•¿åº¦ï¼ˆæœ€å¤§ä¼ è¾“å•å…ƒ MTUï¼‰æ¥è®¾ç½®</p><p>MSSæŒ‡çš„æ˜¯ <strong>æŠ¥æ–‡æ®µé‡Œåº”ç”¨å±‚æ•°æ®çš„æœ€å¤§é•¿åº¦ï¼Œè€Œä¸æ˜¯åŒ…æ‹¬é¦–éƒ¨çš„TCPæŠ¥æ–‡æ®µçš„æœ€å¤§é•¿åº¦</strong></p></li></ul><h4 id="æŠ¥æ–‡ç»“æ„">æŠ¥æ–‡ç»“æ„</h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210914163318606.png" alt="image-20210914163318606"></p><p>é¦–éƒ¨ä¸€èˆ¬20å­—èŠ‚ï¼ˆä¸åŒ…æ‹¬é€‰é¡¹ï¼‰</p><ol><li><p>åºå·å’Œç¡®è®¤å·</p><p>è¯¥åºå·éå½¼åºå·ï¼Œåºå·å»ºç«‹åœ¨ä¼ é€çš„å­—èŠ‚æµä¹‹ä¸Šï¼Œè€Œä¸æ˜¯åœ¨ä¼ é€çš„æŠ¥æ–‡æ®µåºåˆ—ä¹‹ä¸Š</p><p>ä¸€ä¸ªæŠ¥æ–‡æ®µçš„åºå·æ˜¯è¯¥æŠ¥æ–‡æ®µé¦–å­—èŠ‚çš„å­—èŠ‚æµç¼–å·</p><p>ç¡®è®¤å·ï¼š Aâ€”&gt;Bï¼Œwhen B----&gt;Aæ—¶ï¼ŒBè¦ç»™Aè¯´æˆ‘å¸Œæœ›ä¸‹ä¸€æ¬¡ä½ ç»™æˆ‘å‘æ¶ˆæ¯æ—¶ä»å“ªé‡Œå¼€å§‹å‘ï¼ˆèµ·å§‹å­—èŠ‚å·ï¼‰</p><p>TCPåªç¡®è®¤è¯¥æµä¸­è‡³ç¬¬ä¸€ä¸ªä¸¢å¤±å­—èŠ‚ä¸ºæ­¢çš„å­—èŠ‚ï¼Œæ‰€ä»¥TCPè¢«ç§°ä¸º<strong>ç´¯è®¡ç¡®è®¤</strong></p><p>æ³¨æ„ï¼š<strong>åºå·å’Œç¡®è®¤å·é’ˆå¯¹çš„éƒ½æ˜¯å­—èŠ‚</strong></p><p>å¯¹å®¢æˆ·åˆ°æœåŠ¡å™¨çš„æ•°æ®çš„ç¡®è®¤è¢«è£…åœ¨åœ¨ä¸€ä¸ªæ‰¿è½½æœåŠ¡å™¨åˆ°å®¢æˆ·æ•°æ®çš„æŠ¥æ–‡æ®µä¸­ï¼Œè¿™ç§ç¡®è®¤è¢«ç§°ä¸ºæ˜¯<strong>æå¸¦</strong>åœ¨æœåŠ¡å™¨åˆ°å®¢æˆ·çš„æ•°æ®æ®µæŠ¥æ–‡ä¸­</p></li><li><p>TCPæ£€éªŒå’Œ</p><ul><li>TCPæ•´ä½“æ£€éªŒï¼ˆåŒ…æ‹¬è½½è·ï¼‰[12å­—èŠ‚ä¼ªé¦–éƒ¨]  TCPé¦–éƒ¨æ ¡éªŒå’Œè®¡ç®—ä¸‰éƒ¨åˆ†ï¼šTCPé¦–éƒ¨+TCPæ•°æ®+TCPä¼ªé¦–éƒ¨ã€‚</li><li>é¦–å…ˆï¼ŒæŠŠä¼ªé¦–éƒ¨ã€TCPæŠ¥å¤´ã€TCPæ•°æ®åˆ†ä¸º16ä½çš„å­—ï¼Œå¦‚æœæ€»é•¿åº¦ä¸ºå¥‡æ•°ä¸ªå­—èŠ‚ï¼Œåˆ™åœ¨æœ€åå¢æ·»ä¸€ä¸ªä½éƒ½ä¸º0çš„å­—èŠ‚ã€‚ æŠŠTCPæŠ¥å¤´ä¸­çš„æ ¡éªŒå’Œå­—æ®µç½®ä¸º0ã€‚ã€‚å…¶æ¬¡ï¼Œç”¨åç ç›¸åŠ æ³•ï¼ˆå¯¹æ¯16bitè¿›è¡ŒäºŒè¿›åˆ¶åç æ±‚å’Œï¼‰<strong>ç´¯åŠ </strong>æ‰€æœ‰çš„16ä½å­—ï¼ˆè¿›ä½ä¹Ÿè¦ç´¯åŠ ï¼Œè¿›ä½åˆ™å°†é«˜ä½å åŠ åˆ°ä½ä½ï¼‰ã€‚æœ€åï¼Œå°†ä¸Šè¿°ç»“æœä½œä¸ºTCPçš„æ ¡éªŒå’Œï¼Œå­˜åœ¨æ£€éªŒå’Œå­—æ®µä¸­</li></ul></li><li><p><strong>é€‰é¡¹</strong>ï¼š</p><ol><li>Selective Acknowledgements â€”SACKã€‚æ•°æ®åŒ…æœªæŒ‰åºåˆ°è¾¾ï¼Œèƒ½å¦ä¸é‡ä¼ å·²æ¥å—åˆ°çš„æ•°æ®ï¼Œåªä¼ æ²¡å¾—åˆ°çš„æ•°æ®</li><li>TimeStampæ–¹ä¾¿è®¡ç®—TTL</li><li>NOP å¡«å……</li><li>Window Scale æ–¹ä¾¿2^næŒ‡æ•°æ‰©å¤§çª—å£å¤§å°</li></ol></li></ol><h4 id="å¾€è¿”æ—¶é—´çš„ä¼°è®¡å’Œè¶…æ—¶">å¾€è¿”æ—¶é—´çš„ä¼°è®¡å’Œè¶…æ—¶</h4><ol><li><p>ä¼°è®¡å¾€è¿”æ—¶é—´</p><p>é€šè¿‡æ ·æœ¬è¿›è¡Œæµ‹é‡  ã€‚ ä»…åœ¨æŸä¸ªæ—¶åˆ»åšä¸€æ¬¡SampleRTTæµ‹é‡ã€‚ä»»æ„æ—¶åˆ»ï¼Œä»…ä¸ºä¸€ä¸ªå·²å‘é€çš„ä½†ç›®å‰å°šæœªè¢«ç¡®è®¤è¿‡çš„æŠ¥æ–‡æ®µä¼°è®¡SampleRTTï¼Œä»è€Œäº§ç”Ÿä¸€ä¸ªæ¥è¿‘æ¯ä¸ªRTTçš„æ–°çš„SampleRTTå€¼</p><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c">EliminatedRTT  <span class="token operator">-</span> <span class="token number">8.875</span> <span class="token operator">*</span> EstimatedRTT <span class="token operator">+</span> <span class="token number">0.125</span> <span class="token operator">*</span> SampleRTT   <span class="token comment">//æŒ‡æ•°åŠ æƒå¹³å‡</span>   DevRTT <span class="token operator">=</span> <span class="token number">0.75</span> <span class="token operator">*</span> DevRTT <span class="token operator">+</span> <span class="token number">0.25</span> <span class="token operator">*</span> <span class="token operator">|</span>SampleRTT <span class="token operator">-</span> EstimatedRTT<span class="token operator">|</span></code></pre></div></li><li><p>è®¾ç½®å’Œç®¡ç†é‡ä¼ è¶…æ—¶é—´éš”</p><p>è¶…æ—¶é—´éš”ä¸èƒ½å¤ªçŸ­ä¹Ÿä¸èƒ½å¤ªé•¿</p><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c">TimeoutInterval <span class="token operator">=</span> EstimatedRTT <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> DevRTT</code></pre></div><p>SampleRTTæ³¢åŠ¨å¤§ ï¼Œåˆ™ä½™é‡å¤§ï¼Œæ³¢åŠ¨å°åˆ™ä½™é‡å°ã€‚</p></li></ol><h4 id="å¯é æ•°æ®ä¼ è¾“">å¯é æ•°æ®ä¼ è¾“</h4><p>IPæœåŠ¡ä¸ä¿è¯æ•°æ®åŒ…çš„äº¤ä»˜ã€æŒ‰åºã€å®Œæ•´ç­‰é—®é¢˜ã€‚</p><p>TCPçš„rdtç¡®ä¿ä¸€ä¸ªè¿›ç¨‹ä»å…¶æ¥æ”¶ç¼“å­˜ä¸­ç‹¬å¤„çš„æ•°æ®æµæ˜¯æ— æŸåï¼Œæ— é—´éš™ã€éå†—æ‚å’ŒæŒ‰åºçš„æ•°æ®æµã€‚</p><p><strong>è¶…æ—¶é—´éš”åŠ å€</strong></p><p>æ¯æ¬¡TCPé‡ä¼ ä¼šå°†ä¸‹ä¸€æ¬¡çš„è¶…å¸‚é—´éš”è®¾ç½®ä¸ºå…ˆå‰å€¼çš„ä¸¤å€ï¼Œè€Œä¸æ˜¯é€šè¿‡Estimatedå’ŒDevRTTçš„æ¨ç®—å€¼</p><p><strong>å¿«é€Ÿé‡ä¼ </strong></p><p>å‘é€æ–¹é€šå¸¸å¯åœ¨è¶…æ—¶æ—¶é—´å‘ç”Ÿä¹‹å‰é€šè¿‡æ³¨æ„å†—ä½™ACKæ¥æ£€æµ‹ä¸¢åŒ…æƒ…å†µã€‚</p><p>å†—ä½™ACKæ˜¯å†æ¬¡ç¡®è®¤æŸä¸ªæŠ¥æ–‡æ®µçš„ACKï¼ŒæŒ‡ç¤ºä¸‹ä¸€ä¸ªæœŸå¾…çš„å­—èŠ‚çš„åºå·</p><p>å› ä¸ºå‘é€æ–¹ç»å¸¸å‘é€å¤§é‡çš„æŠ¥æ–‡æ®µï¼Œå¦‚æœä¸€ä¸ªæŠ¥æ–‡æ®µä¸¢å¤±ï¼Œä¼šå¼•èµ·è®¸å¤šä¸€ä¸ªæ¥ä¸€ä¸ªçš„å†—ä½™ACKï¼Œå¦‚æœTCPå‘é€æ–¹æ¥æ”¶åˆ°ç›¸åŒçš„3ä¸ªå†—ä½™ACKï¼Œå°±æ‰§è¡Œå¿«é€Ÿé‡ä¼ ï¼ˆåœ¨è¯¥æŠ¥æ–‡æ®µçš„å®šæ—¶å™¨è¿‡æœŸä¹‹å‰é‡ä¼ ï¼‰</p><p><strong>å›é€€Næ­¥è¿˜æ˜¯é€‰æ‹©é‡ä¼ </strong></p><p>é€‰æ‹©ç¡®è®¤ï¼šå…è®¸TCPæ¥æ”¶æ–¹æœ‰é€‰æ‹©åœ°ç¡®è®¤å¤±åºæŠ¥æ–‡æ®µï¼Œè€Œä¸æ˜¯ç´¯è®¡åœ°ç¡®è®¤æœ€ç«ä¸€ä¸ªæ­£ç¡®æ¥æ”¶çš„æŠ¥æ–‡æ®µ</p><h4 id="æµé‡æ§åˆ¶-v2">æµé‡æ§åˆ¶</h4><p>æ¥æ”¶æ–¹åº”ç”¨å¯èƒ½å¾ˆå¿™ï¼Œæ•°æ®åˆ°è¾¾TCPç¼“å­˜åï¼Œæš‚æ—¶æ²¡æ—¶é—´è¯»å–ï¼Œå¦‚æœå‘é€æ–¹å‘çš„å¤ªå¤šï¼Œå¯èƒ½ä½¿å¾—æ¥æ”¶ç¼“å­˜æº¢å‡ºã€‚</p><p>ä¸ºåº”ç”¨ç¨‹åºæä¾›ï¼Œä½¿å¾— å‘é€æ–¹å‘é€é€Ÿç‡å’Œæ¥æ”¶æ–¹æ¥å—é€Ÿç‡å¤§è‡´ç›¸åŒã€‚ä»¥æ¶ˆé™¤å‘é€æ–¹ä½¿å¾—æ¥æ”¶æ–¹ç¼“å­˜æº¢å‡ºçš„å¯èƒ½æ€§ï¼Œä¸æ‹¥å¡æ§åˆ¶ååˆ†ç›¸ä¼¼ã€‚</p><p>å‘é€æ–¹ç»´æŠ¤ä¸€ä¸ª<strong>æ¥æ”¶çª—å£</strong>(rwnd)ï¼Œæç¤ºå‘é€æ–¹æ¥æ”¶æ–¹è¿˜æœ‰å¤šå°‘å¯ç”¨çš„ç¼“å­˜ç©ºé—´ã€‚ï¼ˆç”±äºTCPå…¨åŒå·¥ï¼Œæ‰€ä»¥æ¥æ”¶ã€å‘é€æ–¹éƒ½ç»´æŠ¤ä¸€ä¸ªæ¥æ”¶çª—å£ï¼‰</p><p>å¦‚ä½•ç¡®ä¿æ¥å—ç¼“å­˜ä¸æº¢å‡ºï¼šå‘é€åˆ°è¿æ¥ä¸­ä½†æœªè¢«ç¡®è®¤çš„å€¼ &lt;= rwnd</p><p>å¦‚æœrwnd == 0ï¼Œå‘é€æ–¹ä¸»æœºç»§ç»­å‘é€åªæœ‰ä¸€ä¸ªå­—èŠ‚æ•°æ®çš„æŠ¥æ–‡æ®µï¼ŒæŠ¥æ–‡æ®µä¼šè¢«æ¥æ”¶æ–¹ç¡®è®¤ï¼Œæœ€ç»ˆç¼“å­˜å¼€å§‹æ¸…ç©ºï¼Œå¹¶ä¸”ç¡®è®¤æŠ¥æ–‡å°†åŒ…å«ä¸€ä¸ªé0çš„rwndå€¼</p><p><a href="https://www.bilibili.com/video/BV1EJ411n7qb?spm_id_from=333.999.0.0">TCPçš„æµé‡æ§åˆ¶ï¼ˆæ¹–ç§‘å¤§ï¼‰</a></p><h4 id="TCPçš„è¿æ¥ç®¡ç†">TCPçš„è¿æ¥ç®¡ç†</h4><p>å¦‚ä½•å»ºç«‹å’Œæ‹†é™¤ä¸€æ¡TCPï¼Ÿä¸‰æ¡å››æŒ¥</p><ol><li><p>ä¸‰æ¬¡æ¡æ‰‹</p><ul><li>å®¢æˆ·ç«¯å‘é€ç‰¹æ®ŠæŠ¥æ–‡æ®µï¼Œä¸åŒ…å«åº”ç”¨å±‚æ•°æ®  æ ‡å¿—ä½SYN =  1ï¼Œå®¢æˆ·ç«¯è¿˜ä¼šéšæœºé€‰æ‹©ä¸€ä¸ªåˆå§‹åºå·(client_isn)ï¼Œæ”¾åœ¨è¯¥æŠ¥æ–‡æ®µçš„åºå·å­—æ®µä¸­ã€‚</li><li>æœåŠ¡å™¨TCPæ¥æ”¶ï¼Œåˆ†é…ç¼“å­˜ã€‚å‘å®¢æˆ·TCPå‘é€å…è®¸è¿æ¥çš„æŠ¥æ–‡æ®µï¼Œ SYN = 1 ï¼Œç¡®è®¤å·= client_isn +1ï¼ŒæœåŠ¡å™¨å†é€‰æ‹©è‡ªå·±çš„åˆå§‹åºå·(server_isn)æ”¾å…¥åºå·å­—æ®µä¸­ã€‚è¯¥æŠ¥æ–‡æ®µç§°ä¸ºSYNACKæŠ¥æ–‡æ®µ</li><li>å®¢æˆ·ç«¯æ”¶åˆ°è¯¥æŠ¥æ–‡æ®µåï¼Œä¹Ÿè¦åˆ†é…ç¼“å­˜ã€‚å‘é€æŠ¥æ–‡æ®µï¼Œç¡®è®¤å·=server_isn + 1 ,SYN = 0 ACK=1ï¼ˆå› ä¸ºè¿æ¥å·²ç»å»ºç«‹ï¼‰ã€‚<strong>è¿™ä¸ªé˜¶æ®µå¯ä»¥åœ¨æŠ¥æ–‡æ®µä¸­è´Ÿè½½å‘é€ç»™æœåŠ¡å™¨çš„æ•°æ®äº†</strong>ï¼ˆåº”ç”¨æ®µï¼‰</li></ul></li><li><p>å››æ¬¡æŒ¥æ‰‹</p></li><li><p>SYNæ´ªæ³›æ”»å‡»(SYN flood attack)</p><p>å¦‚æœæ¡æ‰‹æœ€åä¸€æ¬¡å®¢æˆ·ç«¯ä¸å‘é€ACKï¼Œåˆ™æœåŠ¡å™¨ä¼šåœ¨ä¸€åˆ†é’Ÿåç»ˆæ­¢è¯¥åŠå¼€è¿æ¥å¹¶å›æ”¶èµ„æºã€‚</p><p>æ”»å‡»è€…å‘é€å¤§é‡TCP SYNæŠ¥æ–‡æ®µï¼Œè€Œä¸å®Œæˆç¬¬ä¸‰æ¬¡è¿‡ç¨‹ï¼Œåˆ™æœåŠ¡å™¨ä¼šä¸æ–­ä¸ºåŠå¼€è¿æ¥åˆ†é…èµ„æºï¼Œå¯¼è‡´é“¾æ¥èµ„æºè¢«æ¶ˆè€—ã€‚</p><p>é˜²èŒƒæ–¹æ³•ï¼šSYN cookie</p><ul><li>æœåŠ¡å™¨æœ€å¼€å§‹æ¥æ”¶åˆ°æ•°æ®æ—¶ï¼Œå¹¶ä¸çŸ¥é“è¯¥æŠ¥æ–‡æ®µæ˜¯æ¥è‡ªåˆæ³•çš„ç”¨æˆ·è¿˜æ˜¯SYNæ´ªæ³›æ”»å‡»ã€‚å› æ­¤ä¸ä¼šç”Ÿæˆä¸€ä¸ªåŠå¼€è¿æ¥ã€‚æœåŠ¡å™¨ä¼šç”Ÿæˆä¸€ä¸ªåˆå§‹TCPåºåˆ—å·ï¼Œä¸SYNæŠ¥æ–‡æ®µçš„æºå’Œç›®çš„IPåœ°å€ã€ç«¯å£å·å’ŒæœåŠ¡å™¨çŸ¥é“çš„ç§˜å¯†æ•°æœ‰å…³ï¼Œè¿™ç§ç²¾å¿ƒåˆ¶ä½œçš„åºåˆ—å·å«cookieã€‚è€ŒæœåŠ¡å™¨è‡ªèº«ä¸è®°å¿†è¯¥cookieã€‚</li><li>å¦‚æœå®¢æˆ·åˆæ³•ï¼Œä¼šç»™ACKï¼Œåˆ™éªŒè¯æ˜¯å¯¹çš„ï¼Œåˆ™æœåŠ¡å™¨ç”Ÿæˆä¸€ä¸ªå…·æœ‰å¥—æ¥å­—çš„å…¨å¼€è¿æ¥ã€‚å¦‚æœä¸åˆæ³•ï¼Œæ²¡æœ‰è¿”å›ACKæŠ¥æ–‡æ®µï¼Œåˆ™ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œå› ä¸ºæœåŠ¡å™¨æ²¡æœ‰ä¸ºå®ƒåˆ†é…ä»»ä½•èµ„æºã€‚</li></ul></li></ol><h3 id="æ‹¥å¡æ§åˆ¶åŸç†">æ‹¥å¡æ§åˆ¶åŸç†</h3><p>å¤ªå¤šçš„æºå‘ä»¥è¿‡é«˜çš„é€Ÿç‡å‘é€æ•°æ®ï¼Œé€ æˆè·¯ç”±å™¨æº¢å‡ºã€‚éœ€è¦ä¸€äº›æ‰‹æ®µæ¥éåˆ¶å‘é€æ–¹ã€‚éå¸¸çš„é‡è¦</p><h4 id="æ‹¥å¡ä»£ä»·å’ŒåŸå› ">æ‹¥å¡ä»£ä»·å’ŒåŸå› </h4><p>ä»£ä»·(ä¹¦ä¸­çš„ä¾‹å­æ¯”è¾ƒå…·ä½“     P172)</p><ol><li><p>ä¸¤ä¸ªå‘é€æ–¹å’Œä¸€å°æ— ç©·å¤§ç¼“å­˜çš„è·¯ç”±å™¨</p><p>æ¯è¿æ¥çš„ååé‡ ï¼š æ¥æ”¶æ–¹æ¯ç§’æ¥æ”¶çš„å­—èŠ‚æ•°</p><ul><li>åˆ†ç»„çš„åˆ°è¾¾é€Ÿç‡æ¥è¿‘é“¾è·¯å®¹é‡æ—¶ï¼Œåˆ†ç»„ä¼šç»å†å·¨å¤§çš„æ’é˜Ÿæ—¶å»¶ï¼ˆè·¯ç”±å™¨ç¼“å­˜æ— çº¿å¤§ï¼‰</li></ul></li><li><p>ä¸¤ä¸ªå‘é€æ–¹å’Œä¸€å°å…·æœ‰æœ‰é™ç¼“å­˜çš„è·¯ç”±å™¨</p><p>è¿è¾“å±‚å‘ç½‘ç»œä¸­å‘é€æŠ¥æ–‡æ®µçš„é€Ÿç‡ b byte/s ï¼š ä¾›ç»™è½½è·(offered load)</p><p>ä¸¤ç§æƒ…å†µ</p><ul><li>å‘é€æ–¹æ‰§è¡Œé‡ä¼ ä»¥è¡¥å¿å› ä¸ºç¼“å­˜æº¢å‡ºè€Œä¸¢å¼ƒçš„åˆ†ç»„</li><li>åœ¨æ—¶å»¶è¾ƒå¤§æ—¶å‘é€æ–¹è¿›è¡Œä¸å¿…è¦çš„é‡ä¼ å¼•èµ·è·¯ç”±å™¨åˆ©ç”¨å…¶é“¾è·¯å¸¦å®½æ¥è½¬å‘ä¸å¿…è¦çš„åˆ†ç»„å‰¯æœ¬</li></ul></li><li><p>4ä¸ªå‘é€æ”¾å’Œå…·æœ‰æœ‰é™ç¼“å­˜çš„å¤šå°è·¯ç”±å™¨å’Œå¤šè·³è·¯å¾„</p><ul><li>å½“ä¸€ä¸ªåˆ†ç»„æ²¿ä¸€æ¡è·¯å¾„è¢«ä¸¢å¼ƒï¼Œæ¯ä¸ªä¸Šæ¸¸è·¯ç”±å™¨ç”¨æˆ·è½¬å‘è¯¥åˆ†ç»„åˆ°ä¸¢å¼ƒè¯¥åˆ†ç»„è€Œä½¿ç”¨çš„ä¼ è¾“å®¹é‡å°±è¢«æµªè´¹æ‰äº†</li></ul></li></ol><h4 id="æ‹¥å¡æ§åˆ¶æ–¹æ³•">æ‹¥å¡æ§åˆ¶æ–¹æ³•</h4><ul><li>ç«¯åˆ°ç«¯æ‹¥å¡æ§åˆ¶ï¼ˆIPä¸ä¼šå‘ç«¯ç³»ç»Ÿæä¾›æœ‰å…³ç½‘ç»œæ‹¥å¡çš„åé¦ˆä¿¡æ¯ï¼‰</li><li>ç½‘ç»œè¾…åŠ©çš„æ‹¥å¡æ§åˆ¶ã€‚ATM å¯ç”¨æ¯”ç‰¹ç‡ï¼Œè·¯ç”±å™¨æ˜¾ç¤ºåœ°Tonå‘ŠçŸ¥å‘é€å®ƒèƒ½åœ¨è¾“å‡ºé“¾è·¯ä¸Šæ”¯æŒçš„æœ€å¤§ç«¯ç³»ç»Ÿå‘é€é€Ÿç‡ã€‚<ul><li>ç›´æ¥åé¦ˆï¼šè·¯ç”±å™¨å‘é€ç»™å‘é€æ–¹ï¼ˆâ€œæˆ‘æ‹¥å¡äº†ï¼Œä½ åˆ«ä¼ äº† â€ï¼‰</li><li>ä¸­é—´å•†ä¿®æ”¹ï¼šè·¯ç”±å™¨æ ‡è®°æˆ–æ›´æ–°ä»å‘é€æ–¹æµå‘æ¥æ”¶æ–¹çš„åˆ†ç»„ä¸­çš„æŸä¸ªå­—æ®µæ¥æŒ‡ç¤ºæ‹¥å¡çš„äº§ç”Ÿï¼Œä¸€æ—¦æ”¶åˆ°è¿™ä¸ªæ ‡è®°çš„åˆ†ç»„ï¼Œæ¥æ”¶æ–¹å°±å‘å‘é€æ–¹é€šçŸ¥ç½‘ç»œæ‹¥å¡æŒ‡ç¤ºã€‚</li></ul></li></ul><h3 id="TCPæ‹¥å¡æ§åˆ¶">TCPæ‹¥å¡æ§åˆ¶</h3><p>TCPå¿…é¡»ä½¿ç”¨ç«¯åˆ°ç«¯çš„æ‹¥å¡æ§åˆ¶è€Œä¸æ˜¯ä½¿ç”¨ç½‘ç»œè¾…åŠ©çš„æ‹¥å¡æ§åˆ¶ï¼Œå› ä¸ºIPå±‚ä¸å‘ç«¯ç³»ç»Ÿæä¾›æ˜¾ç¤ºçš„ç½‘ç»œæ‹¥å¡åé¦ˆã€‚</p><ul><li>å¦‚ä½•é™åˆ¶å®ƒçš„å‘é€é€Ÿç‡ï¼Ÿ</li><li>å¦‚ä½•æ„ŸçŸ¥ç½‘ç»œæ‹¥å¡</li><li>æ„ŸçŸ¥åˆ°æ‹¥å¡æ—¶ï¼Œæ€æ ·å˜åŒ–å‘é€é€Ÿç‡ï¼Ÿ</li></ul><p>å‘é€æ–¹çš„TCPè·Ÿè¸ªä¸€ä¸ªé¢å¤–å˜é‡ï¼ˆæ‹¥å¡çª—å£ cwndï¼‰ï¼Œåœ¨å‘é€æ–¹ä¸­æœªè¢«ç¡®è®¤çš„æ•°æ®é‡ &lt;= min {rwnd, cwnd};</p><h4 id="TCPæ‹¥å¡æ§åˆ¶ç®—æ³•"><strong>TCPæ‹¥å¡æ§åˆ¶ç®—æ³•</strong></h4><ol><li><p>æ…¢å¯åŠ¨</p><p>è¿æ¥åˆšå¼€å§‹æ—¶ï¼Œcwnd = MSSè¾ƒå°å€¼  â‰ˆ MSS/RTTã€‚å¯ç”¨çš„å¸¦å®½å¯èƒ½è¿˜æœ‰å¾ˆå¤šï¼ŒTCPå¸Œæœ›å°½å¿«åœ°æ‰¾åˆ°è¿™ä¸ªå€¼ã€‚</p><p>cwndä»¥1ä¸ªMSSå¼€å§‹ï¼Œå¹¶ä¸”æŠ¥æ–‡æ®µé¦–æ¬¡è¢«ç¡®è®¤æ—¶ï¼Œcwndå°±å¢åŠ ä¸€ä¸ªMSSã€‚æ­¤åä¸€æ ·ï¼Œx2é€Ÿç‡è¿›è¡Œã€‚</p><p>ä½•æ—¶åœæ­¢ï¼Ÿ</p><p>å¦‚æœå‘ç”Ÿä¸¢åŒ…ï¼ŒTCPå°†cwndè®¾ç½®ä¸º1å¹¶é‡å¯æ…¢å¯åŠ¨è¿‡ç¨‹ã€‚å¹¶ä¸”ï¼Œå°†ssthresh(æ…¢å¯åŠ¨é˜ˆå€¼)è®¾ç½®ä¸ºcwnd/2.å½“cwndè¶…è¿‡ssthreshå€¼æ—¶ï¼Œç»§ç»­æ—¶cwndç¿»å€å°±æ²¡ä»€ä¹ˆæ•ˆæœäº†ï¼Œè¿™æ—¶ç»“æŸæ…¢å¯åŠ¨ï¼Œå¹¶ä¸”TCPè½¬ç§»åˆ°æ‹¥å¡é¿å…æ¨¡å¼ï¼Œæ›´åŠ è°¨æ…çš„å¢åŠ cwndã€‚</p><ul><li>å¦‚æœä¸¢åŒ…æ˜¯å› ä¸ºç®€å•è¶…æ—¶ï¼Œåˆ™cwnd = 1MSS ssthresh = 1cwnd(old) è¿›å…¥æ‹¥å¡é¿å…</li><li>å¦‚æœä¸¢åŒ…æ˜¯å› ä¸ºæ”¶åˆ°äº†å†—ä½™ACKï¼Œå¿«é€Ÿé‡ä¼ å¹¶ä¸”è¿…é€Ÿæ¢å¤</li></ul><p>é¢å¤–ï¼šTCPåˆ†å²”ï¼Œä¼˜åŒ–äº‘æœåŠ¡æ€§èƒ½</p></li><li><p>æ‹¥å¡é¿å…</p><p>æ¯ä¸ªRTTï¼ˆæ³¨æ„ï¼Œä¸æ˜¯ACKï¼‰åå°†cwndçš„å€¼å¢åŠ ä¸€ä¸ªMSS</p><ul><li>å¦‚æœä¸¢åŒ…æ˜¯å› ä¸ºç®€å•è¶…æ—¶ï¼Œåˆ™cwnd = 1MSS ssthresh = 1cwnd(old) ç»§ç»­è¿›å…¥æ…¢å¯åŠ¨</li><li>å¦‚æœä¸¢åŒ…æ˜¯å› ä¸ºæ”¶åˆ°äº†å†—ä½™ACKï¼Œåˆ™ ssthresh = cwnd/2;  cwnd /=2ï¼Œè¿›å…¥å¿«æ¢å¤</li></ul></li><li><p>å¿«é€Ÿæ¢å¤</p><p>å¯¹æ¯ä¸ªACKï¼Œcwndå€¼å¢åŠ ä¸€ä¸ªMSS</p><ul><li><p>æ—©æœŸ ï¼ŒTahoeï¼šä¸ç®¡æ˜¯è¶…æ—¶è¿˜æ˜¯3ä¸ªå†—ä½™ï¼Œéƒ½å°†cwnd ç½®ä¸º1MSSï¼Œè¿›å…¥æ…¢å¯åŠ¨</p></li><li><p>æ–°ç‰ˆæœ¬ï¼Œ Renoï¼š</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210915200815873.png" alt="image-20210915200815873"></p></li></ul></li><li><p>å›é¡¾</p><p>TCPæ‹¥å¡æ§åˆ¶åˆè¢«ç§°ä¸ºï¼šåŠ æ€§å¢ã€ä¹˜æ€§å‡ï¼ˆAIMDï¼‰  ï¼Œé”¯é½¿å½¢ä½</p></li></ol><p>ä¸€æ¡è¿æ¥çš„å¹³å‡ååé‡ = 1.22 * MSS / (RTT * æ ¹å·L)  Lï¼šä¸¢åŒ…ç‡</p><h6 id="1-å…¬å¹³æ€§">1. å…¬å¹³æ€§</h6><p>å¤šæ¡TCPè¿æ¥ï¼Œæœ‰ä¸åŒçš„ç«¯åˆ°ç«¯è·¯å¾„ï¼Œä½†éƒ½è¦ç»è¿‡ä¸€æ¡ç“¶é¢ˆé“¾è·¯ï¼Œå¦‚æœæ¯æ¡è¿æ¥éƒ½å¾—åˆ°ç›¸åŒä»½é¢çš„é“¾è·¯å¸¦å®½ï¼Œåˆ™è®¤ä¸ºè¯¥æ‹¥å¡æ§åˆ¶æœºåˆ¶æ˜¯å…¬å¹³çš„ã€‚</p><h2 id="ç½‘ç»œå±‚ï¼šæ•°æ®å¹³é¢">ç½‘ç»œå±‚ï¼šæ•°æ®å¹³é¢</h2><p>ç½‘ç»œä¸­çš„æ¯ä¸€å°ä¸»æœºå’Œè·¯ç”±å™¨éƒ½æœ‰ç½‘ç»œå±‚</p><h3 id="æ¦‚è¿°-v7">æ¦‚è¿°</h3><p>æ•°æ®å¹³é¢ä½œç”¨ï¼šæ­¤è¾“å…¥é“¾è·¯å‘è¾“å‡ºé“¾è·¯è½¬å‘æ•°æ®åŒ…</p><p>æ§åˆ¶å¹³é¢ä½œç”¨ï¼šåè°ƒæœ¬åœ°çš„æ¯è·¯ç”±å™¨è½¬å‘åŠ¨ä½œï¼Œä½¿å¾—æ•°æ®æŠ¥æ²¿ç€å’Œç›®çš„åœ°ä¸»æœºä¹‹é—´çš„è·¯ç”±å™¨è·¯å¾„æœ€ç»ˆè¿›è¡Œç«¯åˆ°ç«¯çš„ä¼ é€</p><p>è·¯ç”±å™¨ä¸è¿è¡Œåœ¨åº”ç”¨å±‚å’Œè¿è¾“å±‚åè®®ï¼Œæ•…æ²¡æœ‰ä¸Šä¸¤å±‚</p><p>ä¸»è¦çš„ä¸¤ç§ç½‘ç»œå±‚åŠŸèƒ½ï¼š</p><ul><li><p><strong>è½¬å‘</strong>ï¼šå°†åˆ†ç»„ä»ä¸€ä¸ªè¾“å…¥é“¾è·¯æ¥å£è½¬ç§»åˆ°é€‚å½“çš„è¾“å‡ºé“¾è·¯æ¥å£çš„è·¯ç”±å™¨æœ¬åœ°åŠ¨ä½œã€‚</p><p>æ˜¯æ•°æ®å¹³é¢ä¸­å®ç°çš„å”¯ä¸€åŠŸèƒ½ï¼Œè·¯ç”±å™¨å°†åˆ†ç»„ç§»åŠ¨åˆ°é€‚å½“çš„è¾“å‡ºé“¾è·¯ã€‚</p></li><li><p><strong>è·¯ç”±é€‰æ‹©</strong>ï¼š ç¡®å®šåˆ†ç»„ä»æºåˆ°ç›®çš„åœ°æ‰€é‡‡å–çš„ç«¯åˆ°ç«¯è·¯å¾„çš„ç½‘ç»œèŒƒå›´å¤„ç†è¿‡ç¨‹ã€‚ç½‘ç»œå±‚å†³å®šåˆ†ç»„é‡‡ç”¨çš„è·¯å¾„ï¼ˆè·¯ç”±é€‰æ‹©ç®—æ³•ï¼‰</p></li></ul><p><strong>è½¬å‘è¡¨</strong>ï¼š æ¯å°è·¯ç”±å™¨ä¸­çš„å…³é”®å…ƒç´ ã€‚è·¯ç”±å™¨æ£€æŸ¥åˆ°è¾¾åˆ†ç»„é¦–éƒ¨çš„ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ®µå€¼ï¼Œä½¿ç”¨è¿™äº›é¦–éƒ¨å€¼åœ¨è½¬å‘è¡¨ä¸­ç´¢å¼•ï¼Œä»¥æ­¤æ¥è½¬å‘åˆ†ç»„ã€‚</p><ol><li><p>æ§åˆ¶å¹³é¢ï¼šä¼ ç»Ÿçš„æ–¹æ³•</p><p>è½¬å‘è¡¨å¦‚ä½•é…ç½®ï¼Ÿ</p><p>è·¯ç”±é€‰æ‹©ç®—æ³•å†³å®šäº†æ’å…¥è¯¥è½¬å‘è¡¨ä¸­çš„å†…å®¹ã€‚</p></li><li><p>æ§åˆ¶å¹³é¢ï¼šSDNæ–¹æ³•</p><p>è·¯ç”±é€‰æ‹©ä»…æ‰§è¡Œè½¬å‘ï¼Œ è¿œç¨‹æ§åˆ¶å™¨è®¡ç®—å¹¶åˆ†å‘è½¬å‘è¡¨ï¼Œä»¥æ­¤åšåˆ°åˆ†ç¦»ã€‚</p><p>æœ¬è´¨ï¼šè½¯ä»¶å®šä¹‰ç½‘ç»œ(Software-Defined Networking ï¼ŒSDN)</p></li></ol><p><strong>ç½‘ç»œæœåŠ¡æ¨¡å‹</strong></p><p>å› ç‰¹ç½‘çš„ç½‘ç»œå±‚æä¾›å•ä¸€çš„æœåŠ¡ï¼Œ<strong>å°½åŠ›è€Œä¸ºæœåŠ¡</strong></p><h3 id="è·¯ç”±å™¨å·¥ä½œåŸç†">è·¯ç”±å™¨å·¥ä½œåŸç†</h3><p>4ä¸ªç»„ä»¶ï¼š</p><ul><li>è¾“å…¥ç«¯å£ï¼šåœ¨è·¯ç”±å™¨ä¸­æ‰§è¡Œç»ˆç»“å…¥ç‰©ç†é“¾è·¯çš„ç‰©ç†å±‚åŠŸèƒ½ã€‚ä¸ä½äºå…¥é“¾è·¯è¿œç«¯çš„æ•°æ®é“¾è·¯å±‚äº¤äº’æ¥æ‰§è¡Œæ•°æ®é“¾è·¯å±‚åŠŸèƒ½ã€‚</li><li>äº¤æ¢ç»“æ„ï¼Œå°†è·¯æ€„æ°”çš„è¾“å…¥ç«¯å£è¿æ¥åˆ°è¾“å‡ºç«¯å£</li><li>è¾“å‡ºç«¯å£ï¼šå­˜å‚¨ä»äº¤æ¢ç»“æ„æ¥æ”¶çš„åˆ†ç»„ã€‚é€šè¿‡æ‰§è¡Œå¿…è¦çš„è¿é“¾è·¯å±‚å’Œç‰©ç†å±‚åŠŸèƒ½åœ¨è¾“å‡ºé“¾è·¯ä¸Šä¼ è¾“è¿™äº›åˆ†ç»„ã€‚</li><li>è·¯ç”±é€‰æ‹©å¤„ç†å™¨ï¼šæ‰§è¡Œå¹³é¢åŠŸèƒ½ï¼Œä¼ ç»Ÿè·¯ç”±å™¨ä¸­ï¼Œæ‰§è¡Œè·¯ç”±é€‰æ‹©åè®®ï¼Œåœ¨SDNè·¯ç”±å™¨ä¸­ï¼Œè´Ÿè´£ä¸è¿œç¨‹æ§åˆ¶å™¨é€šä¿¡ã€‚</li></ul><h4 id="è¾“å…¥ç«¯å£å¤„ç†å’ŒåŸºäºç›®çš„åœ°è½¬å‘">è¾“å…¥ç«¯å£å¤„ç†å’ŒåŸºäºç›®çš„åœ°è½¬å‘</h4><ol><li><p>å‰ç¼€åŒ¹é…ï¼ˆè·¯ç”±å™¨è½¬å‘è¡¨ä¸­ä¸å¿…è¦æœ‰æ‰€æœ‰çš„ç›®çš„åœ°å€çš„å¯¹åº”ï¼‰ï¼Œæœ€é•¿å‰ç¼€åŒ¹é…è§„åˆ™</p><p>ä¸€æ—¦ç¡®å®šäº†æŸåˆ†ç»„çš„è¾“å‡ºç«¯å£ï¼Œè¯¥åˆ†ç»„å°±èƒ½å¤Ÿå‘é€è¿›å…¥äº¤æ¢ç»“æ„ã€‚ä½†è¯¥è¾“å…¥ç«¯å£å¯èƒ½è¢«å…¶ä»–åˆ†ç»„å ç”¨ï¼Œè¿™æ—¶å€™åˆšè¿›å…¥çš„å°±è¦è¢«æš‚æ—¶é˜»å¡ï¼Œéœ€è¦åœ¨è¾“å…¥ç«¯å£å¤„æ’é˜Ÿ</p></li><li><p>äº¤æ¢ï¼šåˆ†ç»„ä»ä¸€ä¸ªè¾“å…¥ç«¯å£äº¤æ¢ï¼ˆè½¬å‘ï¼‰ä¸€ä¸ªè¾“å‡ºç«¯å£ä¸­</p><p>ä¸‰ç§äº¤æ¢æŠ€æœ¯ï¼šå†…å­˜ã€æ€»çº¿ã€çºµæ¨ª P207</p><ul><li><p>å†…å­˜äº¤æ¢ï¼š</p><p>æœ€ç®€å•ï¼Œäº¤æ¢è¿‡ç¨‹åœ¨CPUï¼ˆè·¯ç”±é€‰æ‹©å¤„ç†å™¨ï¼‰çš„æ§åˆ¶ä¸‹å®Œæˆï¼Œé€šè¿‡ä¸­æ–­æ–¹å¼ï¼Œåˆ†ç»„è¢«å¤åˆ¶åˆ°å†…å­˜ä¸­ï¼Œç„¶åå†è¢«å¤åˆ¶åˆ°è¾“å‡ºç«¯å£çš„ç¼“å­˜ä¸­ã€‚</p><p>ç¼ºç‚¹ï¼šä¸èƒ½åŒæ—¶è½¬å‘ä¸¤ä¸ªåˆ†ç»„(ç»è¿‡å…±äº«ç³»ç»Ÿæ€»çº¿ä¸€æ¬¡ä»…èƒ½æ‰§è¡Œä¸€ä¸ªå†…å­˜è¯»/å†™)</p></li><li><p>ç»æ€»çº¿äº¤æ¢ï¼š</p><p>è¾“å…¥ç«¯å£ç»è¿‡ä¸€æ ¹å…±äº«æ€»çº¿å°†åˆ†ç»„ç›´æ¥ä¼ é€åˆ°è¾“å‡ºç«¯å£ï¼Œä¸éœ€è¦è·¯ç”±é€‰æ‹©å¤„ç†å™¨çš„å¹²é¢„ã€‚è¾“å…¥ç«¯å£ä¸ºåˆ†ç»„é¢„å…ˆè®¡åˆ’ä¸€ä¸ªäº¤æ¢æœºå†…éƒ¨æ ‡ç­¾ï¼ŒæŒ‡ç¤ºæœ¬åœ°è¾“å‡ºç«¯å£ï¼Œåˆ†ç»„åœ¨æ€»çº¿ä¸Šä¼ é€åˆ°è¾“å‡ºç«¯å£å“¦ï¼Œæ‰€æœ‰è¾“å‡ºç«¯å£éƒ½èƒ½æ”¶åˆ°ï¼Œä½†åªæœ‰ä¸è¯¥æ ‡ç­¾åŒ¹é…çš„ç«¯å£æ‰èƒ½ä¿å­˜è¯¥åˆ†ç»„ï¼Œç„¶åæ ‡ç­¾åœ¨è¾“å‡ºç«¯å£è¢«å»é™¤ã€‚</p><p>ä¸€æ¬¡åªæœ‰ä¸€ä¸ªåˆ†ç»„èƒ½è·¨è¶Šæ€»çº¿ï¼Œå…¶ä½™çš„éœ€è¦ç­‰å¾…ã€‚</p></li><li><p>ç»äº’è”ç½‘ç»œäº¤æ¢</p><p>é€šè¿‡å¼€å¯å’Œé—­åˆäº¤å‰ç‚¹ï¼Œèƒ½å¤Ÿå¹¶è¡Œè½¬å‘å¤šä¸ªåˆ†ç»„ã€‚çºµæ¨ªå¼äº¤æ¢æœºæ˜¯éé˜»å¡çš„ã€‚ä½†å¦‚æœç”±ä¸¤ä¸ªä¸åŒè¾“å…¥ç«¯å£çš„åˆ†ç»„ å…¶ç›®çš„åœ°ä¸ºç›¸åŒçš„è¾“å‡ºç«¯å£ï¼Œåˆ™ä¸€ä¸ªåˆ†ç»„éœ€è¦ç­‰å¾…ã€‚å› ä¸ºæŸä¸ªæ—¶åˆ»ç»ç»™å®šæ€»çº¿ä»…èƒ½å¤Ÿå‘é€ä¸€ä¸ªåˆ†ç»„ã€‚</p></li></ul><ol start="3"><li><p>è¾“å‡ºç«¯å£å¤„ç†</p><p>äº¤æ¢ç»“æ„  ----&gt; æ’é˜Ÿï¼ˆç¼“å­˜ç®¡ç†ï¼‰ ----&gt; æ•°æ®é“¾è·¯å¤„ç†ï¼ˆåè®®ã€å°è£…ï¼‰ â€”&gt; çº¿è·¯ç«¯æ¥</p></li><li><p>ä½•æ—¶å‡ºç°æ’é˜Ÿ</p><p>æ’é˜Ÿé˜Ÿåˆ—å¢é•¿ï¼Œè·¯ç”±å™¨çš„ç¼“å­˜ç©ºé—´æœ€ç»ˆå°†ä¼šè¢«è€—å°½----&gt; ä¸¢åŒ…</p><ol><li><p>è¾“å…¥æ’é˜Ÿ</p><p>äº¤æ¢ç»“æ„æ— æ³•å¿«å¾—è®©æ‰€æœ‰åˆ°è¾¾åˆ†ç»„æ— æ—¶å»¶åœ°é€šè¿‡å®ƒä¼ é€ï¼ˆæ¥çº¿å‘˜å¿™ï¼‰ï¼Œåˆ™åˆ°è¾¾çš„åˆ†ç»„å¿…é¡»åŠ å…¥è¾“å…¥ç«¯å£é˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…é€šè¿‡äº¤æ¢ç»“æ„ä¼ é€ã€‚</p><p>å¤šä¸ªä¸åŒåˆ†ç»„è¢«åˆ†é…åˆ°äº†ç›¸åŒè¾“å‡ºç«¯å£ï¼Œåˆ™å…¶ä¸­å¤šä¸ªéœ€è¦ç­‰å¾…ï¼Œä¸”æ’åœ¨æ¯ä¸ªåˆ†ç»„åçš„åˆ†ç»„ä¹Ÿè¦ç­‰å¾…   çº¿è·¯å‰éƒ¨(Head-Of the Line,HOL)é˜»å¡ï¼Œå³åœ¨ä¸€ä¸ªè¾“å…¥é˜Ÿåˆ—ä¸­æ’é˜Ÿçš„åˆ†ç»„å¿…é¡»ç­‰å¾…é€šè¿‡äº¤æ¢ç»“æ„å‘é€ï¼Œå› ä¸ºå®ƒè¢«ä½äºçº¿è·¯å‰éƒ¨çš„å¦ä¸€ä¸ªåˆ†ç»„æ‰€é˜»å¡ã€‚</p></li><li><p>è¾“å‡ºæ’é˜Ÿ</p><p>äº¤æ¢æœºé€Ÿåº¦è¾ƒå¿«</p><p>å¼ƒå°¾</p><p>ä¸»åŠ¨é˜Ÿåˆ—ç®¡ç†ï¼ˆActive Queue Management ï¼ŒAQMï¼‰ï¼Œéšæœºæ—©æœŸæ£€æµ‹ï¼ˆRandom Early Detectionï¼ŒREDï¼‰æ˜¯AQMä¹‹ä¸€</p><p>å¦‚ä½•å†³å®šè·¯ç”±å™¨ç¼“å­˜å®¹é‡ï¼š</p><p>RTT * é“¾è·¯å®¹é‡C</p></li></ol></li><li><p>åˆ†ç»„è°ƒåº¦</p><ol><li><p>å…ˆè¿›å…ˆå‡º FIFO</p></li><li><p>ä¼˜å…ˆæƒæ’é˜Ÿ</p><p>æ¯ä¸ªä¼˜å…ˆæƒç±»æœ‰è‡ªå·±çš„é˜Ÿåˆ—åŸºäºIPçš„å®æ—¶è¯éŸ³åˆ†ç»„å¯èƒ½è·å¾—è¾ƒé«˜ä¼˜å…ˆæƒ</p><p>ä¼˜å…ˆæƒç±»åˆ†ç»„ä¹‹é—´çš„é€‰æ‹©è¿˜æ˜¯FIFO</p></li><li><p>å¾ªç¯å’ŒåŠ æƒå…¬å¹³æ’é˜Ÿ</p><p>åŠ æƒå…¬å¹³æ’é˜Ÿï¼ˆWeighted Fair Queuingï¼‰ï¼Œä¸åœå¾ªç¯ä¸åŒåŠ æƒç±»</p></li></ol></li></ol></li></ol><h3 id="ç½‘é™…åè®®">ç½‘é™…åè®®</h3><h4 id="IPV4æ•°æ®æŠ¥æ ¼å¼">IPV4æ•°æ®æŠ¥æ ¼å¼</h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210918102733176.png" alt="image-20210918102733176"></p><ul><li><p>ç‰ˆæœ¬å·ï¼šè§„å®šæ•°æ®æŠ¥çš„IPåè®®ç‰ˆæœ¬ï¼ŒæŸ¥çœ‹ç‰ˆæœ¬å·â€”&gt; è·¯ç”±å™¨ç¡®å®šå¦‚ä½•è§£é‡Šæ•°æ®æŠ¥å‰©ä½™éƒ¨åˆ†ã€‚</p></li><li><p>é¦–éƒ¨é•¿åº¦ã€‚IPv4æ•°æ®æŠ¥å¯èƒ½åŒ…å«å¯å˜æ•°é‡çš„é€‰é¡¹ï¼Œä»¥æ­¤æ¥ç¡®å®šæ•°æ®æŠ¥è½½è·å®é™…å¼€å§‹çš„åœ°æ–¹</p></li><li><p>æœåŠ¡ç±»å‹ TOSï¼Œä½¿ä¸åŒç±»å‹ç­‰å¾…IPæ•°æ®æŠ¥ç›¸äº’åŒºåˆ«å¼€ï¼ˆä½å»¶è¿Ÿã€é«˜ååâ€¦ï¼‰ã€‚ä¾‹å¦‚åŒºåˆ†éå®æ—¶æµé‡(FTP)å’Œå®æ—¶æ•°æ®æŠ¥(IPç”µè¯åº”ç”¨)</p></li><li><p>æ•°æ®æŠ¥é•¿åº¦ï¼Œæ ‡è¯†IPæ•°æ®æŠ¥æ€»é•¿åº¦  æœ€å¤§65535å­—èŠ‚</p></li><li><p>æ ‡è¯†ã€æ ‡å¿—ã€ç‰‡åç§»ã€‚ç”¨äºåˆ†ç‰‡</p></li><li><p>å¯¿å‘½TTLï¼Œï¼ˆTime To Liveï¼‰ ç¡®ä¿æ•°æ®ä¸ä¼šæ°¸è¿œåœ¨ç½‘ç»œä¸­å¾ªç¯ã€‚æ¯å½“ä¸€å°è·¯ç”±å™¨å¤„ç†è¯¥æ•°æ®æŠ¥æ—¶ï¼ŒTTLâ€“ï¼š è‹¥TTL== 0 ï¼Œåˆ™å­—æ®µä¼šè¢«ä¸¢å¼ƒ</p></li><li><p>åè®®ï¼Œé€šå¸¸ä»…å½“ä¸€ä¸ªIPæ•°æ®æŠ¥åˆ°è¾¾æœ€ç»ˆç›®çš„åœ°æ—¶æ‰ä¼šæœ‰ç”¨ã€‚æŒ‡ç¤ºIPæ•°æ®æŠ¥çš„æ•°æ®éƒ¨åˆ†åº”è¯¥äº¤ç»™å“ªä¸ªç‰¹å®šçš„è¿è¾“å±‚åè®®ã€‚</p><ul><li><p>åè®®å·å°†ç½‘ç»œå±‚å’Œè¿è¾“å±‚ç»‘å®š</p></li><li><p>ç«¯å£å·å°†è¿è¾“å±‚å’Œåº”ç”¨å±‚ç»‘å®š</p></li></ul></li><li><p>é¦–éƒ¨æ£€éªŒå’Œï¼Œå¸®åŠ©è·¯ç”±å™¨æ£€æµ‹IPæ•°æ®æŠ¥ä¸­çš„æ¯”ç‰¹é”™è¯¯ã€‚</p><p>ä»…æ£€éªŒé¦–éƒ¨ï¼ï¼å¦‚ä½•æ£€æµ‹ï¼Ÿ</p><p>ä¸ºä»€ä¹ˆTCP/IPåœ¨è¿è¾“å±‚å’Œç½‘ç»œå±‚éƒ½æ‰§è¡Œå·®é”™æ£€æµ‹ï¼Ÿ</p><ol><li>IPå±‚åªå¯¹IPé¦–éƒ¨è®¡ç®—äº†æ£€éªŒå’Œ,TCP/UDPå¯¹æ•´ä¸ªæŠ¥æ–‡æ®µè¿›è¡Œæ£€æµ‹</li><li>TCP/UDP ä¸ IPä¸ä¸€å®šå±äºåŒä¸€ä¸ªåè®®æ ˆã€‚ï¼ˆä¾‹å¦‚ï¼ŒTCPèƒ½å¤Ÿè¿è¡Œåœ¨ATMä¸Šï¼Œè€ŒIPèƒ½ä¼ ç»™å…¶ä»–è¿è¾“å±‚ï¼‰</li></ol></li><li><p>æºå’Œç›®çš„IPåœ°å€</p></li><li><p>é€‰é¡¹ï¼Œå…è®¸IPé¦–éƒ¨è¢«æ‰©å±•ï¼Œipv6ä¸­å»æ‰äº†è¿™ä¸ªé€‰é¡¹ï¼ˆå¯å˜é•¿åº¦å¯¼è‡´è·¯ç”±å™¨å¤„ç†IPæ•°æ®æŠ¥æ‰€éœ€çš„æ—¶é—´å˜åŒ–å¤§ï¼‰</p></li><li><p>æ•°æ®ï¼ˆæœ‰æ•ˆè½½è·ï¼‰</p></li></ul><h4 id="IPv4æ•°æ®æŠ¥åˆ†ç‰‡">IPv4æ•°æ®æŠ¥åˆ†ç‰‡</h4><p>é—®é¢˜ï¼šå¹¶ä¸æ˜¯æ‰€æœ‰çš„é“¾è·¯å±‚åè®®éƒ½èƒ½æ‰¿è½½ç›¸åŒé•¿åº¦çš„ç½‘ç»œå±‚åˆ†ç»„ã€‚</p><p>æœ€å¤§ä¼ é€å•å…ƒ(MTU) ï¼šä¸€ä¸ªé“¾è·¯å±‚å¸§èƒ½æ‰¿è½½çš„æœ€å¤§æ•°æ®é‡ï¼Œä¸¥æ ¼é™åˆ¶IPæ•°æ®æŠ¥é•¿åº¦ï¼ˆé—®é¢˜æ˜¯å‘é€æ–¹ä¸ç›®çš„åœ°è·¯å¾„ä¸Šçš„æ¯æ®µé“¾è·¯å¯èƒ½ä½¿ç”¨ä¸åŒçš„é“¾è·¯å±‚åè®®ï¼Œæ¯ç§åè®®å¯èƒ½å…·æœ‰ä¸åŒçš„MTUï¼‰</p><p>æ¯”å¦‚ä¸€æ¡é“¾è·¯ä¸ŠMTUå¾ˆå¤§ï¼Œå‘çš„IPæ•°æ®æŠ¥å¾ˆå¤§ï¼Œæ¥ç€çš„é“¾è·¯ä¸ŠMTUå°ï¼Œå‘çš„IPæ•°æ®æŠ¥å°ï¼Œè¿™æ—¶å€™ä¸€ä¸ªåˆ†ç»„è¯¥æ€ä¹ˆåŠï¼Ÿ</p><p><strong>åˆ†ç‰‡</strong>ï¼šæ•°æ®åˆ†ç‰‡æˆä¸¤ä¸ªæˆ–è€…æ›´å¤šä¸ªè¾ƒå°çš„IPæ•°æ®æŠ¥ï¼Œç”¨å•ç‹¬çš„é“¾è·¯å±‚å°è£…è¿™äº›è¾ƒå°çš„IPæ•°æ®æŠ¥ï¼Œé€šè¿‡è¾“å‡ºé“¾è·¯å‘é€è¿™äº›å¸§ã€‚è¿™äº›è¾ƒå°çš„æ•°æ®æŠ¥ç§°ä¸º<strong>ç‰‡</strong></p><p>ç‰‡åœ¨åˆ°è¾¾ç›®çš„åœ°åéœ€è¦é‡æ–°ç»„è£…ï¼Œç»„è£…çš„å·¥ä½œåœ¨ç«¯ç³»ç»Ÿä¸­ã€‚</p><p>å¦‚ä½•åˆ¤æ–­æ”¶åˆ°ï¼Ÿå¦‚ä½•ç¡®å®šä¸¢å¤±ï¼Ÿ</p><p>å‘é€ä¸»æœºé€šå¸¸å°†å‘é€æ¯ä¸ªæ•°æ®æŠ¥çš„æ ‡è¯†å·+1ï¼Œç”±äºIPçš„ä¸å¯é æ€§ï¼Œä¸ºäº†è®©ç›®çš„ä¸»æœºç»å¯¹ç›¸ä¿¡å®ƒæ”¶åˆ°äº†åˆå§‹æ•°æ®æŠ¥çš„æœ€åä¸€ä¸ªç‰‡ï¼Œæœ€åä¸€ä¸ªç‰‡çš„æ ‡å¿—æ¯”ç‰¹= 0 ï¼Œè€Œå…¶ä»–æ‰€æœ‰ç‰‡çš„æ ‡å¿—æ¯”ç‰¹= 1ã€‚å¹¶ä¸”ï¼Œä¸ºäº†è®©ç›®çš„ä¸»æœºç¡®å®šæ˜¯å¦ä¸¢å¤±äº†ä¸€ä¸ªç‰‡ï¼Œä½¿ç”¨åç§»å­—æ®µæ¥åˆ¶å®šè¯¥ç‰‡åº”è¯¥æ”¾åœ¨åˆå§‹æ•°æ®æŠ¥çš„å“ªä¸ªä½ç½®ã€‚</p><h4 id="IPv4ç¼–å€">IPv4ç¼–å€</h4><p>ä¸€å°ä¸»æœºä¸€èˆ¬åªæœ‰ä¸€æ¡é“¾è·¯è¿æ¥åˆ°ç½‘ç»œã€‚å¦‚æœå‘å‘é€æ•°æ®æŠ¥ï¼Œåˆ™åœ¨è¯¥é“¾è·¯ä¸Šå‘é€</p><p>è·¯ç”±å™¨æœ‰ä¸¤æ¡æˆ–å¤šæ¡é“¾è·¯ä¸å®ƒè¿æ¥ï¼ˆæ¥æ”¶ã€è½¬å‘ï¼‰ï¼Œè·¯ç”±å™¨ä¸å®ƒä»»æ„ä¸€æ¡é“¾è·¯ä¹‹é—´çš„è¾¹ç•Œå«æ¥å£</p><p>ä¸»æœºä¸ç‰©ç†é“¾è·¯ä¹‹é—´çš„è¾¹ç•Œå«æ¥å£ã€‚</p><p>IPè¦æ±‚æ¯å°ä¸»æœºå’Œè·¯ç”±å™¨æ¥å£æ‹¥æœ‰è‡ªå·±çš„IPåœ°å€ï¼ˆä¸€ä¸ªIPåœ°å€ä¸ä¸€ä¸ªæ¥å£ç›¸å…³è”ï¼Œè€Œä¸æ˜¯åŒ…æ‹¬è¯¥æ¥å£çš„ä¸»æœºæˆ–è·¯ç”±å™¨ï¼‰</p><p>IPåœ°å€é•¿åº¦ï¼š4å­—èŠ‚ 32bit æ€»å…±æœ‰ 2<sup>32</sup> (40äº¿ä¸ª)ï¼Œç‚¹åˆ†åè¿›åˆ¶æ³•ä¹¦å†™</p><p>å­ç½‘ï¼šå¤šä¸ªä¸»æœºæ¥å£ä¸è·¯ç”±å™¨æ¥å£çš„ç½‘ç»œ</p><p>IPåœ°å€ä¸ºå­ç½‘åˆ†é…åœ°å€ï¼ˆ223.1.1.0/24ï¼Œè¿™æ ·çš„è®°æ³•è¢«ç§°ä¸ºå­ç½‘æ©ç ï¼‰ï¼Œå·¦ä¾§çš„24bitå®šä¹‰äº† å­ç½‘åœ°å€ï¼Œå…¶ä½™çš„æ˜¯å¯åˆ†é…çš„ã€‚</p><p>å› ç‰¹ç½‘çš„åœ°å€åˆ†é…ç­–ç•¥ï¼š<strong>æ— ç±»åˆ«åŸŸé—´è·¯ç”±é€‰æ‹©</strong>  CIDRï¼ˆClassless InterDomain Routingï¼‰</p><p>a.b.c.d/xçš„xæœ€é«˜æ¯”ç‰¹æ„æˆäº†IPåœ°å€çš„ç½‘ç»œéƒ¨åˆ†ï¼Œç§°ä¸ºè¯¥åœ°å€çš„å‰ç¼€ï¼Œç»„ç»‡å†…éƒ¨çš„è®¾å¤‡çš„IPåœ°å€å°†äº«æœ‰å…±åŒçš„å‰ç¼€æ¯”ç‰¹xã€‚</p><p>åœ°å€èšåˆã€è·¯ç”±èšåˆã€è·¯ç”±æ‘˜è¦ï¼šä½¿ç”¨å•ä¸ªç½‘ç»œå‰ç¼€é€šå‘Šå¤šä¸ªç½‘ç»œçš„èƒ½åŠ›</p><p>CIDRé‡‡ç”¨å‰ï¼Œä½¿ç”¨çš„æ˜¯<strong>åˆ†ç±»ç¼–åˆ¶</strong>ï¼ˆA\B\Cç±»ç½‘ç»œï¼‰ï¼Œç¼ºç‚¹ï¼ŒCç±» /24å­ç½‘ä»…èƒ½å®¹çº³254ä¸»æœº â€” å¤ªå°‘ï¼ŒBç±» /16 æ”¯æŒ65534ä¸»æœºï¼Œå¤ªå¤šï¼Œé€ æˆæµªè´¹ã€‚</p><p>255.255.255.255 ï¼šIPå¹¿æ’­åœ°å€ï¼ŒæŠ¥æ–‡æ®µä¼šäº¤ä»˜ç»™åŒä¸€ä¸ªç½‘ç»œä¸­çš„æ‰€æœ‰ä¸»æœºï¼Œè·¯ç”±å™¨ä¹Ÿä¼šé€‰æ‹©åœ°å‘é‚»è¿‘çš„å­ç½‘è½¬å‘è¯¥æŠ¥æ–‡ã€‚</p><p><strong>ä¸€å°è®¾å¤‡å¦‚ä½•ä»æŸç»„ç»‡çš„åœ°å€å¿«ä¸­åˆ†é…åˆ°åœ°å€</strong>ï¼š</p><ol><li><p>è·å–ä¸€å—åœ°å€2</p><ul><li>ä¸€ä¸ªç»„ç»‡ä»ISPä¸­è·å–ä¸€ç»„åœ°å€</li><li>ä¸€ä¸ªISPè·å–ä¸€å—åœ°å€</li></ul><p>IPåœ°å€ç”±å› ç‰¹ç½‘åå­—å’Œç¼–å·åˆ†é…æœºæ„(ICANN)ç®¡ç†ï¼ˆå®ƒè¿˜ç®¡ç†DNSæ ¹æœåŠ¡å™¨ã€åˆ†é…åŸŸåå’Œè§£å†³åŸŸåçº·äº‰ï¼‰ï¼ŒICANNå‘åŒºåŸŸæ€§å› ç‰¹ç½‘æ³¨å†Œæœºæ„åˆ†é…åœ°å€ï¼Œè¿™äº›æœºæ„ä¸€èµ·å½¢æˆäº†ICANNçš„åœ°å€æ”¯æŒç»„ç»‡ã€‚</p></li><li><p>è·å–ä¸»æœºåœ°å€ï¼šåŠ¨æ€ä¸»æœºé…ç½®åè®®</p><p>ä¸ºç»„ç»‡å†…çš„ä¸»æœºé…ç½®IPåœ°å€ï¼š<strong>åŠ¨æ€ä¸»æœºé…ç½®åè®®</strong>ï¼ˆDynamic Host Configuration ï¼Œ <strong>DHCP</strong>ï¼‰ã€‚</p><p><strong>è§£é‡Š</strong>ï¼šDHCPå…è®¸ä¸»æœºè‡ªåŠ¨è·å–ä¸€ä¸ªIPåœ°å€ï¼Œç½‘ç»œç®¡ç†å‘˜ä¹Ÿèƒ½å¤Ÿé…ç½®DHCPï¼Œä»¥ä½¿å¾—ç»™å®šä¸»æœºæ¯æ¬¡ä¸ç½‘ç»œè¿æ¥éƒ½èƒ½å¾—åˆ°ä¸€ä¸ªç›¸åŒçš„IPåœ°å€ï¼ˆæœåŠ¡å™¨å›ºå®šIPåœ°å€åŸç†ï¼Ÿï¼‰ï¼Œæˆ–è€…å°†ä¸»æœºåˆ†é…åˆ°ä¸€ä¸ªä¸´æ—¶çš„IPåœ°å€ï¼ŒDHCPè¿˜å…è®¸ä¸»æœºå¾—çŸ¥å…¶ä»–ä¿¡æ¯ï¼ˆå­ç½‘æ©ç ã€ç¬¬ä¸€è·³è·¯ç”±å™¨ï¼ˆé»˜è®¤ç½‘ç®¡å…³ï¼‰ã€å®ƒçš„æœ¬åœ°DNSæœåŠ¡å™¨åœ°å€ï¼‰</p><p>ç”±äºDHCPå…·æœ‰å°†ä¸»æœºè¿æ¥è¿›ä¸€ä¸ªç½‘ç»œçš„ç½‘ç»œç›¸å…³æ–¹é¢çš„è‡ªåŠ¨èƒ½åŠ›ï¼Œåˆå¸¸è¢«ç§°ä¸º<strong>å³æ’å³ç”¨åè®®</strong>æˆ–è€…<strong>é›¶é…ç½®åè®®</strong>ï¼Œå¹¿æ³›ç”¨äºä½å®…å› ç‰¹ç½‘ã€ä¼ä¸šç½‘ã€æ— çº¿å±€åŸŸç½‘</p><p>æœ¬èº«æ˜¯ä¸€ä¸ªB-Såè®®ï¼Œå®¢æˆ·æ˜¯ä¸€ä¸ªæ–°åˆ°è¾¾çš„ä¸»æœºï¼Œæƒ³è·å¾—è‡ªèº«çš„IPåœ°å€åœ¨å†…çš„ç½‘ç»œé…ç½®ä¿¡æ¯ã€‚å¦‚æœå­ç½‘æ²¡æœ‰æœåŠ¡å™¨ï¼Œåˆ™éœ€è¦DHCPä¸­ç»§ä»£ç†ï¼ˆé€šå¸¸æ˜¯ä¸€å°è·¯ç”±å™¨ï¼‰ï¼Œä»£ç†çŸ¥é“ç”¨äºè¯¥ç½‘ç»œçš„DHCPæœåŠ¡å™¨çš„åœ°å€ã€‚</p><p>æ–°åˆ°è¾¾çš„ä¸»æœºå¦‚ä½•ä¸DHCPäº¤äº’ä»¥è·å¾—IPåœ°å€ï¼Ÿ</p><ul><li>DHCPæœåŠ¡å™¨å‘ç°ã€‚æ–°åˆ°è¾¾çš„ä¸»æœºçš„é¦–è¦ä»»åŠ¡æ˜¯å‘ç°ä¸€ä¸ªè¦ä¸ä¹‹äº¤äº’çš„DHCPæœåŠ¡å™¨ï¼Œä½¿ç”¨<strong>DHCPå‘ç°æŠ¥æ–‡</strong>ã€‚å®¢æˆ·åœ¨UDPåˆ†ç»„ä¸­å‘ç«¯å£<strong>67</strong>å‘é€æŠ¥æ–‡ï¼ŒUDPåˆ†ç»„å°è£…åœ¨IPæ•°æ®æŠ¥ä¸­ï¼ˆä½†è¿™ä¸ªæ•°æ®æŠ¥åº”è¯¥å‘ç»™è°ï¼Ÿè¿IPåœ°å€éƒ½ä¸çŸ¥é“å•Šï¼Ÿï¼‰ã€‚<strong>ä½¿ç”¨å¹¿æ’­ç›®çš„åœ°å€255.255.255.255 å¹¶ä¸”ä½¿ç”¨æœ¬ä¸»æœºçš„æºIPåœ°å€0.0.0.0</strong>ã€‚è¯¥æ•°æ®æŠ¥é€šè¿‡é“¾è·¯å±‚ï¼Œé“¾è·¯å±‚å°†è¯¥å¸§å¹¿æ’­åˆ°æ‰€æœ‰ä¸è¯¥å­ç½‘è¿æ¥çš„èŠ‚ç‚¹ã€‚</li><li>DHCPæœåŠ¡å™¨æä¾›ã€‚DHCPæœåŠ¡å™¨æ”¶åˆ°DHCPå‘ç°æŠ¥æ–‡æ—¶ï¼Œåšå‡ºå“åº”ï¼Œè¯¥æŠ¥æ–‡å‘è¯¥å­ç½‘çš„æ‰€æœ‰èŠ‚ç‚¹å¹¿æ’­ï¼Œä»ç„¶ç”¨255.255.255.255ï¼ˆä¸ºä»€ä¹ˆä¸ç”¨ä¹‹å‰æ•°æ®æŠ¥çš„æºIPåœ°å€ï¼Ÿ  å› ä¸ºå­ç½‘ä¸­å¯èƒ½å­˜åœ¨å‡ ä¸ªDHCPæœåŠ¡å™¨ï¼Œè¯¥å®¢æˆ·ä¹Ÿè®¸ä¼šå‘ç°ä»–å¤„äºèƒ½åœ¨å‡ ä¸ªæä¾›è€…ä¹‹é—´é€‰æ‹©çš„ä¼˜è¶Šä½ç½®ï¼‰ã€‚æ¯å°æœåŠ¡å™¨æä¾›çš„æŠ¥æ–‡åŒ…å«ç”±æ”¶åˆ°å‘ç°æŠ¥æ–‡çš„äº‹åŠ¡IDï¼Œå‘å®¢æˆ·æ¨èçš„IPåœ°å€ã€ç½‘ç»œæ©ç ä»¥åŠIPåœ°å€ç§Ÿç”¨æœŸï¼ˆIPåœ°å€çš„æœ‰æ•ˆæ—¶é—´é‡ï¼‰ã€‚æœåŠ¡å™¨ç§Ÿç”¨æœŸä¸€èˆ¬ä¸ºå‡ å°æ—¶æˆ–è€…å‡ å¤©</li><li>DHCPè¯·æ±‚ï¼Œæ–°åˆ°è¾¾çš„å®¢æˆ·ä»ä¸€ä¸ªæˆ–å¤šä¸ªæœåŠ¡å™¨ä¸­é€‰æ‹©ä¸€ä¸ªï¼Œå¹¶å‘é€‰ä¸­çš„æœåŠ¡å™¨æä¾›ç”¨<strong>DHCPè¯·æ±‚æŠ¥æ–‡</strong>è¿›è¡Œå“åº”ã€‚</li><li>DHCP ACKã€‚æœåŠ¡å™¨ç”¨DHCP ACKæŠ¥æ–‡å¯¹è¯·æ±‚æŠ¥æ–‡è¿›è¡Œå“åº”ï¼Œè¯å®æ‰€è¦æ±‚çš„å‚æ•°ã€‚</li></ul><p>ä¸€æ—¦å®¢æˆ·æ”¶åˆ°DHCP ACKï¼Œè¯¥å®¢æˆ·èƒ½å¤Ÿåœ¨<strong>ç§Ÿç”¨æœŸå†…</strong>ä½¿ç”¨DHCPåˆ†é…çš„IPåœ°å€ã€‚å¦‚æœå®¢æˆ·å¸Œæœ›åœ¨è¯¥ç§Ÿç”¨æœŸè¶…æ—¶åç»§ç»­ä½¿ç”¨è¿™ä¸ªåœ°å€ï¼ŒDHCPè¿˜æœ‰ä¸€ç§æœºåˆ¶å…è®¸å®¢æˆ·æ›´æ–°å®ƒå¯¹è¿™ä¸ªIPåœ°å€çš„ç§Ÿç”¨</p><p>ç¼ºç‚¹ï¼šæ¯å½“èŠ‚ç‚¹è¿æ¥åˆ°æ–°çš„å­ç½‘ï¼Œè¦ä»DHCPè·å–æ–°çš„IPåœ°å€ï¼Œä¸èƒ½ç»´æŒä¸è¿œç¨‹åº”ç”¨ä¹‹é—´çš„TCPè¿æ¥ï¼ˆè§£å†³æ–¹æ¡ˆï¼šç§»åŠ¨IPï¼šå¯¹IPåŸºç¡€è®¾æ–½çš„æ‰©å±•ï¼Œå…è®¸ç§»åŠ¨èŠ‚ç‚¹åœ¨ç½‘ç»œä¹‹é—´ç§»åŠ¨æ—¶ä½¿ç”¨å…¶å•ä¸€æ°¸ä¹…çš„åœ°å€ï¼‰</p></li></ol><h4 id="ç½‘ç»œåœ°å€è½¬æ¢">ç½‘ç»œåœ°å€è½¬æ¢</h4><p>éšç€å°é›†å›¢çš„éœ€æ±‚å¢å¤šï¼ˆåŠå…¬å®¤â€¦ï¼‰ï¼Œå­ç½‘è¢«å¤§é‡éœ€æ±‚ï¼Œå¦‚æœå­ç½‘å˜å¤§äº†ï¼Œè¶…è¿‡äº†åŸæœ‰éœ€æ±‚ï¼Œæ€ä¹ˆåŠï¼Ÿ</p><p><strong>ç½‘ç»œåœ°å€è½¬æ¢ ï¼ˆNetwork Address Translationï¼ŒNATï¼‰</strong></p><p>NATä½¿å¾—è·¯ç”±å™¨å¯¹äºå¤–éƒ¨ä¸–ç•Œè€Œè¨€ä¸æ˜¯ä¸€å°è·¯ç”±å™¨ï¼Œæ›´åƒæ˜¯ä¸€ä¸ªå…·æœ‰å•ä¸€IPçš„å•ä¸€è®¾å¤‡ï¼Œæ‰€æœ‰ç¦»å¼€å®¶åº­è·¯ç”±å™¨æµå‘æ›´å¤§å› ç‰¹ç½‘çš„æŠ¥æ–‡éƒ½æœ‰ä¸€ä¸ªæºIPåœ°å€ï¼Œä¸”æ‰€æœ‰è¿›å…¥å®¶åº­çš„æŠ¥æ–‡éƒ½æœ‰åŒä¸€ä¸ªç›®çš„IPåœ°å€ã€‚ï¼ˆæœ¬è´¨ä¸Šï¼ŒNATä½¿å¾—è·¯ç”±å™¨å¯¹å¤–å¤–ç•Œéšè—äº†å®¶åº­ç½‘ç»œçš„ç»†èŠ‚  [ä¸­é—´ç›’]ï¼‰ ï¼ˆDHCPå‘æŒ¥äº†ä½œç”¨ï¼‰</p><p>æ—¢ç„¶å¦‚æ­¤ï¼Œè·¯ç”±å™¨å¦‚ä½•çŸ¥é“å°†å“ªä¸ªåˆ†ç»„å‘ç»™å“ªä¸ªå…·ä½“çš„å†…éƒ¨ä¸»æœºå‘¢ï¼Ÿ</p><p>NATè·¯ç”±å™¨ä¸Šçš„ NATè½¬æ¢è¡¨ï¼Œè¡¨ä¸­è¿˜åŒ…å«äº†ç«¯å£å·åŠå…¶IPåœ°å€</p><p>NATè·¯ç”±å™¨æ¥æ”¶åˆ°å†…éƒ¨ä¸»æœºçš„æ•°æ®æŠ¥åï¼Œ<strong>æ›¿æ¢ç«¯å£å·ä¸IPåœ°å€</strong></p><h4 id="IPv6">IPv6</h4><p>åŸå› ï¼šæ–°çš„å­ç½‘åœ°å€å’ŒIPèŠ‚ç‚¹ä»¥æƒŠäººçš„é€Ÿåº¦å¢é•¿ï¼Œ32æ¯”ç‰¹çš„IPåœ°å€ç©ºé—´å³å°†è¢«è€—å°½ã€‚</p><ol><li><p>IPv6æ•°æ®æ ¼å¼æŠ¥</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210922175812677.png" alt="image-20210922175812677"></p><p>ç‰¹ç‚¹ï¼š</p><ul><li>æ‰©å¤§çš„åœ°å€å®¹é‡ï¼ˆ32bit â€”&gt; 128bitï¼‰ï¼Œå¼•å…¥ä»»æ’­åœ°å€ï¼ˆåœ°å€å¯ä»¥ä½¿å¾—æ•°æ®æŠ¥äº¤ä»˜ç»™ä¸€ç»„ä¸»æœºä¸­çš„ä»»ä½•ä¸€ä¸ªï¼‰</li><li>ç®€åŒ–é«˜æ•ˆçš„40å­—èŠ‚é¦–éƒ¨</li><li>æµæ ‡ç­¾ã€‚flowï¼Œç”¨äºç»™ç‰¹æ®Šæµçš„åˆ†ç»„åŠ ä¸Šæ ‡ç­¾ï¼ˆå‘é€æ–¹åšè¦æ±‚ï¼Œæ¯”å¦‚éé»˜è®¤æœåŠ¡è´¨é‡æˆ–éœ€è¦å®æ—¶æœåŠ¡çš„æµï¼ŒéŸ³è§†é¢‘æµï¼Œå¯ä»¥å¯¹ä¸€æ¡æµä¸­çš„æŸäº›æ•°æ®æŠ¥ç»™å‡ºæ›´é«˜çš„ä¼˜å…ˆæƒï¼‰</li><li>ç‰ˆæœ¬ï¼Œ4bitï¼Œè®¾ç½®ä¸º6ï¼ˆæ³¨æ„ï¼šæ­¤å­—æ®µ=4ä¸ä»£è¡¨å°±åˆ›å»ºIPv4æ•°æ®æŠ¥ï¼‰</li><li>æµé‡ç±»å‹ â‰ˆ IPv4çš„TOS</li><li>æœ‰æ•ˆè½½è·é•¿åº¦ 16bitï¼Œç»™å‡ºè·Ÿåœ¨å®šé•¿é¦–éƒ¨åçš„å­—èŠ‚æ•°é‡ï¼ˆå®é™…æ•°æ®æŠ¥ï¼‰</li><li>ä¸‹ä¸€ä¸ªé¦–éƒ¨ã€‚æ ‡è¯†æ•°æ®æŠ¥ä¸­çš„å†…å®¹éœ€è¦äº¤ä»˜ç»™å“ªä¸ªæ¯åè®®ï¼ˆTCP or UDPï¼‰ï¼Œä¸IPv4ç›¸åŒ</li><li>è·³é™åˆ¶ ï¼Œæ¯å°è·¯ç”±å™¨å¯¹è¯¥å­—æ®µå†…å®¹-1ï¼Œ==0æ—¶åˆ™ä¸¢å¼ƒ</li><li>æ•°æ®ã€‚</li></ul><p>IPv6ä¸­çš„æ›´æ”¹ç‚¹ï¼š</p><ul><li>åˆ†ç‰‡/é‡æ–°ç»„è£…ã€‚v6ä¸å…è®¸åœ¨ä¸­é—´è·¯ç”±å™¨ä¸Šè¿›è¡Œåˆ†ç‰‡å’Œé‡æ–°ç»„è£…ã€‚è¿™ç§æ“ä½œåªèƒ½åœ¨æºä¸ç›®çš„åœ°æ‰§è¡Œã€‚å¦‚æœè·¯ç”±å™¨æ”¶åˆ°çš„æ•°æ®æŠ¥å¤ªå¤§è€Œä¸èƒ½è½¬å‘åˆ°é“¾è·¯ä¸Šï¼Œåˆ™è·¯ç”±å™¨ä¼šä¸¢æ‰è¯¥æ•°æ®æŠ¥ï¼Œå¹¶å‘åˆ†ç»„å‘é€ä¸€ä¸ªâ€œåˆ†ç»„å¤ªå¤§â€çš„ICMPï¼ˆInternet Control Message Protocolï¼Œç½‘ç»œå±‚åè®®ï¼‰å·®é”™æŠ¥æ–‡ï¼Œè®©å‘é€æ–¹é‡æ–°å‘é€è¾ƒå°æ•°æ®çš„æŠ¥æ–‡ã€‚(ä¸ºä»€ä¹ˆå»é™¤ï¼Ÿåˆ†ç‰‡å’Œé‡ç»„æ˜¯ä¸€ä¸ªè€—æ—¶æ“ä½œï¼Œè¯¥åŠŸèƒ½ä»è·¯ç”±å™¨ä¸­åˆ é™¤ï¼Œå¹¶æ”¾åœ¨ç«¯ç³»ç»Ÿä¸­ï¼ŒåŠ å¿«ç½‘ç»œä¸­IPè½¬å‘é€Ÿåº¦)ã€‚</li><li>é¦–éƒ¨æ£€éªŒå’Œã€‚è¿è¾“å±‚å’Œæ•°æ®é“¾è·¯å±‚æ‰§è¡Œäº†æ£€éªŒæ“ä½œã€‚è®¾è®¡è€…å¯èƒ½è§‰å¾—æ²¡å¿…è¦ï¼Œv4ä¸­ï¼Œç”±äºé¦–éƒ¨ç”±TTLå­—æ®µï¼Œæ¯å°è·¯ç”±å™¨éƒ½éœ€è¦é‡æ–°è®¡ç®—é¦–éƒ¨æ£€éªŒå’Œã€‚æ¯å°è·¯ç”±å™¨ä¼šé‡æ–°è®¡ç®—é¦–éƒ¨æ£€éªŒå’Œï¼Œä¹Ÿæ˜¯è€—æ—¶æ“ä½œã€‚</li><li>é€‰é¡¹ã€‚æ²¡æœ‰å®Œå…¨æ¶ˆå¤±ï¼Œå¯èƒ½å‡ºç°åœ¨â€œä¸‹ä¸€ä¸ªé¦–éƒ¨â€æŒ‡å‡ºçš„ä½ç½®ä¸Šã€‚</li></ul></li><li><p>ä»IPv4åˆ°IPv6çš„è¿ç§»</p><p>IPv4 å¦‚ä½•è¿ç§»åˆ° v6ï¼Ÿè™½ç„¶v6èƒ½å‘åå…¼å®¹ï¼Œä½†v4ä¸èƒ½å¤Ÿå¤„ç†v6æ•°æ®æŠ¥ã€‚</p><p>å»ºéš§é“ï¼ˆtunnelingï¼‰ã€‚ä¸¤å°IPv6è·¯ç”±å™¨ä¹‹é—´ä¸­é—´çš„v4è·¯ç”±å™¨é›†åˆå«ä¸€ä¸ªéš§é“ã€‚å°†æ•´ä¸ªIPv6æ•°æ®æŠ¥æ”¾åˆ°ä¸€ä¸ªv4æ•°æ®æŠ¥çš„æ•°æ®å­—æ®µä¸­ã€‚v4æ•°æ®æŠ¥ä¸çŸ¥é“è‡ªå·±å«æœ‰ä¸€ä¸ªv6æ•°æ®æŠ¥ã€‚</p></li></ol><h3 id="é€šç”¨è½¬å‘å’ŒSDN">é€šç”¨è½¬å‘å’ŒSDN</h3><p>åŸå› ï¼šç¬¬äºŒå±‚äº¤æ¢æœºå’Œç¬¬ä¸‰å±‚è·¯ç”±å™¨ç­‰ä¸­é—´ç›’å‰§å¢ï¼Œéƒ½æœ‰ä¸åŒçš„ç¡¬ä»¶ã€è½¯ä»¶ï¼Œä¸ç»Ÿä¸€ã€‚SDNæ­£åœ¨æå‡ºä¸€ç§ç»Ÿä¸€ã€ç°ä»£ã€ç®€æ´çš„æ–¹æ³•ï¼Œæä¾›å¤šç§ç½‘ç»œå±‚åŠŸèƒ½å’ŒæŸäº›é“¾è·¯å±‚åŠŸèƒ½ã€‚</p><p>æµè¡¨   openFlow</p><h2 id="ç½‘ç»œå±‚ï¼šæ§åˆ¶å¹³é¢">ç½‘ç»œå±‚ï¼šæ§åˆ¶å¹³é¢</h2><p>æ§åˆ¶å¹³é¢ï¼Œæ§åˆ¶æ²¿ç€ä»æºä¸»æœºåˆ°ç›®çš„ä¸»æœºçš„çš„ç«¯åˆ°ç«¯è·¯åŠ²é—´çš„è·¯ç”±å™¨å¦‚ä½•è½¬å‘æ•°æ®æŠ¥ï¼Œå¹¶ä¸”æ§åˆ¶ç½‘ç»œå±‚ç»„ä»¶å’ŒæœåŠ¡å¦‚ä½•é…ç½®å’Œç®¡ç†ã€‚</p><p>é€šç”¨åœºæ™¯ä¸‹ï¼ŒåŠ¨ä½œåŒ…æ‹¬è½¬å‘åˆ†ç»„åˆ°è¾¾è·¯ç”±å™¨çš„æ¯ä¸ªè¾“å‡ºç«¯å£ï¼Œä¸¢å¼ƒåˆ†ç»„ï¼Œå¤åˆ¶åˆ†ç»„ï¼Œé‡å†™é¦–éƒ¨</p><p>æ–¹å¼ï¼š</p><ul><li>æ¯è·¯ç”±å™¨æ§åˆ¶</li><li>é€»è¾‘é›†ä¸­å¼æ§åˆ¶</li></ul><h3 id="è·¯ç”±é€‰æ‹©ç®—æ³•">è·¯ç”±é€‰æ‹©ç®—æ³•</h3><p>ç›®çš„ï¼šä»å‘é€æ–¹åˆ°æ¥æ”¶æ–¹çš„è¿‡ç¨‹ä¸­ç¡®å®šä¸€æ¡é€šè¿‡è·¯ç”±å™¨ç½‘ç»œçš„å¥½çš„è·¯å¾„</p><p>å›¾ï¼Œæ‰¾åˆ°æœ€çŸ­è·¯å¾„</p><p>åˆ†ç±»æ–¹æ³•ï¼š</p><ol><li><p>é›†ä¸­ã€åˆ†æ•£</p><ul><li><p>é›†ä¸­å¼è·¯ç”±é€‰æ‹©å®£å‘ã€‚ç”¨å®Œæ•´çš„ã€å…¨å±€æ€§çš„ç½‘ç»œçŸ¥è¯†è®¡ç®—å‡ºæºåˆ°ç›®çš„åœ°çš„æœ€ä½å¼€é”€è·¯å¾„ã€‚ï¼ˆè¦æ±‚ï¼šå…·æœ‰å…³äºè¿é€šæ€§å’Œé“¾è·¯å¼€é”€çš„å®Œæ•´ä¿¡æ¯ï¼‰ã€‚å…·æœ‰å…¨å±€çŠ¶æ€ä¿¡æ¯çš„ç®—æ³•è¢«ç§°ä¸ºé“¾è·¯çŠ¶æ€ï¼ˆLink Stateï¼ŒLSï¼‰ç®—æ³•ã€‚å¿…é¡»çŸ¥é“ç½‘ç»œä¸­æ¯æ¡é“¾è·¯çš„å¼€é”€</p></li><li><p>åˆ†æ•£å¼è·¯ç”±é€‰æ‹©ç®—æ³•ã€‚è·¯ç”±å™¨ä»¥è¿­ä»£ã€åˆ†å¸ƒå¼çš„æ–¹æ³•è®¡ç®—å‡ºæœ€ä½å¼€é”€è·¯å¾„ã€‚æ²¡æœ‰èŠ‚ç‚¹æ‹¥æœ‰å…³äºæ‰€æœ‰ç½‘ç»œé“¾è·¯å¼€é”€çš„å®Œæ•´ä¿¡æ¯ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä»…æœ‰ä¸å…¶ç›´æ¥é¡¹é“¾é“¾è·¯çš„å¼€é”€çŸ¥è¯†å³å¯å·¥ä½œã€‚è·ç¦»å‘é‡ï¼ˆDistance-Vector ï¼ŒDVï¼‰ç®—æ³•ï¼Œæ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤åˆ°ç½‘ç»œä¸­æ‰€æœ‰å…¶ä»–èŠ‚ç‚¹çš„å¼€é”€ä¼°è®¡çš„å‘é‡ã€‚</p></li></ul></li><li><p>é™æ€åŠ¨æ€</p><ul><li>é™æ€è·¯ç”±é€‰æ‹©ç®—æ³•ï¼Œè·¯ç”±éšæ—¶é—´å˜åŒ–æ…¢ã€‚</li><li>åŠ¨æ€è·¯ç”±é€‰æ‹©ç®—æ³•ï¼Œéšç€ç½‘ç»œæµé‡è´Ÿè½½æˆ–æ‹“æ‰‘å‘ç”Ÿå˜åŒ–è€Œæ”¹å˜è·¯ç”±é€‰æ‹©è·¯å¾„ã€‚</li></ul></li><li><p>è´Ÿè½½æ•æ„Ÿã€è¿Ÿé’</p><ul><li>è´Ÿè½½æ•æ„Ÿç®—æ³•ï¼Œé“¾è·¯å¼€é”€ä¼šåŠ¨æ€åœ°å˜åŒ–ä»¥ååº”å‡ºåº•å±‚é“¾è·¯å½“å‰æ‹¥å¡æ°´å¹³ã€‚å¦‚æœå½“å‰æ‹¥å¡çš„é“¾è·¯ä¸é«˜å¼€é”€ç›¸è”ç³»ï¼Œåˆ™ç®—æ³•è¶‹å‘äºç»•å¼€è¯¥æ‹¥å¡é“¾è·¯æ¥é€‰æ‹©è·¯ç”±ã€‚</li><li>è´Ÿè½½è¿Ÿé’ç®—æ³•ï¼ˆå½“ä»Šå› ç‰¹ç½‘è·¯ç”±é€‰æ‹©ç®—æ³•ï¼‰</li></ul></li></ol><h4 id="é“¾è·¯çŠ¶æ€è·¯ç”±é€‰æ‹©ç®—æ³•">é“¾è·¯çŠ¶æ€è·¯ç”±é€‰æ‹©ç®—æ³•</h4><p>Dijkstraç®—æ³•ã€‚</p><p>LSç®—æ³•ç»ˆæ­¢æ—¶ï¼Œå¯¹äºæ¯ä¸ªèŠ‚ç‚¹ï¼Œæˆ‘ä»¬éƒ½å¾—åˆ°ä»æºèŠ‚ç‚¹æ²¿ç€å®ƒçš„æœ€ä½å¼€é”€è·¯å¾„çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ã€‚</p><p>å¯¹äºnä¸ªèŠ‚ç‚¹ï¼Œæœ€åæƒ…å†µæ˜¯O(n<sup>2</sup>)</p><p>å¯¹äºå¦ä¸€ç§æƒ…å†µï¼Œé“¾è·¯ä¸¤ä¸ªæ–¹å‘æ‰¿è½½çš„è´Ÿè½½ä¸åŒæ—¶ï¼Œå‘ç”Ÿé“¾è·¯æŒ¯è¡</p><h4 id="è·ç¦»å‘é‡è·¯ç”±é€‰æ‹©ç®—æ³•">è·ç¦»å‘é‡è·¯ç”±é€‰æ‹©ç®—æ³•</h4><p>è¿­ä»£ã€å¼‚æ­¥ã€åˆ†å¸ƒå¼</p><p>Bellman-Fordæ–¹ç¨‹</p><p>æ¯ä¸ªèŠ‚ç‚¹xç»´æŠ¤ çš„è·¯ç”±é€‰æ‹©ä¿¡æ¯ï¼š</p><ul><li>å¯¹æ¯ä¸ªé‚»å±…vï¼Œä»xåˆ°ç›´æ¥ç›¸è¿é‚»å±…vçš„å¼€é”€c(x,v)</li><li>èŠ‚ç‚¹xçš„è·ç¦»å‘é‡ã€‚xåˆ°Nä¸­æ‰€æœ‰ç›®çš„åœ°yçš„å¼€é”€ä¼°è®¡å€¼ã€‚</li><li>xçš„<strong>æ¯ä¸ªé‚»å±…çš„è·ç¦»å‘é‡</strong></li></ul><p>åœ¨è¯¥ç®—æ³•ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸æ—¶åœ°å‘å®ƒçš„æ¯ä¸ªé‚»å±…å‘é€å®ƒçš„è·ç¦»å‘é‡å‰¯æœ¬ï¼Œå½“xä»å®ƒçš„ä»»ä½•ä¸€ä¸ªé‚»å±…wæ”¶åˆ°ä¸€ä¸ªæ–°çš„è·ç¦»å‘é‡æ—¶ï¼Œå®ƒä¿å­˜wçš„è·ç¦»å‘é‡ï¼Œä½¿ç”¨Bellman-Fordæ–¹ç¨‹æ›´æ–°è‡ªå·±çš„è·ç¦»å‘é‡ã€‚</p><p>å¦‚æœèŠ‚ç‚¹xçš„è·ç¦»å‘é‡å› ä¸ºè¿™ä¸ªæ­¥éª¤è€Œæ”¹å˜ï¼Œåˆ™èŠ‚ç‚¹xå°†å‘å®ƒçš„æ¯ä¸ªé‚»å±…å‘é€æ›´æ–°åçš„è·ç¦»å‘é‡ï¼Œç»§è€Œè®©é‚»å±…æ›´æ–°ä»–ä»¬è‡ªå·±çš„è·ç¦»å‘é‡ã€‚ï¼ˆå¦‚æœåœ¨ä¸€ä¸ªé‚»å±…æ›´æ–°è¿‡ç¨‹ä¸­æ”¶åˆ°äº†å¦ä¸€ä¸ªé‚»å±…çš„æ›´æ–°é€šçŸ¥è¯¥æ€ä¹ˆåŠï¼Ÿï¼‰</p><p>è¿™æ ·ä¸‹æ¥ï¼Œæ¯ä¸ªå¼€é”€ä¼°è®¡ä¼šæ”¶æ•›åˆ°ä»èŠ‚ç‚¹xåˆ°èŠ‚ç‚¹yå®é™…æœ€ä½çš„è·¯å¾„å¼€é”€</p><ol><li><p>è·ç¦»å‘é‡ç®—æ³•ï¼šé“¾è·¯å¼€é”€æ”¹å˜ä¸é“¾è·¯æ•…éšœ</p><p>äº§ç”ŸåŸå› ï¼šæ›´æ–°é€šçŸ¥çš„å»¶è¿Ÿé€ æˆ</p><p>è·¯ç”±é€‰æ‹©ç¯è·¯ï¼ˆP.253ï¼‰ã€‚å¢åŠ æœ€ä½å¼€é”€ ---- æ— ç©·è®¡æ•°é—®é¢˜</p></li><li><p>è·ç¦»å‘é‡ç®—æ³•ï¼šå¢åŠ æ¯’æ€§é€†è½¬</p><p>é¿å…è·¯ç”±é€‰æ‹©ç¯è·¯</p><p>å¦‚æœzé€šè¿‡yè·¯ç”±é€‰æ‹©åˆ°ç›®çš„åœ°xï¼Œåˆ™zç»™yè¯´ï¼Œå®ƒåˆ°xçš„è·ç¦»æ˜¯æ— ç©·å¤§ï¼Œè¿™æ ·yæ°¸è¿œä¸ä¼šè¯•å›¾ç»ç”±zè·¯ç”±é€‰æ‹©åˆ°x</p><p>æ¯’æ€§é€†è½¬æ— æ³•æ¥è§£å†³3ä¸ªæˆ–æ›´å¤šèŠ‚ç‚¹</p></li><li><p>LSã€DVæ¯”è¾ƒ</p><p>Nä¸ªèŠ‚ç‚¹ã€Eæ¡é“¾è·¯</p><ul><li><p>æŠ¥æ–‡å¤æ‚æ€§ã€‚LSè¦å‘é€Oï¼ˆN*Eï¼‰ä¸ªæŠ¥æ–‡ã€‚ä¸”ä¸€æ¡é“¾è·¯çš„å¼€é”€æ”¹å˜ï¼Œå¿…é¡»è¦å‘æ‰€æœ‰èŠ‚ç‚¹å‘é€æ–°çš„é“¾è·¯å¼€é”€ã€‚DVç®—æ³•ä»…åœ¨æ–°çš„é“¾è·¯å¼€é”€å¯¼è‡´ä¸è¯¥é“¾è·¯ç›¸è¿èŠ‚ç‚¹çš„æœ€ä½å¼€é”€è·¯å¾„å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰ä¼ æ’­å·²æ”¹å˜çš„é“¾è·¯å¼€é”€ã€‚</p></li><li><p>æ”¶æ•›é€Ÿåº¦ã€‚LS ï¼ŒOï¼ˆN<sup>2</sup>ï¼‰æ—¶é—´å¤æ‚åº¦ã€‚DVæ”¶æ•›è¾ƒæ…¢ï¼Œè¿˜å¯èƒ½é‡åˆ°è·¯ç”±é€‰æ‹©ç¯è·¯ã€æ— ç©·è®¡æ•°é—®é¢˜</p></li><li><p>å¥å£®æ€§ã€‚ï¼ˆä¸€å°è·¯ç”±å™¨æ¶æ„å‘é€é”™è¯¯çš„å‘é‡è¡¨ï¼‰ã€‚LSç®—æ³•ï¼Œè·¯ç”±è®¡ç®—åˆ†ç¦»ï¼Œæœ‰ä¸€å®šå¥å£®æ€§ã€‚DVç®—æ³•ä¸­ä¸€ä¸ªä¸æ­£ç¡®èŠ‚ç‚¹çš„è®¡ç®—å€¼ä¼šæ‰©æ•£åˆ°æ•´ä¸ªç½‘ç»œã€‚</p></li></ul></li></ol><h3 id="OSPF-å› ç‰¹ç½‘ä¸­è‡ªæ²»ç³»ç»Ÿå†…éƒ¨çš„è·¯ç”±é€‰æ‹©">OSPF: å› ç‰¹ç½‘ä¸­è‡ªæ²»ç³»ç»Ÿå†…éƒ¨çš„è·¯ç”±é€‰æ‹©</h3><p>ç”±äºè§„æ¨¡å’Œç®¡ç†è‡ªæ²»ï¼ˆISPæ„æ„¿ï¼‰è·¯ç”±é€‰æ‹©ç®—æ³•ä¸ç»Ÿä¸€ã€‚</p><p>é€šè¿‡å°†è·¯ç”±å™¨ç»„ç»‡è¿›è‡ªæ²»ç³»ç»Ÿï¼ˆAutonomous System ï¼ŒASï¼‰</p><p>æ¯ä¸ªASç”±ä¸€ç»„é€šå¸¸åœ¨ç›¸åŒç®¡ç†æ§åˆ¶ä¸‹çš„è·¯ç”±å™¨ç»„æˆã€‚é€šå¸¸ä¸€ä¸ªISPçš„è·¯ç”±å™¨ä»¥åŠäº’è”ä»–ä»¬çš„é“¾è·¯æ„æˆä¸€ä¸ªASï¼Œå½“ç„¶ISPä¹Ÿå¯ä»¥æœ‰å¤šä¸ªASã€‚ä¸€ä¸ªè‡ªæ²»ç³»ç»Ÿç”±å…¨å±€å”¯ä¸€çš„ASå·ï¼ˆASNï¼‰æ ‡è¯†ï¼Œç±»ä¼¼IPå·ã€‚</p><p>åœ¨ç›¸åŒASä¸­è·¯ç”±å™¨éƒ½è¿è¡Œç›¸åŒçš„è·¯ç”±é€‰æ‹©ç®—æ³•å¹¶ä¸”æœ‰å½¼æ­¤ä¿¡æ¯ã€‚åœ¨ä¸€ä¸ªè‡ªæ²»ç³»ç»Ÿå†…è¿è¡Œçš„è·¯ç”±é€‰æ‹©ç®—æ³•å« <strong>è‡ªæ²»ç³»ç»Ÿå†…éƒ¨è·¯ç”±é€‰æ‹©ç®—æ³•</strong></p><p><strong>å¼€å‘æœ€çŸ­è·¯ä¼˜å…ˆï¼ˆOSPFï¼‰</strong></p><p>Open Short Priority Firstï¼Œ æ˜¯ä¸€ç§é“¾è·¯çŠ¶æ€ï¼ˆLSï¼‰åè®®ï¼Œä½¿ç”¨æ´ªæ³›é“¾è·¯çŠ¶æ€ä¿¡æ¯å’ŒDijkstraæœ€ä½å¼€é”€è·¯å¾„ç®—æ³•ï¼Œä½¿ç”¨OSPFï¼Œä¸€å°è·¯ç”±å™¨èƒ½å¤Ÿæ„å»ºä¸€å‰¯å…³äºæ•´ä¸ªè‡ªæ²»ç³»ç»Ÿçš„å®Œæˆæ‹“æ‰‘å›¾ã€‚</p><p>ä½¿ç”¨OSPFï¼Œè·¯ç”±å™¨å‘è‡ªæ²»ç³»ç»Ÿå†…çš„æ‰€æœ‰å…¶ä»–è·¯ç”±å™¨å¹¿æ’­è·¯ç”±é€‰æ‹©ä¿¡æ¯ï¼ˆè€Œä¸ä»…ä»…æ˜¯ç›¸é‚»çš„è·¯ç”±å™¨å¹¿æ’­ï¼‰ï¼Œå³ä½¿é“¾è·¯çŠ¶æ€æœªå‘ç”Ÿæ”¹å˜ï¼Œä¹Ÿè¦å‘¨æœŸæ€§çš„å¹¿æ’­é“¾è·¯çŠ¶æ€ï¼ˆå¢å¼ºLSç®—æ³•å¥å£®æ€§ï¼‰ã€‚OSPFæŠ¥æ–‡ç”±IPç›´æ¥æ‰¿è½½ï¼Œå¯¹OSPFçš„ä¸Šå±‚åè®®å€¼ä¸º89</p><p>ä¼˜ç‚¹ï¼š</p><ul><li>å®‰å…¨ã€‚é‰´åˆ«OSPFè·¯ç”±å™¨ä¹‹é—´çš„ä¿¡æ¯äº¤æ¢ã€‚OSPFæŠ¥æ–‡å¯é…ç½®ä¸ºMD5ï¼ˆé»˜è®¤æ˜¯ç®€å•ï¼Œæœªè¢«é‰´åˆ«å¹¶ä¸”å¯ä»¥è¢«ä¼ªé€ ï¼‰</li><li>å¤šæ¡ç›¸åŒå¼€é”€çš„è·¯å¾„ã€‚å­˜åœ¨å¤šæ¡ç›¸ç­‰å¼€é”€è·¯å¾„æ—¶ï¼Œæ— éœ€ä»…é€‰æ‹©å•ä¸€çš„è·¯å¾„æ¥æ‰¿è½½æ‰€æœ‰çš„æµé‡ã€‚</li><li>å¯¹å•æ’­å’Œå¤šæ’­è·¯ç”±é€‰æ‹©çš„ç»¼åˆæ”¯æŒã€‚</li><li>æ”¯æŒåœ¨å•ä¸ªASä¸­çš„å±‚æ¬¡ç»“æ„ï¼Œä¸€ä¸ªOSPF ASèƒ½å¤Ÿå±‚æ¬¡åŒ–é…ç½®å¤šä¸ªåŒºåŸŸï¼Œæ¯ä¸ªåŒºåŸŸéƒ½è¿è¡Œè‡ªå·±çš„OSPFé“¾è·¯çŠ¶æ€è·¯ç”±å™¨é€‰æ‹©ç®—æ³•ï¼ŒåŒºåŸŸå†…çš„æ¯å°è·¯ç”±å™¨éƒ½å‘<strong>è¯¥åŒºåŸŸ</strong>å†…çš„æ°”æ°”ä»–æ‰€æœ‰è·¯ç”±å™¨å¹¿æ’­é“¾è·¯çŠ¶æ€ã€‚æ¯ä¸ªåŒºåŸŸå†…ï¼Œä¸€å°æˆ–å¤šå°åŒºåŸŸè¾¹ç•Œè·¯ç”±å™¨è´Ÿè´£ä¸º<strong>æµå‘è¯¥åŒºåŸŸä»¥å¤–çš„åˆ†ç»„</strong>æä¾›è·¯ç”±é€‰æ‹©ã€‚ASä¸­åªæœ‰ä¸€ä¸ªOSPFåŒºåŸŸé…ç½®ä¸ºä¸»å¹²åŒºåŸŸï¼Œä¸»å¹²åŒºåŸŸçš„ä¸»è¦ä½œç”¨<strong>æ˜¯ä¸ºå…¶ä»–åŒºåŸŸä¹‹é—´çš„æµé‡æä¾›è·¯ç”±é€‰æ‹©</strong>ã€‚ä¸»å¹²æ€»æ˜¯åŒ…å«æœ¬ASä¸­çš„æ‰€æœ‰åŒºåŸŸè¾¹ç•Œè·¯ç”±å™¨ã€‚ASä¸­çš„åŒºåŸŸé—´è·¯ç”±é€‰æ‹©è¦æ±‚åˆ†ç»„å…ˆè·¯ç”±åˆ°ä¸€ä¸ªåŒºåŸŸè¾¹ç•Œè·¯ç”±å™¨ï¼ˆåŒºåŸŸå†…è·¯ç”±é€‰æ‹©ï¼‰ï¼Œå†é€šè¿‡ä¸»å¹²è·¯ç”±åˆ°ä½ç›®çš„åŒºåŸŸçš„åŒºåŸŸè¾¹ç•Œè·¯ç”±å™¨ï¼Œå†è·¯ç”±åˆ°æœ€ç»ˆç›®çš„åœ°ã€‚</li></ul><p>è®¾ç½®OSPFé“¾è·¯æƒé‡ï¼Œä¸å¤ªæ‡‚</p><h3 id="ISPä¹‹é—´çš„è·¯ç”±é€‰æ‹©ï¼šBGP">ISPä¹‹é—´çš„è·¯ç”±é€‰æ‹©ï¼šBGP</h3><p>å½“åˆ†ç»„è·¨è¶Šå¤šä¸ªASè¿›è¡Œè·¯ç”±æ—¶ï¼Œéœ€è¦<strong>è‡ªæ²»ç³»ç»Ÿé—´è·¯ç”±é€‰æ‹©åè®®</strong></p><p>ASé—´è·¯ç”±é€‰æ‹©åè®®è®¾è®¡å¤šä¸ªASä¹‹é—´çš„åè°ƒï¼Œæ‰€ä»¥ASé€šä¿¡å¿…é¡»è¿è¡Œç›¸åŒçš„ASé—´è·¯ç”±é€‰æ‹©åè®®ã€‚æ‰€ä»¥ï¼Œå› ç‰¹ç½‘ä¸­è¿è¡Œç›¸åŒçš„ASé—´è·¯ç”±é€‰æ‹©åè®®ï¼Œ<strong>è¾¹ç•Œç½‘å…³åè®®</strong>ï¼ˆBroder Gateway Protocolï¼ŒBGPï¼‰ã€è¿™ä¸ªåè®®å°†æ•°åƒçš„ISPç²˜åˆèµ·æ¥ã€‘</p><p>BGPä¸­ï¼Œåˆ†ç»„ä¸æ˜¯è·¯ç”±åˆ°ç‰¹å®šçš„ç›®çš„åœ°å€ï¼Œè€Œæ˜¯è·¯ç”±åˆ°CIDRåŒ–çš„å‰ç¼€(132.13.12/22)ã€‚</p><p>BGPä¸ºæ¯å°è·¯ç”±å™¨æä¾›äº†å®Œæˆä»¥ä¸‹ä»»åŠ¡çš„æ‰‹æ®µï¼š</p><ul><li>ä»ä»¤å±…ASè·å¾—å‰ç¼€çš„å¯è¾¾æ€§ä¿¡æ¯ã€‚å…è®¸æ¯ä¸ªå­ç½‘å‘å› ç‰¹ç½‘çš„åŒºåŸŸéƒ¨åˆ†é€šå‘Šå®ƒçš„å­˜åœ¨ï¼Œç¡®ä¿åœ¨å› ç‰¹ç½‘ä¸­çš„æ‰€æœ‰ASçŸ¥é“è¯¥å­ç½‘ã€‚å¦‚æœæ²¡æœ‰BGPï¼Œåˆ™æ¯ä¸ªå­ç½‘æ˜¯å­¤ç«‹çš„ã€‚</li><li>ç¡®å®šåˆ°è¯¥å‰ç¼€çš„æœ€å¥½çš„è·¯ç”±ã€‚</li></ul><h4 id="é€šå‘ŠBGPè·¯ç”±ä¿¡æ¯">é€šå‘ŠBGPè·¯ç”±ä¿¡æ¯</h4><p>å¯¹äºæ¯ä¸ªASï¼Œè·¯ç”±å™¨è¦ä¹ˆæ˜¯ç½‘å…³è·¯ç”±å™¨ï¼ˆä½äºASè¾¹ç¼˜ï¼Œç›´æ¥è¿æ¥åˆ°å…¶ä»–ASä¸­çš„ä¸€å°æˆ–è€…å¤šå°è·¯ç”±å™¨ï¼‰ï¼Œè¦ä¹ˆæ˜¯å†…éƒ¨è·¯ç”±å™¨ï¼ˆä»…è¿æ¥åœ¨ä»–è‡ªå·±ASä¸­çš„ä¸»æœºå’Œè·¯ç”±å™¨ï¼‰ã€‚</p><p>BGPä¸­ï¼Œæ¯å¯¹è·¯ç”±å™¨ç”¨179ç«¯å£<strong>åŠæ°¸ä¹…TCP</strong>è¿æ¥äº¤æ¢è·¯ç”±é€‰æ‹©ä¿¡æ¯ã€‚æ¯æ¡ç›´æ¥è¿æ¥ä»¥åŠæ‰€æœ‰é€šè¿‡è¯¥è¿æ¥å‘é€çš„BGPæŠ¥æ–‡ï¼Œç§°ä¸º<strong>BGPè¿æ¥</strong>ã€‚è·¨è¶Šä¸¤ä¸ªASçš„BGPè¿æ¥ç§°ä¸º<strong>å¤–éƒ¨BGPè¿æ¥</strong>ï¼ˆeBGPï¼‰ï¼Œç›¸åŒASä¸­çš„ä¸¤å°è·¯ç”±å™¨ä¹‹é—´çš„BGPä¼šè¯ç§°ä¸º<strong>å†…éƒ¨BGP</strong>è¿æ¥ï¼ˆiBGPï¼‰</p><h4 id="ç¡®å®šæœ€å¥½çš„è·¯ç”±">ç¡®å®šæœ€å¥½çš„è·¯ç”±</h4><p>è·¯ç”±å™¨é€šè¿‡BGPè¿æ¥é€šå‘Šå‰ç¼€æ—¶ï¼Œ<strong>å‰ç¼€ä¸­åŒ…æ‹¬æŸäº›BGPå±æ€§</strong>ï¼ˆ<strong>è·¯ç”±</strong>ï¼‰ã€‚åŒ…å«AS-PATHå’ŒNEXT-HOP</p><p>AS-PATHåŒ…å«é€šå‘Šå·²ç»é€šè¿‡ASçš„åˆ—è¡¨ï¼ŒæŸä¸€ä¸ªå‰ç¼€é€šè¿‡ASæ—¶ï¼ŒASå°†å…¶ASNåŠ å…¥åˆ°ç°æœ‰åˆ—è¡¨ã€‚è¿˜å¯ä»¥æ£€æµ‹å’Œé˜²æ­¢é€šå‘Šç¯è·¯ï¼Œå¦‚æœä¸€å°è·¯ç”±å™¨åœ¨è·¯åŠ²åˆ—è¡¨ä¸­çœ‹åˆ°åŒ…å«äº†å®ƒè‡ªå·±çš„ASï¼Œå®ƒå°†æ‹’ç»è¯¥é€šå‘Šã€‚</p><p>NEXT-HOPï¼Œ æ˜¯èµ·å§‹çš„AS-PATHèµ·å§‹çš„è·¯ç”±å™¨æ¥å£çš„IPåœ°å€ï¼ˆå¯èƒ½è¦çœ‹ä¹¦ï¼ŒP259ï¼‰</p><p>æ¯æ¡BGPè·¯ç”±åŒ…å«ä¸‰ä¸ªç»„ä»¶ï¼šNEXT-HOP AS-PATH ç›®çš„å‰ç¼€â€¦</p><ol><li><p>çƒ­åœŸè±†è·¯ç”±é€‰æ‹©</p><p>çƒ­åœŸè±†ï¼Œçƒ«æ‰‹ï¼Œèµ¶å¿«æŠŠå®ƒç»™åˆ«äººã€‚è‡ªç§çš„ç®—æ³•ï¼Œä¸ç®¡å…¶ä»–äººåˆ°å…¶ä»–äººé—´çš„</p><p>é€‰æ‹©å…·æœ‰æœ€å°æœ€ä½å¼€é”€çš„ç½‘å…³</p></li><li><p>è·¯ç”±å™¨é€‰æ‹©ç®—æ³•</p><p>BGPä½¿ç”¨ã€‚å¦‚æœåˆ°ç›¸åŒçš„å‰ç¼€æœ‰ä¸¤æ¡æˆ–è€…å¤šæ¡è·¯ç”±ï¼Œåˆ™é¡ºåºè°ƒç”¨ä¸‹åˆ—æ¶ˆé™¤è§„åˆ™ï¼š</p><ol><li>è·¯ç”±è¢«æŒ‡æ´¾ä¸€ä¸ªæœ¬åœ°åå¥½å€¼ä½œä¸ºå±æ€§ä¹‹ä¸€ã€‚è¯¥å€¼å¯èƒ½ç”±è·¯ç”±å™¨è®¾ç½®æˆ–åœ¨ç›¸åŒASä¸­çš„å¦ä¸€å°è·¯ç”±å™¨å­¦ä¹ åˆ°ã€‚å®Œå…¨å–å†³äºASç½‘ç»œç®¡ç†å‘˜ï¼Œå…·æœ‰æœ€é«˜æœ¬åœ°åå¥½å€¼çš„è·¯ç”±å°†è¢«é€‰æ‹©ï¼›</li><li>ä»ä½™ä¸‹çš„è·¯ç”±ä¸­ï¼ˆå…·æœ‰ç›¸åŒæœ€é«˜æœ¬åœ°åå¥½å€¼ï¼‰é€‰æ‹©æœ€çŸ­AS-PATHçš„è·¯ç”±</li><li>ä»ä½™ä¸‹çš„è·¯ç”±ä¸­ï¼Œä½¿ç”¨çƒ­åœŸè±†è·¯ç”±é€‰æ‹©ï¼Œé€‰æ‹©å…·æœ‰æœ€é è¿‘NEXT-HOPè·¯ç”±å™¨çš„è·¯ç”±</li><li>å¦‚æœä»ç•™ä¸‹å¤šæ¡ï¼Œåˆ™ä½¿ç”¨BGPæ ‡è¯†é€‰æ‹©è·¯ç”±ã€‚</li></ol><p>éè‡ªç§ç®—æ³•ï¼Œå…ˆæŸ¥æ‰¾å…·æœ‰çŸ­ASè·¯å¾„çš„è·¯ç”±ï¼Œå› è€Œå¯èƒ½å‡å°ç«¯åˆ°ç«¯çš„æ—¶å»¶</p></li></ol><p><strong>IPä»»æ’­</strong></p><p>BGPé™¤äº†è¢«ç”¨åšASé—´è·¯ç”±é€‰æ‹©åè®®ï¼Œè¿˜ç”¨äºå®ç°IPä»»æ’­æœåŠ¡ã€‚</p><p>å½“ä¸€ä¸ªç”¨æˆ·è¦è®¿é—®å¤åˆ¶å†…å®¹æ—¶ï¼Œå°†ç”¨æˆ·æŒ‡å‘å…·æœ‰è¯¥å¤åˆ¶å†…å®¹çš„æœ€è¿‘çš„æœåŠ¡å™¨ã€‚</p><p>CDNå…¬å¸ä¸ºå¤šå°æœåŠ¡å™¨æŒ‡æ´¾ç›¸åŒçš„IPåœ°å€ï¼Œä½¿ç”¨æ ‡å‡†çš„BGPä»è¿™äº›æœåŠ¡å™¨çš„æ¯å°æ¥é€šå‘Šè¯¥IPåœ°å€ã€‚å½“æŸå°BGPè·¯ç”±å™¨æ”¶åˆ°è¯¥IPåœ°å€çš„å¤šä¸ªè·¯ç”±é€šå‘Šï¼Œå°†é€šå‘Šå¤„ç†ä¸ºå¯¹ç›¸åŒçš„ç‰©ç†ä½ç½®æä¾›ä¸åŒçš„è·¯å¾„ã€‚å½“é…ç½®è·¯ç”±é€‰æ‹©è¡¨æ—¶ï¼Œæ¯å°è·¯ç”±å™¨å°†æœ¬åœ°åŒ–ä½¿ç”¨BGPè·¯ç”±é€‰æ‹©ç®—æ³•æ¥æŒ‘é€‰åˆ°è¯¥IPåœ°å€çš„æœ€å¥½çš„ï¼ˆä¾‹å¦‚ï¼ŒASè·³è®¡æ•°æœ€å°‘çš„ï¼‰è·¯ç”±ã€‚å®¢æˆ·è¯·æ±‚è§†é¢‘æ—¶ï¼ŒCDNå‘å®¢æˆ·è¿”å›ç”±åœ°ç†ä¸Šåˆ†æ•£çš„æœåŠ¡å™¨ä½¿ç”¨çš„å…±åŒIPåœ°å€ï¼Œå½“å®¢æˆ·å‘IPåœ°å€å‘é€è¯·æ±‚æ—¶ï¼Œåˆ™å› ç‰¹ç½‘è·¯ç”±å™¨å‘æœ€è¿‘çš„æœåŠ¡å™¨è½¬å‘è¯¥åˆ†ç»„ã€‚</p><p>å®é™…ä¸­CDNé€šå¸¸é€‰æ‹©ä¸é€‚ç”¨IPä»»æ’­ã€‚å› ä¸ºBGPè·¯ç”±é€‰æ‹©å˜åŒ–èƒ½å¤Ÿå¯¼è‡´ç›¸åŒçš„TCPè¿æ¥çš„ä¸åŒåˆ†ç»„åˆ°è¾¾WebæœåŠ¡å™¨çš„ä¸åŒå®åŠ›ã€‚</p><p>IPä»»æ’­è¢«DNSç³»ç»Ÿå¹¿æ³›ç”¨äºå°†DNSè¯·æ±‚æŒ‡å‘æœ€è¿‘çš„æ ¹DNSæœåŠ¡å™¨</p><p><strong>è·¯ç”±é€‰æ‹©ç­–ç•¥</strong></p><p>P263ï¼Œæ¥å…¥ISPä¸ºä»€ä¹ˆä¸ä¼šè½¬å‘ä¸»å¹²æä¾›å•†ç½‘ç»œçš„æµé‡ï¼Ÿ</p><h3 id="SDNæ§åˆ¶å¹³é¢">SDNæ§åˆ¶å¹³é¢</h3><p>SDNä½“ç³»ç»“æ„çš„4ä¸ªå…³é”®ç‰¹å¾ï¼š</p><ol><li>åŸºäºæµçš„è½¬å‘ã€‚SDNæ§åˆ¶çš„äº¤æ¢æœºèƒ½å¤ŸåŸºäºè¿è¾“å±‚ã€ç½‘ç»œå±‚ã€é“¾è·¯å±‚é¦–éƒ¨ä¸­ä»»æ„æ•°é‡çš„é¦–éƒ¨å­—æ®µå€¼è¿›è¡Œã€‚</li><li>æ•°æ®å¹³é¢ä¸æ§åˆ¶å¹³é¢åˆ†ç¦»ã€‚æ•°æ®å¹³é¢æ˜¯ç½‘ç»œäº¤æ¢æœºï¼Œåœ¨æµè¡¨ä¸­æ‰§è¡ŒåŒ¹é…åŠ åŠ¨ä½œçš„è§„åˆ™ã€‚æ§åˆ¶å¹³é¢ç”±æœåŠ¡å™¨ä»¥åŠå†³å®šå’Œç®¡ç†äº¤æ¢æœºæµè¡¨çš„è½¯ä»¶ç»„æˆ</li><li>ç½‘ç»œæ§åˆ¶åŠŸèƒ½ã€‚</li><li>å¯ç¼–ç¨‹ç½‘ç»œ</li></ol><p><strong>SDNæ§åˆ¶å¹³é¢ï¼šSDNæ§åˆ¶å™¨å’ŒSDNç½‘ç»œæ§åˆ¶åº”ç”¨</strong></p><p>SDNæ§åˆ¶å™¨ç»“æ„</p><ul><li>é€šä¿¡å±‚ï¼šSDNæ§åˆ¶å™¨å’Œå—æ§ç½‘ç»œè®¾å¤‡ä¹‹é—´çš„é€šä¿¡ã€‚SDNæ§åˆ¶å™¨æ§åˆ¶è¿œç¨‹SDNä½¿äº¤æ¢æœºã€ä¸»æœºè¿è¡Œï¼Œåˆ™éœ€è¦ä¸€ä¸ªåè®®ä¼ é€è¿™äº›è®¾å¤‡ä¹‹é—´çš„ä¿¡æ¯ã€‚å¹¶ä¸”è®¾å¤‡ä¹Ÿè¦èƒ½å¤Ÿå‘æ§åˆ¶å™¨ä¼ è¾“æœ¬åœ°è§‚å¯Ÿåˆ°çš„æ—¶é—´ã€‚</li><li>ç½‘ç»œèŒƒå›´çŠ¶æ€ç®¡ç†å±‚ã€‚ç”±SDNæ§åˆ¶å¹³é¢æ‰€åšå‡ºçš„æœ€ç»ˆæ§åˆ¶å†³å®šï¼Œå°†è¦æ±‚æ§åˆ¶å™¨å…·æœ‰æœ‰å…³ç½‘ç»œçš„ä¸»æœºã€é“¾è·¯ã€äº¤æ¢æœºä»¥åŠå…¶ä»–SDNæ§åˆ¶è®¾å¤‡çš„æœ€æ–°çŠ¶æ€ä¿¡æ¯ã€‚</li><li>å¯¹äºç½‘ç»œæ§åˆ¶åº”ç”¨ç¨‹åºå±‚çš„æ¥å£ã€‚æ§åˆ¶å™¨é€šè¿‡åŒ—å‘æ¥å£ä¸ç½‘ç»œæ§åˆ¶åº”ç”¨ç¨‹åºäº¤äº’</li></ul><p><strong>OpenFlowåè®®</strong></p><p>è¿è¡Œåœ¨SDNæ§åˆ¶å™¨å’ŒSDNæ§åˆ¶çš„äº¤äº’åŠä¹‹é—´ã€‚åè®®è¿è¡Œåœ¨TCPä¹‹ä¸Šï¼Œé»˜è®¤ç«¯å£å·ï¼š6653</p><h3 id="ICMPï¼šå› ç‰¹ç½‘æ§åˆ¶æŠ¥æ–‡åè®®">ICMPï¼šå› ç‰¹ç½‘æ§åˆ¶æŠ¥æ–‡åè®®</h3><p>ç›®çš„ï¼šä¸»æœºå’Œè·¯ç”±å™¨ç”¨æ¥å½¼æ­¤æ²Ÿé€šç½‘ç»œå±‚çš„ä¿¡æ¯ã€‚å·®é”™æŠ¥å‘Š</p><p>åœ¨æŸä¸ªä½ç½®ï¼ŒIPè·¯ç”±å™¨ä¸èƒ½æ‰¾åˆ°ä¸€æ¡é€šå¾€HTTPè¯·æ±‚ä¸­æ‰€åˆ¶å®šçš„ä¸»æœºçš„è·¯å¾„ï¼Œè·¯ç”±å™¨å°±ä¼šå‘ä½ çš„ä¸»æœºç”Ÿæˆå¹¶å‘é€ä¸€ä¸ªICMPæŠ¥æ–‡ä»¥æŒ‡ç¤ºè¯¥é”™è¯¯</p><p>ICMPä½œä¸ºIPæœ‰æ•ˆè½½è·æ‰¿è½½çš„ï¼Œä½äºIPä¹‹ä¸Šã€‚</p><p>ç±»å‹å­—æ®µ+ç¼–ç å­—æ®µï¼Œå¹¶ä¸”åŒ…å«å¼•èµ·è¯¥ICMPæŠ¥æ–‡é¦–æ¬¡ç”Ÿæˆçš„IPæ•°æ®æŠ¥é¦–éƒ¨å’Œå‰8ä¸ªå­—èŠ‚ï¼ˆä»¥ä¾¿å‘é€æ”¾èƒ½ç¡®å®šå¼•å‘è¯¥å·®é”™çš„æ•°æ®æŠ¥ï¼‰</p><p>ä¾‹å¦‚ï¼š</p><ul><li>pingç¨‹åºå‘é€ä¸€ä¸ªICMPç±»å‹8ç¼–ç 0çš„æŠ¥æ–‡åˆ°æŒ‡å®šä¸»æœºï¼Œçœ‹åˆ°å›æ˜¾è¯·æ±‚åï¼Œç›®çš„ä¸»æœºå‘å›ä¸€ä¸ªç±»å‹0ç¼–ç 0çš„ICMPå›æ˜¾å›ç­”ã€‚</li><li>æºæŠ‘åˆ¶æŠ¥æ–‡ã€‚æ‰§è¡Œæ‹¥å¡æ§åˆ¶ï¼Œä½¿å¾—æ‹¥å¡çš„è·¯ç”±å™¨å‘ä¸€å°ä¸»æœºå‘é€ä¸€ä¸ªICMPæºæŠ‘åˆ¶æŠ¥æ–‡ï¼Œä»¥å¼ºåˆ¶è¯¥ä¸»æœºå‡å°å…¶å‘é€é€Ÿç‡ã€‚</li></ul><h3 id="ç½‘ç»œç®¡ç†å’ŒSNMP">ç½‘ç»œç®¡ç†å’ŒSNMP</h3><h4 id="ç½‘ç»œç®¡ç†æ¡†æ¶">ç½‘ç»œç®¡ç†æ¡†æ¶</h4><p>ç½‘ç»œç®¡ç†å…³é”®ç»„ä»¶ï¼š</p><ul><li><p>ç®¡ç†æœåŠ¡å™¨ã€‚ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œè¿è¡Œåœ¨ç½‘ç»œè¿è¥ä¸­å¿ƒï¼ˆNOCï¼‰çš„é›†ä¸­å¼ç½‘ç»œç®¡ç†å·¥ä½œç«™ä¸Šã€‚æ§åˆ¶ç½‘ç»œç®¡ç†ä¿¡æ¯çš„æ”¶é›†ã€å¤„ç†ã€åˆ†æã€‚</p></li><li><p>è¢«ç®¡è®¾å¤‡ã€‚ä½äºè¢«ç®¡ç†ç½‘ç»œä¸­ï¼Œå¯ä»¥æ˜¯ä¸€å°ä¸»æœºã€è·¯ç”±å™¨ã€äº¤æ¢æœºã€ä¸­é—´ç›’â€¦åœ¨ä¸€ä¸ªè¢«ç®¡è®¾å¤‡ä¸­ï¼Œæœ‰å‡ ä¸ªæ‰€è°“è¢«ç®¡å¯¹è±¡ã€‚è¿™äº›è¢«ç®¡å¯¹è±¡æ˜¯è¢«ç®¡è®¾å¤‡ä¸­ç¡¬ä»¶çš„åå‡ éƒ¨åˆ†å’Œç”¨äºè¿™äº›ç¡¬ä»¶å’Œè½¯ä»¶ç»„ä»¶çš„é…ç½®å‚æ•°ã€‚</p></li><li><p>ä¸€ä¸ªè¢«ç®¡è®¾å¤‡ä¸­çš„æ¯ä¸ªè¢«ç®¡å¯¹è±¡çš„å…³è”ä¿¡æ¯æ”¶é›†åœ¨ ç®¡ç†ä¿¡æ¯åº“ï¼ˆMIBï¼‰ã€‚ä¸€ä¸ªMIBå¯¹è±¡å¯ä»¥æ˜¯ï¼š</p><ul><li>ä¸€ä¸ªè®¡æ•°å™¨</li><li>è¿è¡Œåœ¨ä¸€å°DNSæœåŠ¡å™¨ä¸Šçš„è½¯ä»¶ç‰ˆæœ¬çš„æè¿°æ€§ä¿¡æ¯</li><li>ä¸€ä¸ªç‰¹å®šè®¾å¤‡åŠŸèƒ½æ˜¯å¦æ­£ç¡®çš„çŠ¶æ€ä¿¡æ¯</li><li>åˆ°ä¸€ä¸ªç›®çš„åœ°çš„è·¯ç”±é€‰æ‹©è·¯å¾„çš„ç‰¹å®šåè®®çš„ä¿¡æ¯</li></ul><p>ç›¸å…³çš„MIBå¯¹è±¡æ”¶é›†åœ¨MIBæ¨¡å—ä¸­</p></li><li><p>æ¯ä¸ªè¢«ç®¡è®¾å¤‡ä¸­é©»ç•™æœ‰ ç½‘ç»œç®¡ç†ä»£ç†ï¼Œè¿è¡Œåœ¨è¢«ç®¡è®¾å¤‡ä¸­çš„ä¸€ä¸ªè¿›ç¨‹ï¼Œä¸ç®¡ç†æœåŠ¡å™¨é€šä¿¡ï¼Œåœ¨ç®¡ç†æœåŠ¡å™¨çš„å‘½ä»¤å’Œæ§åˆ¶ä¸‹åœ¨è¢«ç®¡è®¾å¤‡ä¸­é‡‡å–æœ¬åœ°åŠ¨ä½œ</p></li><li><p>ç½‘ç»œç®¡ç†åè®®ï¼Œè¿è¡Œåœ¨è¢«ç®¡è®¾å¤‡å’Œç®¡ç†æœåŠ¡å™¨ä¹‹é—´ï¼Œå…è®¸ç®¡ç†æœåŠ¡å™¨æŸ¥è¯¢è¢«ç®¡è®¾å¤‡çš„çŠ¶æ€ï¼Œç»è¿‡ä»£ç†é—´æ¥åœ°çš„åœ¨è¿™äº›è®¾å¤‡ä¸Šé‡‡å–è¡ŒåŠ¨ã€‚ä»£ç†èƒ½å¤Ÿä½¿ç”¨ç½‘ç»œç®¡ç†åè®®å‘ç®¡ç†æœåŠ¡å™¨é€šçŸ¥å¼‚å¸¸äº‹ä»¶ã€‚</p></li></ul><h4 id="ç®€å•ç½‘ç»œç®¡ç†åè®®">ç®€å•ç½‘ç»œç®¡ç†åè®®</h4><p>ç®€å•ç½‘ç»œç®¡ç†åè®® v2 ï¼š SNMPv2æ˜¯ä¸€ä¸ªåº”ç”¨å±‚åè®®ã€‚ç”¨äºåœ¨ç®¡ç†æœåŠ¡å™¨å’Œä»£è¡¨ç®¡ç†æœåŠ¡å™¨æ‰§è¡Œçš„ä»£ç†ä¹‹é—´ä¼ é€’ç½‘ç»œç®¡ç†æ§åˆ¶å’Œä¿¡æ¯æŠ¥æ–‡ã€‚æœ€å¸¸ä½¿ç”¨ï¼š<strong>è¯·æ±‚å“åº”æ¨¡å¼</strong>ã€‚ä¹Ÿè¢«ç”¨æ¥ä»£ç†å‘ç®¡ç†æœåŠ¡å™¨å‘é€éè¯·æ±‚æŠ¥æ–‡ï¼ˆé™·é˜±æŠ¥æ–‡ï¼Œé€šçŸ¥ç®¡ç†æœåŠ¡å™¨ï¼Œä¸€ä¸ªå¼‚å¸¸æƒ…å†µå·²å¯¼è‡´MIBå¯¹è±¡å€¼çš„æ”¹å˜ï¼‰</p><p>å®šä¹‰äº†7ä¸­ç±»å‹çš„æŠ¥æ–‡ï¼Œç§°ä¸º åè®®æ•°æ®å•å…ƒï¼ˆPDUï¼‰</p><p>SNMP PDUç»å¸¸æ˜¯ä½œä¸ºUDPæ•°æ®æŠ¥çš„è½½è·ä¼ è¾“çš„ï¼Œé˜²æ­¢UDPæ•°æ®ä¸¢å¤±ï¼Œç®¡ç†æœåŠ¡åŒºçˆ±ç”¨è¯¥PDUçš„è¯·æ±‚IDå­—æ®µä¸ºå®ƒå‘ä»£ç†å‘é€çš„è¯·æ±‚ç¼–å·ã€‚</p><h2 id="é“¾è·¯å±‚å’Œå±€åŸŸç½‘">é“¾è·¯å±‚å’Œå±€åŸŸç½‘</h2><h3 id="æ¦‚è¿°-v8">æ¦‚è¿°</h3><p>èŠ‚ç‚¹ï¼šè¿è¡Œé“¾è·¯å±‚åè®®çš„ä»»ä½•è®¾å¤‡ï¼ˆä¸»æœºã€è·¯ç”±å™¨ã€äº¤æ¢æœºã€WiFiæ¥å…¥ç‚¹ï¼‰</p><p>é“¾è·¯ï¼šæ²¿ç€é€šä¿¡è·¯å¾„è¿æ¥ç›¸é‚»èŠ‚ç‚¹çš„é€šä¿¡ä¿¡é“ã€‚</p><h4 id="é“¾è·¯å±‚æä¾›çš„æœåŠ¡">é“¾è·¯å±‚æä¾›çš„æœåŠ¡</h4><p>ä»»æ„ä¸€ä¸ªé“¾è·¯å±‚èƒ½æä¾›çš„åŸºæœ¬æœåŠ¡ï¼šå°†æ•°æ®æŠ¥é€šè¿‡å•ä¸€çš„é€šä¿¡é“¾è·¯ä»ä¸€ä¸ªèŠ‚ç‚¹ç§»åŠ¨åˆ°ç›¸é‚»èŠ‚ç‚¹</p><p>è¿˜å¯èƒ½åŒ…æ‹¬ï¼š</p><ul><li>æˆå¸§ã€‚å°†ç½‘ç»œå±‚æ•°æ®æŠ¥ç”¨é“¾è·¯å±‚å¸§å°è£…èµ·æ¥ï¼Œä¸€ä¸ªå¸§ç”±ä¸€ä¸ªæ•°æ®å­—æ®µå’Œè‹¥å¹²é¦–éƒ¨å­—æ®µç»„æˆï¼Œç½‘ç»œå±‚æ•°æ®æŠ¥å°±æ’åœ¨æ•°æ®å­—æ®µä¸­ã€‚</li><li>é“¾è·¯æ¥å…¥ã€‚åª’ä½“è®¿é—®æ§åˆ¶ï¼ˆMACï¼ŒMedium Access Controlï¼‰åè®®è§„å®šäº†å¸§åœ¨é“¾è·¯ä¸Šçš„ä¼ è¾“è§„åˆ™ã€‚åè°ƒå¤šä¸ªèŠ‚ç‚¹çš„å¸§ä¼ è¾“ã€‚</li><li>å¯é äº¤ä»˜ã€‚å¦‚æœæä¾›ï¼Œåˆ™ä¿è¯æ— å·®é”™åœ°å°†é“¾è·¯å±‚ç§»åŠ¨æ¯ä¸€ä¸ªç½‘ç»œå±‚æ•°æ®ï¼ˆé€šå¸¸é€šè¿‡ç¡®è®¤å’Œé‡ä¼ å–å¾—ï¼‰ã€‚è¿é“¾è·¯å±‚å¯é äº¤ä»˜æœåŠ¡é€šå¸¸ç”¨äºæ˜“äºäº§ç”Ÿé«˜å·®é”™çš„é“¾è·¯ï¼Œä¾‹å¦‚æ— çº¿é“¾è·¯ï¼Œå…¶ç›®çš„æ˜¯åœ¨å·®é”™å‘ç”Ÿçš„é“¾è·¯ä¸Šï¼Œçº æ­£ä¸€ä¸ªå·®é”™ï¼Œè€Œä¸æ˜¯é€šè¿‡è¿è¾“å±‚æˆ–åº”ç”¨å±‚åè®®è¿«ä½¿è¿›è¡Œç«¯åˆ°ç«¯çš„æ•°æ®é‡ä¼ ã€‚</li><li>å·®é”™æ£€æµ‹å’Œçº æ­£ã€‚å¸§ä¸­çš„ä¸€ä¸ªæ¯”ç‰¹ 0 ä¼ è¾“æ—¶ï¼Œæ¥æ”¶æ–¹èŠ‚ç‚¹ä¸­çš„é“¾è·¯å±‚ç¡¬ä»¶å¯èƒ½ä¸æ­£ç¡®åœ°åˆ¤æ–­ä¸º1.è¿™ç§æ¯”ç‰¹å·®é”™ç”±ä¿¡å·è¡°å‡å’Œç”µç£å™ªå£°å¯¼è‡´çš„ã€‚æ²¡æœ‰å¿…è¦è½¬å‘ä¸€ä¸ªæœ‰å·®é”™çš„æ•°æ®æŠ¥ã€‚å‘é€æ–¹åœ¨å¸§ä¸­åŒ…æ‹¬å·®é”™æ£€æµ‹æ¯”ç‰¹ï¼Œè®©æ¥æ”¶æ–¹è¿›è¡Œå·®é”™æ£€æµ‹ã€‚</li></ul><h4 id="åœ¨ä½•å¤„å®ç°">åœ¨ä½•å¤„å®ç°</h4><p><em>é“¾è·¯å±‚åœ¨å“ªä¸€å¤„å®ç°ï¼Ÿ</em></p><p>ä¸»ä½“éƒ¨åˆ†åœ¨ <strong>ç½‘ç»œé€‚é…å™¨</strong>ï¼ˆç½‘ç»œæ¥å£å¡ï¼Œ<strong>NIC</strong>ï¼‰ä¸­å®ç°ï¼Œä½äºç½‘ç»œé€‚é…å™¨æ ¸å¿ƒçš„æ˜¯<strong>é“¾è·¯å±‚æ§åˆ¶å™¨</strong>ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªå®ç°äº†è®¸å¤šé“¾è·¯å±‚æœåŠ¡çš„ä¸“ç”¨èŠ¯ç‰‡ã€‚</p><p>é“¾è·¯å±‚æ§åˆ¶å™¨çš„è®¸å¤šåŠŸèƒ½éƒ½æ˜¯ç”±<strong>ç¡¬ä»¶</strong>å®ç°çš„ï¼Œé«˜å±‚åŠŸèƒ½æ˜¯ç”±è½¯ä»¶å®ç°ã€‚å› æ­¤ï¼Œé“¾è·¯å±‚æ˜¯ç¡¬ä»¶å’Œè½¯ä»¶çš„ç»“åˆä½“ã€‚</p><h3 id="å·®é”™æ£€æµ‹å’Œçº æ­£æŠ€æœ¯">å·®é”™æ£€æµ‹å’Œçº æ­£æŠ€æœ¯</h3><p>æ³¨æ„è¿™é‡Œæ˜¯ä¸¤ä¸ªæŠ€æœ¯ï¼Œå·®é”™æ£€æµ‹ å’Œ å·®é”™çº æ­£</p><p>åœ¨å‘é€èŠ‚ç‚¹ï¼Œä¸ºäº†ä¿æŠ¤æ¯”ç‰¹å…å—å·®é”™ï¼Œä½¿ç”¨å·®é”™æ£€æµ‹å’Œçº æ­£æ¯”ç‰¹ï¼ˆEDCï¼‰æ¥å¢å¼ºæ•°æ®Dã€‚è¦ä¿æŠ¤çš„æ•°æ®ä¸ä»…åŒ…æ‹¬ä»ç½‘ç»œå±‚ä¼ é€’ä¸‹ä¿©çš„æ•°æ®æŠ¥ï¼Œè¿˜åŒ…æ‹¬é“¾è·¯å¸§é¦–éƒ¨ä¸­çš„é“¾è·¯çº§å¯»å€ä¿¡æ¯ã€åºå·å’Œå…¶ä»–å­—æ®µã€‚</p><p>æ¥æ”¶æ–¹ä»»åŠ¡ï¼Œåªæ”¶åˆ°D<sup>`</sup>  å’Œ EDC<sup>1</sup> çš„æƒ…å†µä¸‹ï¼Œç¡®å®šDæ˜¯å¦å’Œåˆå§‹æ•°æ®Dç›¸åŒï¼Œä½†è¯¥æŠ€æœ¯è¿˜æ˜¯å¯èƒ½æœ‰<strong>æœªæ£€å‡ºæ¯”ç‰¹å·®é”™</strong>ï¼</p><p>å› æ­¤è¦é€‰æ‹©ä¸€ä¸ªå·®é”™æ£€æµ‹æ–¹æ¡ˆï¼Œä½¿å¾—è¿™ç§äº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡éå¸¸å°ã€‚ï¼ˆå¼€é”€å’Œæ¦‚ç‡çš„æƒè¡¡ï¼‰</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210927111505369.png" alt="image-20210927111505369"></p><h4 id="å¥‡å¶æ ¡éªŒ">å¥‡å¶æ ¡éªŒ</h4><p><strong>å•ä¸ªå¥‡å¶æ ¡éªŒ</strong></p><p>å¶æ ¡éªŒï¼Œå‘é€æ–¹åŒ…å«ä¸€ä¸ªé™„åŠ çš„æ¯”ç‰¹ï¼Œä½¿å¾—æ•°æ®ä¸­1çš„æ€»æ•°æ€»æ˜¯å¶æ•°ã€‚</p><p>äºŒç»´å¥‡å¶æ ¡éªŒï¼šæ¥æ”¶æ–¹å¯ä»¥æ£€æµ‹åˆ°å‡ºç°å•ä¸ªæ¯”ç‰¹å·®é”™çš„äº‹å®ï¼Œå¹¶ä¸”è¿˜å¯ä»¥åˆ©ç”¨å­˜åœ¨å¥‡å¶æ ¡éªŒå·®é”™çš„åˆ—å’Œè¡Œçš„ç´¢å¼•æ¥å®é™…è¯†åˆ«å‘ç”Ÿå·®é”™çš„æ¯”ç‰¹å¹¶çº æ­£å®ƒã€‚èƒ½å¤Ÿæ£€æµ‹ï¼ˆä½†æ— æ³•çº æ­£ï¼‰[æ˜¯è¿™æ ·çš„]   ä¸€ä¸ªåˆ†ç»„ä¸­ä¸¤ä¸ªæ¯”ç‰¹å·®é”™çš„ä»»ä½•åˆ†ç»„ã€‚</p><p>å‰å‘çº é”™ï¼ˆFECï¼‰ï¼š æ¥æ”¶æ–¹æ£€æµ‹å’Œçº æ­£å·®é”™çš„èƒ½åŠ›ï¼Œé€šå¸¸ç”¨äºéŸ³é¢‘CDè¿™æ ·çš„éŸ³é¢‘å­˜å‚¨å’Œå›æ”¾è®¾å¤‡ä¸­ã€‚FECå…è®¸åœ¨æ¥æ”¶æ–¹ç«‹å³çº æ­£å·®é”™ï¼Œé¿å…äº†ä¸å¾—ä¸ç­‰å¾…çš„å¾€è¿”æ—¶å»¶</p><h4 id="æ£€éªŒå’Œæ–¹æ³•">æ£€éªŒå’Œæ–¹æ³•</h4><p>æ³¨æ„æ˜¯       æ£€éªŒå’Œ æ–¹æ³•  è€Œä¸æ˜¯   æ£€éªŒ å’Œ æ–¹æ³•</p><p><strong>å› ç‰¹ç½‘æ£€éªŒå’Œ</strong>ï¼šå°†kæ¯”ç‰¹æ•´æ•°åŠ èµ·æ¥ï¼Œå¾—åˆ°çš„å’Œçš„åç ä½œä¸ºå·®é”™æ£€æµ‹æ¯”ç‰¹ã€‚æ¥æ”¶æ–¹é€šè¿‡å¯¹æ¥æ”¶æ•°æ®åŒ…æ‹¬æ£€éªŒå’Œçš„å’Œå–åç ï¼Œå¹¶ä¸”æ£€æµ‹ç»“æœæ˜¯å¦å…¨ä¸º1æ¯”ç‰¹æ¥æ£€æµ‹æ£€éªŒå’Œã€‚</p><h4 id="å¾ªç¯å†—ä½™æ£€æµ‹">å¾ªç¯å†—ä½™æ£€æµ‹</h4><p>å¦‚ä»Šè®¡ç½‘ä¸­å¹¿æ³›é‡‡ç”¨ï¼š<strong>å¾ªç¯å†—ä½™æ£€æµ‹</strong>ï¼ˆCRCï¼ŒCyclic Redundancy Checkï¼‰ï¼Œä¹Ÿå«<strong>å¤šé¡¹å¼ç¼–ç </strong>ã€‚</p><p>å‘é€æ–¹å’Œæ¥æ”¶æ–¹é¦–å…ˆåå•†ä¸€ä¸ªr + 1æ¯”ç‰¹æ¨¡å¼ï¼Œç§°ä¸ºç”Ÿæˆå¤šé¡¹å¼Gï¼ŒGçš„æœ€é«˜æœ‰æ•ˆä½æ¯”ç‰¹æ˜¯1.</p><p>å¯¹ä¸€ä¸ªç»™å®šçš„æ•°æ®æ®µDï¼Œå‘é€æ–¹é€‰æ‹©rä¸ªé™„åŠ æ¯”ç‰¹Rï¼Œé™„åŠ åˆ°Dä¸Šï¼Œå¾—åˆ°d+ræ¯”ç‰¹æ¨¡å¼ï¼Œç”¨æ¨¡2ç®—æœ¯æ°å¥½èƒ½å¤Ÿè¢«Gæ•´é™¤ï¼ˆå¼‚æˆ– XORï¼ŒåŠ æ³•ä¸­ä¸è¿›ä½ï¼Œå‡æ³•ä¸å€Ÿä½ï¼‰ã€‚</p><p>æ¥æ”¶æ–¹ç”¨Gå»é™¤æ¥æ”¶åˆ°çš„d+ræ¯”ç‰¹ï¼Œå¦‚æœä½™æ•° ï¼= 0ï¼Œåˆ™å‡ºç°äº†å·®é”™</p><blockquote><p>D * 2<sup>r</sup> XOR R = nG</p><p>R = remainder D*2<sup>r</sup>/G</p></blockquote><p>æ¯ä¸ªCRCæ ‡å‡†éƒ½èƒ½æ£€æµ‹å°äºr+11æ¯”ç‰¹çš„çªå‘é”™è¯¯ï¼Œä¹Ÿèƒ½æ£€æµ‹åˆ°ä»»ä½•å¥‡æ•°ä¸ªæ¯”ç‰¹å·®é”™ã€‚</p><p><a href="https://www.bilibili.com/video/BV1xJ411K7Wx?from=search&amp;seid=1083546657965979769&amp;spm_id_from=333.337.0.0">CRCå…·ä½“ä¾‹é¢˜æ¼”ç¤º</a></p><h3 id="å¤šè·¯è®¿é—®é“¾è·¯å’Œåè®®">å¤šè·¯è®¿é—®é“¾è·¯å’Œåè®®</h3><p>ä¸¤ç§ç±»å‹çš„ç½‘ç»œé“¾è·¯ï¼š</p><ul><li>ç‚¹å¯¹ç‚¹é“¾è·¯ï¼Œç”±é“¾è·¯ä¸€æ®µçš„å•ä¸ªå‘é€æ–¹å’Œé“¾è·¯å¦ä¸€ç«¯çš„å•ä¸ªæ¥æ”¶æ–¹ç»„æˆã€‚è®¸å¤šé“¾è·¯å±‚åè®®éƒ½æ˜¯ä¸ºç‚¹å¯¹ç‚¹é“¾è·¯è®¾è®¡çš„ã€‚ï¼ˆä¾‹å¦‚ï¼Œç‚¹å¯¹ç‚¹åè®® PPP å’Œé«˜çº§æ•°æ®é“¾è·¯æ§åˆ¶ï¼ˆHDLCï¼‰ï¼‰</li><li>å¹¿æ’­é“¾è·¯ï¼Œèƒ½å¤Ÿè®©å¤šä¸ªå‘é€æ–¹æ¥æ”¶æ–¹éƒ½è¿æ¥åˆ°ç›¸åŒçš„ã€å•ä¸€çš„ã€å…±äº«çš„å¹¿æ’­ä¿¡é“ä¸Šï¼Œä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹ä¼ è¾“ä¸€ä¸ªå¸§ï¼Œä¿¡é“å¹¿æ’­è¯¥å¸§ï¼Œæ¯ä¸ªèŠ‚ç‚¹æ”¶å‰¯æœ¬ã€‚ï¼ˆä¾‹å¦‚ï¼Œä»¥å¤ªç½‘å’Œæ— çº¿å±€åŸŸç½‘ï¼‰</li></ul><p>å¦‚ä½•åè°ƒå¤šä¸ªå‘é€å’Œæ¥æ”¶èŠ‚ç‚¹å¯¹ä¸€ä¸ªå…±äº«å¹¿æ’­ä¿¡é“çš„è®¿é—® ----- &gt; å¤šè·¯è®¿é—®é—®é¢˜ï¼ˆå¹¿æ’­ä¿¡é“å¸¸ç”¨äºå±€åŸŸç½‘ä¸­ï¼‰</p><p>å› ä¸ºæ‰€æœ‰èŠ‚ç‚¹éƒ½èƒ½ä¼ è¾“å¸§ï¼Œæ‰€ä»¥å¤šä¸ªèŠ‚ç‚¹å¯èƒ½ä¼šåŒæ—¶ä¼ è¾“å¸§ï¼Œè¿™ç§æƒ…å†µå‘ç”Ÿæ—¶ï¼Œæ‰€æœ‰èŠ‚ç‚¹åŒæ—¶æ¥æ”¶åˆ°å¤šä¸ªå¸§ï¼Œå³ä¼ è¾“çš„å¸§åœ¨æ‰€æœ‰çš„æ¥æ”¶æ–¹å¤„<strong>ç¢°æ’</strong>äº†ã€‚é€šå¸¸å½“ç¢°æ’å‘ç”Ÿæ—¶ï¼Œæ²¡æœ‰ä¸€ä¸ªæ¥å—èŠ‚ç‚¹èƒ½å¤Ÿæœ‰æ•ˆè·å¾—ä»»ä½•ä¼ è¾“çš„å¸§ï¼ˆæŸç§æ„ä¹‰ä¸‹ï¼Œå¸§çš„ä¿¡å·çº ç¼ åœ¨ä¸€èµ·ï¼‰ï¼Œåœ¨ç¢°æ’æ—¶é—´é—´éš”ä¸­çš„å¹¿æ’­ä¿¡é“éƒ½è¢«æµªè´¹äº†ã€‚åè°ƒå¤šä¸ªèŠ‚ç‚¹çš„ä¼ è¾“ â€” &gt; å¤šè·¯è®¿é—®åè®®è´Ÿè´£ã€‚</p><p>å¤šè·¯è®¿é—®åè®®çš„åˆ’åˆ†ï¼š</p><ul><li>ä¿¡é“åˆ’åˆ†åè®®</li><li>éšæœºæ¥å…¥åè®®</li><li>è½®æµåè®®</li></ul><h4 id="ä¿¡é“åˆ’åˆ†åè®®">ä¿¡é“åˆ’åˆ†åè®®</h4><p>æ—¶åˆ†å¤šè·¯å¤ç”¨ï¼ˆTDMï¼‰å’Œé¢‘åˆ†å¤šè·¯å¤ç”¨ï¼ˆFDMï¼‰æ˜¯ä¸¤ç§èƒ½å¤Ÿç”¨äºåœ¨æ‰€æœ‰å…±äº«ä¿¡é“èŠ‚ç‚¹ä¹‹é—´åˆ’åˆ†å¹¿æ’­ä¿¡é“å¸¦å®½çš„æŠ€æœ¯ã€‚</p><p>ä¸€ä¸ªæ”¯æŒNä¸ªå‡ ç‚¹çš„ä¿¡é“ä¸”ä¼ è¾“é€Ÿç‡ä¸ºR bps</p><p><strong>TDMï¼š æ—¶åˆ†å¤šè·¯å¤ç”¨</strong></p><p>TDMå°†æ—¶é—´åˆ’åˆ†ä¸ºæ—¶é—´å¸§ï¼Œè¿›ä¸€æ­¥åˆ’åˆ†æ¯ä¸ªæ—¶é—´å¸§ä¸ºNä¸ªæ—¶éš™ï¼ŒæŠŠæ¯ä¸ªæ—¶éš™åˆ†é…ä¸ªNä¸ªèŠ‚ç‚¹ä¸­çš„ä¸€ä¸ªã€‚æ— è®ºä½•æ—¶æŸä¸ªèŠ‚ç‚¹åœ¨æœ‰åˆ†ç»„è¦å‘é€çš„æ—¶å€™ï¼Œå®ƒåœ¨å¾ªç¯çš„TDMå¸§ä¸­æŒ‡æ´¾ç»™å®ƒçš„æ—¶éš™å†…ä¼ è¾“åˆ†ç»„æ¯”ç‰¹ã€‚é€šå¸¸ï¼Œé€‰æ‹©çš„æ—¶éš™é•¿åº¦åº”è¯¥ä½¿ä¸€ä¸ªæ—¶éš™å†…èƒ½ä¼ è¾“å•ä¸ªåˆ†ç»„ã€‚ï¼ˆç±»ä¼¼æ—¶é—´ç‰‡æ–¹å¼ï¼Œæ¯ä¸ªäººéƒ½æœ‰å…¬å¹³çš„å‘è¨€æƒï¼‰</p><p>ç¼ºç‚¹ï¼š</p><ul><li>èŠ‚ç‚¹è¢«é™åˆ¶ R/N bpsçš„å¹³å‡é€Ÿç‡ï¼Œ<strong>å³ä½¿ä»–æ˜¯å”¯ä¸€æœ‰åˆ†ç»„è¦å‘é€çš„èŠ‚ç‚¹æ—¶</strong></li><li>èŠ‚ç‚¹å¿…é¡»æ€»æ˜¯ç­‰å¾…å®ƒåœ¨ä¼ è¾“åºåˆ—ä¸­çš„è½®æ¬¡ï¼Œ<strong>å³ä½¿ä»–æ˜¯å”¯ä¸€æœ‰åˆ†ç»„è¦å‘é€çš„èŠ‚ç‚¹</strong></li></ul><p><strong>FDMï¼šé¢‘åˆ†å¤šè·¯å¤ç”¨</strong></p><p>FDMå°†R bpsä¿¡é“åˆ’åˆ†ä¸ºä¸åŒçš„é¢‘æ®µï¼Œæ¯ä¸ªé¢‘æ®µæœ‰R/Nä¸ªå¸¦å®½ï¼ŒæŠŠæ¯ä¸ªé¢‘ç‡åˆ†é…ä¸ªNä¸ªèŠ‚ç‚¹ä¸­çš„ä¸€ä¸ªï¼Œå› æ­¤FDMåœ¨R bpsä¿¡é“ä¸­åˆ›å»ºäº†Nä¸ªè¾ƒå°çš„R/N bpsä¿¡é“ã€‚</p><p>ä¼˜ç‚¹ï¼šé¿å…ç¢°æ’ï¼Œåœ¨Nä¸ªèŠ‚ç‚¹ä¹‹é—´å…¬å¹³åˆ’åˆ†å¸¦å®½ã€‚</p><p>ç¼ºç‚¹ï¼šé™åˆ¶ä¸€ä¸ªèŠ‚ç‚¹åªèƒ½ä½¿ç”¨R/Nçš„å¸¦å®½ï¼Œ<strong>å³ä½¿å½“ä»–æ˜¯å”¯ä¸€ä¸€ä¸ªæœ‰åˆ†ç»„è¦å‘é€çš„èŠ‚ç‚¹</strong></p><p><strong>CDMAï¼šç åˆ†å¤šå€</strong></p><p>CDMAä¸ºæ¯ä¸ªèŠ‚ç‚¹åˆ†é…ä¸€ç§ä¸åŒçš„ç¼–ç ï¼Œæ¯ä¸ªèŠ‚ç‚¹ç”¨å®ƒå”¯ä¸€çš„ç¼–ç æ¥å¯¹ä»–å‘é€çš„æ•°æ®è¿›è¡Œç¼–ç ã€‚èƒ½å¤Ÿåšåˆ°<strong>ä¸åŒèŠ‚ç‚¹åŒæ—¶ä¼ è¾“</strong>ï¼Œå¹¶ä¸”æ¥æ”¶æ–¹ä»èƒ½æ­£ç¡®æ¥æ”¶å‘é€æ–¹ç¼–ç çš„æ•°æ®æ¯”ç‰¹ï¼Œè€Œä¸åœ¨ä¹å…¶ä»–èŠ‚ç‚¹çš„å¹²æ‰°ä¼ è¾“ã€‚ï¼ˆç›®å‰åœ¨å†›ç”¨ç³»ç»Ÿä¸­ä½¿ç”¨ã€æ°‘ç”¨èœ‚çªç”µè¯ä¹Ÿæœ‰ä½¿ç”¨æŠ—å¹²æ‰°ï¼‰</p><h4 id="éšæœºæ¥å…¥åè®®">éšæœºæ¥å…¥åè®®</h4><p>å½“æœ‰ç¢°æ’æ—¶ï¼Œæ¶‰åŠç¢°æ’çš„æ¯ä¸ªèŠ‚ç‚¹åå¤é‡å‘å®ƒçš„å¸§ï¼Œåˆ°è¯¥å¸§æ— ç¢°æ’é€šè¿‡ä¸ºæ­¢ã€‚ä½†å½“ä¸€ä¸ªèŠ‚ç‚¹ç»å†ä¸€æ¬¡ç¢°æ’æ—¶ï¼Œå®ƒä¸å¿…ç«‹åˆ»é‡å‘è¯¥å¸§ã€‚ç›¸åï¼Œå®ƒåœ¨é‡å‘è¯¥å¸§ä¹‹å‰çš„ç­‰å¾…ä¸€ä¸ªéšæœºæ—¶å»¶ã€‚</p><p>å¸¸ç”¨çš„éšæœºæ¥å…¥åè®®ï¼š</p><ol><li><p><strong>æ—¶éš™ALOHAåè®®</strong></p><p>è¦æ±‚ï¼š</p><ul><li>ä¸€ä¸ªæ—¶éš™ç­‰äºä¼ è¾“ä¸€å¸§çš„æ—¶é—´</li><li>èŠ‚ç‚¹åªåœ¨æ—¶éš™èµ·ç‚¹ä¼ è¾“å¸§</li><li>èŠ‚ç‚¹æ˜¯åŒæ­¥çš„ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½çŸ¥é“æ—¶éš™ä½•æ—¶å¼€å§‹</li><li>èŠ‚ç‚¹åœ¨å‘é€æ—¶éš™ç»“æŸä¹‹å‰æ£€æµ‹åˆ°ç¢°æ’æ—¶é—´</li></ul><p>å¦‚æœæœ‰ç¢°æ’ï¼Œåˆ™èŠ‚ç‚¹åœ¨å‘é€æ—¶éš™ç»“æŸä¹‹å‰æ£€æµ‹åˆ°è¿™æ¬¡ç¢°æ’ï¼Œå¹¶ä¸”ä»¥æ¦‚ç‡påœ¨åç»­çš„æ¯ä¸ªæ—¶éš™ä¸­é‡ä¼ è¯¥å¸§ï¼ŒçŸ¥é“è¯¥å¸§æ— ç¢°æ’åœ°ä¼ è¾“å‡ºå»ã€‚</p><p>ä¼˜ç‚¹ï¼š</p><ul><li>å½“æŸèŠ‚ç‚¹æ˜¯å”¯ä¸€æ´»è·ƒçš„èŠ‚ç‚¹æ—¶ï¼Œæ—¶éš™ALOHAå…è®¸è¯¥èŠ‚ç‚¹ä»¥å…¨é€ŸR bpsè¿ç»­ä¼ è¾“ã€‚</li><li>é«˜åº¦åˆ†æ•£ï¼Œæ¯ä¸ªèŠ‚ç‚¹æ£€æµ‹ç¢°æ’å¹¶ç‹¬ç«‹åœ°å†³å®šä»€ä¹ˆæ—¶å€™é‡ä¼ </li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>éœ€è¦èŠ‚ç‚¹ä¸­å¯¹æ—¶éš™åŒæ­¥</li><li>å¤šä¸ªæ´»è·ƒèŠ‚ç‚¹ï¼Œä¸€éƒ¨åˆ†æ—¶éš™æœ‰ç¢°æ’è¢«æµªè´¹æ‰ï¼›æ—¶éš™çš„ä¸€éƒ¨åˆ†çœæ§çº¿çš„ï¼Œå› ä¸ºæ‰€æœ‰æ´»è·ƒèŠ‚ç‚¹ç”±äºæ¦‚ç‡ä¼ è¾“ç­–ç•¥ä¼šèŠ‚åˆ¶ä¼ è¾“ã€‚</li></ul><p>æ—¶éš™ALOHAæ•ˆç‡æ˜¯ Npï¼ˆ1-pï¼‰<sup>N-1</sup>, å–å¾—æœ€å¤§å€¼æ—¶ï¼Œ æ•ˆç‡37%</p></li><li><p><strong>ALOHA  by Norm Abramson</strong></p><p>å½“ä¸€å¸§é¦–æ¬¡åˆ°è¾¾ï¼ŒèŠ‚ç‚¹ç«‹åˆ»ï¼ˆåœ¨å®Œå…¨ä¼ è¾“å®Œå®ƒçš„ç¢°æ’å¸§ä¹‹åï¼‰ä»¥æ¦‚ç‡pé‡ä¼ è¯¥å¸§ï¼Œå¦åˆ™èŠ‚ç‚¹ç­‰å¾…ä¸€ä¸ªå¸§ä¼ è¾“æ—¶é—´ï¼Œæ­¤åä»¥æ¦‚ç‡pé‡ä¼ è¯¥å¸§ã€‚</p><p>ä¸€ä¸ªç»™å®šèŠ‚ç‚¹ä¼ è¾“æˆåŠŸçš„æ¦‚ç‡æ˜¯ p(1-p)<sup>2(N-1)</sup>ï¼ˆN-1ä¸ªèŠ‚ç‚¹åœ¨ä¸¤ä»½è¿ç»­æ—¶éš™å†…ä¸èƒ½ä¼ è¾“ï¼‰ï¼Œ æœ€å¤§æ•ˆç‡æ˜¯ 1 / 2e  [P.297]</p></li><li><p><strong>CSMA è½½æ³¢ä¾¦å¬å¤šè·¯è®¿é—®</strong></p><p>ALOHAæ¯ä¸ªèŠ‚ç‚¹ç‹¬ç«‹ï¼Œä¸å…³å¿ƒæ˜¯å¦æœ‰å…¶ä»–èŠ‚ç‚¹æ­£åœ¨ä¼ è¾“</p><ul><li><p>è½½æ³¢ä¾¦å¬ï¼šä¸€ä¸ªèŠ‚ç‚¹åœ¨ä¼ è¾“å‰è¦å…ˆå¬ä¿¡é“</p></li><li><p>ç¢°æ’æ£€æµ‹ï¼šä¸€ä¸ªä¼ è¾“èŠ‚ç‚¹åœ¨ä¼ è¾“æ—¶ä¸€ç›´åœ¨ä¾¦å¬æ­¤ä¿¡é“ï¼Œå¦‚æœç”±ä¸€ä¸ªèŠ‚ç‚¹æ­£åœ¨ä¼ è¾“å¹²æ‰°å¸§ï¼Œåˆ™æ­¤èŠ‚ç‚¹å°±åœæ­¢ä¼ è¾“ã€‚</p><p>æ—¢ç„¶æœ‰è½½æ³¢ä¾¦å¬ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦ç¢°æ’æ£€æµ‹ï¼Ÿ</p><p>ä¿¡é“ç«¯åˆ°ç«¯ä¿¡é“ä¼ æ’­æ—¶å»¶ï¼Œè™½ç„¶æ˜¯å…‰é€Ÿä¼ æ’­ï¼Œä½†æœªåˆ°è¾¾ä¹‹å‰è¿˜æ˜¯è®¤ä¸ºè¯¥ä¿¡é“æ˜¯ç©ºé—²çš„ P.299</p><p>ä¼ æ’­æ—¶å»¶è¶Šå¤§ï¼Œè½½æ³¢ä¾¦å¬èŠ‚ç‚¹ä¸èƒ½ä¾¦å¬åˆ°ç½‘ç»œä¸­å¦ä¸€ä¸ªèŠ‚ç‚¹ä»¥åŠå¼€å§‹ä¼ è¾“çš„æœºä¼šå°±è¶Šå¤§ã€‚</p></li></ul></li><li><p><strong>CSMA/CD å…·æœ‰ç¢°æ’æ£€æµ‹çš„è½½æ³¢ä¾¦å¬å¤šè·¯è®¿é—®</strong></p><p>ç›®çš„ï¼Œä¸ä¼ è¾“ä¸€ä¸ªæ— ç”¨çš„ã€æŸåçš„å¸§ï¼Œæ”¹å–„åè®®çš„æ€§èƒ½</p><p>å¦‚ä½•é€‰æ‹©ç­‰å¾…çš„æ—¶é—´é—´éš”ï¼Ÿ</p><p>ç†æƒ³æƒ…å†µï¼šç¢°æ’èŠ‚ç‚¹æ•°å°‘ â€”&gt; æ—¶é—´é—´éš”çŸ­;ç¢°æ’èŠ‚ç‚¹æ•°å¤š â€”&gt; æ—¶é—´é—´éš”é•¿</p><p>é—®é¢˜è§£å†³ï¼š <strong>äºŒè¿›åˆ¶æŒ‡æ•°åé€€</strong>ç®—æ³•</p><ul><li>æŸå¸§ç»å†äº†ä¸€è¿ä¸²næ¬¡ç¢°æ’åï¼ŒèŠ‚ç‚¹éšæœºä»0 åˆ° 2<sup>n</sup> -1 ä¸­é€‰æ‹©ä¸€ä¸ªKå€¼ï¼Œå› æ­¤ï¼Œç¢°æ’è¶Šå¤šï¼ŒKé€‰æ‹©é—´éš™è¶Šå¤§ã€‚èƒ½å¤Ÿå–å¾—çš„æœ€å¤§å€¼åœ¨10ä»¥å†…</li></ul></li></ol><h4 id="è½®æµåè®®">è½®æµåè®®</h4><p>å½“æœ‰Mä¸ªèŠ‚ç‚¹æ´»è·ƒæ—¶ï¼Œæ¯ä¸ªæ´»è·ƒèŠ‚ç‚¹çš„ååé‡æ¥è¿‘R / M bps (å‰ä¸¤ä¸ªåè®®ä¸å…·æœ‰)</p><ul><li><p>è½®è¯¢åè®®ã€‚é€‰ä¸»èŠ‚ç‚¹ï¼Œä¸»èŠ‚ç‚¹ä»¥å¾ªç¯æ–¹å¼è½®è¯¢æ¯ä¸ªèŠ‚ç‚¹ã€‚ä¸»èŠ‚ç‚¹é€šè¿‡è§‚å¯Ÿåœ¨ä¿¡é“ä¸Šæ˜¯å¦ç¼ºä¹ä¿¡å·ï¼Œæ¥å†³å®šä¸€ä¸ªèŠ‚ç‚¹ä½•æ—¶å®Œæˆäº† å¸§çš„ä¼ è¾“ã€‚</p><p>æ¶ˆé™¤äº†ç¢°æ’å’Œç©ºæ—¶éš™ï¼Œä½†å¼•å…¥è½®è¯¢æ—¶å»¶ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹æ˜¯æ´»è·ƒçš„ï¼Œåˆ™è¯¥èŠ‚ç‚¹å¿…ç„¶ä»¥å°äºR bpsçš„é€Ÿç‡ä¼ è¾“ï¼›å¦‚æœä¸»èŠ‚ç‚¹æ•…éšœåœ¨ï¼Œåˆ™æ•´ä¸ªä¿¡é“ä¸å¯æ“ä½œã€‚</p></li><li><p>ä»¤ç‰Œä¼ é€’åè®®ã€‚ä¸€ä¸ªç§°ä¸ºä»¤ç‰Œ(token)çš„å°çš„ç‰¹æ®Šå¸§åœ¨èŠ‚ç‚¹ä¹‹é—´ä»¥å›ºå®šçš„æ¬¡åºè¿›è¡Œäº¤æ¢ã€‚ä¸€ä¸ªèŠ‚ç‚¹æ”¶åˆ°ä»¤ç‰Œæ—¶ï¼Œä»…å½“å®ƒæœ‰å¸§è¦å‘é€æ—¶ï¼Œå®ƒæ‰ä¼šæŒæœ‰è¿™ä¸ªä»¤ç‰Œï¼Œå¦åˆ™å°±å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹è½¬å‘è¯¥ä»¤ç‰Œã€‚</p><p>ä»¤ç‰Œä¼ é€’æ˜¯åˆ†æ•£ï¼Œæ•ˆç‡é«˜ã€‚ä½†ä¸€ä¸ªèŠ‚ç‚¹çš„æ•…éšœå¯èƒ½ä½¿å¾—æ•´ä¸ªä¿¡é“å´©æºƒã€‚å¦‚æœä¸€ä¸ªèŠ‚ç‚¹å¿˜è®°é‡Šæ”¾ä»¤ç‰Œï¼Œåˆ™éœ€è¦æ¢å¤æ­¥éª¤ã€‚</p></li></ul><h4 id="DOCSISï¼šç”¨äºç”µç¼†å› ç‰¹ç½‘æ¥å…¥çš„é“¾è·¯å±‚åè®®">DOCSISï¼šç”¨äºç”µç¼†å› ç‰¹ç½‘æ¥å…¥çš„é“¾è·¯å±‚åè®®</h4><p>ä¸€ä¸ªç”µç¼†æ¥å…¥ç½‘é€šå¸¸åœ¨ç”µç¼†ç½‘å¤´ç«¯å°†å‡ åƒä¸ªä½å®…ç”µç¼†è°ƒåˆ¶è§£è°ƒå™¨ä¸ä¸€ä¸ªç”µç¼†è°ƒåˆ¶è§£è°ƒå™¨ç«¯æ¥ç³»ç»Ÿ(CMTS)è¿æ¥ã€‚DOCSISä½¿ç”¨FDMå°†ä¸‹è¡Œï¼ˆCMTSåˆ°è°ƒåˆ¶è§£è°ƒå™¨ï¼‰å’Œä¸Šè¡Œï¼ˆè°ƒåˆ¶è§£è°ƒå™¨åˆ°CMTSï¼‰ç½‘ç»œæ®µåˆ’åˆ†ä¸ºå¤šä¸ªé¢‘ç‡ä¿¡é“ã€‚CMTSåœ¨ä¸‹è¡Œä¿¡é“ä¸­ä¼ è¾“çš„å¸§è¢«æ‰€å“Ÿæœ‰åœ¨ä¿¡é“ä¸Šåšæ¥æ”¶çš„è°ƒåˆ¶è§£è°ƒå™¨æ¥æ”¶ï¼Œç„¶è€Œå› ä¸ºä»…æœ‰å•ä¸€çš„CMTSåœ¨ä¸‹è¡Œä¿¡é“ä¼ è¾“ï¼Œæ‰€ä»¥ä¸å­˜åœ¨å¤šè·¯è®¿é—®é—®é¢˜ï¼Œä½†ä¸Šè¡Œæ–¹å‘ï¼Œå¤šä¸ªç”µç¼†è°ƒåˆ¶è§£è°ƒå™¨å…±äº«åˆ°CMTSçš„ç›¸åŒä¸Šè¡Œä¿¡é“ï¼Œå¯èƒ½å‡ºç°ç¢°æ’</p><p>æ¯æ¡ä¸Šè¡Œä¿¡é“è¢«åˆ’åˆ†ä¸ºæ—¶é—´é—´éš”ï¼ˆç±»ä¼¼TDMï¼‰ï¼Œæ¯ä¸ªæ—¶é—´é—´éš”åŒ…å«ä¸€ä¸ªå¾®æ—¶éš™åºåˆ—ï¼Œç”µç¼†è°ƒåˆ¶è§£è°ƒå™¨åœ¨å¾®æ—¶éš™ä¸­å‘CMTSä¼ è¾“ã€‚CMTSæ˜¾ç¤ºçš„å…è®¸å„ä¸ªç”µç¼†è°ƒåˆ¶è§£è°ƒå™¨åœ¨ç‰¹å®šçš„å¾®æ—¶éš™ä¸­è¿›è¡Œä¼ è¾“ã€‚CMTSåœ¨ä¸‹è¡Œä¿¡é“ä¸Šé€šè¿‡å‘é€MAPæŠ¥æ–‡çš„æ§åˆ¶æŠ¥æ–‡ï¼Œåˆ¶å®šå“ªä¸ªç”µç¼†è°ƒåˆ¶è§£è°ƒå™¨èƒ½å¤Ÿåœ¨å¾®æ—¶éš™ä¸­ä¼ è¾“ç”±æ§åˆ¶æŠ¥æ–‡åˆ¶å®šçš„æ—¶é—´é—´éš”ã€‚ç”±äºå¾®æ—¶éš™æ˜ç¡®åˆ†é…ç»™ç”µç¼†è°ƒåˆ¶è§£è°ƒå™¨ï¼Œæ•…CMTSèƒ½ç¡®ä¿åœ¨å¾®æ—¶éš™ä¸­æ²¡æœ‰ç¢°æ’ä¼ è¾“ã€‚</p><p>CMTSä¸€å¼€å§‹å¦‚ä½•çŸ¥é“å“ªä¸ªè°ƒåˆ¶è§£è°ƒå™¨æœ‰æ•°æ®è¦å‘é€ï¼Ÿè§„å®šä¸€ç»„ç‰¹æ®Šçš„å¾®æ—¶éš™é—´éš”ï¼Œè¿™ä¸ªé—´éš”å†…éƒ½å¯ä»¥å‘CMTSå‘é€å¾®æ—¶éš™è¯·æ±‚å¸§æ¥å®Œæˆã€‚ä½†è¿™äº›å¸§å¯èƒ½ç¢°æ’ã€‚å¦‚ä½•è§£å†³ï¼Ÿç”µç¼†è°ƒåˆ¶è§£è°ƒå™¨å¦‚æœæ²¡æœ‰åœ¨ä¸‹ä¸€ä¸ªä¸‹è¡Œæ§åˆ¶æŠ¥æ–‡ä¸­æ”¶åˆ°å¯¹è¯·æ±‚åˆ†é…çš„å“åº”ï¼Œå°±æ¨æµ‹å‡ºæœ‰ç¢°æ’ï¼Œä½¿ç”¨äºŒè¿›åˆ¶æŒ‡æ•°å›é€€å°†å¾®æ—¶éš™çš„è¯·æ±‚å¸§å»¶ç¼“åˆ°ä»¥åçš„æ—¶éš™å‘é€       P. 302</p><h3 id="äº¤æ¢å±€åŸŸç½‘">äº¤æ¢å±€åŸŸç½‘</h3><h4 id="é“¾è·¯å±‚å¯»å€å’ŒARP">é“¾è·¯å±‚å¯»å€å’ŒARP</h4><h5 id="MACåœ°å€">MACåœ°å€</h5><p>å†æ¬¡å¼ºè°ƒï¼Œä¸æ˜¯ä¸»æœºæˆ–è€…è·¯ç”±å™¨å…·æœ‰é“¾è·¯å±‚åœ°å€ï¼Œè€Œæ˜¯ä»–ä»¬çš„é€‚é…å™¨ï¼ˆå³ç½‘ç»œæ¥å£ï¼‰å…·æœ‰é“¾è·¯å±‚åœ°å€ã€‚ä½†é“¾è·¯å±‚äº¤æ¢æœºä¸å…·æœ‰ä¸ä»–ä»¬çš„æ¥å£ç›¸å…³è”çš„é“¾è·¯å±‚åœ°å€ï¼Œå› ä¸ºé“¾è·¯å±‚äº¤æ¢æœºçš„ä»»åŠ¡æ˜¯åœ¨ä¸»æœºå’Œè·¯ç”±å™¨ä¹‹é—´æ‰¿è½½æ•°æ®æŠ¥ï¼Œå®ƒé€æ˜åº•æ‰§è¡Œäº†è¿™é¡¹ä»»åŠ¡ï¼Œä¸»æœºæˆ–è·¯ç”±å™¨ä¸å¿…æ˜ç¡®ç¬¬å°†å¸§å¯»å€åˆ°å…¶é—´çš„äº¤æ¢æœºã€‚</p><p>é“¾è·¯å±‚åœ°å€ä¸åŒçš„ç§°å‘¼ï¼š</p><p><strong>LAN åœ°å€ã€ç‰©ç†åœ°å€ã€MACåœ°å€</strong></p><p>MACåœ°å€é•¿åº¦ä¸º6å­—èŠ‚ï¼Œ2^48ä¸ªå¯ç”¨MACåœ°å€ï¼Œå¸¸ç”¨åå…­æœºåˆ¶è¡¨ç¤ºï¼ŒMACåœ°å€è¢«è®¾è®¡ä¸ºæ˜¯å›ºå®šçš„ã€‚</p><p><strong>æ²¡æœ‰ä¸¤å—é€‚é…å™¨å…·æœ‰ç›¸åŒçš„MACåœ°å€</strong></p><p>MACæ‰å¹³ç»“æ„ï¼ŒIPåœ°å€å…·æœ‰å±‚æ¬¡ç»“æ„ï¼ˆä¸€ä¸ªç½‘è·¯éƒ¨åˆ†å’Œä¸€ä¸ªä¸»æœºéƒ¨åˆ†ï¼‰ï¼Œä¸¤è€…ç›¸åã€‚</p><p>ä¸€ä¸ªé€‚é…å™¨å¯èƒ½æ¥æ”¶åˆ°ä¸€ä¸ªå¹¶éå‘å®ƒå¯»å€çš„å¸§ï¼Œä¸åŒ¹é…ï¼Œå°±ä¼šèµŒæ°”ï¼Œè€Œä¸æ˜¯å‘ä¸Šä¼ é€’ç½‘ç»œå±‚æ•°æ®åŒ…ã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶é€‚é…å™¨çš„ç¡®éœ€è¦è®©æ‰€æœ‰å…¶ä»–é€‚é…å™¨æ‹‰åŸƒæ¥æ”¶å¹¶å¤„ç†ä»–æ‰“ç®—å‘é€çš„å¸§ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå‘é€é€‚é…åœ¨å¸§çš„ç›®çš„åœ°å€å­—æ®µä¸­æ’å…¥ä¸€ä¸ªç‰¹æ®Šçš„MACå¹¿æ’­åœ°å€ï¼ŒFF-FF-FF-FF-FF</p><h5 id="åœ°å€è§£æåè®®">åœ°å€è§£æåè®®</h5><p>Address Resolution Protocolï¼Œ ARP ï¼šIP  ---- &gt;  ARP</p><p>åœºæ™¯ï¼šä¸€ä¸ªå­ç½‘ä¸­çš„ä¸»æœºè¦å‘ç›¸åŒå­ç½‘çš„å¦ä¸€å°ä¸»æœºå‘é€æ•°æ®æŠ¥</p><p><strong>åªä¸ºåœ¨åŒä¸€ä¸ªå­ç½‘ä¸Šçš„ä¸»æœºå’Œè·¯ç”±å™¨æ¥å£è§£æIPåœ°å€</strong></p><p>æ¯å°ä¸»æœºæˆ–è·¯ç”±å™¨ä¸­æœ‰ä¸€ä¸ªARPè¡¨ï¼ŒåŒ…å«IPåœ°å€åˆ°MACåœ°å€çš„æ˜ å°„å…³ç³»ï¼Œä¹ŸåŒ…å«äº†å¯¿å‘½TTLå€¼ï¼ˆæŒ‡ç¤ºä»è¡¨ä¸­åˆ é™¤æ¯ä¸ªæ˜ å°„çš„æ—¶é—´ï¼Œé€šå¸¸æ˜¯20minï¼‰</p><p>å‘é€æ–¹æ„é€ ä¸€ä¸ªARP packetçš„ç‰¹æ®Šåˆ†ç»„ï¼ŒåŒ…å«å­—æ®µï¼ˆå‘é€ã€æ¥æ”¶çš„IPåœ°å€å’ŒMACåœ°å€ï¼‰ã€‚åˆå¯åˆ†ä¸ºARPæŸ¥è¯¢åˆ†ç»„å’Œå“åº”åˆ†ç»„ï¼Œæ ¼å¼å‡ç›¸åŒã€‚æŸ¥è¯¢åˆ†ç»„çš„ç›®çš„æ˜¯è¯¢é—®å­ç½‘ä¸Šæ‰€æœ‰å…¶ä»–ä¸»æœºå’Œè·¯ç”±å™¨ï¼Œç¡®å®šå¯¹åº”äºè¦è§£æçš„IPåœ°å€çš„é‚£ä¸ªMACåœ°å€</p><p>è¿‡ç¨‹ä¸¾ä¾‹ï¼š</p><ul><li>ä¸€ä¸ªä¸»æœºå‘å®ƒçš„é€‚é…å™¨ä¼ é€’ä¸€ä¸ªARPæŸ¥è¯¢åˆ†ç»„ï¼Œå¹¶ä¸”æŒ‡ç¤ºé€‚é…å™¨åº”è¯¥ç”¨MACå¹¿æ’­åœ°å€æ¥å‘é€è¿™ä¸ªåˆ†ç»„</li><li>é€‚é…å™¨åœ¨é“¾è·¯å±‚å¸§ä¸­å°è£…è¿™ä¸ªARPåˆ†ç»„ï¼Œç”¨å¹¿æ’­åœ°å€ä½œä¸ºå¸§çš„ç›®çš„åœ°å€ï¼Œå°†è¯¥å¸§ä¼ è¾“åˆ°å­ç½‘ä¸­ã€‚</li><li>å­ç½‘ä¸­çš„æ‰€æœ‰å…¶ä»–é€‚é…å™¨éƒ½æ¥æ”¶åˆ°ï¼Œå¹¶ä¸”æ¯ä¸ªé€‚é…å™¨æŠŠåœ¨è¯¥å¸§ä¸­çš„ARPåˆ†ç»„<strong>å‘ä¸Šä¼ é€’ç»™ARPæ¨¡å—</strong></li><li>ARPæ¨¡å—æ£€æŸ¥å®ƒçš„IPåœ°å€ä¸ARPåˆ†ç»„ä¸­çš„ç›®çš„IPåœ°å€æ˜¯å¦åŒ¹é…ï¼ŒåŒ¹é… --&gt; ç»™æŸ¥è¯¢ä¸»æœºå‘é€ä¸€ä¸ªå¸¦æœ‰æ‰€å¸Œæœ›æ˜ å°„çš„ARPåˆ†ç»„ã€‚</li><li>æŸ¥è¯¢ä¸»æœºæ›´æ–°å®ƒçš„ARPè¡¨ï¼Œå¹¶å‘é€IPæ•°æ®æŠ¥ï¼Œè¯¥æ•°æ®æŠ¥å°è£…åœ¨é“¾è·¯å±‚å¸§ä¸­ï¼Œå¹¶ä¸”è¯¥å¸§çš„ç›®çš„MACå°±æ˜¯å¯¹å…ˆå‰çš„ARPè¯·æ±‚è¿›è¡Œå“åº”çš„ä¸»æœºæˆ–è·¯ç”±å™¨çš„MACåœ°å€ï¼ˆï¼Ÿï¼Ÿï¼Ÿï¼‰</li></ul><p>ARPå¯çœ‹æˆæ˜¯è·¨è¶Šé“¾è·¯å±‚å’Œç½‘ç»œå±‚è¾¹ç•Œä¸¤è¾¹çš„åè®®ã€‚</p><h5 id="å‘é€æ•°æ®æŠ¥åˆ°å­ç½‘ä»¥å¤–">å‘é€æ•°æ®æŠ¥åˆ°å­ç½‘ä»¥å¤–</h5><p>åœºæ™¯ï¼šå­ç½‘çš„ä¸»æœºè¦å‘å­ç½‘ä»¥å¤–çš„ï¼ˆå¦ä¸€ä¸ªå­ç½‘ä¸­ï¼‰ä¸»æœºå‘é€ç½‘ç»œå±‚æ•°æ®æŠ¥</p><p>æ³¨æ„ç‚¹ï¼šè·¯ç”±å™¨çš„æ¯ä¸ªæ¥å£ï¼Œéƒ½æœ‰ä¸€ä¸ªIPåœ°å€ã€ä¸€ä¸ªARPæ¨¡å—å’Œä¸€ä¸ªé€‚é…å™¨ï¼Œé€‚é…å™¨æœ‰è‡ªå·±çš„MACåœ°å€</p><p>ä¸»æœº---- &gt; è·¯ç”±å™¨åœ¨å­ç½‘1çš„æ¥å£  ----- &gt; è·¯ç”±å™¨åœ¨å­ç½‘2çš„æ¥å£   ------&gt; ç›®çš„ä¸»æœº</p><p><em><strong>å¦‚ä½•ç¡®å®šç›®çš„ä¸»æœºä¸åœ¨å­ç½‘ä¸­ï¼Œä»è€Œå°†è¿™ä¸ªå¸§å‘é€ç»™è·¯ç”±å™¨ï¼Ÿ</strong></em></p><p><em><strong>ARPè¡¨é¡¹åœ¨TTLå†…IPåœ°å€è¿‡æœŸæ€ä¹ˆåŠ</strong></em></p><h4 id="ä»¥å¤ªç½‘">ä»¥å¤ªç½‘</h4><p>Ethernetï¼Œç”±Xeroxã€Intelå’ŒDecå…¬å¸è”åˆå¼€å‘çš„åŸºå¸¦æ€»çº¿å±€åŸŸç½‘è§„èŒƒã€‚ä½¿ç”¨CSMA/CDï¼ˆè½½æ³¢ç›‘å¬å¤šè·¯è®¿é—®åŠå†²çªé¿å…æŠ€æœ¯ï¼‰</p><ul><li>ç›®å‰æœ€æµè¡Œçš„<strong>æœ‰çº¿å±€åŸŸç½‘æŠ€æœ¯</strong>ï¼ˆå³å±€åŸŸç½‘é‡‡ç”¨çš„é€šä¿¡åè®®ï¼‰ï¼Œéå¸¸çš„é‡è¦ï¼ˆé€ ä»·ä½å»‰ï¼ˆç½‘å¡ä¸åˆ°100mbï¼‰ã€ç»„ç½‘æ›´ç®€å•ï¼‰</li><li>ç¬¬ä¸€ä¸ªå¹¿æ³›éƒ¨ç½²çš„é«˜é€Ÿå±€åŸŸç½‘</li><li>æ— è¿æ¥ã€ä¸å¯é ã€å°½æœ€å¤§åŠªåŠ›äº¤ä»˜ï¼›åªå®ç°å·®é”™æ¥æ”¶ï¼Œä¸å®ç°å¯é ä¼ è¾“ï¼ˆå·®é”™å¸§ç›´æ¥ä¸¢å¼ƒï¼‰</li><li>é’ˆå¯¹ç‰©ç†å±‚ã€é“¾è·¯å±‚</li></ul><p>by Bob Metcalfe å’Œ David Boggs 20ä¸–çºª70å¹´ä»£ä¸­æœŸå‘æ˜åˆå§‹çš„ä»¥å±€åŸŸç½‘ï¼Œä½¿ç”¨åŒè½´ç”µç¼†æ€»çº¿æ¥äº’è”èŠ‚ç‚¹ã€‚ä»¥å¤ªç½‘çš„æ€»çº¿æ‹“æ‰‘ä»80å¹´ä»£åˆ°90å¹´ä»£åŸºæœ¬ä¸å˜ï¼Œä½¿ç”¨æ€»çº¿æ‹“æ‰‘çš„ä»¥å¤ªç½‘æ˜¯ä¸€ç§å¹¿æ’­å±€åŸŸç½‘ï¼Œæ‰€æœ‰ä¼ è¾“çš„å¸§ä¼ é€åˆ°ä¸è¯¥æ€»çº¿è¿æ¥çš„æ‰€æœ‰é€‚é…å™¨å¹¶è¢«å¤„ç†ã€‚</p><p>90å¹´ä»£åæœŸï¼Œå¤§å¤šå…¬å¸å’Œå¤§å­¦ä½¿ç”¨åŸºäºé›†çº¿å™¨çš„æ˜Ÿå½¢æ‹“æ‰‘ä»¥å¤ªç½‘æ›¿ä»£å±€åŸŸç½‘ã€‚è¿™ç§ç»“æ„ä¸­ï¼Œä¸»æœºå’Œè·¯ç”±å™¨ç›´æ¥ç”¨åŒç»å¯¹é“œçº¿ä¸ä¸€å°é›†çº¿å™¨é¡¹é“¾ã€‚é›†çº¿å™¨æ˜¯ç‰©ç†å±‚è®¾å¤‡ï¼Œä½œç”¨äºå„ä¸ªæ¯”ç‰¹ã€‚å½“0ã€1æ¯”ç‰¹åˆ°è¾¾ä¸€ä¸ªæ¥å£æ—¶ï¼Œé›†çº¿å™¨åªæ˜¯é‡æ–°ç”Ÿæˆè¿™ä¸ªæ¯”ç‰¹ï¼Œå°†èƒ½é‡å¼ºåº¦æ”¾å¤§ï¼Œå¹¶å°†è¯¥æ¯”ç‰¹å‘æ‰€æœ‰å…¶ä»–æ¥å£ä¼ è¾“å‡ºå»ã€‚å› æ­¤ï¼Œé‡‡ç”¨åŸºäºé›†çº¿å™¨çš„æ˜Ÿå½¢æ‹“æ‰‘çš„ä»¥å¤ªç½‘ä¹Ÿæ˜¯ä¸€ä¸ªå¹¿æ’­å±€åŸŸç½‘ã€‚åŒæ—¶ï¼Œå¦‚æœé›†çº¿å™¨åŒæ—¶ä»ä¸¤ä¸ªä¸åŒæ¥å£æ¥æ”¶åˆ°å¸§ï¼Œä¹Ÿä¼šäº§ç”Ÿç¢°æ’ï¼Œéœ€è¦é‡æ–°ä¼ è¾“ã€‚</p><p>21ä¸–çºªåˆï¼Œé›†çº¿å™¨è¢«äº¤æ¢æœºæ›¿ä»£ï¼Œäº¤äº’æœºæ˜¯æ— ç¢°æ’çš„ï¼Œè¿è¡Œåœ¨ç¬¬äºŒå±‚ï¼ˆè·¯ç”±å™¨åœ¨ç¬¬ä¸‰å±‚ï¼‰ã€‚</p><h5 id="ä»¥å¤ªç½‘å¸§ç»“æ„">ä»¥å¤ªç½‘å¸§ç»“æ„</h5><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211004102312226.png" alt="image-20211004102312226"></p><p>åœºæ™¯ï¼šä¸€å°ä¸»æœºå‘å¦ä¸€å°ç›¸åŒä»¥å¤ªå±€åŸŸç½‘ä¸Šçš„ä¸»æœºå‘é€ä¸€ä¸ªIPæ•°æ®æŠ¥</p><ul><li>æ•°æ®å­—æ®µï¼ˆ46â€“1500å­—èŠ‚ï¼‰ã€‚æ‰¿è½½IPæ•°æ®æŠ¥ï¼Œä»¥å¤ªç½‘çš„æœ€å¤§ä¼ è¾“å•å…ƒMTUæ˜¯1500å­—èŠ‚ï¼ˆè¿‡å¤§å°±è¢«åˆ†ç‰‡ï¼‰ï¼Œæœ€å°é•¿åº¦æ˜¯46å­—èŠ‚ï¼ˆè¿‡å°ä¼šè¢«å¡«å……ï¼‰ï¼Œè¿‡å°æ—¶ï¼Œç½‘ç»œå±‚ä½¿ç”¨IPæ•°æ®æŠ¥é¦–éƒ¨çš„é•¿åº¦å­—æ®µæ¥å»é™¤å¡«å……éƒ¨åˆ†</li><li>ç›®çš„åœ°å€ï¼ˆ6å­—èŠ‚ï¼‰ã€‚åŒ…å«ç›®çš„é€‚é…å™¨çš„MACåœ°å€ï¼Œå½“é€‚é…å™¨æ”¶åˆ°ä¸€ä¸ªä»¥å¤ªç½‘å¸§ï¼Œæ— è®ºæ˜¯è‡ªèº«MACåœ°å€è¿˜æ˜¯MACå¹¿æ’­åœ°å€ï¼Œå®ƒéƒ½å°†è¯¥å¸§çš„æ•°æ®å­—æ®µçš„å†…å®¹ä¼ é€’ç»™ç½‘ç»œå±‚ï¼Œå¦‚æœæ”¶åˆ°å…¶ä»–MACçš„å¸§ï¼Œåˆ™ä¸¢å¼ƒ</li><li>æºåœ°å€ï¼ˆ6å­—èŠ‚ï¼‰ã€‚</li><li>ç±»å‹å­—æ®µï¼ˆ2å­—èŠ‚ï¼‰å…è®¸ä»¥å¤ªç½‘å¤ç”¨å¤šç§ç½‘ç»œå±‚åè®®ï¼Œä¸»æœºèƒ½å¤Ÿä½¿ç”¨é™¤äº†IPä»¥å¤–çš„å…¶ä»–ç½‘ç»œå±‚åè®®ã€‚å³é€‚é…å™¨æ”¶åˆ°ä»¥å¤ªç½‘å¸§æ—¶ï¼Œé€‚é…å™¨å°†å®ƒåº”è¯¥å°†æ•°æ®å­—æ®µçš„å†…å®¹ä¼ é€’åˆ°çš„é‚£ä¸ªç½‘ç»œå±‚åè®®å¯¹åº”ã€‚</li><li>CRCï¼ˆ4å­—èŠ‚ï¼‰ã€‚ä½¿å¾—æ¥å—é€‚é…å™¨æ£€æµ‹ï¼Œå¸§ä¸­æ˜¯å¦å‡ºç°äº†å·®é”™</li><li>å‰åŒæ­¥ç ï¼ˆ8å­—èŠ‚ï¼‰ã€‚ä»¥å¤ªç½‘å¸§ä»¥ä¸€ä¸ª8å­—èŠ‚çš„å‰åŒæ­¥ç å­—æ®µå¼€å§‹ï¼Œå‰7å­—èŠ‚çš„å€¼éƒ½æ˜¯10101010ï¼Œæœ€åä¸€ä¸ªå­—èŠ‚æ˜¯10101011.å‰7å­—èŠ‚ç”¨é€”æ˜¯å”¤é†’ æ¥æ”¶é€‚é…å™¨ï¼Œå¹¶å°†ä»–ä»¬çš„æ—¶é’Ÿå’Œå‘é€æ–¹çš„æ—¶é’ŸåŒæ­¥ã€‚ï¼ˆä¸ºä»€ä¹ˆæœ‰æ—¶é’Ÿä¸åŒæ­¥ç°è±¡ï¼Ÿä»¥å¤ªå±€åŸŸç½‘ç±»å‹ä¸åŒï¼Œç”±10Mbpsã€100Mbpsã€1Gbpsçš„é€Ÿç‡ä¼ è¾“å¸§ï¼‰ã€‚ä½†å‘é€æ–¹é€‚é…å™¨ä¸ä¼šä»¥ç²¾ç¡®çš„é¢å®šé€Ÿç‡ä¼ è¾“å¸§ï¼Œç›¸å¯¹äºé¢å®šé€Ÿç‡è‚¯å®šæœ‰åå·®ï¼Œæ¥æ”¶é€‚é…å™¨åªéœ€è¦é€šè¿‡é”å®šå‰åŒæ­¥ç çš„å‰7å­—èŠ‚çš„æ¯”ç‰¹ï¼Œå°±èƒ½å¤Ÿé”å®šé€‚é…å™¨Açš„æ—¶é’Ÿï¼Œç¬¬8å­—èŠ‚çš„æœ€åä¸¤ä¸ªæ¯”ç‰¹ 1 1ï¼Œ<strong>è­¦å‘Š</strong>é€‚é…å™¨Bï¼Œæ•°æ®å³å°†åˆ°æ¥ã€‚</li></ul><p><strong>ç‰¹ç‚¹</strong></p><ul><li>æ‰€æœ‰çš„ä»¥å¤ªç½‘è®¡æ•°éƒ½å‘ç½‘ç»œå±‚æä¾›æ— è¿æ¥æœåŠ¡ï¼ˆä¸éœ€æ¡æ‰‹ï¼‰</li><li>ä»¥å¤ªç½‘æŠ€æœ¯å‘ç½‘ç»œå±‚æä¾›ä¸å¯é æœåŠ¡ï¼šé€‚é…å™¨æ”¶åˆ°å¸§ï¼Œæ‰§è¡ŒCRCæ ¡éªŒï¼Œä½†è¯¥å¸§é€šè¿‡CRCæ ¡éªŒæ—¶ï¼Œå®ƒæ—¢ä¸å‘é€ç¡®è®¤å¸§ï¼Œæ²¡æœ‰é€šè¿‡CRCæ ¡éªŒä¹Ÿä¸å‘é€å¦å®šå¸§ï¼Œä»…ä»…ä¸¢å¼ƒè¯¥å¸§ã€‚</li><li>ç”±äºä¸¢å¼ƒäº†ä»¥å¤ªç½‘ä½¿å¾—ä¼ é€’åˆ°ç½‘ç»œå±‚çš„æ•°æ®æŠ¥æµæœ‰é—´éš™ï¼Œä¸»æœºBä¸Šçš„åº”ç”¨èƒ½çœ‹åˆ°è¿™ä¸ªé—®é¢˜ç ï¼Ÿå–å†³äºä¸Šå±‚åè®®ï¼ˆUDPã€TCPï¼‰</li></ul><h5 id="ä»¥å¤ªç½‘æŠ€æœ¯">ä»¥å¤ªç½‘æŠ€æœ¯</h5><p>ä¸åŒåè®®</p><p><strong>å†å²</strong></p><p>æ—©æœŸ10BASE-2å’Œ10BASE-5æ ‡å‡†è§„å®šäº†ä¸¤ç§ç±»å‹çš„åŒè½´ç”µç¼†ä¹‹ä¸Šçš„ 10Mbpsçš„ä»¥å¤ªç½‘ï¼Œæ²¡ç§æ ‡å‡†éƒ½é™åˆ¶åœ¨500ç±³é•¿åº¦ä»¥å†…ã€‚é€šè¿‡è½¬å‘å™¨ï¼ˆç‰©ç†è®¾å¤‡ï¼Œåœ¨è¾“å…¥ç«¯æ¥æ”¶ä¿¡å·å¹¶ä¸”åœ¨è¾“å‡ºç«¯å†ç”Ÿä¿¡å·ï¼‰ï¼Œèƒ½å¤Ÿå¾—åˆ°æ›´é•¿çš„è¿è¡Œè·ç¦»ã€‚ä¸€ä¸ªæ¥å£ä¼ è¾“çš„æ‰€æœ‰å¸§å¯åœ¨å…¶ä»–æ¥å£æ”¶åˆ°ï¼Œå¹¶ä¸”ä»¥å¤ªç½‘çš„CSMA/CDåè®®è§£å†³äº†å¤šè·¯è®¿é—®é—®é¢˜ã€‚èŠ‚ç‚¹ç›´æ¥é™„ç€åœ¨ç”µç¼†ä¸Šã€‚</p><p>å¦‚ä»Šï¼ŒèŠ‚ç‚¹ç»è¿‡ç‚¹å¯¹ç‚¹çš„ç”±åŒç»é“œçº¿æˆ–å…‰çº¤ç”µç¼†æ„æˆçš„çº¿æ®µä¸ä¸€å°äº¤æ¢æœºç›¸è¿ã€‚</p><p>90å¹´ä»£ä¸­æœŸï¼Œä»¥å¤ªç½‘è¢«æ ‡å‡†åŒ–ä¸º100Mbpsï¼Œæ›´é«˜é€Ÿç‡çš„ç‰©ç†å±‚è¢«å®šä¹‰ä¸ºç”¨é“œçº¿(100BASE-T)å’Œå…‰çº¤ï¼ˆ100BASE-FXã€100BASE-SXã€100BASE-BXï¼‰ã€‚ç”¨åŒç»é“œçº¿è·ç¦»é™åˆ¶ä¸º100mï¼Œå…‰çº¤è·ç¦»é™åˆ¶ä¸ºå‡ åƒç±³ï¼Œå…è®¸æŠŠä¸åŒå»ºç­‘ç‰©ä¸­çš„ä»¥å¤ªç½‘äº¤æ¢æœºè¿æ¥èµ·æ¥ã€‚</p><p>å‰æ¯”ç‰¹ä»¥å¤ªç½‘æ˜¯å¯¹æä¸ºæˆåŠŸçš„10Mbpså’Œ100Mbpsä»¥å¤ªç½‘æ ‡å‡†çš„æ‰©å±•ã€‚40Gbpsä»¥ä»¥å¤ªç½‘æä¾›40000Mbpsæ€»æ•°æ®é€Ÿç‡ã€‚å‰æ¯”ç‰¹ä»¥å¤ªç½‘æ ‡å‡†ä¸ºIEEE 802.3zï¼Œå®Œæˆä»¥ä¸‹å·¥ä½œï¼š</p><ul><li>æ ‡å‡†ä»¥å¤ªç½‘å¸§æ ¼å¼ï¼Œå¹¶ä¸”å‘åå…¼å®¹10BASE-Tä¸100BASE-T</li><li>å…è®¸ç‚¹å¯¹ç‚¹é“¾è·¯ä»¥åŠå…±äº«çš„å¹¿æ’­ä¿¡é“ï¼Œç‚¹å¯¹ç‚¹é“¾è·¯ä½¿ç”¨äº¤æ¢æœºï¼Œå¹¿æ’­ä¿¡é“ä½¿ç”¨é›†çº¿å™¨ï¼ˆâ€œå¸¦ç¼“å­˜çš„åˆ†é…å™¨â€ï¼‰</li><li>ä½¿ç”¨CSMA/CDæ¥å…±äº«å¹¿æ’­ä¿¡é“</li></ul><p>å‰æ¯”ç‰¹ä»¥å¤ªç½‘æœ€åˆä½œç”¨ä¸å…‰çº¤ä¹‹ä¸Šï¼Œç°åœ¨èƒ½å¤Ÿåœ¨5ç±»UTPçº¿ç¼†ä¸Šã€‚</p><p>åœ¨æ€»çº¿æ‹“æ‰‘å’ŒåŸºäºé›†çº¿å™¨çš„æ˜Ÿå½¢æ‹“æ‰‘å¹´ä»£ï¼Œä»¥å°æ¹¾ç½‘è´­æ˜¯ä¸€ç§å¹¿æ’­é“¾è·¯ï¼Œ ä¼šå‡ºç°ç¢°æ’çš„é—®é¢˜ï¼Œä¸ºäº†å¤„ç†è¿™äº›é—®é¢˜ï¼Œä½¿ç”¨CSMA/CDåè®®ï¼Œå¯¹è·¨è¶Šä¸€ä¸ªå°çš„åœ°ç†åŠå¾„çš„æœ‰çº¿å¹¿æ’­å±€åŸŸç½‘éå¸¸æœ‰æ•ˆã€‚ä½†å¦‚ä»Šä½¿ç”¨çš„æ˜¯ä»¥å¤ªç½‘åŸºäºäº¤æ¢æœºçš„æ˜Ÿå½¢æ‹“æ‰‘ï¼Œé‡‡ç”¨å­˜å‚¨è½¬å‘åˆ†ç»„äº¤æ¢ï¼Œæ˜¯å¦è¿˜éœ€è¦ä¸€ç§ä»¥å¤ªç½‘MACåè®®ï¼Ÿã€ä¸ä¼šã€‚äº¤æ¢æœºåè°ƒä¼ è¾“ï¼Œåœ¨ä»»ä½•æ—¶å€™ä¸ä¼šå‘ç›¸åŒçš„æ¥å£è½¬å‘è¶…è¿‡ä¸€ä¸ª çš„å¸§ï¼Œä¸”ç°ä»£äº¤æ¢æœºæ˜¯å…¨åŒå·¥ï¼Œä½¿å¾—ä¸€å°äº¤æ¢æœºå’Œä¸€ä¸ªèŠ‚ç‚¹åœ¨åŒæ—¶å‘å¯¹æ–¹å‘é€å¸§è€Œæ²¡æœ‰å¹²æ‰°ã€‘</p><h5 id="é“¾è·¯å±‚äº¤æ¢æœº">é“¾è·¯å±‚äº¤æ¢æœº</h5><p>äº¤æ¢æœºå¯¹äºå­ç½‘ä¸­çš„ä¸»æœºå’Œè·¯ç”±å™¨æ˜¯é€æ˜çš„</p><ol><li><p><strong>äº¤æ¢æœºçš„è½¬å‘å’Œè¿‡æ»¤</strong></p><p>è½¬å‘ï¼šå†³å®šä¸€ä¸ªå¸§åº”è¯¥è¢«å¯¼å‘åˆ°å“ªä¸ªæ¥å£ï¼Œå¹¶æŠŠè¯¥å¸§ç§»åŠ¨åˆ°å“ªäº›æ¥å£çš„äº¤æ¢æœºåŠŸèƒ½</p><p>è¿‡æ»¤ï¼šå†³å®šä¸€ä¸ªå¸§åº”è¯¥è½¬å‘åˆ°æŸä¸ªæ¥å£è¿˜æ˜¯åº”å½“å°†å…¶ä¸¢å¼ƒçš„äº¤æ¢æœºåŠŸèƒ½</p><p>è½¬å‘å’Œè¿‡æ»¤å€ŸåŠ©äºäº¤æ¢æœºè¡¨å®Œæˆï¼ŒåŒ…å«ï¼š</p><ul><li>ä¸€ä¸ªMACåœ°å€</li><li>é€šå‘è¯¥MACåœ°å€çš„äº¤æ¢æœºæ¥å£</li><li>è¡¨é¡¹é˜²æ­¢åœ¨è¡¨ä¸­çš„æ—¶é—´</li></ul><p>P.313 ä¸‰ç§æƒ…å†µï¼šç›¸åŒå±€åŸŸç½‘ï¼ˆè¿‡æ»¤ï¼‰ã€è¡¨ä¸­æŸ¥ä¸åˆ°ï¼ˆå¹¿æ’­ï¼‰ã€è¡¨ä¸­æœ‰ä¸åŒæ¥å£çš„è¡¨é¡¹ï¼ˆè½¬å‘ï¼‰</p><p>ä½†ä¸€å¼€å§‹äº¤æ¢æœºè¡¨æ˜¯å¦‚ä½•é…ç½®çš„ï¼Ÿ</p></li><li><p><strong>è‡ªå­¦ä¹ </strong></p><p>äº¤äº’æœºçš„è¡¨æ˜¯è‡ªåŠ¨ã€åŠ¨æ€å’Œè‡ªæ²»å»ºç«‹çš„ï¼Œæ²¡æœ‰æ¥è‡ªç½‘ç»œç®¡ç†å‘˜æˆ–ä»»ä½•é…ç½®åè®®çš„ä»»ä½•å¹²é¢„ã€‚</p><ul><li>äº¤æ¢æœºè¡¨åˆå§‹ä¸ºç©º</li><li>åœ¨æ¯ä¸ªæ¥å£æ¥æ”¶åˆ°çš„æ¯ä¸ªå…¥å¸§ï¼Œäº¤äº’æœºåœ¨è¡¨ä¸­èƒ½å¤Ÿå­˜å‚¨ï¼š<ol><li>è¯¥å¸§æºåœ°å€å­—æ®µä¸­çš„MACåœ°å€</li><li>å¸§åˆ°è¾¾çš„æ¥å£</li><li>å½“å‰æ—¶é—´</li></ol></li><li>å¦‚æœåœ¨ä¸€æ®µæ—¶é—´ï¼ˆè€åŒ–æœŸï¼‰åï¼Œäº¤æ¢æœºæ²¡æœ‰æ¥æ”¶åˆ°ä»¥è¯¥åœ°å€ä½œä¸ºæºåœ°å€çš„å¸§ï¼Œ å°±åœ¨è¡¨ä¸­åˆ é™¤è¿™ä¸ªåœ°å€ã€‚</li></ul><p>äº¤æ¢æœºæ˜¯<strong>å³æ’å³ç”¨</strong>è®¾å¤‡</p></li><li><p><strong>é“¾è·¯å±‚äº¤æ¢æœºçš„æ€§è´¨</strong></p><p>ä¸åŒäºæ€»çº¿æ‹“æ‰‘å’ŒåŸºäºé›†çº¿å™¨çš„æ˜Ÿå½¢æ‹“æ‰‘é‚£æ ·çš„å¹¿æ’­é“¾è·¯ï¼š</p><ul><li>æ¶ˆé™¤ç¢°æ’ã€‚ä½¿ç”¨äº¤æ¢æœºæ„å»ºçš„å±€åŸŸç½‘ä¸­ï¼Œæ²¡æœ‰å› ç¢°æ’è€Œæ„æˆçš„å¸¦å®½ï¼Œäº¤æ¢æœºç¼“å­˜å¸§ä¸ä¼šåœ¨ç½‘æ®µä¸ŠåŒæ—¶ä¼ è¾“å¤šäºä¸€ä¸ªå¸§ã€‚äº¤æ¢æœºçš„æœ€å¤§èšåˆå¸¦å®½æ˜¯äº¤æ¢æœºæ‰€æœ‰æ¥å£é€Ÿç‡ä¹‹å’Œï¼Œæ€§èƒ½æ›´é«˜</li><li>å¼‚è´¨çš„é“¾è·¯ã€‚äº¤æ¢æœºå°†é“¾è·¯å½¼æ­¤éš”ç¦»ï¼Œå±€åŸŸç½‘ä¸­ä¸åŒé“¾è·¯èƒ½å¤Ÿä»¥ä¸åŒçš„ é€Ÿç‡è¿è¡Œå¹¶åœ¨ä¸åŒçš„åª’ä½“ä¸Šè¿è¡Œ</li><li>ç®¡ç†ã€‚äº¤æ¢æœºèƒ½æ£€æµ‹å¾—åˆ°é€‚é…å™¨å¼‚å¸¸å·¥ä½œæƒ…å†µï¼ˆæŒç»­å‘é€å¸§ï¼‰ï¼Œåœ¨å†…éƒ¨ä¼šæ–­å¼€ å¼‚å¸¸é€‚é…å™¨ã€‚äº¤æ¢æœºä¹Ÿæ”¶é›†å¸¦å®½ä½¿ç”¨çš„ ç»Ÿè®¡æ•°æ®ã€ç¢°æ’ç‡ç­‰æ•°æ®ã€‚ã€‚</li></ul><p>å¯¹æŠ—äº¤æ¢æœºï¼šäº¤æ¢æœºæ¯’åŒ–ã€‚å‘äº¤æ¢æœºå‘é€å¤§é‡çš„å…·æœ‰ä¸åŒä¼ªé€ æºMACåœ°å€çš„åˆ†ç»„ï¼Œä¼ªé€ è¡¨é¡¹å¡«æ»¡äº†äº¤æ¢æœºè¡¨ï¼Œæ²¡æœ‰ä¸ºåˆæ³•çš„ä¸»æœºç•™ä¸‹ç©ºé—´ã€‚</p></li><li><p>äº¤æ¢æœºå’Œè·¯ç”±å™¨æ¯”è¾ƒ</p><p>äº¤æ¢æœºï¼šç¬¬äºŒå±‚åˆ†ç»„äº¤æ¢æœºï¼Œä½¿ç”¨MACåœ°å€è½¬å‘åˆ†ç»„</p><p>è·¯ç”±å™¨ï¼šç¬¬ä¸‰å±‚åˆ†ç»„äº¤æ¢æœºï¼Œä½¿ç”¨ç½‘ç»œå±‚åœ°å€è½¬å‘åˆ†ç»„</p><p>å„è‡ªä¼˜ç¼ºç‚¹ï¼š</p><p><strong>TODO</strong></p><p>ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ä»€ä¹ˆæœºå™¨ï¼Ÿ</p><p>å‡ ç™¾å°ä¸»æœºç»„æˆçš„å°ç½‘ç»œ      -------- äº¤æ¢æœºï¼ˆå› ä¸ºä¸è¦æ±‚IPåœ°å€çš„ä»»ä½•é…ç½®å°±èƒ½ä½¿å¾—æµé‡å±€éƒ¨åŒ–å¹¶ä¸”å¢åŠ æ€»è®¡ååé‡ï¼‰</p><p>å‡ åƒå°ä¸»æœºç»„æˆçš„æ›´å¤§ç½‘ç»œ   -----äº¤æ¢æœº+è·¯ç”±å™¨ï¼Œè·¯ç”±å™¨æä¾›æ›´å¥å£®çš„æµé‡éš”ç¦»æ–¹å¼å’Œå¯¹å¹¿æ’­é£æš´çš„æ§åˆ¶ã€‚</p></li></ol><h5 id="è™šæ‹Ÿå±€åŸŸç½‘">è™šæ‹Ÿå±€åŸŸç½‘</h5><p>ä»¥ä¸Šç½‘ç»œç»“æ„çš„ç¼ºç‚¹ï¼š</p><ul><li>ç¼ºä¹æµé‡éš”ç¦»ã€‚å°½ç®¡ç»„æµé‡è¢«å±€åŸŸåŒ–åˆ°ä¸€ä¸ªå•ä¸€çš„äº¤æ¢æœºä¸­ï¼Œä½†å¹¿æ’­æµé‡ï¼ˆä¾‹å¦‚ARPå’ŒDHCPæŠ¥æ–‡æˆ–é‚£äº›ç›®çš„åœ°è¿˜æ²¡æœ‰è¢«äº¤æ¢æœºå­¦ä¹ åˆ°çš„å¸§ï¼‰ä»ç„¶éœ€è¦è·¨è¶Šæ•´ä¸ªæœºæ„ç½‘ç»œï¼Œåˆæ˜¯å¯èƒ½ä¸ºäº†éšç§çš„ç›®çš„éœ€è¦é™åˆ¶å±€åŸŸç½‘å¹¿æ’­çš„æµé‡</li><li>äº¤æ¢æœºçš„æ— æ•ˆä½¿ç”¨ã€‚å¦‚æœè¯¥æœºæ„æœ‰è®¸å¤šä¸ªç»„ï¼Œåˆ™æ¯ä¸ªç»„éƒ½å¿…é¡»æœ‰ä¸€ä¸ªä¸€çº§äº¤æ¢æœºï¼Œä½†æ¯ä¸ªç»„äººæ•°å°‘ï¼Œåˆ™å•å°96ç«¯å£çš„çš„äº¤æ¢æœºå°±å¤Ÿäº†ï¼Œä½†å¹¶ä¸èƒ½æä¾›æµé‡éš”ç¦»</li><li>ç®¡ç†ç”¨æˆ· ï¼Œå¦‚æœä¸€ä¸ªé›‡å‘˜åœ¨ä¸åŒç»„ä»¶ç§»åŠ¨ï¼Œå¿…é¡»æ”¹å˜ç‰©ç†å¸ƒçº¿ï¼Œå°†è¯¥é›‡å‘˜è¿æ¥åˆ°ä¸åŒçš„äº¤äº’æœºä¸Š</li></ul><p>è§£å†³æ–¹æ¡ˆï¼š<strong>è™šæ‹Ÿå±€åŸŸç½‘</strong>ï¼ˆVLANï¼‰</p><p>æ”¯æŒVLANçš„äº¤äº’åŠå…è®¸ç»è¿‡ä¸€ä¸ªå•ä¸€çš„ç‰©ç†å±€åŸŸç½‘çš„åŸºç¡€è®¾æ–½å®šä¹‰å¤šä¸ªVLANï¼Œåœ¨ä¸€ä¸ªVLANå†…çš„ä¸»æœºå½¼æ­¤é€šä¿¡ã€‚åœ¨ä¸€ä¸ªåŸºäºç«¯å£çš„VLANä¸­ï¼Œäº¤æ¢æœºçš„ç«¯å£ç”±ç®¡ç†å‘˜åˆ’åˆ†ä¸ºç»„ã€‚æ¯ä¸ªç»„æ„æˆä¸€ä¸ªVLANï¼Œæ¯ä¸ªVLANä¸­çš„ç«¯å£å½¢æˆä¸€ä¸ªå¹¿æ’­åŸŸï¼ˆå³æ¥è‡ªä¸€ä¸ªç«¯å£çš„å¹¿æ’­æµé‡ä»…èƒ½åˆ°è¾¾è¯¥ç»„ä¸­çš„å…¶ä»–ç«¯å£ï¼‰ã€‚</p><p>åªéœ€è¦åœ¨äº¤æ¢æœºä¸­ç»´æŠ¤ä¸€å¼ ç«¯å£åˆ°VLANçš„æ˜ å°„è¡¨ï¼Œäº¤æ¢æœºè½¯ä»¶ä»…åœ¨å±äºç›¸åŒVLANçš„ç«¯å£ä¹‹é—´äº¤ä»˜å¸§</p><p><em>ä½†ï¼Œä¸åŒçš„VLANä¸­çš„ä¸»æœºå¦‚ä½•äº¤äº’ï¼Ÿ</em></p><p>ä¸€ç§æ–¹å¼ï¼šVLANäº¤æ¢æœºçš„ä¸€ä¸ªç«¯å£ä¸ä¸€å°å¤–éƒ¨è·¯ç”±å™¨ç›¸è¿ã€‚è·¯ç”±å™¨çš„ç«¯å£é…ç½®ä¸ºæƒ³äº¤äº’çš„å‡ ä¸ªä¸»æœºã€‚è·¯ç”±å™¨ç­‰äºåšäº†ä¸€ä¸ªä¸­é—´äººã€‚</p><p><em>å¤šå°äº¤æ¢æœº å¦‚ä½•äº’è”ï¼Ÿ</em></p><p>VLANå¹²çº¿è¿æ¥ï¼Œæ¯ä¸ªäº¤æ¢æœºä¸Šæœ‰ä¸€ä¸ªç‰¹æ®Šç«¯å£è¢«é…ç½®ä¸ºå¹²çº¿ç«¯å£ï¼Œè¿™ä¸ªç«¯å£ä¸å±äºæŸä¸€ä¸ªVLLANï¼Œè€Œå±äºæ‰€æœ‰çš„VLANï¼Œå‘é€åˆ°ä»»ä½•vLANçš„å¸§å¿…é¡»è¦ç»è¿‡å¹²çº¿é“¾è·¯è½¬å‘åˆ°å…¶ä»–äº¤æ¢æœºã€‚</p><p><em>äº¤æ¢æœºæ€ä¹ˆçŸ¥é“åˆ°è¾¾å¹²çº¿ç«¯å£çš„å¸§å±äºæŸä¸ªç‰¹å®šçš„VLANï¼Ÿ</em></p><p>IEEEå®šä¹‰äº†ä¸€ç§æ‰©å±•åˆ°è¾¾ä»¥å¤ªç½‘å¸§æ ¼å¼ï¼š802.1Qï¼Œè·¨è¶Š VLANå¹²çº¿çš„å¸§ã€‚æ ‡å‡†çš„ä»¥å¤ªç½‘å¸§ + åŠ è¿›é¦–éƒ¨çš„4å­—èŠ‚VLANæ ‡ç­¾ï¼ŒVLANæ ‡ç­¾æ‰¿è½½ç€è¯¥å¸§æ‰€å±çš„ VLANæ ‡è¯†ç¬¦ã€‚VLAN tagç”±åœ¨VLANå¹²çº¿å‘é€ä¾§çš„äº¤æ¢æœºåŠ è¿›å¸§ä¸­ï¼Œè§£æåå¹¶ç”±åœ¨VLANå¹²çº¿æ¥æ”¶æ–¹çš„äº¤æ¢æœºåˆ é™¤ã€‚</p><p>VLAN tagï¼š</p><ul><li>ä¸€ä¸ª2å­—èŠ‚çš„æ ‡ç­¾åè®®æ ‡è¯†ç¬¦ï¼ˆTag Protocol Identifier ,TYIDï¼‰å­—æ®µï¼ˆå…·æœ‰å›ºå®šçš„åå…­è¿›åˆ¶å€¼ï¼‰</li><li>ä¸€ä¸ª2å­—èŠ‚çš„æ ‡ç­¾æ§åˆ¶ä¿¡æ¯å­—æ®µï¼ˆåŒ…å«ä¸€ä¸ª12bitçš„VLANæ ‡è¯†å­—æ®µï¼‰</li><li>ä¸€ä¸ª3æ¯”ç‰¹çš„ä¼˜å…ˆæƒå­—æ®µï¼ˆç±»ä¼¼IPæ•°æ®æŠ¥TOSå­—æ®µï¼‰</li></ul><p>VLANå¯ä»¥åŸºäºç«¯å£ä¹Ÿå¯ä»¥ç»“ä½™MACåœ°å€ã€ç½‘ç»œå±‚åè®®ç­‰è¿›è¡Œå®šä¹‰ã€‚</p><h3 id="é“¾è·¯è™šæ‹ŸåŒ–ï¼šç½‘ç»œå±‚ä½œä¸ºé“¾è·¯å±‚">é“¾è·¯è™šæ‹ŸåŒ–ï¼šç½‘ç»œå±‚ä½œä¸ºé“¾è·¯å±‚</h3><p>è¿æ¥ä¸¤å°ä¸»æœºçš„é“¾è·¯æ˜¯ç”µè¯ç½‘ï¼Œç”±è‡ªå·±çš„ç”¨äºæ•°æ®ä¼ è¾“å’Œä¿¡ä»¤çš„äº¤æ¢æœºã€é“¾è·¯å’Œåè®®æ ˆã€‚ç„¶è€Œï¼Œä»é“¾è·¯å±‚ çš„è§‚ç‚¹çœ‹ï¼Œé€šè¿‡ç”µè¯ç½‘çš„æ‹¨å·è¿æ¥è¢«çœ‹åšæˆæ˜¯ä¸€æ ¹ç®€å•çš„çº¿è·¯ã€‚è¿™ä¸ªæ„ä¹‰ä¸Šï¼Œå› ç‰¹ç½‘è™šåŒ–äº†ç”µè¯ç½‘ï¼Œå°†å…¶çœ‹æˆæ˜¯ä¸¤å°å› ç‰¹ç½‘ä¸»æœºä¹‹é—´æä¾›é“¾è·¯å±‚è¿æ¥çš„é“¾è·¯å±‚æŠ€æœ¯ã€‚</p><h4 id="MPLS">MPLS</h4><p><strong>å¤šåè®®æ ‡ç­¾äº¤æ¢</strong> ï¼š æ”¹å–„IPè·¯ç”±å™¨çš„è½¬å‘é€Ÿåº¦ã€‚å›ºå®šé•¿åº¦æ ‡ç­¾ã€‚</p><p>ç›®æ ‡ï¼šå¯¹äºåŸºäºå›ºå®šé•¿åº¦æ ‡ç­¾å’Œè™šç”µè·¯çš„æŠ€æœ¯ï¼Œåœ¨ä¸æ”¾å¼ƒåŸºäºç›®çš„åœ°IPæ•°æ®æŠ¥è½¬å‘çš„åŸºç¡€è®¾æ–½çš„å‰æä¸‹ï¼Œå½“å¯èƒ½æ—¶é€šè¿‡é€‰æ‹©æ€§åœ°æ ‡è¯†æ•°æ®æŠ¥å¹¶å…è®¸è·¯ç”±å™¨åŸºäºå›ºå®šé•¿åº¦çš„æ ‡ç­¾è½¬å‘æ•°æ®æŠ¥æ¥å¢å¼ºå…¶åŠŸèƒ½ã€‚ï¼ˆè¯¥æŠ€æœ¯ä¸IPååŒå·¥ä½œï¼Œä½¿ç”¨IPå¯»å€å’Œè·¯ç”±é€‰æ‹©ï¼‰</p><p>MPLSé¦–éƒ¨ï¼Œä½äºç¬¬äºŒå±‚é¦–éƒ¨å’Œç¬¬ä¸‰å±‚é¦–éƒ¨ä¹‹é—´ã€‚</p><p>å­—æ®µï¼šæ ‡ç­¾ï¼›é¢„ç•™çš„3bitå®éªŒå­—æ®µï¼›1bit Så­—æ®µï¼Œç”¨äºæŒ‡ç¤ºä¸€äº›åˆ—æˆæ ˆçš„MPLSé¦–éƒ¨çš„ç»“æŸï¼›å¯¿å‘½å­—æ®µ</p><p>ä¸€ä¸ªMPLSä½¿èƒ½çš„è·¯ç”±å™¨å¸¸è¢«ç§°ä¸º<strong>æ ‡ç­¾äº¤æ¢è·¯ç”±å™¨</strong></p><p>ä¸€ä¸ªMPLSåŠ å¼ºçš„å¸§ä»…èƒ½åœ¨ä¸¤ä¸ªå‡ä¸ºæ ‡ç­¾äº¤æ¢è·¯ç”±å™¨ä¹‹é—´è½¬å‘ï¼ˆæ™®é€šçš„è·¯ç”±å™¨è¯†åˆ«ä¸äº†MPLSé¦–éƒ¨ï¼‰ï¼Œåœ¨è½¬å‘è¡¨ä¸­æŸ¥æ‰¾MPLSæ ‡ç­¾ï¼Œç«‹å³å°†æ•°æ®æŠ¥ä¼ é€’ç»™é€‚å½“çš„è¾“å‡ºæ¥å£æ¥è½¬å‘MPLSå¸§ã€‚å› æ­¤ï¼Œæ ‡ç­¾äº¤æ¢è·¯ç”±å™¨ä¸éœ€è¦æå–ç›®çš„IPåœ°å€å’Œåœ¨è½¬å‘è¡¨ä¸­æ‰§è¡Œæœ€é•¿å‰ç¼€åŒ¹é…çš„æŸ¥æ‰¾ã€‚<em>è·¯ç”±å™¨å¦‚ä½•çŸ¥é“å®ƒçš„é‚»å±…æ˜¯å¦æ˜¯æ ‡ç­¾äº¤æ¢è·¯ç”±å™¨ï¼Ÿ</em></p><p>MPLSåŸºäºæ ‡ç­¾æ‰§è¡Œäº¤æ¢ï¼Œä½¿å¾—è·¯ç”±å™¨ä¸æ¥è§¦IPé¦–éƒ¨ï¼Œç„¶è€Œå…¶çœŸæ­£çš„ä¼˜ç‚¹å¹¶ä¸åœ¨äºäº¤æ¢é€Ÿåº¦çš„æ½œåœ¨å¢åŠ ã€‚è€Œæ˜¯MPLSä½¿èƒ½çš„æ–°çš„<strong>æµé‡ç®¡ç†èƒ½åŠ›</strong>ã€‚MPLSæä¾›äº†æ²¿ç€å¤šæ¡è·¯ç”±è½¬å‘åˆ†ç»„çš„åŠŸèƒ½ï¼Œä½†å¦‚æœä½¿ç”¨IPæ ‡å‡†è·¯ç”±åè®®è¿™äº›è·¯ç”±å°†æ˜¯ä¸å¯èƒ½çš„ --------- <strong>æµé‡å·¥ç¨‹</strong>ï¼Œç½‘ç»œè¿è¡Œç€èƒ½å¤Ÿè¶…è¶Šæ™®é€šçš„IPè·¯ç”±é€‰æ‹©ï¼Œè¿«ä½¿æŸäº›æµé‡æ²¿ç€ä¸€æ¡è·¯å¾„æœç€ç»™å®šçš„ç›®çš„åœ°å¼•å¯¼ã€‚</p><p>MPLSè¿˜å¯è¢«ç”¨äºå®ç°<strong>è™šæ‹Ÿä¸“ç”¨ç½‘</strong>ï¼ˆVPNï¼‰ï¼Œåœ¨ä¸ºç”¨æˆ·å®ç°ä¸€ä¸ªVPNRçš„è¿‡ç¨‹ä¸­ï¼ŒISRä½¿ç”¨å®ƒçš„MPLSä½¿èƒ½ç½‘ç»œå°†ç”¨æˆ·çš„å„ç§ç½‘ç»œè¿æ¥åœ¨ä¸€èµ·ï¼ŒMPLSå°†èµ„æºå’Œç”±ç”¨æˆ·çš„VPNæ‰€ä½¿ç”¨æ¬§å† çš„å¯»å€æ–¹å¼ç›¸éš”ç¦»ï¼Œå…¶ä»–ç”¨æˆ·åˆ©ç”¨è¯¥VPNè·¨è¶Šè¯¥ISPç½‘ç»œ</p><h3 id="æ•°æ®ä¸­å¿ƒç½‘ç»œ">æ•°æ®ä¸­å¿ƒç½‘ç»œ</h3><p>æ•°æ®ç½‘ç»œä¸­å¿ƒå†…éƒ¨ä¸»æœºå½¼æ­¤äº’è”å¹¶ä¸”ä¸å› ç‰¹ç½‘ä¸­çš„æ•°æ®äº’è”ã€‚</p><p>æ•°æ®ä¸­å¿ƒä¸­çš„ä¸»æœºè¢«ç§°ä¸º åˆ€ç‰‡ï¼Œä¸€èˆ¬æ˜¯åŒ…æ‹¬CPUã€å†…å­˜å’Œç£ç›˜å­˜å‚¨çš„å•†ç”¨ä¸»æœºï¼Œæ¯20-40ä¸ªä¸»æœºå æ”¾åœ¨æœºæ¶ä¸Šï¼Œæ¯ä¸ªæœºæ¶é¡¶éƒ¨æœ‰ä¸€å°äº¤æ¢æœºï¼ˆæœºæ¶é¡¶éƒ¨äº¤æ¢æœºï¼ŒTORäº¤æ¢æœºï¼ŒTop Of Rackï¼‰ï¼Œä¸æœºæ¶ä¸Šçš„ä¸»æœºäº’è”ï¼Œå¹¶ä¸æ•°æ®ä¸­å¿ƒä¸­çš„å…¶ä»–äº¤æ¢æœºäº’è”ã€‚[ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯å°æœºæ¶ä¸Šçš„æ¯å°ä¸»æœºéƒ½æœ‰ä¸€å—ä¸TORäº¤æ¢æœºè¿æ¥çš„ç½‘å¡ï¼Œæ¯å°TORäº¤æ¢æœºæœ‰é¢å¤–çš„ç«¯å£èƒ½å¤Ÿä¸å…¶ä»–TORäº¤æ¢æœºè¿æ¥]</p><p>æ•°æ®ä¸­å¿ƒç½‘ç»œæ”¯æŒä¸¤ç§ç±»å‹çš„æµé‡ï¼š</p><ul><li><p>åœ¨å¤–éƒ¨å®¢æˆ·ä¸å†…éƒ¨ä¸»æœºä¹‹é—´æµåŠ¨çš„æµé‡</p><p>æ•°æ®ä¸­å¿ƒç½‘ç»œåŒ…æ‹¬äº† ä¸€å°æˆ–è€…å¤šå°<strong>è¾¹ç•Œè·¯ç”±å™¨</strong>ï¼Œå°†æ•°æ®ä¸­å¿ƒç½‘ç»œä¸å…¬å…±å› ç‰¹ç½‘ç›¸è¿.æ•°æ®ä¸­å¿ƒç½‘ç»œå› æ­¤éœ€è¦æ‰€æœ‰æœºæ¶å½¼æ­¤äº’è”ï¼Œå°†æœºæ¶ä¸è¾¹ç•Œè·¯ç”±å™¨è¿æ¥ã€‚</p></li><li><p>å†…éƒ¨ä¸»æœºä¹‹é—´æµåŠ¨çš„æµé‡</p></li></ul><h4 id="1-è´Ÿè½½å‡è¡¡">1. è´Ÿè½½å‡è¡¡</h4><p>æ•°æ®ä¸­å¿ƒå†…éƒ¨ ï¼Œå¤–éƒ¨è¯·æ±‚é¦–å…ˆè¢«å®šå‘åˆ°ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨ï¼Œï¼ˆä»»åŠ¡ï¼šå‘è¿™ä¸ªç”¨æˆ·åˆ†å‘è¯·æ±‚ï¼Œä»¥ä¸»æœºå½“å‰çš„è´Ÿè½½ä½œä¸ºå‡½æ•°æ¥åœ¨ä¸»æœºä¹‹é—´å‡è¡¡è´Ÿè½½ï¼‰ï¼Œä¸€ä¸ªå¤§å‹çš„æ•°æ®ä¸­å¿ƒé€šå¸¸æœ‰å‡ å°å‡è¡¡è´Ÿè½½å™¨ï¼Œæ¯å°æœåŠ¡äºä¸€ç»„ç‰¹å®šçš„äº‘åº”ç”¨ã€‚</p><p>è´Ÿè½½å‡è¡¡å™¨åŸºäºåˆ†ç»„çš„ç›®çš„ç«¯å£å·ä»¥åŠç›®çš„IPåœ°å€åšå†³ç­–ï¼Œæ‰€ä»¥ç»å¸¸è¢«ç§°ä¸º<strong>ç¬¬å››å±‚äº¤æ¢æœº</strong></p><p>å¤–éƒ¨è¯·æ±‚ ----&gt; è´Ÿè½½å‡è¡¡å™¨ ----&gt; ç‰¹å®šå¤„ç†ä¸»æœº ----&gt;å¤„ç†å®Œæˆå ----&gt; å›é€å“åº”ç»™è´Ÿè½½å‡è¡¡å™¨ ----&gt; è´Ÿè½½å‡è¡¡å™¨ä¸­ç»§å‘é€å›å¤–éƒ¨å®¢æˆ·ã€‚</p><p>è¿˜æä¾›NATç±»ä¼¼åŠŸèƒ½ï¼Œå°†å¤–éƒ¨IPåœ°å€è½¬æ¢ä¸ºåˆé€‚çš„å†…éƒ¨ä¸»æœºIPåœ°å€ï¼Œé˜²æ­¢å®¢æˆ·ç›´æ¥æ¥è§¦ä¸»æœºã€‚</p><h4 id="2-ç­‰çº§ä½“ç³»ç»“æ„">2. ç­‰çº§ä½“ç³»ç»“æ„</h4><p>æ•°åƒå°ä¸»æœºçš„å°å‹æ•°æ®ä¸­å¿ƒï¼Œä¸€å°è¾¹ç•Œè·¯ç”±å™¨ã€ä¸€å°è´Ÿè½½å‡è¡¡å™¨ã€å‡ åä¸ªæœºæ¶ã€å•ä¸€ä»¥å¤ªç½‘äº¤æ¢æœºå°±okã€‚ä½†ä¸»æœºè§„æ¨¡æ‰©å¢åˆ°å‡ ä¸‡ã€åå‡ ä¸‡æ€ä¹ˆåŠï¼Ÿ</p><p>æ•°æ®ä¸­å¿ƒåº”ç”¨<strong>è·¯ç”±å™¨å’Œäº¤æ¢æœºç­‰çº§ç»“æ„</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211002150129091.png" alt="image-20211002150129091"></p><ul><li>æ¯å¤ªç¬¬ä¸€å±‚äº¤æ¢æœºä¸å¤šå°ç¬¬äºŒå±‚äº¤æ¢æœºå’Œä¸€å°è´Ÿè½½å‡è¡¡å™¨ç›¸è¿ã€‚</li><li>æ¯å°ç¬¬äºŒå±‚äº¤æ¢æœºé€šè¿‡å¤šä¸ªæœºæ¶çš„TORäº¤æ¢æœºï¼ˆç¬¬ä¸‰å±‚äº¤æ¢æœºï¼‰ä¸å¤šä¸ªæœºæ¶ç›¸è¿</li></ul><p>é—®é¢˜ï¼šå­˜åœ¨ä¸»æœºåˆ°ä¸»æœºå®¹é‡å—é™åˆ¶çš„é—®é¢˜ P.324</p><h4 id="3-æ•°æ®ä¸­å¿ƒç½‘ç»œçš„å‘å±•è¶‹åŠ¿">3. æ•°æ®ä¸­å¿ƒç½‘ç»œçš„å‘å±•è¶‹åŠ¿</h4><p>ä¸ºé™ä½æ•°æ®ä¸­å¿ƒçš„è´¹ç”¨ï¼ŒåŒæ—¶æé«˜åœ¨æ—¶å»¶å’Œååé‡ä¸Šçš„æ€§èƒ½çš„æ–¹æ¡ˆ</p><p>éƒ¨ç½²èƒ½å¤Ÿå®¢æœä¼ ç»Ÿç­‰çº§è®¾è®¡ç¼ºé™·çš„æ–°å‹äº’è”ä½“ç³»ç»“æ„å’Œç½‘ç»œåè®®çš„ä¸¤ç§æ–¹æ³•</p><p><strong>1. å…¨è¿æ¥æ‹“æ‰‘</strong></p><p>æ›¿ä»£äº¤æ¢æœºå’Œè·¯ç”±å™¨çš„ç­‰çº§ç»“æ„</p><p>æ¯å°ç¬¬ä¸€å±‚äº¤æ¢æœºéƒ½ä¸<strong>æ‰€æœ‰</strong>çš„ç¬¬äºŒå±‚äº¤æ¢æœºç›¸è¿</p><ul><li>ä¸»æœºåˆ°ä¸»æœºçš„æµé‡ç»ä¸ä¼šè¶…è¿‡äº¤æ¢æœºå±‚æ¬¡</li><li>å¯¹äºnå¤ªç¬¬ä¸€å±‚äº¤æ¢æœºï¼Œåœ¨ä»»æ„ä¸¤å°äºŒå±‚äº¤æ¢æœºä¹‹é—´æœ‰næ¡ä¸å‘äº¤çš„è·¯å¾„</li><li>æ˜¾è‘—æ”¹å–„ä¸»æœºåˆ°ä¸»æœºä¹‹é—´çš„å®¹é‡ã€‚ï¼ˆå¯ä»¥èµ°çš„è·¯å˜å¤šäº†ï¼‰</li></ul><p><strong>2. æ¨¡å—åŒ–æ•°æ®ä¸­å¿ƒï¼ˆMDCï¼‰</strong></p><p>æ¯ä¸ªé›†è£…ç®±ç”±æ•°åƒå°ä¸»æœºã€å †æ”¾åœ¨æ•°åå°æœºæ¶ä¸Šï¼Œç´§å¯†æ’åˆ—ï¼Œæ•°æ®ä¸­å¿ƒä½ç½®ï¼Œå¤šä¸ªé›†è£…ç®±å½¼æ­¤äº’è”ï¼Œä¹Ÿå’Œå› ç‰¹ç½‘è¿æ¥ã€‚ä½†é€šå¸¸é›†è£…ç®±éš¾ä»¥æ£€ä¿®ï¼Œå½“ç»„ä»¶å‡ºç°æ•…éšœæ—¶ï¼Œé›†è£…ç®±ç»§ç»­è¿è¡Œä½†æ€§èƒ½ä¸‹é™ã€‚å½“è®¸å¤šç»„ä»¶å‡ºç°æ•…éšœå¹¶ä¸”æ€§èƒ½è¿‡ä½æ—¶ï¼Œå°†ä¼šæ›¿æ¢ã€‚</p><h3 id="å›é¡¾ï¼šWebé¡µé¢è¯·æ±‚è¿‡ç¨‹">å›é¡¾ï¼šWebé¡µé¢è¯·æ±‚è¿‡ç¨‹</h3><p>ä¸€å®šå›é¡¾çœ‹ä¹¦ä¸Šçš„ä¸¾ä¾‹ï¼Œååˆ†çš„å…¨é¢ P.329</p><h2 id="æ— çº¿ç½‘ç»œå’Œç§»åŠ¨ç½‘ç»œ">æ— çº¿ç½‘ç»œå’Œç§»åŠ¨ç½‘ç»œ</h2><h3 id="æ¦‚è¿°-v9">æ¦‚è¿°</h3><p>æ— çº¿ä¸»æœºï¼šä¾¿æºæœºã€æŒä¸Šæœºã€æ™ºèƒ½æ‰‹æœºâ€¦</p><p>æ— çº¿é“¾è·¯ï¼šä¸»æœºé€šè¿‡æ— çº¿é€šä¿¡é“¾è·¯è¿æ¥åˆ°ä¸€ä¸ªåŸºç«™æˆ–è€…å¦ä¸€å°æ— çº¿ä¸»æœºï¼Œä¸åŒçš„æ— é™è¿è·¯æŠ€æœ¯å…·æœ‰ä¸åŒçš„ä¼ è¾“é€Ÿç‡ã€èƒ½å¤Ÿä¼ è¾“ä¸åŒçš„è·ç¦»</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211002153624811.png" alt="image-20211002153624811"></p><p>åŸºç«™ï¼šæ— çº¿ç½‘ç»œåŸºç¡€è®¾æ–½ï¼Œè´Ÿè´£å‘ä¸ä¹‹å…³è”çš„æ— çº¿ä¸»æœºå‘é€æ•°æ®ã€å¹¶ä»ä¸»æœºæ¥æ”¶æ•°æ®ã€‚é€šå¸¸è´Ÿè´£åè°ƒä¸ä¹‹ç›¸å…³è”çš„å¤šä¸ªæ— çº¿ä¸»æœºçš„ä¼ è¾“ã€‚</p><p>ä¸€å°æ— çº¿ä¸»æœºä¸æŸåŸºç«™ç›¸å…³è”ï¼š</p><ul><li>ä¸»æœºä½äºåŸºç«™çš„æ— çº¿é€šä¿¡è¦†ç›–èŒƒå›´å†…ã€‚</li><li>ä¸»æœºä½¿ç”¨åŸºç«™ä¸­ç»§å®ƒå’Œæ›´å¤§ç½‘ç»œä¹‹é—´çš„æ•°æ®ã€‚</li><li>eg(èœ‚çªå¡”ï¼Œæ— çº¿LANçš„æ¥å…¥ç‚¹)</li></ul><p>â€œè·³â€çš„æ¦‚å¿µè§£é‡Š</p><ul><li><p>å•è·³ï¼šåŸºäºåŸºç¡€è®¾æ–½ï¼Œè¿™äº›ç½‘ç»œå…·æœ‰ä¸è¾ƒå¤§æœ‰é™ç½‘ç»œï¼ˆå› ç‰¹ç½‘ï¼‰è¿æ¥çš„åŸºç«™ã€‚è¯¥åŸºç«™ä¸æ— çº¿ä¸»æœºä¹‹é—´çš„æ‰€æœ‰é€šä¿¡éƒ½ç»è¿‡ä¸€ä¸ªæ— é™è·³ã€‚æ—¥å¸¸çš„ç½‘ç»œè¿æ¥åŸºæœ¬éƒ½æ˜¯è¿™æ ·çš„ã€‚</p></li><li><p>å•æŒ‘ï¼Œæ— åŸºç¡€è®¾æ–½ã€‚åœ¨è¿™äº›ç½‘ç»œä¸­ï¼Œä¸å­˜åœ¨ä¸æ— çº¿ç½‘ç»œç›¸è¿æ¥çš„åŸºç«™ã€‚è¿™ç§å•è·³ç½‘ç»œä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥åè°ƒå…¶ä»–èŠ‚ç‚¹ä¼ è¾“ï¼ˆè“ç‰™ã€å¤´æˆ´è€³æœºä¹‹ç±»çš„æ— çº¿è®¾å¤‡â€¦ï¼‰</p></li><li><p>å¤šè·³ï¼ŒåŸºäºåŸºç¡€è®¾æ–½ã€‚ä¸€ä¸ªåŸºç«™è¡¨ç°ä¸ºä»¥æœ‰çº¿æ–¹å¼ä¸è¾ƒå¤§ç½‘ç»œç›¸è¿æ¥ã€‚æŸäº›æ— çº¿èŠ‚ç‚¹ä¸ºäº†ç»è¿‡è¯¥åŸºç«™é€šä¿¡ï¼Œä¸å¾—ä¸é€šè¿‡å…¶ä»–æ— çº¿èŠ‚ç‚¹ä¸­ç»§ä»–ä»¬çš„é€šä¿¡ã€‚ï¼ˆæ— çº¿ç½‘çŠ¶ç½‘ç»œã€æ— çº¿ä¼ æ„Ÿç½‘ç»œï¼‰</p></li><li><p>å¤šè·³ï¼Œæ— åŸºç¡€è®¾æ–½ã€‚ç½‘ç»œä¸­æ²¡æœ‰åŸºç«™ï¼ŒèŠ‚ç‚¹ä¸ºäº†åˆ°è¾¾ç›®çš„åœ°å¯èƒ½å¿…é¡»åœ¨å‡ ä¸ªå…¶ä»–æ— çº¿èŠ‚ç‚¹ä¸­é—´ä¸­ç»§æŠ¥æ–‡ï¼ŒèŠ‚ç‚¹ä¹Ÿæ˜¯å¯ç§»åŠ¨çš„ï¼Œå¤šä¸ªå‡ ç‚¹ä¸­æ”¹å˜è¿æ¥å…³ç³»ï¼Œè¢«ç§°ä¸ºç§»åŠ¨è‡ªç»„ç»‡ç½‘ç»œ(MANET)ã€‚å¦‚æœè¯¥ç§»åŠ¨èŠ‚ç‚¹æ˜¯è½¦è½½çš„ï¼Œè¢«ç§°ä¸ºè½¦è½½è‡ªç»„ç»‡ç½‘ç»œ(VANET)</p></li></ul><p>æ— çº¿ç½‘ç»œçš„åˆ†ç±»ï¼š</p><ul><li>è¯¥æ— çº¿ç½‘ç»œä¸­çš„åˆ†ç»„æ˜¯å¦è·¨è¶Šäº†ä¸€ä¸ªæ— çº¿è·³æˆ–å¤šä¸ªæ— çº¿è·³</li><li>ç½‘ç»œä¸­æ˜¯å¦ç”±è¯¸å¦‚åŸºç«™è¿™æ ·çš„åŸºç¡€è®¾æ–½</li></ul><h3 id="æ— çº¿é“¾è·¯å’Œç½‘ç»œç‰¹å¾">æ— çº¿é“¾è·¯å’Œç½‘ç»œç‰¹å¾</h3><p>æ— çº¿é“¾è·¯å’Œæœ‰çº¿é“¾è·¯çš„åŒºåˆ«ï¼š</p><ul><li>é€’å‡çš„ä¿¡å·å¼ºåº¦ã€‚ç”µç£æ³¢ç©¿è¿‡ç‰©ä½“æ—¶å¼ºåº¦å‡å¼±ã€‚ä¿¡å·å¼ºåº¦éšç€å‘é€ã€æ¥æ”¶æ–¹ä¹‹é—´çš„è·ç¦»å¢åŠ è€Œå‡å¼± ----&gt; è·¯å¾„æŸè€—</li><li>æ¥è‡ªå…¶ä»–æºçš„å¹²æ‰°ã€‚åŒä¸€ä¸ªé¢‘æ®µå‘é€ä¿¡å·çš„ç‚¹æ’­æºå°†ç›¸äº’å¹²æ‰°ã€‚ä¾‹å¦‚ï¼Œ802.11bæ— çº¿LANç”¨æˆ·åŒæ—¶åˆ©ç”¨2.4GHzæ— çº¿ç”µè¯é€šä¿¡ï¼Œå°†å¯¼è‡´ç½‘ç»œå’Œç”µè¯éƒ½ä¸ä¼šå·¥ä½œçš„å¾ˆå¥½ã€‚</li><li>å¤šå¾„ä¼ æ’­ã€‚ç”µç£æ³¢çš„ä¸€éƒ¨åˆ†å—åå°„å½±å“ï¼Œ å¯èƒ½åˆ†æˆå¤šä¸ªéƒ¨åˆ†ï¼Œä»ä¸åŒè·¯å¾„ä¼ æ’­ï¼Œä½¿å¾—æ¥æ”¶æ–¹æ¥æ”¶çš„ä¿¡å·å˜å¾—æ¨¡ç³Šã€‚</li></ul><p>å› æ­¤ï¼Œæ— çº¿é“¾è·¯çš„æ¯”ç‰¹å·®é”™æ›´ä¸ºæ˜æ˜¾ï¼Œæ— çº¿é“¾è·¯åè®®é™¤äº†é‡‡ç”¨CRCé”™è¯¯æ£€æµ‹å—ï¼Œè¿˜é‡‡ç”¨<strong>é“¾è·¯å±‚ARQåè®®</strong>æ¥é‡ä¼ å—æŸçš„å¸§ã€‚</p><p>ä¿¡å™ªæ¯”ï¼ˆSNRï¼‰ï¼šæ¥æ”¶ä¸»æœºæ”¶åˆ°çš„ä¿¡å·å’Œå™ªå£°å¼ºåº¦çš„ç›¸å¯¹æµ‹é‡ï¼Œå•ä½dB<br>æ¯”ç‰¹å·®é”™ç‡ï¼ˆBERï¼‰ï¼šæ¥æ”¶æ–¹æ¥æ”¶åˆ°æœ‰é”™è¯¯ä¼ è¾“æ¯”ç‰¹çš„æ¦‚ç‡</p><p><strong>ç‰¹å¾ï¼š</strong></p><ul><li>å¯¹äºç»™å®šçš„è°ƒåˆ¶æ–¹æ¡ˆï¼ŒSNRè¶Šé«˜- --BERè¶Šä½ã€‚å‘é€æ–¹èƒ½å¤Ÿ é€šè¿‡å®ƒçš„ä¼ è¾“åŠŸç‡å¢åŠ SNRä¸€æ¬¡æ¥é™ä½æ¥æ”¶åˆ°å·®é”™å¸§çš„é€Ÿç‡ã€‚</li><li>ç»™å®šçš„SNRï¼Œå…·æœ‰è¾ƒé«˜æ¯”ç‰¹ä¼ è¾“ç‡çš„è°ƒåˆ¶æŠ€æœ¯ï¼Œå°†å…·æœ‰è¾ƒé«˜çš„BERã€‚</li><li>ç‰©ç†å±‚è°ƒåˆ¶æŠ€æœ¯çš„åŠ¨æ€é€‰æ‹©èƒ½ç”¨äºé€‚é…å¯¹ä¿¡é“æ¡ä»¶çš„è°ƒåˆ¶æŠ€æœ¯ã€‚SNRå¯èƒ½ç”±äºç¯å¢ƒçš„æ”¹å˜è€Œæ”¹å˜ï¼Œèœ‚çªæ•°æ®ã€802.11WiFiå’Œ4Gèœ‚çªç½‘ç»œä½¿ç”¨äº†è‡ªé€‚åº”è°ƒåˆ¶å’Œç¼–ç ã€‚</li></ul><p><strong>éšè”½ç»ˆç«¯é—®é¢˜</strong>        P.343</p><p><strong>CDMA</strong></p><p>ä¸åŒä¸»æœºä½¿ç”¨ä¸€ä¸ªå…±äº«åª’ä½“é€šä¿¡ï¼Œéœ€è¦ä¸€ä¸ªåè®®æ¥ä¿è¯å¤šä¸ªå‘é€æ–¹å‘é€çš„ä¿¡å·ä¸åœ¨æ¥æ”¶æ–¹ç›¸äº’å¹²æ‰°ã€‚å›é¡¾ç¬¬å…­ç« ï¼Œä¸‰ç±»åª’ä½“è®¿é—®åè®®ã€‚</p><p><strong>ç å¤šåˆ†å€</strong>ï¼ˆCode Division Multiple Access ï¼Œ<strong>CDMA</strong>ï¼‰ï¼Œå±äºä¿¡é“åˆ’åˆ†åè®®ï¼Œåœ¨æ— çº¿LANå’Œèœ‚çªæŠ€æœ¯ä¸­åº”ç”¨å¹¿æ³›ã€‚</p><p>ç ç‰‡é€Ÿç‡ï¼šè¦å‘é€çš„æ¯ä¸ªæ¯”ç‰¹éƒ½é€šè¿‡ x ä¸€ä¸ªä¿¡å·çš„æ¯”ç‰¹æ¥è¿›è¡Œç¼–ç ï¼ŒæŒ‡çš„æ˜¯è¿™ä¸ªä¿¡å·çš„å˜åŒ–é€Ÿç‡ã€‚å®ƒæ¯”åˆå§‹æ•°æ®æ¯”ç‰¹åºåˆ—çš„å˜åŒ–é€Ÿç‡å¿«å¾—å¤šã€‚</p><p>æ¦‚å¿µï¼š</p><p>å†…ç§¯ã€æ­£äº¤ã€å¤ç”¨ã€å¤šå€</p><p><a href="https://www.bilibili.com/video/av70564273">æ¹–ç§‘å¤§â€”é™æ€åˆ’åˆ†ä¿¡é“</a></p><h3 id="WiFi-802-11æ— çº¿LAN">WiFi:802.11æ— çº¿LAN</h3><p>IEEE 802.11æ— çº¿LAN -----&gt; WiFi</p><p>ä¸åŒçš„WiFiæ ‡å‡†éƒ½å…·æœ‰æŸäº›å…±åŒçš„ç‰¹å¾ï¼Œä½¿ç”¨ç›¸åŒçš„åª’ä½“è®¿é—®åè®®CSMA/CA;é“¾è·¯å±‚ä½¿ç”¨ç›¸åŒçš„å¸§ç»“æ„;èƒ½å¤Ÿå‡å°‘å…¶ä¼ è¾“é€Ÿç‡ä»¥æ‰©å±•åˆ°æ›´è¿œçš„è·ç¦»;</p><p>802.11è®¾å¤‡å·¥ä½œåœ¨ä¸¤ä¸ªä¸åŒé¢‘æ®µä¸Šï¼š</p><ul><li>2.4 ~ 2.485GHzï¼Œæ— éœ€æ‰§ç…§</li><li>5.1 ~ 5.8GHzï¼Œç»™å®šçš„åŠŸç‡ç­‰çº§ä¸‹æœ‰æ›´çŸ­çš„ä¼ è¾“è·ç¦»ï¼Œå¹¶ä¸”å—å¤šå¾„ä¼ æ’­çš„å½±å“æ›´å¤šã€‚</li></ul><p><a href="https://blog.csdn.net/weixin_34297300/article/details/92311889">IEEE802.11æ ‡å‡†</a></p><h4 id="802-11ä½“ç³»ç»“æ„">802.11ä½“ç³»ç»“æ„</h4><p>åŸºæœ¬æ„å»ºæ¨¡å—ï¼šåŸºæœ¬æœåŠ¡é›†ï¼ˆBasic Service Setï¼ŒBSSï¼‰ï¼Œä¸€ä¸ªBSSåŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ— çº¿ç«™ç‚¹å’Œä¸€ä¸ªæ¥å…¥ç‚¹ï¼ˆAccess Pointï¼ŒAPï¼‰ã€ä¹Ÿå«ä¸­å¤®åŸºç«™ã€‘</p><p>æ¯ä¸ª802.11æ— çº¿ç«™ç‚¹éƒ½å…·æœ‰ä¸€ä¸ª6å­—èŠ‚çš„MACåœ°å€ï¼Œè¯¥åœ°å€å­˜å‚¨åœ¨è¯¥ç«™é€‚é…å™¨ï¼ˆ802.11ç½‘ç»œæ¥å£å¡ï¼‰çš„å›ºä»¶ä¸­ã€‚æ¯ä¸ªAPçš„æ— çº¿æ¥å£ä¹Ÿæœ‰ä¸€ä¸ªMACåœ°å€ã€‚</p><p>åŸºç¡€è®¾æ–½æ— çº¿LANï¼šé…ç½®APçš„æ— çº¿LANï¼ˆåŸºç¡€è®¾æ–½ï¼ŒæŒ‡APè¿åŒäº’è”APå’Œä¸€å°è·¯ç”±å™¨çš„æœ‰çº¿ä»¥å¤ªç½‘ï¼‰ã€‚</p><p><strong>ä¿¡é“ä¸å…³è”</strong></p><p>802.11ä¸­æ¯ä¸ªæ— çº¿ç«™ç‚¹åœ¨èƒ½å¤Ÿå‘é€æˆ–è€…æ¥æ”¶ç½‘ç»œå±‚æ•°æ®å‰ï¼Œéƒ½è¦ä¸ä¸€ä¸ªAPç›¸å…³è”</p><p>ç½‘ç»œç®¡ç†å‘˜å®‰è£…APæ—¶ï¼Œä¾¿ä¸ºè¯¥æ¥å…¥ç‚¹åˆ†é…äº†ä¸€ä¸ªå•å­—æˆ–è€…åŒå­—çš„æœåŠ¡é›†æ ‡è¯†ç¬¦ï¼ˆService Set Identifier ï¼ŒSSIDï¼‰ï¼Œè¿˜ä¼šåˆ†é…ä¸€ä¸ªä¿¡é“å·</p><p>WiFiä¸›æ—ï¼šæ˜¯ä»»æ„ç‰©ç†ä½ç½®ï¼Œåœ¨è¿™é‡Œæ— çº¿ç«™ç‚¹èƒ½ä»ä¸¤ä¸ªæˆ–è€…å¤šä¸ªAPä¸­æ”¶åˆ°å¾ˆå¼ºçš„ä¿¡å·</p><p>ä¸ºäº†åŠ å…¥å…¶ä¸­çš„ä¸€ä¸ªå­ç½‘ï¼Œå®¢æˆ·çš„æ— çº¿ç«™ç‚¹å¿…é¡»è¦ä¸å…¶ä¸­çš„ä¸€ä¸ªAPå…³è”ã€‚å…³è”æ„å‘³ç€æ— çº¿ç«™ç‚¹åœ¨è‡ªèº«å’ŒAPä¹‹é—´åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿçº¿è·¯ã€‚ä»…æœ‰å…³è”çš„APæ‰å‘ä½ çš„æ— çº¿ç«™ç‚¹å‘é€æ•°æ®å¸§ï¼Œå¹¶ä¸” ä½ çš„æ— çº¿ç«™ç‚¹ä¹Ÿé€šè¿‡è¯¥å…³è”APå‘å› ç‰¹ç½‘å‘é€æ•°æ®å¸§ã€‚</p><p><em>æ— çº¿ç«™ç‚¹å¦‚ä½•ä¸ç‰¹å®šAPå…³è”ï¼Ÿ</em></p><p>802.11è¦æ±‚æ¯ä¸ªAPå‘¨æœŸæ€§å‘é€<strong>ä¿¡æ ‡å¸§</strong>ï¼Œæ¯ä¸ªä¿¡æ ‡å¸§åŒ…æ‹¬APçš„SSIDå’ŒMACåœ°å€ã€‚æ— çº¿ç«™ç‚¹ä¸ºäº†å¾—çŸ¥æ­£åœ¨å‘é€ä¿¡æ ‡å¸§çš„APï¼Œæ‰«æ11ä¸ªä¿¡é“ï¼Œæ‰¾åˆ°å¯èƒ½ä½äºè¯¥åŒºåŸŸçš„APï¼Œé€‰æ‹©ä¸€ä¸ªå¯ç”¨APå¹¶å…³è”ã€‚ï¼ˆåˆæœ‰å…³è”è¯·æ±‚å¸§å’Œå…³è”å“åº”å¸§ï¼‰</p><p>è¢«åŠ¨æ‰«æï¼šæ‰«æä¿¡é“å’Œç›‘å¬ä¿¡æ ‡å¸§çš„è¿‡ç¨‹<br>ä¸»åŠ¨æ‰«æï¼šé€šè¿‡å‘ä½äºæ— çº¿ä¸»æœºèŒƒå›´å†…çš„æ‰€æœ‰APå¹¿æ’­æ¢æµ‹å¸§å®Œæˆã€‚ï¼ˆAPç”¨ä¸€ä¸ªæ¢æµ‹å“åº”å¸§å›åº”æ¢æµ‹è¯·æ±‚å¸§ï¼‰</p><p>ä¸€æ—¦ä¸ä¸€ä¸ªAPå…³è”ï¼Œä¸»æœºå°†å‘é€šè¿‡å…³è”çš„APå‘å­ç½‘å‘é€ä¸€ä¸ªDHCPå‘ç°æŠ¥æ–‡ï¼Œè·å–åœ¨è¯¥APå­ç½‘ä¸­çš„ä¸€ä¸ªIPåœ°å€ã€‚</p><h4 id="802-11-MACåè®®">802.11 MACåè®®</h4><p>è®¸å¤šæ— çº¿è®¾å¤‡æˆ–è€…APè‡ªèº«å¸Œæœ›åŒæ—¶ç»è¿‡ç›¸åŒä¿¡é“ä¼ è¾“æ•°æ®å¸§ ---- &gt; éœ€è¦å¤šè·¯è®¿é—®åè®®æ¥åè°ƒä¼ è¾“ã€‚</p><p>ç«™ç‚¹ï¼šæ— çº¿è®¾å¤‡å’ŒAPï¼Œå…±äº«å¤šä¸ªæ¥å…¥ä¿¡é“ã€‚</p><p>å¸¦ç¢°æ’é¿å…çš„CSMAï¼ˆCSMA/CAï¼‰ï¼Œå±äºéšæœºè®¿é—®åè®®</p><p><em>ä»¥å¤ªç½‘å’Œ802.11MACåè®®çš„åŒºåˆ«ï¼Ÿ</em></p><ul><li><p>æœªå®ç°ç¢°æ’æ£€æµ‹ï¼Œè€Œæ˜¯ç¢°æ’é¿å…</p><p>åŸå› ï¼š</p><ul><li>æ£€æµ‹ç¢°æ’çš„èƒ½åŠ›è¦æ±‚ç«™ç‚¹å…·æœ‰åŒæ—¶å‘é€å’Œæ¥æ”¶çš„èƒ½åŠ›ã€‚åœ¨802.11é€‚é…å™¨ä¸Šï¼Œæ¥æ”¶ä¿¡å·çš„å¼ºåº¦è¿œå°äºå‘é€ä¿¡å·çš„å¼ºåº¦ï¼Œåˆ¶é€ å…·æœ‰æ£€æµ‹ç¢°æ’èƒ½åŠ›çš„ç¡¬ä»¶ä»£ä»·è¾ƒå¤§ã€æˆæœ¬è¾ƒé«˜ã€‚</li><li>å³ä½¿é€‚é…å™¨å¯ä»¥æ¥æ”¶å’Œå‘é€åŒæ—¶è¿›è¡Œï¼Œä½†ä¹Ÿä¼šç”±äºéšè—ç»ˆç«¯é—®é¢˜å’Œè¡°å‡é—®é¢˜è€Œæ— æ³•æ£€æµ‹åˆ°æ‰€æœ‰çš„ç¢°æ’</li></ul><p>ç”±äºä¸é€‚ç”¨ç¢°æ’æ£€æµ‹ï¼Œæ‰€ä»¥ä¸€æ—¦ç«™ç‚¹å¼€å§‹å‘é€ä¸€ä¸ªå¸§ï¼Œä»–å°±å®Œå…¨çš„å‘é€è¯¥å¸§ã€‚</p></li><li><p>ä½¿ç”¨é“¾è·¯å±‚ç¡®è®¤ / é‡ä¼ åè®®</p><p>æ— çº¿LANä¸­æŸç«™ç‚¹å‘é€ä¸€ä¸ªå¸§ï¼Œå¯èƒ½ä¸ä¼šæ— æŸåœ°åˆ°è¾¾ç›®çš„ç«™ç‚¹ -----&gt;é“¾è·¯å±‚ç¡®è®¤ã€‚</p><p>ç›®çš„ç«™ç‚¹åœ¨æ”¶åˆ°ä¸€ä¸ªCRCæ ¡éªŒçš„å¸§åï¼Œç­‰å¾…ä¸€ä¸ª<strong>çŸ­å¸§é—´é—´éš”</strong>ï¼ˆSIFSï¼‰ï¼Œç„¶åå‘å›ä¸€ä¸ªç¡®è®¤å¸§ã€‚å¦‚æœå‘é€ç«™ç‚¹åœ¨ç»™å®šæ—¶é—´å†…æœªæ”¶åˆ°ç¡®è®¤å¸§ï¼Œåˆ™å‡å®šå‡ºç°äº†é”™è¯¯ï¼Œå¹¶é‡ä¼ è¯¥å¸§ã€‚è‹¥åœ¨è‹¥å¹²å›ºå®šæ¬¡é‡ä¼ åä»æœªæ”¶åˆ°ç¡®è®¤ï¼Œå‘é€ç«™ç‚¹å°†æ”¾å¼ƒå‘é€å¹¶ä¸¢å¼ƒè¯¥å¸§ã€‚</p></li></ul><p>CSMA/CAåè®®è¿‡ç¨‹ï¼š</p><ol><li>ä¸€ä¸ªç«™ç‚¹æœ‰å¸§è¦å‘é€</li><li>ç«™ç‚¹æœ€åˆç›‘å¬åˆ°ä¿¡é“ç©ºé—²ï¼Œåˆ™å°†åœ¨ä¸€ä¸ªè¢«ç§°ä¸º<strong>åˆ†å¸ƒå¼å¸§é—´é—´éš”</strong>ï¼ˆDIFSï¼‰çš„çŸ­æ—¶é—´æ®µåå‘é€è¯¥å¸§</li><li>ä¸ç©ºé—²ï¼Œåˆ™ç«™ç‚¹é€‰å–ä¸€ä¸ªéšæœºå›é€€å€¼ï¼Œå¹¶åœ¨ä¾¦å¬ä¿¡é“ç©ºé—²æ—¶é€’å‡è¯¥å€¼ã€‚</li><li>è®¡æ•°å€¼ä¸º0æ—¶ï¼Œè¯¥ç«™ç‚¹å‘é€æ•´ä¸ªæ•°æ®å¸§</li><li>æ”¶åˆ°ç¡®è®¤ï¼Œå¦‚æœè¿˜è¦å‘é€å¦ä¸€å¸§ï¼Œå›åˆ°ç¬¬äºŒæ­¥ã€‚æœªæ”¶åˆ°ç¡®è®¤ï¼Œå‘é€ç«™ç‚¹å°†é‡æ–°è¿›å…¥ç¬¬äºŒæ­¥ä¸­çš„å›é€€é˜¶æ®µï¼Œä»ä¸€ä¸ªæ›´å¤§çš„èŒƒå›´é€‰æ‹©éšæœºå€¼</li></ol><p><strong>1. å¤„ç†éšè—ç»ˆç«¯ï¼šRTSå’ŒCTS</strong></p><p>èƒŒæ™¯ï¼šä¸¤ä¸ªæ— çº¿ç«™ç‚¹ä¹‹é—´æ˜¯éšè—çš„ï¼Œä½†å¯¹APä¸éšè— ï¼ˆè¦†ç›–èŒƒå›´å’Œè¡°å‡é—®é¢˜ï¼‰</p><p>å¯¼è‡´çš„é—®é¢˜ï¼šAç«™ç‚¹å‘APä¼ è¾“ä¸€ä¸ªå¸§ï¼Œä¸­é€”Bç«™ç‚¹ä¹Ÿè¦å‘APä¼ è¾“ä¸€ä¸ªå¸§ï¼Œä½†Bå¬ä¸åˆ°æ¥è‡ªAçš„ä¼ è¾“ï¼Œå°†ä¼šå¯¼è‡´ç¢°æ’ã€‚</p><p>é—®é¢˜è§£å†³ï¼š802.11å…è®¸ç«™ç‚¹ä½¿ç”¨ä¸€ä¸ªçŸ­<strong>è¯·æ±‚å‘é€</strong>(Request - To -Send ,RTS)æ§åˆ¶å¸§å’Œä¸€ä¸ªçŸ­<strong>å…è®¸å‘é€</strong>ï¼ˆClear To Sendï¼ŒCTSï¼‰æ§åˆ¶å¸§æ¥<strong>é¢„çº¦</strong>å¯¹ä¿¡é“çš„è®¿é—®ã€‚</p><p>å‘é€æ–¹è¦å‘é€DATAå¸§æ—¶ï¼Œå…ˆå‘APå‘é€RTSå¸§ï¼ŒæŒ‡ç¤ºä¼ è¾“DATAå¸§å’Œç¡®è®¤ACKå¸§éœ€è¦çš„æ€»æ—¶é—´ã€‚APæ”¶åˆ°åï¼Œå°†å¹¿æ’­ä¸€ä¸ªCTSå¸§ä½œä¸ºå“åº”ã€‚å¹¿æ’­CTSå¸§ä½œç”¨ï¼šï¼ˆç»™æŒ‡å®šå‘é€æ–¹æ˜ç¡®çš„å‘é€è®¸å¯ï¼›æŒ‡ç¤ºå…¶ä»–ç«™ç‚¹åœ¨é¢„çº¦æœŸå†…ä¸å¯å‘é€ï¼‰</p><p>ç¼ºç‚¹ï¼šå¼•å…¥äº†æ—¶å»¶ã€æ¶ˆè€—äº†ä¿¡é“èµ„æºã€‚RTS/CTSä»…ç”¨åšé•¿æ•°æ®å¸§é¢„çº¦ä¿¡é“ã€‚</p><p><strong>2. ä½¿ç”¨802.11ä½œä¸ºä¸€ä¸ªç‚¹å¯¹ç‚¹é“¾è·¯</strong></p><p>ä¸¤ä¸ªèŠ‚ç‚¹éƒ½å…·æœ‰å®šå‘å¤©çº¿ï¼Œåˆ™å¯ä»¥å°†å¤©çº¿æŒ‡å‘å¯¹æ–¹ï¼Œåœ¨ä¸€ä¸ªç‚¹å¯¹ç‚¹é“¾è·¯ä¸Šè¿è¡Œ802.11åè®®</p><h4 id="802-11å¸§">802.11å¸§</h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211004102532916.png" alt="image-20211004102532916"></p><ul><li><p>æœ‰æ•ˆè½½è·ä¸CRCå­—æ®µï¼šæœ‰æ•ˆè½½è·é€šå¸¸ç”±IPæ•°æ®æŠ¥æˆ–è€…ARPåˆ†ç»„ç»„æˆï¼Œæœ€å¤§å…è®¸é•¿åº¦ä¸º2312å­—èŠ‚ï¼ˆé€šå¸¸&lt;1500ï¼‰ï¼ŒåŒ…å«CRCæ ¡éªŒ</p></li><li><p><strong>åœ°å€å­—æ®µ</strong>ï¼š4ä¸ªåœ°å€å­—æ®µï¼Œæ¯ä¸€ä¸ªéƒ½å¯ä»¥åŒ…å«ä¸€ä¸ª6å­—èŠ‚çš„MACåœ°å€ã€‚ä¸ºå•¥éœ€è¦4ä¸ªï¼Ÿ</p><p>äº’è”ç›®çš„éœ€è¦3ä¸ªåœ°å€å­—æ®µã€‚ç½‘ç»œå±‚æ•°æ®æŠ¥ä»ä¸€ä¸ªæ— çº¿ç«™ç‚¹é€šè¿‡ä¸€ä¸ªAPåˆ°ä¸€å°è·¯ç”±å™¨æ¥å£ã€‚</p><p>å½“APåœ¨è‡ªç»„ç»‡æ¨¡å¼ä¸­ç›¸äº’è½¬å‘æ—¶ä½¿ç”¨ç¬¬å››ä¸ªåœ°å€</p><ul><li>åœ°å€1ï¼šæ¥æ”¶è¯¥å¸§çš„æ— çº¿ç«™ç‚¹çš„MACåœ°å€ã€‚</li><li>åœ°å€2ï¼šä¼ è¾“è¯¥å¸§çš„ç«™ç‚¹çš„MACåœ°å€ã€‚</li><li>åœ°å€3ï¼šä¸APç›¸è¿ä¸”ä¸APè¿æ¥çš„è·¯ç”±å™¨æ¥å£çš„MACåœ°å€ã€‚åœ¨BSSå’Œæœ‰çº¿å±€åŸŸç½‘çš„äº’è”ä¸­æœ‰å…³é”®çš„ä½œç”¨ï¼ˆç†è§£åœ°å€3, P.354ï¼‰</li></ul><p>æ³¨æ„ç‚¹ï¼šå½“APä¸ç›´æ¥ç›¸è¿çš„è·¯ç”±å™¨æ¥å£ä¼ è¾“å¸§æ—¶ï¼Œæœ‰802.3çš„ä»¥å¤ªç½‘å¸§ ------ 802.11å¸§ä¹‹é—´çš„ç›¸äº’è½¬åŒ–</p></li><li><p>åºå·ã€æŒç»­æœŸå’Œå¸§æ§åˆ¶å­—æ®µï¼š</p><p>å›å¿†rdt2.1ï¼Œä½¿ç”¨åºå·å¯ä»¥ä½¿æ¥æ”¶æ–¹åŒºåˆ†æ–°ä¼ è¾“çš„å¸§å’Œä»¥å‰çš„å¸§é‡ä¼ </p><p>æŒç»­æœŸï¼ŒRTSã€CTSä¸­çš„é¢„çº¦æ—¶é—´ï¼ŒåŒ…æ‹¬ä¼ è¾“æ•°æ®å¸§çš„æ—¶é—´å’Œä¼ è¾“ç¡®è®¤çš„æ—¶é—´</p><p>å¸§æ§åˆ¶æœ‰è®¸å¤šå­—æ®µï¼Œç±»å‹å’Œå­ç±»å‹å­—æ®µç”¨äºåŒºåˆ†å…³ã€RTSã€CTSã€ACKå’Œæ•°æ®å¸§ï¼›Toå’ŒFromå­—æ®µç”¨äºå®šä¹‰ä¸åŒåœ°å€å­—æ®µçš„å«ä¹‰ï¼ˆå«ä¹‰ä¼šéšç€ä½¿ç”¨è‡ªç»„ç»‡æ¨¡å¼æˆ–è€…åŸºç¡€è®¾æ–½æ¨¡å¼è€Œæ”¹å˜ï¼›åŸºç¡€è®¾æ–½æ¨¡å¼æ—¶ï¼Œä¹Ÿä¼šéšç€æ˜¯æ— çº¿ç«™ç‚¹è¿˜æ˜¯APåœ¨å‘é€å¸§è€Œå˜åŒ–ï¼‰ï¼›WEPå­—æ®µæŒ‡ç¤ºäº†æ˜¯å¦ä½¿ç”¨åŠ å¯†</p></li></ul><h4 id="åœ¨ç›¸åŒçš„IPå­ç½‘ä¸­çš„ç§»åŠ¨æ€§">åœ¨ç›¸åŒçš„IPå­ç½‘ä¸­çš„ç§»åŠ¨æ€§</h4><p>ä¸ºå¢åŠ æ— çº¿LANçš„ç‰©ç†èŒƒå›´ï¼ŒåŒä¸€ä¸ªIPå­ç½‘ä¸­ä¼šéƒ¨ç½²å¤šä¸ªBSSã€‚</p><p><em>æ— çº¿ç«™ç‚¹å¦‚ä½•åœ¨ç»´æŒè¿›è¡Œä¸­çš„TCPä¼šè¯çš„æƒ…å†µä¸‹ï¼Œæ— ç¼åœ°ä»ä¸€ä¸ªBSSç§»åŠ¨åˆ°å¦ä¸€ä¸ª</em></p><p>**äº’è”è®¾å¤‡ä¸æ˜¯è·¯ç”±å™¨ï¼Œåˆ™ä¸¤ä¸ªBSSä¸­çš„æ‰€æœ‰ç«™ç‚¹éƒ½å±äºåŒä¸€ä¸ªIPå­ç½‘ã€‚**å¦‚æœæ˜¯è·¯ç”±å™¨ï¼Œåˆ™ç«™ç‚¹å¿…é¡»åœ¨å®ƒç§»åŠ¨è¿›å…¥çš„å­ç½‘ä¸­è·å¾—ä¸€ä¸ªæ–°çš„åœ°å€ï¼ˆè¿™ç§åœ°å€å˜åŒ–ä¼šæ‰“æ–­è¯¥ç«™ç‚¹çš„ä»»ä½•TCPè¿æ¥ï¼‰ã€‚P.355</p><h4 id="802-11ä¸­çš„é«˜çº§ç‰¹è‰²ã€">802.11ä¸­çš„é«˜çº§ç‰¹è‰²ã€</h4><p>ä¸ä¸€å®šæ‰€æœ‰åè®®éƒ½å®ç°</p><ol><li><p><strong>é€Ÿç‡é€‚åº”</strong></p><p>è‡ªæ˜¯ä¸€ä¸ªæ ¹æ®å½“å‰å’Œè¿‘æœŸä¿¡é“ç‰¹ç‚¹æ¥é€‰æ‹©ç‰©ç†å±‚è°ƒåˆ¶æŠ€æœ¯ã€‚ä¸TCPæ‹¥å¡æ§åˆ¶ç±»ä¼¼</p></li><li><p><strong>åŠŸç‡ç®¡ç†</strong></p><p>ä¸€ä¸ªèŠ‚ç‚¹èƒ½å¤Ÿæ˜æ˜¾åœ°åœ¨ç¡çœ å’Œå”¤é†’çŠ¶æ€ä¹‹é—´äº¤æ›¿ã€‚èŠ‚ç‚¹èƒ½å¤Ÿå‘APæŒ‡ç¤ºå®ƒå°†è¦ç¡çœ ï¼ŒAPè®¡åˆ’å‘é€å®ƒçš„ä¿¡æ ‡å¸§åœ¨èŠ‚ç‚¹åˆšå¥½å”¤é†’åã€‚</p></li></ol><h4 id="ä¸ªäººåŸŸç½‘ç»œï¼šè“ç‰™å’ŒZigBee">ä¸ªäººåŸŸç½‘ç»œï¼šè“ç‰™å’ŒZigBee</h4><ol><li><p><strong>è“ç‰™</strong></p><p>IEEE 802.15.1 ç½‘ç»œä»¥ä½åŠŸç‡å’Œä½æˆæœ¬åœ¨å°èŒƒå›´å†…å…è®¸ï¼Œæœ¬è´¨æ˜¯ä¸€ä¸ªä½åŠŸç‡ã€ä½é€Ÿç‡çš„ç”µç¼†æ›¿ä»£æŠ€æœ¯ã€‚</p><ul><li>è¢«ç§°ä¸ºâ€œ<strong>æ— çº¿ä¸ªäººåŸŸç½‘ç»œ</strong>â€ï¼ˆWPANï¼‰</li><li>ä»¥TDMæ–¹å¼å·¥ä½œåœ¨2.4GHzæ— çº¿ç”µæ³¢æ®µï¼Œæ¯ä¸ªæ—¶éš™ä¸º625usã€‚æ¯ä¸ªæ—¶éš™å†…ï¼Œå‘é€æ–¹åˆ©ç”¨79ä¸ªä¿¡é“ä¸­çš„ä¸€ä¸ªè¿›è¡Œä¼ è¾“ï¼ŒåŒæ—¶ä»æ—¶éš™åˆ°æ—¶éš™ä»¥ä¸€ä¸ªå·²çŸ¥çš„ä¼ªéšæœºæ–¹å¼å˜æ›´ä¿¡é“ï¼ˆ<strong>è·³é¢‘æ‰©å±•é¢‘è°±ï¼ŒFHSS</strong>çš„ä¿¡é“è·³åŠ¨æ–¹å¼å°†ä¼ è¾“åŠæ—¶æ‰©å±•åˆ°æ•´ä¸ªé¢‘è°±ï¼‰ã€‚èƒ½æä¾›4Mbpsçš„æ•°æ®ç‡</li><li>è‡ªç»„ç»‡ç½‘ç»œï¼Œå—é™è®¾å¤‡è¦ç»„ç»‡æˆä¸€ä¸ªå¤šè¾¾8ä¸ªæ´»åŠ¨è®¾å¤‡çš„çš®å¯ç½‘ï¼ˆpiconetï¼‰ï¼Œæœ‰ä¸€ä¸ªä¸»è®¾å¤‡ã€‚ä¸»è®¾å¤‡çœŸæ­£æ§åˆ¶piconetï¼Œå®ƒçš„æ¹¿ç–¹ç¡®å®šäº†piconetçš„æ—¶é—´ï¼Œå¯ä»¥åœ¨å¥‡æ•°æ—¶éš™ä¸­æ¬§å† å‘é€ï¼Œè€Œä»è®¾å¤‡ä»…å½“ä¸»è®¾å¤‡åœ¨å‰ä¸€æ—¶éš™ä¸å…¶é€šä¿¡åæ‰å¯å‘é€ï¼Œå¹¶ä¸”åªèƒ½å‘é€ç»™ä¸»è®¾å¤‡ã€‚é™¤äº†ä»è®¾å¤‡ï¼Œç½‘ç»œä¸­è¿˜å¯ä»¥æœ‰255ä¸ªå¯„æ”¾è®¾å¤‡ï¼Œå½“è®¾å¤‡è¢«ä¸»èŠ‚ç‚¹è½¬æ¢ä¸ºæ´»åŠ¨çŠ¶æ€åæ‰å¯ä»¥é€šä¿¡ã€‚</li></ul></li><li><p><strong>ZigBee</strong></p><p>ç¬¬äºŒä¸ªäººåŸŸç½‘ç»œã€‚802.14.5ï¼›ä½åŠŸç‡ã€ä½æ•°æ®ç‡ã€ä½å·¥ä½œå‘¨æœŸï¼ˆé€‚ç”¨äºå®¶åº­æ¸©åº¦ã€å…‰çº¿ä¼ æ„Ÿå™¨ç­‰ï¼‰ 20kbpsã€40kbpsã€100ã€250kbpsçš„ä¿¡é“é€Ÿç‡</p><p>ä¸€ä¸ªå…¨åŠŸèƒ½è®¾å¤‡ä½œä¸ºä¸»è®¾å¤‡ã€‚å¤šä¸ªå…¨åŠŸèƒ½è®¾å¤‡èƒ½å¤Ÿé…ç½®ä¸ºä¸€ä¸ªç½‘çŠ¶ç½‘ç»œ</p></li></ol><h3 id="èœ‚çªå› ç‰¹ç½‘æ¥å…¥">èœ‚çªå› ç‰¹ç½‘æ¥å…¥</h3><p>GSMï¼šå…¨çƒç§»åŠ¨é€šä¿¡ç³»ç»Ÿï¼ˆGroupe Special Mobileï¼‰</p><p>UMTS: é€šä¿¡ç§»åŠ¨é€šä¿¡æœåŠ¡ï¼ˆUMTSï¼‰</p><p>ç¬¬ä¸€ä»£ï¼šæ¨¡æ‹ŸFDMAç³»ç»Ÿï¼Œä¸“é—¨ç”¨äºè¯­éŸ³é€šä¿¡ã€‚å‡ ä¹å®Œå…¨è¢«2Gæ›¿ä»£</p><h4 id="2Gèœ‚çªç½‘ä½“ç³»ç»“æ„ï¼šè¯­éŸ³å’Œç”µè¯ç½‘è¿æ¥">2Gèœ‚çªç½‘ä½“ç³»ç»“æ„ï¼šè¯­éŸ³å’Œç”µè¯ç½‘è¿æ¥</h4><p>èœ‚çªï¼šä¸€ä¸ªèœ‚çªç½‘è¦†ç›–çš„åŒºåŸŸè¢«åˆ†æˆè®¸å¤šå°åŒº(cell)çš„åœ°ç†è¦†ç›–åŒºåŸŸ<br>å…¶ä¸­æ¯ä¸ªå°åŒºæœ‰ä¸€ä¸ª<strong>æ”¶å‘åŸºç«™</strong>(Base Transceiver Station ,BTS)ï¼Œè´Ÿè´£å‘ä½äºå°åŒºå†…çš„ç§»åŠ¨ç«™ç‚¹å‘é€ã€æ¥æ”¶ä¿¡å·ã€‚</p><p>2GGèœ‚çªç³»ç»Ÿçš„GSMæ ‡å‡†å¯¹ç©ºä¸­æ¥å£ä½¿ç”¨ç»„åˆçš„FDM/TDMï¼Œç”±200kHzçš„é¢‘å¸¦ç»„æˆï¼Œæ¯ä¸ªé¢‘å¸¦æ”¯æŒ8ä¸ªTDMå‘¼å«ã€‚GSMä»¥13kbpså’Œ12.2kbpsé€Ÿç‡ç¼–ç </p><p>åŸºç«™æ§åˆ¶å™¨ï¼ˆBSCï¼‰ï¼šé€šå¸¸æœåŠ¡ä¸å‡ åä¸ªæ”¶å‘åŸºç«™ï¼Œä¸ºç§»åŠ¨ç”¨æˆ·åˆ†é…BTSæ— çº¿ä¿¡é“ï¼Œæ‰§è¡Œ<strong>å¯»å‘¼</strong>ï¼ˆæ‰¾å‡ºæŸç§»åŠ¨ç”¨æˆ·æ‰€åœ¨çš„å°åŒºï¼‰ï¼Œæ‰§è¡Œç§»åŠ¨ç”¨æˆ·çš„åˆ‡æ¢ã€‚</p><p>GSMåŸºç«™ç³»ç»Ÿï¼ˆBSSï¼‰= BSC + BSCæ§åˆ¶çš„BTS</p><p>ç§»åŠ¨äº¤æ¢ä¸­å¿ƒï¼ˆMobile sWitching Centerï¼ŒMSCï¼‰ï¼šç”¨æˆ·é‰´åˆ«ã€è´¦å·ç®¡ç†ã€å‘¼å«å»ºç«‹å’Œåˆ‡æ¢ã€‚åŒ…å«å¤šè¾¾5ä¸ªçš„BSCï¼Œæ¯ä¸ªMSCå¤§çº¦æœ‰20 0000ä¸ªç”¨æˆ·ï¼Œä¸€ä¸ªèœ‚çªæä¾›å•†ç½‘ç»œæœ‰è‹¥å¹²ä¸ªMSCï¼Œä½¿ç”¨ç½‘å…³MSCçš„ç‰¹æ®ŠMSCå°†æä¾›å•†çš„èœ‚çªç½‘ç»œå’Œæ›´å¤§çš„å…¬å…±ç”µè¯ç½‘ç›¸è¿æ¥</p><h4 id="3Gèœ‚çªæ•°æ®ç½‘ï¼šå°†å› ç‰¹ç½‘æ‰©å±•åˆ°èœ‚çªç”¨æˆ·">3Gèœ‚çªæ•°æ®ç½‘ï¼šå°†å› ç‰¹ç½‘æ‰©å±•åˆ°èœ‚çªç”¨æˆ·</h4><p>è¦æ±‚æ‰‹æœºè¦è¿è¡Œå®Œæ•´çš„TCP/IPåè®®æ ˆï¼ˆ5å±‚ï¼‰</p><p><strong>1. 3Gæ ¸å¿ƒç½‘</strong></p><p>â€‹3Gæ ¸å¿ƒèœ‚çªæ•°æ®å°†æ— çº¿ç”µæ¥å…¥ç½‘è¿æ¥åˆ°å…¬å…±å› ç‰¹ç½‘ã€‚æ ¸å¿ƒç½‘ä¸ç°æœ‰èœ‚çªè¯­éŸ³ç½‘ï¼ˆMSCï¼‰ç»„ä»¶ç›¸åä½œï¼šä¸è§¦åŠ¨ç°æœ‰çš„æ ¸å¿ƒGSMèœ‚çªè¯­éŸ³ç½‘ï¼Œå¢åŠ ä¸ç°æœ‰èœ‚çªè¯­éŸ³ç½‘å¹³è¡Œçš„é™„åŠ èœ‚çªæ•°æ®åŠŸèƒ½ã€‚</p><p>3Gæ ¸å¿ƒç½‘ä¸­çš„ä¸¤ç±»èŠ‚ç‚¹ï¼š</p><ul><li><p>æœåŠ¡é€šç”¨åˆ†ç»„æ— çº¿æœåŠ¡æ”¯æŒèŠ‚ç‚¹ï¼ˆSGSNï¼‰ï¼Œè´Ÿè´£å‘ä½äºå…¶è¿æ¥çš„æ— çº¿ç”µæ¥å…¥ç½‘ä¸­çš„ç§»åŠ¨èŠ‚ç‚¹äº¤ä»˜/è·å– æ•°æ®æŠ¥ã€‚</p><p>SGSNä¸è¯¥åŒºåŸŸèœ‚çªè¯­éŸ³ç½‘çš„MSCè¿›è¡Œäº¤äº’ï¼Œæä¾›ç”¨æˆ·è®¤è¯ã€åˆ‡æ¢ï¼Œç»´æŠ¤æ´»è·ƒç§»åŠ¨èŠ‚ç‚¹çš„ä½ç½®ä¿¡æ¯ï¼Œæ‰§è¡Œä½äºæ— çº¿æ¥å…¥ç½‘ä¸­çš„ç§»åŠ¨èŠ‚ç‚¹å’ŒGGSNä¹‹é—´çš„æ•°æ®æŠ¥è½¬å‘ã€‚</p></li><li><p>ç½‘ç®¡GPRSæ”¯æŒåŠè¯¶å¤§ï¼ˆGGSNï¼‰ã€æ³¨ï¼šGPRSï¼ˆGeneral Packet Radiio Serviceï¼‰è¡¨ç¤ºé€šç”¨åˆ†ç»„æ— çº¿æœåŠ¡ï¼Œæ˜¯ä¸€ç§åœ¨2Gç½‘ç»œä¸­çš„æ—©æœŸèœ‚çªæ•°æ®æœåŠ¡ã€‚ã€‘ã€‚ç½‘å…³ä½œç”¨ï¼Œå°†å¤šä¸ªSGSNè¿æ¥åˆ°æ›´å¤§çš„å› ç‰¹ç½‘ã€‚GGSNæ˜¯ç§»åŠ¨èŠ‚ç‚¹çš„ä¸€ä¸ªæ•°æ®æŠ¥åœ¨è¿›å…¥æ›´å¤§å› ç‰¹ç½‘ä¹‹å‰é‡åˆ°çš„3GåŸºç¡€è®¾æ–½çš„æœ€åä¸€éƒ¨åˆ†</p></li></ul><p><strong>2. 3Gæ— çº¿æ¥å…¥ç½‘ï¼šæ— çº¿è¾¹ç¼˜</strong></p><p>3Gæ— çº¿ç”µæ¥å…¥ç½‘æ˜¯3Gç”¨æˆ·çœ‹è§çš„æ— çº¿ç¬¬ä¸€è·³ç½‘ç»œã€‚</p><p>æ— çº¿ç”µç½‘æ§åˆ¶å™¨ï¼ˆRNCï¼‰é€šå¸¸æ§åˆ¶å‡ ä¸ªå°åŒºçš„æ”¶å‘åŸºç«™ï¼ŒRNCæ—¢é€šè¿‡MSCä¸ç”µè·¯è·¯äº¤æ¢èœ‚çªè¯­éŸ³ç½‘è¿æ¥ï¼Œåˆé€šè¿‡SGSNä¸åˆ†ç»„äº¤æ¢çš„å› ç‰¹ç½‘è¿æ¥ã€‚å› æ­¤ï¼Œå°½ç®¡3Gèœ‚çªè¯­éŸ³æœåŠ¡å’Œæ•°æ®æœåŠ¡ä½¿ç”¨ä¸åŒçš„æ ¸å¿ƒç½‘ï¼Œä½†ä»–ä»¬å…±äº«ä¸€ä¸ªç›¸åŒçš„ç¬¬ä¸€/æœ€åä¸€è·³æ— çº¿ç”µæ¥å…¥ç½‘ã€‚</p><p>3G UMTSåœ¨TDMAæ—¶éš™ä¸­ä½¿ç”¨<strong>ç›´æ¥åºåˆ—å®½å¸¦CDMA</strong> ï¼ˆDS-WCDMAï¼‰æŠ€æœ¯</p><h4 id="4Gï¼šLTE">4Gï¼šLTE</h4><p><strong>1. ä½“ç³»ç»“æ„ï¼šä¸€ä¸ªå…¨IPæ ¸å¿ƒç½‘</strong></p><p>4Gé•¿æœŸæ¼”è¿›äº’è”ç½‘ï¼šLTE</p><p>ç”¨æˆ·ï¼šUE  åˆ†ç»„ç½‘å…³ï¼šP-GW  ä¿è¯æœåŠ¡è´¨é‡ï¼ˆQoSï¼‰</p><p>ç‰¹ç‚¹ï¼š</p><ul><li>ä¸€ç§ç»Ÿä¸€çš„ã€å…¨IPç½‘ç»œä½“ç³»ç»“æ„ã€‚å…¨IPï¼šè¯­éŸ³å’Œæ•°æ®éƒ½æ‰¿è½½åœ¨IPæ•°æ®æŠ¥ä¸­ã€‚ï¼ˆ3Gç½‘ç»œä¸­è¯­éŸ³ã€æ•°æ®æµé‡æœ‰åˆ†ç¦»çš„ç½‘ç»œç»„ä»¶å’Œè·¯å¾„ï¼‰</li><li>4Gæ•°æ®å¹³é¢å’Œæ§åˆ¶å¹³é¢è¢«æ¸…æ™°åˆ†ç¦»ã€‚</li><li>æ— çº¿ç”µæ¥å…¥ç½‘ä¸å…¨IPæ ¸å¿ƒç½‘è¢«æ¸…æ™°åˆ†ç¦»</li><li>eNodeBæ˜¯2GåŸºç«™å’Œ3Gæ— çº¿æ·¡å¿˜ç½—æ§åˆ¶å™¨çš„é€»è¾‘åä»£ã€‚UEæ•°æ®æŠ¥åœ¨eNodeBä¸­è¢«å°è£…ï¼Œé€šè¿‡4Gç½‘ç»œçš„å…¨IPå¼ºåŒ–åˆ†ç»„ï¼ˆEPCï¼‰ä»¥éš§é“å½¢å¼ä¼ è¾“åˆ°P-GW</li><li>åˆ†ç»„æ•°æ®ç½‘ç»œç½‘å…³ï¼ˆPacket Data Network Gatewayï¼ŒP-GWï¼‰ï¼Œç»™UEåˆ†é…IPåœ°å€ï¼Œå¹¶ä¸”ä¿è¯QoSå®æ–½</li><li>æœåŠ¡ç½‘å…³ï¼ˆS-GWï¼‰ï¼Œæ•°æ®å¹³é¢çš„ç§»åŠ¨æ€§é”šç‚¹ï¼Œæ‰€æœ‰çš„UEæµé‡å°†é€šè¿‡S-GWä¼ é€’ã€‚S-GWä¹Ÿæ‰§è¡Œæ”¶è´¹ã€è®°è´¦åŠŸèƒ½ä»¥åŠæ³•å®šçš„æµé‡æ‹¦æˆª</li><li>ç§»åŠ¨æ€§ç®¡ç†å®ä½“ï¼ˆMMEï¼‰ï¼Œä»£è¡¨ä½äºå®ƒæ‰€æ§åˆ¶å•å…ƒä¸­çš„UEï¼Œæ‰§è¡Œè¿æ¥å’Œç§»åŠ¨æ€§ç®¡ç†ã€‚ä»HHSæ¥æ”¶UEè®¢è´­ä¿¡æ¯</li><li>å½’å±ç”¨æˆ·æœåŠ¡ï¼ˆHome Subscriber Server ï¼ŒHSSï¼‰åŒ…å«æ¼«æ¸¸æ¥å…¥èƒ½åŠ›ã€æœåŠ¡è´¨é‡é…ç½®æ–‡ä»¶å’Œé‰´åˆ«ä¿¡æ¯çš„UEä¿¡æ¯ï¼ŒHSSä»UEå½’å±èœ‚çªæä¾›ä¸Šå¾—åˆ°è¿™äº›ä¿¡æ¯</li></ul><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211004170036976.png" alt="image-20211004170036976"></p><p><strong>2. LETæ— çº¿ç”µæ¥å…¥</strong></p><p>LTEåœ¨ä¸‹è¡Œä¿¡é“é‡‡ç”¨FDMå’ŒTDMç»“åˆçš„æ–¹æ³• ---- æ­£äº¤é¢‘åˆ†å¤ç”¨ï¼ˆOFDMï¼‰æŠ€æœ¯</p><p>æ¯ä¸ªæ´»è·ƒçš„ç§»åŠ¨èŠ‚ç‚¹éƒ½å¯ä»¥åœ¨ä¸€ä¸ªæˆ–è€…æ›´å¤šä¸ªä¿¡é“é¢‘ç‡ä¸Šè¢«åˆ†é…ä¸€ä¸ªæˆ–å¤šä¸ª0.5msæ—¶éš™ï¼Œæ—¶éš™è¶Šå¤šï¼Œç§»åŠ¨èŠ‚ç‚¹çš„ä¼ è¾“é€Ÿç‡å°±è¶Šé«˜</p><h3 id="ç§»åŠ¨ç®¡ç†ï¼šåŸç†">ç§»åŠ¨ç®¡ç†ï¼šåŸç†</h3><p>æ°¸ä¹…å½’å±ï¼šä¸€ä¸ªç§»åŠ¨èŠ‚ç‚¹çš„æ°¸ä¹…å±…æ‰€</p><p>å½’å±ä»£ç†ï¼šå½’å±ç½‘ç»œä¸­ä»£è¡¨ç§»åŠ¨èŠ‚ç‚¹æ‰§è¡Œ çš„ç§»åŠ¨ç®¡ç†åŠŸèƒ½çš„å®ä½“ã€‚è´Ÿè´£ä¸å¤–éƒ¨ä»£ç†äº¤äº’ä»¥è·Ÿè¸ªç§»åŠ¨èŠ‚ç‚¹çš„COAï¼›ç›‘è§†åˆ°è¾¾çš„æ•°æ®æŠ¥ï¼ˆè¿™äº›æ•°æ®æŠ¥çš„å¯»å€çš„èŠ‚ç‚¹å½’å±ç½‘ç»œä¸æ­¤ç›¸åŒï¼Œä½†èŠ‚ç‚¹åœ¨å¦ä¸€ä¸ªå¤–éƒ¨ç½‘ç»œä¸­ï¼‰ï¼Œè½¬å‘ç»™å¤–éƒ¨ä»£ç†ï¼Œå¤–éƒ¨ä»£ç†å†è½¬ç»™ç§»åŠ¨èŠ‚ç‚¹ã€‚</p><p>å¤–éƒ¨ç½‘ç»œ/è¢«è®¿ç½‘ç»œï¼šç§»åŠ¨èŠ‚ç‚¹å½“å‰æ‰€åœ¨ç½‘ç»œ</p><p>å¤–éƒ¨ä»£ç†ï¼šå¤–éƒ¨ç½‘ç»œä¸­å¸®åŠ©ç§»åŠ¨èŠ‚ç‚¹åšç§»åŠ¨ç®¡ç†åŠŸèƒ½çš„å®ä½“</p><h4 id="å¯»å€">å¯»å€</h4><p>å¤–éƒ¨ä»£ç†æ”¾ç½®åœ¨å¤–éƒ¨ç½‘ç»œçš„è¾¹ç¼˜è·¯ç”±å™¨ä¸Šï¼Œ ä¸ºç§»åŠ¨èŠ‚ç‚¹åˆ›å»ºä¸€ä¸ªæ‰€è°“<strong>è½¬äº¤åœ°å€</strong>ï¼ˆCare Of Address ï¼ŒCOAï¼‰ï¼ŒCOAçš„ç½‘ç»œéƒ¨åˆ†ä¸å¤–éƒ¨ç½‘ç»œçš„ç½‘ç»œéƒ¨åˆ†åŒ¹é…</p><p>å› æ­¤ä¸€ä¸ªç§»åŠ¨èŠ‚ç‚¹å¯ä»¥å’Œä¸¤ä¸ªåœ°å€å…³è”</p><ul><li>æ°¸ä¹…åœ°å€</li><li>COAï¼ˆå¤–éƒ¨åœ°å€ï¼‰</li></ul><h4 id="è·¯ç”±é€‰æ‹©åˆ°ç§»åŠ¨èŠ‚ç‚¹">è·¯ç”±é€‰æ‹©åˆ°ç§»åŠ¨èŠ‚ç‚¹</h4><p><strong>1. ç§»åŠ¨èŠ‚ç‚¹çš„é—´æ¥è·¯ç”±é€‰æ‹©</strong></p><p><em>é€šä¿¡è€…å¦‚ä½•ç»™åœ¨ä¸€ä¸ªç½‘ç»œä¸­çš„æ‡‚èŠ‚ç‚¹å‘é€æ•°æ®æŠ¥ï¼Ÿ</em></p><ul><li>ç§»åŠ¨èŠ‚ç‚¹åˆ°å¤–éƒ¨ä»£ç†çš„åè®®ã€‚å½“ç§»åŠ¨èŠ‚ç‚¹è¿æ¥åˆ°å¤–éƒ¨ç½‘ç»œæ—¶ï¼Œå®ƒå‘å¤–éƒ¨ä»£ç†æ³¨å†Œï¼Œç¦»å¼€æ—¶å–æ¶ˆæ³¨å†Œ</li><li>å¤–éƒ¨ä»£ç†åˆ°å½’å±ä»£ç†çš„æ³¨å†Œåè®®ã€‚å¤–éƒ¨ä»£ç†å‘<strong>å½’å±ä»£ç†</strong>æ³¨å†Œç§»åŠ¨èŠ‚ç‚¹çš„COAã€‚æŸä¸ªç§»åŠ¨èŠ‚ç‚¹ç¦»å¼€ç½‘ç»œæ—¶ï¼Œå¤–éƒ¨ä»£ç†ä¸éœ€è¦æ˜¾ç¤ºåœ°æ³¨é”€COAï¼Œå› ä¸ºç§»åŠ¨èŠ‚ç‚¹åˆ°æ–°çš„ç½‘ç»œæ—¶ï¼Œå°±ä¼šæ³¨å†Œä¸€ä¸ªæ–°çš„COAï¼ˆå‘Šè¯‰è¯¥èŠ‚ç‚¹çš„å½’å±ä»£ç†ï¼Œå®Œæˆæ›¿æ¢ï¼‰</li><li>å½’å±ä»£ç†æ•°æ®æŠ¥å°è£…åè®®ã€‚é€šä¿¡è€…çš„åŸå§‹æ•°æ®å°è£…åœ¨ä¸€ä¸ªç›®çš„åœ°å€ä¸ºCOAçš„æ•°æ®æŠ¥å†…</li><li>å¤–éƒ¨ä»£ç†æ‹†å°åè®®ã€‚ä»å°è£…å·çš„ æ•°æ®æŠ¥ä¸­å»é™¤é€šä¿¡è€…çš„åŸå§‹æ•°æ®å®ï¼Œå¹¶è½¬å‘ç»™ç§»åŠ¨èŠ‚ç‚¹</li></ul><p><em>ç§»åŠ¨èŠ‚ç‚¹å¦‚ä½•ç»™ä¸€ä¸ª é€šä¿¡è€…å‘é€æ•°æ®æŠ¥ï¼Ÿ</em></p><p>ç›´æ¥å‘é€ã€‚</p><p><em>ä¼šå¯¼è‡´æ•°æ®æµä¸­æ–­å—ï¼Ÿ</em></p><p>åªè¦ç§»åŠ¨èŠ‚ç‚¹å†æ¬¡è¿æ¥åˆ°ç½‘ç»œBï¼Œå‘å½’å±ä»£ç†æ³¨å†Œæ–°çš„COAæ—¶é—´å°‘ï¼Œ åˆ™å‡ ä¹æ— ä¸¢å¤±æ•°æ®æŠ¥</p><p><strong>2. ç§»åŠ¨èŠ‚ç‚¹çš„ç›´æ¥è·¯ç”±é€‰æ‹©</strong></p><p>é—´æ¥è·¯ç”±é—®é¢˜ï¼šæ˜æ˜æœ‰æœ€çŸ­è·¯å¾„ï¼Œä½†èµ°ä¸äº†ï¼ˆå¿…é¡»ç»è¿‡è¿‡å½’å±ä»£ç†ï¼‰    -------ä¸‰è§’è·¯ç”±é€‰æ‹©é—®é¢˜</p><p>é€šä¿¡è€…æ‰€åœ¨ç½‘ç»œçš„ä¸€ä¸ªé€šä¿¡è€…ä»£ç†ï¼Œäº‹å…ˆçŸ¥é“è¯¥ç§»åŠ¨èŠ‚ç‚¹çš„COAé€šè¿‡è®©é€šä¿¡è€…ä»£ç†å‘å½’å±ä»£ç†è¯¢é—®å¾—çŸ¥ã€‚é€šä¿¡è€…ä»£ç†å°†æ•°æ®æŠ¥ç›´æ¥é€šè¿‡éš§é“æŠ€æœ¯å‘å¾€ç§»åŠ¨èŠ‚ç‚¹çš„COA</p><p>è¦æ±‚ï¼š</p><ul><li>éœ€è¦ç§»åŠ¨ç”¨æˆ·å®šä½åè®®ã€‚ä¾¿äºé€šä¿¡è€…ä»£ç†å‘å½’å±ä»£ç†æŸ¥è¯¢è·å¾—ç§»åŠ¨èŠ‚ç‚¹çš„COA</li><li>å½“é€šä¿¡è€…ä»£ç†ä¸­æŸç§»åŠ¨èŠ‚ç‚¹çš„COAè¿‡æœŸæ€ä¹ˆåŠï¼Ÿ</li></ul><p>è§£å†³ï¼š</p><p>é”šå¤–éƒ¨ä»£ç†ï¼šé¦–æ¬¡å‘ç°ç§»åŠ¨èŠ‚ç‚¹çš„å¤–éƒ¨ç½‘ç»œä¸­çš„å¤–éƒ¨ä»£ç†</p><p>å½“ä¸€ä¸ªèŠ‚ç‚¹åˆ°è¾¾æ–°å¤–éƒ¨ç½‘ç»œåï¼Œç§»åŠ¨èŠ‚ç‚¹å‘æ–°çš„å¤–éƒ¨ä»£ç†æ³¨å†Œï¼Œæ–°å¤–éƒ¨ä»£ç†å‘é”šå¤–éƒ¨ä»£ç†æä¾›ç§»åŠ¨èŠ‚ç‚¹çš„æ–°COAã€‚å½“é”šå¤–éƒ¨ä»£ç†æ”¶åˆ°ä¸€ä¸ªå‘å¾€å·²ç»ç¦»å¼€çš„ç§»åŠ¨èŠ‚ç‚¹çš„å°è£…æ•°æ®æŠ¥åï¼Œå¯ä»¥ä½¿ç”¨æ–°çš„COAé‡æ–°å°è£…æ•°æ®æŠ¥å¹¶è½¬å‘ç»™è¯¥ç§»åŠ¨èŠ‚ç‚¹ã€‚</p><p>ç¼ºç‚¹ï¼šå¢åŠ äº†å¤æ‚æ€§ï¼Œå¹¶ä¸”å¤–éƒ¨ä»£ç†ä½œä¸ºé”šå¤–éƒ¨ä»£ç†æ—¶è´Ÿè½½ä¹Ÿä¼šå¢åŠ ã€‚</p><h3 id="ç§»åŠ¨IP">ç§»åŠ¨IP</h3><p>ç§»åŠ¨èŠ‚ç‚¹ ä»¥ <strong>å›ºå®šçš„ç½‘ç»œ IP</strong> åœ°å€ , å®ç° è·¨è¶Š ä¸åŒç½‘æ®µ çš„ æ¼«æ¸¸ åŠŸèƒ½ , å¹¶èƒ½ä¿è¯ åŸºäº ç½‘ç»œ IP çš„ ç½‘ç»œæƒé™ åœ¨ æ¼«æ¸¸è¿‡ç¨‹ä¸­ ä¸å‘ç”Ÿ ä»»ä½•æ”¹å˜ ;ï¼ˆä½¿ç”¨é—´æ¥è·¯ç”±é€‰æ‹©ï¼‰</p><p><strong>æ°¸ä¹…åœ°å€</strong>ï¼šç§»åŠ¨èŠ‚ç‚¹åœ¨å½’å±ç½‘ç»œä¸­çš„åŸå§‹åœ°å€</p><p>ç§»åŠ¨IPæ ‡å‡†ï¼š</p><ul><li>ä»£ç†å‘ç°ã€‚å®šä¹‰äº†ä¸€ä¸ªå½’å±ä»£ç†æˆ–å¤–éƒ¨ä»£ç†æ¥å‘ç§»åŠ¨èŠ‚ç‚¹é€šå‘Šå…¶æœåŠ¡çš„åè®®ï¼Œä»¥åŠç§»åŠ¨èŠ‚ç‚¹è¯·æ±‚ä¸€ä¸ªå¤–éƒ¨ä»£ç†æˆ–å½’å±ä»£ç†çš„æœåŠ¡æ‰€ä½¿ç”¨çš„åè®®ã€‚</li><li>å‘å½’å±ä»£ç†æ³¨å†Œã€‚å®šä¹‰äº†ç§»åŠ¨èŠ‚ç‚¹æˆ–å¤–éƒ¨ä»£ç†å‘ ä¸€ä¸ªç§»åŠ¨èŠ‚ç‚¹çš„å½’å±ä»£ç†æ³¨å†Œæˆ–æ³¨é”€COAæ‰€ä½¿ç”¨çš„åè®®</li><li>æ•°æ®æŠ¥çš„ç®€ä»‹è·¯ç”±é€‰æ‹©ã€‚å®šä¹‰äº†æ•°æ®æŠ¥è¢«ä¸€ä¸ªå½’å±ä»£ç†è½¬å‘ç»™ç§»åŠ¨èŠ‚ç‚¹çš„æ–¹å¼ã€‚</li></ul><h4 id="ä»£ç†å‘ç°">ä»£ç†å‘ç°</h4><p>ä»£ç†å‘ç°ï¼šåˆ°è¾¾ä¸€ä¸ªæ–°ç½‘ç»œçš„ç§»åŠ¨èŠ‚ç‚¹ï¼Œå¿…é¡»çŸ¥é“å“åº”å¤–éƒ¨ä»£ç†æˆ–è€…å½’å±ä»£ç†çš„ èº«ä»½ã€‚ä¸¤ç§æ–¹å¼ï¼šç»ä»£ç†é€šå‘Šæˆ–è€…ç»ä»£ç†è¯·æ±‚</p><p><strong>1. ä»£ç†é€šå‘Š</strong></p><p>å¤–éƒ¨ä»£ç†/å½’å±ä»£ç† ä½¿ç”¨ç°æœ‰è·¯ç”±å™¨å‘ç°åè®®çš„æ‰©å±•åè®®æ¥é€šå‘ŠæœåŠ¡ã€‚ä»£ç†å‘¨æœŸæ€§åœ°åœ¨æ‰€æœ‰è¿æ¥çš„é“¾è·¯ä¸Šå¹¿æ’­ä¸€ä¸ªç±»å‹å­—æ®µä¸º9ï¼ˆè·¯ç”±å™¨å‘ç°ï¼‰çš„ICMPæŠ¥æ–‡ï¼Œå…è®¸ä¸€ä¸ªç§»åŠ¨èŠ‚ç‚¹çŸ¥é“è¯¥ä»£ç†çš„IPåœ°å€ã€‚</p><p>è¿˜åŒ…å«ä»¥ä¸‹æ‰©å±•ï¼š</p><ul><li>å½’å±ä»£ç†æ¯”ç‰¹Hï¼Œæ”¯å‡ºè¯¥ä»£ç†æ˜¯å®ƒæ‰€åœ¨ç½‘ç»œçš„ä¸€ä¸ªå½’å±ä»£ç†</li><li>å¤–éƒ¨ä»£ç†æ¯”ç‰¹F</li><li>æ³¨å†Œè¦æ±‚æ¯”ç‰¹Rï¼Œæ”¯å‡ºè¯¥ç½‘ç»œçš„ç§»åŠ¨ç”¨æˆ·å¿…é¡»å‘æŸä¸ªå¤–éƒ¨ä»£ç†æ³¨å†Œã€‚</li><li>è½¬äº¤åœ°å€COAå­—æ®µï¼Œç”±å¤–éƒ¨ä»£ç†æä¾›çš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªè½¬äº¤åœ°å€çš„åˆ—è¡¨ã€‚</li></ul><p><strong>2. ä»£ç†è¯·æ±‚</strong></p><p>ç§»åŠ¨èŠ‚ç‚¹è‡ªèº«èƒ½å¤Ÿå¹¿æ’­ä¸€ä¸ªä»£ç†è¯·æ±‚æŠ¥æ–‡ï¼Œç±»å‹å€¼ä¸º10çš„ICMPæŠ¥æ–‡ã€‚æ”¶åˆ°è¯¥è¯·æ±‚çš„ä»£ç†ç›´æ¥å‘ç§»åŠ¨èŠ‚ç‚¹<strong>å•æ’­</strong>ä¸€ä¸ªä»£ç†é€šå‘Š</p><h4 id="2-å‘å½’å±ä»£ç†æ³¨å†Œ">2. å‘å½’å±ä»£ç†æ³¨å†Œ</h4><p>ä¸€æ—¦æŸä¸ªç§»åŠ¨IPèŠ‚ç‚¹æ”¶åˆ°ä¸€ä¸ªCOAï¼Œåˆ™è¯¥åœ°å€å¿…é¡»å‘å½’å±ä»£ç†æ³¨å†Œã€‚å¯é€šè¿‡å¤–éƒ¨ä»£ç†æˆ–ç§»åŠ¨èŠ‚ç‚¹è‡ªèº«å®Œæˆã€‚</p><ul><li>ç§»åŠ¨IPèŠ‚ç‚¹æ”¶åˆ°å¤–éƒ¨ä»£ç†é€šå‘Šåï¼Œç«‹å³å‘å¤–éƒ¨ä»£ç†å‘é€ä¸€ä¸ªç§»åŠ¨IPæ³¨å†ŒæŠ¥æ–‡ã€‚æ‰¿è½½åœ¨UDPæ•°æ®æŠ¥ï¼Œç«¯å£434.åŒ…æ‹¬ï¼šç”±å¤–éƒ¨ä»£ç†é€šå‘Šçš„COAï¼›å½’å±ä»£ç†çš„åœ°å€HAã€ç§»åŠ¨èŠ‚ç‚¹çš„æ°¸ä¹…åœ°å€MAã€è¯·æ±‚çš„æ³¨å†Œå¯¿å‘½å’Œä¸€ä¸ª64æ¯”ç‰¹çš„æ³¨å†Œè¡¨ç¤ºã€‚</li><li>å¤–éƒ¨ä»£ç†æ”¶åˆ°å¹¶è®°å½•ç§»åŠ¨èŠ‚ç‚¹çš„æ°¸ä¹…IPåœ°å€ã€‚å¤–éƒ¨ä»£ç†å‘å½’å±ä»£ç†434ç«¯å£å‘é€ç§»åŠ¨IPæ³¨å†ŒæŠ¥æ–‡ã€‚å…¶ä»–ä¿¡æ¯åŒä¸Š</li><li>å½’å±ä»£ç†æ¥æ”¶æ³¨å†Œè¯·æ±‚å¹¶æ£€æŸ¥çœŸå®æ€§å’Œæ­£ç¡®æ€§ï¼ˆå› ä¸ºæ˜¯å¤–éƒ¨æ¥çš„ï¼‰ã€‚å°†ç§»åŠ¨èŠ‚ç‚¹çš„æ°¸ä¹…IPå’ŒCOAç»‘å®šåœ¨ä¸€èµ·ã€‚ä»¥ååˆ°è¾¾å½’å±ä»£ç†çš„æ•°æ®æŠ¥ä¸å‘å¾€ç§»åŠ¨èŠ‚ç‚¹çš„æ•°æ®æŠ¥éƒ½å°†è¢«å°è£…å¹¶ä»¥éš§é“æ–¹å¼å‘ç»™COAï¼Œå½’å±ä»£ç†è¿”å›ä¸€ä¸ªç§»åŠ¨IPæ³¨å†Œå›ç­”ï¼ŒåŒ…å«HAã€MAã€ä¸–çºªæ³¨å†Œå¯¿å‘½å’Œè¢«è®¤å¯çš„è¯·æ±‚æŠ¥æ–‡æ³¨å†Œè¡¨ç¤º</li><li>å¤–éƒ¨ä»£ç†æ¥æ”¶æ³¨å†Œå“åº”ï¼Œè½¬å‘ç»™ç§»åŠ¨èŠ‚ç‚¹ã€‚</li></ul><h3 id="ç®¡ç†èœ‚çªç½‘ä¸­çš„ç§»åŠ¨æ€§">ç®¡ç†èœ‚çªç½‘ä¸­çš„ç§»åŠ¨æ€§</h3><p>ä¸ç§»åŠ¨IPç±»ä¼¼ï¼ŒGSM ä½¿ç”¨é—´æ¥è·¯ç”±é€‰æ‹©æ–¹æ³•ã€‚</p><p>GSMä¸­ï¼Œç§»åŠ¨ç”¨æˆ·çš„å½’å±ç½‘ç»œ ----- &gt; ç§»åŠ¨ç”¨æˆ·çš„<strong>å½’å±å…¬å…±åœ°åŸŸç§»åŠ¨</strong>ï¼ˆPLMNï¼‰</p><p>ç§»åŠ¨ç”¨æˆ·å‘æŸä¸ªèœ‚çªç½‘çš„æä¾›å•†è®¢è´­äº†æ–¹æœåŠ¡ï¼Œåˆ™è¯¥èœ‚çªç½‘å°±ç§°ä¸ºäº†è¿™äº›ç”¨æˆ·çš„å½’å±ç½‘ç»œã€‚è¢«è®¿é—®äº†PLMNï¼Œç§°ä¸º<strong>è¢«è®¿ç½‘ç»œ</strong>ï¼Œæ˜¯ç§»åŠ¨ç”¨æˆ·å½“å‰æ‰€åœ¨ç½‘ç»œ</p><ul><li>å½’å±ç½‘ç»œç»´æŠ¤ä¸€ä¸ªå½’å±ä½ç½®æ³¨å†Œå™¨ï¼ˆHLRï¼‰çš„æ•°æ®åº“ï¼ŒåŒ…æ‹¬æ¯ä¸ªç”¨æˆ·çš„ æ°¸ä¹…èœ‚çªç”µè¯å·ç ä»¥åŠç”¨æˆ·ä¸ªäººæ¦‚è¦ä¿¡æ¯ï¼Œä¹ŸåŒ…æ‹¬è¿™äº›ç”¨æˆ·çš„å½“å‰ä½ç½®ä¿¡æ¯ã€‚å½“ä¸€ä¸ªå‘¼å«å®šä½åˆ°ä¸€ä¸ªç§»åŠ¨ç”¨æˆ·åï¼Œé€šä¿¡è€…å°†ä¸å½’å±ç½‘ç»œä¸­çš„<strong>ç½‘å…³ç§»åŠ¨æœåŠ¡äº¤æ¢ä¸­å¿ƒ</strong>ï¼ˆGMSCï¼Œå½’å±MSCï¼‰çš„ç‰¹æ®Šäº¤äº’æœºè”ç³»ã€‚</li><li>è¢«æ”¾ç½‘ç»œç»´æŠ¤ä¸€ä¸ª**è®¿é—®è€…ä½ç½®æ³¨å†Œï¼ˆ**VLRï¼‰çš„æ•°æ®åº“ã€‚ä¸ºå½“å‰åœ¨å…¶æœåŠ¡ç½‘ç»œçš„ç§»åŠ¨ç”¨æˆ·åŒ…å«ä¸€ä¸ªè¡¨é¡¹ã€‚éšç€ç”¨æˆ·çš„è¿›å…¥å’Œç¦»å¼€ç½‘ç»œå‡ºç°/æ¶ˆå¤±ã€‚</li></ul><h4 id="å¯¹ç§»åŠ¨ç”¨æˆ·å‘¼å«çš„è·¯ç”±é€‰æ‹©">å¯¹ç§»åŠ¨ç”¨æˆ·å‘¼å«çš„è·¯ç”±é€‰æ‹©</h4><p>å‘¼å«è¿‡ç¨‹</p><ul><li>é€šä¿¡è€…æ‰“ç”µè¯ï¼ˆå·ç çš„å‰å‡ ä½è¶³ä»¥å…¨å±€åˆ¤åˆ«ç§»åŠ¨ç”¨æˆ·çš„å½’å±ç½‘ç»œï¼‰ã€‚å‘¼å«ä»é€šä¿¡è€…é€šè¿‡å…¬å…±äº¤æ¢ç”µè¯ç½‘åˆ°è¾¾ç§»åŠ¨ç”¨æˆ·å½’å±ç½‘ç»œä¸­çš„GMSCã€‚</li><li>GMSCæ”¶åˆ°å‘¼å«è¢«æŸ¥è¯¢HLRæ¥ç¡®å®šç§»åŠ¨ç”¨æˆ·çš„ä½ç½®ã€‚æœ€ç®€å•æƒ…å†µä¸‹ï¼ŒHLRè¿”å›ç§»åŠ¨ç«™ç‚¹æ¼«æ¸¸å·ç ï¼ˆMSRNï¼Œæ¼«æ¸¸å·ç ï¼‰ã€‚æ¼«æ¸¸å·ç æ˜¯çŸ­æš‚çš„ï¼ˆç±»ä¼¼COAçš„ä½œç”¨ï¼Œå¯¹é€šä¿¡è€…å’Œç§»åŠ¨ç”¨æˆ·ä¸å¯è§ï¼‰ï¼›å¦‚æœHLRä¸å…·æœ‰è¯¥æ¼«æ¸¸å·ç ï¼Œåˆ™è¿”å›è¢«è®¿ç½‘ç»œä¸­çš„VLRåœ°å€ï¼ŒGMSCéœ€è¦æŸ¥è¯¢VLRï¼ˆï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼‰æ¥è·å–ç§»åŠ¨èŠ‚ç‚¹çš„æ¼«æ¸¸å·ç ã€‚</li><li>GMSCé€šè¿‡ç½‘ç»œåˆ°è¾¾è¢«è®¿ç½‘ç»œçš„MSCå»ºç«‹å‘¼å«çš„ç¬¬äºŒæ­¥ã€‚</li></ul><p>é€šä¿¡è€…----&gt; GMSCâ€”&gt; è¢«è®¿MSC</p><p><em>ä½†HLRå¦‚ä½•è·å¾—ç§»åŠ¨ç”¨æˆ·çš„ä½ç½®ä¿¡æ¯ï¼Ÿ</em></p><h4 id="GSMä¸­çš„åˆ‡æ¢">GSMä¸­çš„åˆ‡æ¢</h4><p>å‘¼å«è¿‡ç¨‹ä¸­ï¼Œç§»åŠ¨ç«™ç‚¹å°†å…¶å…³è”çš„ä¸€ä¸ªåŸºç«™æ”¹å˜åˆ°å¦ä¸€ä¸ªåŸºç«™æ—¶å‡ºç°<strong>åˆ‡æ¢</strong></p><p>åˆ‡æ¢å‘ç”Ÿçš„åŸå› :</p><ul><li>å½“å‰åŸºç«™ä¸ç§»åŠ¨ç”¨æˆ·ä¿¡å·è¿‡å¼±ï¼Œå‘¼å«å¯èƒ½è¢«ä¸­æ–­</li><li>ä¸€ä¸ªèœ‚çªå¤„ç†çš„å‘¼å«å¤ªå¤šï¼Œè´Ÿè½½å¤ªå¤§</li></ul><p>å¦‚ä½•åˆ‡æ¢  P.377</p><p>ä¸åŒçš„æ–¹å¼ï¼šé”šMSC å’Œ æ–°æ—§MSCè½¬å‘</p><p><strong>ç§»åŠ¨IPå’ŒGSMç§»åŠ¨æ€§é—´çš„å…±æ€§</strong></p><h3 id="æ— çº¿æ€§å’Œç§»åŠ¨æ€§ï¼šå¯¹é«˜å±‚åè®®çš„å½±å“">æ— çº¿æ€§å’Œç§»åŠ¨æ€§ï¼šå¯¹é«˜å±‚åè®®çš„å½±å“</h3><p>æ— çº¿ç½‘ç»œåœ¨é“¾è·¯å±‚ï¼ˆè¡°å‡ã€å¤šè·¯å¾„ã€éšè—ç»ˆç«¯ï¼‰ç­‰é—®é¢˜å’Œç½‘ç»œå±‚ï¼ˆç§»åŠ¨ç”¨æˆ·æ”¹å˜ä¸ç½‘ç»œçš„è¿æ¥ç‚¹ï¼‰ä¸æœ‰çº¿ç½‘ç»œçš„å¯¹åº”ç‰©æœ‰é‡å¤§åŒºåˆ«ï¼Œåœ¨è¿è¾“å±‚å’Œåº”ç”¨å±‚æ˜¯å¦ä¹Ÿæœ‰åŒºåˆ«ï¼Ÿ</p><p>è¿è¾“å±‚åè®®ï¼ˆç‰¹åˆ«æ˜¯TCPï¼‰åœ¨æœ‰çº¿å’Œæ— çº¿ç½‘ç»œä¸­æœ‰å®Œå…¨ä¸åŒçš„æ€§èƒ½</p><p>ç”±äºæ— çº¿ä¿¡é“çš„é«˜æ¯”ç‰¹å·®é”™ç‡å’Œåˆ‡æ¢ä¸¢å¤±çš„å¯èƒ½ï¼ŒTCPæ‹¥å¡æ§åˆ¶ååº”å¯èƒ½æœ‰é—®é¢˜ï¼ˆå‘é€æ–¹ å¹¶ä¸çŸ¥é“æ˜¯å› ä¸ºæ‹¥å¡è¿˜æ˜¯åˆ‡æ¢è¿‡ç¨‹ä¸­æœ‰æ¯”ç‰¹å·®é”™è¢«ä¸¢å¼ƒï¼‰ã€‚è§£å†³æ–¹æ¡ˆï¼š</p><ul><li>æœ¬åœ°æ¢å¤ã€‚åœ¨æ¯”ç‰¹å·®é”™å‡ºç°çš„å½“æ—¶å’Œå½“åœ° å°†å…¶æ¢å¤</li><li>TCPå‘é€æ–¹çŸ¥æ™“æ— çº¿é“¾è·¯ã€‚è®©TCPå‘é€æ–¹å’Œæ¥æ”¶æ–¹çŸ¥æ™“æ— çº¿é“¾è·¯çš„å­˜åœ¨ï¼Œä»è€Œå°†æœ‰çº¿ç½‘ç»œä¸­å‘ç”Ÿçš„æ‹¥å¡æ€§ä¸¢åŒ…å’Œæ— çº¿ç½‘ç»œä¸­å‘ç”Ÿçš„å·®é”™/ä¸¢åŒ…åŒºåˆ†å¼€æ¥</li><li>åˆ†ç¦»è¿æ¥æ–¹æ³•ã€‚åˆ†ç¦»æˆä¸¤ä¸ªè¿è¾“å±‚è¿æ¥:ç§»åŠ¨ä¸»æœºåˆ°æ— çº¿æ¥å…¥ç‚¹ â€” æ— çº¿æ¥å…¥ç‚¹åˆ°å…¶ä»–é€šä¿¡ç«¯ç‚¹ï¼ˆä¹Ÿå³ æ— çº¿éƒ¨åˆ† + æœ‰çº¿éƒ¨åˆ†ï¼‰ç»è¿‡æ— çº¿æ®µçš„è¿è¾“å±‚èƒ½å¤Ÿæ˜¯ä¸€ä¸ªTCPï¼Œæˆ–æ˜¯ä¸€ä¸ªç‰¹åˆ«å®šåˆ¶è¿è¡Œåœ¨UDPä¸Šçš„å·®é”™æ¢å¤åè®®</li></ul><h2 id="è®¡ç®—æœºç½‘ç»œçš„å®‰å…¨">è®¡ç®—æœºç½‘ç»œçš„å®‰å…¨</h2><p>ä¸‰ç§æ”»å‡»æ–¹å¼</p><ul><li>å”¯å¯†æ–‡æ”»å‡»ã€‚å…¥ä¾µè€…åªèƒ½å¾—åˆ°æˆªå–çš„å¯†æ–‡ï¼Œä¸äº†è§£æ˜æ–‡æŠ¥æ–‡çš„å†…å®¹</li><li>å·²çŸ¥æ˜æ–‡æ”»å‡»ã€‚ç¡®ä¿¡å¯†æ–‡ã€æ˜æ–‡ä¸­æœ‰ä¸€äº›åŒ¹é…â€¦</li><li>é€‰æ‹©æ˜æ–‡æ”»å‡»ã€‚å…¥ä¾µè€…èƒ½å¤Ÿé€‰æ‹©æŸä¸€æ˜æ–‡æŠ¥æ–‡å¹¶ä¸”å¾—åˆ°è¯¥æ˜æ–‡æŠ¥æ–‡å¯¹åº”çš„å¯†æ–‡å½¢å¼</li></ul><h3 id="åŠ å¯†æŠ€æœ¯">åŠ å¯†æŠ€æœ¯</h3><h4 id="å¯¹ç§°å¯†é’¥å¯†ç ä½“è´¨">å¯¹ç§°å¯†é’¥å¯†ç ä½“è´¨</h4><p>å•ç ä»£æ›¿å¯†ç ---- &gt; å¤šç ä»£æ›¿å¯†ç </p><p>ä¸¤ç§å¯¹ç§°åŠ å¯†æŠ€æœ¯ï¼š</p><ul><li>æµå¯†ç </li><li>å—å¯†ç </li></ul><p><strong>1. å—å¯†ç </strong></p><p>è¦åŠ å¯†çš„æŠ¥æ–‡è¢«å¤„ç†æˆkæ¯”ç‰¹çš„å—ï¼Œæ¯å—è¢«ç‹¬ç«‹åŠ å¯†ã€‚kæ¯”ç‰¹æ˜æ–‡è¢«æ˜ å°„æˆkæ¯”ç‰¹å¯†æ–‡</p><p>é€šå¸¸ä½¿ç”¨å‡½æ•°æ¨¡æ‹Ÿéšæœºæ’åˆ—è¡¨ï¼Œåˆ†å—æˆè¡Œï¼Œç”¨æ›´å°‘çš„è§„åˆ™å¾ªç¯åœ°ç»™æ¯è¡ŒåŠ å¯†    P. 390</p><p>eg. DFS(æ•°æ®åŠ å¯†æ ‡å‡†)ã€3DES ã€AESï¼ˆé«˜çº§åŠ å¯†æ ‡å‡†ï¼‰éƒ½ä½¿ç”¨äº†æ¯”ç‰¹ä¸²ä½œä¸ºå¯†é’¥</p><p><strong>2. å¯†ç å—é“¾æ¥</strong></p><p>ç›¸åŒçš„æ˜æ–‡é€šè¿‡å—å¯†ç è¢«é‡å¤åŠ å¯†ä¸ºç›¸åŒçš„å¯†æ–‡ï¼Œå¯èƒ½è¢«çŒœå‡º</p><p>å—å¯†ç  ^ ç­‰æ¯”ç‰¹éšæœºæ•°</p><p>ä½†ä¼ è¾“æ¯”ç‰¹ * 2 â€“ &gt; è§£å†³æ–¹æ¡ˆ   å¯†ç å—é“¾æ¥(CBC)ï¼Œä»…éšç¬¬ä¸€ä¸ªæŠ¥æ–‡å‘é€ä¸€ä¸ªéšæœºå€¼ï¼Œå‘é€æ–¹å’Œæ¥æ”¶æ–¹æ˜¯ä½¿ç”¨è®¡ç®—çš„ç¼–ç å—ä»£æ›¿åé¢çš„éšæœºæ•°ã€‚</p><p>P. 392</p><h4 id="å…¬å¼€å¯†é’¥åŠ å¯†">å…¬å¼€å¯†é’¥åŠ å¯†</h4><p>å…¬é’¥ã€ç§é’¥    K<sup>+</sup>(K<sup>-</sup>(M)) = K<sup>-</sup>(K<sup>+</sup>(M))  = M</p><p>ä½†æœ‰ä¸¤ä¸ªé—®é¢˜ï¼š</p><ol><li>å…¥ä¾µè€…å¯ä»¥é€šè¿‡æˆ‘ä¸»æœºçš„å…¬é’¥ é€‰æ‹©æ˜æ–‡æ”»å‡»ï¼Œå¯ä»¥æ ¹æ®æ˜æ–‡å»çŒœå¯†æ–‡</li><li>ä»»ä½•ä¸€ä¸ªäººéƒ½å¯ä»¥å‘æˆ‘å‘é€ç”¨æˆ‘çš„å…¬é’¥åŠ å¯†çš„æŠ¥æ–‡ï¼Œä¼šæœ‰ä¼ªé€ å‘é€æ–¹çš„ç°è±¡</li></ol><p>è§£å†³æ–¹æ¡ˆï¼š</p><p><strong>1. RSA</strong></p><p>å¹¿æ³›ä½¿ç”¨äº†æ¨¡nç®—æœ¯çš„è¿ç®—</p><p>(a mod n)<sup>d</sup> mod n = a<sup>d</sup> mod n</p><p>ä¸¤å¤§æ­¥éª¤</p><ul><li>é€‰æ‹©å…¬é’¥å’Œç§é’¥</li><li>åŠ å¯†å’Œè§£å¯†ç®—æ³•</li></ul><p>å…·ä½“æ­¥éª¤</p><ul><li>é€‰æ‹©ä¸¤ä¸ªå¤§ç´ æ•° p qã€‚å€¼è¶Šå¤§ï¼Œç ´è§£RSAè¶Šå›°éš¾ã€‚pã€qä¹˜ç§¯ä¸º1024æ¯”ç‰¹çš„æ•°é‡çº§è¾ƒå¥½</li><li>è®¡ç®—n=qpå’Œz = (p-1)(q-1)</li><li>é€‰æ‹©å°äºnçš„æ•°eï¼Œä½¿å¾—eå’Œzæ²¡æœ‰é1çš„å…¬å› æ•°ã€‚eç”¨äºåŠ å¯†</li><li>æ±‚ä¸€ä¸ªæ•°dï¼Œä½¿å¾—ed-1èƒ½è¢«zæ•´é™¤ã€‚dç”¨äºè§£å¯†</li><li>å…¬é’¥ K<sup>+</sup> = (n,e),ç§é’¥  K<sup>-</sup> = (n,d)</li></ul><p>æ‰§è¡Œæ­¥éª¤</p><ul><li>æˆ‘ç»™ä»–å‘ä¸€ä¸ªmæ•´æ•°è¡¨ç¤ºçš„æ¯”ç‰¹ç»„åˆã€‚m&lt;nï¼Œä¸ºäº†æ‰§è¡Œç¼–ç ï¼Œæˆ‘å°†æ‰§è¡Œm<sup>e</sup>è®¡ç®—è¿™ä¸ªæ•°è¢«né™¤çš„æ•´æ•°ä½™æ•°ã€‚å³åŠ å¯†å€¼ï¼š c = m<sup>e</sup> mod nï¼Œå‘é€ç»™ä»–</li><li>ä»–è¦è§£å¯†ï¼Œè®¡ç®— m = c<sup>d</sup> mod n</li></ul><p><strong>2. ä¼šè¯å¯†é’¥</strong></p><p>RSAæŒ‡æ•°è¿ç®—ååˆ†è€—æ—¶ï¼Œå®é™…åº”ç”¨ä¸­ï¼ŒRSAé€šå¸¸ä¸å¯¹ç§°å¯†é’¥å¯†ç </p><p>Sendå…ˆé€‰æ‹©ä¸€ä¸ªä¼šè¯å¯†é’¥ K<sub>s</sub> è¿™ä¸ªå¯†é’¥å¿…é¡»å…±äº«ç»™Receiveã€‚Sendç”¨Recçš„RSAå…¬é’¥æ¥åŠ å¯†è¯¥å¯†é’¥ï¼ŒRecæ”¶åˆ°åï¼Œè§£å¯†å¾—åˆ°å¯†é’¥ã€‚</p><p><strong>3. RSAå·¥ä½œåŸç†</strong></p><p>ç®—æœ¯è¯æ˜ P. 396</p><p>RSAçš„å®‰å…¨æ€§ä¾èµ–äºè¿™æ ·ä¸€ä¸ªäº‹å®ï¼šç›®å‰æ²¡æœ‰å·²çŸ¥çš„ç®—æ³•æ¶æ„å¿«é€Ÿè¿›è¡Œä¸€ä¸ªæ•°çš„å› æ•°åˆ†è§£ï¼Œè¿™ç§æƒ…å†µä¸‹å…¬å¼€å€¼næ— æ³•å¿«é€Ÿåˆ†è§£å‡ºç´ æ•°på’Œqï¼Œä½†ä¹Ÿä¸ç¡®å®šæ˜¯å¦ä»¥åå°±ä¸€ç›´æ²¡æœ‰è¿™æ ·çš„ç®—æ³•ã€‚</p><h3 id="æŠ¥æ–‡å®Œæ•´æ€§å’Œæ•°å­—ç­¾å">æŠ¥æ–‡å®Œæ•´æ€§å’Œæ•°å­—ç­¾å</h3><p>ç¡®ä¿æ²¡æœ‰è¢«æ›´æ”¹</p><h4 id="å¯†ç æ•£åˆ—å‡½æ•°">å¯†ç æ•£åˆ—å‡½æ•°</h4><p>å…·æœ‰æ€§è´¨ï¼š</p><p>æ‰¾åˆ°ä¸¤ä¸ªä¸åŒçš„æŠ¥æ–‡x,yä½¿å¾—H(x) = H(y)ï¼Œåœ¨è®¡ç®—ä¸Šæ˜¯ä¸å¯èƒ½çš„ï¼ˆä¾‹å¦‚å› ç‰¹ç½‘æ ¡éªŒå’Œå’ŒCRCï¼‰</p><p>ä½†å› ç‰¹ç½‘æ ¡éªŒå’Œä¸å¤ªä¸¥æ ¼ï¼Œå¯èƒ½æœ‰ä¸¤ä¸ªç›¸åŒçš„å­—ç¬¦ä¸²æœ‰æ ¡éªŒå’Œ</p><p><strong>MD5æ•£åˆ—ç®—æ³•</strong></p><p>é€šè¿‡å››æ­¥è¿‡ç¨‹è®¡ç®—å¾—åˆ°128æ¯”ç‰¹çš„æ•£åˆ—</p><ul><li>å¡«å……ï¼šå…ˆå¡«1ï¼Œç„¶åå¡«è¶³å¤Ÿå¤šçš„0ï¼ŒçŸ¥é“æŠ¥æ–‡é•¿åº¦æ»¡è¶³ä¸€å®šæ¡ä»¶</li><li>æ·»åŠ ï¼šåœ¨å¡«å……å‰æ·»åŠ ä¸€ä¸ªç”¨64bitè¡¨ç¤ºçš„æŠ¥æ–‡é•¿åº¦</li><li>åˆå§‹åŒ–ç´¯è®¡å™¨</li><li>å¾ªç¯ï¼šåœ¨æœ€åçš„å¾ªç¯æ­¥éª¤ï¼Œå¯¹æŠ¥æ–‡çš„16å­—å—è¿›è¡Œ4è½®å¤„ç†</li></ul><p>ä½œç”¨ï¼š</p><ol><li>å¯†ç ä¿æŠ¤</li><li>å®Œæ•´æ€§éªŒè¯</li><li>æ•°å­—ç­¾å</li></ol><p>(MD5ç®—æ³•ä»‹ç»)[<a href="https://www.bilibili.com/video/BV1u44y1z7t1?from=search&amp;seid=8959130404275666978&amp;spm_id_from=333.337.0.0">https://www.bilibili.com/video/BV1u44y1z7t1?from=search&amp;seid=8959130404275666978&amp;spm_id_from=333.337.0.0</a>]</p><p><strong>å®‰å…¨æ•£åˆ—ç®—æ³•SHAï¼ˆSecurity Hash Algorithmï¼‰â€“1</strong></p><h4 id="æŠ¥æ–‡é‰´åˆ«ç ">æŠ¥æ–‡é‰´åˆ«ç </h4><p>é‰´åˆ«å¯†é’¥s</p><p><strong>æŠ¥æ–‡é‰´åˆ«ç </strong>(MAC, Message Authentication Code)ï¼š  sçº§è”æ˜æ–‡mï¼Œè®¡ç®—æ•£åˆ—å¾—åˆ°H(m+s)</p><p>ä½œç”¨ï¼šé˜²æ­¢åˆ«äººä¹Ÿé€šè¿‡æ•£åˆ—æ–¹æ³•ä¼ªé€ è¯·æ±‚</p><p><em>å¦‚ä½•å‘é€šä¿¡å®ä½“åˆ†å‘å…±äº«çš„é‰´åˆ«å¯†é’¥ï¼Ÿ</em></p><h4 id="æ•°å­—ç­¾å">æ•°å­—ç­¾å</h4><p>æŒ‡å‡ºä¸€ä¸ªæ–‡ä»¶çš„çš„æ‰€æœ‰è€…ï¼Œï¼ˆæ˜¯æˆ‘å†™çš„è¿™ä¸ªï¼‰ï¼Œè¯æ˜æŸä¸ªäººåœ¨ä¸€ä¸ªæ–‡ä»¶ä¸Šçš„ç­¾åç¡®å®æ˜¯è¿™ä¸ªäººç­¾ç½²çš„ï¼ˆå¯éªŒè¯æ€§ï¼‰ï¼Œä¸”åªæœ‰é‚£ä¸ªäººèƒ½ç­¾ç½²è¿™ä¸ªæ–‡ä»¶ï¼ˆä¸å¯ä¼ªé€ æ€§ï¼‰</p><p>ç”¨ç§é’¥åŠ å¯†æŠ¥æ–‡m  ï¼Œå¯¹æ–¹ç”¨å…¬é’¥è§£å¯†</p><p>ä½†ç›´æ¥å¯¹æŠ¥æ–‡åŠ è§£å¯†å¼€é”€éå¸¸å¤§ï¼Œæ‰€ä»¥ç»å¸¸è®¡ç®—è¯¥æŠ¥æ–‡çš„ä¸€ä¸ªå›ºå®šé•¿åº¦çš„æ•°æ®â€œæŒ‡çº¹â€ã€‚<strong>å¯¹æŠ¥æ–‡çš„æ•£åˆ—ç­¾åè€Œä¸æ˜¯å¯¹æŠ¥æ–‡çš„æœ¬èº«ç­¾å</strong></p><p><strong>å…¬é’¥è®¤è¯</strong></p><p>å¯¹è·å¾—å…¬é’¥çš„ éªŒè¯ï¼Œä»æºå¤´ä¸Šç¡®å®šè¿™æ˜¯ä½ </p><p>æ•°å­—ç­¾åçš„ä¸€ä¸ªé‡è¦åº”ç”¨ï¼Œè¯å®ä¸€ä¸ªå…¬é’¥å±äºæŸä¸ªç‰¹å®šçš„å®ä½“ï¼Œåº”ç”¨äºè®¸å¤šå®‰å…¨ç½‘ç»œåè®®ä¸­ï¼ŒSSLå’ŒIPsec</p><p>å…¬é’¥ä¸ç‰¹å®šå®ä½“çš„ç»‘å®šï¼Œ<strong>è®¤è¯ä¸­å¿ƒ</strong>ï¼ˆ<strong>CA</strong>ï¼ŒCertification Authoriityï¼‰</p><p>ä½œç”¨ï¼š</p><ul><li>è¯å®ä¸€ä¸ªå®ä½“ï¼ˆä¸€å°æœºå™¨ã€è·¯ç”±å™¨ï¼‰çš„çœŸå®èº«ä»½ï¼Œå¯¹CAå¿…é¡»å®Œå…¨ä¿¡ä»»</li><li>ä¸€æ—¦CAéªŒè¯äº†æŸä¸ªå¸ˆå¤ªçš„èº«ä»½ï¼ŒCAå°†ç”Ÿæˆä¸€ä¸ªä¸å…¶èº«ä»½å’Œå®ä½“å…¬é’¥ç»‘å®šçš„è¯ä¹¦ã€‚è¯ä¹¦ä¸­åŒ…å«äº†è¿™ä¸ªå…¬é’¥å’Œå…¬é’¥æ‰€æœ‰è€…å…¨å±€å”¯ä¸€çš„èº«ä»½è¡¨ç¤ºä¿¡æ¯ï¼ˆä¾‹å¦‚å®ƒçš„IPåœ°å€ï¼‰ï¼Œç”±CAå¯¹è¿™ä¸ªè¯ä¹¦è¿›è¡Œæ•°å­—ç­¾åï¼ˆç”¨CAçš„ç§é’¥ï¼‰</li></ul><p>åœ¨è¯·æ±‚å…¬é’¥çš„åŒæ—¶ï¼Œä¹Ÿä¼šå‘é€CAç­¾ç½²çš„è¯ä¹¦ï¼Œç”¨CAçš„å…¬é’¥è§£å¯†ï¼Œæ¥éªŒè¯å¯¹æ–¹å…¬é’¥çš„å®‰å…¨æ€§</p><h3 id="ç«¯ç‚¹é‰´åˆ«">ç«¯ç‚¹é‰´åˆ«</h3><p>ä¸€ä¸ªå®ä½“ç»è¿‡è®¡ç®—æœºç½‘ç»œå‘å¦ä¸€ä¸ªå®ä½“è¯æ˜<strong>è‡ªå·±</strong>èº«ä»½çš„è¿‡ç¨‹ï¼ˆä¹‹å‰è®¨è®ºçš„æ˜¯é‰´åˆ«ä»–äººèº«ä»½ï¼‰ï¼Œå³å¦‚ä½•å˜å¾—è¢«å¯é‰´åˆ«ï¼Ÿ</p><p>é‰´åˆ«åè®®ï¼ŒAP</p><p><strong>é‰´åˆ«åè®® ap1.0</strong></p><p>æˆ‘å°±æ˜¯æˆ‘</p><p><strong>é‰´åˆ«åè®® ap2.0</strong></p><p>åŠ å…¥IPåœ°å€</p><p>é—®é¢˜ï¼šIPå“„éª—</p><p><strong>é‰´åˆ«åè®® ap3.0</strong></p><p>ä½¿ç”¨ç§˜å¯†å£ä»¤ï¼Œåˆæ˜¯ä¸€ä¸ªå…±äº«ç§˜å¯†ã€‚Gmailã€Telnetã€FTPæœåŠ¡ä½¿ç”¨</p><p>å£ä»¤çš„å‘é€è¿‡ç¨‹å¯èƒ½è¢«çªƒå¬</p><p><strong>é‰´åˆ«åè®® ap3.1</strong></p><p>ç§˜å¯†å£ä»¤ + åŠ å¯†å£ä»¤ï¼Œç±»ä¼¼å…¬é’¥ç§é’¥çš„åŠ è§£å¯†æ–¹å¼ï¼ŒåŒæ–¹å…±äº«ä¸€ä¸ªå¯¹ç§°ç§˜å¯†å¯†é’¥</p><p>é—®é¢˜ï¼šå›æ”¾æ”»å‡»ï¼Œç›‘å¬å‘ä»¶äººé€šä¿¡å¹¶ä¼ªè£…æˆå‘ä»¶äººï¼ˆæˆ‘ä¸çŸ¥é“è¿™æ˜¯ä½ ç¬¬å‡ æ¬¡åœ¨è·Ÿæˆ‘è¯´ä½ åœ¨ä¸åŒçš„è®¾å¤‡ï¼‰</p><p><strong>é‰´åˆ«åè®® ap4.0</strong></p><p>ä¸é‡æ•°ï¼šåœ¨ä¸€ä¸ªåè®®çš„ç”Ÿå­˜æœŸå†…åªä½¿ç”¨ä¸€æ¬¡çš„æ•°ã€‚</p><p>åŠ å¯†è¿‡ç¨‹ï¼š</p><ul><li>Aliceå‘Bobå‘é€æŠ¥æ–‡</li><li>Bobé€‰æ‹©ä¸€ä¸ªä¸é‡æ•°Rï¼Œå‘ç»™Aliceï¼Œè¿™ä¸ªæ•°å¯èƒ½è¢«çªƒå¬</li><li>Aliceä½¿ç”¨ä»–ä¸Bobå…±äº«çš„å¯¹ç§°å¯†é’¥ï¼ŒåŠ å¯†è¿™ä¸ªRï¼ŒæŠŠåŠ å¯†çš„ä¸é‡æ•°Kï¼ˆRï¼‰è¿”å›ç»™Bobï¼Œè¿™ä¸ªä¸é‡æ•°è¯æ˜Aliceè¿˜æ˜¯æ´»è·ƒçš„ã€‚</li></ul><h3 id="å®‰å…¨ç”µå­é‚®ä»¶">å®‰å…¨ç”µå­é‚®ä»¶</h3><p>å› ç‰¹ç½‘åœ¨å¤šä¸ªå±‚æ¬¡ä¸Šæä¾›å®‰å…¨æ€§åŠŸèƒ½</p><p>åŸå› ï¼š</p><ul><li>æä¾›ç”¨æˆ·çº§åˆ«çš„å®‰å…¨æ€§</li><li>åœ¨é«˜å±‚éƒ¨ç½²æ–°çš„å› ç‰¹ç½‘æœåŠ¡è¾ƒä¸ºå®¹æ˜“ã€‚</li></ul><h4 id="å®‰å…¨ç”µå­é‚®ä»¶-v2">å®‰å…¨ç”µå­é‚®ä»¶</h4><p>ä¼šè¯å¯†é’¥ + æ•°å­—ç­¾å</p><h4 id="PGP">PGP</h4><p>Pretty Good Privacy ï¼Œç”µå­é‚®ä»¶åŠ å¯†æ–¹æ¡ˆ</p><p>æ•°å­—ç­¾å + å…¬å¼€å¯†é’¥å¯¹ + æ•£åˆ—</p><h3 id="TCPè¿æ¥å®‰å…¨ï¼šSSL">TCPè¿æ¥å®‰å…¨ï¼šSSL</h3><p>å®‰å…¨å¥—æ¥å­—å±‚ï¼ˆSecure Socket Layerï¼ŒSSLï¼‰</p><p>TCPçš„å¼ºåŒ–ç‰ˆæœ¬ï¼Œ<strong>æœºå¯†æ€§ã€æ•°æ®å®Œæ•´æ€§ã€ç«¯ç‚¹é‰´åˆ«</strong></p><p>SSLç‰ˆæœ¬çš„åŠ å¼ºç‰ˆæœ¬ è¿è¾“å±‚å®‰å…¨æ€§ï¼ŒTLSï¼ˆTransport Layer Securityï¼‰</p><p>SSLä½¿å¾—TCPå®‰å…¨äº†ï¼Œèƒ½å¤Ÿåº”ç”¨äºè¿è¡Œåœ¨TCPä¸Šçš„ä»»ä½•åº”ç”¨ç¨‹åºï¼Œæä¾›äº†ä¸€ä¸ªç®€å•çš„å…·æœ‰å¥—æ¥å­—çš„åº”ç”¨ç¼–ç¨‹æ¥å£ï¼ˆAPIï¼‰ï¼Œç±»ä¼¼TCPçš„APIã€‚ï¼ˆå°½ç®¡SSLæŠ€æœ¯ä¸Šä½äºåº”ç”¨å±‚ï¼Œä½†å®ƒå´æä¾›TCPæœåŠ¡çš„è¿è¾“åè®®ï¼‰</p><p>å¸Œæœ›ç­‰åˆ°TCPä¼šè¯ç»“æŸæ‰éªŒè¯æ‰€æœ‰çš„æ•°æ®å®Œæ•´æ€§ã€‚<br>è§£å†³ï¼šSSLå°†æ•°æ®æµåˆ†å‰²æˆè®°å½•ï¼Œå¯¹æ¯ä¸ªè®°å½•é™„åŠ ä¸€ä¸ªMACç”¨äºéªŒè¯å®Œæ•´æ€§ï¼Œç„¶ååŠ å¯†è¯¥â€œè®°å½•+MACâ€ï¼Œä½†å¦‚æœæœ‰äººæ›´æ”¹äº†è®°å½•è¡¨çš„éƒ¨åˆ†é¡ºåºï¼Œåˆ™æŠ¥æ–‡å®Œæ•´æ€§è¢«ç ´åã€‚</p><p>è§£å†³æ–¹å¼ï¼š<strong>SSLåºå·</strong></p><p>å‘é€æ–¹SSLç»´æŠ¤ä¸€ä¸ªåºå·è®¡æ•°å™¨ï¼Œæ¯å‘ä¸€ä¸ªSSLè®°å½•ï¼Œå°±+1ï¼Œè®¡ç®—MACæ—¶ï¼Œå°±æŠŠåºå·åŒ…æ‹¬åœ¨MACçš„è®¡ç®—ä¸­ã€‚æ¥å—æ–¹é€šè¿‡è·Ÿè¸ªå‘é€æ–¹çš„åºå·ï¼Œé€šè¿‡åœ¨MACçš„è®¡ç®—ä¸­åŒ…æ‹¬é€‚å½“çš„åºå·ï¼Œæ¥éªŒè¯ä¸€æ¡è®°å½•çš„å®Œæ•´æ€§ã€‚SSLåºå·çš„ä½¿ç”¨ç»„ç»‡äº†ç¬¬ä¸‰æ–¹æ‰§è¡Œé‡æ’åºè®°å½•æˆ–é‡æ”¾æŠ¥æ–‡æ®µç­‰ä¸­é—´äººåŠŸèƒ½æœº</p><p><strong>æ³¨æ„SSLåºå·å’Œä¸é‡æ•°çš„ä½œç”¨</strong></p><p>é˜²æ­¢è¿æ¥é‡æ”¾  é˜²æ­¢åœ¨ä¸€ä¸ªè¿›è¡Œä¸­çš„ä¼šè¯é‡æ”¾ä¸ªåˆ«åˆ†ç»„</p><p><strong>SSLè®°å½•</strong></p><p>ç±»å‹ + ç‰ˆæœ¬+ é•¿åº¦ + æ•°æ®å’ŒMACçš„å¯†é’¥åŠ å¯†ç»“æœ</p><h4 id="è¿‡ç¨‹-v2">è¿‡ç¨‹</h4><p>ä¼ªè¿‡ç¨‹ P.412</p><ol><li><p><strong>SSLæ¡æ‰‹</strong></p><ol><li>Clientå‘é€å®ƒæ”¯æŒçš„å¯†ç ç®—æ³•åˆ—è¡¨ï¼Œä»¥åŠä¸é‡æ•°</li><li>Serverä»åˆ—è¡¨ä¸­é€‰æ‹©ä¸€ç§å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œä¸€ç§å…¬é’¥ç®—æ³•ï¼Œä¸€ç§MACç®—æ³•ã€‚æŠŠè¿™äº›é€‰æ‹©ä»¥åŠè¯ä¹¦å’Œä¸€ä¸ªæœåŠ¡å™¨ä¸é‡æ•°è¿”å›ç»™client</li><li>å®¢æˆ·éªŒè¯è¯¥è¯ä¹¦ï¼Œæå–æœåŠ¡å™¨å…¬é’¥ï¼Œç”Ÿæˆä¸€ä¸ªå‰ä¸»å¯†é’¥ï¼ˆPMSï¼‰ï¼Œç”¨æœåŠ¡å™¨çš„å…¬é’¥åŠ å¯†è¯¥PMSï¼Œå¹¶å°†åŠ å¯†çš„PMSå‘é€ç»™server</li><li>clientå’Œserverç‹¬ç«‹åœ°ä»PMSå’Œä¸é‡æ•°ä¸­è®¡ç®—å‡ºä¸»å¯†é’¥MSï¼ŒMSè¢«åˆ‡ç‰‡ä»¥ç”Ÿæˆä¸¤ä¸ªå¯†ç å’Œä¸¤ä¸ªMACå¯†é’¥ã€‚</li><li>clientå‘é€æ‰€æœ‰æ¡æ‰‹æŠ¥æ–‡çš„ä¸€ä¸ªMAC</li><li>serverå‘é€æ‰€æœ‰æ¡æ‰‹æŠ¥æ–‡çš„ä¸€ä¸ªMACï¼ˆ5.6æ­¥éª¤ä½¿å¾—æ¡æ‰‹å…å—ç¯¡æ”¹ä¼¤å®³ï¼ˆç®—æ³•åˆ—è¡¨ä¸è¢«åˆ æ”¹ï¼‰</li></ol><p>å­˜åœ¨ä¸é‡æ•°çš„åŸå› ï¼šé˜²å¾¡&quot;è¿æ¥é‡æ”¾&quot;ï¼Œä½¿å¾—åŠ å¯†çš„å¯†é’¥ä¸åŒ</p></li><li><p><strong>è¿æ¥å…³é—­</strong></p><p>åœ¨ç±»å‹å­—æ®µä¸­æŒ‡å‡ºè¯¥è®°å½•æ˜¯å¦ç”¨äºç»ˆæ­¢è¯¥SSLä¼šè¯</p></li></ol><h3 id="ç½‘ç»œå±‚å®‰å…¨æ€§ï¼šIPsecå’Œè™šæ‹Ÿä¸“ç”¨ç½‘">ç½‘ç»œå±‚å®‰å…¨æ€§ï¼šIPsecå’Œè™šæ‹Ÿä¸“ç”¨ç½‘</h3><p>IPsec: IPå®‰å…¨åè®®ï¼Œä¸ºä»»æ„ä¸¤ä¸ªç½‘ç»œå±‚å®ä½“ä¹‹é—´çš„IPæ•°æ®æŠ¥æä¾›äº†å®‰å…¨ï¼Œå¾ˆå¤šæœºæ„ä½¿ç”¨IPsecåˆ›å»ºäº†è¿è¡Œåœ¨å…¬å…±å› ç‰¹ç½‘ä¸Šçš„è™šæ‹Ÿä¸“ç”¨ç½‘ï¼ˆVPNï¼‰</p><p>å¦‚æœä¸¤å°ä¸»æœºè¦è·¨è¶Šå…¬å…±å› ç‰¹ç½‘è¿›è¡Œé€šä¿¡ï¼Œåˆ™æµé‡åœ¨è¿›å…¥å› ç‰¹ç½‘ä¹‹å‰è¦è¿›è¡ŒåŠ å¯†ï¼ˆIPv4æ•°æ®æŠ¥ â€”&gt; IPsecæ•°æ®æŠ¥ï¼Œç±»ä¼¼IPv4æ•°æ®æŠ¥ï¼Œä½†è½½è·ä¸­åŒ…å«ä¸€ä¸ªIPsecé¦–éƒ¨ï¼‰</p><p><strong>AHåè®®å’ŒESPåè®®</strong></p><p>IPsecä¸­ä¸¤ä¸ªä¸»è¦åè®®ï¼š</p><ul><li>**é‰´åˆ«é¦–éƒ¨ï¼ˆAHï¼‰**åè®®ï¼Œæä¾›é‰´åˆ«å’Œæ•°æ®å®Œæ•´æ€§æœåŠ¡ï¼Œä¸æä¾›æœºå¯†æ€§æœåŠ¡</li><li><strong>å°è£…å®‰å…¨æ€§è½½è·ï¼ˆESPï¼‰åè®®</strong>ï¼Œæä¾›æºé‰´åˆ«ã€æ•°æ®å®Œæ•´æ€§å’Œæœºå¯†æœåŠ¡ï¼Œä½¿ç”¨å¹¿æ³›ï¼ˆæœºå¯†æ€§ååˆ†é‡è¦ï¼‰</li></ul><p>å½“ä¸»æœºè¦å‘ä¸€ä¸ªç›®çš„å®ä½“å‘é€å®‰å…¨æ•°æ®æŠ¥æ—¶ï¼Œé€šå¸¸ä½¿ç”¨ä»¥ä¸Šä¸¤ç§ä¹‹ä¸€åè®®</p><p><strong>å®‰å…¨å…³è”</strong></p><p>æºå®ä½“å‘ç›®çš„å®ä½“å‘é€IPsecæ•°æ®æŠ¥ä¹‹å‰ï¼Œæºå’Œç›®çš„å®ä½“éœ€è¦åˆ›å»ºä¸€ä¸ªç½‘ç»œå±‚çš„é€»è¾‘è¿æ¥ï¼Œç§°ä¹‹ä¸º<strong>å®‰å…¨å…³è”</strong>ï¼ˆSAï¼‰</p><p>ä¸€ä¸ªSAæ˜¯ä¸€ä¸ªå•å·¥é€»è¾‘è¿æ¥ï¼Œä»æºåˆ°ç›®çš„åœ°æ˜¯å•å‘çš„ï¼Œå¦‚æœè¦äº’ç›¸å‘é€æ•°æ®æŠ¥ï¼Œåˆ™éœ€è¦å»ºç«‹ä¸¤ä¸ªSA</p><p>è·¯ç”±å™¨ç»´æŠ¤ä»¥ä¸‹SAçŠ¶æ€ä¿¡æ¯</p><ul><li>32bitæ ‡è¯†ç¬¦ â€” å®‰å…¨å‚æ•°ç´¢å¼•SPI</li><li>åˆå§‹æ¥å£å’Œç›®çš„æ¥å£</li><li>åŠ å¯†ç±»å‹</li><li>åŠ å¯†å¯†é’¥</li><li>å®Œæ•´æ€§æ£€æŸ¥çš„ç±»å‹</li><li>é‰´åˆ«å¯†é’¥</li></ul><p>ä¸€ä¸ªIPsecå®ä½“ç»å¸¸ç»´æŠ¤è€Œè®¸å¤šSAçš„çŠ¶æ€ä¿¡æ¯ï¼Œåœ¨<strong>å®‰å…¨å…³è”æ•°æ®åº“</strong>ï¼ˆSADï¼‰ä¸­å­˜å‚¨æ‰€æœ‰çš„SAçŠ¶æ€ä¿¡æ¯</p><p><strong>IPsecæ•°æ®æŠ¥</strong></p><p>ä¸¤ç§ä¸åŒçš„åˆ†ç»„å½¢å¼ï¼Œéš§é“æ¨¡å¼å’Œè¿è¾“æ¨¡å¼,<strong>æ­¤å¤„é’ˆå¯¹éš§é“æ¨¡å¼</strong></p><p>IPv4å¦‚ä½•è½¬æ¢åˆ°IPsecï¼Ÿ</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211011103701653.png" alt="image-20211011103701653"></p><ul><li>IPv4æ•°æ®æŠ¥åé™„ä¸Šä¸€ä¸ªESPå°¾éƒ¨å­—æ®µ</li><li>ä½¿ç”¨ç®—æ³•å’ŒSAè§„å®šçš„å¯†é’¥åŠ å¯†è¯¥ç»“æœ</li><li>åœ¨è¿™ä¸ªåŠ å¯†é‡çš„å‰é¢é™„åŠ ä¸€ä¸ªESPé¦–éƒ¨çš„å­—æ®µ</li><li>ä½¿ç”¨ç®—æ³•å’Œç”±SAè§„å®šçš„å¯†é’¥ç”Ÿæˆä¸€ä¸ªè¦†ç›–æ•´ä¸ªåŒ…çš„é‰´åˆ«MAC</li><li>è¯¥MACé™„åŠ åˆ°åŒ…åé¢å½¢æˆè½½è·</li><li>ç”Ÿæˆä¸€ä¸ªå…·æœ‰æ‰€æœ‰ç»å…¸IPv4é¦–éƒ¨å­—æ®µçš„å…¨æ–°IPé¦–éƒ¨ï¼Œè¯¥é¦–éƒ¨é™„åŠ åˆ°è½½è·ä¹‹å‰</li></ul><p>æ•´ä¸ªæ–°IPv4çš„é¦–éƒ¨å­—æ®µä¸­çš„åè®®å·ä¸è¢«è®¾ç½®ä¸ºTCPã€UDPç­‰ï¼Œè€Œæ˜¯è®¾ç½®ä¸º50ï¼ŒæŒ‡ç¤ºè¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ESPåè®®çš„IPsecæ•°æ®æŠ¥ã€‚æœ€å¤–éƒ¨çš„IPåœ°å€è¢«è®¾ç½®å€¼ä¸ºä½äºéš§é“ä¸¤ä¸ªç«¯ç‚¹çš„æºå’Œç›®çš„åœ°è·¯ç”±å™¨æ¥å£ã€‚</p><p>è¯¥è·¯ç”±å™¨å°†IPsecæŠ¥å‘é€è¿›å…¬å…±å› ç‰¹ç½‘ä¹‹åï¼Œåœ¨åˆ°è¾¾ç›®çš„è·¯ç”±å™¨å‰é€šè¿‡è®¸å¤šè·¯ç”±å™¨ï¼Œæ¯ä¸ªéƒ½å°†å¤„ç†è¯¥æ•°æ®æŠ¥ï¼Œå°†å…¶å¯¹å¾…æˆæ™®é€šçš„æ•°æ®æŠ¥ä¸€æ ·</p><p>ESPå°¾éƒ¨ä¸‰ä¸ªå­—æ®µï¼šå¡«å……ã€å¡«å……é•¿åº¦ã€ä¸‹ä¸€ä¸ªé¦–éƒ¨<br>å¡«å……ï¼šå› ä¸ºåŠ å¯†çš„æŠ¥æ–‡å¿…é¡»ä¸ºå—é•¿åº¦çš„æ•´æ•°å€<br>ä¸‹ä¸€ä¸ªé¦–éƒ¨ï¼šæŒ‡ç¤ºåŒ…å«åœ¨è½½è·æ•°æ®çš„å­—æ®µä¸­çš„ç±»å‹ï¼ˆUDPã€TCPâ€¦ï¼‰</p><p>ESPé¦–éƒ¨ï¼šSPIå­—æ®µå’Œåºå·å­—æ®µã€‚<br>SPIå­—æ®µï¼šæŒ‡ç¤ºæ¥å—å®ä½“è¯¥æ•°æ®æŠ¥å±äºå“ªä¸ªSA<br>æ¥å—å®ä½“èƒ½å¤Ÿç”¨è¯¥SPIç´¢å¼•å…¶SADæ¥ç¡®å®šé€‚å½“çš„é‰´åˆ«/è§£å¯†ç®—æ³•å’Œå¯†é’¥<br>åºå·ï¼šé˜²å¾¡é‡æ”¾æ”»å‡»</p><p>IPsecå®ä½“è¿˜ç»´æŠ¤ä¸€ä¸ªå®‰å…¨ç­–ç•¥åº“ï¼ˆSPDï¼‰ï¼ŒæŒ‡ç¤ºå“ªäº›ç±»å‹çš„æ•°æ®æŠ¥å°†è¢«IPsecå¤„ç†ï¼Œå¹¶ä¸”å¯¹è¿™äº›å°†è¢«å¤„ç†çš„æ•°æ®æŠ¥åº”å½“ä½¿ç”¨å“ªä¸ªSA</p><p><em><strong>å¦‚ä½•ä¿æŠ¤ï¼Ÿ</strong></em></p><ul><li>ä¸­é—´äººçœ‹ä¸åˆ°æ­£ç¡®çš„æºå’Œç›®çš„åœ°å€ã€ç«¯å£å·ã€ä¸çŸ¥é“æ˜¯å¦æºå¸¦TCPã€UDPã€ICMPæ•°æ®ï¼Œæ›´çœ‹ä¸åˆ°åº”ç”¨å±‚çš„æ•°æ®è½½è·ï¼Œæœºå¯†æ€§æ¯”SSLå¹¿æ³›</li><li>æ— æ³•åè½¬bitæ¥å¹²æ‰° â€” MAC</li><li>æ— æ³•å‡å†’ ---- MAC</li><li>æ— æ³•å‘èµ·é‡æ”¾æ”»å‡» ---- åºå·</li></ul><p><strong>IKEï¼šIPsecä¸­çš„å¯†é’¥ç®¡ç†</strong></p><p>VPNå…·æœ‰å°‘é‡ç«¯ç‚¹æ—¶ï¼Œèƒ½å¤Ÿåœ¨ç«¯ç‚¹çš„SADä¸­äººå·¥é”®å…¥SAä¿¡æ¯ã€‚ä½†å¤§å‹çš„VPNåˆ™è¦æ±‚éƒ¨ç½²è‡ªåŠ¨çš„æœºåˆ¶æ¥ç”ŸæˆSA--------<strong>å› ç‰¹ç½‘å¯†é’¥äº¤æ¢(IKE)</strong></p><p>ä¸SSLç›¸ä¼¼ï¼Œæ¯ä¸ªIPsecå®ä½“æœ‰ä¸€ä¸ªæ•´æ•°ï¼ŒåŒ…æ‹¬äº†è¯¥å®ä½“çš„å…¬å¼€å¯†é’¥ã€‚IKEåè®®è®©ä¸¤ä¸ªå®ä½“äº¤æ¢æ•´æ•°ã€åå•†é‰´åˆ«å’ŒåŠ å¯†ç®—æ³•ï¼Œå¹¶å®‰å…¨åœ°äº¤æ¢ç”¨äºåœ¨IPsec SAä¸­ç”Ÿæˆä¼šè¯å¯†é’¥çš„å¯†é’¥ææ–™ã€‚</p><h3 id="ä½¿æ— çº¿LANå®‰å…¨">ä½¿æ— çº¿LANå®‰å…¨</h3><p><strong>æœ‰çº¿ç­‰æ•ˆä¿å¯†ï¼ˆWEPï¼‰</strong></p><p>P.422</p><p><strong>IEEE 802.11i</strong></p><p>2004å¹´æ‰¹å‡†ï¼Œæ–°æ ‡å‡†ï¼Œæä¾›äº†å¼ºå¾—å¤šçš„åŠ å¯†å½¢å¼ã€å¯æ‰©å±•çš„é‰´åˆ«æœºåˆ¶é›†åˆå’Œå¯†é’¥çš„åˆ†å‘æœºåˆ¶ã€‚</p><p>åœ¨APä¹‹ä¸Šå¢åŠ äº†ä¸€å°é‰´åˆ«æœåŠ¡å™¨ï¼Œå¯¹åº”å¤šå°APé¢ç§¯ä¸­åœ¨ä¸€å°æœåŠ¡å™¨ä¸­åšå‡ºæœ‰å…³é‰´åˆ«å’Œæ¥å…¥çš„å†³å®š</p><p>è¿è¡Œé˜¶æ®µ:</p><ul><li>å‘ç°ã€‚APé€šå‘Šå®ƒçš„å­˜åœ¨ä»¥åŠå®ƒèƒ½å¤Ÿå‘æ— çº¿å®¢æˆ·èŠ‚ç‚¹æä¾›çš„é‰´åˆ«å’ŒåŠ å¯†å½¢å¼ï¼Œå®¢æˆ·åˆ™è¯·æ±‚å®ƒå¸Œæœ›çš„ç‰¹å®šçš„é‰´åˆ«å’ŒåŠ å¯†å½¢å¼ã€‚</li><li>ç›¸äº’é‰´åˆ«å’Œä¸»å¯†é’¥çš„ç”Ÿæˆã€‚APä¸­è½¬æŠ¥æ–‡ï¼Œå‘ç»™é‰´åˆ«æœåŠ¡å™¨ã€‚<strong>å¯æ‰©å±•é‰´åˆ«åè®®</strong>(EAP)å®šä¹‰äº†å®¢æˆ·å’Œé‰´åˆ«æœåŠ¡å™¨ä¹‹é—´äº¤äº’æ—¶ç®€å•çš„è¯·æ±‚/å“åº”æ¨¡å¼ä¸­ä½¿ç”¨çš„ç«¯åˆ°ç«¯çš„æŠ¥æ–‡æ ¼å¼ã€‚<ul><li>ä½¿ç”¨EAPoL(EAP or LAN)å°è£…ï¼Œé€šè¿‡802.11æ— çº¿é“¾è·¯å‘é€</li><li>æŠ¥æ–‡åœ¨APæ‹†å°ï¼Œå¹¶ä½¿ç”¨RADIUSåè®®é‡æ–°å°è£…ï¼Œç»è¿‡UDP/IPä¼ è¾“åˆ°é‰´åˆ«æœåŠ¡å™¨</li></ul></li><li>ç”Ÿæˆæˆå¯¹ä¸»å¯†é’¥ã€‚MKæ˜¯ä»…ä¸ºå®¢æˆ·å’Œé‰´åˆ«æœåŠ¡å™¨æ‰€è‡´çš„å…±äº«å¯†é’¥ï¼ŒåŒæ–¹ç”¨MKç”Ÿæˆä¸€ä¸ªæ¬¡å¯†é’¥ï¼Œå³æˆå¯¹ä¸»å¯†é’¥ã€‚é‰´åˆ«æœåŠ¡å™¨å‘APå‘é€è¯¥PMKï¼Œåˆ™å®¢æˆ·å’ŒAPé™åˆ¶æœ‰ä¸€ä¸ªå…±äº«çš„å¯†é’¥ï¼Œå¯ä»¥ç›¸äº’é‰´åˆ«</li><li>ä¸´æ—¶å¯†é’¥TKã€‚å€ŸåŠ©PMKï¼Œæ— çº¿å®¢æˆ·å’ŒAPèƒ½å¤Ÿç”Ÿæˆé™„åŠ ç”¨äºé€šä¿¡çš„å¯†é’¥ã€‚TKç”¨äºæ‰§è¡Œç»è¿‡æ— çº¿é“¾è·¯å‘ä»»æ„è¿œç¨‹ä¸»æœºå‘é€æ•°æ®çš„é“¾è·¯çº§åŠ å¯†</li></ul><h3 id="é˜²ç«å¢™å’Œå…¥ä¾µæ£€æµ‹ç³»ç»Ÿ">é˜²ç«å¢™å’Œå…¥ä¾µæ£€æµ‹ç³»ç»Ÿ</h3><p>é€šä¿¡æµé‡è¿›å…¥/ç¦»å¼€ç½‘ç»œæ—¶è¦æ‰§è¡Œå®‰å…¨æ£€æŸ¥ï¼Œåšè®°å½•ã€ä¸¢å¼ƒã€è½¬å‘ï¼Œ</p><h4 id="é˜²ç«å¢™">é˜²ç«å¢™</h4><p>ç¡¬ä»¶+è½¯ä»¶ç»“åˆä½“ï¼Œå…è®¸ä¸€äº›æ•°æ®åˆ†ç»„é€šè¿‡è€Œå¦ä¸€éƒ¨åˆ†ä¸å…è®¸ã€‚</p><p>ç›®æ ‡ï¼š</p><ul><li>ä»å†…åˆ°å¤–å’Œä»å¤–åˆ°å†…çš„æµé‡éƒ½è¦é€šè¿‡é˜²ç«å¢™ã€‚</li><li>ä»…è¢«æˆæƒçš„æµé‡å…è®¸é€šè¿‡</li><li>é˜²ç«å¢™è‡ªèº«å…äºæ¸—é€</li></ul><p>åˆ†ç±»ï¼š</p><ol><li><p><strong>ä¼ ç»Ÿçš„åˆ†ç»„è¿‡æ»¤å™¨</strong></p><p>ä¸€ä¸ªæœºæ„é€šå¸¸æœ‰ä¸€ä¸ªå†…éƒ¨ç½‘ç»œä¸ISPç›¸è¿æ¥çš„ç½‘å…³è·¯ç”±å™¨ï¼Œåˆ†ç»„è¿‡æ»¤ä¾¿åœ¨è¿™é‡Œã€‚ç»´æŠ¤ä¸€å¼ è®¿é—®æ§åˆ¶åˆ—è¡¨</p><p>è¿‡æ»¤ç­–ç•¥ï¼š</p><ul><li>IPæºå’Œç›®çš„åœ°å€</li><li>IPæ•°æ®æŠ¥ä¸­çš„åè®®ç±»å‹</li><li>åè®®ç«¯å£</li><li>TCPæ ‡å¿—æ¯”ç‰¹ï¼šSYN ACK</li><li>ICMPæŠ¥æ–‡ç±»å‹</li><li>å¯¹æ•°æ®æŠ¥ç¦»å¼€å’Œè¿›å…¥ç½‘ç»œçš„ä¸åŒè§„åˆ™</li><li>å¯¹ä¸åŒè·¯ç”±å™¨æ¥å£çš„ä¸åŒè§„åˆ™</li></ul></li><li><p><strong>çŠ¶æ€åˆ†ç»„è¿‡æ»¤å™¨</strong></p><p>å®é™…åœ°è·Ÿè¸ªTCPè¿æ¥ï¼Œåšå‡ºè¿‡æ»¤å†³å®šã€‚è§£å†³çš„é—®é¢˜ï¼šé˜²æ­¢å†…é¬¼ã€‚</p><p>ç”¨ä¸€å¼ è¿æ¥è¡¨æ¥è·Ÿè¸ªæ‰€æœ‰è¿›è¡Œçš„TCPè¿æ¥ï¼Œé˜²ç«å¢™èƒ½å¤Ÿé€šè¿‡è§‚å¯Ÿä¸‰æ¬¡æ¡æ‰‹æ¥è§‚å¯Ÿä¸€æ¡æ–°è¿æ¥çš„å¼€å§‹ã€‚å½“å®ƒçœ‹åˆ°ä¸€ä¸ªFINåˆ†ç»„æ—¶ï¼Œä¾¿è§‚å¯Ÿåˆ°è¯¥é“¾æ¥ç»“æŸã€‚</p><p>ç»´æŠ¤è¿æ¥è¡¨å’Œè®¿é—®æ§åˆ¶åˆ—è¡¨ï¼ˆåˆ—è¡¨ä¸­æœ‰æ˜¯å¦æ ¸å¯¹è¿æ¥å­—æ®µç”¨äºäºŒæ¬¡ç¡®è®¤ï¼‰</p><p>ä¹¦ä¸­çš„ä¾‹å­è¾ƒä¸ºå…·ä½“ï¼ˆP.427ï¼‰</p></li><li><p><strong>åº”ç”¨ç¨‹åºç½‘å…³</strong></p><p>åœ¨åº”ç”¨å±‚å±‚é¢é™åˆ¶ ---- <strong>åº”ç”¨ç¨‹åºç½‘å…³</strong> æ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºç‰¹å®šçš„æœåŠ¡å™¨ï¼Œæ‰€æœ‰åº”ç”¨ç¨‹åºæ•°æ®å¿…é¡»é€šè¿‡å®ƒã€‚å¤šä¸ªåº”ç”¨ç¨‹åºç½‘å…³å¯ä»¥åœ¨åŒä¸€å°ä¸»æœºä¸Šè¿è¡Œï¼Œä½†æ¯ä¸€ä¸ªç½‘å…³æœ‰è‡ªå·±è¿›ç¨‹çš„å•ç‹¬æœåŠ¡å™¨</p></li></ol><h4 id="å…¥ä¾µæ£€æµ‹ç³»ç»Ÿ">å…¥ä¾µæ£€æµ‹ç³»ç»Ÿ</h4><p>åˆ†ç»„è¿‡æ»¤å™¨æ£€æµ‹IPã€TCPã€ICMPé¦–éƒ¨å­—æ®µï¼Œä¸ºäº†æ£€æµ‹æ›´å¤šçš„æ”»å‡»ï¼Œéœ€è¦æ‰§è¡Œ<strong>æ·±åº¦åˆ†ç»„æ£€æŸ¥</strong>ï¼ŒæŸ¥çœ‹é¦–éƒ¨ä»¥å¤–çš„éƒ¨åˆ†ï¼Œå³æŸ¥çœ‹åˆ†ç»„æºå¸¦çš„å®é™…åº”ç”¨æ•°æ®ã€‚</p><p><strong>å…¥ä¾µæ£€æµ‹ç³»ç»Ÿ</strong>(IDS)ï¼šè§‚å¯Ÿåˆ°æ½œåœ¨æ¶æ„æµé‡èƒ½äº§ç”Ÿå‘Šè­¦çš„è®¾å¤‡<br><strong>å…¥ä¾µé˜²æ­¢ç³»ç»Ÿ</strong>(IPS)ï¼šæ»¤é™¤å¯ä»¥æµé‡çš„è®¾å¤‡</p><p>IDS + IPS = IDSç³»ç»Ÿ</p><p>æ£€æµ‹å¤šç§æ”»å‡»ï¼šæ´ªæ³›ã€ç½‘ç»œæ˜ å°„ã€ç«¯å£æ‰«æã€DoSå¸¦å®½æ´ªæ³›ã€è •è™«ã€‹ã€‚ã€‚</p><p>ä¸€ä¸ªæœºæ„å¯èƒ½åœ¨æœºæ„ç½‘ç»œä¸­éƒ¨ç½²ä¸€ä¸ªæˆ–è€…å¤šä¸ªIDSä¼ æ„Ÿå™¨ï¼Œå…±åŒå·¥ä½œï¼Œå‘ä¸€ä¸ªä¸­å¿ƒIDSå¤„ç†å™¨å‘é€æœ‰å…³å¯ç–‘æµé‡æ´»åŠ¨çš„ä¿¡æ¯ã€‚</p><p>IDSä¸ä»…è¦åšæ·±åº¦åˆ†ç»„æ£€æŸ¥ï¼Œè¿˜è¦å°†æ¯ä¸ªè¿‡å¾€çš„åˆ†ç»„ä¸è®¸å¤šçš„â€œç‰¹å¾â€åšæ¯”è¾ƒ  ----&gt; æå¤§å¤„ç†é‡ï¼Œæ‰€æœ‰IDSä¼ æ„Ÿå™¨å¤šå‘ä¸‹æ¸¸å¹¿æ³›å¸ƒç½®ï¼Œä¾¿äºç»´æŠ¤ã€å‡å°‘è´Ÿè½½ã€‚</p><p>IDSç³»ç»Ÿåˆ†ç±»ï¼š</p><ul><li><strong>åŸºäºç‰¹å¾çš„ç³»ç»Ÿ</strong><ul><li>ç»´æŠ¤ä¸€ä¸ªèŒƒå›´å¹¿æ³›çš„æ”»å‡»ç‰¹å¾æ•°æ®åº“ï¼Œæ¯ä¸ªç‰¹å¾æ˜¯ä¸ä¸€ä¸ªå…¥ä¾µæ´»åŠ¨ç›¸å…³è”çš„è§„åˆ™é›†ã€‚ï¼ˆä¸€ä¸ªç‰¹å¾å¯èƒ½æŒ‡ç¤ºæœ‰å…³å•ä¸ªåˆ†ç»„çš„ç‰¹æ€§åˆ—è¡¨ï¼ˆç«¯å£å·ã€IPåœ°å€ã€åˆ†ç»„ä¸­ç‰¹å®šçš„æ¯”ç‰¹ä¸²â€¦ï¼‰ï¼‰ç‰¹å¾é€šå¸¸ç”±ç†Ÿç»ƒçš„ç½‘ç»œå®‰å…¨å·¥ç¨‹å¸ˆç”Ÿæˆå¹¶æ·»åŠ åˆ°æ•°æ®åº“ä¸­</li><li>å—…æ¢æ¯ä¸ªé€šè¿‡å®ƒçš„åˆ†ç»„ï¼Œå¹¶ä¸ç‰¹å¾åº“ä¸­çš„ç‰¹å¾è¿›è¡Œæ¯”è¾ƒ</li><li>å¯¹æ–°æ”»å‡»æ— åˆ¤æ–­åŠ›ï¼Œå¯èƒ½äº§ç”Ÿè™šå‡å‘Šè­¦</li></ul></li><li><strong>åŸºäºå¼‚å¸¸çš„ç³»ç»Ÿ</strong><ul><li>è§‚å¯Ÿæ­£å¸¸è¿è¡Œçš„æµé‡ï¼Œäº§ç”Ÿæµé‡æ¦‚å†µæ–‡ä»¶ã€‚å¯»æ‰¾ç»Ÿè®¡ä¸Šä¸å¯»å¸¸çš„åˆ†ç»„åˆ˜ï¼ˆä¾‹å¦‚ICMPåˆ†ç»„ä¸å¯»å¸¸çš„ç™¾åˆ†æ¯”ï¼‰ã€‚</li><li>ä¸ä¾èµ–ä»¥å‰çš„æ”»å‡»çŸ¥è¯†</li><li>ä¸å¤ªå¸¸ç”¨</li></ul></li></ul><h1>TCP/IPåè®®</h1><h2 id="æ¦‚è¿°-v10">æ¦‚è¿°</h2><h3 id="ä¸€äº›é—®é¢˜-v7">ä¸€äº›é—®é¢˜</h3><p><em>å› ç‰¹ç½‘å’Œä¸‡ç»´ç½‘çš„åŒºåˆ«ï¼Ÿ</em></p><ul><li>å› ç‰¹ç½‘æ˜¯äº’è”ç½‘çš„ä¸€ç§ï¼Œç”±ä¸Šåƒä¸‡å°è®¾å¤‡ç»„æˆï¼Œæ˜¯ä¸€ä¸ªå¹¿åŸŸç½‘</li><li>ä¸‡ç»´ç½‘æ˜¯å› ç‰¹ç½‘æä¾›çš„ä¸€ç§æœåŠ¡ï¼ˆWWWï¼‰{å› ç‰¹ç½‘è¿˜æä¾›FTPæ–‡ä»¶ä¼ è¾“ã€ç½‘ç»œç”µè¯ã€ç”µå­é‚®ä»¶ä¹‹ç±»çš„æœåŠ¡â€¦}ï¼Œæ˜¯æ— æ•°ä¸ªç«™ç‚¹å’Œç½‘é¡µçš„é›†åˆï¼Œç”±æµè§ˆå™¨æµè§ˆè¶…æ–‡æœ¬é¡µé¢ç»„æˆã€‚httpå’Œhttpså°±å±äºä¸‡ç»´ç½‘çš„ä¸€ç§</li></ul><p><em>OSIå‚è€ƒæ¨¡å‹å’ŒTCP/IPä½“ç³»ç»“æ„</em></p><ul><li>OSI å›½é™…æ ‡å‡†åŒ–ç»„ç»‡(ISO)åˆ¶å®šçš„è®¡ç®—æœºæˆ–é€šä¿¡ç³»ç»Ÿé—´äº’è”çš„æ ‡å‡†ä½“ç³»</li><li><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211012161741783.png" alt="image-20211012161741783"></li><li>TCP/IPä½“ç³»ç»“æ„<img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211012161936904.png" alt="image-20211012161936904"></li></ul><h2 id="Internetåœ°å€ç»“æ„">Internetåœ°å€ç»“æ„</h2><h3 id="æ¦‚è¿°-v11">æ¦‚è¿°</h3><p>IPv6çš„ç¼©å†™è§„èŒƒ P.22</p><h3 id="åŸºæœ¬çš„IPåœ°å€ç»“æ„">åŸºæœ¬çš„IPåœ°å€ç»“æ„</h3><h4 id="åˆ†ç±»å¯»å€">åˆ†ç±»å¯»å€</h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211012162858017.png" alt="image-20211012162858017"></p><p>å•æ’­åœ°å€ï¼šç”¨äºè¯†åˆ«è¿æ¥Internetæˆ–è€…æŸäº›ä¸“ç”¨çš„å†…è”ç½‘çš„è®¡ç®—æœºç½‘ç»œæ¥å£</p><p><strong>å­ç½‘å¯»å€</strong></p><p>ä¸»æœºéƒ¨åˆ†åˆ’åˆ†ä¸º å­ç½‘å· + ä¸»æœºå·</p><p><strong>å­ç½‘æ©ç </strong></p><p>ç”±ä¸€å°ä¸»æœºæˆ–è€…è·¯ç”±å™¨ä½¿ç”¨çš„åˆ†é…ä¸ºï¼Œï¼Œç¡®å®šå¦‚ä½•ä»ä¸€å°ä¸»æœºå¯¹åº”IPåœ°å€ä¸­è·å¾—ç½‘ç»œå’Œå­ç½‘ä¿¡æ¯ã€‚</p><p><strong>å¯å˜é•¿åº¦çš„å­ç½‘æ©ç VLSM</strong></p><p>å¯ç”¨äºåˆ†å‰²ä¸€ä¸ªç½‘ç»œå·ï¼Œä½¿å¾—æ¯ä¸ªå­ç½‘æ”¯æŒä¸åŒæ•°é‡çš„ä¸»æœºã€‚</p><p>å¦‚æœæ²¡æœ‰VLSMï¼Œä¸€ä¸ªå­ç½‘æ©ç åªèƒ½æä¾›ç»™ä¸€ä¸ªç½‘ç»œï¼Œé™åˆ¶äº†è¦æ±‚çš„å­ç½‘æ•°ä¸Šçš„ä¸»æœºæ•°ï¼Œä½¿å¾—å¯ä»¥åˆ’åˆ†å¤šå±‚å­ç½‘ï¼ˆä½†IPæ•°è¿˜æ˜¯é‚£ä¹ˆå¤šï¼‰</p><p><strong>å¹¿æ’­åœ°å€</strong></p><p>æ„å»ºæ–¹å¼ï¼š</p><p>å­ç½‘å¹¿æ’­ï¼šå°†å­ç½‘æ©ç å»ç¿»ï¼Œå¹¶ä¸å­ç½‘ä¸­ä»»æ„ä¸»æœºåœ°å€è¿›è¡ŒæŒ‰ä½æˆ– | è¿ç®—ï¼ˆ11111111â€¦ï¼‰</p><blockquote><p>å®šå‘å¹¿æ’­é—®é¢˜å¾ˆå¤§ï¼Œç›®å‰ä»åœ¨ç¦ç”¨(é€šè¿‡å®šå‘å¹¿æ’­å¯ä»¥å°†æ•°æ®æŠ¥å‘é€ç»™å­ç½‘ä¸­çš„æ‰€æœ‰ä¸»æœº)</p></blockquote><p>æœ¬åœ°ç½‘ç»œå¹¿æ’­ï¼ˆæœ‰é™å¹¿æ’­ï¼‰ï¼š255.255.255.255ï¼Œä¸ä¼šè¢«è·¯ç”±å™¨è½¬å‘ï¼Œä½†å­ç½‘å¹¿æ’­å’Œè¿æ¥åœ¨åŒä¸€ç½‘ç»œä¸­çš„è®¡ç®—æœºçš„æœ¬åœ°ç½‘ç»œå¹¿æ’­å°†å·¥ä½œã€‚ï¼ˆï¼Ÿï¼Ÿï¼Ÿä¸æ‡‚ï¼‰</p><p>IPv6æ²¡æœ‰ä»»ä½•å¹¿æ’­åœ°å€ï¼Œä»…ä½¿ç”¨ç»„æ’­åœ°å€</p><p><strong>IPv6åœ°å€å’Œæ¥å£æ ‡è¯†ç¬¦</strong></p><p>IPv6é€šè¿‡ç‰¹æ®Šå‰ç¼€è¡¨ç¤ºä¸€ä¸ªåœ°å€èŒƒå›´ã€‚</p><ul><li>èŠ‚ç‚¹æœ¬åœ°ï¼ˆç”¨äºç»Ÿä¸€è®¡ç®—æœºä¸­é€šä¿¡ï¼‰</li><li>é“¾è·¯æœ¬åœ°ï¼ˆåŒä¸€ç½‘ç»œé“¾è·¯æˆ–IPv6å‰ç¼€ä¸­çš„èŠ‚ç‚¹ï¼‰</li><li>å…¨çƒæ€§ï¼ˆInternetèŒƒå›´ï¼‰</li></ul><p>é“¾è·¯æœ¬åœ°IPv6åœ°å€å’Œä¸€äº›å…¨çƒæ€§IPv6åœ°å€ä½¿ç”¨æ¥å£æ ‡è¯†ç¬¦ï¼ˆIIDï¼Œç›´æ¥ç”±ä¸€ä¸ªç½‘ç»œæ¥å£çš„ç›¸å…³é“¾è·¯å±‚MACåœ°å€å½¢æˆï¼‰ä½œä¸ºä¸€ä¸ªå•æ’­IPv6åœ°å€çš„åˆ†é…åŸºç¡€</p><p>OUIï¼šç»„ç»‡å”¯ä¸€æ ‡è¯†ç¬¦</p><p>EUIï¼šæ‰©å±•å”¯ä¸€æ ‡è¯†ç¬¦</p><p><em>MACåœ°å€å¦‚ä½•è¢«æ˜ å°„æˆä¸€ä¸ªIPv6åœ°å€ï¼Ÿ</em></p><h3 id="CIDRå’Œèšåˆ">CIDRå’Œèšåˆ</h3><p>é¢ä¸´é—®é¢˜ï¼š</p><ul><li>å¤šåŠBç±»åœ°å€å·²è¢«åˆ†é…------------æ¸…é™¤IPåœ°å€åˆ†ç±»æƒé™å¹¶ä¸”æé«˜å±‚æ¬¡åŒ–åˆ†é…çš„IPåœ°å€çš„èšåˆèƒ½åŠ›</li><li>32ä½IPv4åœ°å€ä¸è¶³ä»¥åº”å¯¹Internetåœ¨21ä¸–çºªåˆçš„è§„æ¨¡            --------IPv6</li><li>å…¨çƒè·¯ç”±è¡¨æ¡æ•°å¢åŠ ï¼Œéšç€è¶Šæ¥è¶Šå¤šçš„è·¯ç”±æ¡ç›®å‡ºç°ï¼Œè·¯ç”±æ€§èƒ½å°†å—åˆ°å½±å“                          ------------æ¸…é™¤IPåœ°å€åˆ†ç±»æƒé™å¹¶ä¸”æé«˜å±‚æ¬¡åŒ–åˆ†é…çš„IPåœ°å€çš„èšåˆèƒ½åŠ›</li></ul><h4 id="å‰ç¼€">å‰ç¼€</h4><p>å¸®åŠ©ç¼“è§£IPv4çš„å‹åŠ›ï¼Œåˆ†ç±»å¯»å€æ–¹æ¡ˆä½¿ç”¨ä¸€ä¸ªç±»ä¼¼VLSMçš„æ–¹æ¡ˆ â€” <strong>CIDRï¼ˆæ— ç±»åˆ«åŸŸé—´è·¯ç”±ï¼‰</strong>ï¼Œæä¾›äº†ä¸€ç§æ–¹ä¾¿çš„åˆ†é…è¿ç»­åœ°å€èŒƒå›´çš„æ–¹å¼ï¼ŒåŒ…å«å¤šäº255å°å°‘äº65536å°ä¸»æœºã€‚</p><ul><li>æœªç»è¿‡é¢„å®šä¹‰çš„ä»»ä½•åœ°å€é˜²èŒƒæœªå¯ä»¥ä½œä¸ºä¸€ä¸ªç±»çš„ä¸€éƒ¨åˆ†ï¼Œä½†éœ€è¦CIDRæ©ç ï¼ˆå¯¹å…¨çƒæ€§è·¯ç”±ç³»ç»Ÿå¯è§ï¼‰</li><li>æ ¸å¿ƒå› ç‰¹ç½‘è·¯ç”±å™¨å¿…é¡»èƒ½è§£é‡Šå’Œå¤„ç†æ©ç ï¼ˆç½‘ç»œå‰ç¼€ï¼‰</li></ul><h4 id="èšåˆ">èšåˆ</h4><p>å–æ¶ˆåˆ†ç±»ç»“æ„çš„IPåœ°å€ï¼Œèƒ½åˆ†é…å„ç§å°ºå¯¸çš„IPåœ°å€å—ï¼Œä½†ä¸èƒ½å¸®åŠ©å‡å°‘è·¯ç”±æ¡ç›®æ•°</p><p>å¦‚ä½•å‡å°‘è·¯ç”±æ¡ç›®æ•°ï¼Ÿ</p><p>éšæœºå¯»å€ å’Œ æ‹“æ‰‘æ•æ„Ÿ(ä½ç½®ç›¸å…³)å¯»å€</p><p><strong>è·¯ç”±èšåˆ</strong>ï¼šå°†ç›¸é‚»çš„å¤šä¸ªIPå‰ç¼€åˆå¹¶æˆä¸€ä¸ªçŸ­å‰ç¼€ï¼Œå¯ä»¥è¦†ç›–æ›´å¤šåœ°å€ç©ºé—´</p><p><em><strong>CIDRå’ŒVLSMçš„åŒºåˆ«</strong></em></p><ul><li>CIDRå°†å‡ ä¸ªæ ‡å‡†ç½‘ç»œå’Œæˆä¸€ä¸ªå¤§çš„ç½‘ç»œ</li><li>VLSMæŠŠä¸€ä¸ªæ ‡å‡†ç½‘ç»œåˆ†æˆå‡ ä¸ªå°å‹ç½‘ç»œï¼ˆå­ç½‘çš„å­ç½‘çš„å­ç½‘â€¦ï¼‰</li></ul><p><strong>ï¼ï¼ï¼è€ƒç ”æ­¤å¤„æœ‰ç›¸å…³é¢˜ç›®ï¼ï¼ï¼</strong></p><h3 id="ç‰¹æ®Šç”¨é€”åœ°å€">ç‰¹æ®Šç”¨é€”åœ°å€</h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211012172618252.png" alt="image-20211012172618252"></p><h4 id="IPv4-IPv6åœ°å€è½¬æ¢">IPv4-IPv6åœ°å€è½¬æ¢</h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211012172927758.png" alt="image-20211012172927758"></p><p>å‰ç¼€å¯ä»¥æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„å‰ç¼€ï¼Œä¹Ÿå¯ä»¥æ˜¯ç»„ç»‡ä¸ºè½¬æ¢å™¨åˆ†é…çš„å”¯ä¸€å‰ç¼€ã€‚64-71ä½ä¸º0ï¼Œä»¥ä¿æŒ[RFC4291]æŒ‡å®šæ ‡è¯†ç¬¦çš„å…¼å®¹æ€§ã€‚åç¼€çš„ä½è¢«ä¿ç•™å¹¶è®¾ç½®ä¸º0</p><h4 id="ç»„æ’­åœ°å€">ç»„æ’­åœ°å€</h4><p>IPv4 v6éƒ½æ”¯æŒç»„æ’­åœ°å€ï¼Œä¸€ä¸ªIPç»„æ’­åœ°å€ï¼ˆä¹Ÿç§°ä¸ºç»„æˆ–ç»„åœ°å€ï¼‰æ ‡è¯†ä¸€ç»„ä¸»æœºæ¥å£ã€‚ä¸€ä¸ªç»„å¯ä»¥è·¨è¶Šæ•´ä¸ªå› ç‰¹ç½‘</p><pre><code class="mermaid"><span class="token keyword">graph</span> TBA<span class="token text string">[æ–¹å½¢]</span> <span class="token arrow operator">--></span>B<span class="token text string">(åœ†è§’)</span>    B <span class="token arrow operator">--></span> C<span class="token text string">&#123;æ¡ä»¶a&#125;</span>    C <span class="token arrow operator">--></span><span class="token label property">|a=1|</span> D<span class="token text string">[ç»“æœ1]</span>    C <span class="token arrow operator">--></span><span class="token label property">|a=2|</span> E<span class="token text string">[ç»“æœ2]</span>    F<span class="token text string">[æ¨ªå‘æµç¨‹å›¾]</span></code></pre>]]></content>
    
    
    
    <tags>
      
      <tag>è€ƒç ”</tag>
      
      <tag>è®¡ç½‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç¼–è¯‘åŸç†</title>
    <link href="/2021/08/30/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/"/>
    <url>/2021/08/30/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/</url>
    
    <content type="html"><![CDATA[<h1>ç¼–è¯‘åŸç†</h1><span id="more"></span><h2 id="æ¦‚è§ˆ">æ¦‚è§ˆ</h2><p>æœºå™¨è¯­è¨€ â€”&gt; æ±‡ç¼–è¯­è¨€(åŠ©è®°ç¬¦ MOVâ€¦) â€”&gt; é«˜çº§è¯­è¨€ï¼ˆä¸ä¾èµ–äºç‰¹å®šæœºå™¨ï¼‰</p><p>æœºå™¨è¯­è¨€ â€” &gt; æ±‡ç¼–è¯­è¨€æˆ–é«˜çº§è¯­è¨€çš„è¿‡ç¨‹ ï¼š</p><p><strong>ç¼–è¯‘ç³»ç»Ÿçš„ç»“æ„</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210830163918375.png" alt="image-20210830163918375"></p><p>è¯­ä¹‰åˆ†æ(Semantic Analysis)</p><p>è¯­ä¹‰ï¼šä¸­é—´è¡¨ç¤ºï¼Œç‹¬ç«‹äºè¡¨ç¤ºè¯­è¨€</p><p><strong>ç¼–è¯‘å™¨çš„ç»“æ„</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210830164732319.png" alt="image-20210830164732319"></p><h2 id="ç»“æ„-v4">ç»“æ„</h2><h3 id="è¯æ³•åˆ†æå™¨">è¯æ³•åˆ†æå™¨</h3><p>ä¸»è¦ä»»åŠ¡ï¼šä»å·¦å‘å³é€è¡Œæ‰«ææºç¨‹åºçš„å­—ç¬¦ï¼Œè¯†åˆ«å‡ºå„ä¸ªå•è¯ï¼Œç¡®å®šå•è¯çš„ç±»å‹ã€‚å°†è¯†åˆ«å‡ºçš„å•è¯è½¬æ¢æˆç»Ÿä¸€çš„æœºå†…è¡¨ç¤ºâ€”â€”è¯æ³•å•å…ƒï¼ˆTokenï¼‰å½¢å¼</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210830165359571.png" alt="image-20210830165359571"></p><p>ä¸¾ä¸ªä¾‹å­</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210830165538515.png" alt="image-20210830165538515"></p><p>ğŸ˜ƒ å¦‚ä½•å®ç°è¯æ³•åˆ†æå™¨ï¼Ÿ</p><h3 id="è¯­æ³•åˆ†æ">è¯­æ³•åˆ†æ</h3><p>ä»è¯æ³•åˆ†æå™¨è¾“å‡ºçš„tokenåºåˆ—ä¸­è¯†åˆ«å‡ºå„ç±»çŸ­è¯­ï¼Œå¹¶æ„é€ è¯­æ³•åˆ†ææ ‘(parse tree)</p><p>ä¸¾ä¸ªä¾‹å­</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210830170121279.png" alt="image-20210830170121279"></p><h3 id="è¯­ä¹‰åˆ†æ">è¯­ä¹‰åˆ†æ</h3><p>ä¸»è¦ä»»åŠ¡ï¼š</p><ol><li>æ”¶é›†æ ‡è¯†ç¬¦çš„å±æ€§ä¿¡æ¯</li></ol><ul><li>ç§å±Kindï¼šç®€å•å˜é‡ã€å¤åˆå˜é‡ã€è¿‡ç¨‹</li><li>ç±»å‹Type: æ•´å‹ã€å­—ç¬¦å‹â€¦</li><li>å­˜å‚¨ä½ç½®ã€é•¿åº¦</li><li>å€¼</li><li>ä½œç”¨åŸŸ</li><li>å‚æ•°å’Œè¿”å›å€¼ä¿¡æ¯</li></ul><p>ç¬¦å·è¡¨ï¼šç”¨äºå­˜æ”¾æ ‡è¯†ç¬¦çš„å±æ€§ä¿¡æ¯çš„æ•°æ®ç»“æ„</p><ol start="2"><li>è¯­ä¹‰æ£€æŸ¥<ul><li>å˜é‡æˆ–è¿‡ç¨‹æœªç»å£°æ˜å°±ä½¿ç”¨</li><li>å˜é‡æˆ–è¿‡ç¨‹åé‡å¤å£°æ˜</li><li>è¿ç®—åˆ†é‡ç±»å‹ä¸åŒ¹é…</li><li>æ“ä½œç¬¦å’Œæ“ä½œæ•°ä¹‹é—´çš„ç±»å‹ä¸åŒ¹é…<ul><li>æ•°ç»„ä¸‹è¡¨ä¸æ˜¯æ•´æ•°â€¦</li><li>â€¦</li></ul></li></ul></li></ol><h3 id="ä¸­é—´ä»£ç ç”Ÿæˆå’Œç¼–è¯‘å™¨åç«¯">ä¸­é—´ä»£ç ç”Ÿæˆå’Œç¼–è¯‘å™¨åç«¯</h3><p>ä¸‰åœ°å€ç (Three-address Code)</p><p>â€‹ç”±ç±»ä¼¼æ±‡ç¼–çš„æŒ‡ä»¤åºåˆ—ç»„æˆï¼Œæ¯ä¸ªæŒ‡ä»¤æœ€å¤šç”±ä¸‰ä¸ªæ“ä½œæ•°(operand)</p><p>å¸¸ç”¨çš„ä¸‰åœ°å€æŒ‡ä»¤</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210830171023260.png" alt="image-20210830171023260"></p><p>ä¸‰åœ°å€æŒ‡ä»¤çš„å››å…ƒå¼è¡¨ç¤º</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210830171111052.png" alt="image-20210830171111052"></p><p>ä¸¾ä¸ªä¾‹å­</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210830172102677.png" alt="image-20210830172102677"></p><p>è¯­æ³•ç»“æ„æ ‘/è¯­æ³•æ ‘ï¼ˆSyntax Treeï¼‰</p><h2 id="è¯­è¨€åŠå…¶æ–‡æ³•">è¯­è¨€åŠå…¶æ–‡æ³•</h2><h3 id="åŸºæœ¬æ¦‚å¿µ-v2">åŸºæœ¬æ¦‚å¿µ</h3><p>å­—æ¯è¡¨ï¼šä¸€ä¸ªæœ‰ç©·ç¬¦å·é›†åˆ</p><p>ä¹˜ç§¯ã€næ¬¡å¹‚ã€æ­£é—­åŒ…ã€å…‹æ—é—­åŒ…</p><p>ä¸²ï¼šå­—æ¯è¡¨ä¸­ç¬¦å·çš„æœ‰ç©·åºåˆ—ï¼ˆç©ºä¸²çš„é•¿åº¦ä¸º0ï¼‰</p><p>è¿æ¥ï¼ˆconnectionï¼‰ï¼šyé™„åŠ åˆ°xåé¢å½¢æˆçš„ä¸²ï¼Œxy</p><p>ç©ºä¸²æ˜¯è¿æ¥è¿ç®—çš„å•ä½å…ƒ</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210830172522935.png" alt="image-20210830172522935"></p><p>ä¸²sçš„næ¬¡å¹‚ï¼šå°†nä¸ªsè¿æ¥èµ·æ¥</p><h3 id="æ–‡æ³•çš„å®šä¹‰">æ–‡æ³•çš„å®šä¹‰</h3><p>æ–‡æ³•çš„å½¢å¼åŒ–å®šä¹‰</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210830172924632.png" alt="image-20210830172924632"></p><p>Vn éç»ˆç»“ç¬¦ï¼šç”¨æ¥è¡¨ç¤ºè¯­æ³•æˆåˆ†çš„ç¬¦å·ï¼ˆâ€œè¯­æ³•å˜é‡â€ï¼‰</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210830173602635.png" alt="image-20210830173602635"></p><p>Sï¼šå¼€å§‹ç¬¦å·ï¼Œè¡¨ç¤ºè¯¥æ–‡æ³•ä¸­æœ€å¤§çš„è¯­æ³•æˆåˆ†</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210830174100349.png" alt="image-20210830174100349"></p><p><strong>ç¬¦å·çº¦å®š</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210830174146387.png" alt="image-20210830174146387"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210830174157061.png" alt="image-20210830174157061"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210830174324785.png" alt="image-20210830174324785"></p><h3 id="è¯­è¨€çš„å®šä¹‰">è¯­è¨€çš„å®šä¹‰</h3><p>æ¨å¯¼Derivationså’Œè§„çº¦Reductions</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210901172339176.png" alt="image-20210901172339176"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210901172605747.png" alt="image-20210901172605747"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210901172850379.png" alt="image-20210901172850226"></p><p>å½’çº¦æ˜¯æ¨å¯¼çš„é€†è¿‡ç¨‹</p><p>å¥å‹å’Œå¥å­</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210901173246838.png" alt="image-20210901173246838"></p><p><img src="/home/pplong/.config/Typora/typora-user-images/image-20210901173408893.png" alt="image-20210901173408893"></p><h3 id="æ–‡æ³•åˆ†ç±»">æ–‡æ³•åˆ†ç±»</h3><p><strong>0å‹æ–‡æ³•</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211026164131136.png" alt="image-20211026164131136"></p><p>0å‹æ–‡æ³•ç”Ÿæˆçš„è¯­è¨€æ˜¯0å‹è¯­è¨€ L(0)</p><p><strong>1å‹è¯­è¨€</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211026164316687.png" alt="image-20211026164316687"></p><p><strong>2å‹æ–‡æ³•</strong></p><p>ä¸Šä¸‹æ–‡æ— å…³æ–‡æ³•</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211026164429771.png" alt="image-20211026164347199"></p><p><strong>3å‹æ–‡æ³•</strong></p><p>æ­£åˆ™æ–‡æ³•</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211026164600834.png" alt="image-20211026164600834"></p><p><strong>è”ç³»</strong></p><p>é€çº§çš„åŒ…å«å…³ç³»ï¼Œ0å‹æ–‡æ³•åŒ…å«åŸŸæœ€å¹¿</p><h3 id="ä¸Šä¸‹æ–‡æ— å…³æ–‡æ³•çš„è¯­æ³•æ ‘">ä¸Šä¸‹æ–‡æ— å…³æ–‡æ³•çš„è¯­æ³•æ ‘</h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211026164933836.png" alt="image-20211026164933836"></p><p><strong>å¥å‹çš„çŸ­è¯­</strong></p><p>åˆ†ææ ‘ä¸­æ¯ä¸€æ£µè‡ªèº«çš„è¾¹ç¼˜ ï¼š è¯¥å¥å‹çš„ä¸€ä¸ªçŸ­è¯­<br>ç›´æ¥çŸ­è¯­ï¼šå­æ ‘åªæœ‰çˆ¶å­ä¸¤ä»£èŠ‚ç‚¹ï¼Œåˆ™å­æ ‘çš„è¾¹ç¼˜å«è¿™ä¸ªå¥å‹çš„ç›´æ¥çŸ­è¯­</p><p>ç›´æ¥çŸ­è¯­ä¸€å®šæ˜¯æŸä¸ªäº§ç”Ÿå¼çš„å³éƒ¨<br>äº§ç”Ÿå¼çš„å³éƒ¨ä¸ä¸€å®šæ˜¯ç»™å®šå¥å‹çš„ç›´æ¥çŸ­è¯­</p><p><strong>äºŒä¹‰æ€§æ–‡æ³•</strong></p><p>ä¸€ä¸ªæ–‡æ³•å¯ä¸ºæŸä¸ªå¥å­ç”Ÿæˆå¤šæ£µåˆ†ææ ‘ï¼Œåˆ™è¿™ä¸ªæ–‡æ³•æ˜¯äºŒä¹‰æ€§çš„</p><h2 id="è¯æ³•åˆ†æ">è¯æ³•åˆ†æ</h2><h3 id="æ­£åˆ™è¡¨è¾¾å¼">æ­£åˆ™è¡¨è¾¾å¼</h3><p>æè¿°æ­£åˆ™è¯­è¨€çš„æ›´ç´§å‡‘çš„æ–¹æ³•ï¼ŒæŒ‰ç…§ä¸€å®šçš„è§„åˆ™é€’å½’æ„å»º</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211026165918119.png" alt="image-20211026165918119"></p><p>å¯ä»¥ç”¨æ­£åˆ™è¡¨è¾¾å¼å®šä¹‰çš„è¯­è¨€å«æ­£åˆ™è¯­è¨€æˆ–è€…æ­£åˆ™é›†åˆ</p><p><strong>ä»£æ•°è§„å¾‹</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211026170108127.png" alt="image-20211026170108127"></p><p><strong>ç­‰ä»·æ€§</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211026170141425.png" alt="image-20211026170141425"></p><h3 id="æ­£åˆ™å®šä¹‰">æ­£åˆ™å®šä¹‰</h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211026170231330.png" alt="image-20211026170231330"></p><p>æä¾›äº†ç±»ä¼¼Aliasä¹‹ç±»çš„ä¸œè¥¿</p><p>ä¾‹å­</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211026170424415.png" alt="image-20211026170424415"></p><h3 id="æœ‰ç©·è‡ªåŠ¨æœº">æœ‰ç©·è‡ªåŠ¨æœº</h3><p>Finite Automata</p><p>å…·æœ‰ç¦»æ•£çš„è¾“å…¥è¾“å‡ºä¿¡æ¯å’Œæœ‰ç©·æ•°ç›®çš„å†…éƒ¨çŠ¶æ€ã€‚æ ¹æ®å½“å‰çš„çŠ¶æ€å’Œé¢ä¸´çš„è¾“å…¥ä¿¡æ¯å¯ä»¥å†³å®šç³»ç»Ÿçš„åç»§è¡Œä¸ºï¼ˆç”µæ¢¯è£…ç½®ï¼‰</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211026170802603.png" alt="image-20211026170802603"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211026170828588.png" alt="image-20211026170828588"></p><p>å¦‚æœå­˜åœ¨ä¸€ä¸ªå¯¹åº”äºè¾“å…¥ä¸²xçš„ä»åˆå§‹çŠ¶æ€åˆ°æŸä¸ªç»ˆæ­¢çŠ¶æ€çš„è½¬æ¢åºåˆ—ï¼Œç§°ä¸²xè¢«è¯¥FAæ¥å—<img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211026171404673.png" alt="image-20211026171404673"></p><p>ä¸€ä¸ªæœ‰ç©·è‡ªåŠ¨æœºMæ¥å—çš„æ‰€æœ‰ä¸²æ„æˆçš„é›†åˆæ˜¯è¯¥FAå®šä¹‰çš„è¯­è¨€ L(M)</p><p><strong>æœ€é•¿å­ä¸²åŒ¹é…</strong></p><p>è¾“å…¥ä¸²çš„å¤šä¸ªå‰ç¼€ä¸ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ¨¡å¼åŒ¹é…æ—¶ï¼Œæ€»æ˜¯é€‰æ‹©æœ€é•¿å‰ç¼€è¿›è¡ŒåŒ¹é…<br>åˆ°è¾¾æŸä¸ªç»ˆæ­¢çŠ¶æ€åï¼Œåªè¦è¾“å…¥å¸¦è¿˜æœ‰ç¬¦å·ï¼ŒFAå°±ç»§ç»­å‰è¿›ï¼Œå¯»æ‰¾å°½å¯èƒ½é•¿çš„åŒ¹é…</p><p><strong>åˆ†ç±»</strong></p><ul><li>ç¡®å®šçš„FA  DFA</li><li>éç¡®å®šçš„FA  NFA</li></ul><h4 id="DFA">DFA</h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027143046811.png" alt="image-20211027143046811"></p><p>DFA å¯ä»¥ç”¨è½¬æ¢å›¾æˆ–è€…è½¬æ¢è¡¨è¡¨ç¤º</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027143449774.png" alt="image-20211027143449774"></p><h4 id="NFA">NFA</h4><p>æ²¿ç€æ ‡è®°a çš„è¾¹èƒ½è¾¾åˆ°çš„çŠ¶æ€çš„<strong>é›†åˆ</strong>ï¼ˆä¸æ˜¯å•ä¸€çš„ï¼‰</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027143523033.png" alt="image-20211027143523033"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027143734974.png" alt="image-20211027143734974"></p><p><strong>ç­‰ä»·æ€§</strong></p><p>å¯¹äºä»»ä½•NFA éƒ½å­˜åœ¨è¯†åˆ«åŒä¸€è¯­è¨€çš„DFA<br>å¯¹äºä»»ä½•NFA éƒ½å­˜åœ¨è¯†åˆ«åŒæ„è¯­è¨€çš„NFA</p><p>$$ æ­£åˆ™æ–‡æ³• \Longleftrightarrow  æ­£åˆ™è¡¨è¾¾å¼ \Longleftrightarrow  FA$$</p><p><strong>å¸¦æœ‰ç©ºè¾¹çš„NFA</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027144532929.png" alt="image-20211027144532929"></p><p><strong>ä¸ä¸å¸¦ç©ºè¾¹NFAçš„ç­‰ä»·æ€§</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027144650234.png" alt="image-20211027144650234"></p><h4 id="æ­£åˆ™è¡¨è¾¾å¼-DFA">æ­£åˆ™è¡¨è¾¾å¼ -&gt; DFA</h4><p>$$æ­£åˆ™è¡¨è¾¾å¼ \xrightarrow {NFA}  DFA $$</p><h5 id="æ­£åˆ™è¡¨è¾¾å¼-NFA">æ­£åˆ™è¡¨è¾¾å¼ -&gt; NFA</h5><p>ä¸åŒçš„æ­£åˆ™è¡¨è¾¾å¼å¯¹åº”çš„NFAç±»å‹</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027145312770.png" alt="image-20211027145312770"></p><h5 id="NFA-DFA">NFA -&gt; DFA</h5><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027145543629.png" alt="image-20211027145543629"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027150323489.png" alt="image-20211027150323489"></p><p>$$\varepsilon-closure(s)$$ï¼š èƒ½å¤Ÿä»NFAçŠ¶æ€så¼€å§‹åªé€šè¿‡$$\varepsilon$$è½¬æ¢åˆ°è¾¾NFAçŠ¶æ€é›†åˆ</p><h3 id="è¯†åˆ«æ ‡è¯†ç¬¦çš„DFA">è¯†åˆ«æ ‡è¯†ç¬¦çš„DFA</h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027150803811.png" alt="image-20211027150803811"></p><p>è½¬æ¢</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027151105738.png" alt="image-20211027151105738"></p><p>æ•´åˆå¤šä¸ªDFAä¸ºä¸€ä¸ªDFA</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027151303681.png" alt="image-20211027151303681"></p><h3 id="è¯æ³•åˆ†æé˜¶æ®µçš„é”™è¯¯å¤„ç†">è¯æ³•åˆ†æé˜¶æ®µçš„é”™è¯¯å¤„ç†</h3><ul><li>å•è¯æ‹¼å†™é”™è¯¯ int i = 0x3G</li><li>éæ³•å­—ç¬¦ ~ @</li></ul><p>å¦‚æœå½“å‰çŠ¶æ€ä¸å½“å‰è¾“å…¥ç¬¦å·åœ¨è½¬æ¢è¡¨å¯¹åº”é¡¹ä¸­çš„ä¿¡æ¯ä¸ºç©ºï¼Œåˆ™æŠ¥é”™ï¼Œè°ƒç”¨é”™è¯¯å¤„ç†ç¨‹åº</p><ul><li>æŸ¥æ‰¾å·²æ‰«æå­—ç¬¦ä¸²ä¸­çš„æœ€åä¸€ä¸ªå¯¹åº”äºæŸç»ˆæ€çš„å­—ç¬¦<ul><li>æ‰¾åˆ°äº†ï¼Œå°†è¯¥å­—ç¬¦ä¸å‰é¢çš„å­—ç¬¦è¯†åˆ«æˆä¸€ä¸ªå•è¯ã€‚è¾“å…¥æŒ‡é’ˆé€€å›åˆ°è¯¥å­—ç¬¦ï¼Œæ‰«æå™¨é‡æ–°å›åˆ°åˆå§‹çŠ¶æ€</li><li>æ²¡æ‰¾åˆ°ï¼Œè¯´æ˜å‡ºé”™ï¼Œé‡‡ç”¨é”™è¯¯æ¢å¤ç­–ç•¥</li></ul></li></ul><p><strong>ææ…Œæ¨¡å¼</strong></p><p>åœ¨å‰©ä½™çš„è¾“å…¥ä¸­ä¸æ–­åˆ é™¤å­—ç¬¦ï¼Œç›´åˆ°è¯æ³•åˆ†æå™¨èƒ½åœ¨å‰©ä½™è¾“å…¥çš„å¼€å¤´å‘ç°ä¸€ä¸ªæ­£ç¡®çš„å­—ç¬¦ä¸ºæ­¢</p><h2 id="è‡ªé¡¶è‡³ä¸‹åˆ†æ">è‡ªé¡¶è‡³ä¸‹åˆ†æ</h2><h3 id="Firstå’ŒFollowé›†">Firstå’ŒFollowé›†</h3><h4 id="è®¡ç®—FIRST">è®¡ç®—FIRST</h4><p><strong>First(X)</strong>ï¼šå¯ä»¥ä»Xæ¨å¯¼å‡ºçš„æ‰€æœ‰<strong>ä¸²é¦–ç»ˆç»“ç¬¦</strong>æ„æˆçš„é›†åˆï¼Œå¦‚æœXèƒ½æ¨åˆ°å‡ºeï¼Œåˆ™eâˆˆFIRST(X)</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027152208916.png" alt="image-20211027152208916"></p><p>è®¡ç®—æ–¹å¼ï¼š</p><ul><li><p>è®¡ç®—ä¸€ä¸ªç¬¦å·çš„FIRST</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211013161156540.png" alt="image-20211013161156540"></p></li><li><p>è®¡ç®—ç¬¦å·ä¸²çš„FISTR</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211013161604282.png" alt="image-20211013161604282"></p></li></ul><h4 id="è®¡ç®—ç»ˆç»“ç¬¦çš„FOLLOW">è®¡ç®—ç»ˆç»“ç¬¦çš„FOLLOW</h4><p>FOLLOW(A) : å¯èƒ½åœ¨æŸä¸ªå¥å‹ä¸­ç´§è·Ÿåœ¨Aåè¾¹çš„ç»ˆç»“ç¬¦açš„é›†åˆï¼Œå¦‚æœAæ˜¯æŸä¸ªçŸ©å½¢çš„æœ€å³ç¬¦å·ï¼Œåˆ™æŠŠ$æ·»åŠ åˆ°FOLLOW(A)ä¸­</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211013161756283.png" alt="image-20211013161756283"></p><p>ä¸€ä¸ªç»ˆç»“ç¬¦çš„followé›†å¯èƒ½ä¾èµ–äºå¦ä¸€ä¸ªç»ˆç»“ç¬¦çš„followé›†</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027152929030.png" alt="image-20211027152929030"></p><p>ç®—æ³•ï¼š</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211013163110606.png" alt="image-20211013163110606"></p><p><strong>æ³¨æ„è¦è¿­ä»£æ›´æ–°å“¦ï¼ï¼ï¼</strong></p><h4 id="è®¡ç®—SELECTé›†åˆ">è®¡ç®—SELECTé›†åˆ</h4><p>å®šä¹‰</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211013164202043.png" alt="image-20211013164202043"></p><p>è®¡ç®—</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211013164234537.png" alt="image-20211013164234537"></p><h4 id="LL-1-æ–‡æ³•">LL(1)æ–‡æ³•</h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211013164326833.png" alt="image-20211013164326833"></p><p>$$SELECT(A \rightarrow \alpha)  \cap SELECT(A \rightarrow \beta) = \phi $$<br>å…¶ä¸­alpha å’Œbetaä¸èƒ½åŒæ—¶ $$\xRightarrow * \varepsilon$$</p><p><strong>æ³¨æ„ç¬¬ä¸€æ¡</strong>  ----&gt; Î±å’ŒÎ²çš„SELECTé›†å°±ä¸ä¼šç›¸äº¤äº†</p><p><strong>ç¬¬ä¸‰æ¡æ„ä¹‰</strong>ï¼šåŒä¸€éç»ˆç»“ç¬¦çš„å„ä¸ªäº§ç”Ÿå¼çš„å¯é€‰é›†ä¸ç›¸äº¤</p><ul><li>Lï¼šä»å·¦å‘å³æ‰«æè¾“å…¥</li><li>Lï¼šäº§ç”Ÿæœ€å·¦æ¨å¯¼</li><li>1ï¼šæ¯ä¸€æ­¥åªéœ€è¦å‘å‰çœ‹ä¸€ä¸ªè¾“å…¥ç¬¦å·æ¥å†³å®šè¯­æ³•åˆ†æåŠ¨ä½œ</li></ul><h3 id="é€’å½’çš„é¢„æµ‹åˆ†ææ³•">é€’å½’çš„é¢„æµ‹åˆ†ææ³•</h3><p>åœ¨é¢„æµ‹ä¸‹é™åˆ†æä¸­ï¼Œç¼–å†™æ¯ä¸€ä¸ªéç»ˆç»“ç¬¦å¯¹åº”çš„è¿‡ç¨‹æ—¶ï¼Œæ ¹æ®é¢„æµ‹åˆ†æè¡¨è¿›è¡Œäº§ç”Ÿå¼çš„é€‰æ‹©</p><p>ä¸ºæ¯ä¸€ä¸ªéç»ˆç»“ç¬¦éƒ½è¦ç¼–å†™é€’å½’çš„ä¸‹é™è¿‡ç¨‹</p><h3 id="éé€’å½’çš„é¢„æµ‹åˆ†ææ³•">éé€’å½’çš„é¢„æµ‹åˆ†ææ³•</h3><p>æ ¹æ®é¢„æµ‹åˆ†æè¡¨æ„é€ ä¸€ä¸ªè‡ªåŠ¨æœº ï¼ˆè¡¨é©±åŠ¨çš„é¢„æµ‹åˆ†æï¼‰</p><p>ä¸‹æ¨è‡ªåŠ¨æœºPDAã€‚DFAä¸èƒ½è¯†åˆ«ä¸‹é¢çš„ä¾‹å­</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027155042904.png" alt="image-20211027155042904"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027155343212.png" alt="image-20211027155343212"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027155414682.png" alt="image-20211027155414682"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027155533916.png" alt="image-20211027155533916"></p><p>æ€»ç»“</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027155712340.png" alt="image-20211027155712340"></p><h3 id="é¢„æµ‹åˆ†æä¸­çš„é”™è¯¯å¤„ç†">é¢„æµ‹åˆ†æä¸­çš„é”™è¯¯å¤„ç†</h3><ul><li>æ ˆé¡¶éç»ˆç»“ç¬¦å’Œå½“å‰è¾“å…¥ç¬¦å·ä¸åŒ¹é…</li><li>æ ˆé¡¶éç»ˆç»“ç¬¦ä¸å½“å‰è¾“å…¥ç¬¦å·åœ¨ä¸€è¹™é¢åˆ†æè¡¨å¯¹åº”é¡¹ä¸­çš„ä¿¡æ¯ä¸ºç©º</li></ul><p><strong>é‡‡ç”¨ææ…Œæ¨¡å¼</strong>ï¼šå¿½ç•¥è¾“å…¥ä¸­çš„ä¸€äº›ç¬¦å·ï¼ŒçŸ¥é“è¾“å…¥ä¸­å‡ºç°ç”±è®¾è®¡è€…é€‰å®šçš„åŒæ­¥è¯æ³•å•å…ƒé›†åˆä¸­çš„æŸä¸ªè¯æ³•å•å…ƒ</p><p>ä¾‹å­</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027160145284.png" alt="image-20211027160145284"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027160429586.png" alt="image-20211027160429586"></p><h2 id="è‡ªåº•å‘ä¸Šåˆ†æ">è‡ªåº•å‘ä¸Šåˆ†æ</h2><p><strong>ä»¥æ¶ˆé™¤å‰©ä½™è¾“å…¥ä¸ºä¸»</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027161701527.png" alt="image-20211027161701527"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027161927887.png" alt="image-20211027161927887"></p><p>ä¸€æœ‰åŒ¹é…å°±å½’çº¦ï¼ˆä»¥åˆšè¿›æ¥çš„ä¸ºå‡†ï¼‰</p><p>å¤±è´¥æƒ…å†µ</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027162628334.png" alt="image-20211027162628334"></p><p>&lt; IDS &gt;,ib æ²¡æœ‰è¿›è¡Œè§„çº¦ï¼Œé”™è¯¯çš„è¯†åˆ«äº†å¥æŸ„</p><p>å¥æŸ„ï¼šå¥å‹çš„æœ€å·¦ç›´æ¥çŸ­è¯­</p><h3 id="LRåˆ†ææ³•">LRåˆ†ææ³•</h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027163000350.png" alt="image-20211027163000350"></p><p>åŸºæœ¬åŸç†</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027163142562.png" alt="image-20211027163142562"></p><p>çŠ¶æ€å †æ ˆ +  è¾“å…¥ç¬¦å·å †æ ˆ + ç¼“å†²ç¬¦å·æ ˆ</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027164920571.png" alt="image-20211027164920571"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027164749977.png" alt="image-20211027164749977"></p><h4 id="LR-0">LR(0)</h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027165127289.png" alt="image-20211027165127289"></p><p><strong>å¢å¹¿æ–‡æ³•</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027165227328.png" alt="image-20211027165227328"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027165405765.png" alt="image-20211027165405765"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027170026739.png" alt="image-20211027170026739"></p><h4 id="åˆ†æè¡¨æ„é€ ">åˆ†æè¡¨æ„é€ </h4><p><strong>closureå‡½æ•°</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027170944130.png" alt="image-20211027170944130"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027171011018.png" alt="image-20211027171011018"></p><p><strong>gotoå‡½æ•°</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027171028416.png" alt="image-20211027171028416"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027171047696.png" alt="image-20211027171047696"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027170912641.png" alt="image-20211027170912641"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027171131963.png" alt="image-20211027171131963"></p><p>ç§»å…¥/å½’çº¦å†²çª</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027171227654.png" alt="image-20211027171227654"></p><p>å½’çº¦å½’çº¦å†²çª</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211027171319095.png" alt="image-20211027171319095"></p><p>ä¸æ˜¯æ‰€æœ‰çš„CFGä¸Šä¸‹æ–‡æ— å…³æ–‡æ³•éƒ½èƒ½ç”¨LR0æ–¹æ³•è¿›è¡Œåˆ†æï¼ŒCFGä¸æ€»æ˜¯LR0æ–‡æ³•</p><h3 id="SLRåˆ†æ">SLRåˆ†æ</h3><p>FOLLOWé›†å¸®åŠ©åˆ¤å®šä»€ä¹ˆæ—¶å€™è§„çº¦ï¼ŒSLRï¼ˆ1ï¼‰ï¼šå‘å‰æŸ¥çœ‹ä¸€ä¸ªç¬¦å·</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211103095603535.png" alt="image-20211103095603535"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211103095819326.png" alt="image-20211103095819326"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211103095927692.png" alt="image-20211103095927692"></p><h3 id="LRï¼ˆ1ï¼‰åˆ†æ">LRï¼ˆ1ï¼‰åˆ†æ</h3><p>SLRåˆ†æå­˜åœ¨çš„é—®é¢˜</p><ul><li>ä»…ä»…ç®€å•è€ƒå¯Ÿä¸‹ä¸€ä¸ªè¾“å…¥ç¬¦å·æ˜¯å¦å±äºè§„çº¦é¡¹ç›®çš„FOLLOWé›†ï¼Œä½†ä¸èƒ½ç¡®ä¿æ­£ç¡®çš„è§„çº¦</li></ul><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211103100100103.png" alt="image-20211103100100103"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211103100320722.png" alt="image-20211103100320722"></p>]]></content>
    
    
    
    <tags>
      
      <tag>è®¡ç®—æœºåŸç†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>macä½¿ç”¨æŠ€å·§</title>
    <link href="/2021/06/22/mac%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7/"/>
    <url>/2021/06/22/mac%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7/</url>
    
    <content type="html"><![CDATA[<h1>Macä½¿ç”¨æŠ€å·§</h1><span id="more"></span><hr><h2 id="å·²çŸ¥èƒ½å¤Ÿå®ç°åŠŸèƒ½">å·²çŸ¥èƒ½å¤Ÿå®ç°åŠŸèƒ½</h2><ol><li>è°ƒæ•´å›¾ç‰‡å¤§å° -åˆ†è¾¨ç‡      ------å·¥å…·</li><li></li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>MacOS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ffmpegå­¦ä¹ </title>
    <link href="/2021/06/04/ffmpeg%E5%AD%A6%E4%B9%A0/"/>
    <url>/2021/06/04/ffmpeg%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1>FFMpeg å­¦ä¹ </h1><h2 id="ç®€ä»‹-v2">ç®€ä»‹</h2><h3 id="å†å²-v2">å†å²</h3><p>2000å¹´ FabriceBellard  æ³•å¸ƒåˆ©æ–¯ . è´æ‹‰åˆ›å»º</p><span id="more"></span><h3 id="ä½œç”¨-v2">ä½œç”¨</h3><p>è·¨å¹³å°çš„å¤šåª’ä½“æ¡†æ¶</p><p>è§£ç ã€ç¼–ç ã€è½¬ç ã€å¤ç”¨</p><h3 id="è€»è¾±æŸ±">è€»è¾±æŸ±</h3><p>ç”¨äº†å¼€æºä»£ç å°±è¦å¼€æº  GPLåè®®</p><h2 id="ä½¿ç”¨-v4">ä½¿ç”¨</h2><h3 id="åŸºç¡€-v5">åŸºç¡€</h3><p>./configure --help</p><p>ç¼–è¯‘â€“å®‰è£…</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210604094134326.png" alt="image-20210604094134326"></p><p><strong>å¤„ç†æµç¨‹</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210604094442731.png" alt="image-20210604094442731"></p><p><strong>åŸºæœ¬iä¿¡æ¯æŸ¥è¯¢</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210604094934070.png" alt="image-20210604094934070"></p><p><strong>å½•åˆ¶å‘½ä»¤</strong></p><p>-f  æŒ‡å®šä½¿ç”¨â€¦é‡‡é›†æ•°æ®</p><p>-i  æŒ‡å®šä»å“ªé‡‡é›†ä¹¦ï¼Œæ˜¯æ–‡ä»¶ç´¢å¼•å·</p><p>-r  æŒ‡å®šå¸§ç‡</p><div class="code-wrapper"><pre class="language-none"><code class="language-none">ffmpeg -f x11grab -video_size 1920x1080 -i $DISPLAY -f alsa -i default -c:v ffvhuff -c:a flac test.mkv</code></pre></div><p>ffplayæ’­æ”¾</p><div class="code-wrapper"><pre class="language-none"><code class="language-none">ffmpeg -f x11grab -video_size 1920x1080 -i $DISPLAY -f alsa -i default -c:v ffvhuff -c:a flac test.mkv</code></pre></div><h2 id="ä½¿ç”¨-v5">ä½¿ç”¨</h2><p><strong>å½•åˆ¶</strong></p><p>éŸ³é¢‘</p><div class="code-wrapper"><pre class="language-none"><code class="language-none">ffmpeg -f alsa -i hw:0 alsaout.wav</code></pre></div><h4 id="åˆ†è§£-å’Œ-å¤ç”¨">åˆ†è§£ å’Œ å¤ç”¨</h4><p>-an ä¸è¦éŸ³é¢‘</p><p>-acodec copy   -vcodec copy</p><h3 id="å¤„ç†åŸå§‹æ•°æ®">å¤„ç†åŸå§‹æ•°æ®</h3><p>éŸ³é¢‘ PCM   è§†é¢‘ YUV</p><h4 id="FFMPEG-æå–yuv">FFMPEG æå–yuv</h4><p>ffmpeg -f alsa -i hw:1 alsaout.wa</p><p>ffmpeg -i ig.mp4 -vn -ar 44100 -ac 2 -f s16le igpcm.pcm</p><p>s æœ‰ç¬¦å·  16 æ¯ä¸ªæ•°å€¼ç”¨16ä½è¡¨ç¤º  le å­˜å‚¨æ–¹å¼ ï¼ˆå°å¤´å­˜å‚¨ï¼‰</p><h4 id="è£å‰ª-åˆå¹¶">è£å‰ª åˆå¹¶</h4><p>ffmpeg -i ig.mp4 -vf crop=in_w-400:in_h-200 -c:v libx264 -c:a copy igcrop.mp4</p><h4 id="å›¾ç‰‡å’Œè§†é¢‘äº’è½¬">å›¾ç‰‡å’Œè§†é¢‘äº’è½¬</h4><p>ffmpeg -i ig.mp4 -vf crop=in_w-400:in_h-200 -c:v libx264 -c:a copy igcrop.mp4</p><p>input.txt</p><p>file â€œname.mp4â€</p><p>â€¦</p><p>è§†é¢‘é€‰å›¾ç‰‡ffmpeg -i video.mp4 -r 1 -f image2 image-%4d.jpeg</p><p>å›¾ç‰‡æ•´è§†é¢‘ffmpeg -i image-%4d.jpeg out.mp4</p><h4 id="æ»¤é•œå‘½ä»¤">æ»¤é•œå‘½ä»¤</h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210604131256759.png" alt="image-20210604131256759"></p><p>ffmpeg -i ig.mp4 -vf crop=in_w-400:in_h-200 -c:v libx264 -c:a copy igcrop.mp4</p><h4 id="ç›´æ’­æ¨-æ‹‰æµ">ç›´æ’­æ¨/æ‹‰æµ</h4><p>ffmpeg -i  rtmp://58.200.131.2:1935/livetv/hunantv -c copy out.flv</p><h2 id="åŸºæœ¬è¿›é˜¶">åŸºæœ¬è¿›é˜¶</h2><h3 id="åˆæ­¥">åˆæ­¥</h3><p>æºç ç»“æ„</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210604140904947.png" alt="image-20210604140904947"></p><h3 id="æ“ä½œç›®å½•">æ“ä½œç›®å½•</h3><h4 id="å¤„ç†æµæ•°æ®">å¤„ç†æµæ•°æ®</h4><p>å¤šåª’ä½“æ–‡ä»¶ï¼šå®¹å™¨  åŒ…å«å¤šä¸ªæµ</p><p>æµï¼šæ¯ç§æµç”±ä¸åŒç¼–ç å™¨ç¼–ç çš„</p><p>åŒ…ï¼šä»æµä¸­è¯»å–çš„æ•°æ®  åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå¸§</p><p><strong>å‡ ä¸ªé‡è¦çš„ç»“æ„ä½“</strong></p><ul><li>AVFormateContext ï¼š é“¾æ¥å¤šä¸ªæµçš„æ¡¥æ¢</li><li>AVStreamï¼šæ‰€æœ‰çš„æµ</li><li>AVPacketï¼š æµä¸­çš„æ¯ä¸€å—æ•°æ®</li></ul><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210605105046328.png" alt="image-20210605105046328"></p><p><strong>å®æˆ˜ï¼šæ‰“å°éŸ³è§†é¢‘ä¿¡æ¯</strong></p><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;libavutil/log.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;libavformat/avformat.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"begin!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    AVFormatContext <span class="token operator">*</span>fmt_ctx <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> ret <span class="token punctuation">;</span>     <span class="token function">av_log_set_level</span><span class="token punctuation">(</span>AV_LOG_INFO<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">av_register_all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ret <span class="token operator">=</span> <span class="token function">avformat_open_input</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>fmt_ctx<span class="token punctuation">,</span> <span class="token string">"./ig.mp4"</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">av_log</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> AV_LOG_ERROR<span class="token punctuation">,</span> <span class="token string">"Cant open !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">av_dump_format</span><span class="token punctuation">(</span>fmt_ctx<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"./ig.mp4"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">avformat_close_input</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>fmt_ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">/* code */</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p><strong>å®æˆ˜ï¼šæŠ½å–å¤šåª’ä½“æ•°æ®</strong></p><ul><li>av_init_packet()</li><li>av_find_best_stream()</li><li>av_read_frame()  / av_packet_unref()</li></ul><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;libavutil/log.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;libavformat/avformat.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;libavcodec/packet.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">char</span><span class="token operator">*</span> src <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token keyword">char</span><span class="token operator">*</span> dst <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> audio_index<span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"begin!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    AVPacket pkt <span class="token punctuation">;</span>    AVFormatContext <span class="token operator">*</span>fmt_ctx <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> ret <span class="token punctuation">;</span>     <span class="token function">av_log_set_level</span><span class="token punctuation">(</span>AV_LOG_INFO<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">av_register_all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// read two params from console</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>argc <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">av_log</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> AV_LOG_ERROR<span class="token punctuation">,</span> <span class="token string">"wrong number"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    src <span class="token operator">=</span> argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>     dst <span class="token operator">=</span> argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>src <span class="token operator">||</span> <span class="token operator">!</span>dst<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token function">av_log</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> AV_LOG_ERROR<span class="token punctuation">,</span> <span class="token string">"wrong input"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    ret <span class="token operator">=</span> <span class="token function">avformat_open_input</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>fmt_ctx<span class="token punctuation">,</span> src<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">av_log</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> AV_LOG_ERROR<span class="token punctuation">,</span> <span class="token string">"Cant open !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>     FILE<span class="token operator">*</span> dst_fd <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span><span class="token string">"wb"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>dst_fd<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">av_log</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> AV_LOG_ERROR<span class="token punctuation">,</span> <span class="token string">"cant open file"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token function">av_dump_format</span><span class="token punctuation">(</span>fmt_ctx<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> src<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// get stream</span>    ret <span class="token operator">=</span> <span class="token function">av_find_best_stream</span><span class="token punctuation">(</span>fmt_ctx<span class="token punctuation">,</span> AVMEDIA_TYPE_AUDIO<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>ret <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">av_log</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> AV_LOG_ERROR<span class="token punctuation">,</span> <span class="token string">"Cant find best stream"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">fclose</span><span class="token punctuation">(</span>dst_fd<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    audio_index <span class="token operator">=</span> ret<span class="token punctuation">;</span>    <span class="token function">av_init_packet</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>pkt<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// dump to a new file</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">av_read_frame</span><span class="token punctuation">(</span>fmt_ctx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>pkt<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"read frame"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> len <span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>pkt<span class="token punctuation">.</span>stream_index <span class="token operator">==</span> audio_index<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            len <span class="token operator">=</span> <span class="token function">fwrite</span><span class="token punctuation">(</span>pkt<span class="token punctuation">.</span>data<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> pkt<span class="token punctuation">.</span>size<span class="token punctuation">,</span> dst_fd<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>len <span class="token operator">!=</span> pkt<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token function">av_log</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> AV_LOG_ERROR<span class="token punctuation">,</span> <span class="token string">"fwrite wrong"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">av_packet_unref</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>pkt<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">avformat_close_input</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>fmt_ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>dst_fd<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">fclose</span><span class="token punctuation">(</span>dst_fd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>       <span class="token comment">/* code */</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p><strong>å®æˆ˜ï¼šæŠ½H264</strong></p><ul><li>startcode  ç‰¹å¾ç ï¼ŒåŒºåˆ†å¸§ä¸å¸§</li><li>SPS / PPS</li><li>codec --&gt; extradata(sps/pps)</li></ul><p><strong>å®æˆ˜ï¼šMP4 â€“ flv</strong></p><ul><li><em>è¾“å‡ºä¸Šä¸‹æ–‡</em></li><li>ç”Ÿæˆæ–°çš„éŸ³é¢‘è½¨ new Stream</li><li>å…¶ä»–å‚æ•°çš„copy</li><li>header å¤šåª’ä½“æ–‡ä»¶å¤´</li><li>å†™è¿›æ–‡ä»¶ä¸­</li></ul><p><strong>å®æˆ˜ ï¼šæˆªå–éŸ³è§†é¢‘</strong></p><ul><li>av_seek_frame</li></ul><h3 id="ä¸­çº§å¼€å‘">ä¸­çº§å¼€å‘</h3><h4 id="H264ç¼–ç ">H264ç¼–ç </h4><blockquote><p>libavcodec/avcodec.h</p></blockquote><p>å¸¸ç”¨uæ•°æ®ç»“æ„</p><ol><li>AVCodecç¼–ç å™¨ç»“æ„ä½“</li><li>AVCodecContext ç¼–ç å™¨ä¸Šä¸‹é—®</li><li>AVFrame è§£ç åçš„å¸§\</li></ol><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210606103051471.png" alt="image-20210606103051471"></p><p><strong>å®æˆ˜ï¼šè§†é¢‘è½¬å›¾ç‰‡</strong></p><h4 id="AACç¼–ç ">AACç¼–ç </h4><h2 id="SDL-ç¼–ç ">SDL ç¼–ç </h2><p>Simple DirectMedia Layer  è·¨å¹³å°åª’ä½“aå¼€æºåº“</p><p>ç¼–è¯‘â€¦</p><h3 id="ä½¿ç”¨-v6">ä½¿ç”¨</h3><ol><li>æ·»åŠ å¤´æ–‡ä»¶</li><li>åˆå§‹åŒ–SDL</li><li>é€€å‡ºSDL</li></ol><p>SDLæ¸²æŸ“çª—å£</p><h4 id="åˆ›å»ºçª—å£">åˆ›å»ºçª—å£</h4><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;SDL.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    SDL_Window <span class="token operator">*</span>window <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token function">SDL_Init</span><span class="token punctuation">(</span>SDL_INIT_VIDEO<span class="token punctuation">)</span><span class="token punctuation">;</span>    window <span class="token operator">=</span> <span class="token function">SDL_CreateWindow</span><span class="token punctuation">(</span><span class="token string">"SDL2 Window"</span><span class="token punctuation">,</span>                    <span class="token number">200</span><span class="token punctuation">,</span>                    <span class="token number">200</span><span class="token punctuation">,</span>                    <span class="token number">640</span><span class="token punctuation">,</span>                    <span class="token number">480</span><span class="token punctuation">,</span>                    SDL_WINDOW_SHOWN <span class="token operator">|</span> SDL_WINDOW_BORDER<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>window<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"create window wrong !"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">goto</span> __EXIT<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">SDL_DestroyWindow</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">;</span>__EXIT<span class="token operator">:</span>    <span class="token function">SDL_Quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><h2 id="éŸ³è§†é¢‘åŒæ­¥">éŸ³è§†é¢‘åŒæ­¥</h2><p>æ—¶é—´æˆ³ ï¼š PTS DTS</p><p>I B P</p><p>PTS ï¼š AVPacket ä¸­ã€ AVFrame ä¸­</p><p>av_frame_get_bestâ€¦_timestamp</p><p><strong>æ—¶é—´åŸº</strong></p><p>tbrï¼šå¸§ç‡ ï¼ˆtimebase rateï¼‰</p><p>tbnï¼štime base of stream</p><p>tbcï¼štime base of codec</p><h2 id="image-20210606204155890"><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210606204155890.png" alt="image-20210606204155890"></h2><h2 id="JNI">JNI</h2><h3 id="åŸºæœ¬iæ¦‚å¿µ">åŸºæœ¬iæ¦‚å¿µ</h3><p>JNIEnv  ï¼š</p><p>JavaVMï¼š</p><p>ä¸€ä¸ªJAVAVM----å¾ˆå¤šAçº¿ç¨‹     ä¸€ä¸ªçº¿ç¨‹ â€” ä¸€ä¸ªJNIEnv</p><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c"><span class="token function">Java_com_example_firstcjni_MainActivity_stringFromJNI</span><span class="token punctuation">(</span>        JNIEnv<span class="token operator">*</span> env<span class="token punctuation">,</span>        jobject <span class="token comment">/* this */</span><span class="token punctuation">)</span>     <span class="token comment">// jobject è°è°ƒçš„è¿™ä¸ªæ–¹æ³•</span></code></pre></div><p><strong>Singature</strong></p><p>Java Cç›¸äº’è°ƒç”¨ å‡½æ•°å‚æ•°çš„æè¿°ç¬¦</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210606223147453.png" alt="image-20210606223147453"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210606223157567.png" alt="image-20210606223157567"></p><h3 id="C-C-è°ƒjavaæ–¹æ³•">C/C++è°ƒjavaæ–¹æ³•</h3><h2 id="ié—®é¢˜">ié—®é¢˜</h2><ol><li>uå¦‚ä½•ç†è§£AVFormatContextï¼Ÿ</li><li></li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>éŸ³è§†é¢‘</title>
    <link href="/2021/04/25/%E9%9F%B3%E8%A7%86%E9%A2%91/"/>
    <url>/2021/04/25/%E9%9F%B3%E8%A7%86%E9%A2%91/</url>
    
    <content type="html"><![CDATA[<h1>éŸ³è§†é¢‘</h1><h2 id="åŸºæœ¬æ¦‚å¿µ-v4">åŸºæœ¬æ¦‚å¿µ</h2><h3 id="I-B-P-å¸§">I B P å¸§</h3><span id="more"></span><p>I frame:è‡ªèº«å¯ä»¥é€šè¿‡è§†é¢‘è§£å‹ç®—æ³•è§£å‹æˆä¸€å¼ å•ç‹¬çš„å®Œæ•´çš„å›¾ç‰‡</p><p>P frameï¼šéœ€è¦å‚è€ƒå…¶å‰é¢çš„ä¸€ä¸ªI frame æˆ–è€…P frameæ¥ç”Ÿæˆä¸€å¼ å®Œæ•´çš„å›¾ç‰‡</p><p>B frame:åˆ™è¦å‚è€ƒå…¶å‰ä¸€ä¸ªIæˆ–è€…På¸§åŠå…¶åé¢çš„ä¸€ä¸ªPå¸§æ¥ç”Ÿæˆä¸€å¼ å®Œæ•´çš„å›¾ç‰‡</p><p>GOP  Group of picture  ä¸€ç»„å˜åŒ–ä¸å¤§çš„è§†é¢‘å¸§<br>GOPçš„ç¬¬ä¸€å¸§æˆä¸ºå…³é”®å¸§ï¼š<strong>IDR</strong></p><p>IDRéƒ½æ˜¯Iå¸§ï¼Œå¯ä»¥é˜²æ­¢ä¸€å¸§è§£ç å‡ºé”™ï¼Œå¯¼è‡´åé¢æ‰€æœ‰å¸§è§£ç å‡ºé”™çš„é—®é¢˜ã€‚å½“è§£ç å™¨åœ¨è§£ç åˆ°IDRçš„æ—¶å€™ï¼Œä¼šå°†ä¹‹å‰çš„å‚è€ƒå¸§æ¸…ç©ºï¼Œé‡æ–°å¼€å§‹ä¸€ä¸ªæ–°çš„åºåˆ—ï¼Œè¿™æ ·ï¼Œå³ä¾¿å‰é¢ä¸€å¸§è§£ç å‡ºç°é‡å¤§é”™è¯¯ï¼Œä¹Ÿä¸ä¼šè”“å»¶åˆ°åé¢çš„æ•°æ®ä¸­ã€‚</p><h3 id="DTS-ã€PTS">DTS ã€PTS</h3><p>DTSï¼š Decoding Time Stamp  æ ‡è¯†è¯»å…¥å†…å­˜ä¸­çš„ï½‚ï½‰ï½”æµåœ¨ä»€ä¹ˆæ—¶å€™å¼€å§‹é€å…¥è§£ç å™¨ä¸­è¿›è¡Œè§£ç </p><p>PTS :   Presentation Time Stamp  åº¦é‡è§£ç åçš„è§†é¢‘å¸§ä»€ä¹ˆæ—¶å€™è¢«æ˜¾ç¤ºå‡ºæ¥</p><p><strong>åœ¨æ²¡æœ‰Bå¸§çš„æƒ…å†µä¸‹ï¼ŒDTSå’ŒPTSçš„è¾“å‡ºé¡ºåºæ˜¯ä¸€æ ·çš„ï¼Œä¸€æ—¦å­˜åœ¨Bå¸§ï¼ŒPTSå’ŒDTSåˆ™ä¼šä¸åŒ</strong></p><h3 id="è‰²å½©ç©ºé—´-YUV">è‰²å½©ç©ºé—´ YUV</h3><p>äº®åº¦å’Œè‰²åº¦åˆ†ç¦» Y äº®åº¦  UV ä¸¤ç§è‰²åº¦</p><p>Yï¼šäº®åº¦ï¼Œå°±æ˜¯ç°åº¦å€¼ã€‚é™¤äº†è¡¨ç¤ºäº®åº¦ä¿¡å·å¤–ï¼Œè¿˜å«æœ‰è¾ƒå¤šçš„ç»¿è‰²é€šé“é‡ã€‚<br>Uï¼šè“è‰²é€šé“ä¸äº®åº¦çš„å·®å€¼ã€‚<br>Vï¼šçº¢è‰²é€šé“ä¸äº®åº¦çš„å·®å€¼ã€‚</p><p><strong>ä¼˜åŠ¿</strong></p><p>äººçœ¼å¯¹äº®åº¦æ•æ„Ÿï¼Œå¯¹è‰²åº¦ä¸æ•æ„Ÿï¼Œå› æ­¤å‡å°‘éƒ¨åˆ†UVçš„æ•°æ®é‡ï¼Œäººçœ¼å´æ— æ³•æ„ŸçŸ¥å‡ºæ¥ï¼Œè¿™æ ·å¯ä»¥é€šè¿‡å‹ç¼©UVçš„åˆ†è¾¨ç‡ï¼Œåœ¨ä¸å½±å“è§‚æ„Ÿçš„å‰æä¸‹ï¼Œå‡å°è§†é¢‘çš„ä½“ç§¯ã€‚</p><h4 id="å­˜å‚¨æ–¹å¼">å­˜å‚¨æ–¹å¼</h4><p>planar  packed</p><p><strong>planar å…ˆå­˜all Y å†U  V</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210427090315589.png" alt="image-20210427090315589"></p><p>packed é¡ºåºå­˜å‚¨</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210427090350317.png" alt="image-20210427090350317"></p><p>pakcedå­˜å‚¨æ–¹å¼å·²ç»éå¸¸å°‘ç”¨ï¼Œå¤§éƒ¨åˆ†è§†é¢‘éƒ½æ˜¯é‡‡ç”¨planarå­˜å‚¨æ–¹å¼ã€‚</p><p>ç»†åˆ†planar</p><ol><li><p>YUV  4ï¼š4ï¼š4 ä¸€ä¸ªYå¯¹åº”ä¸€ç»„UV</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210427090442152.png" alt="image-20210427090442152"></p></li><li><p>YUV 4ï¼š2ï¼š2 æ¯ä¸¤ä¸ªYå¯¹åº”ä¸€ç»„UV</p><p><img src="/home/pplong/.config/Typora/typora-user-images/image-20210427090512408.png" alt="image-20210427090512408"></p></li><li><p>YUV 4ï¼š2ï¼š0 æ¯å››ä¸ªYå…¬ç”¨ä¸€ç»„UV</p><p><strong>æœ€å¸¸ç”¨</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210427090547683.png" alt="image-20210427090547683"></p><p>420åˆåˆ†ä¸¤ç§æ¨¡å¼ ä¸‰å¹³é¢å­˜å‚¨</p><p>YYYYYYYYUUVVï¼ˆå¦‚I420ï¼‰æˆ–YYYYYYYYVVUUï¼ˆå¦‚YV12ï¼‰</p><p>420SP ä¸¤å¹³é¢å­˜å‚¨  YYYYYYYYUVUVï¼ˆå¦‚NV12ï¼‰æˆ–YYYYYYYYVUVUï¼ˆå¦‚NV21ï¼‰</p></li></ol><h3 id="ACC">ACC</h3><p>ä¸¤ç§æ ¼å¼ ADIF ã€ADTS</p><h4 id="ADIF">ADIF</h4><p>Audio Data Interchange Formatã€‚ éŸ³é¢‘æ•°æ®äº¤æ¢æ ¼å¼</p><p>å¯ä»¥ç¡®å®šçš„æ‰¾åˆ°è¿™ä¸ªéŸ³é¢‘æ•°æ®çš„å¼€å§‹ï¼Œä¸éœ€è¿›è¡Œåœ¨éŸ³é¢‘æ•°æ®æµä¸­é—´å¼€å§‹çš„è§£ç ï¼Œå³å®ƒçš„<strong>è§£ç å¿…é¡»åœ¨æ˜ç¡®å®šä¹‰çš„å¼€å§‹å¤„è¿›è¡Œ</strong>ã€‚è¿™ç§æ ¼å¼å¸¸ç”¨åœ¨ç£ç›˜æ–‡ä»¶ä¸­ã€‚</p><h4 id="ADTSï¼š">ADTSï¼š</h4><p>Audio Data Transport Streamã€‚ éŸ³é¢‘æ•°æ®ä¼ è¾“æµã€‚è¿™ç§æ ¼å¼çš„ç‰¹å¾æ˜¯å®ƒæ˜¯ä¸€ä¸ªæœ‰åŒæ­¥å­—çš„æ¯”ç‰¹æµï¼Œè§£ç å¯ä»¥åœ¨è¿™ä¸ªæµä¸­ä»»ä½•ä½ç½®å¼€å§‹ã€‚å®ƒçš„ç‰¹å¾ç±»ä¼¼äºmp3æ•°æ®æµæ ¼å¼ã€‚</p><h3 id="ç¡¬è§£ç å’Œè½¯è§£ç ">ç¡¬è§£ç å’Œè½¯è§£ç </h3><h2 id="å›¾åƒåŸºç¡€">å›¾åƒåŸºç¡€</h2><h3 id="çŸ¢é‡å›¾ã€ä½å›¾">çŸ¢é‡å›¾ã€ä½å›¾</h3><ol><li>çŸ¢é‡å›¾</li><li>ä½å›¾</li></ol><h3 id="é¢œè‰²">é¢œè‰²</h3><h4 id="RGB">RGB</h4><ol><li><p>RGB16</p><p>RGB565</p><p>RGB555 æœ€é«˜ä½ä¸ç”¨</p></li><li><p>RGB24</p><p>å†…å­˜ä¸­æ˜¯ BGR</p></li><li><p>RGB32</p><p>BGR å8ä¸ªå­—èŠ‚ä¿ç•™</p><p>ARGB32 ï¼š BGRA Aä»£è¡¨ALPHAé€æ˜åº¦</p></li></ol><h4 id="YCbCr">YCbCr</h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210427093047209.png" alt="image-20210427093047209"></p><p>æ–‡ç« æœ‰è½¬è½½</p><p><a href="https://zhuanlan.zhihu.com/p/347989727">https://zhuanlan.zhihu.com/p/347989727</a></p><h2 id="æ¦‚è¿°-v6">æ¦‚è¿°</h2><p><strong>éŸ³è§†é¢‘æ’­æ”¾å™¨æ¶æ„</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210604085343266.png" alt="image-20210604085343266"></p>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Kotlinå­¦ä¹ </title>
    <link href="/2021/04/12/Kotlin%E5%AD%A6%E4%B9%A0/"/>
    <url>/2021/04/12/Kotlin%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1>Kotlinå­¦ä¹ </h1><span id="more"></span><h2 id="åŸºç¡€-v3">åŸºç¡€</h2><p>å°½é‡ä½¿ç”¨valè¿›è¡Œç¼–å†™</p><h3 id="ç±»-v2">ç±»</h3><ul><li>æ„é€ æ–¹æ³•æ›´åŠ ç®€æ´</li><li>ä¸»æ„é€ å™¨çš„å‚æ•°ä¸èƒ½åœ¨å­æ–¹æ³•ä¸­è°ƒç”¨  initæ–¹æ³•å¯ä»¥æœ‰å¤šä¸ª é¡ºåºä»ä¸Šåˆ°ä¸‹</li></ul><p><strong>å£°æ˜</strong></p><ul><li>by lazy : å˜é‡å¿…é¡»å¼•ç”¨ä¸å¯å˜ æ— æ³•é€šè¿‡varå®ç°   çº¿ç¨‹å®‰å…¨</li><li>lateinit ï¼šç”¨äºvaréå†å»¶è¿Ÿå£°æ˜ï¼Œä¸èƒ½ç”¨äºåŸºæœ¬æ•°æ®ç±»å‹â€¦</li><li>by Delegates.notNull<T> è®©åŸºæœ¬æ•°æ®ç±»å‹varä¹Ÿå…·æœ‰å»¶è¿Ÿåˆå§‹åŒ–æ•ˆæœ</li></ul><h3 id="æ¥å£">æ¥å£</h3><ul><li>æ”¯æŒæŠ½è±¡å±æ€§ï¼Œå±æ€§ä¸èƒ½ç›´æ¥å¤åˆ¶ è¦é€šè¿‡getæ¥å¤åˆ¶</li></ul><h2 id="å¼‚åŒ">å¼‚åŒ</h2><h2 id="é—®é¢˜-v3">é—®é¢˜</h2><p>ä¸ºå•¥Int ==   === éƒ½æ˜¯trueï¼Ÿ</p><p>å¦‚æœæ¯”è¾ƒçš„æ˜¯åŸºæœ¬ç±»å‹çš„è¯ï¼Œåˆ™===çš„åˆ¤æ–­æ•ˆæœä¹Ÿæ˜¯==</p>]]></content>
    
    
    
    <tags>
      
      <tag>Kotlin</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RecylerViewæ»‘åŠ¨åµŒå¥—çš„é—®é¢˜</title>
    <link href="/2021/04/10/RecylerView%E6%BB%91%E5%8A%A8%E5%B5%8C%E5%A5%97%E7%9A%84%E9%97%AE%E9%A2%98/"/>
    <url>/2021/04/10/RecylerView%E6%BB%91%E5%8A%A8%E5%B5%8C%E5%A5%97%E7%9A%84%E9%97%AE%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1>RecycleViewæ»‘åŠ¨åµŒå¥—é—®é¢˜</h1><h2 id="é—®é¢˜å¼•å…¥">é—®é¢˜å¼•å…¥</h2><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210410162131807.png" alt="image-20210410162131807"></p><p>çˆ¶recå’Œå­recyéƒ½æ˜¯ç«–ç›´æˆ–è€…æ¨ªå‘çš„æ—¶å€™ï¼Œè¿™ä¸ªæ—¶å€™æ»‘åŠ¨ï¼Œåªæœ‰çˆ¶å¸ƒå±€ä¼šå“åº”</p><p>åŸå› ï¼šçˆ¶recæ¶ˆè€—äº†æ­¤æ¬¡ç‚¹å‡»äº‹ä»¶</p>]]></content>
    
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Androidä¸ªäººå¼€å‘æ—¶æ€»ç»“</title>
    <link href="/2021/03/06/Android%E4%B8%AA%E4%BA%BA%E5%BC%80%E5%8F%91%E9%A1%B9%E7%9B%AE%E6%8A%80%E6%9C%AF%E6%80%BB%E7%BB%93/"/>
    <url>/2021/03/06/Android%E4%B8%AA%E4%BA%BA%E5%BC%80%E5%8F%91%E9%A1%B9%E7%9B%AE%E6%8A%80%E6%9C%AF%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<h1>Androidä¸ªäººé¡¹ç›®å¼€å‘æ€»ç»“</h1><hr><h2 id="dddraft-æ‰‹è´¦">dddraft æ‰‹è´¦</h2><h3 id="å¸ƒå±€å¤„ç†">å¸ƒå±€å¤„ç†</h3><p>é—®é¢˜ ï¼š RecycleViewæ»‘åŠ¨åè¿”å›  å†…å®¹æ¶ˆå¤±   ----RecycleViewçš„å¤ç”¨æœºåˆ¶</p><p>è§£å†³ ï¼šå°è¯•å–æ¶ˆRecycleViewçš„å¤ç”¨   æœªæœ</p><span id="more"></span><p>â€‹åä½¿ç”¨Scrollview åŒ…è£¹ RelativeLayoutï¼Œèƒ½å¤Ÿè§£å†³æ»‘åŠ¨åçš„Viewæ¶ˆå¤±</p><p>â€‹ä½†æ˜¯åˆæ¶‰åŠåˆ°å†…éƒ¨12ä¸ªæœˆä»½çš„å¸ƒå±€é¡ºåºæ’åˆ—é—®é¢˜ï¼Œè¿™é‡Œæœ€åˆä½¿ç”¨çš„æ˜¯RelativeLayoutçš„é¡ºåºæ’åºï¼Œä½†æ˜¯é¡ºåºæ’åºä¼šé€ æˆä¹‹ååŠ¨æ€æ·»åŠ çš„å…ƒç´ ï¼Œä¹Ÿä¼šæŒ‰ç…§è¿™ä¸ªé¡ºåºæ’åºï¼Œå³æ·»åŠ åœ¨é¡¶éƒ¨æˆ–è€…åº•éƒ¨ã€‚</p><p>â€‹è¿™é‡Œæˆ‘ä¹‹åçš„è§£å†³æ–¹æ¡ˆå¹¶ä¸æ˜¯å¾ˆå¥½ï¼Œæˆ‘é‡‡ç”¨äº†åˆå§‹åŒ–æ—¶åŠ¨æ€ç”Ÿæˆ12ä¸ªViewï¼Œå¹¶ä¸”å›ºå®šçš„è®¾ç½®æ¯ä¸ªviewçš„topmargin</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token comment">//å¾ªç¯ä½“å†…</span>params<span class="token punctuation">.</span>topMargin <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1029</span><span class="token punctuation">;</span>scrollLinearLayout<span class="token punctuation">.</span><span class="token function">addView</span><span class="token punctuation">(</span>view<span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><h3 id="è‡ªå®šä¹‰çš„DrugImageView">è‡ªå®šä¹‰çš„DrugImageView</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token comment">//è§£å†³æ»‘åŠ¨æ—¶å¸¦æ¥çš„ ACTION_CANCEL çš„é—®é¢˜ï¼ˆäº‹ä»¶åˆ†å‘ï¼‰</span><span class="token comment">//é˜»æ­¢çˆ¶å±‚çš„Viewæˆªè·touchäº‹ä»¶</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">requestDisallowInterceptTouchEvent</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p>è§£å†³æ‹–åŠ¨é—®é¢˜</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">case</span> <span class="token class-name">MotionEvent</span><span class="token punctuation">.</span>ACTION_DOWN<span class="token operator">:</span>    isUpRepeat <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    lastX <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> event<span class="token punctuation">.</span><span class="token function">getX</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    lastY <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> event<span class="token punctuation">.</span><span class="token function">getY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    startTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    endTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// è¿˜åŸåˆå§‹ç‚¹å‡»æ—¶ ç›¸å¯¹å›¾ç‰‡çš„xy åæ ‡</span>    listener<span class="token punctuation">.</span><span class="token function">onDragDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token class-name">MotionEvent</span><span class="token punctuation">.</span>ACTION_MOVE<span class="token operator">:</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>fingerCount <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>endTime <span class="token operator">-</span> startTime <span class="token operator">></span> <span class="token class-name">ClickTimeDuration</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            offsetX <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token function">getX</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> lastX<span class="token punctuation">)</span><span class="token punctuation">;</span>            offsetY <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token function">getY</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> lastY<span class="token punctuation">)</span><span class="token punctuation">;</span>            rootView<span class="token punctuation">.</span><span class="token function">layout</span><span class="token punctuation">(</span><span class="token function">getLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> offsetX<span class="token punctuation">,</span> <span class="token function">getTop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> offsetY<span class="token punctuation">,</span> <span class="token function">getRight</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> offsetX<span class="token punctuation">,</span> <span class="token function">getBottom</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> offsetY<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p>layout ä¼šä½¿å…¶getLeft ç­‰éƒ½å‘ç”Ÿæ”¹å˜</p><p>æ ¸å¿ƒæ€æƒ³ï¼š</p><p>é€šè¿‡lastXè®°å½•ç‚¹å‡»æ—¶æ‰‹æŒ‡ç›¸å¯¹äºå›¾ç‰‡å†…éƒ¨çš„ä½ç½®ï¼Œç„¶åé€šè¿‡offsetXè¿›è¡Œæ»‘åŠ¨æ—¶ç›¸å¯¹èµ·ç‚¹çš„åˆ¤æ–­ï¼Œåˆ¤æ–­æ°¸è¿œéƒ½æ˜¯åœ¨å†…éƒ¨çš„ï¼Œä½†æ˜¯layoutæ˜¯åœ¨å¤–éƒ¨è¿›è¡Œçš„</p><h3 id="ScaleGestureDetectoré—®é¢˜">ScaleGestureDetectoré—®é¢˜</h3><p>æŒ‰ç…§æ¯”ä¾‹è¿›è¡Œç¼©æ”¾ï¼Œä½†æ˜¯æœ€åˆæ£€æµ‹ä¸åˆ°ç¼©å°çš„æ‰‹åŠ¿</p><p>åªæœ‰å…ˆæ”¾å¤§åæ‰èƒ½å¤Ÿæ£€æµ‹åˆ°ç¼©å°çš„æŒ‡ä»¤ï¼Œè¿™é‡Œä¸æ¸…æ¥š</p><h3 id="WriteableEditText">WriteableEditText</h3><p>å¯åŠ¨æ€è®¾ç½®çš„å­—ä½“  --å¤§å°  --å’Œé¢œè‰²çš„TextView ï¼Œå¹¶ä¸”ç¡®ä¿åŒä¸€ä¸ªTextä¸­å¯ä»¥æœ‰å¤šä¸ªä¸åŒæ ¼å¼çš„Textï¼Œå¹¶ä¸”å¯æ‹–åŠ¨</p><ul><li>å•å‡»å’Œé•¿æŒ‰çš„åˆ¤æ–­ ã€‚å®ç°å•å‡»æ˜¾ç¤º/éšè—buttonï¼Œé•¿æŒ‰å®ç°æ‹–åŠ¨</li></ul><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">case</span> <span class="token class-name">MotionEvent</span><span class="token punctuation">.</span>ACTION_DOWN<span class="token operator">:</span>    firstClickTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>firstClickTime <span class="token operator">-</span> secondClickTime <span class="token operator">></span> timeDuration<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token string">">200"</span><span class="token punctuation">,</span> <span class="token class-name">Toast</span><span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token class-name">MotionEvent</span><span class="token punctuation">.</span>ACTION_MOVE<span class="token operator">:</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>isFirstClicked<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        initX <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> event<span class="token punctuation">.</span><span class="token function">getRawX</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        initY <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> event<span class="token punctuation">.</span><span class="token function">getRawY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        isFirstClicked <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    listener<span class="token punctuation">.</span><span class="token function">onMove</span><span class="token punctuation">(</span>rootView<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> event<span class="token punctuation">.</span><span class="token function">getRawX</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> event<span class="token punctuation">.</span><span class="token function">getRawY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> initX<span class="token punctuation">,</span> initY<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token class-name">MotionEvent</span><span class="token punctuation">.</span>ACTION_UP<span class="token operator">:</span>    <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"Writebale"</span><span class="token punctuation">,</span> <span class="token string">"down"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    secondClickTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>secondClickTime <span class="token operator">-</span> firstClickTime <span class="token operator">&lt;</span> timeDuration<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>dragButton<span class="token punctuation">.</span><span class="token function">getAlpha</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            dragButton<span class="token punctuation">.</span><span class="token function">setAlpha</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            borderView<span class="token punctuation">.</span><span class="token function">setAlpha</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            dragButton<span class="token punctuation">.</span><span class="token function">setAlpha</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            borderView<span class="token punctuation">.</span><span class="token function">setAlpha</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">break</span><span class="token punctuation">;</span></code></pre></div><ul><li><p>å¦ä¸€ç§åŠ¨æ€è®¾ç½®ä½ç½®çš„æ–¹å¼</p><p>å›è°ƒä¸­</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onMove</span><span class="token punctuation">(</span><span class="token class-name">View</span> v<span class="token punctuation">,</span> <span class="token keyword">int</span> rawx<span class="token punctuation">,</span> <span class="token keyword">int</span> rawy<span class="token punctuation">,</span> <span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">//xï¼š first rawx</span>    <span class="token class-name">Rect</span> scrollBounds <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Rect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    scrollView<span class="token punctuation">.</span><span class="token function">getDrawingRect</span><span class="token punctuation">(</span>scrollBounds<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//è·å–æ•´ä¸ªscrollViewçš„å¤§å°</span>    v<span class="token punctuation">.</span><span class="token function">setX</span><span class="token punctuation">(</span>rawx <span class="token operator">-</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>    v<span class="token punctuation">.</span><span class="token function">setY</span><span class="token punctuation">(</span>rawy <span class="token operator">-</span> y <span class="token operator">+</span> scrollBounds<span class="token punctuation">.</span>top<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div></li><li><p>æ–‡å­—æ–¹é¢ï¼Œå¤šä¸ªEditTextæ”¾åœ¨ä¸€èµ·å æ»‘åŠ¨æ¶ˆå¤±å†è¿”å›åå‘ç°è¾“å…¥çš„å­—ä½“æ¶ˆå¤±ï¼Œè¿™é‡Œè¦é€šè¿‡TextWatcherå®ç°ä¿å­˜</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java">editText<span class="token punctuation">.</span><span class="token function">getEditText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTextChangedListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TextWatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">beforeTextChanged</span><span class="token punctuation">(</span><span class="token class-name">CharSequence</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span> start<span class="token punctuation">,</span> <span class="token keyword">int</span> count<span class="token punctuation">,</span> <span class="token keyword">int</span> after<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@RequiresApi</span><span class="token punctuation">(</span>api <span class="token operator">=</span> <span class="token class-name">Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>P</span><span class="token punctuation">)</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onTextChanged</span><span class="token punctuation">(</span><span class="token class-name">CharSequence</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span> start<span class="token punctuation">,</span> <span class="token keyword">int</span> before<span class="token punctuation">,</span> <span class="token keyword">int</span> count<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">TextStyleHelper</span><span class="token punctuation">.</span><span class="token function">setEditText</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> currentTextStyle<span class="token punctuation">,</span> editText<span class="token punctuation">,</span> start<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterTextChanged</span><span class="token punctuation">(</span><span class="token class-name">Editable</span> s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token comment">//è®¾ç½®æŒ‡é’ˆä½ç½® editText.getEditText().setSelection(s.length());</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div></li></ul><h3 id="ScannableString">ScannableString</h3><p>å®ç°TextViewçš„å¤šæ ¼å¼å­—ä½“æ˜¾ç¤º</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java">editText<span class="token punctuation">.</span><span class="token function">getEditText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeTextChangedListener</span><span class="token punctuation">(</span>watcher<span class="token punctuation">)</span><span class="token punctuation">;</span>editText<span class="token punctuation">.</span><span class="token function">getEditText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>ss<span class="token punctuation">)</span><span class="token punctuation">;</span>editText<span class="token punctuation">.</span><span class="token function">getEditText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTextChangedListener</span><span class="token punctuation">(</span>watcher<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p>æ ¸å¿ƒï¼š å…ˆåœ¨å†…éƒ¨é™¤å»watcher æ·»åŠ æ–‡å­—åå†æ¢å¤watcher</p><p>åŸå› ï¼š æ­»å¾ªç¯</p><p>å½“ä¸€ä¸ªTextViewä¸­å«æœ‰TextWatcheræ—¶ åœ¨è°ƒç”¨setTextæ—¶ï¼Œä¼šå…ˆå»æœç´¢æ˜¯å¦æœ‰TextWatcher  åˆæˆ‘è¿™é‡Œçš„setTextæ–¹æ³•æ˜¯åœ¨TextWatcherä¸­è°ƒç”¨çš„ï¼Œæ‰€ä»¥å°±å½¢æˆäº†ä¸€ä¸ªæ­»å¾ªç¯</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">void</span> <span class="token function">sendOnTextChanged</span><span class="token punctuation">(</span><span class="token class-name">CharSequence</span> text<span class="token punctuation">,</span> <span class="token keyword">int</span> start<span class="token punctuation">,</span> <span class="token keyword">int</span> before<span class="token punctuation">,</span> <span class="token keyword">int</span> after<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>mListeners <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">//å»éå†æ‰€æœ‰çš„TextWatcher</span>        <span class="token keyword">final</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TextWatcher</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> mListeners<span class="token punctuation">;</span>        <span class="token keyword">final</span> <span class="token keyword">int</span> count <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">//è°ƒç”¨onTextChangedçš„æ–¹æ³•</span>            list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onTextChanged</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> start<span class="token punctuation">,</span> before<span class="token punctuation">,</span> after<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>mEditor <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> mEditor<span class="token punctuation">.</span><span class="token function">sendOnTextChanged</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> before<span class="token punctuation">,</span> after<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><h2 id="Sudoko-æ•°ç‹¬æ¸¸æˆ">Sudoko æ•°ç‹¬æ¸¸æˆ</h2>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ ¼å¼</title>
    <link href="/2021/02/23/%E6%A0%BC%E5%BC%8F/"/>
    <url>/2021/02/23/%E6%A0%BC%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><p><span style='color:red;font-size:24px'>nihao</span></p><p><span style='color:red;font-size:24px'>é—®é¢˜</span></p><p><span style='color:orange;font-size:24px'>é‡ç‚¹</span></p><p><span style='color: #DA70D6;font-size:24px'>æœªè§£å†³é—®é¢˜</span></p><p><span style='color: #DAA520;font-size:24px'>æµç¨‹</span></p><p><span style='color:#8A2BE2;font-size:24px'>çœ‹æƒ…å†µ</span></p><p><span style='color: #00BFFF;font-size:24px'>ä¸ªäººç†è§£</span></p><p><span style='color:#3CB371;font-size:24px'>é†’æ‚Ÿ</span></p><p><span style='color:#FA8072;font-size:24px'>æ ‡é¢˜</span></p><p><span style='color:#FA8072;font-size:24px'>æ˜¯</span></p><p><span style='color:#FA8072;font-size:24px'>æ˜¯</span></p><center>asdas</center>]]></content>
    
    
    <categories>
      
      <category>æ¨¡å—</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Markdown</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®¡ç½‘</title>
    <link href="/2021/01/22/%E8%AE%A1%E7%BD%91/"/>
    <url>/2021/01/22/%E8%AE%A1%E7%BD%91/</url>
    
    <content type="html"><![CDATA[<h1>è®¡ç½‘</h1><!-- toc --><p>[toc]</p><h2 id="äº”å±‚åè®®">äº”å±‚åè®®</h2><h3 id="ç‰©ç†å±‚">ç‰©ç†å±‚</h3><p>è§£å†³åœ¨å„ç§ä¼ è¾“åª’ä½“ä¸Šä¼ è¾“æ¯”ç‰¹0 å’Œ 1 çš„é—®é¢˜ï¼Œç»™æ•°æ®é“¾è·¯å±‚æä¾›é€æ˜ä¼ è¾“æ¯”ç‰¹æµçš„æœåŠ¡</p><p>é€æ˜ï¼š æ•°æ®é“¾è·¯å±‚ä¸éœ€è¦çŸ¥é“ç‰©ç†å±‚ä½¿ç”¨ä»€ä¹ˆæ–¹æ³•ä¼ è¾“çš„</p><span id="more"></span><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210331214511474.png" alt="image-20210331214511474"></p><h3 id="æ•°æ®é“¾è·¯å±‚">æ•°æ®é“¾è·¯å±‚</h3><p>ä¸‰ä¸ªé‡è¦é—®é¢˜ï¼š å°è£…æˆå¸§ã€å·®é”™æ£€æµ‹ã€å¯é ä¼ è¾“</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210331214815983.png" alt="image-20210331214815983"></p><p>é“¾è·¯ï¼šä¸€ä¸ªèŠ‚ç‚¹åˆ°ç›¸é‚»èŠ‚ç‚¹çš„ä¸€æ®µç‰©ç†çº¿è·¯ï¼Œä¸­é—´æ²¡æœ‰ä»»ä½•å…¶ä»–çš„äº¤æ¢èŠ‚ç‚¹</p><p>æ•°æ®é“¾è·¯ï¼šå®ç°é€šä¿¡åè®®çš„ç¡¬ä»¶å’Œè½¯ä»¶åŠ åˆ°è¿è·¯ä¸Šï¼Œä»¥å¸§å•ä½å°è£…å¤„ç†</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210331215104288.png" alt="image-20210331215104288"></p><p>å¸§ä¼ è¾“è¿‡ç¨‹ä¸­å‡ºç°è¯¯ç ï¼ˆ1å˜æˆ0ï¼‰</p><p>å‘é€æ–¹å‘é€æ•°æ®å‰å°†å‘é€çš„æ•°æ®å’Œç®—æ³•è®¡ç®—å‡º<strong>æ£€é”™ç </strong>ï¼Œæ”¾åœ¨å¸§å°¾</p><p>æ¥å—æ–¹å†è¿›è¡ŒéªŒè¯ï¼Œå¦‚æœé”™è¯¯ï¼Œåˆ™ä¸ä¼šæ¥å—è¯¥å¸§ï¼Œå°±ä¸¢å¼ƒäº†</p><h4 id="å°è£…æˆå¸§">å°è£…æˆå¸§</h4><p>ç»™ä¸Šå±‚äº¤ä»˜çš„åè®®æ•°æ®å•å…ƒæ·»åŠ å¸§å¤´å’Œå¸§å°¾ä½¿ä¹‹æˆä¸ºå¸§</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210331215956065.png" alt="image-20210331215956065"></p><p>å¸§å¤´å¸§å°¾ï¼šè¿›è¡Œå¸§å®šç•Œ  â€”</p><ol><li>å¸§å®šç•Œæ ‡å¿—ï¼ˆä¸ä¸€å®šæœ‰ï¼‰</li><li>ç‰©ç†å±‚æ·»åŠ å‰å¯¼ç ï¼Œå¸§é—´éš”æ—¶é—´ 96bit</li></ol><p>é€æ˜ä¼ è¾“ï¼šæ•°æ®é“¾è·¯å±‚å¯¹ä¸Šå±‚äº¤ä»˜çš„ä¼ è¾“æ•°æ®æ²¡æœ‰ä»»ä½•é™åˆ¶ï¼Œå°±å¥½åƒæ•°æ®é“¾è·¯å±‚ä¸å­˜åœ¨ä¸€æ ·</p><ul><li>é¢å‘å­—èŠ‚çš„ç‰©ç†é“¾è·¯ä½¿ç”¨å­—èŠ‚å¡«å……çš„æ–¹æ³•å®ç°é€æ˜ä¼ è¾“ â€“ ESC 27</li><li>é¢å‘æ¯”ç‰¹çš„ç‰©ç†é“¾è·¯ä½¿ç”¨æ¯”ç‰¹å¡«å……çš„æ–¹æ³•å®ç°é€æ˜ä¼ è¾“</li></ul><p>å¦‚ä½•è§£å†³ä¸åŒæ–¹å¼çš„è¯¯åˆ¤ï¼ˆä¸ç•Œå®šç¬¦ç›¸åŒï¼‰</p><h4 id="å·®é”™æ£€æµ‹">å·®é”™æ£€æµ‹</h4><p><strong>æ¯”ç‰¹å·®é”™</strong>ï¼šæ¯”ç‰¹ä¼ è¾“æ—¶1 0 å¯èƒ½ä¼šæ”¹å˜</p><p>è¯¯ç ç‡ï¼šé”™è¯¯çš„æ¯”ç‰¹å æ¯”</p><p>åˆ¤æ–­ï¼šå·®é”™æ£€æµ‹ç </p><ol><li><p>å¥‡å¶æ ¡éªŒï¼š åœ¨æ•°æ®åæ·»åŠ 1 æ˜¯çš„æ•´ä¸ªæ•°æ® çš„1 çš„ä¸ªæ•°ä¸ºå¥‡æ•°(å¥‡æ ¡éªŒ)æˆ–è€…å¶æ•°(å¶æ ¡éªŒ)</p><p>ç¼ºç‚¹ï¼Œåªèƒ½æ£€æµ‹å¥‡æ•°ä½çš„é”™è¯¯</p></li><li><p>å¾ªç¯å†—ä½™æ ¡éªŒï¼šåŒæ–¹çº¦å®šå¥½ä¸€ä¸ªç”Ÿæˆå¤šé¡¹å¼ï¼ˆå¤šé¡¹å¼çš„å„é¡¹ç³»æ•°ç”Ÿæˆæ¯”ç‰¹ä¸²ï¼‰ï¼Œå‘é€æ–¹åŸºäºå¾…å‘é€çš„æ•°æ®å’Œç”Ÿæˆå¤šé¡¹å¼è®¡ç®—å‡ºå·®é”™æ£€æµ‹ç ï¼Œä¹Ÿå°±æ˜¯å†—ä½™ç ï¼Œæ·»åŠ åˆ°å¸¦ä¼ è¾“çš„åé¢ä¸€èµ·ä¼ è¾“ï¼ˆç±»ä¼¼Digestçš„æ•°å­—ç­¾åï¼‰ï¼Œæ¥æ”¶æ–¹é€šè¿‡æ­¤æ–¹æ³•åˆ¤æ–­</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210331221431870.png" alt="image-20210331221431870"></p></li></ol><h4 id="å¯é ä¼ è¾“">å¯é ä¼ è¾“</h4><p>å‘ä¸Šå±‚çš„æœåŠ¡ç±»å‹ï¼š</p><p>ä¸å¯é ä¼ è¾“æœåŠ¡ï¼šä¸¢å¼ƒæœ‰è¯¯ç çš„å¸§ï¼Œç„¶åä»€ä¹ˆéƒ½ä¸åš</p><p>å¯é ä¼ è¾“æœåŠ¡ï¼šå‘é€ç«¯å‘ä»€ä¹ˆå°±æ¥å—ä»€</p><p>ä¸€èˆ¬äº¤ç”±ä¸Šå±‚å¤„ç†</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210401102629080.png" alt="image-20210401102629080"></p><p><strong>ç‚¹å¯¹ç‚¹åè®®</strong></p><p>PPP Point to Point Protocol</p><p>ä¸ºåœ¨ç‚¹å¯¹ç‚¹é“¾è·¯ä¼ è¾“å„ç§åè®®æ•°æ®æŠ¥æä¾›äº†æ ‡å‡†æ–¹æ³•</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210401104045712.png" alt="image-20210401104045712"></p><p>ä»ISP äº’è”ç½‘æœåŠ¡æä¾›å•†  ä¸­å›½ç§»åŠ¨â€¦ è·å¾—æä¾›çš„åˆæ³•ipåœ°å€</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210401103306939.png" alt="image-20210401103306939"></p><p>å­˜åœ¨è¯¯åˆ¤ ï¼Œè§£å†³æ–¹æ³•</p><ol><li><p>å¸§å®šç•Œ</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210401103442613.png" alt="image-20210401103442613"></p></li><li><p>å‰å¯¼ç </p></li></ol><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210401103535405.png" alt="image-20210401103535405"></p><h4 id="åœ°å€">åœ°å€</h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210401104430428.png" alt="image-20210401104430428"></p><h5 id="Macåœ°å€">Macåœ°å€</h5><p>ç‚¹å¯¹ç‚¹ä¿¡é“çš„æ•°æ®é“¾è·¯å±‚ä¸éœ€è¦åœ°å€</p><p>ä½¿ç”¨å¹¿æ’­ä¿¡é“çš„æ•°æ®é“¾è·¯å±‚éœ€è¦ä½¿ç”¨åœ°å€æ¥åŒºåˆ†</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210401104748601.png" alt="image-20210401104748601"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210401104856860.png" alt="image-20210401104856860"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210401105646563.png" alt=""></p><p>å•æ’­  å‘é€Macåœ°å€ä¸åŒ¹é…ï¼Œä¸¢å¼ƒ</p><p>å¹¿æ’­å¸§ ç›®çš„å­—æ®µ FFFFFFFFFFFF  æ¥å—</p><p>å¤šæ’­  å¤šæ’­åœ°å€  å¤šæ’­ç»„åˆ—è¡¨</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210401105523344.png" alt="image-20210401105523344"></p><h5 id="IPåœ°å€">IPåœ°å€</h5><p>ç½‘é™…å±‚</p><p>å› ç‰¹ç½‘ä¸Šä¸»æœºå’Œè·¯ç”±å™¨ä½¿ç”¨çš„åœ°å€</p><p>ç½‘ç»œç¼–å· å’Œ ä¸»æœºç¼–å·</p><p>åŒä¸€ç½‘ç»œçš„ç½‘ç»œç¼–å·æ˜¯ç›¸åŒçš„</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210401110022989.png" alt="image-20210401110022989"></p><p>ç½‘ç»œä¼ æ’­éœ€è¦IPåœ°å€å’ŒMacåœ°å€</p><p>ç½‘ç»œä¼ è¾“ä¸­ä¸»æœºæœ‰è¿è¾“å±‚å’Œåº”ç”¨å±‚â€¦ è€Œè·¯ç”±å™¨çš„æœ€é«˜å±‚å°±æ˜¯ç½‘ç»œå±‚</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210401222930927.png" alt="image-20210401222930927"></p><p>å°è£…æ—¶çš„åœ°å€</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210401223316294.png" alt="image-20210401223316294"></p><h5 id="ARP">ARP</h5><p>IPåœ°å€è½¬MACåœ°å€</p><p>åœ°å€è§£æåè®®</p><p>æ¯ä¸ªä¸»æœºéƒ½æœ‰ ARPé«˜é€Ÿç¼“å­˜è¡¨ ---- ç”µè¯ç°¿</p><p>ARPè¯·æ±‚æŠ¥æ–‡å‘é€åœ¨MACå¸§ä¸­ åªèƒ½åœ¨ä¸€ä¸ªç½‘ç»œ  ä¸€ä¸ªé“¾è·¯ä¸­ä½¿ç”¨</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210401223810852.png" alt="image-20210401223810852"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210401224012968.png" alt="image-20210401224012968"></p><h3 id="ç½‘ç»œå±‚">ç½‘ç»œå±‚</h3><p>ä¸»è¦ä»»åŠ¡ï¼šå®ç°ç½‘ç»œäº’è¿ï¼Œå®ç°æ•°æ®åŒ…åœ¨ç½‘ç»œé—´çš„ä¼ è¾“</p><p>è§£å†³é—®é¢˜ï¼šç½‘ç»œå±‚å¯»å€é—®é¢˜  æä¾›æ€æ ·çš„æœåŠ¡   è·¯ç”±é€‰æ‹©é—®é¢˜ï¼ˆä¸åŒè·¯å¾„é€‰æ‹©ï¼‰</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210401224627313.png" alt="image-20210401224627313"></p><p>**ç½‘ç»œå±‚æä¾›çš„ä¸¤ç§æœåŠ¡**</p><p>é¢å‘è¿æ¥çš„è™šç”µè·¯æœåŠ¡ï¼š</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210401224838914.png" alt="image-20210401224838914"></p><ul><li><p>æ— è¿æ¥çš„æ•°æ®æŠ¥æœåŠ¡</p><p>TCP/IPä½“ç³»ç»“æ„çš„å› ç‰¹ç½‘ç½‘é™…å±‚é‡‡ç”¨</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210401225008037.png" alt="image-20210401225008037"></p></li></ul><h4 id="IPV4">IPV4</h4><p>å› ç‰¹ç½‘æ¯ä¸€å°ä¸»æœº/è·¯ç”±å™¨ çš„æ¯ä¸€ä¸ªæ¥å£åˆ†é…åœ¨å…¨ä¸–ç•Œå”¯ä¸€çš„32æ¯”ç‰¹æ ‡è¯†ç¬¦</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210401225354928.png" alt="image-20210401225354928"></p><h5 id="åˆ†ç±»ç¼–åˆ¶">åˆ†ç±»ç¼–åˆ¶</h5><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210401225751543.png" alt="image-20210401225751543"></p><p>Aç±»åœ°å€</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210401230004953.png" alt="image-20210401230004953"></p><p>Bç±»åœ°å€</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210401230208878.png" alt="image-20210401230208878"></p><p>Cç±»åœ°å€</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210401230335803.png" alt="image-20210401230335803"></p><p>ç‰¹æ®Šæƒ…å†µ</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210401230644359.png" alt="image-20210401230644359"></p><h5 id="åˆ’åˆ†å­ç½‘">åˆ’åˆ†å­ç½‘</h5><p>éœ€è¦åˆ’åˆ†å­ç½‘ï¼Œåˆ©ç”¨åŸæœ‰ç½‘ç»œä¸­å¤§é‡å‰©ä½™çš„IPåœ°å€ï¼Œåˆ†é…ç¬¬ä¸‰éƒ¨åˆ†â€¦</p><p>å› æ­¤æœ‰äº†ï¼š<strong>å­ç½‘æ©ç </strong></p><p>32æ¯”ç‰¹çš„å­ç½‘æ©ç å¯ä»¥è¡¨æ˜åˆ†ç±»IPåœ°å€çš„ä¸»æœºå·éƒ¨åˆ†è¢«å€Ÿç”¨äº†å‡ ä¸ªæ¯”ç‰¹ä½œä¸ºå­ç½‘å·</p><p>æ³¨æ„ä¸åŒçš„ç½‘ç»œç±»åˆ«æœ‰ä¸åŒä½æ•°çš„ç½‘ç»œå·å’Œä¸»æœºå·</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210402084027580.png" alt="image-20210402084027580"></p><p>ä¸¾ä¸ªä¾‹å­</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210402084230681.png" alt="image-20210402084230681"></p><p>å¦‚ä½•è¢«åˆ’åˆ†æˆä¸¤ä¸ªå­ç½‘çš„</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210402084626964.png" alt="image-20210402084626964"></p><p>é»˜è®¤å­ç½‘æ©ç </p><p>Aç±» 8ä½ç½‘ç»œå· ï¼š 255.0.0.0</p><p>Bç±» 16ä½ç½‘ç»œå· 255.255.0.0</p><p>Cç±» 24ä½ç½‘ç»œå· 255.255.255.0</p><p>æ³¨æ„ï¼Œä¸»æœºå·ä¸º0ä»£è¡¨æœ‰ä¸€ä¸ª ä¸º1000000 ä»£è¡¨æœ‰ä¸¤ä¸ª ï¼ˆæ³¨æ„æ–¹å‘å’Œé¡ºåºï¼‰</p><h5 id="æ— åˆ†ç±»ç¼–å€">æ— åˆ†ç±»ç¼–å€</h5><p>æ•°é‡å·¨å¤§çš„Cé›·ç‹å› ä¸ºåœ°å€ç©ºé—´å¤ªå°å¹¶æ²¡æœ‰å……åˆ†ä½¿ç”¨ï¼Œè€ŒIPåœ°å€ä»åœ¨åŠ é€Ÿæ¶ˆè€—ï¼ŒIPV4åœ°å€ç©ºé—´ç´§å¼ </p><p><strong>CIDR Classless Inter Domain Routing</strong></p><p>æ¶ˆé™¤äº†ä¼ ç»Ÿçš„A\B\Cç±»åœ°å€å’Œåˆ’åˆ†å­ç½‘çš„æ¦‚å¿µï¼Œæ›´æœ‰æ•ˆçš„åˆ†é…Ipv4åœ°å€ç©ºé—´ï¼Œå¹¶ä¸”å¯ä»¥åœ¨æ–°çš„Ipv6ä½¿ç”¨ä¹‹å‰å…è®¸å› ç‰¹ç½‘çš„è§„æ¨¡ç»§ç»­å¢é•¿</p><p>æ–œçº¿è®°æ³•</p><p>128.14.35.7 / 20  ä»£è¡¨ç½‘ç»œå‰ç¼€å ç”¨çš„æ¯”ç‰¹æ•°é‡ä¸º20 ä¸»æœºç¼–å·å°±ä¸º12</p><p>è·¯ç”±èšåˆ   ï¼ˆæ„é€ è¶…ç½‘ï¼‰</p><p>æ–¹æ³•ï¼š æ‰¾å…±åŒå‰ç¼€</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210402090132427.png" alt="image-20210402090132427"></p><p><strong>IPV4çš„åœ°å€åº”ç”¨è§„åˆ’</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210402091203126.png" alt="image-20210402091203126"></p><p>å®šé•¿ï¼š å…ˆç¡®å®šä¸»æœºæ•°</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210402091834330.png" alt="image-20210402091834330"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210402092118490.png" alt="image-20210402092118490"></p><p>å˜é•¿çš„å­ç½‘æ©ç ç›¸å½“äºä¸²è¡ŒåŠ¨æ€åˆ†é…</p><h2 id="Http">Http</h2><p>HyperTextTransferProtocol  è¶…æ–‡æœ¬ä¼ è¾“åè®®  ç”¨äºä»WWWæœåŠ¡å™¨ä¼ è¾“è¶…æ–‡æœ¬åˆ°æœ¬åœ°æµè§ˆå™¨çš„ä¼ è¾“åè®®</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210310221622240.png" alt="image-20210310221622240"></p><p>æ‰€æœ‰æ¶ˆæ¯ç”¨æ˜æ–‡å‘é€  é€šè¿‡å…¬å…±çš„äº’è”ç½‘</p><h2 id="Https">Https</h2><p>ä¸¤å¤§æ³•å®</p><p>SSL  Secure Sockets Layer å®‰å…¨å¥—æ¥å±‚ ä½¿ç”¨å…¬åŒ™åŠ å¯†  SSLè¯ä¹¦</p><p>TLS  Transport Layer Security ä¼ è¾“å±‚å®‰å…¨   æœ€æ–°è¡Œä¸šæ ‡å‡†åŠ å¯†åè®®  ç»§æ‰¿SSL</p><p>éæ˜æ–‡</p><h3 id="Http2-0-ä¸-Http-1-xçš„åŒºåˆ«">Http2.0 ä¸ Http 1.xçš„åŒºåˆ«</h3><h4 id="1-å¤šè·¯å¤ç”¨">1. å¤šè·¯å¤ç”¨</h4><p>â€‹å¤šè·¯å¤ç”¨æŠ€æœ¯ï¼šå•è¿æ¥å¤šèµ„æºçš„æ–¹å¼ï¼Œå‡å°‘æœåŠ¡ç«¯çš„é“¾æ¥å‹åŠ›,å†…å­˜å ç”¨æ›´å°‘,è¿æ¥ååé‡æ›´å¤§ï¼›ç”±äºå‡å°‘TCP æ…¢å¯åŠ¨æ—¶é—´ï¼Œæé«˜ä¼ è¾“çš„é€Ÿåº¦</p><p>â€‹å…è®¸å•ä¸€HTTP 2 è¿æ¥åŒæ—¶å‘èµ·å¤šé‡çš„è¯·æ±‚ - å“åº”æ¶ˆæ¯</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210310221742708.png" alt="image-20210310221742708"></p><p>äºŒè¿›åˆ¶åˆ†å¸§</p><p>åœ¨äºŒè¿›åˆ¶åˆ†å¸§å±‚ä¸­ï¼Œ HTTP/2 ä¼šå°†æ‰€æœ‰ä¼ è¾“çš„ä¿¡æ¯åˆ†å‰²ä¸ºå¸§ï¼ˆframeï¼‰,å¹¶å¯¹å®ƒä»¬é‡‡ç”¨äºŒè¿›åˆ¶æ ¼å¼çš„ç¼–ç  ï¼Œå…¶ä¸­ é¦–éƒ¨ä¿¡æ¯ä¼šè¢«å°è£…åˆ° HEADER frameï¼Œè€Œç›¸åº”çš„ Request Body åˆ™å°è£…åˆ° DATA frame é‡Œé¢ã€‚</p><p>HTTP æ€§èƒ½ä¼˜åŒ–çš„<strong>å…³é”®å¹¶ä¸åœ¨äºé«˜å¸¦å®½ï¼Œè€Œæ˜¯ä½å»¶è¿Ÿ</strong>ã€‚TCP è¿æ¥ä¼šéšç€æ—¶é—´è¿›è¡Œè‡ªæˆ‘ã€Œè°ƒè°ã€ï¼Œèµ·åˆä¼šé™åˆ¶è¿æ¥çš„æœ€å¤§é€Ÿåº¦ï¼Œå¦‚æœæ•°æ®æˆåŠŸä¼ è¾“ï¼Œä¼šéšç€æ—¶é—´çš„æ¨ç§»æé«˜ä¼ è¾“çš„é€Ÿåº¦ã€‚è¿™ç§è°ƒè°åˆ™è¢«ç§°ä¸º TCP æ…¢å¯åŠ¨ã€‚ç”±äºè¿™ç§åŸå› ï¼Œè®©åŸæœ¬å°±å…·æœ‰çªå‘æ€§å’ŒçŸ­æ—¶æ€§çš„ HTTP è¿æ¥å˜çš„ååˆ†ä½æ•ˆã€‚</p><h4 id="2-é¦–éƒ¨å‹ç¼©">2. é¦–éƒ¨å‹ç¼©</h4><p>â€‹ HTTP/1 ä¸­ï¼ŒHTTP è¯·æ±‚å’Œå“åº”éƒ½æ˜¯ç”±ã€ŒçŠ¶æ€è¡Œã€è¯·æ±‚ / å“åº”å¤´éƒ¨ã€æ¶ˆæ¯ä¸»ä½“ã€ä¸‰éƒ¨åˆ†ç»„æˆã€‚ä¸€èˆ¬è€Œè¨€ï¼Œæ¶ˆæ¯ä¸»ä½“éƒ½ä¼šç»è¿‡ gzip å‹ç¼©ï¼Œæˆ–è€…æœ¬èº«ä¼ è¾“çš„å°±æ˜¯å‹ç¼©è¿‡åçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆä¾‹å¦‚å›¾ç‰‡ã€éŸ³é¢‘ï¼‰ï¼Œä½†çŠ¶æ€è¡Œå’Œå¤´éƒ¨å´æ²¡æœ‰ç»è¿‡ä»»ä½•å‹ç¼©ï¼Œç›´æ¥ä»¥çº¯æ–‡æœ¬ä¼ è¾“ã€‚</p><p>éšç€ Web åŠŸèƒ½è¶Šæ¥è¶Šå¤æ‚ï¼Œæ¯ä¸ªé¡µé¢äº§ç”Ÿçš„è¯·æ±‚æ•°ä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œå¯¼è‡´æ¶ˆè€—åœ¨å¤´éƒ¨çš„æµé‡è¶Šæ¥è¶Šå¤šï¼Œå°¤å…¶æ˜¯æ¯æ¬¡éƒ½è¦ä¼ è¾“ UserAgentã€Cookie è¿™ç±»ä¸ä¼šé¢‘ç¹å˜åŠ¨çš„å†…å®¹ï¼Œå®Œå…¨æ˜¯ä¸€ç§æµªè´¹ã€‚</p><p>æˆ‘ä»¬å†ç”¨é€šä¿—çš„è¯­è¨€è§£é‡Šä¸‹ï¼Œå‹ç¼©çš„åŸç†ã€‚å¤´éƒ¨å‹ç¼©éœ€è¦åœ¨æ”¯æŒ HTTP/2 çš„æµè§ˆå™¨å’ŒæœåŠ¡ç«¯ä¹‹é—´ï¼š</p><ul><li>ç»´æŠ¤ä¸€ä»½ç›¸åŒçš„é™æ€å­—å…¸ï¼ˆStatic Tableï¼‰ï¼ŒåŒ…å«å¸¸è§çš„å¤´éƒ¨åç§°ï¼Œä»¥åŠç‰¹åˆ«å¸¸è§çš„å¤´éƒ¨åç§°ä¸å€¼çš„ç»„åˆï¼›</li><li>ç»´æŠ¤ä¸€ä»½ç›¸åŒçš„åŠ¨æ€å­—å…¸ï¼ˆDynamic Tableï¼‰ï¼Œå¯ä»¥åŠ¨æ€çš„æ·»åŠ å†…å®¹ï¼›</li><li>æ”¯æŒåŸºäºé™æ€å“ˆå¤«æ›¼ç è¡¨çš„å“ˆå¤«æ›¼ç¼–ç ï¼ˆHuffman Codingï¼‰ï¼›</li></ul><p>é™æ€å­—å…¸çš„ä½œç”¨æœ‰ä¸¤ä¸ªï¼š</p><p>1ï¼‰å¯¹äºå®Œå…¨åŒ¹é…çš„å¤´éƒ¨é”®å€¼å¯¹ï¼Œä¾‹å¦‚ â€œ:method :GETâ€ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ä¸€ä¸ªå­—ç¬¦è¡¨ç¤ºï¼›</p><p>2ï¼‰å¯¹äºå¤´éƒ¨åç§°å¯ä»¥åŒ¹é…çš„é”®å€¼å¯¹ï¼Œä¾‹å¦‚ â€œcookie :xxxxxxxâ€ï¼Œå¯ä»¥å°†åç§°ä½¿ç”¨ä¸€ä¸ªå­—ç¬¦è¡¨ç¤ºã€‚</p><p>HTTP/2 ä¸­çš„é™æ€å­—å…¸å¦‚ä¸‹ï¼ˆä»¥ä¸‹åªæˆªå–äº†éƒ¨åˆ†ï¼Œå®Œæ•´è¡¨æ ¼åœ¨è¿™é‡Œï¼‰ï¼š</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210310224715407.png" alt="image-20210310224715407"></p><p>æµè§ˆå™¨å’ŒæœåŠ¡ç«¯éƒ½å¯ä»¥å‘åŠ¨æ€å­—å…¸ä¸­æ·»åŠ é”®å€¼å¯¹ï¼Œä¹‹åè¿™ä¸ªé”®å€¼å¯¹å°±å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå­—ç¬¦è¡¨ç¤ºäº†ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒåŠ¨æ€å­—å…¸ä¸Šä¸‹æ–‡æœ‰å…³ï¼Œéœ€è¦ä¸ºæ¯ä¸ª HTTP/2 è¿æ¥ç»´æŠ¤ä¸åŒçš„å­—å…¸ã€‚åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä½¿ç”¨ï¼Œä½¿ç”¨å­—ç¬¦ä»£æ›¿é”®å€¼å¯¹å¤§å¤§å‡å°‘ä¼ è¾“çš„æ•°æ®é‡ã€‚</p><h4 id="3-HTTP2æ”¯æŒæœåŠ¡å™¨æ¨é€"><strong>3. HTTP2æ”¯æŒæœåŠ¡å™¨æ¨é€</strong></h4><p>æœåŠ¡ç«¯æ¨é€æ˜¯ä¸€ç§åœ¨å®¢æˆ·ç«¯è¯·æ±‚ä¹‹å‰å‘é€æ•°æ®çš„æœºåˆ¶ã€‚å½“ä»£ç½‘é¡µä½¿ç”¨äº†è®¸å¤šèµ„æº:HTMLã€æ ·å¼è¡¨ã€è„šæœ¬ã€å›¾ç‰‡ç­‰ç­‰ã€‚åœ¨HTTP/1.xä¸­è¿™äº›èµ„æºæ¯ä¸€ä¸ªéƒ½å¿…é¡»æ˜ç¡®åœ°è¯·æ±‚ã€‚è¿™å¯èƒ½æ˜¯ä¸€ä¸ªå¾ˆæ…¢çš„è¿‡ç¨‹ã€‚æµè§ˆå™¨ä»è·å–HTMLå¼€å§‹ï¼Œç„¶ååœ¨å®ƒè§£æå’Œè¯„ä¼°é¡µé¢çš„æ—¶å€™ï¼Œå¢é‡åœ°è·å–æ›´å¤šçš„èµ„æºã€‚å› ä¸ºæœåŠ¡å™¨å¿…é¡»ç­‰å¾…æµè§ˆå™¨åšæ¯ä¸€ä¸ªè¯·æ±‚ï¼Œç½‘ç»œç»å¸¸æ˜¯ç©ºé—²çš„å’Œæœªå……åˆ†ä½¿ç”¨çš„ã€‚</p><p>ä¸ºäº†æ”¹å–„å»¶è¿Ÿï¼ŒHTTP/2å¼•å…¥äº†server pushï¼Œå®ƒå…è®¸æœåŠ¡ç«¯æ¨é€èµ„æºç»™æµè§ˆå™¨ï¼Œåœ¨æµè§ˆå™¨æ˜ç¡®åœ°è¯·æ±‚ä¹‹å‰ã€‚ä¸€ä¸ªæœåŠ¡å™¨ç»å¸¸çŸ¥é“ä¸€ä¸ªé¡µé¢éœ€è¦å¾ˆå¤šé™„åŠ èµ„æºï¼Œåœ¨å®ƒå“åº”æµè§ˆå™¨ç¬¬ä¸€ä¸ªè¯·æ±‚çš„æ—¶å€™ï¼Œå¯ä»¥å¼€å§‹æ¨é€è¿™äº›èµ„æºã€‚è¿™å…è®¸æœåŠ¡ç«¯å»å®Œå…¨å……åˆ†åœ°åˆ©ç”¨ä¸€ä¸ªå¯èƒ½ç©ºé—²çš„ç½‘ç»œï¼Œæ”¹å–„é¡µé¢åŠ è½½æ—¶é—´ã€‚</p><h2 id="TCPåè®®">TCPåè®®</h2><p>Transmission Control Protocol  ä¼ è¾“æ§åˆ¶åè®®</p><p>å±äºå“ªä¸€å±‚   è¿è¾“å±‚   ç½‘é™…å±‚éƒ½ä½¿ç”¨IPåè®®</p><p>é¢å‘è¿æ¥  é€šä¿¡å‰è¦å»ºç«‹TCPé€»è¾‘è¿æ¥ â€” ä¸‰æ¬¡æ¡æ‰‹ã€é¢å‘å­—èŠ‚æµã€é¦–éƒ¨å¼€é”€å¤§ min20å­—èŠ‚ max60å­—èŠ‚</p><p>å¯é ä¼ è¾“ï¼šé‡ä¼ æœºåˆ¶ï¼ˆä¸‹æ–‡æœ‰è®²ï¼‰ã€æµé‡æ§åˆ¶ã€æ‹¥å¡æ§åˆ¶</p><h3 id="æŠ¥æ–‡ä¿¡æ¯">æŠ¥æ–‡ä¿¡æ¯</h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210331203958930.png" alt="image-20210331203958930"></p><h3 id="å¯é ä¼ è¾“-v2">å¯é ä¼ è¾“</h3><p>ä»¥å­—èŠ‚ä¸ºå•ä½çš„æ»‘åŠ¨çª—å£  â€” æ¥å—çª—å£å’Œå‘é€çª—å£</p><p>å·²æ”¶åˆ°ackç¡®å®šçš„æŠ¥æ–‡å¯ä»¥delete</p><p>æœªæŒ‰åºåˆ°è¾¾çš„æ•°æ®åŒ…ä¸€èˆ¬ä¸´æ—¶å­˜æ”¾åœ¨æ¥å—çª—å£ä¸­ï¼Œç­‰åˆ°ç¼ºå°‘çš„å­—èŠ‚æ”¶åˆ°åå†æŒ‰åºäº¤ä»˜ä¸Šå±‚åº”ç”¨</p><p><strong>ç´¯è®¡ç¡®è®¤ï¼</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210331211800303.png" alt="image-20210331211800303"></p><h3 id="è¶…æ—¶é‡ä¼ æ—¶é—´é€‰æ‹©">è¶…æ—¶é‡ä¼ æ—¶é—´é€‰æ‹©</h3><p>RTTï¼š æŠ¥æ–‡æ®µå¾€è¿”æ—¶é—´ï¼ˆæ¯æ¬¡å¯èƒ½ä¸åŒï¼‰</p><p>RTO: è¶…æ—¶é‡ä¼ æ—¶é—´</p><p>å¦‚ä½•åˆç†è®¾ç½®RTOæ—¶é—´</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210331212813944.png" alt="image-20210331212813944"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210331212910233.png" alt="image-20210331212910233"></p><p><strong>æŠ¥æ–‡æ®µä¸¢å¤±é‡å‘çš„æƒ…å†µ  è¯¯åˆ¤</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210331213047103.png" alt="image-20210331213047103"></p><p><strong>ä¼ æŠ¥æ–‡æ®µè¶…æ—¶æƒ…å†µ</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210331213204617.png" alt="image-20210331213204617"></p><p>é’ˆå¯¹ä»¥ä¸Šä¸¤ç§æƒ…å†µçš„æ–°ç®—æ³•ï¼š</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210331213442132.png" alt="image-20210331213442132"></p><h3 id="æµé‡æ§åˆ¶">æµé‡æ§åˆ¶</h3><p>å‘é€æ–¹çš„æ•°æ®å‘çš„å¤ªå¿«ä»¥è‡³äºæ¥æ”¶æ–¹æ¥å—ä¸ä¸‹ï¼Œä¼šé€ æˆæ•°æ®çš„ä¸¢å¤± ï¼ˆ2MSL ï¼‰</p><p>åŸºäºæ»‘åŠ¨çª—å£æœºåˆ¶</p><p>æ¥å—çª—å£ rwnd</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210331210025354.png" alt="image-20210331210025354"></p><p>è§£å†³æ­»é”ï¼š æŒç»­è®¡æ—¶å™¨</p><p>æ¥æ”¶æ–¹æ”¶åˆ°0çª—å£é€šçŸ¥æ—¶ï¼Œå¼€å¯è®¡æ—¶å™¨ï¼Œè¶…æ—¶åˆ™å‘é€é›¶çª—å£çš„æ¢æµ‹æŠ¥æ–‡(æºå¸¦1å­—èŠ‚æ•°æ®)ï¼Œå¦‚æœå¯¹æ–¹å‘æ¥çš„æŠ¥æ–‡åˆ›å£ä¹Ÿæ˜¯é›¶ï¼Œåˆ™é‡ç½®è®¡æ—¶å™¨ç»§ç»­ç­‰å¾…ï¼Œå¦‚æœä¸æ˜¯é›¶åˆ™æ‰“ç ´åƒµå±€</p><p><strong>æ—¢ç„¶æœåŠ¡å™¨çš„çª—å£ä¸º0ï¼Œé‚£ä¸ºä»€ä¹ˆè¿˜èƒ½æ¥å—å‘é€æ–¹å‘æ¥çš„æ¢æµ‹æŠ¥æ–‡æ®µï¼Ÿ</strong></p><p>è§„å®šæ¥å— 0çª—å£æ¢æµ‹æŠ¥æ–‡æ®µã€ç¡®è®¤æŠ¥æ–‡æ®µã€æºå¸¦ç´§æ€¥æ•°æ®çš„æŠ¥æ–‡æ®µ</p><p><strong>ä¸‰æ¬¡æ¡æ‰‹</strong></p><p><strong>å››æ¬¡æŒ¥æ‰‹</strong></p><p><strong>ä¸ºä»€ä¹ˆä¸€å®šè¦ä¸‰æ¡å››æŒ¥ï¼Ÿ</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220331202037703.png" alt="image-20220331202037703"></p><p>å››æ¬¡æŒ¥æ‰‹ï¼Œæ˜¯å› ä¸º</p><p>ä¸ºä»€ä¹ˆè¿™é‡ŒServerçš„FIN å’Œ ACKåˆ†ä¸¤æ¬¡å‘é€å‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¬å¯ä»¥å¾—çŸ¥Clientè¦å…³é—­æ—¶ï¼Œå†å‘é€æœ€åä¸€ç‚¹æ•°æ®ç»™Client</p><p>ä¸ºä»€ä¹ˆè¦æœ‰æœ€åä¸€æ¬¡çš„æŒ¥æ‰‹ï¼Œå¦‚æœæ²¡æœ‰è¿™æ¬¡æŒ¥æ‰‹ï¼Œåˆ™æœåŠ¡ç«¯ç»™å®¢æˆ·ç«¯å‘é€çš„FINæŠ¥æ–‡å°±ä¸ä¸€å®šèƒ½æ¥æ”¶åˆ°ï¼Œå®¢æˆ·ç«¯å°±è®¤ä¸ºæœåŠ¡ç«¯å¯èƒ½è¿˜ä¼šæœ‰æ•°æ®è¦å‘ã€‚</p><p><strong>ä¸ºä»€ä¹ˆä¼šæœ‰2MSLï¼Ÿä»–æœ‰ä»€ä¹ˆä½œç”¨</strong></p><p>ç¬¬ä¸€ï¼Œä¸ºäº†ä¿è¯Aå‘é€çš„æœ€åä¸€ä¸ªACKæŠ¥æ–‡èƒ½å¤Ÿåˆ°è¾¾Bã€‚è¿™ä¸ªACKæŠ¥æ–‡æ®µæœ‰å¯èƒ½ä¸¢å¤±ï¼Œå› è€Œä½¿å¤„åœ¨LAST-ACKçŠ¶æ€çš„Bæ”¶ä¸åˆ°å¯¹å·²å‘é€çš„FIN+ACKæŠ¥æ–‡æ®µçš„ç¡®è®¤ã€‚Bä¼šè¶…æ—¶é‡ä¼ è¿™ä¸ªFIN+ACKæŠ¥æ–‡æ®µï¼Œè€ŒAå°±èƒ½åœ¨2MSLæ—¶é—´å†…æ”¶åˆ°è¿™ä¸ªé‡ä¼ çš„FIN+ACKæŠ¥æ–‡æ®µã€‚å¦‚æœAåœ¨TIME-WAITçŠ¶æ€ä¸ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œè€Œæ˜¯åœ¨å‘é€å®ŒACKæŠ¥æ–‡æ®µåå°±ç«‹å³é‡Šæ”¾è¿æ¥ï¼Œå°±æ— æ³•æ”¶åˆ°Bé‡ä¼ çš„FIN+ACKæŠ¥æ–‡æ®µï¼Œå› è€Œä¹Ÿä¸ä¼šå†å‘é€ä¸€æ¬¡ç¡®è®¤æŠ¥æ–‡æ®µã€‚è¿™æ ·ï¼ŒBå°±æ— æ³•æŒ‰ç…§æ­£å¸¸çš„æ­¥éª¤è¿›å…¥CLOSEDçŠ¶æ€ã€‚<br>ç¬¬äºŒï¼ŒAåœ¨å‘é€å®ŒACKæŠ¥æ–‡æ®µåï¼Œå†ç»è¿‡2MSLæ—¶é—´ï¼Œå°±å¯ä»¥ä½¿æœ¬è¿æ¥æŒç»­çš„æ—¶é—´æ‰€äº§ç”Ÿçš„æ‰€æœ‰æŠ¥æ–‡æ®µéƒ½ä»ç½‘ç»œä¸­æ¶ˆå¤±ã€‚è¿™æ ·å°±å¯ä»¥ä½¿ä¸‹ä¸€ä¸ªæ–°çš„è¿æ¥ä¸­ä¸ä¼šå‡ºç°è¿™ç§æ—§çš„è¿æ¥è¯·æ±‚çš„æŠ¥æ–‡æ®µ</p><h2 id="UDP">UDP</h2><p>User Datagram Protocol</p><p>æ— è¿æ¥ï¼Œå¯éšæ—¶å‘é€æ•°æ®ã€ç½‘ç»œå¼€é”€å° é€Ÿåº¦å¿« ã€æ”¯æŒä¸€å¯¹ä¸€ ä¸€å¯¹å¤š(å¹¿æ’­ã€å¤šæ’­(æŒ‡å®š)) å¤šå¯¹ä¸€ã€æŠ¥æ–‡ç›´æ¥æ‰“åŒ…ã€é¦–éƒ¨å¼€é”€å° 8 å­—èŠ‚</p><p>é¢å‘æŠ¥æ–‡ï¼Œç›´æ¥åŠ ä¸ªæŠ¥æ–‡å¤´å°±å‘å‡ºå»äº†</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210331204004782.png" alt="image-20210331204004782"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210331203219149.png" alt="image-20210331203219149"></p><h2 id="DNS">DNS</h2><p>Domain Name ( to ip )System è§£æåŸŸå   ç”µè¯ç°¿</p><p>è¿‡ç¨‹ï¼š</p><ol><li><p>æµè§ˆå™¨ç¼“å­˜</p></li><li><p>ç³»ç»Ÿç¼“å­˜</p></li><li><p>ISPã€ å› ç‰¹ç½‘æœåŠ¡å•†</p></li><li><p>æ ¹åŸŸåæœåŠ¡å™¨  å…¨ä¸–ç•Œ13ç»„ ï¼Œå¯èƒ½è¿™ä¸ªæ ¹åŸŸåæœåŠ¡å™¨ä¸çŸ¥é“ä»–çš„ipï¼Œä½†æ˜¯å¯ä»¥çŸ¥é“è°å¯ä»¥</p><p>.com é¡¶çº§åŸŸåæœåŠ¡å™¨  TLD(.com   .net  â€¦)</p></li><li><p>TLDä¹Ÿä¸çŸ¥é“æ—¶ï¼Œç»™æƒé™åç§°æœåŠ¡å™¨  å•¥éƒ½çŸ¥é“</p></li></ol><p>å›ä¼ æ—¶ï¼Œè¿›è¡Œä¿å­˜</p><h2 id="ç½‘ç»œæ‹¥å¡">ç½‘ç»œæ‹¥å¡</h2><p>æ‹¥å¡ï¼š ç½‘ç»œä¸­æŸä¸€èµ„æºçš„éœ€æ±‚ è¶…è¿‡äº†è¯¥èµ„æºæ‰€èƒ½æä¾›çš„å¯ç”¨éƒ¨åˆ†ï¼Œç½‘ç»œæ€§èƒ½å°†ä¼šå˜å·®ï¼Œå‡ºç°æ‹¥å¡è€Œä¸æ§åˆ¶ï¼Œåˆ™ç½‘ç»œçš„ååé‡å°±ä¼šéšç€è´Ÿè·çš„å¢å¤§è€Œä¸‹é™ï¼ˆå µè½¦ï¼‰</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210331193813129.png" alt="image-20210331193813129"></p><p>cnwdã€ssthreshã€rttã€swndã€æ•°æ®åŒ…æ–‡æ®µã€é‡ä¼ è®¡æ—¶å™¨</p><h3 id="TCP-Tahoe">TCP Tahoe</h3><p>æ…¢å¼€å§‹ cnwd &gt;&gt; 1</p><p>æ‹¥å¡é¿å…   cnwd++</p><h3 id="TCP-Reno-æ”¹è¿›å">TCP Reno æ”¹è¿›å</h3><p>åŸå› ï¼š æœ‰æ—¶ ä¸ªåˆ«æŠ¥æ–‡æ®µåœ¨ç½‘ç»œä¸­ä¸¢å¤±ï¼Œä½†å®é™…ä¸Šç½‘ç»œå¹¶æœªå‘ç”Ÿæ‹¥å¡ï¼Œè¿™å°†å¯¼è‡´å‘é€æ–¹è¶…æ—¶é‡ä¼ ï¼Œå¹¶è¯¯è®¤ä¸ºç½‘ç»œå‘ç”Ÿæ‹¥å¡ã€‚å‘é€æ–¹é”™è¯¯åœ°å¯åŠ¨æ…¢å¼€å§‹ç®—æ³•ï¼Œé™ä½äº†ä¼ è¾“æ•ˆç‡</p><p>å¿«é‡ä¼   è®©å‘é€æ–¹å°½å¿«çŸ¥é“å‘ç”Ÿäº†ä¸ªåˆ«æŠ¥æ–‡æ®µçš„ä¸¢å¤± ï¼Œè€Œä¸æ˜¯è®©è¶…å¸‚é‡ä¼ è®¡æ—¶å™¨è¶…æ—¶åå†é‡ä¼   ç›¸ç­‰çš„ack  == 3æ—¶ï¼Œåˆ™ç›¸åº”çš„æŠ¥æ–‡æ®µç«‹å³é‡ä¼ ï¼Œä¸ä¼šå†ç­‰è¶…æ—¶è®¡æ—¶å™¨è¶…æ—¶æ—¶å†é‡ä¼ ï¼Œæ¥ä¸‹æ¥æ‰§è¡Œå¿«æ¢å¤ç®—æ³•</p><p><strong>é—®é¢˜ï¼š é‡ä¼ åé‚£ä¸¢å¤±ä¹‹å‰çš„æ•°æ®åŒ…éƒ½æ”¶åˆ°äº†ï¼Œé‚£æ¥æ”¶æ–¹é‡å¤ç¡®è®¤æ—¶æ”¶åˆ°äº†ä¹‹åçš„æŠ¥æ–‡æ®µå—</strong></p><p>æ”¶åˆ°äº†</p><p>å¿«æ¢å¤</p><p>ssthresh å’Œ cwndå€¼ä¸ºå½“å‰çª—å£çš„ä¸€åŠï¼Œ æ‰§è¡Œæ‹¥å¡é¿å…ç®—æ³•</p><p>ä¹Ÿæœ‰ä¸€äº›æŠŠcwnd = æ–°çš„sstresh +3</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210331194703992.png" alt="image-20210331194703992"></p><h2 id="å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†çš„åŒºåˆ«">å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†çš„åŒºåˆ«</h2><h3 id="å¯¹ç§°åŠ å¯†">å¯¹ç§°åŠ å¯†</h3><p>åŠ å¯†å’Œè§£å¯†ä½¿ç”¨çš„ç§˜åŒ™æ˜¯åŒä¸€ä¸ª</p><p>ä¼˜ç‚¹ï¼šç®—æ³•å…¬å¼€ï¼Œè®¡ç®—é‡å°ï¼ŒåŠ å¯†é€Ÿåº¦å¿«ï¼ŒåŠ å¯†æ•ˆç‡é«˜</p><p>ç¼ºç‚¹ï¼šæ•°æ®ä¼ é€å‰ï¼ŒåŒæ–¹å¿…é¡»å•†å®šå¥½å¯†åŒ™ï¼Œä¿å­˜ã€‚å¦‚æœä¸€æ–¹å¯†åŒ™æ³„éœ²è¢«é»‘å®¢æ‹¦æˆªï¼Œåˆ™åŠ å¯†ä¿¡æ¯ä¸å®‰å…¨ï¼Œæ¯æ¬¡ä½¿ç”¨å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œéƒ½éœ€è¦ä½¿ç”¨å…¶ä»–äººä¸çŸ¥é“çš„å”¯ä¸€å¯†åŒ™ï¼Œæ˜¯çš„åŒæ–¹æ‹¥æœ‰çš„å¯†åŒ™æ•°é‡å¤§</p><p>å¸¸è§ï¼š DES  AES 3DES</p><h3 id="éå¯¹ç§°åŠ å¯†">éå¯¹ç§°åŠ å¯†</h3><p>éœ€è¦å…¬å¼€å¯†åŒ™å’Œç§æœ‰å¯†åŒ™ï¼Œä¸€æ–¹åŠ å¯†ï¼Œå¦ä¸€æ–¹çš„å¯†åŒ™å°±è§£å¯†</p><p>è¿‡ç¨‹ï¼š ç”²æ–¹ç”Ÿæˆå¯†åŒ™ ï¼Œå°†å…¶ä¸­ä¸€æŠŠä½œä¸ºå…±æœ‰çš„å¹¶å‘å…¶ä»–æ–¹å…¬å¼€ï¼Œå¾—åˆ°å…¬æœ‰å¯†åŒ™çš„ä¹™æ–¹ä½¿ç”¨è¯¥å¯†åŒ™å¯¹æœºå¯†ä¿¡æ¯è¿›è¡ŒåŠ å¯†åå‘é€ç»™ç”²æ–¹ï¼Œç”²æ–¹å†ç”¨ç§æœ‰çš„å¯†åŒ™å¯¹åŠ å¯†ä¿¡æ¯è¿›è¡Œè§£å¯†</p><p>ä¼˜ç‚¹ï¼šå®‰å…¨</p><p>ç¼ºç‚¹ï¼šé€Ÿåº¦æ…¢</p><p>å¸¸è§ï¼šRSA  ECC</p><h2 id="MD5">MD5</h2><p>MD5è®¯æ¯æ‘˜è¦æ¼”ç®—æ³•ï¼ˆè‹±è¯­ï¼šMD5 Message-Digest Algorithmï¼‰ï¼Œä¸€ç§è¢«å¹¿æ³›ä½¿ç”¨çš„å¯†ç æ‚å‡‘å‡½æ•°ï¼Œå¯ä»¥äº§ç”Ÿå‡ºä¸€ä¸ª128ä½å…ƒï¼ˆ16ä½å…ƒç»„ï¼‰çš„æ•£åˆ—å€¼ï¼ˆhash valueï¼‰ï¼Œç”¨äºç¡®ä¿ä¿¡æ¯ä¼ è¾“å®Œæ•´ä¸€è‡´ã€‚</p><p>MD5ä¸å¯é€†çš„åŸå› æ˜¯å…¶æ˜¯ä¸€ç§æ•£åˆ—å‡½æ•°ï¼Œä½¿ç”¨çš„æ˜¯hashç®—æ³•ï¼Œåœ¨è®¡ç®—è¿‡ç¨‹ä¸­åŸæ–‡çš„éƒ¨åˆ†ä¿¡æ¯æ˜¯ä¸¢å¤±äº†çš„</p><p>ä¸è¿‡æœ‰ä¸ªåœ°æ–¹å€¼å¾—æŒ‡å‡ºçš„æ˜¯ï¼Œä¸€ä¸ªMD5ç†è®ºä¸Šçš„ç¡®æ˜¯å¯èƒ½å¯¹åº”æ— æ•°å¤šä¸ªåŸæ–‡çš„ï¼Œå› ä¸ºMD5æ˜¯æœ‰é™å¤šä¸ªçš„è€ŒåŸæ–‡å¯ä»¥æ˜¯æ— æ•°å¤šä¸ªã€‚æ¯”å¦‚ä¸»æµä½¿ç”¨çš„MD5å°†ä»»æ„é•¿åº¦çš„â€œå­—èŠ‚ä¸²æ˜ å°„ä¸ºä¸€ä¸ª128bitçš„å¤§æ•´æ•°ã€‚ä¹Ÿå°±æ˜¯ä¸€å…±æœ‰2<sup>128ç§å¯èƒ½ï¼Œå¤§æ¦‚æ˜¯3.4*10</sup>38ï¼Œè¿™ä¸ªæ•°å­—æ˜¯æœ‰é™å¤šä¸ªçš„ï¼Œè€Œä½†æ˜¯ä¸–ç•Œä¸Šå¯ä»¥è¢«ç”¨æ¥åŠ å¯†çš„åŸæ–‡åˆ™ä¼šæœ‰æ— æ•°çš„å¯èƒ½æ€§ã€‚</p><h3 id="ç”¨é€”">ç”¨é€”</h3><ol><li><p>é˜²æ­¢è¢«ç¯¡æ”¹</p></li><li><p>é˜²æ­¢ç›´æ¥çœ‹åˆ°æ˜æ–‡ ---- å‰åæ¯”è¾ƒ</p><p>â€‹ç°åœ¨å¾ˆå¤šç½‘ç«™åœ¨æ•°æ®åº“å­˜å‚¨ç”¨æˆ·çš„å¯†ç çš„æ—¶å€™éƒ½æ˜¯å­˜å‚¨ç”¨æˆ·å¯†ç çš„MD5å€¼ã€‚è¿™æ ·å°±ç®—ä¸æ³•åˆ†å­å¾—åˆ°æ•°æ®åº“çš„ç”¨æˆ·å¯†ç çš„MD5å€¼ï¼Œä¹Ÿæ— æ³•çŸ¥é“ç”¨æˆ·çš„å¯†ç ã€‚ï¼ˆæ¯”å¦‚åœ¨UNIXç³»ç»Ÿä¸­ç”¨æˆ·çš„å¯†ç å°±æ˜¯ä»¥MD5ï¼ˆæˆ–å…¶å®ƒç±»ä¼¼çš„ç®—æ³•ï¼‰ç»åŠ å¯†åå­˜å‚¨åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ã€‚å½“ç”¨æˆ·ç™»å½•çš„æ—¶å€™ï¼Œç³»ç»ŸæŠŠç”¨æˆ·è¾“å…¥çš„å¯†ç è®¡ç®—æˆMD5å€¼ï¼Œç„¶åå†å»å’Œä¿å­˜åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„MD5å€¼è¿›è¡Œæ¯”è¾ƒï¼Œè¿›è€Œç¡®å®šè¾“å…¥çš„å¯†ç æ˜¯å¦æ­£ç¡®ã€‚é€šè¿‡è¿™æ ·çš„æ­¥éª¤ï¼Œç³»ç»Ÿåœ¨å¹¶ä¸çŸ¥é“ç”¨æˆ·å¯†ç çš„æ˜ç çš„æƒ…å†µä¸‹å°±å¯ä»¥ç¡®å®šç”¨æˆ·ç™»å½•ç³»ç»Ÿçš„åˆæ³•æ€§ã€‚è¿™ä¸ä½†å¯ä»¥é¿å…ç”¨æˆ·çš„å¯†ç è¢«å…·æœ‰ç³»ç»Ÿç®¡ç†å‘˜æƒé™çš„ç”¨æˆ·çŸ¥é“ï¼Œè€Œä¸”è¿˜åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ äº†å¯†ç è¢«ç ´è§£çš„éš¾åº¦ã€‚ï¼‰</p></li><li><p>é˜²æ­¢æŠµèµ–â€“æ•°å­—ç­¾å</p></li></ol><h3 id="è¿‡ç¨‹">è¿‡ç¨‹</h3><p>å¯¹MD5ç®—æ³•ç®€è¦çš„å™è¿°å¯ä»¥ä¸ºï¼šMD5ä»¥512ä½åˆ†ç»„æ¥å¤„ç†è¾“å…¥çš„ä¿¡æ¯ï¼Œä¸”æ¯ä¸€åˆ†ç»„åˆè¢«åˆ’åˆ†ä¸º16ä¸ª32ä½å­åˆ†ç»„ï¼Œç»è¿‡äº†ä¸€ç³»åˆ—çš„å¤„ç†åï¼Œç®—æ³•çš„è¾“å‡ºç”±å››ä¸ª32ä½åˆ†ç»„ç»„æˆï¼Œå°†è¿™å››ä¸ª32ä½åˆ†ç»„çº§è”åå°†ç”Ÿæˆä¸€ä¸ª128ä½æ•£åˆ—å€¼ã€‚</p><h2 id="å¦å¤–çš„é—®é¢˜">å¦å¤–çš„é—®é¢˜</h2><h3 id="å†…ç½‘å’Œå¤–ç½‘çš„åŒºåˆ«">å†…ç½‘å’Œå¤–ç½‘çš„åŒºåˆ«</h3><p>å†…ç½‘åˆç§°å±€åŸŸç½‘ï¼ˆLocal Area Networkï¼ŒLANï¼‰æ˜¯æŒ‡åœ¨æŸä¸€åŒºåŸŸå†…ç”±å¤šå°è®¡ç®—æœºäº’è”æˆçš„è®¡ç®—æœºç»„ã€‚ä¸€èˆ¬æ˜¯æ–¹åœ†å‡ åƒç±³ä»¥å†…ã€‚</p><p>å±€åŸŸç½‘æ˜¯å°é—­å‹çš„ï¼Œå¯ä»¥ç”±åŠå…¬å®¤å†…çš„ä¸¤å°è®¡ç®—æœºç»„æˆï¼Œä¹Ÿå¯ä»¥ç”±ä¸€ä¸ªå…¬å¸å†…çš„ä¸Šåƒå°è®¡ç®—æœºç»„æˆã€‚</p><p>å±€åŸŸç½‘ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼š</p><p>1ã€è¦†ç›–çš„åœ°ç†èŒƒå›´è¾ƒå°ï¼Œåªåœ¨ä¸€ä¸ªç›¸å¯¹ç‹¬ç«‹çš„å±€éƒ¨èŒƒå›´å†…è”ï¼Œå¦‚ä¸€åº§æˆ–é›†ä¸­çš„å»ºç­‘ç¾¤å†…ã€‚</p><p>2ã€ä½¿ç”¨ä¸“é—¨é“ºè®¾çš„ä¼ è¾“ä»‹è´¨è¿›è¡Œè”ç½‘ï¼Œæ•°æ®ä¼ è¾“é€Ÿç‡é«˜ï¼ˆ10Mb/sï½10Gb/sï¼‰</p><p>3ã€é€šä¿¡å»¶è¿Ÿæ—¶é—´çŸ­ï¼Œå¯é æ€§è¾ƒé«˜</p><p>4ã€å±€åŸŸç½‘å¯ä»¥æ”¯æŒå¤šç§ä¼ è¾“ä»‹è´¨</p><p>å¤–ç½‘åˆè¢«ç§°ä¸ºå¹¿åŸŸç½‘ï¼ˆWANï¼‰ï¼Œå°±æ˜¯æˆ‘ä»¬é€šå¸¸æ‰€è¯´çš„Internetï¼Œå®ƒæ˜¯ä¸€ä¸ªéåŠå…¨ä¸–ç•Œçš„ç½‘ç»œã€‚å®ƒå¯ä»¥è¿æ¥æå…¶å¤§çš„ç‰©ç†èŒƒå›´ï¼Œå±äºè¿œç¨‹æ€§çš„ç½‘ç»œï¼Œå·²ç»å®ç°äº†è·¨å›½äº’è”ï¼Œå±€åŸŸç½‘ä»¥åŠåŸåŸŸç½‘éƒ½è¿œè¿œæ¯”ä¸ä¸Šå¤–ç½‘ï¼Œå¤–ç½‘æ˜¯è®¸å¤šçš„è®¡ç®—æœºç›¸äº’ä¹‹é—´ç”¨çº¿è·¯è¿æ¥å½¢æˆçš„ã€‚</p><p>ç›®å‰ä¸ºæ­¢ï¼Œå› ç‰¹ç½‘å°±æ˜¯ä¸–ç•Œä¸Šæœ€å¤§çš„å¤–ç½‘ï¼Œå®ƒçš„è¦†ç›–èŒƒå›´æ— å¯åŒ¹æ•Œã€‚ä¸€äº›ç›¸éš”è¾ƒè¿œçš„è®¾å¤‡å°±éœ€è¦å¤–ç½‘çš„è¿æ¥ï¼Œè¿™äº›è®¾å¤‡ä¸­æ¯”è¾ƒå¸¸è§çš„æ˜¯è·¯ç”±å™¨å’Œäº¤æ¢æœº ã€‚</p><p>å¤–ç½‘è¿˜åˆ†ä¸ºäº†å¥½å‡ ç±»ï¼ŒæŒ‰ç…§ç½‘ç»œçš„ä½¿ç”¨ç±»å‹å¯ä»¥åˆ†æˆå…¬å…±ä¼ è¾“ã€ä¸“ç”¨ä¼ è¾“å’Œæ— çº¿ä¼ è¾“ä¸‰ç±»ç½‘ç»œä¼ è¾“ã€‚</p><p><strong>è¿…é›·ä¸ºä»€ä¹ˆä¼šå‘˜å¯ä»¥åŠ é€Ÿé‚£ä¹ˆå¿«ï¼Ÿ</strong></p><p><strong>QQä¼ æ–‡ä»¶ä¸ºä»€ä¹ˆé‚£ä¹ˆå¿«ï¼Ÿ</strong></p><h3 id="å¸¸è§çš„ç½‘ç»œè¯·æ±‚ç ">å¸¸è§çš„ç½‘ç»œè¯·æ±‚ç </h3><ul><li>101 ç­‰åˆ°æ¥å—å…¶ä»–éƒ¨åˆ†</li><li>200 å¤„ç†æˆåŠŸ</li><li>201 è¯·æ±‚æˆåŠŸæœåŠ¡å™¨åˆ›å»º äº†æ–°çš„èµ„æº</li><li>202 æœåŠ¡å™¨æ¥å—è¯·æ±‚ä½†æœªå¤„ç†</li><li>301 æ°¸ä¹…ç§»åŠ¨</li><li>302 ä¸´æ—¶ç§»åŠ¨</li><li>400 é”™è¯¯è¯·æ±‚  è¯­æ³•</li><li>401 æœªæˆæƒ  éœ€è¦ç™»é™†</li><li>403 ç¦æ­¢ æœåŠ¡å™¨æ‹’ç»è¯·æ±‚</li><li>404 uæ‰¾ä¸åˆ°è¯·æ±‚é¡µé¢</li><li>405 ç¦æ­¢è¯·æ±‚nä¸­åˆ¶å®šçš„æ–¹æ³•</li><li>408 è¯·æ±‚è¶…æ—¶</li><li>500 æœåŠ¡å™¨å†…éƒ¨ué”™è¯¯</li><li>503 æœåŠ¡ä¸å¯ç”¨</li><li>505 httpç‰ˆæœ¬ä¸æ”¯æŒ</li></ul>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>TCP/IP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaå­¦ä¹ </title>
    <link href="/2021/01/20/Java%E5%AD%A6%E4%B9%A0/"/>
    <url>/2021/01/20/Java%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1>Java SE</h1><!--toc--><h2 id="é›†åˆ">é›†åˆ</h2><h3 id="ArrayList">ArrayList</h3><ul><li>å…è®¸æ·»åŠ å¤šä¸ªnullå€¼<ul><li>å±æ€§ size æ˜¯æŒ‡ elementData ä¸­å®é™…æœ‰å¤šå°‘ä¸ªå…ƒç´ ï¼Œè€Œ elementData.length ä¸ºé›†åˆå®¹é‡</li></ul></li><li>DEFAULTCAPACITY_EMPTY_ELEMENTDATAå’ŒEMPTY_ELEMENTDATAåŒºåˆ«ï¼š æ„é€ å‡½æ•° æ˜¯å¦æœ‰initialCapacity</li><li>ç¬¬ä¸€æ¬¡æ·»åŠ å…ƒç´ æ—¶æ‰©å®¹   é»˜è®¤åˆå§‹çš„é›†åˆå®¹é‡ 10</li><li>æ¯æ¬¡å¢åˆ éƒ½ä½¿modCountå¢åŠ  ï¼Œå¹¶ä¸”å¢åˆ ä¼šè¿›è¡ŒmodCountçš„æ£€æŸ¥ï¼Œä¾‹å¦‚åœ¨è¿­ä»£æ—¶è¿›è¡Œå¢åˆ æ“ä½œæ—¶ ä¼šæŠ¥é”™ï¼ŒIträ¸­çš„expectedModCountä¸modCountä¸ä¸€è‡´ï¼</li></ul><p><span style='color:red;font-size:20px;'>é¢è¯•ï¼šä¼˜åŒ–æ•°ç»„Â </span></p><span id="more"></span><p>æ ‡è®°-æ¸…é™¤æ³•</p><h3 id="HashMap">HashMap</h3><p>å†…éƒ¨hashå‡½æ•°</p><p>putå‰è¦è¿›è¡Œå¯¹å†æ¬¡å¯¹hashcodeå†æ¬¡hashï¼Œä¹Ÿå°±æ˜¯é«˜16 å’Œä½ 16åšå¼‚æˆ–è¿ç®—</p><p><strong>ä¸ºä»€ä¹ˆè¦é‡å†™equals å’Œhascodeæ–¹æ³•ï¼ŒpuValæ–¹æ³•ä¸­æœ‰æåˆ°</strong></p><p>æ³¨æ„åŒºåˆ†Nodeçš„hash å’Œ keyçš„hashcode</p><p>åŸºæœ¬ç±»å‹çš„hashcodeæ–¹æ³•</p><p>è‡ªåŠ¨è£…ç®±  æœ€ç¡¬æ ¸çš„å±…ç„¶æ˜¯Integerçš„hashcodeæ–¹æ³•ï¼Œå±…ç„¶å°±è¿”å›çš„valueï¼ï¼</p><ul><li><p>ä¸ºä»€ä¹ˆè¦å³ç§»16ä½ï¼Ÿ</p><p>å‡å°‘ç¢°æ’ é™ä½hashå†²çª</p><p>JDK 1.8 put</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">final</span> <span class="token class-name">V</span> <span class="token function">putVal</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> <span class="token class-name">K</span> key<span class="token punctuation">,</span> <span class="token class-name">V</span> value<span class="token punctuation">,</span> <span class="token keyword">boolean</span> onlyIfAbsent<span class="token punctuation">,</span>                  <span class="token keyword">boolean</span> evict<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab<span class="token punctuation">;</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> p<span class="token punctuation">;</span> <span class="token keyword">int</span> n<span class="token punctuation">,</span> i<span class="token punctuation">;</span>       <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tab <span class="token operator">=</span> table<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token punctuation">(</span>n <span class="token operator">=</span> tab<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>           <span class="token comment">//é‡ç‚¹å…³æ³¨</span>           n <span class="token operator">=</span> <span class="token punctuation">(</span>tab <span class="token operator">=</span> <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>       <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>p <span class="token operator">=</span> tab<span class="token punctuation">[</span>i <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> hash<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>           tab<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">newNode</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>           <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> e<span class="token punctuation">;</span> <span class="token class-name">K</span> k<span class="token punctuation">;</span>           <span class="token comment">//é‡ç‚¹å…³æ³¨</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span>               <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> p<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>               <span class="token comment">//è¿™å¥è¯å…è®¸äº†é…çš„é’¥åŒ™å¯ä»¥å¼€ç›¸åŒçš„é”</span>               e <span class="token operator">=</span> p<span class="token punctuation">;</span>           <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token keyword">instanceof</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span>               e <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">)</span>p<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">putTreeVal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> tab<span class="token punctuation">,</span> hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> binCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">;</span> <span class="token operator">++</span>binCount<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> p<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                       p<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token function">newNode</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                       <span class="token keyword">if</span> <span class="token punctuation">(</span>binCount <span class="token operator">>=</span> TREEIFY_THRESHOLD <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// -1 for 1st</span>                           <span class="token function">treeifyBin</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span> hash<span class="token punctuation">)</span><span class="token punctuation">;</span>                       <span class="token keyword">break</span><span class="token punctuation">;</span>                   <span class="token punctuation">&#125;</span>                   <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span>                       <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> e<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                       <span class="token keyword">break</span><span class="token punctuation">;</span>                   p <span class="token operator">=</span> e<span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// existing mapping for key</span>               <span class="token class-name">V</span> oldValue <span class="token operator">=</span> e<span class="token punctuation">.</span>value<span class="token punctuation">;</span>               <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>onlyIfAbsent <span class="token operator">||</span> oldValue <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>                   e<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>               <span class="token function">afterNodeAccess</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token keyword">return</span> oldValue<span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token operator">++</span>modCount<span class="token punctuation">;</span>       <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">++</span>size <span class="token operator">></span> threshold<span class="token punctuation">)</span>           <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token function">afterNodeInsertion</span><span class="token punctuation">(</span>evict<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p>resizeæ‰©å®¹æœºåˆ¶</p><p>JDK 1.6</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">void</span> <span class="token function">transfer</span><span class="token punctuation">(</span><span class="token class-name">Entry</span><span class="token punctuation">[</span><span class="token punctuation">]</span> newTable<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token class-name">Entry</span><span class="token punctuation">[</span><span class="token punctuation">]</span> src <span class="token operator">=</span> table<span class="token punctuation">;</span>       <span class="token keyword">int</span> newCapacity <span class="token operator">=</span> newTable<span class="token punctuation">.</span>length<span class="token punctuation">;</span>       <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> src<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> e <span class="token operator">=</span> src<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               src<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>               <span class="token keyword">do</span> <span class="token punctuation">&#123;</span>                   <span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> next <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">;</span>                   <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token function">indexFor</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash<span class="token punctuation">,</span> newCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>                   e<span class="token punctuation">.</span>next <span class="token operator">=</span> newTable<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>                   newTable<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>                   e <span class="token operator">=</span> next<span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>e <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p>æ³¨æ„ &amp; oldCap  å’Œ &amp;oldCap-1 çš„åŒºåˆ«ï¼ï¼ï¼</p><p>æ³¨æ„è¿™é‡Œçš„ (e.hash &amp; oldCap) == 0</p><p><a href="https://blog.csdn.net/u010425839/article/details/106620440?utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-1.control&amp;dist_request_id=1328767.10456.16173490220630373&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-1.control">https://blog.csdn.net/u010425839/article/details/106620440?utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-1.control&amp;dist_request_id=1328767.10456.16173490220630373&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-1.control</a></p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> oldTab <span class="token operator">=</span> table<span class="token punctuation">;</span><span class="token keyword">int</span> oldCap <span class="token operator">=</span> <span class="token punctuation">(</span>oldTab <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> oldTab<span class="token punctuation">.</span>length<span class="token punctuation">;</span><span class="token keyword">int</span> oldThr <span class="token operator">=</span> threshold<span class="token punctuation">;</span><span class="token keyword">int</span> newCap<span class="token punctuation">,</span> newThr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>oldCap <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCap <span class="token operator">>=</span> MAXIMUM_CAPACITY<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        threshold <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>        <span class="token keyword">return</span> oldTab<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>newCap <span class="token operator">=</span> oldCap <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> MAXIMUM_CAPACITY <span class="token operator">&amp;&amp;</span>             oldCap <span class="token operator">>=</span> DEFAULT_INITIAL_CAPACITY<span class="token punctuation">)</span>        newThr <span class="token operator">=</span> oldThr <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// double threshold</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>oldThr <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// initial capacity was placed in threshold</span>    newCap <span class="token operator">=</span> oldThr<span class="token punctuation">;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>               <span class="token comment">// zero initial threshold signifies using defaults</span>    newCap <span class="token operator">=</span> DEFAULT_INITIAL_CAPACITY<span class="token punctuation">;</span>    newThr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>DEFAULT_LOAD_FACTOR <span class="token operator">*</span> DEFAULT_INITIAL_CAPACITY<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>newThr <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">float</span> ft <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>newCap <span class="token operator">*</span> loadFactor<span class="token punctuation">;</span>    newThr <span class="token operator">=</span> <span class="token punctuation">(</span>newCap <span class="token operator">&lt;</span> MAXIMUM_CAPACITY <span class="token operator">&amp;&amp;</span> ft <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>MAXIMUM_CAPACITY <span class="token operator">?</span>              <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>ft <span class="token operator">:</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>threshold <span class="token operator">=</span> newThr<span class="token punctuation">;</span><span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"rawtypes"</span><span class="token punctuation">,</span><span class="token string">"unchecked"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> newTab <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">[</span>newCap<span class="token punctuation">]</span><span class="token punctuation">;</span>table <span class="token operator">=</span> newTab<span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>oldTab <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> oldCap<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> e<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> oldTab<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            oldTab<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>next <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>                newTab<span class="token punctuation">[</span>e<span class="token punctuation">.</span>hash <span class="token operator">&amp;</span> <span class="token punctuation">(</span>newCap <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token keyword">instanceof</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span>                <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">)</span>e<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> newTab<span class="token punctuation">,</span> j<span class="token punctuation">,</span> oldCap<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">// preserve order</span>                <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> loHead <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> loTail <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>                <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> hiHead <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> hiTail <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>                <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> next<span class="token punctuation">;</span>                <span class="token keyword">do</span> <span class="token punctuation">&#123;</span>                    next <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">&amp;</span> oldCap<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span>loTail <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>                            loHead <span class="token operator">=</span> e<span class="token punctuation">;</span>                        <span class="token keyword">else</span>                            loTail<span class="token punctuation">.</span>next <span class="token operator">=</span> e<span class="token punctuation">;</span>                        loTail <span class="token operator">=</span> e<span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span>hiTail <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>                            hiHead <span class="token operator">=</span> e<span class="token punctuation">;</span>                        <span class="token keyword">else</span>                            hiTail<span class="token punctuation">.</span>next <span class="token operator">=</span> e<span class="token punctuation">;</span>                        hiTail <span class="token operator">=</span> e<span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> next<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>loTail <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    loTail<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>                    newTab<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> loHead<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>hiTail <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    hiTail<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>                    newTab<span class="token punctuation">[</span>j <span class="token operator">+</span> oldCap<span class="token punctuation">]</span> <span class="token operator">=</span> hiHead<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> newTab<span class="token punctuation">;</span></code></pre></div><p>é¦–å…ˆå°†é«˜16ä½æ— ç¬¦å·å³ç§»16ä½ä¸ä½åå…­ä½åšå¼‚æˆ–è¿ç®—ã€‚å¦‚æœä¸è¿™æ ·åšï¼Œè€Œæ˜¯ç›´æ¥åš&amp;è¿ç®—é‚£ä¹ˆé«˜åå…­ä½æ‰€ä»£è¡¨çš„éƒ¨åˆ†ç‰¹å¾å°±å¯èƒ½è¢«ä¸¢å¤± å°†é«˜åå…­ä½æ— ç¬¦å·å³ç§»ä¹‹åä¸ä½åå…­ä½åšå¼‚æˆ–è¿ç®—ä½¿å¾—é«˜åå…­ä½çš„ç‰¹å¾ä¸ä½åå…­ä½çš„ç‰¹å¾è¿›è¡Œäº†æ··åˆå¾—åˆ°çš„æ–°çš„æ•°å€¼ä¸­å°±é«˜ä½ä¸ä½ä½çš„ä¿¡æ¯éƒ½è¢«ä¿ç•™äº† ï¼Œè€Œåœ¨è¿™é‡Œé‡‡ç”¨å¼‚æˆ–è¿ç®—è€Œä¸é‡‡ç”¨&amp; ï¼Œ| è¿ç®—çš„åŸå› æ˜¯ å¼‚æˆ–è¿ç®—èƒ½æ›´å¥½çš„ä¿ç•™å„éƒ¨åˆ†çš„ç‰¹å¾ï¼Œå¦‚æœé‡‡ç”¨&amp;è¿ç®—è®¡ç®—å‡ºæ¥çš„å€¼ä¼šå‘1é æ‹¢ï¼Œé‡‡ç”¨|è¿ç®—è®¡ç®—å‡ºæ¥çš„å€¼ä¼šå‘0é æ‹¢</p></li><li><p>Node å•é“¾è¡¨ç»“æ„</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210228192712917.png" alt="image-20210228192712917"></p></li><li><p>æ‰©å®¹æœºåˆ¶</p></li><li><p>hashç¢°æ’</p></li></ul><p>å‘ç”Ÿhashç¢°æ’æ—¶ å½“å‰çš„å…ƒç´ ç”Ÿæˆæ–°çš„èŠ‚ç‚¹ä¿å­˜åœ¨é“¾è¡¨çš„å°¾éƒ¨</p><h3 id="LinkedHashMap">LinkedHashMap</h3><p><strong>ç»“æ„</strong></p><p>accessOrderæœ‰ä»€ä¹ˆç”¨ï¼Ÿ</p><p>transientå…³é”®å­—ä¸å¯è§ ï¼Ÿ</p><p><strong>å®ç°LRU</strong></p><p><strong>æ’å…¥åˆ é™¤åŸç†</strong></p><p><strong>hashmapç•™çš„åé—¨</strong></p><p>å“ªç§æƒ…å†µä¸‹getä¹Ÿä¼šä½¿å¾—é‡æ–°æ’åº</p><h3 id="Hashtable">Hashtable</h3><p>Hashtableæ—¢ä¸æ”¯æŒNull keyä¹Ÿä¸æ”¯æŒNull value</p><p>ä¸ºå•¥ï¼Ÿ</p><p>è¿™æ˜¯å› ä¸ºHashtableä½¿ç”¨çš„æ˜¯å®‰å…¨å¤±è´¥æœºåˆ¶ï¼ˆfail-safeï¼‰ï¼Œè¿™ç§æœºåˆ¶ä¼šä½¿ä½ æ­¤æ¬¡è¯»åˆ°çš„æ•°æ®ä¸ä¸€å®šæ˜¯æœ€æ–°çš„æ•°æ®ã€‚</p><p>å¦‚æœä½ ä½¿ç”¨nullå€¼ï¼Œå°±ä¼šä½¿å¾—å…¶æ— æ³•åˆ¤æ–­å¯¹åº”çš„keyæ˜¯ä¸å­˜åœ¨è¿˜æ˜¯ä¸ºç©ºï¼Œå› ä¸ºä½ æ— æ³•å†è°ƒç”¨ä¸€æ¬¡contain(keyï¼‰æ¥å¯¹keyæ˜¯å¦å­˜åœ¨è¿›è¡Œåˆ¤æ–­ï¼ŒConcurrentHashMapåŒç†ã€‚</p><p><strong>è§£å†³é—®é¢˜</strong></p><p>å¤šçº¿ç¨‹ä¸‹æ·»åŠ å…ƒç´ çš„å®‰å…¨æ€§</p><p>ä½•ä¸ºå®‰å…¨ï¼Ÿå¤šçº¿ç¨‹æ’å…¥æ—¶çš„çº¿ç¨‹ä¸å®‰å…¨é—®é¢˜  â€“ ç”¨hashTableå¯è§£å†³</p><p><strong>å¦‚ä½•å®ç°</strong></p><p>synchronized é”æ–¹æ³•</p><h3 id="ConcurrentHashMap">ConcurrentHashMap</h3><p>ä¼˜å…ˆé€‰æ‹©-- æ€§èƒ½æ•ˆç‡æ›´é«˜</p><p>èƒ½è¯´è¯´ä»€ä¹ˆæ˜¯å¿«é€Ÿå¤±è´¥ä»€ä¹ˆæ˜¯å®‰å…¨å¤±è´¥å—ï¼Ÿ</p><p>å¿«é€Ÿå¤±è´¥  modCount ä¸èƒ½åœ¨å¤šçº¿ç¨‹ä¸‹å¹¶å‘ä¿®æ”¹</p><p>å®‰å…¨å¤±è´¥  concurrentåŒ…ä¸‹çš„å®¹å™¨éƒ½æ˜¯</p><h3 id="SynchronizedMap">SynchronizedMap</h3><p>æ’æ–¥æ‰€ Object mutex</p><p>å°±æ˜¯åŠ é”</p><h3 id="HashSet">HashSet</h3><p><strong>Hashsetåº•å±‚ç”±ä»€ä¹ˆå®ç°ï¼Ÿ</strong></p><p>hashmap</p><h3 id="PriorityQueue">PriorityQueue</h3><p>æ•°ç»„ç»„æˆï¼›modCountç¦æ­¢å¹¶å‘</p><p>åŸºäºå †çš„æ’åº</p><h2 id="Clone">Clone</h2><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">User</span> u1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">User</span> u2 <span class="token operator">=</span> u1<span class="token punctuation">;</span><span class="token comment">//å°†u1çš„referenceç»™äº†u2</span>u1 <span class="token operator">!=</span> u2</code></pre></div><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Obj</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Obj</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Obj</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>obj<span class="token punctuation">.</span>stu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Stu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Obj</span> obj2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Obj</span><span class="token punctuation">)</span> obj<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>obj2<span class="token operator">==</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>obj2<span class="token punctuation">.</span>stu <span class="token operator">==</span> obj<span class="token punctuation">.</span>stu<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p>æ­¤æ—¶æ“ä½œu2/u1 éƒ½ä¼šä½¿å¦ä¸€ä¸ªçš„å€¼å‘ç”Ÿæ”¹å˜</p><p>ä½†å¦‚æœæˆ‘ä»¬ä¸æƒ³æ”¹å˜å¦ä¸€ä¸ªçš„å€¼å°±éœ€è¦ä½¿ç”¨åˆ°clone</p><p>å®ç°Cloneableæ¥å£ //Cloneableæ¥å£æ²¡æœ‰å…·ä½“çš„å®ç°æ–¹æ³•ï¼Œä»–ç›¸å½“äºæ˜¯ä¸€ä¸ªæ ‡è¯†ï¼Œå¦‚æœç±»æ²¡æœ‰ç»§æ‰¿cloneableæ¥å£è€Œè°ƒç”¨cloneæ–¹æ³•ï¼Œä¼šæŠ›å‡º<strong>CloneNotSupportedExcepionå¼‚å¸¸</strong></p><h2 id="-v2"></h2><h3 id="æ·±æ‹·è´å’Œæµ…æ‹·è´">æ·±æ‹·è´å’Œæµ…æ‹·è´</h3><p>æµ…æ‹·è´</p><p>cloneæ— æ³•clone ä¸€ä¸ªå¯¹è±¡ä¸­çš„å¦ä¸€ä¸ªå¯¹è±¡ï¼Œè¿˜æ˜¯æ˜¯ä¸€ä¸ªreference</p><p>æ·±æ‹·è´</p><p>åœ¨å¯¹è±¡çš„å¯¹è±¡ä¸­å®ç°cloneableæ¥å£ï¼Œé‡å†™cloneæ–¹æ³•</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span><span class="token keyword">protected</span> <span class="token class-name">Object</span> <span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">CloneNotSupportedException</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">Obj</span> obj <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Obj</span><span class="token punctuation">)</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    obj<span class="token punctuation">.</span>stu <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Stu</span><span class="token punctuation">)</span> stu<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> obj<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><h3 id="cloneçš„ä¿æŠ¤æœºåˆ¶">cloneçš„ä¿æŠ¤æœºåˆ¶</h3><p>objectç±»ä¸­æœ‰protected çš„nativeæ–¹æ³• cloneï¼Œä¸” Userè‚¯å®šæ˜¯ç»§æ‰¿äº†Objectï¼Œä¸ºä»€ä¹ˆ</p><p><span style='color:red;font-size:24px'>æœªå®ç°Cloneableæ¥å£çš„ç±»ä¸èƒ½è°ƒç”¨cloneæ–¹æ³•</span></p><h4 id="å»¶ä¼¸ï¼š-protectedçš„ä½œç”¨èŒƒå›´">å»¶ä¼¸ï¼š protectedçš„ä½œç”¨èŒƒå›´</h4><p>ä¸€ä¸ªpublic ç±»ï¼Œ æœ‰protectedçš„æ–¹æ³•ï¼Œ</p><p>å¦‚æœåœ¨åŒåŒ…ä¸‹æ–°å»ºç±»ç»§æ‰¿ä»–ï¼Œè¿™ä¸ªæ–°å»ºçš„ç±»å¯¹è±¡èƒ½å¤Ÿè°ƒç”¨protecTedçš„æ–¹æ³•</p><p>å¦‚æœåœ¨ä¸åŒåŒ…ä¸‹ æ–°å»ºä¸€ä¸ªç±» ç»§æ‰¿ä»–ï¼Œ åˆ›å»ºè¿™ä¸ªç±»çš„å¯¹è±¡ï¼Œä¸èƒ½è°ƒç”¨ cloneæ–¹æ³•ï¼Œä½†æ˜¯å¯ä»¥åœ¨è¿™ä¸ªç±»ä¸­é‡å†™protectedçš„æ–¹æ³•ï¼Œè¿™æ ·å°±èƒ½å¤Ÿè°ƒç”¨ã€‚</p><p><span style='color:#3CB371;font-size:24px'>è¿™å°±æ˜¯protectedçš„ æ´¾ç”Ÿç±»å¯¹åŒåŒ…å¯è§ï¼Œä¸åŒåŒ…ä¸å¯è§çš„åŸç†</span></p><p>protectedå—è®¿é—®ä¿æŠ¤è§„åˆ™æ˜¯å¾ˆå¾®å¦™çš„ã€‚è™½ç„¶protectedåŸŸå¯¹æ‰€æœ‰å­ç±»éƒ½å¯è§ã€‚ä½†æ˜¯æœ‰ä¸€ç‚¹å¾ˆé‡è¦ï¼Œå­ç±»åªèƒ½åœ¨è‡ªå·±çš„ä½œç”¨èŒƒå›´å†…è®¿é—®è‡ªå·±ç»§æ‰¿çš„é‚£ä¸ªçˆ¶ç±»protectedåŸŸï¼Œè€Œæ— æ³•åˆ°è®¿é—®åˆ«çš„å­ç±»ï¼ˆåŒçˆ¶ç±»çš„äº²å…„å¼Ÿï¼‰æ‰€ç»§æ‰¿çš„protectedåŸŸå’Œçˆ¶ç±»å¯¹è±¡çš„protectedåŸŸ</p><h2 id="å®ç°Serlizableæ¥å£çš„ç±»ä¸­UIDæ˜¯å•¥ï¼Ÿ">å®ç°Serlizableæ¥å£çš„ç±»ä¸­UIDæ˜¯å•¥ï¼Ÿ</h2><p>javaåºåˆ—åŒ–æœºåˆ¶ã€‚ç®€å•æ¥è¯´ï¼ŒJAVAåºåˆ—åŒ–çš„æœºåˆ¶æ˜¯é€šè¿‡ åˆ¤æ–­ç±»çš„serialVersionUIDæ¥éªŒè¯çš„ç‰ˆæœ¬ä¸€è‡´çš„ã€‚åœ¨è¿›è¡Œååºåˆ—åŒ–æ—¶ï¼ŒJVMä¼šæŠŠä¼ æ¥çš„å­—èŠ‚æµä¸­çš„serialVersionUIDäºæœ¬åœ°ç›¸åº”å®ä½“ç±»çš„serialVersionUIDè¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœç›¸åŒè¯´æ˜æ˜¯ä¸€è‡´çš„ï¼Œå¯ä»¥è¿›è¡Œååºåˆ—åŒ–ï¼Œå¦åˆ™ä¼šå‡ºç°ååºåˆ—åŒ–ç‰ˆæœ¬ä¸€è‡´çš„å¼‚å¸¸ï¼Œå³æ˜¯InvalidCastException</p><p>æ˜¾ç¤ºå£°æ˜serialVersionUIDå¯ä»¥é¿å…å¯¹è±¡ä¸ä¸€è‡´ï¼Œ</p><h2 id="equals-å’Œ-hascodeæ–¹æ³•">equals å’Œ hascodeæ–¹æ³•</h2><h3 id="ä¸ºä»€ä¹ˆè¦é‡å†™">ä¸ºä»€ä¹ˆè¦é‡å†™</h3><p>å…¬å¼ï¼š</p><p>hashcodeç›¸ç­‰æ—¶å†…å®¹ä¸ä¸€å®šç›¸ç­‰</p><p>equalsç›¸ç­‰æ—¶hashcodeå¿…é¡»ç›¸ç­‰</p><p>hashmap å­˜å…¥è‡ªå®šä¹‰ç±»æ—¶å¼•å‘çš„é—®é¢˜</p><p>æƒ³ç”¨è¡¨é¢ä¸€æ ·çš„ä¸¤æŠŠé’¥åŒ™å»å¼€åŒä¸€æ‰‡é—¨çš„é—®é¢˜</p><h3 id="hashcodeæ–¹æ³•å¦‚ä½•é‡å†™">hashcodeæ–¹æ³•å¦‚ä½•é‡å†™</h3><p>åˆ°åº•è¦æ¯”è¾ƒä»€ä¹ˆå±æ€§æˆ–è€…å¯¹è±¡</p><h3 id="equalsæ–¹æ³•å¦‚ä½•é‡å†™">equalsæ–¹æ³•å¦‚ä½•é‡å†™</h3><p>hashå€¼ç›¸åŒæ—¶ï¼Œç”±äºä½  hashmapåˆ¤æ–­é“¾è¡¨æ—¶ï¼Œhashå€¼ä¼šç”¨equals æ–¹æ³•æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡ï¼Œ æ‰€ä»¥å¦‚æœè¦å¼€é”ï¼Œè¿™é‡Œå°±éœ€è¦é‡å†™equalsæ–¹æ³•</p><p>Objectç±»åŸç”Ÿçš„equalsæ–¹æ³•å°±æ˜¯åˆ¤æ–­åœ°å€ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦é‡å†™</p><h3 id="Stringç±»çš„equals">Stringç±»çš„equals</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> anObject<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">//å†…å­˜åœ°å€ç›¸ç­‰</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>anObject <span class="token keyword">instanceof</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> anotherString <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span>anObject<span class="token punctuation">;</span>    <span class="token keyword">int</span> n <span class="token operator">=</span> value<span class="token punctuation">.</span>length<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> anotherString<span class="token punctuation">.</span>value<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">//æ¯”è¾ƒå­—ç¬¦ä¸²é•¿åº¦</span>        <span class="token keyword">char</span> v1<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>        <span class="token keyword">char</span> v2<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> anotherString<span class="token punctuation">.</span>value<span class="token punctuation">;</span>        <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>n<span class="token operator">--</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">//é€ä¸€æ¯”è¾ƒå­—ç¬¦</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>v1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> v2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            i<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span></code></pre></div><h2 id="AbstrackStringBuilder">AbstrackStringBuilder</h2><p>æ„æˆ</p><p>char[] value , int count</p><h3 id="StringBuilder">StringBuilder</h3><p>static final long serialVersionUID = 4383685877147921099L;</p><p>åŒºåˆ† length() å’Œ capacity()</p><ul><li><p>capacityå¤§å°å¹¶ä¸æ˜¯2çš„å¹‚æ¬¡æ–¹</p></li><li><p>é»˜è®¤16é•¿åº¦ï¼Œåappendå¤šå°‘ï¼Œå°±åŠ å¤šå°‘ 16 æ˜¯é»˜è®¤é¢„ç•™çš„è¾“å…¥é•¿åº¦é—´éš”ï¼Œè¶…è¿‡16åˆ™å¼•èµ·æ‰©å®¹</p></li><li><p>å®¹é‡åˆ¤æ–­  ensureCapacityInternal(int minimumCapacity)</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ensureCapacityInternal</span><span class="token punctuation">(</span><span class="token keyword">int</span> minimumCapacity<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// mini--- all words</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>minimumCapacity <span class="token operator">-</span> value<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        value <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span>                <span class="token function">newCapacity</span><span class="token punctuation">(</span>minimumCapacity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div></li><li><p>æ‰©å®¹æœºåˆ¶</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">newCapacity</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// why add 2 ?</span>    <span class="token comment">//è¿™é‡Œä¹Ÿå°±è¯´æ˜äº†ä¸ºä»€ä¹ˆcapacityä¸ºä»€ä¹ˆä¸æ˜¯2çš„å¹‚æ¬¡æ–¹çš„é—®é¢˜äº†</span>    <span class="token keyword">int</span> newCapacity <span class="token operator">=</span> <span class="token punctuation">(</span>value<span class="token punctuation">.</span>length <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>newCapacity <span class="token operator">-</span> minCapacity <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        newCapacity <span class="token operator">=</span> minCapacity<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>newCapacity <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span> MAX_ARRAY_SIZE <span class="token operator">-</span> newCapacity <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token operator">?</span> <span class="token function">hugeCapacity</span><span class="token punctuation">(</span>minCapacity<span class="token punctuation">)</span>        <span class="token operator">:</span> newCapacity<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">hugeCapacity</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE <span class="token operator">-</span> minCapacity <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// overflow</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">OutOfMemoryError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>minCapacity <span class="token operator">></span> MAX_ARRAY_SIZE<span class="token punctuation">)</span>        <span class="token operator">?</span> minCapacity <span class="token operator">:</span> MAX_ARRAY_SIZE<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div></li><li><p>æ ¸å¿ƒæ·»åŠ æ–¹æ³•</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token comment">//String ç±»ä¸‹çš„</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">getChars</span><span class="token punctuation">(</span><span class="token keyword">int</span> srcBegin<span class="token punctuation">,</span> <span class="token keyword">int</span> srcEnd<span class="token punctuation">,</span> <span class="token keyword">char</span> dst<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> dstBegin<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>srcBegin <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">StringIndexOutOfBoundsException</span><span class="token punctuation">(</span>srcBegin<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>srcEnd <span class="token operator">></span> value<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">StringIndexOutOfBoundsException</span><span class="token punctuation">(</span>srcEnd<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>srcBegin <span class="token operator">></span> srcEnd<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">StringIndexOutOfBoundsException</span><span class="token punctuation">(</span>srcEnd <span class="token operator">-</span> srcBegin<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token comment">//æ ¸å¿ƒ</span>        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> srcBegin<span class="token punctuation">,</span> dst<span class="token punctuation">,</span> dstBegin<span class="token punctuation">,</span> srcEnd <span class="token operator">-</span> srcBegin<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div></li></ul><p>è¿½é—®ï¼Ÿ æœ‰äº†è§£è¿‡åº•å±‚çš„arraycopyæ–¹æ³•å—ï¼Ÿ</p><h3 id="StringBuffer">StringBuffer</h3><p>ç»“æ„ï¼š transient char[]  toStringCache , static final long serialVersionUId</p><h4 id="ä¸ºä½•æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ">ä¸ºä½•æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ</h4><p>ä½¿ç”¨synchronized</p><h2 id="æ¥å£ã€ç»§æ‰¿ã€æ³›å‹">æ¥å£ã€ç»§æ‰¿ã€æ³›å‹</h2><p>å¦‚ä½•çœ‹å¾…æ¥å£å’ŒæŠ½è±¡ç±»ï¼Ÿ</p><p>ä½ æ€ä¹ˆç†è§£æ³›å‹ï¼Ÿæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</p><h2 id="æ·±å…¥Synchronized">æ·±å…¥Synchronized</h2><p><strong>Javaä¸­çš„é”ç±»å‹</strong></p><p>å¯é‡å…¥é”ã€å…¬å¹³é”ã€äº’æ–¥é”ã€è‡ªæ—‹é”ã€åå‘é”ã€è½»é‡çº§é”ã€è¯»å†™é”ã€å…±äº«é”</p><p>ReentrantLock åŠ é”åŸç†ï¼š æ›´æ”¹æ ‡è¯†ç¬¦çš„å€¼</p><p>synchronized åˆ°åº•æ”¹å˜çš„æ˜¯å¯¹è±¡çš„ä»€ä¹ˆå±æ€§ï¼Ÿï¼Ÿï¼Ÿ</p><p><strong>å¯¹è±¡å¤´</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307090828271.png" alt="image-20210307090828271"></p><p><strong>éšå¼</strong></p><p>synchronizedæ–¹æ³• monitorexit</p><p>JVMå¯ä»¥ä»æ–¹æ³•å¸¸é‡æ± ä¸­çš„æ–¹æ³•è¡¨ç»“æ„(method_info Structure) ä¸­çš„ ACC_SYNCHRONIZED è®¿é—®æ ‡å¿—åŒºåˆ†ä¸€ä¸ªæ–¹æ³•æ˜¯å¦åŒæ­¥æ–¹æ³•</p><p>å½“æ–¹æ³•è°ƒç”¨æ—¶ï¼Œè°ƒç”¨æŒ‡ä»¤å°†ä¼š æ£€æŸ¥æ–¹æ³•çš„ ACC_SYNCHRONIZED è®¿é—®æ ‡å¿—æ˜¯å¦è¢«è®¾ç½®ï¼Œå¦‚æœè®¾ç½®äº†ï¼Œæ‰§è¡Œçº¿ç¨‹å°†å…ˆæŒæœ‰monitorï¼ˆè™šæ‹Ÿæœºè§„èŒƒä¸­ç”¨çš„æ˜¯ç®¡ç¨‹ä¸€è¯ï¼‰ï¼Œ ç„¶åå†æ‰§è¡Œæ–¹æ³•ï¼Œæœ€åå†æ–¹æ³•å®Œæˆ(æ— è®ºæ˜¯æ­£å¸¸å®Œæˆè¿˜æ˜¯éæ­£å¸¸å®Œæˆ)æ—¶é‡Šæ”¾monitor</p><p><strong>ä¸ºä½•classæ–‡ä»¶ä¼šæœ‰ä¸¤ä¸ªmonitorexit</strong></p><p>synchronizedä»£ç å—  ä¼šæœ‰monitorenterâ€¦</p><p>ä¸ºäº†ä¿è¯åœ¨æ–¹æ³•å¼‚å¸¸å®Œæˆæ—¶ monitorenter å’Œ monitorexit æŒ‡ä»¤ä¾ç„¶å¯ä»¥æ­£ç¡®é…å¯¹æ‰§è¡Œï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨äº§ç”Ÿä¸€ä¸ªå¼‚å¸¸å¤„ç†å™¨ï¼Œè¿™ä¸ªå¼‚å¸¸å¤„ç†å™¨å£°æ˜å¯å¤„ç†æ‰€æœ‰çš„å¼‚å¸¸ï¼Œå®ƒçš„ç›®çš„å°±æ˜¯ç”¨æ¥æ‰§è¡Œ monitorexit æŒ‡ä»¤ã€‚ä»å­—èŠ‚ç ä¸­ä¹Ÿå¯ä»¥çœ‹å‡ºå¤šäº†ä¸€ä¸ªmonitorexitæŒ‡ä»¤ï¼Œå®ƒå°±æ˜¯å¼‚å¸¸ç»“æŸæ—¶è¢«æ‰§è¡Œçš„é‡Šæ”¾monitor çš„æŒ‡ä»¤ã€‚</p><p><strong>ä¸ºä»€ä¹ˆæ—©æœŸæ˜¯é‡é‡çº§é”</strong></p><p>åŒæ—¶æˆ‘ä»¬è¿˜å¿…é¡»æ³¨æ„åˆ°çš„æ˜¯åœ¨Javaæ—©æœŸç‰ˆæœ¬ä¸­ï¼Œsynchronizedå±äºé‡é‡çº§é”ï¼Œæ•ˆç‡ä½ä¸‹ï¼Œå› ä¸ºç›‘è§†å™¨é”ï¼ˆmonitorï¼‰æ˜¯ä¾èµ–äºåº•å±‚çš„æ“ä½œç³»ç»Ÿçš„Mutex Lockæ¥å®ç°çš„ï¼Œè€Œæ“ä½œç³»ç»Ÿå®ç°çº¿ç¨‹ä¹‹é—´çš„åˆ‡æ¢æ—¶éœ€è¦ä»ç”¨æˆ·æ€è½¬æ¢åˆ°æ ¸å¿ƒæ€ï¼Œè¿™ä¸ªçŠ¶æ€ä¹‹é—´çš„è½¬æ¢éœ€è¦ç›¸å¯¹æ¯”è¾ƒé•¿çš„æ—¶é—´ï¼Œæ—¶é—´æˆæœ¬ç›¸å¯¹è¾ƒé«˜</p><h3 id="JVMå¯¹é”çš„ä¼˜åŒ–"><strong>JVMå¯¹é”çš„ä¼˜åŒ–</strong></h3><p>é”çš„å‡çº§ï¼š æ— é”â€“åå‘â€“è½»é‡â€“é‡é‡</p><p><strong>åå‘é”</strong></p><p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œé”ä¸ä»…ä¸å­˜åœ¨å¤šçº¿ç¨‹ç«äº‰ï¼Œè€Œä¸”æ€»æ˜¯ç”±åŒä¸€çº¿ç¨‹å¤šæ¬¡è·å¾—ï¼Œå› æ­¤ä¸ºäº†å‡å°‘åŒä¸€çº¿ç¨‹è·å–é”(ä¼šæ¶‰åŠåˆ°ä¸€äº›CASæ“ä½œ,è€—æ—¶)çš„ä»£ä»·è€Œå¼•å…¥åå‘é”ã€‚åå‘é”çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹è·å¾—äº†é”ï¼Œé‚£ä¹ˆé”å°±è¿›å…¥åå‘æ¨¡å¼ï¼Œæ­¤æ—¶Mark Word çš„ç»“æ„ä¹Ÿå˜ä¸ºåå‘é”ç»“æ„ï¼Œå½“è¿™ä¸ªçº¿ç¨‹å†æ¬¡è¯·æ±‚é”æ—¶ï¼Œæ— éœ€å†åšä»»ä½•åŒæ­¥æ“ä½œï¼Œå³è·å–é”çš„è¿‡ç¨‹ï¼Œè¿™æ ·å°±çœå»äº†å¤§é‡æœ‰å…³é”ç”³è¯·çš„æ“ä½œï¼Œä»è€Œä¹Ÿå°±æä¾›ç¨‹åºçš„æ€§èƒ½ã€‚æ‰€ä»¥ï¼Œå¯¹äºæ²¡æœ‰é”ç«äº‰çš„åœºåˆï¼Œåå‘é”æœ‰å¾ˆå¥½çš„ä¼˜åŒ–æ•ˆæœï¼Œæ¯•ç«Ÿææœ‰å¯èƒ½è¿ç»­å¤šæ¬¡æ˜¯åŒä¸€ä¸ªçº¿ç¨‹ç”³è¯·ç›¸åŒçš„é”ã€‚ä½†æ˜¯å¯¹äºé”ç«äº‰æ¯”è¾ƒæ¿€çƒˆçš„åœºåˆï¼Œåå‘é”å°±å¤±æ•ˆäº†ï¼Œå› ä¸ºè¿™æ ·åœºåˆææœ‰å¯èƒ½æ¯æ¬¡ç”³è¯·é”çš„çº¿ç¨‹éƒ½æ˜¯ä¸ç›¸åŒçš„ï¼Œå› æ­¤è¿™ç§åœºåˆä¸‹ä¸åº”è¯¥ä½¿ç”¨åå‘é”ï¼Œå¦åˆ™ä¼šå¾—ä¸å¿å¤±ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåå‘é”å¤±è´¥åï¼Œå¹¶ä¸ä¼šç«‹å³è†¨èƒ€ä¸ºé‡é‡çº§é”ï¼Œè€Œæ˜¯å…ˆå‡çº§ä¸ºè½»é‡çº§é”</p><p><strong>è½»é‡çº§é”</strong></p><p>å€˜è‹¥åå‘é”å¤±è´¥ï¼Œè™šæ‹Ÿæœºå¹¶ä¸ä¼šç«‹å³å‡çº§ä¸ºé‡é‡çº§é”ï¼Œå®ƒè¿˜ä¼šå°è¯•ä½¿ç”¨ä¸€ç§ç§°ä¸ºè½»é‡çº§é”çš„ä¼˜åŒ–æ‰‹æ®µ(1.6ä¹‹ååŠ å…¥çš„)ï¼Œæ­¤æ—¶Mark Word çš„ç»“æ„ä¹Ÿå˜ä¸ºè½»é‡çº§é”çš„ç»“æ„ã€‚è½»é‡çº§é”èƒ½å¤Ÿæå‡ç¨‹åºæ€§èƒ½çš„ä¾æ®æ˜¯â€œå¯¹ç»å¤§éƒ¨åˆ†çš„é”ï¼Œåœ¨æ•´ä¸ªåŒæ­¥å‘¨æœŸå†…éƒ½ä¸å­˜åœ¨ç«äº‰â€ï¼Œæ³¨æ„è¿™æ˜¯ç»éªŒæ•°æ®ã€‚éœ€è¦äº†è§£çš„æ˜¯ï¼Œè½»é‡çº§é”æ‰€é€‚åº”çš„åœºæ™¯æ˜¯çº¿ç¨‹äº¤æ›¿æ‰§è¡ŒåŒæ­¥å—çš„åœºåˆï¼Œå¦‚æœå­˜åœ¨åŒä¸€æ—¶é—´è®¿é—®åŒä¸€é”çš„åœºåˆï¼Œå°±ä¼šå¯¼è‡´è½»é‡çº§é”è†¨èƒ€ä¸ºé‡é‡çº§é”ã€‚</p><p><strong>è‡ªæ—‹é”</strong></p><p>è½»é‡çº§é”å¤±è´¥åï¼Œè™šæ‹Ÿæœºä¸ºäº†é¿å…çº¿ç¨‹çœŸå®åœ°åœ¨æ“ä½œç³»ç»Ÿå±‚é¢æŒ‚èµ·ï¼Œè¿˜ä¼šè¿›è¡Œä¸€é¡¹ç§°ä¸ºè‡ªæ—‹é”çš„ä¼˜åŒ–æ‰‹æ®µã€‚è¿™æ˜¯åŸºäºåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œçº¿ç¨‹æŒæœ‰é”çš„æ—¶é—´éƒ½ä¸ä¼šå¤ªé•¿ï¼Œå¦‚æœç›´æ¥æŒ‚èµ·æ“ä½œç³»ç»Ÿå±‚é¢çš„çº¿ç¨‹å¯èƒ½ä¼šå¾—ä¸å¿å¤±ï¼Œæ¯•ç«Ÿæ“ä½œç³»ç»Ÿå®ç°çº¿ç¨‹ä¹‹é—´çš„åˆ‡æ¢æ—¶éœ€è¦ä»ç”¨æˆ·æ€è½¬æ¢åˆ°æ ¸å¿ƒæ€ï¼Œè¿™ä¸ªçŠ¶æ€ä¹‹é—´çš„è½¬æ¢éœ€è¦ç›¸å¯¹æ¯”è¾ƒé•¿çš„æ—¶é—´ï¼Œæ—¶é—´æˆæœ¬ç›¸å¯¹è¾ƒé«˜ï¼Œå› æ­¤è‡ªæ—‹é”ä¼šå‡è®¾åœ¨ä¸ä¹…å°†æ¥ï¼Œå½“å‰çš„çº¿ç¨‹å¯ä»¥è·å¾—é”ï¼Œå› æ­¤è™šæ‹Ÿæœºä¼šè®©å½“å‰æƒ³è¦è·å–é”çš„çº¿ç¨‹åšå‡ ä¸ªç©ºå¾ªç¯(è¿™ä¹Ÿæ˜¯ç§°ä¸ºè‡ªæ—‹çš„åŸå› )ï¼Œä¸€èˆ¬ä¸ä¼šå¤ªä¹…ï¼Œå¯èƒ½æ˜¯50ä¸ªå¾ªç¯æˆ–100å¾ªç¯ï¼Œåœ¨ç»è¿‡è‹¥å¹²æ¬¡å¾ªç¯åï¼Œå¦‚æœå¾—åˆ°é”ï¼Œå°±é¡ºåˆ©è¿›å…¥ä¸´ç•ŒåŒºã€‚å¦‚æœè¿˜ä¸èƒ½è·å¾—é”ï¼Œé‚£å°±ä¼šå°†çº¿ç¨‹åœ¨æ“ä½œç³»ç»Ÿå±‚é¢æŒ‚èµ·ï¼Œè¿™å°±æ˜¯è‡ªæ—‹é”çš„ä¼˜åŒ–æ–¹å¼ï¼Œè¿™ç§æ–¹å¼ç¡®å®ä¹Ÿæ˜¯å¯ä»¥æå‡æ•ˆç‡çš„ã€‚æœ€åæ²¡åŠæ³•ä¹Ÿå°±åªèƒ½å‡çº§ä¸ºé‡é‡çº§é”äº†</p><p><strong>é”æ¶ˆé™¤</strong></p><p>avaè™šæ‹Ÿæœºåœ¨JITç¼–è¯‘æ—¶(å¯ä»¥ç®€å•ç†è§£ä¸ºå½“æŸæ®µä»£ç å³å°†ç¬¬ä¸€æ¬¡è¢«æ‰§è¡Œæ—¶è¿›è¡Œç¼–è¯‘ï¼Œåˆç§°å³æ—¶ç¼–è¯‘)ï¼Œé€šè¿‡å¯¹è¿è¡Œä¸Šä¸‹æ–‡çš„æ‰«æï¼Œå»é™¤ä¸å¯èƒ½å­˜åœ¨å…±äº«èµ„æºç«äº‰çš„é”ï¼Œé€šè¿‡è¿™ç§æ–¹å¼æ¶ˆé™¤æ²¡æœ‰å¿…è¦çš„é”ï¼Œå¯ä»¥èŠ‚çœæ¯«æ— æ„ä¹‰çš„è¯·æ±‚é”æ—¶é—´ï¼Œå¦‚ä¸‹StringBufferçš„appendæ˜¯ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œä½†æ˜¯åœ¨addæ–¹æ³•ä¸­çš„StringBufferå±äºä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œå¹¶ä¸”ä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹æ‰€ä½¿ç”¨ï¼Œå› æ­¤StringBufferä¸å¯èƒ½å­˜åœ¨å…±äº«èµ„æºç«äº‰çš„æƒ…æ™¯ï¼ŒJVMä¼šè‡ªåŠ¨å°†å…¶é”æ¶ˆé™¤</p><h3 id="è‡ªæ—‹é”">è‡ªæ—‹é”</h3><p>CAS   æ²¡æœ‰è·å–åˆ°é”çš„çº¿ç¨‹æ˜¯ä¸ä¼šé˜»å¡çš„ï¼Œè¦é€šè¿‡æ§åˆ¶å¾ªç¯å€¼ä¸æ–­è·å–</p><p>3ä¸ªæ“ä½œæ•°  å†…å­˜å€¼ Vï¼ˆå…±äº«ï¼‰ æ—§çš„é¢„æœŸå€¼Eï¼ˆç¼“å­˜ï¼‰ è¦ä¿®æ”¹çš„æ–°å€¼Nï¼Œä»…å½“E == Næ—¶ï¼Œæ‰ä¼šä¿®æ”¹  E!=Næ—¶ï¼Œåˆ™å†æ¬¡æŸ¥è¯¢ä¸»å­˜ä¸­çš„V ä½¿ E == N</p><p>åº•å±‚ï¼šç¡¬ä»¶</p><h2 id="ä¸‰å¤§ç‰¹æ€§">ä¸‰å¤§ç‰¹æ€§</h2><h3 id="åŸå­æ€§">åŸå­æ€§</h3><p>ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ“ä½œåœ¨CPUæ‰§è¡Œçš„è¿‡ç¨‹ä¸­ä¸è¢«ä¸­æ–­çš„ç‰¹æ€§</p><h4 id="å¯è§æ€§">å¯è§æ€§</h4><p>ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹ä¸€ä¸ªå˜é‡åï¼Œå…¶ä»–çº¿ç¨‹èƒ½å¤Ÿç«‹å³å¾—çŸ¥è¿™ä¸ªä¿®æ”¹</p><p>å„è‡ªçš„çº¿ç¨‹æœ‰å…¶å·¥ä½œå†…å­˜ï¼Œå³ä¿å­˜æ—¶çš„å‰¯æœ¬å­˜å‚¨çš„ç©ºé—´</p><h4 id="æœ‰åºæ€§">æœ‰åºæ€§</h4><p>ä»£ç çš„æ‰§è¡Œé¡ºåº</p><p>ç¼–è¯‘å™¨ å’Œ å¤„ç†å™¨æ‰§è¡ŒæŒ‡ä»¤æ—¶ä¼šè¿›è¡Œä»æ’åºï¼Œæ”¹å˜è¯­åº   è¿™é‡Œ<strong>æ³¨æ„ä»€ä¹ˆæ—¶å€™èƒ½æ”¹ä»€ä¹ˆæ—¶å€™ä¸èƒ½æ”¹ï¼</strong></p><h3 id="Volatile">Volatile</h3><ol><li><p>ä¿è¯ä¸åŒçº¿ç¨‹å¯¹å˜é‡æ“ä½œçš„å†…å­˜å¯è§æ€§ï¼ˆä¿®æ”¹å˜é‡ç›´æ¥åˆ·æ–°å›ä¸»å­˜ï¼‰ï¼Œä½¿ç¼“å­˜è¡Œæ— æ•ˆ</p></li><li><p><strong>ç¦æ­¢æŒ‡ä»¤é‡æ’åº</strong>   æ³¨æ„æ˜¯å¹¶ä¸æ˜¯å®Œå…¨å°±æ˜¯ä¸€æ ·çš„é¡ºåºï¼Œåªä¿è¯å…ˆåé¡ºåº</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210313233725385.png" alt="image-20210313233725385"></p></li></ol><h4 id="happens-before-åŸåˆ™">happens - before åŸåˆ™</h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210313233650045.png" alt="image-20210313233650045"></p><h4 id="volatile-åˆ°åº•é”ä»€ä¹ˆï¼Ÿ">volatile åˆ°åº•é”ä»€ä¹ˆï¼Ÿ</h4><h4 id="ä¸ºä»€ä¹ˆä¸èƒ½ä¿è¯-count-åŸå­æ€§ï¼Ÿ">ä¸ºä»€ä¹ˆä¸èƒ½ä¿è¯ count++ åŸå­æ€§ï¼Ÿ</h4><p>å•ä¸ªå˜é‡çš„è¯»å†™ å…·æœ‰åŸå­æ€§</p><p>ä½†å¤åˆæ“ä½œåˆ™ä¸è¡Œ</p><p>åº•å±‚æœºåˆ¶ï¼šå†…å­˜å±éšœ</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210313233706649.png" alt="image-20210313233706649"></p><p>ä½¿ç”¨ ï¼š çŠ¶æ€æ ‡è®°ã€å•ä¾‹æ¨¡å¼</p><h3 id="JUC">JUC</h3><h4 id="é—®é¢˜-v2">é—®é¢˜</h4><h5 id="synchronizedåˆ°åº•æ˜¯ä»€ä¹ˆ-åŸç†ï¼Ÿ">synchronizedåˆ°åº•æ˜¯ä»€ä¹ˆ  åŸç†ï¼Ÿ</h5><p>synchronizedæ˜¯ä¸€ä¸ªé‡é‡çº§é”ï¼Œå®ç°ä¾èµ–äºJVM çš„ monitor ç›‘è§†å™¨é”ã€‚ä¸»è¦ä½¿ç”¨monitorenterå’ŒmonitorexitæŒ‡ä»¤æ¥å®ç°æ–¹æ³•åŒæ­¥å’Œä»£ç å—åŒæ­¥ã€‚åœ¨ç¼–è¯‘çš„æ˜¯æ—¶å€™ï¼Œä¼šå°†monitorexitæŒ‡ä»¤æ’å…¥åˆ°åŒæ­¥ä»£ç å—çš„å¼€å§‹ä½ç½®ï¼Œè€Œmonitorexitæ’å…¥æ–¹æ³•ç»“æŸå¤„å’Œå¼‚å¸¸å¤„ï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªmonitorexitéƒ½æœ‰ä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„monitorexitã€‚</p><p><strong>ä»»ä½•å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªmonitorä¸ä¹‹å…³è”</strong>ï¼Œå½“ä¸€ä¸ªmonitorè¢«æŒæœ‰åï¼Œå®ƒå°†è¢«å¤„äºé”å®šçŠ¶æ€ï¼Œçº¿ç¨‹æ‰§è¡Œåˆ°monitorenteræŒ‡ä»¤æ—¶é—´ï¼Œä¼š<strong>å°è¯•è·å–å¯¹è±¡æ‰€å¯¹åº”çš„monitorçš„æ‰€æœ‰æƒ</strong>ï¼Œå³è·å–è·å¾—å¯¹è±¡çš„é”ï¼Œç”±äºåœ¨ç¼–è¯‘æœŸä¼šå°†monitorexitæ’å…¥åˆ°æ–¹æ³•ç»“æŸå¤„å’Œå¼‚å¸¸å¤„ï¼Œæ‰€ä»¥åœ¨æ–¹æ³•æ‰§è¡Œå®Œæ¯•æˆ–è€…å‡ºç°å¼‚å¸¸çš„æƒ…å†µä¼šè‡ªåŠ¨é‡Šæ”¾é”</p><h4 id="é”">é”</h4><p>ç»“æ„  å¯é‡å…¥é” è¯»é” å†™é”</p><p>å°†å¤§çš„æ–¹æ³•åŠ å…¥åŒæ­¥é”ä¼šå½±å“æ‰§è¡Œæ•ˆç‡</p><p>sleep æŠ±ç€é”ç¡è§‰</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210303172037854.png" alt="image-20210303172037854"></p><h5 id="é”åˆ°åº•é”ä»€ä¹ˆ">é”åˆ°åº•é”ä»€ä¹ˆ</h5><p>synchronized é»˜è®¤é”çš„æ˜¯this  æ–¹æ³•çš„è°ƒç”¨è€…</p><p>â€‹    ä½†æ˜¯this ä¸­çš„å¯¹è±¡åˆ™ä¸èƒ½åŒæ­¥ ï¼Œè¦åŒæ­¥å“ªä¸ªå¯¹è±¡ å°±é”å“ªä¸ª</p><h5 id="æ­»é”">æ­»é”</h5><p><strong>ä¸¤ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹åœ¨ç­‰å¾…å¯¹æ–¹é‡Šæ”¾èµ„æºï¼›æŸä¸ªåŒæ­¥å—åŒæ—¶æ‹¥æœ‰ä¸¤ä¸ªä»¥ä¸Šå¯¹è±¡çš„é”</strong></p><p>äº§ç”Ÿæ­»é”çš„æ¡ä»¶<br>1.äº’æ–¥æ¡ä»¶ï¼šä¸€ä¸ªèµ„æºæ¯æ¬¡åªèƒ½è¢«ä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨ã€‚<br>2.è¯·æ±‚ä¸ä¿æŒæ¡ä»¶ï¼šä¸€ä¸ªè¿›ç¨‹å› è¯·æ±‚èµ„æºè€Œé˜»å¡æ—¶ï¼Œå¯¹å·²è·å¾—çš„èµ„æºä¿æŒä¸æ”¾ã€‚<br>3.ä¸å‰¥å¤ºæ¡ä»¶:è¿›ç¨‹å·²è·å¾—çš„èµ„æºï¼Œåœ¨æœ«ä½¿ç”¨å®Œä¹‹å‰ï¼Œä¸èƒ½å¼ºè¡Œå‰¥å¤ºã€‚<br>4.å¾ªç¯ç­‰å¾…æ¡ä»¶:è‹¥å¹²è¿›ç¨‹ä¹‹é—´å½¢æˆä¸€ç§å¤´å°¾ç›¸æ¥çš„å¾ªç¯ç­‰å¾…èµ„æºå…³ç³»ã€‚</p><h4 id="Synchronizedå’ŒLockçš„åŒºåˆ«">Synchronizedå’ŒLockçš„åŒºåˆ«</h4><ul><li>Lockå¯ä»¥åˆ¤æ–­æ˜¯å¦è·å–åˆ°äº†é”</li><li>lockå¿…é¡»è¦æ‰‹åŠ¨é‡Šæ”¾ï¼Œå¦‚æœä¸é‡Šæ”¾é”ï¼Œåˆ™å‡ºç°æ­»é”</li><li>Lockä¸ä¸€å®šä¼šç­‰å¾…ä¸‹å»</li><li>å¯é‡å…¥é”ï¼Œä¸å¯ä¸­æ–­ï¼Œéå…¬å¹³</li><li>Locké€‚åˆé”å¤§é‡çš„ä»£ç </li></ul><h4 id="è™šå‡å”¤é†’">è™šå‡å”¤é†’</h4><p>ç­‰å¾…åº”è¯¥æ€»æ˜¯åœ¨å¾ªç¯ä¸­</p><p>åµŒå¥—çš„synè¯­å¥</p><h4 id="Condition">Condition</h4><p>ç²¾å‡†å”¤é†’å’Œåœæ­¢   é¡ºåºå”¤é†’</p><h4 id="â‘§é”é—®é¢˜">â‘§é”é—®é¢˜</h4><h3 id="å‘ä¸‹è½¬å‹å’Œå‘ä¸Šè½¬å‹">å‘ä¸‹è½¬å‹å’Œå‘ä¸Šè½¬å‹</h3><p>å°†æ•´ä¸ªç»§æ‰¿å…³ç³»æƒ³åƒæˆç”±ä¸Šè‡³ä¸‹</p><p>å‘ä¸Šè½¬å‹   å­è½¬çˆ¶ï¼ˆåŒ…æ‹¬æ¥å£ï¼‰ ä¸¢å¤±æ–¹æ³•</p><p>å‘ä¸‹è½¬å‹   çˆ¶è½¬å­   é‡æ–°è·å¾—å¤±å»çš„æ–¹æ³•</p><p>è”æƒ³ ï¼šAndroidä¸­findViewByIdä¸­å°±æ˜¯éœ€è¦å‘ä¸‹è½¬å‹</p><h3 id="è‡ªåŠ¨æ‹†ç®±å’Œè£…ç®±">è‡ªåŠ¨æ‹†ç®±å’Œè£…ç®±</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Integer</span> a <span class="token operator">=</span> <span class="token number">127</span><span class="token punctuation">;</span><span class="token class-name">Integer</span> b <span class="token operator">=</span> <span class="token number">127</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a <span class="token operator">==</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//false </span><span class="token comment">//å­—èŠ‚ç  æ¯”è¾ƒæ—¶æ¶‰åŠåˆ°intValueæ–¹æ³•</span><span class="token comment">//newæ—¶æ¶‰åŠvalueOfæ–¹æ³•</span></code></pre></div><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> value<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Integer</span> <span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">>=</span> <span class="token class-name">IntegerCache</span><span class="token punctuation">.</span>low <span class="token operator">&amp;&amp;</span> i <span class="token operator">&lt;=</span> <span class="token class-name">IntegerCache</span><span class="token punctuation">.</span>high<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token class-name">IntegerCache</span><span class="token punctuation">.</span>cache<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token class-name">IntegerCache</span><span class="token punctuation">.</span>low<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Integer</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">IntegerCache</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> low <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">128</span><span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> high<span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Integer</span> cache<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// high value may be configured by property</span>        <span class="token keyword">int</span> h <span class="token operator">=</span> <span class="token number">127</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> integerCacheHighPropValue <span class="token operator">=</span>            sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span>VM<span class="token punctuation">.</span><span class="token function">getSavedProperty</span><span class="token punctuation">(</span><span class="token string">"java.lang.Integer.IntegerCache.high"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å¯ä»¥è‡ªè¡Œè®¾ç½®maxçš„æœ€å¤§å€¼</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>integerCacheHighPropValue <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>integerCacheHighPropValue<span class="token punctuation">)</span><span class="token punctuation">;</span>                i <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// Maximum array size is Integer.MAX_VALUE</span>                h <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token operator">-</span>low<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span><span class="token punctuation">(</span> <span class="token class-name">NumberFormatException</span> nfe<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">// If the property cannot be parsed into an int, ignore it.</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        high <span class="token operator">=</span> h<span class="token punctuation">;</span>        cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Integer</span><span class="token punctuation">[</span><span class="token punctuation">(</span>high <span class="token operator">-</span> low<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> j <span class="token operator">=</span> low<span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> cache<span class="token punctuation">.</span>length<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span>            cache<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Integer</span><span class="token punctuation">(</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// range [-128, 127] must be interned (JLS7 5.1.7)</span>        <span class="token keyword">assert</span> <span class="token class-name">IntegerCache</span><span class="token punctuation">.</span>high <span class="token operator">>=</span> <span class="token number">127</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token class-name">IntegerCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p>æ¶‰åŠåˆ°çš„é™æ€å†…éƒ¨ç±»çš„çŸ¥è¯†</p><p>é™æ€å†…éƒ¨ç±»åªä¼šåœ¨ä½¿ç”¨åˆ°è¯¥å†…éƒ¨ç±»æ—¶æ‰ä¼šåŠ è½½ï¼Œå¦åˆ™æ˜¯ä¸ä¼šåŠ è½½çš„ï¼Œä¹Ÿå°±æ˜¯åªæœ‰ä½¿ç”¨åˆ°new Integerçš„valueOfæ–¹æ³•æ—¶ï¼Œæ‰ä¼šåŠ è½½è¯¥å†…éƒ¨ç±»</p><h2 id="çº¿ç¨‹">çº¿ç¨‹</h2><h3 id="Callableå’ŒRunnable"><strong>Callableå’ŒRunnable</strong></h3><p>callableå¯ä»¥æœ‰hè¿”å›å­ï¼Œä¸”å¯ä»¥æŠ›å‡ºå¼‚å¸¸</p><p>Callable.callï¼ˆï¼‰ ä¼šè°ƒç”¨è¯¥çº¿ç¨‹ï¼Œé˜»å¡ç­‰å¾…ç»“æœ</p><h3 id="Future"><strong>Future</strong></h3><p>futureiæä¾›äº†äº”ä¸ªæ–¹æ³•ï¼Œç”¨äºcancel  isCancel isDone</p><p>get   get(timeout)</p><p><strong>Threadåªæ”¯æŒRunnableæ¥å£</strong></p><p>é€šè¿‡çº¿ç¨‹æ± æ–¹å¼ï¼Œsubmitä¸€ä¸ªcallable ï¼ŒåŒæ—¶çº¿ç¨‹æ± ä¹Ÿiæ”¯æŒrunnableå½¢å¼ï¼Œä¹Ÿä¸€ä¸ª æ”¯æŒrunnbale çš„ è¿”å›ä¸€ä¸ªfuture</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210428192019015.png" alt="image-20210428192019015"></p><h3 id="FutureTask">FutureTask</h3><p>futureTaskå®ç°äº†runnableå’Œcallableæ¥å£</p><p>ç›´æ¥è°ƒç”¨futuretaskçš„getæ–¹æ³•ï¼Œä¼šä¸€ç›´é˜»å¡  ä¸ºä»€ä¹ˆä¸€ç›´aé˜»å¡ï¼Ÿ</p><p>FutureTask get ä¸­æ¶‰åŠçš„æ–¹æ³•æœ‰æ­»å¾ªç¯</p><p>futuretaskå¿…é¡»æ”¾åœ¨threadä¸­ ï¼Œstartåæ‰èƒ½è¿›è¡Œisdoneç­‰çš„æ“ä½œ</p><p>ï¼ˆå¦‚ä½•åˆ¤æ–­isDone isCancel   ï¼Ÿ  çŠ¶æ€é‡ï¼‰</p><p>threadpoolæ— æ³•æ‰§è¡Œfutuetask,ä¼šè¿”å›null</p><p><strong>ä½†æ˜¯</strong></p><p>å…¶å®executor.submit a Future å…¶å®ä¹Ÿæ˜¯è·‘äº†ä¸€ä¸ªfuturetask</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> task<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>task <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">RunnableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">></span></span> ftask <span class="token operator">=</span> <span class="token function">newTaskFor</span><span class="token punctuation">(</span>task<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¿”å›ä¸€ä¸ªfuturetask</span>        <span class="token function">execute</span><span class="token punctuation">(</span>ftask<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> ftask<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p><strong>å»¶ä¼¸</strong></p><p>Thread.startå¦‚ä½•å¯åŠ¨ï¼ŸThreadgroupï¼Ÿ</p><h2 id="æ³›å‹">æ³›å‹</h2><p><strong>ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦æ³›å‹ï¼Ÿ</strong></p><p>æ²¡æœ‰æ³›å‹ä¹‹å‰æˆ‘ä»¬æ˜¯æ€ä¹ˆåšåˆ°ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡Objectå­˜å‚¨ä»»æ„çš„å¯¹è±¡ï¼Œç„¶åä½¿ç”¨æ—¶å†å¼ºè½¬æˆå¯¹åº”çš„ç±»å‹å°±è¡Œäº†ï¼ˆä½†å¦‚æœæˆ‘ä»¬ä¸æ¸…æ¥šå¯¹è±¡çš„ç±»å‹ï¼Œé‚£ä¹ˆåœ¨è½¬æ¢æ—¶å°±kennelå‡ºç°ClassCast Exceptionï¼‰</p><p>Javaæ³›å‹Genericsæ˜¯JDK5ä¸­å¼•å…¥çš„æ–°ç‰¹æ€§ï¼Œ<strong>æä¾›äº†ç¼–è¯‘æ—¶ç±»å‹å®‰å…¨æ£€æµ‹æœºåˆ¶</strong>ï¼Œå…è®¸æˆ‘ä»¬åœ¨<strong>ç¼–è¯‘æ—¶</strong>æ£€æµ‹éæ³•çš„ç±»å‹æ•°æ®ç»“æ„ã€‚<strong>æ³›å‹çš„æœ¬è´¨å°±æ˜¯å‚æ•°åŒ–ç±»å‹</strong>ï¼Œå³æ‰€æ“ä½œçš„æ•°æ®ç±»å‹è¢«æŒ‡å®šä¸ºä¸€ä¸ªå‚æ•°ã€‚<strong>ä¿è¯äº†ç±»å‹å®‰å…¨ï¼Œå¹¶æ¶ˆé™¤äº†å¼ºåˆ¶ç±»å‹çš„è½¬æ¢</strong></p><p>å¸¸ç”¨æ³›å‹æ ‡è¯† T E K Vï¼Œ<strong>æ³›å‹ç±»ä¸æ”¯æŒåŸºæœ¬æ•°æ®ç±»å‹</strong>ã€‚ä¸ºä»€ä¹ˆï¼Ÿ</p><h3 id="æ³›å‹ç±»">æ³›å‹ç±»</h3><p>åœ¨å®ä¾‹åŒ–ç±»çš„æ—¶å€™æŒ‡æ˜æ³›å‹çš„å…·ä½“ç±»å‹ã€‚æ³›å‹ç±»å¯ä»¥æœ‰å¤šä¸ªæ³›å‹æ ‡è¯†ï¼Œä¸ä¸€å®šæ˜¯1ä¸ªæˆ–2ä¸ª</p><p>åŒä¸€æ³›å‹ç±»ï¼Œæ ¹æ®ä¸åŒçš„æ•°æ®ç±»å‹åˆ›å»ºå¯¹è±¡ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯åŒä¸€ä¸ªç±»å‹ï¼ˆgetClass()ç›¸ç­‰ï¼‰</p><p><strong>æ³›å‹é€šé…ç¬¦</strong>ï¼šç”¨ï¼Ÿä»£æ›¿å…·ä½“ç±»å‹çš„å®é™…å‚æ•°ï¼Œæ‰€ä»¥ç±»å‹é€šé…ç¬¦æ˜¯ç±»å‹å® å‚è€Œä¸æ˜¯ç±»å‹å‹å‚ã€‚é€šå¸¸ç»“åˆä¸Šä¸‹é™æ¥é™åˆ¶æ³›å‹çš„å®ç°ç±»å‹</p><p><strong>ç±»å‹é€šé…ç¬¦çš„ä¸Šé™ï¼š &lt;? extends XXXClass&gt;</strong></p><p>**ç±»å‹é€šé…ç¬¦çš„ä¸‹é™ï¼š&lt;? super xxxx&gt; è¦æ±‚è¯¥æ³›å‹çš„ç±»å‹åªèƒ½æ˜¯å®å‚ç±»å‹æˆ–å®å‚ç±»å‹çš„çˆ¶ç±»å‹ï¼Œä¸‹é™ä¸åœ¨åˆ›å»ºæ³›å‹æ—¶ä½¿ç”¨ **</p><p><strong>æ³›å‹ç±»çš„ç»§æ‰¿</strong></p><p>çˆ¶ç±»æ˜¯æ³›å‹ç±»ï¼š</p><ul><li>å­ç±»æ˜¯æ³›å‹ç±»ï¼Œå­ç±»æ˜¯çˆ¶ç±»çš„æ³›å‹æ ‡è¯†è‡³å°‘è¦åŒ…å«çˆ¶ç±»çš„æ³›å‹æ ‡è¯†</li><li>å­ç±»ä¸æ˜¯æ³›å‹ç±»ï¼Œçˆ¶ç±»è¦æ˜ç¡®æ³›å‹çš„æ•°æ®ç±»å‹</li></ul><h3 id="æ³›å‹æ¥å£">æ³›å‹æ¥å£</h3><ul><li>å®ç°ç±»æ˜¯æ³›å‹ç±»ï¼Œåˆ™å®ç°äº†ç±»çš„æ³›å‹æ ‡è¯†è¦åŒ…å«æ¥å£çš„æ³›å‹æ ‡è¯†</li><li>å®ç°ç±»ä¸æ˜¯æ³›å‹ç±»ï¼Œå®ç°ç±»è¦æ˜ç¡®æ¥å£å®šä¹‰çš„æ³›å‹</li></ul><h3 id="æ³›å‹æ–¹æ³•">æ³›å‹æ–¹æ³•</h3><p>åœ¨è°ƒç”¨æ–¹æ³•çš„æ—¶å€™æŒ‡æ˜æ³›å‹çš„å…·ä½“ç±»å‹</p><p>è¯­æ³•ï¼š ä¿®é¥°ç¬¦  &lt;T, E, â€¦&gt; è¿”å›å€¼ç±»å‹ æ–¹æ³•å (è¡Œå‚åˆ—è¡¨){}</p><p>å…¶ä¸­&lt;&gt;æŒ‡æ˜äº†è¯¥æ–¹æ³•æ˜¯æ³›å‹æ–¹æ³•ï¼Œå¹¶æŒ‡å‡ºå…¶è¦ç”¨åˆ°çš„æ³›å‹æ ‡è¯†</p><h3 id="ç±»å‹æ“¦é™¤">ç±»å‹æ“¦é™¤</h3><p>æ³›å‹ä¿¡æ¯åªå­˜åœ¨äº<strong>ä»£ç ç¼–è¯‘</strong>é˜¶æ®µï¼Œè¿›å…¥JVMï¼ˆç”Ÿæˆå­—èŠ‚ç ï¼‰ä¹‹å‰ä¸æ³›å‹ç›¸å…³çš„ä¿¡æ¯ä¼šè¢«æ“¦é™¤æ‰</p><ul><li>æ— é™åˆ¶ç±»å‹æ“¦é™¤ï¼Œæ³›å‹æ ‡è¯†ç›´æ¥æ›¿æ¢ä¸º<strong>Object</strong>ï¼ˆå› ä¸ºæ²¡æœ‰è¿›è¡Œä¸Šä¸‹é™çš„é™åˆ¶ï¼‰</li><li>æœ‰é™åˆ¶ç±»å‹æ“¦é™¤ï¼Œ<code>&lt;T extends XXX&gt;</code>ï¼ŒæŒ‰ç…§ä¸Šé™ç±»å‹è¿›è¡Œç±»å‹æ“¦é™¤</li></ul><p>æ¡¥æ¥æ–¹æ³•ï¼Œåœ¨æ— æ³›å‹æ¡ä»¶ä¸‹ä¿è¯æ¥å£å’Œç±»çš„å¤±ä¿¡å…³ç³»</p><h3 id="æ³›å‹æ•°ç»„">æ³›å‹æ•°ç»„</h3><p>å¯ä»¥å£°æ˜å¸¦æ³›å‹çš„æ•°ç»„å¼•ç”¨ä½†ä¸èƒ½ç›´æ¥åˆ›å»ºå¸¦æ³›å‹çš„æ•°ç»„å¯¹è±¡</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayLists <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre></div><p>è¿™æ ·å°±æ˜¯é”™è¯¯çš„ï¼Œç¼–è¯‘æŠ¥é”™ <code>java: cannot create array with '&lt;&gt;'</code></p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">ArrayList</span><span class="token punctuation">[</span><span class="token punctuation">]</span> objects <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayLists <span class="token operator">=</span> objects<span class="token punctuation">;</span><span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> objects1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>arrayLists<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> objects1<span class="token punctuation">;</span></code></pre></div><p>åœ¨è¾ƒè€ç‰ˆæœ¬ä¸­ï¼Œä»¥ä¸Šä»£ç å¯èƒ½ç¼–è¯‘ä¸ä¼šæŠ¥é”™ï¼Œä½†å®é™…è¿è¡Œè‹¥è¦ä½¿ç”¨åˆ°objects1ä¸­çš„å€¼æ—¶åˆ™ä¼šæŠ±æ•°æ®è½¬æ¢ç±»å‹çš„é”™ï¼Œä½†ç›®å‰è‡ªå·±çš„ideaä¼šæŠ±è¿™ä¸ªé”™ jdk 1.8 341</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrayLists <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre></div><p>æ¯”è¾ƒç¨³å¦¥çš„æ–¹æ³•æ˜¯è¿™æ ·ï¼Œä¸è¦æŠŠåŸç”Ÿæ•°æ®ç±»å‹æš´éœ²ç»™å¤–é¢ï¼Œç›´æ¥ä½¿ç”¨å¸¦æœ‰æ³›å‹è§„å®šçš„æ•°ç»„æ³›å‹å¯¹è±¡ï¼Œè¿™æ ·å°±èƒ½é¿å…ä¸Šè¿°é”™è¯¯ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆjavaä¸æ”¯æŒç›´æ¥åˆ›å»ºæ³›å‹æ•°ç»„çš„åŸå› </p><p><strong>é€šè¿‡åå°„åˆ›å»ºæ³›å‹æ•°ç»„</strong></p><p>ä¸èƒ½ç›´æ¥é€šè¿‡T[] data = new T[length]çš„æ–¹å¼åˆ›å»ºæ•°ç»„ï¼ˆå­—èŠ‚ç å±‚ï¼‰</p><p>ä¸ºä»€ä¹ˆä¸èƒ½é€šè¿‡ä¸Šè¿°æ–¹å¼åˆ›å»ºæ•°ç»„å‘¢ï¼Ÿ</p><p>è¿™é‡Œçš„æ ¸å¿ƒé—®é¢˜åº”è¯¥æ˜¯æ˜¯ T data = new T()æ— æ³•é€šè¿‡ç¼–è¯‘ï¼Œå› ä¸ºè‹¥æ²¡æœ‰ä¸Šä¸‹é™ï¼Œåˆ™ç±»å‹æ“¦é™¤æ—¶é»˜è®¤ä¸ºObjectï¼Œé‚£è¿™é‡Œä½ newçš„å°±æ˜¯ä¸€ä¸ªObjectäº†ã€‚å¯ä»¥é€šè¿‡åå°„çš„æ–¹å¼åˆ›å»º</p><p>è¡¥å……ï¼š</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token class-name">String</span> typeName <span class="token operator">=</span> o<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTypeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>typeName<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// java.lang.String[]</span>o<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"123"</span><span class="token punctuation">;</span>o<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// throw ArrayStoreException</span></code></pre></div><p>ç”±äºJavaçˆ¶å­ç±»å‹è½¬æ¢çš„é™åˆ¶ï¼Œå½“ç¬¬ä¸€è¡Œä»£ç è¿è¡Œåï¼Œoå¯¹è±¡å…¶å®ä¾¿æ˜¯String[]ç±»å‹è€ŒéObjectç±»å‹ï¼Œè¿è¡Œä¸Šè¿°ä»£ç ä¼šæŠ¥é”™ArrayStoreException</p><p>å¦‚ä½•é€šè¿‡æ³›å‹æ ‡è¯†åˆ›å»ºæ•°ç»„å‘¢ï¼Ÿä½¿ç”¨åå°„</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyGenerics</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>    <span class="token class-name">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> data<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">MyGenerics</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> t<span class="token punctuation">,</span> <span class="token keyword">int</span> length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        data <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token class-name">Array</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><h2 id="I-Oæ“ä½œ">I/Oæ“ä½œ</h2><h3 id="å¸¸è§å‡ å¤§è¾“å…¥è¾“å‡ºç±»">å¸¸è§å‡ å¤§è¾“å…¥è¾“å‡ºç±»</h3><h2 id="å¼‚å¸¸">å¼‚å¸¸</h2><h3 id="Exceptionå’ŒErrorå…³ç³»">Exceptionå’ŒErrorå…³ç³»</h3><p><strong>Exceptionå’ŒErroréƒ½å¯ä»¥è¢«catchåˆ°</strong></p><p>ä½†ä¸åº”åœ¨ä»£ç ä¸­catch error</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210428185332025.png" alt="image-20210428185332025"></p><p>checkedException ï¼š ç¼–è¯‘æœŸå¼‚å¸¸ï¼Œæ˜“å¤„ç†ï¼Œæ˜“å‡ºé”™çš„</p><h2 id="é¢è¯•é—®é¢˜-v3">é¢è¯•é—®é¢˜</h2><p>ä¸ºä»€ä¹ˆ0.1+0.2= 0.30000000004</p><p>short s1 = 1; s1 = s1 + 1;</p><p>HashSetå†…éƒ¨å¦‚ä½•å®ç°ï¼Ÿä¸ºä»€ä¹ˆè¦é‡å†™hashcode å’Œ equalsæ–¹æ³•ï¼Ÿ</p><p>try catch ä¸­ return ä¼šæ€ä¹ˆæ ·ï¼Ÿ è°ƒç”¨system.exitå‘¢</p><p>ä¸ºä»€ä¹ˆä½œä¸ºæ–¹æ³•ä¼ å‚æ—¶ï¼ŒString æ˜¯ä¸å¯å˜ï¼Œä½†ä¾‹å¦‚è‡ªå®šä¹‰ç±»çš„å¼•ç”¨ // æ•°ç»„  æ˜¯å¯å˜çš„å‘¢</p><ul><li>åœ¨æˆ‘ä»¬è¿›è¡Œä¼ é€’æ—¶ä¸ç®¡æ˜¯å€¼ä¼ é€’è¿˜æ˜¯åœ°å€ä¼ é€’ä¼ é€’çš„éƒ½ä¼šcopyä¸€ä¸ªå‰¯æœ¬è¿›è¡Œä¼ é€’è€Œä¸æ˜¯â€˜åŸä»¶â€™ã€‚åœ¨å¼•ç”¨æ•°æ®ç±»å‹ä¸­ï¼Œå‰¯æœ¬ä¸åŸä»¶æŒ‡å‘åŒä¸€ä¸ªåœ°å€æ—¶æ”¹å˜åœ°å€å†…éƒ¨çš„å€¼åŸä»¶ä¼šå—åˆ°å½±å“ï¼Œä½†æ˜¯å¦‚æœæ”¹å˜äº†å‰¯æœ¬æŒ‡å‘çš„åœ°å€é‚£ä¹ˆå‰¯æœ¬çš„ä¸€åˆ‡å˜åŒ–äºåŸä»¶å°±æ²¡æœ‰å…³ç³»äº†ã€‚<br>æ‰€ä»¥å½“ æ–¹æ³•ä¸­çš„så‘ç”Ÿæ”¹å˜æ—¶ç›¸å½“äºå°†å‰¯æœ¬æŒ‡å‘äº†æ–°çš„åœ°å€äºåŸä»¶è‡ªç„¶å°±æ²¡æœ‰å…³ç³»äº†ï¼Œæ–¹æ³•å¤–éƒ¨çš„sæ²¡æœ‰å˜åŒ–ä¹Ÿå°±è§£é‡Šçš„é€šäº†ã€‚</li></ul><p><strong>ä¸ºä»€ä¹ˆStringæ˜¯ä¸å¯å˜çš„</strong></p><p>å†…éƒ¨finalä¿®é¥° ï¼Œs1 = s2 æ˜¯å…è®¸çš„ï¼Œä»…æ”¹å˜æŒ‡å‘çš„å¼•ç”¨åœ°å€</p><p>æ˜¯å¦å¯ä»¥æ”¹å˜valueçš„å€¼ï¼Ÿ å¯ä»¥ï¼Œåå°„</p><p><strong>æŠ½è±¡ç±»å’Œæ¥å£çš„åŒºåˆ«</strong></p><p>æŠ½è±¡ç±» ä»£ç å¤ç”¨    ç›¸åŒçš„è¡Œä¸ºâ€¦</p><p>æ¥å£æ˜¯å¯¹ç±»çš„çº¦æŸï¼Œå¼ºåˆ¶è¦æ±‚ä¸åŒçš„ç±»æœ‰ç›¸åŒçš„è¡Œä¸º</p><p><strong>JDK 8æ–°ç‰¹æ€§</strong></p><p>**try catch returné—®é¢˜  **</p><p>å¦‚æœåœ¨tryã€catchä¸­ return  ,finally ä»å¯æ‰§è¡Œï¼Œä½†finallyåçš„è¯­å¥ä¸å¯æ‰§è¡Œ</p>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>Study</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>AndroidçŸ¥è¯†æ€»ç»“</title>
    <link href="/2021/01/10/Android%E9%9D%A2%E8%AF%95/"/>
    <url>/2021/01/10/Android%E9%9D%A2%E8%AF%95/</url>
    
    <content type="html"><![CDATA[<h1>Androidé¢è¯•æ€»ç»“</h1><!-- toc --><h2 id="CAS">CAS</h2><h3 id="IPCè¿›ç¨‹é—´é€šä¿¡">IPCè¿›ç¨‹é—´é€šä¿¡</h3><p>Inter-Process Communication</p><ul><li>Windowsï¼šé€šè¿‡å‰ªåˆ‡æ¿ã€ç®¡é“ã€æ²¹æ§½ç­‰è¿›è¡Œè¿›ç¨‹é—´é€šè®¯ã€‚</li><li>Linuxï¼šé€šè¿‡å‘½åç©ºé—´ã€å…±äº«å†…å®¹ã€ä¿¡å·é‡ç­‰è¿›è¡Œè¿›ç¨‹é—´é€šè®¯ã€‚</li><li>Androidï¼šæ²¡æœ‰å®Œå…¨ç»§æ‰¿Linuxï¼Œæ¯”å¦‚ï¼Œå…¶ç‹¬å…·ç‰¹è‰²çš„é€šè®¯æ–¹å¼æœ‰Binderã€Socketç­‰ç­‰ã€‚</li><li><span id="more"></span></li></ul><h4 id="çº¿ç¨‹å’Œè¿›ç¨‹çš„å…³ç³»">çº¿ç¨‹å’Œè¿›ç¨‹çš„å…³ç³»</h4><p>è¿›ç¨‹ï¼š ä¸€ä¸ªæ‰§è¡Œå•å…ƒ ä¸€ä¸ªç¨‹åºæˆ–è€…åº”ç”¨</p><p>è¿›ç¨‹æ˜¯ç¨‹åºè¿è¡Œå’Œèµ„æºåˆ†é…çš„åŸºæœ¬å•ä½</p><p>çº¿ç¨‹ï¼š CPUè°ƒåº¦çš„æœ€å°å•å…ƒ  æœ‰é™çš„ç³»ç»Ÿèµ„æº</p><p>æ˜¯cpuè°ƒåº¦å’Œåˆ†æ´¾çš„åŸºæœ¬å•ä½</p><p>Androidä¸­ è¿›ç¨‹ç©ºé—´åˆ’åˆ†ä¸ºç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´ï¼Œè¿›ç¨‹é—´ç”¨æˆ·ç©ºé—´ä¸å¯åˆ†äº«ï¼Œä½†å†…æ ¸ç©ºé—´å¯åˆ†äº«  æ‰€æœ‰è¿›ç¨‹å…±ç”¨ä¸€ä¸ªå†…æ ¸ç©ºé—´</p><p>è¿›ç¨‹å†…ç”¨æˆ·ç©ºé—´ å’Œå†…æ ¸ç©ºé—´äº¤äº’ è¦é€šè¿‡ç³»ç»Ÿè°ƒç”¨</p><ol><li>copy_from_userï¼ˆï¼‰ï¼šå°†ç”¨æˆ·ç©ºé—´çš„æ•°æ®æ‹·è´åˆ°å†…æ ¸ç©ºé—´</li><li>copy_to_userï¼ˆï¼‰ï¼šå°†å†…æ ¸ç©ºé—´çš„æ•°æ®æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´</li></ol><h4 id="Androidä¸­çš„IPC">Androidä¸­çš„IPC</h4><h5 id="AIDL">AIDL</h5><p>AIDL     <strong>Android Interface definition language</strong></p><p>C/S ç«¯çš„AIDLåç§°  ï¼ˆåŒ…å+ç±»åï¼‰å¿…é¡»ä¸€è‡´</p><p>å†…éƒ¨ç±» Proxy  Stub  éƒ½implementesè¿™ä¸ªæ¥å£</p><p>AIDLå±‚åŒæ–¹é€šä¿¡æ–¹å¼ç±»ä¼¼ ç¬¦å·å¼•ç”¨</p><h5 id="Binder">Binder</h5><p>è®¾è®¡åŸºäºC/Sç»“æ„  å®¢æˆ·ç«¯è¿›ç¨‹è·å–æœåŠ¡ç«¯è¿›ç¨‹çš„ä»£ç†ï¼Œå¹¶é€šè¿‡å‘è¿™ä¸ªä»£ç†å€Ÿå£æ–¹æ³•ä¸­è¯»å†™æ•°æ®æ¥å®Œæˆè¿›ç¨‹é—´çš„æ•°æ®é€šä¿¡</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210321133957552.png" alt="image-20210321133957552"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210320184127616.png" alt="image-20210320184127616"></p><p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL3VwbG9hZC1pbWFnZXMuamlhbnNodS5pby91cGxvYWRfaW1hZ2VzLzk0NDM2NS1kM2M3OGIxOTNjM2U4YTM4LnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTI0MA" alt="img"></p><p>ä¼ ç»Ÿè¿›ç¨‹é€šä¿¡</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210320192944412.png" alt="image-20210320192944412"></p><p>Binderé€šä¿¡</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210321134303878.png" alt="image-20210321134303878"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210320192905310.png" alt="image-20210320192905310"></p><p>Binderå¯ç†è§£ä¸ºæ˜¯ä¸€ç§è™šæ‹Ÿçš„ç‰©ç†è®¾å¤‡ï¼Œå®ƒçš„è®¾å¤‡é©±åŠ¨æ˜¯/dev/binder</p><p>ä»Android Frameworkè§’åº¦æ¥è¯´ï¼ŒBinderæ˜¯ServiceManagerè¿æ¥å„ç§Managerï¼ˆActivityManagerã€WindowManagerï¼Œetcï¼‰å’Œç›¸åº”ManagerServiceçš„æ¡¥æ¢</p><p>ä»Androidåº”ç”¨å±‚æ¥è¯´ï¼ŒBinderæ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯è¿›è¡Œé€šä¿¡çš„åª’ä»‹ï¼Œå½“ä½ bindServiceçš„æ—¶å€™ï¼ŒæœåŠ¡ç«¯ä¼šè¿”å›ä¸€ä¸ªåŒ…å«äº†æœåŠ¡ç«¯ä¸šåŠ¡è°ƒç”¨çš„Binderå¯¹è±¡ï¼Œé€šè¿‡è¿™ä¸ªBinderå¯¹è±¡ï¼Œå®¢æˆ·ç«¯å°±å¯ä»¥è·å–æœåŠ¡ç«¯æä¾›çš„æœåŠ¡æˆ–è€…æ•°æ®ï¼Œè¿™é‡Œçš„æœåŠ¡åŒ…æ‹¬æ™®é€šæœåŠ¡å’ŒåŸºäºAIDLçš„æœåŠ¡ã€‚</p><p><strong>Binderä¸€ä¸ªå¾ˆé‡è¦çš„ä½œç”¨æ˜¯ï¼šå°†å®¢æˆ·ç«¯çš„è¯·æ±‚å‚æ•°é€šè¿‡ParcelåŒ…è£…åä¼ åˆ°è¿œç¨‹æœåŠ¡ç«¯ï¼Œè¿œç¨‹æœåŠ¡ç«¯è§£ææ•°æ®å¹¶æ‰§è¡Œå¯¹åº”çš„æ“ä½œï¼ŒåŒæ—¶å®¢æˆ·ç«¯çº¿ç¨‹æŒ‚èµ·ï¼Œå½“æœåŠ¡ç«¯æ–¹æ³•æ‰§è¡Œå®Œæ¯•åï¼Œå†å°†è¿”å›ç»“æœå†™å…¥åˆ°å¦å¤–ä¸€ä¸ªParcelä¸­å¹¶å°†å…¶é€šè¿‡Binderä¼ å›åˆ°å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯æ¥æ”¶åˆ°è¿”å›æ•°æ®çš„Parcelåï¼ŒBinderä¼šè§£ææ•°æ®åŒ…ä¸­çš„å†…å®¹å¹¶å°†åŸå§‹ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œè‡³æ­¤ï¼Œæ•´ä¸ªBinderçš„å·¥ä½œè¿‡ç¨‹å°±å®Œæˆäº†ã€‚ç”±æ­¤å¯è§ï¼ŒBinderæ›´åƒä¸€ä¸ªæ•°æ®é€šé“ï¼ŒParcelå¯¹è±¡å°±åœ¨è¿™ä¸ªé€šé“ä¸­è·¨è¿›ç¨‹ä¼ è¾“ï¼Œè‡³äºåŒæ–¹å¦‚ä½•é€šä¿¡ï¼Œè¿™å¹¶ä¸è´Ÿè´£ï¼Œåªéœ€è¦åŒæ–¹æŒ‰ç…§çº¦å®šå¥½çš„è§„èŒƒå»æ‰“åŒ…å’Œè§£åŒ…æ•°æ®å³å¯ã€‚</strong></p><p>ä¸‰å±‚ç»“æ„ï¼š</p><p>Clientï¼šå…·ä½“å’ŒæŸä¸€ä¸ªServiceé€šä¿¡ï¼Œå…ˆä»ServiceManagerè·å–è¯¥Serviceçš„ç›¸å…³ä¿¡æ¯ï¼Œæ ¹æ®å¾—åˆ°çš„Serviiceä¿¡æ¯å’ŒServiceæ‰€åœ¨çš„Serveè¿›ç¨‹å»ºç«‹é€šä¿¡</p><p>Serverï¼šæ³¨å†ŒServiceåˆ°ServiceManager</p><p>ServiceManagerï¼š ç®¡ç†è¿™äº›Service å¹¶å‘Clientæä¾›ç›¸å…³çš„æ¥å£</p><p>Androidç³»ç»Ÿä¼šä¸ºæ¯ä¸€ä¸ªåº”ç”¨åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„UIDï¼Œå…·æœ‰ç›¸åŒUIDçš„åº”ç”¨æ‰èƒ½å…±äº«æ•°æ®ã€‚è¦æ±‚ä¸¤ä¸ªåº”ç”¨å…·æœ‰ç›¸åŒçš„ShareUIDå¹¶ä¸”ç­¾åç›¸åŒæ‰å¯ä»¥è·‘åœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¸­ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒä»¬å¯ä»¥äº’ç›¸è®¿é—®å¯¹æ–¹çš„ç§æœ‰æ•°æ®ï¼Œæ¯”å¦‚dataç›®å½•ã€ç»„ä»¶ä¿¡æ¯ç­‰ï¼Œä¸ç®¡å®ƒä»¬æ˜¯å¦è·‘åœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¸­ã€‚å½“ç„¶å¦‚æœå®ƒä»¬è·‘åœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œé‚£ä¹ˆé™¤äº†èƒ½å…±äº«dataç›®å½•ã€ç»„ä»¶ä¿¡æ¯ï¼Œè¿˜å¯ä»¥å…±äº«å†…å­˜æ•°æ®ï¼Œæˆ–è€…è¯´å®ƒä»¬çœ‹èµ·æ¥å°±åƒæ˜¯ä¸€ä¸ªåº”ç”¨çš„ä¸¤ä¸ªéƒ¨åˆ†ã€‚</p><h5 id="åºåˆ—åŒ–çš„ä¸¤ç§æ–¹å¼">åºåˆ—åŒ–çš„ä¸¤ç§æ–¹å¼</h5><p>Parcelable</p><p>Serializable</p><h2 id="Andoird">Andoird</h2><h3 id="å¯åŠ¨åŸç†">å¯åŠ¨åŸç†</h3><p><a href="https://www.jianshu.com/p/12de32b31836">https://www.jianshu.com/p/12de32b31836</a></p><h2 id=""></h2><h3 id="äº‹ä»¶åˆ†å‘æœºåˆ¶">äº‹ä»¶åˆ†å‘æœºåˆ¶</h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210301164920245.png" alt="image-20210301164920245"></p><h4 id="dispatchTouchEvent">dispatchTouchEvent</h4><p>true ï¼š å·²ç»è¿›è¡Œäº†å¤„ç†ï¼Œä¸åœ¨å‘ä¸‹ä¼ é€’ï¼Œåœæ­¢åˆ†å‘</p><p>falseï¼š æœªå¤„ç†ï¼Œç»§ç»­åˆ†å‘    ä¸€èˆ¬é»˜è®¤è¿”å›false</p><h4 id="onInterceptTouchEvent">onInterceptTouchEvent</h4><p>Viewgroupç‰¹æœ‰</p><p>äº‹ä»¶ä¼ å…¥ dispatchå†…éƒ¨ è°ƒç”¨è¿™ä¸ªæ–¹æ³•</p><p>false ï¼š å­View è°ƒç”¨dispatcâ€¦</p><p>trueï¼šäº¤ç»™è¯¥Viewgourpçš„onTouchEventæ–¹æ³•å¤„ç† ï¼Œä¸è¿‡ä¹Ÿè¦çœ‹ä»–è‡ªå·±èƒ½ä¸èƒ½æœ‰æ²¡æœ‰ontouchEvent</p><h4 id="onTouchEvent">onTouchEvent</h4><p>Activityå±‚</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210301174949296.png" alt="image-20210301174949296"></p><p>ViewGroupå±‚</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210301180054892.png" alt="image-20210301180054892"></p><p>Viewå±‚</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210301182854640.png" alt="image-20210301182854640"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210301182955527.png" alt="image-20210301182955527"></p><h3 id="ViewåŸç†">ViewåŸç†</h3><h4 id="Activtyçš„å¯åŠ¨é¡ºåº">Activtyçš„å¯åŠ¨é¡ºåº</h4><p>onCreate â€“ onStart â€”onResume</p><p>homeé”®è¿”å›å  onPause  â€“ onStop   ä»åå°è¿”å›æ—¶  onStart â€” onResume</p><p>æ‰“å¼€æ–°çš„activityâ€™æ—¶  onpause  --onStop</p><p>å…³é—­ç¨‹åºå  onPuase â€“ onStop â€“ onDestroy â€“ onDetachedFromWindow</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210314102121692.png" alt="image-20210314102121692"></p><h4 id="Activityå¯åŠ¨æ¨¡å¼">Activityå¯åŠ¨æ¨¡å¼</h4><ol><li><p>standard é»˜è®¤æ ‡å‡†æ¨¡å¼ï¼Œæ¯å¯åŠ¨ä¸€ä¸ªéƒ½ä¼šåˆ›å»ºå®ä¾‹</p><p>åº”ç”¨ï¼š Bç«™è§†é¢‘æ‰“å¼€</p></li><li><p>singleTop æ ˆé¡¶å¤ç”¨ï¼Œåœ¨æ ˆé¡¶ å°±è°ƒç”¨onNewIntentå¤ç”¨</p></li><li><p>singleTask æ ˆå†…å¤ç”¨ï¼Œ æœ¬æ ˆå†…åªè¦ç”¨è¯¥ç±»å‹çš„activtyå°±ä¼šå°†é¡¶éƒ¨çš„activityå‡ºæ ˆ</p></li><li><p>singleInstance å•ä¾‹æ¨¡å¼ï¼Œå•ç‹¬ç»™activityåˆ›å»ºä¸€ä¸ªæ ˆ</p><p>å‰å°ä»»åŠ¡æ ˆ  åå°ä»»åŠ¡æ ˆ</p></li></ol><h4 id="å¯¹activityè¿›è¡Œç¼“å­˜">å¯¹activityè¿›è¡Œç¼“å­˜</h4><ul><li>æ‰“å¼€æ–°çš„Activity / Homeé”® / ç”µæºé”®  onStopåä¼šè°ƒç”¨onSaveInstanceState æ–¹æ³•ï¼Œå¯ä»¥åœ¨å‚æ•°bundleä¸­è¿›è¡Œä¿å­˜</li><li>onRestoreInstanceState å¯¹æ•°æ®è¿›è¡Œæ¢å¤</li></ul><h4 id="Activityé—´é€šä¿¡">Activityé—´é€šä¿¡</h4><ol><li>Intent â€“ Bundle</li><li>Service</li></ol><h4 id="Viewç»“æ„">Viewç»“æ„</h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210314103217599.png" alt="image-20210314103217599"></p><p>View æ ‘ç»“æ„</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210314103242042.png" alt="image-20210314103242042"></p><h4 id="Viewç»˜åˆ¶æµç¨‹">Viewç»˜åˆ¶æµç¨‹</h4><h5 id="measure">measure</h5><h5 id="layout">layout</h5><h5 id="draw">draw</h5><h3 id="æ¨ªç«–å±åˆ‡æ¢çš„ç”Ÿå‘½å‘¨æœŸ">æ¨ªç«–å±åˆ‡æ¢çš„ç”Ÿå‘½å‘¨æœŸ</h3><h3 id="Gradle">Gradle</h3><h4 id="æ˜¯ä»€ä¹ˆ">æ˜¯ä»€ä¹ˆ</h4><p>Gradleæ˜¯ä¸€ä¸ªåŸºäºApache Antå’ŒApache Mavenæ¦‚å¿µçš„é¡¹ç›®è‡ªåŠ¨åŒ–æ„å»ºå¼€æºå·¥å…·ã€‚å®ƒä½¿ç”¨ä¸€ç§åŸºäºGroovyçš„ç‰¹å®šé¢†åŸŸè¯­è¨€(DSL)æ¥å£°æ˜é¡¹ç›®è®¾ç½®ï¼ŒæŠ›å¼ƒäº†åŸºäºXMLçš„å„ç§ç¹çé…ç½®ã€‚</p><ol><li>Gradleæ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–æ„å»ºå·¥å…·</li><li>å…¼å®¹Mavenç­‰ä»“åº“</li><li>åŸºäºGroovyçš„ç‰¹å®šé¢†åŸŸè¯­è¨€æ¥å£°æ˜åç›®è®¾ç½®</li></ol><h4 id="é…ç½®æ–‡ä»¶">é…ç½®æ–‡ä»¶</h4><ol><li>settings.gradle:æ•´ä¸ªProjectçš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥è®¾ç½®åŒ…å«å“ªäº›module</li><li>build.gradle ï¼ˆProjectçš„gradleæ–‡ä»¶ï¼‰:æ•´ä¸ªProjectçš„é…ç½®æ–‡ä»¶</li><li>build.gradleï¼ˆModuleï¼‰ï¼šModuleçš„é…ç½®æ–‡ä»¶</li><li>gradle.propertiesï¼šå¯ä»¥åœ¨ gradle.properties æ–‡ä»¶ä¸­é…ç½®ä¸€äº›å˜é‡</li></ol><h3 id="Fragment">Fragment</h3><p><span style='color: #00BFFF;font-size:24px'>ç»“åˆBottomNavigationViewä½¿ç”¨</span></p><p><span style='color:#3CB371;font-size:24px'>å¦‚ä½•å‡å°‘Fragmentåˆ‡æ¢æ—¶çš„é‡å¤åˆ›å»ºï¼Ÿtransaction.replaceæ–¹æ³•å¦‚ä½•ï¼Ÿ æœ‰æ²¡æœ‰è€ƒè™‘ç”¨è¿‡hide ã€addã€showçš„æ–¹æ³•ï¼ŸçŠ¶æ€ä¿å­˜ï¼Ÿ</span></p><p>å…ˆåˆ›å»ºæ‰€æœ‰fragmentçš„å¯¹è±¡ï¼Œåœ¨éœ€è¦æ—¶åˆå§‹åŒ–ï¼Œå¦‚æœåˆ‡æ¢æ—¶éšè—ï¼Œéœ€è¦æ—¶åœ¨åˆ©ç”¨ï¼Œè¿™æ ·ä¹Ÿèƒ½å¤Ÿè¿›è¡ŒçŠ¶æ€çš„ä¿å­˜äº†</p><p>fragmentä¸­ onHiddenChangeæ–¹æ³•å¯ä»¥ç›‘å¬ hideçŠ¶æ€</p><p><strong>fragmentTransaction  addToBackStack æœ‰ä»€ä¹ˆä½œç”¨?</strong></p><p>è®°å½•å½“å‰äº‹åŠ¡ï¼Œ backPressæ—¶ ä¾æ¬¡å¼¹æ ˆ</p><h4 id="ä¸Activityé€šä¿¡çš„å‡ ç§æ–¹å¼">ä¸Activityé€šä¿¡çš„å‡ ç§æ–¹å¼</h4><ol><li>æ¥å£  ä¼ å…¥activityçš„view</li><li>getActivity è°ƒç”¨å…¶ä¸­çš„å…¬å…±æ–¹æ³•</li><li>å¹¿æ’­ï¼Ÿ</li><li>getActivity.getFragmentManager.findFragmentById</li></ol><h3 id="Handler">Handler</h3><h4 id="ä»€ä¹ˆæ˜¯Handler">ä»€ä¹ˆæ˜¯Handler</h4><p>Android SDK å¤„ç†å¼‚æ­¥æ¶ˆæ¯çš„æ ¸å¿ƒç±»</p><p>å­çº¿ç¨‹ä¸ä¸»çº¿ç¨‹é€šè¿‡Handler é€šä¿¡ï¼Œå­çº¿ç¨‹é€šè¿‡Hanlderé€šçŸ¥ä¸»çº¿ç¨‹çš„Uiæ›´æ–°</p><p>Handler  Message  MessageQueue    Looper   Thread</p><h4 id="é—®é¢˜çš„å‡ºå‘ç‚¹">é—®é¢˜çš„å‡ºå‘ç‚¹</h4><p>Handler å¤šå±‚åµŒå¥—è¿‡ç¨‹å¦‚ä½•ï¼Ÿ</p><p>è¯•å›¾åœ¨å­çº¿ç¨‹ä¸­æ›´æ”¹UI:</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210305160239366.png" alt="image-20210305160239366"></p><p>åœ¨å­çº¿ç¨‹ä¸­æ·»åŠ Looperä¼šæŠ¥é”™   ä¸”é€šè¿‡Looper.getMainLooper  æˆ–è€…myLooperè·å–çš„å€¼å’Œä¸»çº¿ç¨‹çš„æ˜¯ä¸€æ ·çš„</p><h4 id="é€šä¿¡åŸç†">é€šä¿¡åŸç†</h4><p>Messageå†…éƒ¨ç»“æ„</p><p>clearæ–¹æ³•</p><p>MessageQueue è¿›è¡¨å‡ºè¡¨  enqueueMessageçš„æœ€ç»ˆç»“æœ  MeeageæŒ‰ç…§whençš„æ—¶é—´è¿œè¿‘æ’åº  â€”æ¶‰åŠé“¾è¡¨çš„æ“ä½œ</p><p>Looperâ€”&gt;ThreadLocal</p><p>looperå†…éƒ¨   loop()æ–¹æ³•    æ‰¾æ˜¯å¦å½“å‰whenæœ‰ä¸€ä¸ªmessage     å¦‚æœmessageè‡ªå·±èƒ½å¤„ç†å°±è‡ªå·±å¤„ç†ï¼Œå¦‚æœä¸èƒ½è‡ªå·±å¤„ç†ï¼Œå°±çœ‹handleræ˜¯å¦èƒ½å¤Ÿæ³•å¤„ç†ï¼ˆå›è°ƒç›‘å¬å™¨  mCallBack   æœ‰boolå€¼ ç±»ä¼¼ontouchï¼‰    æœ€åçœ‹å›è°ƒç›‘å¬å™¨çš„è¿”å›å€¼ï¼Œçœ‹æ˜¯å¦æ‰§è¡Œé‡å†™çš„handleMessage</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">dispatchMessage</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NonNull</span> <span class="token class-name">Message</span> msg<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>msg<span class="token punctuation">.</span>callback <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">handleCallback</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>mCallback <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>mCallback<span class="token punctuation">.</span><span class="token function">handleMessage</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">return</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            <span class="token function">handleMessage</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span></code></pre></div><h4 id="çº¿ç¨‹é€šä¿¡">çº¿ç¨‹é€šä¿¡</h4><p>Messageçº¿ç¨‹é—´é€šä¿¡çš„æ•°æ®è½½ä½“</p><h5 id="AsyncTask">AsyncTask</h5><p>å¼‚æ­¥ä»»åŠ¡    å¯¹Handler å’ŒThreadçš„å°è£…  æ›´ç®€æ´é«˜æ•ˆ   ä¸”å°è£…äº†ThreadPool</p><ul><li>Messageè§†è§’</li></ul><p><span style='color: #00BFFF;font-size:18px'>ä¸€ä¸ªçº¿ç¨‹å¯ä»¥æœ‰å¤šä¸ªHandlerï¼Œä¸€ä¸ªçº¿ç¨‹çš„å¤šä¸ªHandleråªèƒ½æœ‰ä¸€ä¸ªç›¸åŒçš„Looperä»¥åŠLooperçš„MessageQueueã€‚Handleråˆå§‹åŒ–æ—¶ä¼šåˆå§‹åŒ–è‡ªèº«æŒæœ‰çš„Loopeä»¥åŠlooperçš„messageQueueï¼Œå‘é€æ¶ˆæ¯æ—¶ï¼Œå…ˆè¿›å…¥åˆ°handler.post/sendä¸­ï¼Œç„¶ååœ¨mQueueä¸­è¿›è¡ŒenqueueMessageï¼Œé€šè¿‡messageçš„whenå¯¹å½“å‰æ’å…¥çš„messageè¿›è¡Œæ’åºï¼ˆå½“ç„¶è‚¯å®šæ˜¯é”äº†çš„ï¼‰ï¼Œç¡®ä¿ä¸€ä¸ªmessagequeueä¸­çš„æ‰€æœ‰messageéƒ½æ˜¯ä»¥whenè¿›è¡Œæ’åºçš„</span></p><ul><li><p>Handlerè§†è§’</p><p><span style='color:#3CB371;font-size:24px'>Handleråœ¨è¿›è¡Œå¤„ç†æ—¶ä¼šé€šè¿‡ç³»ç»ŸæŒç»­å¾ªç¯çš„looperçš„loopæ–¹æ³•è¿›è¡Œæœç´¢ï¼Œåˆ¤æ–­å½“å‰çš„æ—¶é—´ç‚¹æ˜¯å¦æœ‰ä¸whenç›¸åŒçš„messageç­‰å¾…è¢«å¤„ç†ï¼Œå¦‚æœéœ€è¦è¢«å¤„ç†ï¼Œåˆ™ä¼šæœ‰ä¸€å¥—åˆ†å‘æœºåˆ¶ã€‚å…ˆçœ‹messageæ˜¯å¦å¸¦æœ‰callbackçš„å›è°ƒæ–¹æ³•ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™çœ‹å½“å‰handleræ˜¯å¦æœ‰callbackçš„å›è°ƒï¼Œå¦‚æœè¿˜æ˜¯æ²¡æœ‰ï¼Œåˆ™å»æ‰¾handlerè‡ªèº«å†™çš„handlemessageæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¹Ÿæ˜¯æš´éœ²çš„ï¼Œå¯ä»¥é‡å†™</span></p></li></ul><h4 id="HandlerThread">HandlerThread</h4><p>å°±æ˜¯å†…ç½®handlerçš„thread</p><h4 id="é¢è¯•é—®é¢˜">é¢è¯•é—®é¢˜</h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210305165916419.png" alt="image-20210305165916419"></p><p><span style='color:red;font-size:20px;'>ä¸€ä¸ªçº¿ç¨‹æœ‰å‡ ä¸ªHandler</span></p><p>å¤šä¸ªhandler</p><p><span style='color:red;font-size:20px;'>ä¸€ä¸ªçº¿ç¨‹æœ‰å‡ ä¸ªlooperï¼Œå¦‚ä½•ä¿è¯</span></p><p>åªæœ‰ä¸€ä¸ªLooper</p><ul><li>çº¿ç¨‹å’Œlooperçš„å…³ç³»</li></ul><p><span style='color:red;font-size:20px;'>é‡ç‚¹ï¼š å†…å­˜æ³„æ¼</span></p><p>æ ¹æœ¬åŸå› ï¼šå†…éƒ¨å˜é‡ï¼Ÿä¼šæŒæœ‰å¤–éƒ¨ç±»çš„å¼•ç”¨  ï¼Œè€Œactivityè¢«handleræŒæœ‰</p><p>MessageQueue  --&gt;Message  --&gt;Handler  -&gt;HandleR  -&gt;this (Activity)   --&gt;æ‹¥æœ‰å¤§é‡çš„å†…å­˜</p><p>é—®é¢˜è½¬ä¸ºJVMé—®é¢˜     GC   å¯è¾¾æ€§åˆ†æ   å‘ç°æ˜¯å¯è¾¾çš„ï¼Œæ•…ä¸ä¼šGC</p><p>è§£å†³æ–¹æ¡ˆ</p><p>static    å¼±å¼•ç”¨ / è½¯å¼•ç”¨</p><p>destroyæ—¶ æ¸…ç†handler æ‰€æœ‰çš„message   messagequeue  quitsafely</p><p><span style='color:red;font-size:20px;'>å¦‚ä½•åœ¨å­çº¿ç¨‹ä¸­ä½¿ç”¨Handler</span></p><p>HandlerThread</p><p>å¦‚ä½•è§£å†³      é”æœºåˆ¶</p><p><span style='color:red;font-size:20px;'>HandlerThreadçš„ä¸åŒ</span></p><p><span style='color:red;font-size:20px;'>æ²¡æœ‰æ¶ˆæ¯æ—¶ä¼šæ€ä¹ˆåŠ</span></p><h4 id="é¢å¤–çš„é—®é¢˜">é¢å¤–çš„é—®é¢˜</h4><p>ä¸ºä»€ä¹ˆ runOnUiThread æ‰§è¡Œè€—æ—¶æ“ä½œè¿˜æ˜¯ ä¼šå½±å“ä¸»çº¿ç¨‹çš„æ‰§è¡Œ</p><h3 id="Intent">Intent</h3><h3 id="RecycleView">RecycleView</h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210306140559042.png" alt="image-20210306140559042"></p><h4 id="ä¸ListVIewçš„ä¸åŒç‚¹">ä¸ListVIewçš„ä¸åŒç‚¹</h4><p>ç¼“å­˜æœºåˆ¶ä¸åŒ</p><h4 id="æ»šåŠ¨æœºåˆ¶">æ»šåŠ¨æœºåˆ¶</h4><p>onTouch  â€“ scrollBy   â€“ fill  â€“  layoutChunkå¡«å……  â€”next --tryGetViewHolderâ€¦å¤ç”¨ â€”</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java">getItemDecorInsetsForChild  </code></pre></div><p>è§£å†³itemdecoration</p><h4 id="å››çº§ç¼“å­˜">å››çº§ç¼“å­˜</h4><p>mAttachedScrap(å±å¹•å†…)// mCaneScrapï¼ŒmCacheViews(å±å¹•å¤–)ï¼ŒmViewCacheExtension(è‡ªå®šä¹‰ç¼“å­˜)ï¼ŒmRecyclerPool(ç¼“å­˜æ± )</p><p>ç¼“å­˜å’Œå¤ç”¨åˆ°åº•åœ¨å¤„ç†ä»€ä¹ˆï¼Ÿ View ï¼Ÿ ViewHolderï¼Ÿ</p><ol><li>é¦–å…ˆåœ¨mChangeScrap  ä¸¤ç§æ–¹å¼  position / id(stable id)</li><li>mattachScrap  å’ŒHiddenView åŠ¨ç”»å’Œ cachedView   by position/ id</li><li>è‡ªå®šä¹‰</li><li>ç¼“å­˜æ± </li><li>createViewHolder - -onCreateViewHolderåˆ›å»º</li></ol><p><strong>ç¼“å­˜</strong></p><p>Recycler</p><p>fillä¹‹å‰</p><ol><li><p>mCachedView   æŠŠç´¢å¼•0 çš„holderæ”¾åˆ°poolä¸­</p></li><li><p>poolä¸­å­˜</p><p>æ ¹æ®ViewType</p><p>sparseArray é”®å€¼å¯¹å­˜å‚¨ ç±»ä¼¼hashmap</p><p>å¦‚æœåŒç±»é¡¹çš„arrayå·²ç»è¶…è¿‡5ä¸ªï¼Œ åˆ™ä¸æ”¾äº†ï¼</p></li></ol><p>éƒ½åœ¨å†…éƒ¨ç±»Recylcer</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210316193720147.png" alt="image-20210316193720147"></p><p>ç¼“å­˜æ± çš„ç»“æ„</p><h4 id="åµŒå¥—å¦‚ä½•è§£å†³æ»‘åŠ¨å†²çª">åµŒå¥—å¦‚ä½•è§£å†³æ»‘åŠ¨å†²çª</h4><h4 id="å…·ä½“æµç¨‹å’Œå¤ç”¨æœºåˆ¶">å…·ä½“æµç¨‹å’Œå¤ç”¨æœºåˆ¶</h4><h4 id="å†…éƒ¨ç±»">å†…éƒ¨ç±»</h4><h5 id="Recyler">Recyler</h5><p>tryGetViewHolderForPositionByDeadline</p><h5 id="RecycledViewPool">RecycledViewPool</h5><h4 id="æ–¹æ³•">æ–¹æ³•</h4><p>onBindView ç¼“å­˜çš„ä¸ªæ•°  10</p><p>onTouchEvent  è§¦ç¢°å…³é”®çš„å‡½æ•°    ----   æ»šåŠ¨æœºåˆ¶  scrollBy</p><p>----fill</p><h4 id="LayoutManager">LayoutManager</h4><p>measureæ–¹æ³•ä¸»è¦æ˜¯äº¤ç»™ä»–æ¥åšçš„</p><h3 id="Androidå¯åŠ¨åŸç†">Androidå¯åŠ¨åŸç†</h3><p>hhhh</p><q>sbsbsb</q><div class="code-wrapper"><pre class="language-none"><code class="language-none">w;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</code></pre></div><h3 id="å±å¹•é€‚é…">å±å¹•é€‚é…</h3><h4 id="æ¦‚å¿µ">æ¦‚å¿µ</h4><p>dp ï¼š  density-independent pixels nä¸ªå®é™…åƒç´ ï¼Œä¸è®¾å¤‡dpiç›¸å…³ï¼Œä¸pxï¼ˆåƒç´ ï¼‰æ¢ç®—å…³ç³»ï¼šdp/160 = px/dpiã€‚  px = dp*dpi /160</p><p>é‚£ä¹ˆdpç©¶ç«Ÿè§£å†³äº†é€‚é…ä¸Šçš„ä»€ä¹ˆé—®é¢˜ï¼Ÿå¯ä»¥çœ‹å‡º1dp = 1/160inchï¼›é‚£ä¹ˆå®ƒè‡³å°‘èƒ½è§£å†³ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ä½ åœ¨å¸ƒå±€æ–‡ä»¶å†™æŸä¸ªViewçš„å®½å’Œé«˜ä¸º160dp*160dpï¼Œè¿™ä¸ªViewåœ¨ä»»ä½•åˆ†è¾¨ç‡çš„å±å¹•ä¸­ï¼Œæ˜¾ç¤ºçš„å°ºå¯¸å¤§å°æ˜¯å¤§çº¦æ˜¯ä¸€è‡´çš„ï¼ˆå¯èƒ½ä¸ç²¾ç¡®ï¼‰ï¼Œå¤§æ¦‚æ˜¯ 1 inch * 1 inch</p><p>dpi:         Dots Per Inchï¼ˆæ¯è‹±å¯¸æ‰€æ‰“å°çš„ç‚¹æ•°ï¼‰</p><p>px: 1920*1080 (px)</p><h3 id="Framework">Framework</h3><h4 id="æ¦‚å¿µ-v2">æ¦‚å¿µ</h4><h3 id="ContentProvider">ContentProvider</h3><h4 id="ä½œç”¨">ä½œç”¨</h4><h3 id="OkHttp">OkHttp</h3><h4 id="æ ¸å¿ƒç±»">æ ¸å¿ƒç±»</h4><ol><li><p>OkHttpClient</p><p>newCall(this,request)   return new ReaCall</p><ol><li><p>RealCall</p><p>final class ã€implements Call</p><p>æŒæœ‰ä¸€ä¸ªfinalçš„OkHttpCallï¼ŒæŒæœ‰ä¼ æ¥çš„Request  æ„é€ æ–¹æ³•</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span><span class="token keyword">void</span> <span class="token function">enqueue</span><span class="token punctuation">(</span><span class="token class-name">Callback</span> responseCallback<span class="token punctuation">,</span> <span class="token keyword">boolean</span> forWebSocket<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>executed<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token string">"Already Executed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      executed <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    client<span class="token punctuation">.</span><span class="token function">dispatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">enqueue</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AsyncCall</span><span class="token punctuation">(</span>responseCallback<span class="token punctuation">,</span> forWebSocket<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token annotation punctuation">@Override</span> <span class="token keyword">public</span> <span class="token class-name">Response</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token comment">//åŒæ­¥ä¸ºä»€ä¹ˆè¿˜è¦ç¡®ä¿æ˜¯å¦æ‰§è¡Œï¼Ÿ</span>      <span class="token comment">//å¯èƒ½cloneï¼Ÿ</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>executed<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token string">"Already Executed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    executed <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>    client<span class="token punctuation">.</span><span class="token function">dispatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">executed</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//dispatcher è¿”å›çš„æ˜¯Distpatcher ---OkHttpClientæŒæœ‰</span>    <span class="token class-name">Response</span> result <span class="token operator">=</span> <span class="token function">getResponseWithInterceptorChain</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IOException</span><span class="token punctuation">(</span><span class="token string">"Canceled"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> result<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>    client<span class="token punctuation">.</span><span class="token function">dispatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">finished</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div></li><li><p>Dispatcher</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">int</span> maxRequests <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">;</span> <span class="token comment">// æœ€å¤§requestæ•°</span><span class="token keyword">private</span> <span class="token keyword">int</span> maxRequestsPerHost <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">// æœ€å¤§requests/Hostæ•° </span><span class="token comment">/** Executes calls. Created lazily. */</span><span class="token operator">/</span><span class="token operator">/</span>é‡è¦ï¼<span class="token keyword">private</span> <span class="token class-name">ExecutorService</span> executorService<span class="token punctuation">;</span><span class="token comment">/** Ready async calls in the order they'll be run. */</span><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Deque</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AsyncCall</span><span class="token punctuation">></span></span> readyAsyncCalls <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayDeque</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/** Running asynchronous calls. Includes canceled calls that haven't finished yet. */</span><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Deque</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AsyncCall</span><span class="token punctuation">></span></span> runningAsyncCalls <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayDeque</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/** Running synchronous calls. Includes canceled calls that haven't finished yet. */</span><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Deque</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">RealCall</span><span class="token punctuation">></span></span> runningSyncCalls <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayDeque</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p>enqueue æ–¹æ³•</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token comment">// æ˜¯åœ¨runningAsyncä¸­æ·»åŠ è¿˜æ˜¯readyAsyncä¸­æ·»åŠ  ï¼Ÿï¼Ÿï¼Ÿ</span><span class="token comment">//è¿è¡Œé˜Ÿåˆ—æ€»æ•°&lt;64 è¯·æ±‚æ‰€å±ä¸»æœºæ‰§è¡Œçš„ä»»åŠ¡æ•°</span><span class="token keyword">if</span> <span class="token punctuation">(</span>runningAsyncCalls<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> maxRequests <span class="token operator">&amp;&amp;</span> <span class="token function">runningCallsForHost</span><span class="token punctuation">(</span>call<span class="token punctuation">)</span> <span class="token operator">&lt;</span> maxRequestsPerHost<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  runningAsyncCalls<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>call<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//å¦‚æœæ˜¯runningAsyncCallä¸­ï¼Œåˆ™ç›´æ¥æ‰§è¡Œè¿™ä¸ªcall</span>  <span class="token comment">//æ ¸å¿ƒ</span>  <span class="token function">executorService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>call<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  readyAsyncCalls<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>call<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>executorServiceæ–¹æ³•</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token class-name">ExecutorService</span> <span class="token function">executorService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>executorService <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    executorService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">,</span>        <span class="token keyword">new</span> <span class="token class-name">SynchronousQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Util</span><span class="token punctuation">.</span><span class="token function">threadFactory</span><span class="token punctuation">(</span><span class="token string">"OkHttp Dispatcher"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ³¨æ„è¿™é‡Œä½¿ç”¨çš„æ˜¯SynchronousQueue åŒæ­¥é˜Ÿåˆ—</span>  <span class="token punctuation">&#125;</span>  <span class="token comment">//ç±»ä¼¼å•ä¾‹ï¼Ÿ</span>  <span class="token keyword">return</span> executorService<span class="token punctuation">;</span></code></pre></div><ol><li><p>ExecutorService</p><p>interface  extends Executor Executoråªæœ‰ä¸€ä¸ªæ–¹æ³•execute</p><p>è¿™é‡Œä½¿ç”¨çš„æ„é€ æ–¹æ³•</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token keyword">int</span> corePoolSize<span class="token punctuation">,</span>                            <span class="token keyword">int</span> maximumPoolSize<span class="token punctuation">,</span>                            <span class="token keyword">long</span> keepAliveTime<span class="token punctuation">,</span>                            <span class="token class-name">TimeUnit</span> unit<span class="token punctuation">,</span>                            <span class="token class-name">BlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">></span></span> workQueue<span class="token punctuation">,</span>                          <span class="token comment">//æ³¨æ„æ˜¯Blockqueue</span>                            <span class="token class-name">ThreadFactory</span> threadFactory<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">this</span><span class="token punctuation">(</span>corePoolSize<span class="token punctuation">,</span> maximumPoolSize<span class="token punctuation">,</span> keepAliveTime<span class="token punctuation">,</span> unit<span class="token punctuation">,</span> workQueue<span class="token punctuation">,</span>           threadFactory<span class="token punctuation">,</span> defaultHandler<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span></code></pre></div><p>BlockingQueue  ç¼“å­˜æ”¾ä¸ä¸‹æ—¶å€™çš„çº¿ç¨‹</p><ul><li><p>ä¸ºä»€ä¹ˆè¿™é‡Œç”¨Synchonrousé˜Ÿåˆ—ï¼Ÿ</p></li><li><p>ä¸ºä»€ä¹ˆnewçš„ThreadPoolExectuoræ ¸å¿ƒçº¿ç¨‹æ•°ä¸º 0</p><p>çº¿ç¨‹æ± æ¦‚å¿µï¼Œå‡å°‘é¢‘ç¹åˆ›å»ºé”€æ¯çš„è€—æ—¶è¿‡ç¨‹</p></li></ul><ol><li><div class="code-wrapper"><pre><code class="language-java">public void execute(Runnable command) &#123;    //ä»»åŠ¡ä¸èƒ½ä¸ºç©º    if (command == null)        throw new NullPointerException();    //è·å–çº¿ç¨‹çŠ¶æ€    int c = ctl.get();    //1.     if (workerCountOf(c) &lt; corePoolSize) &#123;        if (addWorker(command, true))            return;        //æ·»åŠ çº¿ç¨‹å¤±è´¥        c = ctl.get();    &#125;    //2.    //å¦‚æœçº¿ç¨‹æ± çŠ¶æ€æ˜¯RUNNING å¹¶ä¸”ä»»åŠ¡æˆåŠŸæ·»åŠ åˆ°workQueueä¸­    if (isRunning(c) &amp;&amp; workQueue.offer(command)) &#123;        //å†æ¬¡æ£€æŸ¥        int recheck = ctl.get();        //2.1å¦‚æœçº¿ç¨‹æ± çŠ¶æ€çº¿ç¨‹æ± æ˜¯`SHUTDOWN`äº†ï¼Œå¹¶ä¸”èƒ½æˆåŠŸçš„æŠŠä»»åŠ¡ä»é˜Ÿåˆ—ä¸­ç§»é™¤        if (! isRunning(recheck) &amp;&amp; remove(command))        //æ‹’ç»ä»»åŠ¡            reject(command);        //2.2ä»»åŠ¡åŠ å…¥åˆ°é˜Ÿåˆ—äº†ï¼Œä½†æ˜¯å½“å‰æ²¡æœ‰å·¥ä½œçº¿ç¨‹å°±æ·»åŠ ä¸€ä¸ªçº¿ç¨‹        else if (workerCountOf(recheck) == 0)            addWorker(null, false);    &#125;    //3.     else if (!addWorker(command, false))        reject(command);&#125;<pre class="language-none"><code class="language-none">               3. AsyncCall   final class ã€ extends NamedRunnable   &#96;&#96;&#96;java   final class AsyncCall extends NamedRunnable &#123;     private final Callback responseCallback;     private final boolean forWebSocket;        private AsyncCall(Callback responseCallback, boolean forWebSocket) &#123;       super(&quot;OkHttp %s&quot;, originalRequest.url().toString());       this.responseCallback &#x3D; responseCallback;       this.forWebSocket &#x3D; forWebSocket;     &#125;</code></pre></div></code></pre></li></ol></li></ol></li><li><p>NamedRunnable</p><p>abstract class implments Runnable</p></li></ol><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>   <span class="token keyword">public</span> <span class="token class-name">NamedRunnable</span><span class="token punctuation">(</span><span class="token class-name">String</span> format<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>format<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token annotation punctuation">@Override</span> <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token class-name">String</span> oldName <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>    <span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>oldName<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">protected</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div></li><li><p>Request</p><p>ç†è§£Builderçš„è®¾è®¡æ€æƒ³</p></li><li><p>Call</p><p>åŸºæœ¬çš„å›è°ƒæ¥å£ç±»</p><p>request ã€executeã€ enqueueã€cancelã€isExcutedã€isCancled</p></li><li><p>Callback</p></li><li><p>Async</p></li></ol><h4 id="æµç¨‹åˆ†è¿°">æµç¨‹åˆ†è¿°</h4><h5 id="1-å¦‚ä½•å‘é€">1. å¦‚ä½•å‘é€</h5><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java">okHttpClient<span class="token punctuation">.</span><span class="token function">newCall</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">enqueue</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RealCall</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">enqueue</span><span class="token punctuation">(</span><span class="token class-name">Callback</span> responseCallback<span class="token punctuation">,</span> <span class="token keyword">boolean</span> forWebSocket<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>executed<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token string">"Already Executed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      executed <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    client<span class="token punctuation">.</span><span class="token function">dispatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">enqueue</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AsyncCall</span><span class="token punctuation">(</span>responseCallback<span class="token punctuation">,</span> forWebSocket<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">return</span> dispatcher<span class="token punctuation">;</span><span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">enqueue</span><span class="token punctuation">(</span><span class="token class-name">AsyncCall</span> call<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>runningAsyncCalls<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> maxRequests <span class="token operator">&amp;&amp;</span> <span class="token function">runningCallsForHost</span><span class="token punctuation">(</span>call<span class="token punctuation">)</span> <span class="token operator">&lt;</span> maxRequestsPerHost<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      runningAsyncCalls<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>call<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">executorService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>call<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>      readyAsyncCalls<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>call<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token class-name">ExecutorService</span> <span class="token function">executorService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>executorService <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      executorService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">,</span>          <span class="token keyword">new</span> <span class="token class-name">SynchronousQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Util</span><span class="token punctuation">.</span><span class="token function">threadFactory</span><span class="token punctuation">(</span><span class="token string">"OkHttp Dispatcher"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> executorService<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> command<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">int</span> c <span class="token operator">=</span> ctl<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">workerCountOf</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">&lt;</span> corePoolSize<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">addWorker</span><span class="token punctuation">(</span>command<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">return</span><span class="token punctuation">;</span>            c <span class="token operator">=</span> ctl<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isRunning</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> workQueue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> recheck <span class="token operator">=</span> ctl<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span> <span class="token function">isRunning</span><span class="token punctuation">(</span>recheck<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">remove</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token function">reject</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">workerCountOf</span><span class="token punctuation">(</span>recheck<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>                <span class="token function">addWorker</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">addWorker</span><span class="token punctuation">(</span>command<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token function">reject</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><h5 id="2-è¢«è°å¤„ç†">2. è¢«è°å¤„ç†</h5><h5 id="3-å¦‚ä½•ç»´æŠ¤">3. å¦‚ä½•ç»´æŠ¤</h5><h5 id="4-å»ºé€ è€…æ¨¡å¼">4. å»ºé€ è€…æ¨¡å¼</h5><p>ä¸éœ€è¦å…³æ³¨ç»†èŠ‚ï¼Œå®šåˆ¶ã€é»˜è®¤</p><p>é“¾å¼ç¼–ç¨‹   â€”return this</p><h5 id="5-è´£ä»»é“¾æ¨¡å¼">5. è´£ä»»é“¾æ¨¡å¼</h5><h3 id="Retrofit">Retrofit</h3><h4 id="å¥½å¤„">å¥½å¤„</h4><p>RetrofitåŸºäºokhttpå°è£…çš„ç½‘ç»œè¯·æ±‚æ¡†æ¶, ç½‘ç»œè¯·æ±‚çš„å·¥ä½œæœ¬è´¨ä¸Šæ˜¯ OkHttp å®Œæˆï¼Œè€Œ retrofit ä»…è´Ÿè´£ç½‘ç»œè¯·æ±‚æ¥å£çš„å°è£…ã€‚</p><p>Retrofitä¼˜åŠ¿ï¼Œå°±æ˜¯ç®€æ´æ˜“ç”¨,è§£è€¦,æ‰©å±•æ€§å¼º,å¯æ­é…å¤šç§Jsonè§£ææ¡†æ¶(ä¾‹å¦‚Gson),å¦å¤–è¿˜æ”¯æŒRxJava.ç½‘ç»œè¯·æ±‚çš„å·¥ä½œæœ¬è´¨ä¸Šæ˜¯ <code>OkHttp</code> å®Œæˆï¼Œè€Œ Retrofit ä»…è´Ÿè´£ ç½‘ç»œè¯·æ±‚æ¥å£çš„å°è£…</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210322153358168.png" alt="image-20210322153358168"></p><p>æ³¨è§£ç±»å‹</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210322153735717.png" alt="image-20210322153735717"></p><p>Retrofitä¸åšç½‘ç»œè¯·æ±‚ï¼Œä»–ç›¸å½“äºæ˜¯ä¸€ä¸ªä¸­é—´äºº</p><p>é€šè¿‡æ¥å£ï¼Œå¯¹æ¥å£æ–¹æ³•è¿›è¡Œæ³¨è§£</p><h4 id="åŸç†">åŸç†</h4><h5 id="åŠ¨æ€ä»£ç†">åŠ¨æ€ä»£ç†</h5><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">INetApiService</span> netApiService<span class="token operator">=</span> retrofit<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">INetApiService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p>è¿™é‡Œå¾—åˆ°çš„netApiServiceä¸æ˜¯æœ¬å°Šï¼Œè€Œåªæ˜¯ä¸€ä¸ªåŠ¨æ€ä»£ç†å¯¹è±¡</p><h4 id="ç±»">ç±»</h4><p><strong>Platform</strong></p><p><strong>ServiceMethod</strong>  ä¸€ä¸ª~ä»£è¡¨ä¸€ä¸ªè¯·æ±‚æ¥å£</p><p><strong>CallAdapter</strong></p><p>å…·ä½“ç±»å‹ä¸åŒçš„adapter  Rxjava Gson Java8 guava rxjavaâ€¦</p><h4 id="è®¾è®¡æ¨¡å¼">è®¾è®¡æ¨¡å¼</h4><p>åŠ¨æ€ä»£ç†</p><p>å·¥å‚æ¨¡å¼</p><p>å»ºé€ è€…æ¨¡å¼</p><p>å¤–è§‚æ¨¡å¼</p><h4 id="å·®å¼‚">å·®å¼‚</h4><p>Retrofitçš„Call æ”¯æŒæ³›å‹ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥ç”¨ä¸€ä¸ªbeanç±»è¿›è¡ŒåŒ…è£…ï¼Œç„¶åé€šè¿‡GSONç›´æ¥è¿”å›æƒ³å¾—åˆ°çš„å¯¹è±¡ï¼Ÿ</p><h4 id="é—®é¢˜">é—®é¢˜</h4><p>ä¸ºä»€ä¹ˆè¯·æ±‚åœ¨å­çº¿ç¨‹è€Œæ˜¾ç¤ºåœ¨UIä¸»çº¿ç¨‹ï¼Ÿ æ·»åŠ äº†Looperï¼Ÿ</p><h3 id="Volley">Volley</h3><h3 id="å›¾ç‰‡åŠ è½½æ¡†æ¶">å›¾ç‰‡åŠ è½½æ¡†æ¶</h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210329094112507.png" alt="image-20210329094112507"></p><h3 id="Glide">Glide</h3><p><strong>load</strong></p><p>ç©ºç™½fragment  â€“ æ§åˆ¶ç”Ÿå‘½å‘¨æœŸ</p><p>ä¸ºä»€ä¹ˆGlideä¸èƒ½åœ¨å­çº¿ç¨‹ä¸­ç»˜åˆ¶</p><p>å­çº¿ç¨‹ä¸­ä¸ä¼šæ·»åŠ ç”Ÿå‘½å‘¨æœŸæœºåˆ¶  ä¸»çº¿ç¨‹æ‰ä¼šå¯¹ç©ºç™½çš„fragmentç›‘å¬activiyty  fragmentå˜åŒ–</p><p>RequestBuilder</p><p>Retriver</p><p>å•ä¾‹æ¨¡å¼</p><p><strong>with</strong></p><p>ç±»å‹è½¬æ¢</p><p><strong>into</strong></p><p>å…‹éš†æ¨¡å¼</p><p>äº«å…ƒæ¨¡å¼ â€“ SingleRequest.obtain</p><p>Engingå±‚</p><p>è¿è¡Œç¼“å­˜ï¼š   æ´»åŠ¨ç¼“å­˜ï¼ˆé¢å‘ç”¨æˆ·ï¼‰ â€“ å†…å­˜ç¼“å­˜ï¼ˆæ´»åŠ¨ç¼“å­˜çš„äºŒçº§ç¼“å­˜ï¼‰</p><p>æ£€æµ‹æœ‰æ²¡æœ‰æ­£åœ¨æ‰§è¡Œçš„ç¼“å­˜å¯ç”¨ï¼ˆç£ç›˜ç¼“å­˜ï¼‰</p><p>ç½‘ç»œè¯·æ±‚</p><p>é«˜å±‚è®¾è®¡ï¼š</p><p>æ¥å£</p><p><strong>ç”Ÿå‘½å‘¨æœŸ</strong></p><p>LifeCycleListeneræ¥å£</p><p>ç©ºç™½Fragmenté™„ç€åœ¨activity  ç›‘å¬ç”Ÿå‘½å‘¨æœŸ</p><p>RequestManager æ§åˆ¶ ç”Ÿå‘½å‘¨æœŸ onstartæ–¹æ³•ä¸­æœ‰å¯¹targetTrackerã€ requestTrackerçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•è°ƒç”¨</p><p>è®¾è®¡æ¨¡å¼</p><h4 id="from">from</h4><h4 id="load">load</h4><h4 id="into">into</h4><h3 id="é¢è¯•é—®é¢˜-v2">é¢è¯•é—®é¢˜</h3><h4 id="ä¸ºä»€ä¹ˆå­çº¿ç¨‹ä¸èƒ½æ›´æ–°UI">ä¸ºä»€ä¹ˆå­çº¿ç¨‹ä¸èƒ½æ›´æ–°UI</h4><p>åŸå› ï¼š ViewRootIml.scheduleTraversalså¯¹viewè¿›è¡Œç»˜åˆ¶å‰ï¼Œå¯¹å½“å‰çº¿ç¨‹è¿›è¡Œæ£€æŸ¥æ˜¯ä¸æ˜¯ä¸»çº¿ç¨‹</p><p>ï¼Œå¤šçº¿ç¨‹åŠ è½½Uiä½¿å¾—èµ„æºæŠ¢å ï¼Œç•Œé¢æ›´æ–°æ··ä¹±</p><p>runOnUiThreadçš„ä½œç”¨</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> mUiThread<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">//å‘é€æ¶ˆæ¯åˆ°ä¸»çº¿ç¨‹çš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­</span>    mHandler<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token comment">//å¦‚æœæ˜¯ä¸»çº¿ç¨‹ï¼Œåˆ™ç›´æ¥æ‰§è¡Œ</span>    action<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><h4 id="View-post-å’Œ-Handler-postçš„åŒºåˆ«">View.post å’Œ Handler.postçš„åŒºåˆ«</h4><p>åœ¨Oncreateé‡Œç›´æ¥è°ƒç”¨View.getWidthæˆ–è€…View.getMeasuredWidthè¿”å›éƒ½æ˜¯0</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">post</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> action<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">final</span> <span class="token class-name">AttachInfo</span> attachInfo <span class="token operator">=</span> mAttachInfo<span class="token punctuation">;</span>    <span class="token comment">//å½“å‰viewåŠ å…¥åˆ°windowä¸­ï¼Œåˆ™ç›´æ¥ç”¨uiçº¿ç¨‹çš„handlerå‘é€æ¶ˆæ¯</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>attachInfo <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> attachInfo<span class="token punctuation">.</span>mHandler<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// Postpone the runnable until we know on which thread it needs to run.</span>    <span class="token comment">// Assume that the runnable will be successfully placed after attach.</span>    <span class="token comment">//æ²¡æœ‰åŠ å…¥åˆ°wndowä¸­ï¼Œæ”¾å…¥viewrootimplçš„Runqueueä¸­</span>    <span class="token function">getRunQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>å¦‚æœViewå°šæœªattachåˆ°windowçš„è¯ï¼Œrunnableè¢«æ”¾åˆ°äº†ViewRootImpl#RunQueueä¸­ï¼Œæœ€ç»ˆä¹Ÿä¼šè¢«å¤„ç†ï¼Œä½†ä¸æ˜¯é€šè¿‡MessageQueueã€‚</p><p>è€Œæ˜¯ç­‰åˆ°ViewRootImplçš„ä¸‹ä¸€ä¸ªperformTraversalsæ—¶å€™ï¼ŒæŠŠRunQueueé‡Œçš„æ‰€æœ‰runnableéƒ½æ‹¿å‡ºæ¥å¹¶æ‰§è¡Œ</p><h4 id="Gradleåˆ°åº•æ˜¯ä¸ªå•¥">Gradleåˆ°åº•æ˜¯ä¸ªå•¥</h4><h2 id="Mysql">Mysql</h2><h3 id="å¼•æ“">å¼•æ“</h3><h4 id="MyIAsm">MyIAsm</h4><h4 id="Inoodb">Inoodb</h4><h3 id="ç´¢å¼•">ç´¢å¼•</h3><h4 id="MyIAsmå’ŒInoodbçš„ä¸åŒ">MyIAsmå’ŒInoodbçš„ä¸åŒ</h4><h2 id="è®¡ç®—æœºåŸç†">è®¡ç®—æœºåŸç†</h2><h2 id="é¢è¯•">é¢è¯•</h2><p><strong>ç³»ç»ŸæŒ‰ä»€ä¹ˆè§„åˆ™å›æ”¶åå°çš„app</strong></p><p><a href="https://blog.csdn.net/u010227042/article/details/108451297?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161715872916780264092268%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=161715872916780264092268&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2">https://blog.csdn.net/u010227042/article/details/108451297?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161715872916780264092268%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=161715872916780264092268&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2</a><sub>all</sub>first_rank_v2~rank_v29-1-108451297.pc_search_result_hbase_insert&amp;utm_term=%E7%B3%BB%E7%BB%9F%E6%8C%89%E4%BB%80%E4%B9%88%E8%A7%84%E5%88%99%E5%9B%9E%E6%94%B6%E5%90%8E%E5%8F%B0%E7%9A%84app</p><p><strong>æ“ä½œç³»ç»Ÿçš„IOæ¨¡å‹</strong></p><p><strong>Java IO è®¾è®¡æ¨¡å¼</strong></p><p><strong>Linux Unix åŒºåˆ«</strong></p><p><strong>æµè§ˆå™¨è¾“å…¥urlå‘ç”Ÿäº†è‚¾ä¹ˆäº‹</strong></p>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Java</tag>
      
      <tag>Study</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼</title>
    <link href="/2021/01/08/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    <url>/2021/01/08/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1>è®¾è®¡æ¨¡å¼</h1><h2 id="å•ä¾‹æ¨¡å¼">å•ä¾‹æ¨¡å¼</h2><ol><li><p>DCL</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">&#123;</span>    <span class="token comment">//DCL </span>    <span class="token comment">//volatileè§£å†³æœ‰åºæ€§é—®é¢˜</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">volatile</span> <span class="token class-name">Singleton</span> singleton<span class="token punctuation">;</span>    <span class="token comment">//ç§æœ‰åŒ–æ„é€ æ–¹æ³•</span>    <span class="token keyword">private</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> <span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>singleton <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token class-name">Singleton</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//æ³¨æ„è¿™é‡Œçš„åŒé‡åˆ¤æ–­  é¿å…å¤šçº¿ç¨‹æ—¶å·²ç»è¿›å…¥ç¬¬ä¸€å±‚</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>singleton <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    singleton <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> singleton<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div></li><li><p>æœ€ç®€å•</p><p>é™æ€  ä¸€å¼€å§‹ä¾¿è£…è½½</p></li><li><p>é™æ€å†…éƒ¨ç±»</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">private</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    <span class="token comment">//é™æ€å†…éƒ¨ç±»ä¸ä¼šå†ä¸€å¼€å§‹å°±è¢«è£…è½½ï¼Œæ— å†…å­˜æ¶ˆè€—</span>    <span class="token comment">//JVMè£…è½½é™æ€å†…éƒ¨ç±»æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿï¼Ÿï¼Ÿ</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">SingletonInstance</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Singleton</span> singleton <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token class-name">Singleton</span> <span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">SingletonInstance</span><span class="token punctuation">.</span>singleton<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div></li><li><p>æšä¸¾Enum</p></li></ol><h3 id="æ¶ˆè´¹è€…ç”Ÿäº§è€…">æ¶ˆè´¹è€…ç”Ÿäº§è€…</h3><p>å¹³è¡¡ç”Ÿäº§è€…çš„ç”Ÿäº§èƒ½åŠ›å’Œæ¶ˆè´¹è€…çš„æ¶ˆè´¹èƒ½åŠ›æ¥æå‡æ•´ä¸ªç³»ç»Ÿçš„è¿è¡Œæ•ˆç‡</p><p>å®ç°</p><ol><li>wait</li><li>Lock</li><li>BlockingQueue</li></ol><p>ä¸ºä»€ä¹ˆç”¨while ä¸ç”¨ ifï¼Ÿ</p><p>while è‡ªæ—‹é”ï¼Œé˜²æ­¢è™šå‡å”¤é†’</p><h3 id="è™šå‡å”¤é†’-v2">è™šå‡å”¤é†’</h3><p>è™šå‡å”¤é†’å°±æ˜¯ä¸€äº›obj.wait()ä¼šåœ¨é™¤äº†obj.notify()å’Œobj.notifyAll()çš„å…¶ä»–æƒ…å†µè¢«å”¤é†’</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªç”Ÿäº§è€…-æ¶ˆè´¹è€…é˜Ÿåˆ—å’Œä¸‰ä¸ªçº¿ç¨‹ã€‚</p><p><strong>1ï¼‰</strong> 1å·çº¿ç¨‹ä»é˜Ÿåˆ—ä¸­è·å–äº†ä¸€ä¸ªå…ƒç´ ï¼Œæ­¤æ—¶é˜Ÿåˆ—å˜ä¸ºç©ºã€‚</p><p><strong>2ï¼‰</strong> 2å·çº¿ç¨‹ä¹Ÿæƒ³ä»é˜Ÿåˆ—ä¸­è·å–ä¸€ä¸ªå…ƒç´ ï¼Œä½†æ­¤æ—¶é˜Ÿåˆ—ä¸ºç©ºï¼Œ2å·çº¿ç¨‹ä¾¿åªèƒ½è¿›å…¥é˜»å¡(cond.wait())ï¼Œç­‰å¾…é˜Ÿåˆ—éç©ºã€‚</p><p><strong>3ï¼‰</strong> è¿™æ—¶ï¼Œ3å·çº¿ç¨‹å°†ä¸€ä¸ªå…ƒç´ å…¥é˜Ÿï¼Œå¹¶è°ƒç”¨cond.notify()å”¤é†’æ¡ä»¶å˜é‡ã€‚</p><p><strong>4ï¼‰</strong> å¤„äºç­‰å¾…çŠ¶æ€çš„2å·çº¿ç¨‹æ¥æ”¶åˆ°3å·çº¿ç¨‹çš„å”¤é†’ä¿¡å·ï¼Œä¾¿å‡†å¤‡è§£é™¤é˜»å¡çŠ¶æ€ï¼Œæ‰§è¡Œæ¥ä¸‹æ¥çš„ä»»åŠ¡(è·å–é˜Ÿåˆ—ä¸­çš„å…ƒç´ )ã€‚</p><p><strong>5ï¼‰</strong> ç„¶è€Œå¯èƒ½å‡ºç°è¿™æ ·çš„æƒ…å†µï¼šå½“2å·çº¿ç¨‹å‡†å¤‡è·å¾—é˜Ÿåˆ—çš„é”ï¼Œå»è·å–é˜Ÿåˆ—ä¸­çš„å…ƒç´ æ—¶ï¼Œæ­¤æ—¶1å·çº¿ç¨‹åˆšå¥½æ‰§è¡Œå®Œä¹‹å‰çš„å…ƒç´ æ“ä½œï¼Œè¿”å›å†å»è¯·æ±‚é˜Ÿåˆ—ä¸­çš„å…ƒç´ ï¼Œ1å·çº¿ç¨‹ä¾¿è·å¾—é˜Ÿåˆ—çš„é”ï¼Œæ£€æŸ¥åˆ°é˜Ÿåˆ—éç©ºï¼Œå°±è·å–åˆ°äº†3å·çº¿ç¨‹åˆšåˆšå…¥é˜Ÿçš„å…ƒç´ ï¼Œç„¶åé‡Šæ”¾é˜Ÿåˆ—é”ã€‚</p><p><strong>6ï¼‰</strong> ç­‰åˆ°2å·çº¿ç¨‹è·å¾—é˜Ÿåˆ—é”ï¼Œåˆ¤æ–­å‘ç°é˜Ÿåˆ—ä»ä¸ºç©ºï¼Œ1å·çº¿ç¨‹â€œå·èµ°äº†â€è¿™ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥å¯¹äº2å·çº¿ç¨‹è€Œè¨€ï¼Œè¿™æ¬¡å”¤é†’å°±æ˜¯â€œè™šå‡â€çš„ï¼Œå®ƒéœ€è¦å†æ¬¡ç­‰å¾…é˜Ÿåˆ—éç©ºã€‚</p><h3 id="BlockingQueueçš„å®ç°">BlockingQueueçš„å®ç°</h3><h2 id="è´£ä»»é“¾æ¨¡å¼">è´£ä»»é“¾æ¨¡å¼</h2><h2 id="å»ºé€ è€…æ¨¡å¼">å»ºé€ è€…æ¨¡å¼</h2><h2 id="å•ä¾‹æ¨¡å¼-v2">å•ä¾‹æ¨¡å¼</h2><h2 id="å·¥å‚æ¨¡å¼">å·¥å‚æ¨¡å¼</h2><h3 id="ç®€å•å·¥å‚æ¨¡å¼">ç®€å•å·¥å‚æ¨¡å¼</h3><h3 id="æŠ½è±¡å·¥å‚æ¨¡å¼">æŠ½è±¡å·¥å‚æ¨¡å¼</h3><h2 id="å¤–è§‚æ¨¡å¼">å¤–è§‚æ¨¡å¼</h2><p>**ä¸»è¦è§£å†³ï¼š**é™ä½è®¿é—®å¤æ‚ç³»ç»Ÿçš„å†…éƒ¨å­ç³»ç»Ÿæ—¶çš„å¤æ‚åº¦ï¼Œç®€åŒ–å®¢æˆ·ç«¯ä¸ä¹‹çš„æ¥å£ã€‚ä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›ä¸€ä¸ªä¸€è‡´çš„ç•Œé¢ï¼Œå¤–è§‚æ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªé«˜å±‚æ¥å£ï¼Œè¿™ä¸ªæ¥å£ä½¿å¾—è¿™ä¸€å­ç³»ç»Ÿæ›´åŠ å®¹æ˜“ä½¿ç”¨</p><p><strong>ä½•æ—¶ä½¿ç”¨ï¼š</strong> 1ã€å®¢æˆ·ç«¯ä¸éœ€è¦çŸ¥é“ç³»ç»Ÿå†…éƒ¨çš„å¤æ‚è”ç³»ï¼Œæ•´ä¸ªç³»ç»Ÿåªéœ€æä¾›ä¸€ä¸ª&quot;æ¥å¾…å‘˜&quot;å³å¯ã€‚ 2ã€å®šä¹‰ç³»ç»Ÿçš„å…¥å£ã€‚</p><p>ç¼ºç‚¹ï¼š ä¸ç¬¦åˆå¼€é—­åŸåˆ™ï¼Œå¦‚æœè¦æ”¹ä¸œè¥¿å¾ˆéº»çƒ¦ï¼Œç»§æ‰¿é‡å†™éƒ½ä¸åˆé€‚</p><p><a href="https://www.runoob.com/design-pattern/facade-pattern.html">https://www.runoob.com/design-pattern/facade-pattern.html</a></p><h2 id="ä»£ç†æ¨¡å¼">ä»£ç†æ¨¡å¼</h2><p>ç»“æ„å‹æ¨¡å¼  ä¸€ä¸ªç±»ä»£è¡¨å¦ä¸€ä¸ªç±»çš„åŠŸèƒ½</p><p>**æ„å›¾ï¼š**ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚</p><p>**ä¸»è¦è§£å†³ï¼š**åœ¨ç›´æ¥è®¿é—®å¯¹è±¡æ—¶å¸¦æ¥çš„é—®é¢˜ï¼Œæ¯”å¦‚è¯´ï¼šè¦è®¿é—®çš„å¯¹è±¡åœ¨è¿œç¨‹çš„æœºå™¨ä¸Šã€‚åœ¨é¢å‘å¯¹è±¡ç³»ç»Ÿä¸­ï¼Œæœ‰äº›å¯¹è±¡ç”±äºæŸäº›åŸå› ï¼ˆæ¯”å¦‚å¯¹è±¡åˆ›å»ºå¼€é”€å¾ˆå¤§ï¼Œæˆ–è€…æŸäº›æ“ä½œéœ€è¦å®‰å…¨æ§åˆ¶ï¼Œæˆ–è€…éœ€è¦è¿›ç¨‹å¤–çš„è®¿é—®ï¼‰ï¼Œ<strong>ç›´æ¥è®¿é—®ä¼šç»™ä½¿ç”¨è€…æˆ–è€…ç³»ç»Ÿç»“æ„å¸¦æ¥å¾ˆå¤šéº»çƒ¦</strong>ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è®¿é—®æ­¤å¯¹è±¡æ—¶åŠ ä¸Šä¸€ä¸ªå¯¹æ­¤å¯¹è±¡çš„è®¿é—®å±‚ã€‚</p><h3 id="é™æ€ä»£ç†-v2">é™æ€ä»£ç†</h3><p>ä¸šåŠ¡æ¥å£ â€” &gt; åŸºæœ¬å®ç°ç±»  â€”&gt; ä»£ç†ç±»</p><p>ç¼ºç‚¹ï¼š ä»£ç é‡å¤ ã€ ä¸ºå•ä¸€ç±»å‹å¯¹è±¡æœåŠ¡</p><h3 id="åŠ¨æ€ä»£ç†-v3">åŠ¨æ€ä»£ç†</h3><p>ä¸šåŠ¡æ¥å£ â€”&gt; åŸºæœ¬å®ç°ç±» â€” &gt;åŠ¨æ€ä»£ç†ç±»</p><p>æ ¸å¿ƒ InvocationHandler</p><h2 id="äº«å…ƒæ¨¡å¼">äº«å…ƒæ¨¡å¼</h2><h2 id="é€‚é…å™¨æ¨¡å¼">é€‚é…å™¨æ¨¡å¼</h2><p>ä¸¤ä¸ªæ¥å£çš„æ¡¥æ¢ â€” ç”µæºé€‚é…å™¨</p><p>Target â€“ Adaptee â€“ Adapter</p><p>ä¸€ä¸ªäº‹ç‰©æœ¬æ¥å·²ç»å¾ˆå¥½äº†ï¼Œä½†æ˜¯æ‰¾ä¸åˆ°åˆé€‚çš„å¯¹è±¡å»å¯¹æ¥ï¼Œï¼ˆæ–°è€ç‰ˆæœ¬æ›´æ›¿ï¼Œè€ç‰ˆæœ¬/æ–°ç‰ˆæœ¬å¦‚ä½•é€‚é…ï¼‰</p><p>æé«˜äº†ç±»çš„å¤ç”¨ï¼Œè®©æ²¡æœ‰å…³è”çš„ä¸¤ä¸ªç±»ä¸€èµ·è¿è¡Œï¼Œæ— å±‚çº§å…³ç³»</p><h3 id="JavaIO-é€‚é…å™¨æ¨¡å¼å’Œè£…é¥°è€…æ¨¡å¼çš„åŒºåˆ«">JavaIO é€‚é…å™¨æ¨¡å¼å’Œè£…é¥°è€…æ¨¡å¼çš„åŒºåˆ«</h3><p>InputStreamReaderç»§æ‰¿äº†ReaderæŠ½è±¡ç±»å¹¶å®ç°ï¼Œä¸”æŒæœ‰äº†InputStreamçš„å¼•ç”¨ï¼Œè¿™é‡Œæ˜¯é€šè¿‡StreamDecoderç±»é—´æ¥æŒæœ‰çš„ï¼Œå› ä¸ºä»byteåˆ°charè¦ç»è¿‡ç¼–ç ã€‚<br>å¾ˆæ˜¾ç„¶ï¼Œé€‚é…å™¨å°±æ˜¯InputStreamReaderï¼Œæºè§’è‰²å°±æ˜¯InputStreamä»£è¡¨çš„å®ä¾‹å¯¹è±¡ï¼Œç›®æ ‡æ¥å£å°±æ˜¯Readerç±»ã€‚OutputStreamWriter ä¹Ÿç±»ä¼¼ã€‚</p><p>InputeStream ç±»å°±æ˜¯ä»¥æŠ½è±¡ç»„ä»¶å­˜åœ¨çš„ï¼šè€ŒFileInputStreamå°±æ˜¯å…·ä½“ç»„ä»¶ï¼Œå®ƒå®ç°äº†æŠ½è±¡ç»„ä»¶çš„æ‰€æœ‰æ¥å£ï¼›FilterInputStreamç±»æ— ç–‘å°±æ˜¯è£…é¥°è§’è‰²ï¼Œå®ƒå®ç°äº†InputStreamç±»çš„æ‰€æœ‰æ¥å£ï¼Œå¹¶ä¸”æŒæœ‰InputStreamçš„å¯¹è±¡å®ä¾‹çš„å¼•ç”¨ï¼›<br>BufferedInputStreamæ˜¯å…·ä½“çš„è£…é¥°å™¨å®ç°è€…ï¼Œå®ƒç»™InputStreamç±»é™„åŠ äº†åŠŸèƒ½ï¼Œè¿™ä¸ªè£…é¥°å™¨ç±»çš„ä½œç”¨å°±æ˜¯ä½¿å¾—InputStreamè¯»å–çš„æ•°æ®ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œè€Œæé«˜è¯»å–çš„æ€§èƒ½ã€‚ä¸è¿™ä¸ªè£…é¥°å™¨ç±»æœ‰ç±»ä¼¼åŠŸèƒ½çš„è¿˜æœ‰LineNumberInputStreamï¼ˆjava 1.8 å·²ç»è¿‡æœŸï¼‰ç±»ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯æé«˜è¡ŒæŒ‰è¡Œè¯»å–æ•°æ®çš„åŠŸèƒ½ï¼Œå®ƒä»¬éƒ½æ˜¯InputStreamç±»å¢å¼ºäº†åŠŸèƒ½ï¼Œæˆ–è€…æå‡äº†æ€§èƒ½ã€‚</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210331230002191.png" alt="image-20210331230002191"></p><h2 id="è£…é¥°è€…æ¨¡å¼">è£…é¥°è€…æ¨¡å¼</h2><p>å‘ä¸€ä¸ªç°æœ‰çš„å¯¹è±¡æ·»åŠ æ–°çš„åŠŸèƒ½ï¼ŒåŒæ—¶ä¸æ”¹å˜å…¶ç»“æ„ï¼Œä½œä¸ºç°æœ‰ç±»çš„ä¸€ä¸ªåŒ…è£…ï¼ŒåŠ¨æ€æ‰©å±•ä¸€ä¸ªå®ç°ç±»çš„åŠŸèƒ½</p><p>component : æŠ½è±¡ç»„ä»¶è§’è‰²ï¼Œå®šä¹‰ä¸€ç»„æŠ½è±¡çš„æ¥å£ï¼Œè§„å®šè¿™ä¸ªè¢«è£…é¥°ç»„ä»¶éƒ½æœ‰å“ªäº›åŠŸèƒ½<br>concreteComponentï¼šå®ç°è¿™ä¸ªæŠ½è±¡ç»„ä»¶çš„æ‰€æœ‰åŠŸèƒ½ã€‚<br>Decoratorï¼šè£…é¥°å™¨è§’è‰²ï¼Œå®ƒæŒæœ‰ä¸€ä¸ªcomponentå¯¹è±¡å®ä¾‹çš„å¼•ç”¨ï¼Œå®šä¹‰ä¸€ä¸ªä¸æŠ½è±¡ç»„ä»¶ä¸€è‡´çš„æ¥å£<br>ConcreteDecoratorï¼šå…·ä½“çš„è£…é¥°å™¨å®ç°è€…ï¼Œè´Ÿè´£å®ç°è£…é¥°å™¨è§’è‰²å®šä¹‰çš„åŠŸèƒ½</p><h3 id="mvpåˆ°åº•æœ‰ä»€ä¹ˆä»€ä¹ˆä½œç”¨ï¼Ÿæ€ä¹ˆè§£è€¦çš„ï¼Ÿ">mvpåˆ°åº•æœ‰ä»€ä¹ˆä»€ä¹ˆä½œç”¨ï¼Ÿæ€ä¹ˆè§£è€¦çš„ï¼Ÿ</h3>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®‰å“æ•°ç‹¬æ¸¸æˆUIè®¾è®¡</title>
    <link href="/2020/12/23/%E5%AE%89%E5%8D%93%E6%95%B0%E7%8B%AC%E6%B8%B8%E6%88%8F%E7%95%8C%E9%9D%A2%E5%BC%80%E5%8F%91/"/>
    <url>/2020/12/23/%E5%AE%89%E5%8D%93%E6%95%B0%E7%8B%AC%E6%B8%B8%E6%88%8F%E7%95%8C%E9%9D%A2%E5%BC%80%E5%8F%91/</url>
    
    <content type="html"><![CDATA[<h1>Sudoku Game</h1><!-- toc --><p>[toc]</p><hr><h2 id="Introduce-v2">Introduce</h2><ul><li>A conventional sudoku game with 9*9 blocks using Java and through Android Studio.</li><li>As for the specific operation rule of this game , you need to first press the blocks above the 9*9 matrix blocks, and drug it to the â€˜?â€™ or the block you want to change (not including the original array) .</li><li>click the â€œSHOWANSWERâ€  button , the complete correct Sudoku matrix will show on the screen ,with the imgs on the unknown blocks bling twice</li></ul><span id="more"></span><h3 id="Preview">Preview</h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/mainScreen.png" alt="hh"> <img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/levelSelect.png" alt="levelSelect"><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/gameScreen.png" alt=""><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/answerShow.png" alt="answerShow"><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/records.png" alt="records"><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/record_2.png" alt="record_2"><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/record_3.png" alt="record_3"></p><h2 id="UI-Settings">UI Settings</h2><h3 id="Previous-Thoughtï¼ˆavoid-delayï¼‰">Previous  Thoughtï¼ˆavoid delayï¼‰</h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201220105134759.png" alt="image-20201220105134759"></p><ul><li>9*9 Blocks Design  :  Itâ€™s certain to abandon statically add ImageView to the parent view. So First I was thinking to use GridLayout, and dynamically generate  81 ImageViews inside it . It worked  , but hearing that recyclerview can save some storage using â€¦?(not so sure),so I turn my side to Recyclerview.But it proves that in a way itâ€™s actually better ,at least I donâ€™t need to care about the dividing line â€¦</li><li>Game-Run Rules  :  In the  first , the action that moving finger on screen to dynamically set the block position of choosing number may be a delayed process ( After that , it proves that I was wrong . Delay is just the images is too bigâ€¦). So I choose to a rule when click a number above  , and click again the blocks below ,to fill the 9x9 blocks . But this method is just a conventional way ,not attractive enough</li></ul><h3 id="Better-Way-Improve-User-Experience">Better Way (Improve User Experience)</h3><ul><li>So after I ran through the delayed problem and adjusted the imgs to a much smaller size.(from 800 kb to 4kb per Imagesâ€¦) , I go back to my first strategy, to timely let the block move with your finger. And when your finger get up ,it will be removed from parent views ,and there will be a judge about its position.</li></ul><h3 id="Thoughts-of-Afterclass-Improvement">Thoughts of Afterclass Improvement</h3><ul><li>maybe some ugly button imgs can be changed?</li><li>packages classification</li><li>MVC model</li></ul><h2 id="Using-of-Class">Using of Class</h2><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201219223339691.png" alt="image-20201219223339691"></p><ul><li><p>MainActivity:  handling LegacyRequest   , LitePal Connect and some Ui settings</p></li><li><p>AboutActivity: developer information  and Lottie Animation</p></li><li><p>RecordBitmap: a bean class with some necessary data of a complete game record , including view bitmaps, dates ,completion dateâ€¦</p></li><li><p>LevelChoosePanel: a Ui class for Level-Choose-Panel Ui layout</p></li><li><p>WrongBorder : a Ui class for a  border view when detecting answer is wrong.</p></li><li><p>RecordShowActivity: handling Records show page , including a recyclerview layout .</p></li><li><p>recycleutil:  Recyclerview Adapter and Decoration for its Ui setting.</p></li><li><p><strong>GamingActivity:</strong>  most important activity in this project. including  handling logically generate 9*9 Sudoku matrix, dynamically generate 9x9Ui Blocks(ImageView actually) and check wrong blocks in real time. Also handling gesture listener including finger DOWN , MOVE and UP .</p></li><li><p><strong>SudoHelper</strong> : core algorithm handling module class , to generate a 9*9 Sudoku with only one answer ,and detect validity of current 9x9 Matrix</p></li></ul><h2 id="Algorithm-Use">Algorithm Use</h2><h3 id="Previous-Thoughts-And-Problem">Previous Thoughts And Problem :</h3><ul><li>Previously , I was thinking to use a way of generation method with not-only answer. The method is quite easy. First to choose N (N=30) blocks , each row , column and numbers inside it is random on the condition that it matches the rules of Sudoku. And them use backTrace Method to fill other blocks remaining. And when to judge in the gameActivity , we just need to use the <strong>isValid()</strong> method to detect if this column &amp; row &amp; 3*3 matrix around it fit the rules , if not , thatâ€™s wrong. Thus it may provide different answers, due to detecting the 9x9 matrix it provides in the first step.</li></ul><h3 id="After-Improvement">After Improvement :</h3><ul><li><p>As seeing more, a standard Sudoku is a 9*9 Matrix with only one answer. So , to improve this , I use two types of buckTrace() method , difference is if it changes the origin matrix it gives.</p></li><li><p>So , first We randomly choose N different block , and under the rules, filling it with random number. Then using the original backTrace()  method (changes params it gives in). We get a correct 9x9 Sudoku Matrix. And then, we dig put specific numbers of blocks . In each digging process ,we detect that besides the original number in the matrix ,if thereâ€™s other number that could make current matrix be a standard matrix . If not , we can safely dig out this number ,and go further , else ,we may need to change the position ï¼ˆgenerate row and column randomly againï¼‰,until we dig out enough numbers of blocks . We get a matrix with only one answer.</p></li><li><p>Some optimization thoughts: if some time , the matrix is not good. Maybe we randomly find many blocks ,but it still canâ€™t be dug out .Therefore ,we may need to go back in the first step, generating a new matrix and do the works below. So we can set a number to record the failed dig-out search , if the number is bigger than a certain number , we re-generate it . So ,in some case ,it may avoid time consuming work inside this methods.</p></li></ul><h2 id="Things-can-be-better">Things can be better</h2><ul><li>Ui , have to say , the Ui design is really so soâ€¦But time is catching up , no time for that . So sometime Ui need to be modified.</li></ul><h2 id="Thanks">Thanks :</h2><ul><li><p>Sincerely thanks for watching this. If any details and humble opinion could contribute to your thoughts , I would be content. And if you have any advice or doubts , welcome to put it there.</p></li><li><p>Contact : <a href="mailto:401177923@qq.com">401177923@qq.com</a></p></li></ul>]]></content>
    
    
    <categories>
      
      <category>ä¸ªäººé¡¹ç›®</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>OOPå¤ä¹ </title>
    <link href="/2020/12/23/OOP%E5%A4%8D%E4%B9%A0/"/>
    <url>/2020/12/23/OOP%E5%A4%8D%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1>OOPå¤ä¹  æŒ‡åŒ—</h1><ol><li><p>å·¥å‚æ–¹æ³•               P117</p></li><li><p>é™æ€boolean ä¸ºfalse mainæ–¹æ³•ä¸­çš„boolean  æ²¡æœ‰åˆå§‹å€¼</p></li><li><p>this åœ¨ä¸€ä¸ªæ„é€ å™¨ä¸­è°ƒç”¨å¦ä¸€ä¸ªæ„é€ å™¨æ–¹æ³•</p></li><li><p>é™æ€åˆå§‹åŒ–å— è¿è¡Œæ¬¡åºé«˜äºåˆå§‹åŒ–å— ä¸”éšç€ç¬¬ä¸€ä¸ªç±»å¯¹è±¡çš„åˆ›ç«‹åªè¿è¡Œä¸€æ¬¡ï¼Œä¸”è°ƒç”¨ç¨‹åºçš„é™æ€æ–¹æ³•ï¼Œä¸åˆ›å»ºå¯¹è±¡æ—¶ï¼Œè¯¥static æ–¹æ³•ä½“ä¹Ÿä¼šè¢«æ‰§è¡Œï¼Œä»…æ‰§è¡Œä¸€æ¬¡ã€‚åˆå§‹åŒ–å—çš„è¿è¡Œæ¬¡åº é«˜äº æ„é€ å™¨æ–¹æ³•,ä¸è®ºæ”¾ç½®çš„æ¬¡åºå¦‚ä½•ã€‚</p><p>æ‰§è¡Œé¡ºåº: çˆ¶ç±»çš„é™æ€æ–¹æ³•----&gt;å­ç±»çš„é™æ€æ–¹æ³•----&gt; çˆ¶ç±»çš„æ„é€ ----&gt;å­ç±»çš„æ„é€ â€¦</p><p>å•ä¸ªç±»ï¼šé™æ€åˆå§‹åŒ–å—â€“&gt;æˆå‘˜å˜é‡åˆå§‹åŒ–â€”&gt;å—ä½œç”¨åŸŸâ€”&gt;æ„é€ æ–¹æ³•</p><span id="more"></span><p>å…ˆ è¿›è¡Œå±æ€§çš„åˆå§‹åŒ–  åœ¨è¿›è¡Œæ„é€ æ–¹æ³•çš„åˆå§‹åŒ–</p><p>ç»§æ‰¿å…³ç³»æ—¶çš„è°ƒç”¨æ¬¡åºï¼šç‰¹æ®Š</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> a<span class="token operator">=</span><span class="token function">getA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"father static"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"father &#123;&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">Father</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"father public "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"father propertiyu a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span>  <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201118083928612.png" alt="image-20201118083928612"></p></li><li><p>ç±»å¯¹è±¡å±æ€§ æœ‰åˆå§‹å€¼  0 false null</p></li><li><p>é™æ€å¯¼å…¥                  P136</p></li><li><p>ç»§æ‰¿            P162</p></li><li><p>ç­¾åå’Œå¯åå˜ã€é™æ€ç»‘å®š å’ŒåŠ¨æ€ç»‘å®š                              P164</p></li><li><p>final ç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•è‡ªåŠ¨å˜ä¸ºfinal æ–¹æ³•</p></li><li><p>instanceof æ˜¯åˆ¤æ–­å…¶ æ˜¯å¦æ˜¯ è¯¥ç±»æˆ–è€…è¯¥ç±»çš„å­ç±»</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">new</span> <span class="token class-name">Son</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">instanceof</span> <span class="token class-name">Father</span>    <span class="token comment">//æ³¨æ„ä½¿ç”¨instanceçš„æ–¹å¼</span></code></pre></div></li><li><p>ç±»å‹å¼ºè½¬åªåœ¨ç»§æ‰¿å±‚æ¬¡å…³ç³»è¿›è¡Œï¼Œå¦åˆ™ä¼šæŠ¥é”™</p></li><li><p>çˆ¶ç±»å¯ä»¥æœ‰å®ç°çš„æ–¹æ³•å’Œå­—æ®µï¼Œä¹Ÿå¯ä»¥æ²¡æœ‰æŠ½è±¡æ–¹æ³•ï¼Œä½†æŠ½è±¡æ–¹æ³•å¿…é¡»åœ¨å­ç±»ä¸­å®ç°</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Man</span> m<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Male</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å®šä¹‰æŠ½è±¡ç±»çš„å¯¹è±¡å˜é‡ï¼Œä½†è¿™æ ·æ˜¯æ— æ³•è°ƒç”¨å­ç±»çš„ç‰¹æ®Šæ–¹æ³•çš„ï¼Œè¿™é‡Œæ³¨æ„å¤šæ€æ€§çš„ä½“ç°</span></code></pre></div></li><li><p>é™¤åŸºæœ¬ç±»å‹å¤–ï¼Œéƒ½æ˜¯å¯¹è±¡ï¼Œæ•°ç»„ä¹Ÿæ˜¯å¯¹è±¡</p></li><li><p>ArrayList  set add æ–¹æ³•çš„åŒºåˆ«ï¼Œä»¥åŠä¸ç”¨æ³›å‹æ—¶ è¿”å›çš„æ˜¯Objectå¯¹è±¡</p></li><li><p>åŒ…è£…ï¼š ä¸€æ—¦æ„é€ äº†åŒ…è£…å™¨å°±ä¸èƒ½æ”¹å˜è´®è—åœ¨å…¶ä¸­çš„å€¼</p><p>åŒ…è£…ç±»çš„ è‡ªåŠ¨è£…ç®±å’Œè‡ªåŠ¨æ‹†ç®±</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Integer</span> a<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">;</span>        <span class="token class-name">Integer</span> b<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">;</span>        <span class="token class-name">Integer</span> c<span class="token operator">=</span><span class="token number">2000</span><span class="token punctuation">;</span>        b<span class="token operator">=</span>a<span class="token punctuation">;</span>        a<span class="token operator">=</span>c<span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// b=1000;</span></code></pre></div></li><li><p>æ¥å£ ï¼š å¯ä»¥æœ‰  å®ä¾‹åŒ–åŸºæœ¬ç±»å‹  int â€¦ ä½†æ˜¯å®ä¾‹åŒ–æ¥å£å¯¹è±¡åä½œä¸ºçš„æ˜¯static final å¸¸é‡ï¼Œä¸èƒ½ä¿®æ”¹ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡å®ç°ç±»è®¿é—®ã€‚æ¥å£ä¸­å¯ä»¥æœ‰æŠ½è±¡æ–¹æ³•ï¼Œæ‰€æœ‰æŠ½è±¡æ–¹æ³•å¿…é¡»å®šä¹‰ï¼Œå¯ä»¥æœ‰default æ–¹æ³•ï¼Œå¯ä»¥æœ‰privateæ–¹æ³•ä½†æ˜¯privateæ–¹æ³•å¿…é¡»åœ¨æ¥å£å®ç°ï¼Œé™¤private å¤– ä¸ç”¨åŠ ä¿®é¥°ç¬¦ï¼Œé»˜è®¤ä¸ºpublicï¼Œä¸å…è®¸æœ‰å—ä½œç”¨åŸŸå’Œé™æ€åˆå§‹åŒ–å—   default æ–¹æ³•å¯ä»¥åœ¨å­æ¥å£ä¸­å¾—åˆ°é‡å†™ï¼Œä¸”é»˜è®¤æ–¹æ³•å¯ä»¥è°ƒç”¨å…¶ä»–æ–¹æ³•ã€‚</p></li><li><p>å†…éƒ¨ç±»ä¸­çš„æ‰€æœ‰é™æ€å­—æ®µ  å¿…é¡»æ˜¯final å£°æ˜å±€éƒ¨å†…éƒ¨ç±»æ—¶ï¼Œä¸èƒ½æœ‰è®¿é—®è¯´æ˜ç¬¦ã€‚é™æ€å†…éƒ¨ç±»ï¼Œä¸ä¼šç”Ÿæˆå¼•ç”¨</p></li><li><p>åœ¨try catch å—ä¸­catchåˆ°å¼‚å¸¸æ—¶ï¼Œ å‘ç”Ÿå¼‚å¸¸å¤„ä¹‹åçš„è¯­å¥éƒ½ä¸ä¼šæ‰§è¡Œ</p><p>åœ¨å—ä¸­å‡ºç°æ²¡æœ‰ catchæƒ…å†µçš„å¼‚å¸¸æ—¶ï¼Œä¼šæ‰§è¡Œ finally åçš„è¯­å¥ï¼Œä½†æ‰§è¡Œå®Œfinallyåçš„è¯­å¥ä¾¿ä¼šè¿”å›ï¼Œä¸ä¼šå†try catch-finallyå—ä¹‹åçš„è¯­å¥äº†</p><p>try - with -resources è‡ªåŠ¨close</p></li><li><p>æ£€æŸ¥å¼‚å¸¸å’Œéæ£€æŸ¥å¼‚å¸¸</p></li><li><p>String å¸¸é‡   å­—ç¬¦ä¸²ç¼“å†²æ± </p><p>[<a href="https://blog.csdn.net/nc_yhy/article/details/78474468?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522160561320919724839249458%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=160561320919724839249458&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2">https://blog.csdn.net/nc_yhy/article/details/78474468?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522160561320919724839249458%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=160561320919724839249458&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2</a><sub>all</sub>sobaiduend~default-1-78474468.pc_search_result_no_baidu_js&amp;utm_term=String+%E5%B8%B8%E9%87%8F&amp;spm=1018.2118.3001.4449]:</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201117194626755.png" alt="image-20201117194626755"></p></li></ol><p>21.åµŒå¥—å¼‚å¸¸è¯¦è§£ï¼š</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java">    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> a<span class="token operator">=</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">0</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"after 3/0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ArithmeticException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"arit cath"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"inner excption"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Exception"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"outer exception"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201117200610606.png" alt="image-20201117200610606"></p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java">  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IOException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//int a=3/0;</span>            <span class="token comment">//System.out.println("after 3/0");</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ArithmeticException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"arit cath"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"inner excption"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Exception"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"outer exception"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201117201055655.png" alt="image-20201117201055655"></p><p>æ€»ç»“ä¸€ä¸‹ï¼š å†…å±‚æ•è·åˆ°çš„excption åœ¨å¤–å±‚ä¸ä¼šå†æ•è·ï¼Œå“ªæ€•æ˜¯çˆ¶å­å…³ç³»ã€‚ä¸”ä¸ä¼šæ‰§è¡Œtryä¸­ä¹‹åçš„è¯­å¥ï¼Œè€Œæ˜¯æ‰§è¡Œfinallyçš„è¯­å¥</p><ol start="22"><li><p>æ¦‚å¿µæ€§å†…å®¹ï¼š</p><ol><li>ç±»çš„ç‰¹æ€§ï¼š</li></ol><ul><li><p>å°è£…ï¼šåœ¨æŠ½è±¡çš„åŸºç¡€ä¸ŠæŠŠå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ç»„åˆæˆä¸€ä¸ªç‹¬ç«‹çš„å•ä½ï¼Œå¹¶å°½å¯èƒ½éšè—å¯¹è±¡çš„å†…éƒ¨ç»†èŠ‚ã€‚</p></li><li><p>å¤šæ€ï¼šç”¨åŒä¸€ä¸ªåå­—å®šä¹‰ä¸åŒçš„æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•ä½“çš„è¯­å¥ä¸åŒï¼Œä½†å®ç°çš„åŠŸèƒ½ç±»ä¼¼ ã€‚å³åŒåçš„æ–¹æ³•å¯ä»¥åœ¨ä¸åŒçš„ç±»ä¸­æœ‰ä¸åŒçš„è¡Œä¸º</p></li><li><p>ç»§æ‰¿ï¼ˆæ³›åŒ–ï¼‰ï¼šåœ¨å·²æœ‰ç±»çš„åŸºç¡€ä¸Šæ´¾ç”Ÿå‡ºæ–°çš„ç±»ï¼Œæ–°çš„ç±»èƒ½å¤Ÿç»§æ‰¿å·²æœ‰ç±»çš„å±æ€§å’Œæ–¹æ³•ï¼Œå¹¶ä¸”æ‰©å±•æ–°çš„å±æ€§å’Œæ–¹æ³•ã€‚å³ä¸€ä¸ªå¯¹è±¡ä»å¦ä¸€ä¸ªå¯¹è±¡è·å¾—å±æ€§å’Œæ–¹æ³•çš„è¿‡ç¨‹</p></li><li><p>æŠ½è±¡ç±»ï¼šä¸€ä¸ªç±»ä¸­æ²¡æœ‰åŒ…å«è¶³å¤Ÿçš„ä¿¡æ¯æ¥æç»˜ä¸€ä¸ªå…·ä½“çš„å¯¹è±¡</p></li><li><p>ç±»æ˜¯ä¸€ç»„å…·æœ‰ç›¸åŒå±æ€§å’Œè¡Œä¸ºçš„å¯¹è±¡çš„æŠ½è±¡</p></li></ul><ol start="2"><li><p>å¯¹è±¡åŸºæœ¬ç‰¹å¾</p><p>å”¯ä¸€æ€§   åˆ†ç±»æ€§   ç»§æ‰¿æ€§   å¤šæ€æ€§</p><p>ä¸‰å¤§åŸºæœ¬ç‰¹å¾æ˜¯ ï¼š å°è£…ç»§æ‰¿å¤šæ€</p></li><li><p>å¯¹è±¡è¦ç´ </p><p>æŠ½è±¡   å°è£…  å…±äº«  å¼ºè°ƒå¯¹è±¡ç»“æ„</p></li><li><p><strong>å¯¹è±¡çš„åŸºæœ¬ç‰¹ç‚¹</strong>ï¼šæ ‡è¯†å”¯ä¸€æ€§ã€åˆ†ç±»æ€§ã€å¤šæ€æ€§ã€å°è£…è¡Œã€æ¨¡å—ç‹¬ç«‹æ€§å¥½ï¼›</p></li><li><p>è¿è¡Œè¿‡ç¨‹ï¼š</p><p>ç¼–è¾‘</p><p>ç¼–è¯‘ï¼šjavaç¼–è¯‘å™¨</p><p>åŠ è½½ï¼šjavaç±»åŠ è½½å™¨  åŠ è½½åˆ°å†…å­˜</p><p>éªŒè¯ï¼šjavaéªŒè¯å™¨</p><p>æ‰§è¡Œï¼šjavaç±»è§£é‡Šå™¨      ç¿»è¯‘å­—èŠ‚ç ä¸ºå¯æ‰§è¡Œçš„æœºå™¨ä»£ç </p></li><li><p>å¯¹è±¡å…·æœ‰ æ ‡è¯†ç¬¦  å±æ€§  è¡Œä¸º</p></li><li><p>é¢å‘å¯¹è±¡ï¼š æ–°çš„è½¯ä»¶å¼€å‘å’Œç¨‹åºè®¾è®¡æŠ€æœ¯ï¼Œè®¤ä¸ºå®¢è§‚äº‹ç‰©éƒ½æ˜¯ç”±å¯¹è±¡ç»„æˆçš„ï¼Œå¯¹è±¡æ˜¯åœ¨åŸäº‹ç‰©åŸºç¡€ä¸ŠæŠ½è±¡çš„ç»“æœ</p></li><li><p>æœåŠ¡ï¼šé€šå¸¸è¢«ç§°ä¸º æ–¹æ³• æˆ– ç»“æœâ€˜</p></li><li><p>åŒ…æ˜¯javaæä¾›çš„ä¸€ç§åŒºåˆ«ç±»çš„åå­—æ§ä»¶çš„æå€¼ï¼Œæ˜¯ç±»çš„ç»„ç»‡æ–¹å¼ï¼Œæ˜¯ä¸€ç§ç›¸å…³ç±»å’Œæ¥å£çš„é›†åˆï¼Œæä¾›äº†è®¿é—®æƒé™å’Œå‘½åçš„ç®¡ç†æœºåˆ¶ã€‚</p></li></ol></li><li><p>æ¥å£å’Œç»§æ‰¿çš„ä¸åŒ  æ¥å£å’ŒæŠ½è±¡ç±»çš„æ¯”è¾ƒ   P149</p><ul><li>ç»§æ‰¿ä¿®æ”¹æ—§çš„åŠŸèƒ½ï¼Œæ¥å£å®ç°æ–°çš„åŠŸèƒ½</li></ul></li><li><p>ä½¿ç”¨å¤šæ€çš„å¥½å¤„  P138</p><p>å¯é‡ç”¨æ€§</p><p>å¯æ‰©å……æ€§ã€å¯ç»´æŠ¤æ€§ã€åŠ¨æ€ç»‘å®š</p></li><li><p>æ•°æ®åº“ JDBCç”¨åˆ°çš„å››å¤§ç±»</p></li><li><p>UMLï¼š</p><ol><li><p>ç»„æˆï¼šäº‹åŠ¡ å…³ç³»  å›¾</p></li><li><p>åˆ†ç±»ï¼š</p><ol><li><p>ç”¨ä¾‹å›¾ï¼š</p><p>ç®€è¦è¯´æ˜ ä¸»äº‹ä»¶æµå’Œå…¶ä»–äº‹ä»¶æµ  å‰ææ¡ä»¶  äº‹åæ¡ä»¶</p></li><li><p>ç±»å›¾ï¼šï¼ˆé‡è¦ï¼‰</p><p>æ˜¾ç¤ºäº†é™æ€ç»“æ„</p></li><li><p>åºåˆ—å›¾</p></li><li><p>æ´»åŠ¨å›¾  P16</p><p>åˆ†å‰ åˆ†æ”¯   æ±‡åˆ åˆå¹¶çš„åŒºåˆ«</p><p>[choice]è¡¨ç¤ºæ¡ä»¶</p><p>å¦‚ä½•ç”»ä¸€ä¸ªå…·ä½“çš„æ´»åŠ¨å›¾</p></li></ol></li><li><p>ä¸‰å±‚ç¨‹åºè®¾è®¡æ¨¡å¼</p><p>è¡¨ç¤ºå±‚       ----ä¸šåŠ¡é€»è¾‘å±‚       -----æ•°æ®è®¿é—®å±‚</p><p>GUI                 PD                           DA       class</p><p>åˆ†å±‚ç»“æ„çš„ä¼˜åŠ¿   P25</p></li><li><p>ç¨‹åºè®¾è®¡é£æ ¼</p><p>å¯é‡ç”¨æ€§   å†… å¤–</p><p>å¯æ‰©å±•æ€§</p><p>å¥å£®æ€§</p></li></ol></li><li><p>æ•°ç»„åˆå§‹åŒ–çš„æ–¹å¼</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201118151442152.png" alt="image-20201118151442152"></p></li><li><p>ä¸‰å±‚è®¾è®¡ çš„å¥½å¤„ ç›®çš„  åŒºåˆ†ä¸‰å±‚è®¾è®¡å’ŒMVC P25 P272</p><p>åˆ†å±‚è®¾è®¡ï¼š åˆ†æ•£å…³æ³¨ æ¾æ•£è€¦åˆ  é€»è¾‘å¤ç”¨   æ ‡å‡†å®šä¹‰</p></li><li><p>HashMap  å¯ä»¥æœ‰ ä¸åŒçš„é”® å…¶å€¼å¯éƒ½ä¸ºnull ï¼Œä½†nullçš„é”®åªèƒ½æœ‰ä¸€ä¸ª hashmapä¸­ä¹Ÿæ˜¯æ— åºçš„</p><p>ArrayListã€Vectorå¯ä»¥æœ‰å¤šä¸ªnullå€¼</p><p>HashSetä¸­åªæœ‰æœ‰ä¸€ä¸ªnullå€¼</p><p>HashMapçš„éå†æ–¹å¼  å››ç§</p><p><a href="https://blog.csdn.net/scgyus/article/details/79105211?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522160570417819724835825778%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=160570417819724835825778&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2">https://blog.csdn.net/scgyus/article/details/79105211?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522160570417819724835825778%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=160570417819724835825778&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2</a><sub>all</sub>top_click~default-1-79105211.pc_search_result_no_baidu_js&amp;utm_term=hashmap%E7%9A%84%E9%81%8D%E5%8E%86&amp;spm=1018.2118.3001.4449</p></li><li><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201119193356887.png" alt="image-20201119193356887"></p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token comment">//Javaè¡¨è¾¾å¼æ˜¯å˜é‡ã€å¸¸é‡ã€è¿ç®—ç¬¦ã€æ–¹æ³•è°ƒç”¨çš„åºåˆ—ï¼Œå®ƒæ‰§è¡ŒæŒ‡å®šçš„è®¡ç®—å¹¶è¿”å›æŸä¸ªç¡®å®šçš„å€¼ã€‚</span></code></pre></div></li><li><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201119211925090.png" alt="image-20201119211925090"></p></li></ol>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®‰å“æ•°ç‹¬æ¸¸æˆè¯¾è®¾</title>
    <link href="/2020/12/22/%E5%AE%89%E5%8D%93%E6%95%B0%E7%8B%AC%E6%B8%B8%E6%88%8F%E8%AE%BE%E8%AE%A1/"/>
    <url>/2020/12/22/%E5%AE%89%E5%8D%93%E6%95%B0%E7%8B%AC%E6%B8%B8%E6%88%8F%E8%AE%BE%E8%AE%A1/</url>
    
    <content type="html"><![CDATA[<h1>æ•°ç‹¬æ¸¸æˆ (å›æº¯ç®—æ³•)â€”æ•°æ®ç»“æ„è¯¾ç¨‹è®¾è®¡å®éªŒæŠ¥å‘Š</h1><p>[toc]</p><!-- toc --><hr><h2 id="æ¸¸æˆä»‹ç»">æ¸¸æˆä»‹ç»</h2><h3 id="ç®€ä»‹-v4">ç®€ä»‹</h3><ul><li>ä¼ ç»Ÿçš„æ•°ç‹¬æ¸¸æˆï¼Œé‡‡ç”¨ 9x9 æ–¹æ ¼ï¼Œé€šè¿‡å¡«å…¥æ•°å­— 1-9 ï¼Œç¡®ä¿<strong>æ¯è¡Œã€æ¯åˆ—ã€ä»¥åŠè¯¥æ ¼æ‰€åœ¨çš„ 3x3 çš„æ–¹æ ¼åŒºåŸŸ</strong>ä¸­ ä¸å‡ºç°ç›¸åŒçš„æ•°å­—ã€‚</li><li><strong>æ¯ä¸ªç”Ÿæˆçš„æ•°ç‹¬åªæœ‰ä¸€ä¸ªè§£</strong></li><li>ä½¿ç”¨ AndroidStudio å¹³å°å¼€å‘ ï¼ŒåŸºäºJavaè¯­è¨€</li></ul><span id="more"></span><h3 id="å®ç°åŠŸèƒ½ï¼š">å®ç°åŠŸèƒ½ï¼š</h3><ol><li>UI åŸºæœ¬æ¸¸æˆç•Œé¢çš„ UI å¸ƒå±€ï¼Œæ•°ç‹¬ç”Ÿæˆä¸ UI åŠ¨æ€ç”Ÿæˆçš„å¼‚æ­¥å¤„ç† ï¼ŒåŠŸèƒ½æŒ‰é’®</li><li>AutoDetect æ¸¸æˆå†…å®æ—¶æ£€é”™å¹¶è‡ªåŠ¨åˆ é™¤é”™è¯¯æ•°å­—</li><li>Show Answer æ˜¾ç¤ºç­”æ¡ˆåŠŸèƒ½ï¼ŒåŠ¨æ€æç¤ºç­”æ¡ˆ</li><li>Reset é‡ç½®æ•°ç‹¬åŠŸèƒ½ï¼Œé‡æ–°ç”Ÿæˆæ–°çš„æ•°ç‹¬</li><li>Timer è®¡æ—¶åŠŸèƒ½</li><li>Record è®°å½•åŠŸèƒ½ï¼Œé€šè¿‡æ•°æ®åº“è®°å½•æ¯æ¬¡æˆåŠŸå®Œæˆæ•°ç‹¬çš„é¢˜ç›®ã€ç­”æ¡ˆå›¾åƒï¼Œå®Œæˆæ—¥æœŸï¼Œå®Œæˆæ—¶é—´ï¼Œä»¥åŠæ•°ç‹¬çš„éš¾åº¦</li></ol><h3 id="æ¸¸æˆæ“ä½œè¯´æ˜ï¼š">æ¸¸æˆæ“ä½œè¯´æ˜ï¼š</h3><ul><li>æœ‰å®‰å“æ‰‹æœºï¼ˆç‰ˆæœ¬ä¸ä½äº17)ï¼š<ol><li>å°†apkæ–‡ä»¶  (app-release.apk) å®‰è£…è‡³æ‰‹æœºï¼Œç›´æ¥å¯åŠ¨å³å¯</li><li>è¿›å…¥æ¸¸æˆåï¼Œè¯·<strong>å…ˆå…è®¸è¯¥ç¨‹åºè®¿é—®æ‰‹æœºå†…å­˜</strong>(å› ä¸ºè®°å½•ä¿å­˜æ—¶è¦è¿›è¡Œæ•°æ®çš„å­˜å–)ï¼Œå¦åˆ™ç¨‹åºä¼šè‡ªåŠ¨é€€å‡ºã€‚é€šè¿‡&quot;START&quot;æŒ‰é’®å¼€å§‹æ¸¸æˆï¼Œé€‰æ‹©éš¾åº¦ï¼Œè¿›å…¥æ¸¸æˆç•Œé¢ï¼Œé€šè¿‡æ‹–åŠ¨ä¸Šæ–¹è¾ƒå¤§çš„1-9çš„å›¾åƒï¼Œå°†æƒ³è¦æ”¾ç½®çš„æ•°ç»„æ‹–åŠ¨åˆ°æƒ³æ”¾ç½®çš„ä½ç½®å³å¯ã€‚ï¼ˆæ³¨ï¼šå¦‚æœæ˜¯æ‹–åŠ¨è‡³å·²ç”Ÿæˆçš„åŸå§‹æ•°ç‹¬ä½ç½®ï¼Œåˆ™ä¸ä¼šæ›¿æ¢ä¸ºæ”¾ç½®çš„æ•°ç»„ï¼Œä¼šå¼¹å‡ºâ€œThe block is origin&quot;æç¤ºï¼‰ã€‚æˆåŠŸå®Œæˆï¼Œåˆ™ä¼šåœ¨ä¸­éƒ¨æ˜¾ç¤º&quot;Congratulationï¼&quot;çš„åŠ¨ç”»æç¤ºã€‚</li><li>å¯é€šè¿‡&quot;RESET&quot;é‡ç½®è¯¥éš¾åº¦ä¸‹çš„æ•°ç‹¬ï¼Œé€šè¿‡â€BACK&quot;è¿”å›åˆ°æ¸¸æˆä¸»ç•Œé¢ï¼Œé€šè¿‡â€œSHOWANSWERâ€æŸ¥çœ‹ç­”æ¡ˆ</li><li>åœ¨ä¸»ç•Œé¢çš„RecordsæŒ‰é’®ç‚¹å‡»åï¼Œå¯æŸ¥çœ‹å·²æœ‰çš„è®°å½•ï¼Œé€šè¿‡å·¦å³æ»‘åŠ¨å¯æŸ¥çœ‹ã€‚å¦‚æœæ²¡æœ‰è®°å½•ï¼Œåˆ™ä¸ä¼šæ˜¾ç¤ºã€‚</li></ol></li><li>æ²¡æœ‰å®‰å“æ‰‹æœºï¼š<ol><li>éº»çƒ¦è€å¸ˆåœ¨PCç«¯ä¸‹è½½å®‰å“æ¨¡æ‹Ÿå™¨ï¼Œç„¶åå°†è¯¥apkå®‰è£…è‡³ç”µè„‘çš„å®‰å“æ¨¡æ‹Ÿå™¨ä¸­è¿è¡Œï¼ˆç”±äºå…¼å®¹é—®é¢˜å¯èƒ½ä¼šå‡ºç°ä¸€äº›å¼‚å¸¸)ã€‚</li><li>æ¸¸æˆå†…æ“ä½œæ­¥éª¤åŒä¸Š2-4æ­¥ã€‚</li></ol></li></ul><p><strong>æˆ‘è‡ªå·±çš„æµ‹è¯•è§†é¢‘æ”¾åœ¨äº†ä¸»ç›®å½•ä¸‹ï¼Œå¦‚æœä»¥ä¸Šä¸¤ç§æƒ…å†µä¸‹éƒ½ä¸èƒ½è¿è¡Œï¼Œå¯ä»¥çœ‹æˆ‘çš„æ¼”ç¤ºè§†é¢‘ã€‚</strong></p><h3 id="é¡¹ç›®è¿è¡Œè¯´æ˜-å¦‚æœéœ€è¦-ï¼š">é¡¹ç›®è¿è¡Œè¯´æ˜ (å¦‚æœéœ€è¦)ï¼š</h3><ul><li><p><strong>JDK :1.8         API :Android 30 Platform</strong></p></li><li><p>ä¸‹è½½Android Studio (3.6ç‰ˆæœ¬åŠä»¥ä¸Š) å®˜ç½‘åœ°å€https://developer.android.google.cn/studio/(å®‰è£…åŒ…800Mï¼Œè¿™é‡Œä¸ç»™å‡º)</p></li><li><p>å·¦ä¸Šè§’ â€Fileâ€œ --â€Openâ€œâ€“é€‰æ‹©é¡¹ç›®æ–‡ä»¶å¤¹   å¯ä»¥è¿æ¥å®‰å“æ‰‹æœº(éœ€è¦æ‰“å¼€è°ƒè¯•æ¨¡å¼)ï¼Œä¹Ÿå¯ä»¥ä¸‹è½½Android Studioå¹³å°ä¸‹çš„å®‰å“æ‰‹æœºæ¨¡æ‹Ÿå™¨(AVD manager â€”Create New Virtual Device)</p></li><li><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201222225942614.png" alt="image-20201222225942614"></p></li></ul><h2 id="æ¸¸æˆè®¾è®¡ç†å¿µ-å›æº¯ç®—æ³•æ ¸å¿ƒéƒ¨åˆ†">æ¸¸æˆè®¾è®¡ç†å¿µ(å›æº¯ç®—æ³•æ ¸å¿ƒéƒ¨åˆ†)</h2><p><strong>æ ¸å¿ƒç®—æ³•åŒºåŸŸï¼š â€œ\app\src\main\java\com\example\sudokuâ€ä¸‹çš„SudoHelper.javaæ–‡ä»¶ä¸­</strong></p><h3 id="æ ¸å¿ƒæ€æƒ³ï¼š">æ ¸å¿ƒæ€æƒ³ï¼š</h3><div class="code-wrapper"><pre class="language-none"><code class="language-none">1. å…ˆé€šè¿‡éšæœºæ•°ï¼Œç”Ÿæˆæœ‰nä¸ªå…ƒç´ çš„ï¼ˆn=30ï¼‰æ®‹ç¼ºçš„æ•°ç»„2. é€šè¿‡solveSudoku()å°†æ®‹ç¼ºæ•°ç»„ç”Ÿæˆå®Œæ•´çš„æ•°ç‹¬3. å°†å®Œæ•´çš„æ•°ç‹¬è¿›è¡ŒæŒ–å–ï¼Œæ¯æŒ–ä¸€ä¸ªå…ƒç´ éƒ½è¦ç¡®ä¿è¯¥ä½ç½®ä¸Šçš„å…ƒç´ ä¸èƒ½ç”±å…¶ä»–å…ƒç´ æ›¿æ¢</code></pre></div><h3 id="isValid-æ–¹æ³•ï¼š"><strong>isValid()æ–¹æ³•</strong>ï¼š</h3><ul><li><p>è¯´æ˜ï¼š è¯¥æ–¹æ³•ç”¨äºåˆ¤æ–­æ•°ç»„ä¸­è¯¥è¡Œè¯¥åˆ— å¡«å…¥æ•°å­—c æ—¶ï¼Œæ˜¯å¦åœ¨è¯¥è¡Œæ‰€æœ‰å…ƒç´ ã€è¯¥åˆ—æ‰€æœ‰å…ƒç´ æˆ–è€…è¯¥3*3åŒºåŸŸä¸­æœ‰ä¸cç›¸åŒçš„å…ƒç´ ï¼Œå¦‚æœæœ‰ï¼Œåˆ™è¯´æ˜è¿åäº†è§„åˆ™ï¼Œè¿”å›false;</p></li><li><div class="code-wrapper"><pre><code class="language-java"> /**     * åˆ¤æ–­è¯¥äºŒç»´æ•°ç»„ä¸­ rowè¡Œ colåˆ—ä¸­å¡«å…¥æ•°å­—cæ˜¯å¦è¿åè§„åˆ™     * @param board åŸå§‹çš„äºŒç»´æ•°ç»„     * @param row   è¯¥æ•°å­—cçš„è¡Œæ•°     * @param col   æ•°å­—cçš„åˆ—æ•°     * @param c     æ•°å­—c     * @return     */    public static boolean isValid(int[][] board, int row, int col, int c) &#123;        for (int i = 0; i &lt; 9; i++) &#123;            //å½“å‰åˆ—æœ‰æ²¡æœ‰å’Œæ•°å­—cé‡å¤çš„            if (board[i][col] == c)                return false;            //å½“å‰è¡Œæœ‰æ²¡æœ‰å’Œæ•°å­—cé‡å¤çš„            if (board[row][i] == c)                return false;            //å½“å‰çš„3*3å•å…ƒæ ¼å†…æ˜¯å¦æœ‰å’Œæ•°å­—cé‡å¤çš„            if (board[3 * (row / 3) + i / 3][3 * (col / 3) + i % 3] == c)                return false;        &#125;        //å¦åˆ™è¯´æ˜æ²¡æœ‰é‡å¤æ•°å­—ï¼Œç¬¦åˆè§„åˆ™        return true;    &#125;<pre class="language-none"><code class="language-none">### **backTrace()æ–¹æ³•*** è¯´æ˜ï¼šé€šè¿‡è¿­ä»£è¿›è¡Œæ•°ç‹¬çš„åˆ¤æ–­ï¼Œç”±ä¸å®Œæ•´çš„æ•°ç‹¬ç”Ÿæˆå®Œæ•´çš„æ•°ç‹¬* &#96;&#96;&#96;java  public static boolean backTrace(int[][] board, int row, int col,int num,int spr,int spc) &#123;          &#x2F;&#x2F;å½“rowç­‰äºboard.lengthçš„æ—¶å€™è¡¨ç¤ºæ•°ç‹¬çš„æœ€åä¸€è¡Œå…¨éƒ¨è¯»éå†å®Œäº†ï¼Œè¯´æ˜æ•°ç‹¬ä¸­çš„å€¼æ˜¯æœ‰æ•ˆçš„ï¼Œç›´æ¥è¿”å›true          if (row &#x3D;&#x3D; board.length)              return true;          &#x2F;&#x2F;å¦‚æœå½“å‰è¡Œçš„æœ€åä¸€åˆ—ä¹Ÿéå†å®Œäº†ï¼Œå°±ä»ä¸‹ä¸€è¡Œçš„ç¬¬ä¸€åˆ—å¼€å§‹ã€‚è¿™é‡Œçš„éå†          &#x2F;&#x2F;é¡ºåºæ˜¯ä»ç¬¬1è¡Œçš„ç¬¬1åˆ—ä¸€ç›´åˆ°æœ€åä¸€åˆ—ï¼Œç„¶åç¬¬äºŒè¡Œçš„ç¬¬ä¸€åˆ—ä¸€ç›´åˆ°æœ€å          if (col &#x3D;&#x3D; board.length)              return backTrace(board, row + 1, 0,num,spr,spc);          &#x2F;&#x2F;å¦‚æœå½“å‰ä½ç½®å·²ç»æœ‰æ•°å­—äº†ï¼Œå°±ä¸èƒ½å†å¡«äº†ï¼Œç›´æ¥åˆ°è¿™ä¸€è¡Œçš„ä¸‹ä¸€åˆ—          if (board[row][col] !&#x3D; 0)              return backTrace(board, row, col + 1,num,spr,spc);          &#x2F;&#x2F;å¦‚æœä¸Šé¢æ¡ä»¶éƒ½ä¸æ»¡è¶³ï¼Œå°±ä»1åˆ°9ç§é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„æ•°å­—å¡«å…¥åˆ°æ•°ç‹¬ä¸­          for (int i &#x3D; 1; i &lt;&#x3D; 9; i++) &#123;              &#x2F;&#x2F;åˆ¤æ–­å½“å‰ä½ç½®[rowï¼Œcol]æ˜¯å¦å¯ä»¥æ”¾æ•°å­—iï¼Œå¦‚æœä¸èƒ½æ”¾å†åˆ¤æ–­ä¸‹ä¸€ä¸ªèƒ½ä¸èƒ½æ”¾              &#x2F;&#x2F;rè¡Œcåˆ—å·²ç»ä¸èƒ½å†å¡«å…¥numäº†ï¼Œç”¨äºisOnlyOneæ–¹æ³•              if(i&#x3D;&#x3D;num&amp;&amp;spr&#x3D;&#x3D;row&amp;&amp;spc&#x3D;&#x3D;col)                  continue;              if (!isValid(board, row, col, i))                  continue;              &#x2F;&#x2F;å¦‚æœèƒ½æ”¾æ•°å­—iï¼Œå°±æŠŠæ•°å­—iæ”¾è¿›å»              board[row][col] &#x3D; i;              &#x2F;&#x2F;å¦‚æœæˆåŠŸå°±ç›´æ¥è¿”å›ï¼Œä¸éœ€è¦å†å°è¯•äº†              if (backTrace(board, row, col,num,spr,spc))                  return true;              &#x2F;&#x2F;å¦åˆ™å°±æ’¤é”€é‡æ–°é€‰æ‹©              board[row][col] &#x3D; 0;          &#125;          &#x2F;&#x2F;å¦‚æœå½“å‰ä½ç½®[rowï¼Œcol]ä¸èƒ½æ”¾ä»»ä½•æ•°å­—ï¼Œç›´æ¥è¿”å›false          return false;      &#125;  </code></pre></div></code></pre></li></ul><h3 id="isOnlyOne-æ–¹æ³•">isOnlyOne()æ–¹æ³•</h3><ul><li><p>è¯´æ˜ï¼šåˆ¤æ–­è¯¥è¡Œè¯¥åˆ—ä¸Šçš„æ•°å­—ï¼Œæ˜¯å¦èƒ½è¢«å…¶ä»–1-9çš„æ•°å­—æ›¿ä»£ï¼Œä¸”ä¸è¿åè§„åˆ™</p></li><li><div class="code-wrapper"><pre><code class="language-java"> /**     * åˆ¤æ–­è¯¥è¡Œè¯¥åˆ—ä¸Šçš„æ•°å­—ï¼Œæ˜¯å¦èƒ½è¢«å…¶ä»–1-9çš„æ•°å­—æ›¿ä»£ï¼Œä¸”ä¸è¿åè§„åˆ™     * @param i è¡Œæ•°     * @param j åˆ—æ•°     * @param b äºŒç»´æ•°ç»„     * @return     */    public static boolean isOnlyOne(int i,int j,int[][] b)&#123;  //åˆ¤æ–­åœ¨i,jæŒ–å»æ•°å­—åæ˜¯å¦æœ‰å”¯ä¸€è§£        int k=b[i][j];  //ä¿å­˜å¾…æŒ–æ´çš„åŸå§‹æ•°å­—        for(int num=1;num&lt;10;num++)&#123;            b[i][j]=0;            if(num!=k&amp;&amp;solveSudoku_noChange(b,k))&#123;     //é™¤å¾…æŒ–çš„æ•°å­—ä¹‹å¤–ï¼Œè¿˜æœ‰å…¶ä»–çš„è§£ï¼Œåˆ™è¿”å›false                b[i][j]=k;                return false;            &#125;        &#125;        return true;     //åªæœ‰å”¯ä¸€è§£åˆ™è¿”å›true    &#125;<pre class="language-none"><code class="language-none">### solveSudokuæ–¹æ³•()* è¯´æ˜ï¼š ç”¨äºåˆ¤æ–­ä¸å®Œæ•´çš„boardæ•°ç»„èƒ½å¦ç”Ÿæˆä¸ºäºŒç»´æ•°ç‹¬ï¼Œå¦‚æœèƒ½ï¼Œåˆ™è¿”å›trueï¼Œä¸”ä¼šæ›´æ”¹boardçš„å…ƒç´ å€¼ï¼Œnumä½œä¸ºisOnlyOne()æ–¹æ³•ä¸­çš„ç‰¹æ®Šåˆ¤æ–­æ¡ä»¶ï¼Œæ£€éªŒé™¤äº†numæ•°å­—ï¼Œå…¶ä»–æ•°å­—æ˜¯å¦èƒ½å¡«å…¥æ•°ç»„ä½¿ä¹‹æ„æˆæ•°ç‹¬ã€‚* solveSudoku_noChange() åŠŸèƒ½ä¸solveSudoku()æ–¹æ³•ä¸€è‡´ï¼ŒåŒºåˆ«æ˜¯ä¸æ›´æ”¹å‚æ•°boardäºŒç»´æ•°ç»„çš„å€¼ï¼Œä»…ç»™å‡ºæ˜¯å¦èƒ½ç”Ÿæˆæ•°ç‹¬çš„ç»“æœã€‚* &#96;&#96;&#96;java   &#x2F;&#x2F;num ç”¨åšisOnlyOne()çš„ç‰¹æ®Šåˆ¤æ–­æ ‡å¿—      &#x2F;&#x2F;spr spcè¡¨ç¤ºè¡¨ç¤ºè¯¥ä½ç½®ä¸Šçš„å…ƒç´ ä¸èƒ½å¡«å…¥numå€¼      public static boolean solveSudoku(int[][] board,int num,int spr,int spc) &#123;          return backTrace(board, 0, 0,num,spr,spc);      &#125;          public static boolean solveSudoku_noChange(int[][] board,int num,int spr,int spc) &#123;          int temp[][]&#x3D;new int[9][9];          for(int i&#x3D;0;i&lt;9;i++)&#123;              System.arraycopy(board[i],0,temp[i],0,9);          &#125;          return backTrace(temp, 0, 0,num,spr,spc);      &#125;</code></pre></div></code></pre></li></ul><h3 id="generateSudoWithLevel-æ–¹æ³•">generateSudoWithLevel()æ–¹æ³•</h3><ul><li>è¯´æ˜ï¼šé€šè¿‡ä¼ å…¥å‚æ•° int levelï¼Œç”Ÿæˆè§£æ³•å”¯ä¸€çš„æ®‹ç¼ºæ•°ç‹¬</li><li>æµç¨‹å›¾ï¼šå®Œæ•´å›¾ç‰‡æ–‡ä»¶åœ¨æºæ–‡ä»¶ä¸­</li><li><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/%E7%AE%97%E6%B3%95%E6%B5%81%E7%A8%8B%E5%9B%BE.png" alt="ç®—æ³•æµç¨‹å›¾"></li></ul><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">generateSudoWithLevel</span><span class="token punctuation">(</span><span class="token keyword">int</span> level<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>     <span class="token keyword">int</span> temp<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>     <span class="token class-name">Random</span> rand<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">int</span> count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>     <span class="token comment">//å¯¹ä¸åŒéš¾åº¦è¿›è¡ŒæŒ–å–ä¸ªæ•°countçš„é€‰æ‹©</span>     <span class="token keyword">switch</span> <span class="token punctuation">(</span>level<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>         <span class="token keyword">case</span> LEVEL_NORMAL<span class="token operator">:</span>             count <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">;</span>             <span class="token keyword">break</span><span class="token punctuation">;</span>         <span class="token keyword">case</span> LEVLE_EASY<span class="token operator">:</span>             count <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>             <span class="token keyword">break</span><span class="token punctuation">;</span>         <span class="token keyword">case</span> LEVLE_DIF<span class="token operator">:</span>             count <span class="token operator">=</span> <span class="token number">35</span><span class="token punctuation">;</span>             <span class="token keyword">break</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span>     <span class="token keyword">int</span> calloc_num <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>    <span class="token comment">//æœ€åˆæŒ–å–çš„æ¬¡æ•°</span>     <span class="token keyword">int</span> count_fresh <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">//é‡æ–°å¯»æ‰¾æ¬¡æ•°</span>     <span class="token keyword">boolean</span> flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>     <span class="token keyword">do</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>             <span class="token keyword">while</span> <span class="token punctuation">(</span>calloc_num <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                 <span class="token keyword">int</span> i <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token keyword">int</span> j <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token keyword">if</span> <span class="token punctuation">(</span>temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                     <span class="token keyword">int</span> num <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>                     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isValid</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                         temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> num<span class="token punctuation">;</span>                         calloc_num<span class="token operator">--</span><span class="token punctuation">;</span>                     <span class="token punctuation">&#125;</span>                 <span class="token punctuation">&#125;</span>             <span class="token punctuation">&#125;</span>             <span class="token comment">//å¦‚æœèƒ½ç”Ÿæˆå®Œæ•´çš„æ•°ç‹¬ åˆ™é€€å‡ºå¾ªç¯è¿›è¡Œä¸‹ä¸€æ­¥</span>             <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">solveSudoku</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>             <span class="token comment">//å¦åˆ™é‡æ–°å¼€å§‹</span>             calloc_num <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>             temp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>         <span class="token comment">//å¯¹å®Œæ•´çš„æ•°ç‹¬è¿›è¡ŒæŒ–å–ï¼Œå¹¶ç¡®ä¿æ¯ä¸€æ¬¡æŒ–å–çš„å…ƒç´ ä¸èƒ½è¢«å…¶ä»–æ•°å­—æ›¿ä»£</span>         <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>             <span class="token keyword">int</span> r <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token keyword">int</span> c <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">//å¦‚æœå·²ç»æŒ–å–äº†countä¸ªå…ƒç´ ï¼Œä¸”æ›´æ–°æ¬¡æ•°&lt;20</span>             <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> count <span class="token operator">&amp;&amp;</span> count_fresh <span class="token operator">&lt;=</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                 <span class="token keyword">return</span> temp<span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span>             <span class="token comment">//è¯¥ä½ç½®æœ‰å€¼ï¼Œä¸”èƒ½ä¸èƒ½è¢«å…¶ä»–å€¼æ›¿æ¢ï¼Œåˆ™æŒ–å–è¿™ä¸ªä½ç½®çš„å€¼</span>             <span class="token keyword">if</span> <span class="token punctuation">(</span>temp<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isOnlyOne</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> c<span class="token punctuation">,</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span>                 <span class="token keyword">continue</span><span class="token punctuation">;</span>             <span class="token comment">//å¦‚æœèƒ½è¢«å…¶ä»–å…ƒç´ å–ä»£ï¼Œåˆ™é‡æ–°å¯»æ‰¾æ¬¡æ•°+1</span>             count_fresh<span class="token operator">++</span><span class="token punctuation">;</span>             <span class="token comment">//å¦‚æœå¯»æ‰¾æ¬¡æ•°è¿‡å¤šï¼Œè¯´æ˜æœ‰è¿™æ˜¯ä¸ªä¸å¤ªç†æƒ³çš„æ•°ç‹¬ï¼Œç»§ç»­å¯»æ‰¾å¯èƒ½è€—æ—¶</span>             <span class="token comment">//åˆ™é‡æ–°ç”Ÿæˆæ–°çš„æ•°ç‹¬</span>             <span class="token keyword">if</span> <span class="token punctuation">(</span>count_fresh <span class="token operator">></span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                 flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                 <span class="token keyword">break</span><span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span>             i<span class="token operator">--</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>         <span class="token comment">//è¿›è¡Œæ•°æ®çš„é‡ç½®ä»¥ä¾¿é‡æ–°ç”Ÿæˆæ•°ç‹¬</span>         count_fresh <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>         calloc_num <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>         temp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">;</span>     <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></code></pre></div><h3 id="æµç¨‹æ¦‚æ‹¬">æµç¨‹æ¦‚æ‹¬</h3><ol><li>æ„å»ºä¸€ä¸ªä¸å®Œæ•´çš„çŸ©é˜µï¼Œå…¶ä¸­çŸ©é˜µä¸­Nä¸ªå…ƒç´ è¢«å¡«å†™1-9çš„æ•°å­—ï¼Œä¸”å‡ç¬¦åˆæ•°ç‹¬çš„è§„åˆ™ (isValid()==true)</li><li>é€šè¿‡ä¸å®Œæ•´çš„çŸ©é˜µï¼ŒåˆsolveSudo(æ–¹æ³•ç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„æ•°ç‹¬çŸ©é˜µ</li><li>å°†ç”Ÿæˆçš„å®Œæ•´æ•°ç‹¬çŸ©é˜µè¿›è¡Œå…ƒç´ æŒ–å–ï¼Œæ¯æŒ–ä¸€ä¸ªå…ƒç´ éƒ½è¦ä¿è¯è¢«æŒ–å–çš„å…ƒç´ ä¸èƒ½è¢«å…¶ä»–æ•°å­—æ›¿ä»£(æ•°ç‹¬è§£çš„å”¯ä¸€æ€§)(isOnlyOne())</li><li>3æ­¥éª¤ä¸­å¦‚æœè¯¥å…ƒç´ ä¸æ»¡è¶³æ—¶ é‡æ–°æœç´¢è®°å½•+1,å½“é‡æ–°æœç´¢è®°å½•å¤§äºä¸€å®šå€¼æ—¶ï¼Œè¯´æ˜è¿™ä¸ªæ•°ç‹¬ä¸æ˜¯ä¸€ä¸ªå¥½çš„æ•°ç‹¬ï¼Œåˆ™é‡æ–°è¿›å…¥æ­¥éª¤ä¸€ï¼Œæ„å»ºæ–°çš„æ•°ç‹¬ï¼›åä¹‹ï¼Œåˆ™å°±å¾—åˆ°äº†è§£å”¯ä¸€çš„æ•°ç‹¬ï¼Œè¾“å‡ºå³å¯ã€‚</li></ol><h3 id="å®éªŒæµ‹è¯•â€”å…·ä½“è€—æ—¶">å®éªŒæµ‹è¯•â€”å…·ä½“è€—æ—¶</h3><ul><li>ä½¿ç”¨generateSudoWithLevel(int level)å‡½æ•°åœ¨IDEAå¹³å°ä¸Šè¿›è¡Œæ•°ç‹¬ç”Ÿæˆ Næ¬¡å®éªŒï¼Œè®°å½•æ¯Næ¬¡çš„è€—æ—¶ï¼Œå¤šæ¬¡æµ‹é‡å¹¶å–å¹³å‡å€¼ï¼Œç”»å‡ºè¡¨æ ¼å¦‚ä¸‹</li><li><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201222111013713.png" alt="image-20201222111013713"></li><li><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201222110639573.png" alt="image-20201222110639573"></li></ul><h3 id="å®éªŒåˆ†æ">å®éªŒåˆ†æ</h3><ul><li>éšç€éš¾åº¦å¢åŠ ï¼Œ count å¢åŠ ï¼Œç”Ÿæˆå®Œæ•´æ•°ç‹¬åæŒ–å–çš„å…ƒç´ ä¸ªæ•°ä¹Ÿå¢åŠ ï¼Œæ‰€ä»¥è€—æ—¶å¿…ç„¶æ˜¯ä¸€ä¸ªé€’å¢çš„è¿‡ç¨‹ã€‚ä½†åœ¨ç®—æ³•ä¸­å› ä¸ºæ¶‰åŠåˆ°calloc_fresh ï¼Œç»Ÿè®¡è¿‡é‡å¯»æ‰¾å¯åˆ é™¤å…ƒç´ çš„åˆ¤æ–­ï¼Œæ‰€ä»¥åœ¨é‡åˆ°ä¸å¤ªç†æƒ³çš„æ•°ç‹¬æ—¶ä¼šè¿›è¡Œé‡æ–°ç”Ÿæˆæ“ä½œï¼Œä½¿å¾—ä¸åŒéš¾åº¦ä¸‹å•æ¬¡ç”Ÿæˆæ•°ç‹¬çš„æ—¶é—´å¯èƒ½æœ‰å·®å¼‚ã€‚å®éªŒä¸­çš„ç©ºé—´å¤æ‚åº¦ : OÂ©  (ç”¨åˆ°ä¸€ä¸ª9x9çš„äºŒç»´æ•°ç»„å’Œå¸¸æ•°ä¸ªå˜é‡),  æ¸è¿›å¤æ‚åº¦ä¸Šç•Œ  &gt;=O(9^{9x9})  (åŸå› ï¼šåŠ å…¥åˆ¤æ–­calloc_freshå¤§äºä¸€å®šå€¼æ—¶ä¼šé‡æ–°ç”Ÿæˆæ•°ç‹¬é‡æ–°æŒ–å–ï¼‰</li></ul><h2 id="æ¸¸æˆå¼€å‘ä¸­çš„å…¶ä»–æƒ³æ³•å’Œé—®é¢˜">æ¸¸æˆå¼€å‘ä¸­çš„å…¶ä»–æƒ³æ³•å’Œé—®é¢˜</h2><p>å¼€å‘ä¸­è¿˜æ¶‰åŠåˆ°ä¸€äº›æ§ä»¶åŠ¨æ€ç”Ÿæˆï¼ŒUIå¸ƒå±€é€‰æ‹©å’Œæ¸¸æˆæ¨¡å¼çš„æ€è€ƒã€‚å¦‚æœè€å¸ˆå¯¹è¿™éƒ¨åˆ†æœ‰å…´è¶£ï¼Œè¯·ç§»æ­¥ä¸»ç›®å½•ä¸­çš„ <a href="http://README.md">README.md</a> æˆ–è€… README.pdf æ–‡ä»¶</p><p>æˆ‘æŠŠå¼€å‘è¿‡ç¨‹ä¸­çš„æƒ³æ³•å’Œè§£å†³æ–¹æ³•å†™åœ¨äº†ä¸Šè¿°æ–‡æ¡£ä¸­</p><p>Githubä¸Šé¡¹ç›®ä¸å®šæ—¶æ›´æ–°  <a href="https://github.com/PPLong222/SudokuGame">https://github.com/PPLong222/SudokuGame</a></p><p>é‚®ç®± <a href="mailto:401177923@qq.com">401177923@qq.com</a></p><h2 id="è¯¾è®¾æ€»ç»“">è¯¾è®¾æ€»ç»“</h2><p>â€‹è¿™æ¬¡è¯¾è®¾è®©æˆ‘å­¦ä¹ äº†å›æº¯ç®—æ³•ï¼Œé‡æ–°è®¤è¯†äº†æ•°ç‹¬æ¸¸æˆçš„å®šä¹‰ï¼Œè®©æˆ‘å¯¹æ±‚è§£Nçš‡åå’Œè§£æ•°ç‹¬ç­‰è¾ƒä¸ºå¤æ‚çš„é—®é¢˜æ—¶æœ‰äº†æ–°çš„æ€è·¯ï¼Œè§£å†³æ•°ç‹¬é—®é¢˜è¿˜å¯ä»¥é€šè¿‡ä½è¿ç®—ã€èˆè¹ˆé“¾ç­‰ç®—æ³•ï¼Œå›æº¯ç®—æ³•åªæ˜¯å…¥é—¨ï¼Œæ•°æ®ç»“æ„å’Œç®—æ³•å¯¹æˆ‘ä»¬æ¥è¯´ï¼Œè¯¾ç¨‹ç»“æŸäº†ä½†æ˜¯è¿˜æœ‰å¾ˆå¤šå¾ˆå¤šéœ€è¦ä»Šåæ·±å…¥å­¦ä¹ ã€‚ é€šè¿‡è¿™æ¬¡è¯¾è®¾ä¹Ÿè®©æˆ‘å›é¡¾äº†ä¹‹å‰æ‰€å­¦ä¹ çš„javaè¯­è¨€å’Œ Androidå¼€å‘çš„ä¸€äº›åŸºç¡€ï¼Œå‘ç°è‡ªå·±çš„åŸºç¡€è¿˜æ˜¯ä¸æ˜¯å¾ˆç‰¢å›ºï¼Œåœ¨è¯¾è®¾åè¿˜éœ€è¦å¤šå·©å›ºå¤šæ€»ç»“ã€‚</p><h2 id="æ„Ÿè°¢-v2">æ„Ÿè°¢</h2><p>â€‹æ„Ÿè°¢è€å¸ˆçš„é˜…è¯»ï¼Œå¦‚æœåœ¨æµ‹è¯•ä¸­å‘ç°äº†ä»»ä½•çš„å¼‚å¸¸æˆ–è€…UIä¸å…¼å®¹é—®é¢˜ï¼Œéº»çƒ¦è€å¸ˆæŒ‡å‡ºã€‚æˆ‘ä¼šåŠæ—¶å¯¹é¡¹ç›®è¿›è¡Œæ›´æ–°</p>]]></content>
    
    
    <categories>
      
      <category>ä¸ªäººé¡¹ç›®</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Android</tag>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸ªäººé¡¹ç›®æ€»ç»“å­¦ä¹ </title>
    <link href="/2020/10/22/%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/"/>
    <url>/2020/10/22/%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<h1>ä¸ªäººé¡¹ç›®æ€»ç»“</h1><h2 id="JDBC-HTML-MYSQL-é—´é€šä¿¡">JDBC \ HTML \ MYSQL é—´é€šä¿¡</h2><h3 id="ç®€ä»‹-v3">ç®€ä»‹</h3><p>å®ç°html ç•Œé¢è¾“å…¥ç”¨æˆ·åå¯†ç ï¼Œèƒ½å¤Ÿé€šè¿‡mysql æŸ¥è¯¢åˆ°ç›¸åº”çš„å…¶ä»–å€¼ï¼Œå¹¶ä¸”å†è¾“å‡ºåˆ°htmlç•Œé¢ä¸Š</p><!-- toc --><span id="more"></span><h3 id="é‡‡å‘ç‚¹">é‡‡å‘ç‚¹</h3><ol><li><p>Servletä¸‹çš„getParameter() è·å–çš„æ˜¯html ä¸­nameçš„å€¼</p></li><li><p>JDBCTemplate  ã€ JDBCDruidUtils çš„ä½¿ç”¨å°šä¸ç†Ÿæ‚‰</p></li><li><p>@Test  å¯¼å…¥åŒ…  ----org.junit è¦å’Œhramâ€¦1.3 ä¸€èµ·å¯¼å…¥</p></li><li><p>jaråŒ… æœ€å¥½éƒ½å¯¼å…¥åˆ°web ä¸‹çš„WEB-INFä¸­çš„libä¸­ï¼Œæ³¨æ„åˆ«å¿˜è®°æ·»åŠ ä¾èµ–</p></li><li><p>å„ç§jaråŒ…çš„å¯»æ‰¾å’Œå¯¼å…¥</p></li><li><p>JDBCTemplate.query() ä¸­çš„new BeanPropertyRowMapper&lt;&gt;(x.class,?1,?2â€¦)  æ˜¯é€šè¿‡ x.classä¸­çš„ æ ‡å‡†çš„java beanç±»æ¥å®ç°çš„</p></li></ol><p>å³ï¼Œ å„ç§å˜é‡åä¸ä¸€å®šè¦ä¸æ•°æ®åº“ä¸­çš„ä¸€è‡´</p><p>ä½†ï¼š <strong>setter getteræ–¹æ³•åçš„åå­—å¿…é¡»ä¸€è‡´</strong>ï¼Œæ¯”å¦‚ï¼š</p><p>æ•°æ®åº“username â€”setUsernameï¼ˆï¼‰â€”name æ˜¯èƒ½å¤Ÿè®¿é—®åˆ°çš„</p><ol start="7"><li><p>template ä¸­æŸ¥æ‰¾æ•°æ® ä¸º ç©ºï¼Œä½†ä¼šæŠ¥é”™ï¼Œ è¿™ä¸ªæ—¶å€™ç›´æ¥æ‰¾åˆ°è¿™ä¸ªå¼‚å¸¸ï¼Œ æ•è·ï¼Œé€‰æ‹©å¤„ç†åŠæ³•ï¼Œé¿å…å¯¼è‡´æœåŠ¡å™¨å¼‚å¸¸</p></li><li><p>å‡ºç° ï¼Ÿï¼Ÿï¼Ÿï¼Ÿçš„htmlæ˜¾ç¤ºå¯èƒ½æ˜¯ ç¼–ç é€‰æ‹©ä¸æ­£å¸¸</p><div class="code-wrapper"><pre class="language-JAVA" data-language="JAVA"><code class="language-JAVA">resp.setContentType(&quot;text&#x2F;html;charset&#x3D;UTF-8&quot;);req.setCharacterEncoding(&quot;UTF-8&quot;);</code></pre></div></li><li><p>ç½‘ç«™404  ï¼š å¯èƒ½æ˜¯ç»§æ‰¿Httpservletç±»ä¸­æ–¹æ³•æ²¡æœ‰@Overrideé‡å†™</p></li><li><p>Mysql ä¸­ charç±»å‹ æ˜¯å®šé•¿çš„ï¼Œä¼šè‡ªåŠ¨è¡¥é½</p><p>è€Œvarcharæ˜¯å˜é•¿çš„ï¼Œå³ä½¿æŒ‡å®š25ä¸ªå­—èŠ‚ï¼Œä¹Ÿä¼šæ ¹æ®è¾“å‡ºçš„ä¸åŒè€Œåˆ é™¤ï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦ï¼ï¼ï¼ï¼</p></li></ol><hr><h2 id="Response-HTML-å®ç°éªŒè¯ç -çš„éªŒè¯å’Œæ›´æ¢">Response/HTML å®ç°éªŒè¯ç  çš„éªŒè¯å’Œæ›´æ¢</h2><ol><li><p>å„ç§srcçš„æŒ‡å®šè·¯å¾„</p></li><li><p>è¿˜æœªæƒ³åˆ°è§£å†³æ–¹æ³•ï¼š å‚æ•°çš„ä¼ é€’ ï¼ˆæˆ‘ç”¨çš„æ˜¯ç±»çš„é™æ€å˜é‡ï¼‰</p></li><li><p>ç°åœ¨ æƒ³åˆ°çš„è§£å†³åŠæ³•ï¼šthis.getServletContext()</p><p>ä¼ å…¥ setattribute   ä½œä¸ºç±»ä¼¼çš„å…¨å±€å˜é‡</p></li></ol><hr><h2 id="Response-ServletContext-FileInputStreamå®ç°æ–‡ä»¶ä¸‹è½½">Response /ServletContext/ FileInputStreamå®ç°æ–‡ä»¶ä¸‹è½½</h2><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java">  <span class="token comment">//è·å– htmlå‚æ•°å</span><span class="token class-name">String</span> fileName<span class="token operator">=</span>req<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"filename"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¾—åˆ°ServletContextå¯¹è±¡</span><span class="token class-name">ServletContext</span> servletContext<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¾—åˆ°æœåŠ¡å™¨åŒ…ä¸‹çš„èµ„æºçš„ç»å¯¹è·¯å¾„</span><span class="token class-name">String</span> realPath<span class="token operator">=</span>servletContext<span class="token punctuation">.</span><span class="token function">getRealPath</span><span class="token punctuation">(</span><span class="token string">"/Sources/"</span><span class="token operator">+</span>fileName<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åˆ›å»ºè¾“å…¥æµå®ä½“</span><span class="token class-name">FileInputStream</span> fileInputStream<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>realPath<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ›´æ”¹å“åº”å¤´ä¿¡æ¯ è®¾ç½®ä¸ºæ‰‹åŠ¨é€‰æ‹©ä¸‹è½½ä½ç½®</span>resp<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">"content-type"</span><span class="token punctuation">,</span>servletContext<span class="token punctuation">.</span><span class="token function">getMimeType</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>resp<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">"content-disposition"</span><span class="token punctuation">,</span><span class="token string">"attachment;filename="</span><span class="token operator">+</span>fileName<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¾—åˆ°è¾“å‡ºæµ</span><span class="token class-name">ServletOutputStream</span> outputStream <span class="token operator">=</span> resp<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> readbyte<span class="token operator">=</span><span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> len<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>len<span class="token operator">=</span>fileInputStream<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>readbyte<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    outputStream<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>readbyte<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>fileInputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><div class="code-wrapper"><pre class="language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/Tomcat_2_war_exploded/downLoadServlet?filename=image_1.jpg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> å›¾ç‰‡<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/Tomcat_2_war_exploded/downLoadServlet?filename=audio.mp3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> éŸ³ä¹<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></code></pre></div><p>æ³¨æ„è¿™é‡Œçš„   ? çš„å‚æ•°ä¼ é€’ï¼ï¼</p><hr><p>##JDBC / HTML/ Mysql /JSP å®ç° ç™»å½• ã€æ³¨å†Œ å¹¶æŸ¥è¯¢ ç”¨æˆ·ä¿¡æ¯</p><ol><li>è§£å†³ ä»æµè§ˆå™¨ä¸Šè·å– è¾“å…¥çš„ä¸­æ–‡å­—ç¬¦  ä¹±ç é—®é¢˜  æ ¸å¿ƒè§£å†³æ–¹æ¡ˆï¼š</li></ol>   <div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java">resp<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"text/html;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   req<span class="token punctuation">.</span><span class="token function">setCharacterEncoding</span><span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è§£å†³ä¹±ç çš„æ ¸å¿ƒé—®é¢˜</span></code></pre></div><ol start="2"><li><p>å¯¹ Mysqlä¸­ Unique  / Null é—®é¢˜çš„è§£å†³ ï¼ï¼ï¼š</p><p>æ³¨æ„ å¼‚å¸¸æ•è·é—®é¢˜ï¼ å…ˆæ•è·å­ç±»ï¼Œå†æ• è¶…ç±» ï¼Œåˆ©ç”¨è¿”å›å€¼ ï¼Œè¿”ç»™è°ƒç”¨ç±»ï¼Œè¿™æ˜¯å¾ˆç»å…¸çš„åšæ³•</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java">  <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"insert into users values(null,?,?,?,?,?,?)"</span><span class="token punctuation">;</span>           template<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getAccount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getSex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span><span class="token comment">//ç”¨æˆ·é‡åï¼š   DuplicateKeyException æ˜¯DataIntegrityViolationExceptionçš„å­ç±»</span>    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">DuplicateKeyException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        i<span class="token operator">=</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">DataIntegrityViolationException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        i <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> i<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div></li><li><p>å¯¹ htmlé¡µé¢è¾“å…¥æ¡†ï¼Œä¸è¾“å…¥æ—¶ï¼Œ å¾—åˆ°çš„ç»“æœ å¹¶ä¸ä¸ºNULL è€Œæ˜¯ä¸º&quot;&quot; çš„æƒ…å†µ</p><ul><li><p>**å°½å¯èƒ½çš„å°†intã€doubleâ€¦ç±»å‹æ¢æˆåŒ…è£…ç±»  ** è¿™æ ·æ–¹ä¾¿ç›´æ¥èµ‹å€¼null</p></li><li><p>åœ¨æ•è·ç«¯çš„å¤„ç†</p></li><li><div class="code-wrapper"><pre><code class="language-java">    String s1=req.getParameter(&quot;age&quot;);        Integer age=null;        if(!s1.equals(&quot;&quot;))  age=Integer.valueOf(req.getParameter(&quot;age&quot;));//æˆ–è€…ç”¨ä¸‰å…ƒ åˆ¤åˆ«å¼ä¹Ÿå¯ä»¥ <pre class="language-none"><code class="language-none">4. åˆ¤æ–­ æ³¨å†Œä¿¡æ¯ é”™è¯¯æ—¶ï¼Œ é”™è¯¯æç¤ºçš„ä¼ é€’   req å­˜å‚¨ä¿¡æ¯ å¹¶å°†è½¬å‘åˆ° æ–°çš„é¡µé¢  ï¼Œforward é‡è¦   &#96;&#96;&#96;java           if(judge&#x3D;&#x3D;-1)&#123;               req.setAttribute(&quot;register_error&quot;,&quot;ç”¨æˆ·åæˆ–å¯†ç å¿…é¡»ä¸ä¸ºç©ºï¼&quot;);               req.getRequestDispatcher(&quot;&#x2F;register.jsp&quot;).forward(req,resp);           &#125;           else if(judge&#x3D;&#x3D;-2)&#123;               req.setAttribute(&quot;register_error&quot;,&quot;ç”¨æˆ·åé‡åå•¦ï¼&quot;);               req.getRequestDispatcher(&quot;&#x2F;register.jsp&quot;).forward(req,resp);           &#125;</code></pre></div></code></pre></li></ul></li><li><p>htmlé¡µé¢ä¸Šçš„æ¥æ”¶ä»¥åŠæ˜¾ç¤ºå¤„ç†  JSPåŸç†</p><p>å…ˆåˆ¤æ–­ æ˜¯å¦ä¸ºç©ºï¼Œ èµ‹å€¼ä¸ºâ€œâ€,å¦åˆ™é¡µé¢ä¼šæ˜¾ç¤º ä¸ºnull</p><div class="code-wrapper"><pre class="language-jsp" data-language="jsp"><code class="language-jsp">&lt;div&gt;&lt;% if(request.getAttribute(&quot;login_error&quot;)&#x3D;&#x3D;null)&#123;        request.setAttribute(&quot;login_error&quot;,&quot;&quot;);&#125; %&gt;    &lt;%&#x3D; request.getAttribute(&quot;login_error&quot;)%&gt;&lt;&#x2F;div&gt;</code></pre></div></li><li><p>é‡å®šå‘</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java">req<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>         resp<span class="token punctuation">.</span><span class="token function">sendRedirect</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">getContextPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"/success.jsp"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div></li><li><p>è¿˜æ˜¯å¯¹äºhtml  è·å–çš„ account å’Œ password  ä¸ºâ€œâ€ è€Œä¸ä¸ºnull ï¼Œå¼‚å¸¸æ˜¯æ•è·ä¸åˆ°çš„,æ³¨æ„ä¸€ä¸‹è¿™ç§ç°è±¡</p><p>è§£å†³åŠæ³•ï¼š</p><div class="code-wrapper"><pre class="language-none"><code class="language-none">String account&#x3D;req.getParameter(&quot;account&quot;);    if(account.equals(&quot;&quot;)) account&#x3D;null;        String password&#x3D;req.getParameter(&quot;password&quot;);    if(password.equals(&quot;&quot;)) password&#x3D;null;   </code></pre></div></li><li><p>å‘ç°çš„é—®é¢˜ï¼š</p></li><li><p>å¯¹JDBC Druid çš„ä½¿ç”¨å’Œå»ºç«‹è¿˜ä¸ç†Ÿæ‚‰</p></li><li><p>å¯¹jsp é¡µé¢çš„ä½¿ç”¨ è¿˜ä¸èƒ½é€‚åº”</p></li><li><p>å¯¹Cookie Session å¾ˆä¸ç†è§£</p></li></ol><hr><h2 id="GUI-BufferedReader-Regex-è¯»å–æ–‡æ¡£ç±»å¯¹è±¡ä¿¡æ¯å¹¶å­˜å…¥ä¸ºå…·ä½“å¯¹è±¡è¿›å…¥å…·ä½“æ•°ç»„ä¸­">GUI  / BufferedReader /  Regex è¯»å–æ–‡æ¡£ç±»å¯¹è±¡ä¿¡æ¯å¹¶å­˜å…¥ä¸ºå…·ä½“å¯¹è±¡è¿›å…¥å…·ä½“æ•°ç»„ä¸­</h2><ol><li><div class="code-wrapper"><pre><code class="language-java"> String Reg_1 = &quot;(?&lt;=\\n)[^\\n]*(?=\\s)&quot;;        String Reg_2 = &quot;(?&lt;=\\t)[^\\t]*(?=\\t)&quot;;        String Reg_3 = &quot;([0-9]+)&quot;;        Pattern pattern = Pattern.compile(Reg_1);        Matcher matcher = pattern.matcher(allInfo);<pre class="language-none"><code class="language-none">   åˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼ç­›é€‰æ•°æ®ï¼ŒPattern  &amp; Matcher è¿›è¡ŒåŒ¹é…ï¼Œå¾—åˆ°çš„æ˜¯mather çš„å¯¹è±¡   **è¸©å‘ï¼š  matcher.group()æ˜¯å¾—ä¸åˆ°å¯¹è±¡çš„ï¼Œå¿…é¡»è¦å…ˆä½¿ç”¨m.find()æ‰ä¼šè¿›è¡ŒæŸ¥æ‰¾ï¼Œä¹‹åæ‰èƒ½groupæ–¹æ³•å¾—åˆ°ä¸‹ä¸€ä¸ªå¯¹è±¡ï¼å¹¶ä¸”æ¯æ¬¡éƒ½è¦è¿™æ ·ï¼Œç±»ä¼¼äº next() **2. å¯¹å¯¹è±¡è¿›è¡Œæ·»åŠ æ—¶åˆ¤æ–­æ˜¯å¦é‡å¤ï¼Œ è¦å…ˆè¿›è¡Œ å­˜å‚¨æ•°ç»„æ˜¯å¦ä¸º Nullçš„é—®é¢˜   (size()!&#x3D;0)   3. &#96;&#96;&#96;java   StringBuilder s&#x3D;new StringBuilder(&quot;&quot;);&#x2F;&#x2F; ä¸æŠ¥é”™   StringBuilder s&#x3D;null;&#x2F;&#x2F; æŠ¥é”™ï¼ </code></pre></div>åˆ›å»ºStringBuilderçš„ç©ºå¯¹è±¡æ—¶å‘ç”Ÿçš„é—®é¢˜</code></pre></li><li><p>HashMap æ’åºçš„å®ç° å¾ˆä¸æ˜ç¡®</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java">ranklist <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>rankTime<span class="token punctuation">.</span><span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>ranklist<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Comparator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token annotation punctuation">@Override</span>         <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> o1<span class="token punctuation">,</span> <span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> o2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>             <span class="token keyword">return</span> o2<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> o1<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span>     <span class="token punctuation">&#125;</span></code></pre></div></li><li><p>å¥½ä¹ æƒ¯ï¼šåœ¨ç±»ä¸­ åˆ›å»º static çš„ é™æ€å˜é‡æ•°ç»„æˆ–è€…æ˜¯é™æ€å¸¸é‡å­—æ®µ</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">static</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Singer</span><span class="token punctuation">></span></span> singers<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span><span class="token keyword">static</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Song</span><span class="token punctuation">></span></span> songsOfYear<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span><span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">></span><span class="token punctuation">></span></span> ranklist<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span><span class="token keyword">static</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> rankTime<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span></code></pre></div><p>â€‹åœ¨ç±»çš„æ„é€ æ–¹æ³•ä¸­åˆ›å»ºå…·ä½“æ•°ç»„æˆ–è€…å¯¹è±¡çš„å®ä¾‹åŒ–</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token function">xxx</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>singers<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>scan <span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//.........</span><span class="token punctuation">&#125;</span></code></pre></div></li></ol>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>JDBC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ’åº</title>
    <link href="/2020/05/23/%E6%8E%92%E5%BA%8F/"/>
    <url>/2020/05/23/%E6%8E%92%E5%BA%8F/</url>
    
    <content type="html"><![CDATA[<h1>æ’åº</h1><p>[TOC]</p><hr><span id="more"></span><h2 id="å†’æ³¡æ’åº">å†’æ³¡æ’åº</h2><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">BubbleSort</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//è®¾ç½®äº†ä¸­æ–­ä½ï¼Œåˆ¤æ–­æ˜¯å¦å·²ç»æ˜¯æ’å¥½åºçš„æ•°ç»„äº†</span><span class="token comment">//èƒ½å¤Ÿå®ç°Oï¼ˆnï¼‰çš„æœ€ä¼˜æ—¶é—´å¤æ‚åº¦</span><span class="token keyword">int</span> isSwap <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>j <span class="token operator">&lt;</span> n <span class="token operator">-</span> i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">></span> a<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">int</span> temp <span class="token operator">=</span> a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>a<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>a<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>isSwap <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">" %d "</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>isSwap <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><h2 id="é€‰æ‹©æ’åº">é€‰æ‹©æ’åº</h2><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">SelectSort</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">int</span> min<span class="token punctuation">;</span> <span class="token keyword">int</span> k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//æœ€å°çš„æ’åœ¨å‰é¢</span>min <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> i<span class="token punctuation">;</span>j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;</span> min<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>min <span class="token operator">=</span> a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>k <span class="token operator">=</span> j<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>min <span class="token operator">!=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>a<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> min<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">" %d "</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><h2 id="å¸Œå°”æ’åº">å¸Œå°”æ’åº</h2><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">SortByShell</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span> arr<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> increment<span class="token punctuation">;</span><span class="token keyword">int</span> temp<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>increment <span class="token operator">=</span> len <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>increment <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span>increment <span class="token operator">/=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> increment<span class="token punctuation">;</span>i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>temp <span class="token operator">=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> i<span class="token punctuation">;</span>j <span class="token operator">>=</span> increment<span class="token punctuation">;</span>j <span class="token operator">-=</span> increment<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>temp <span class="token operator">&lt;</span> arr<span class="token punctuation">[</span>j <span class="token operator">-</span> increment<span class="token punctuation">]</span><span class="token punctuation">)</span>arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>j <span class="token operator">-</span> increment<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">else</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//9,8,7,6,5,4,3,2,1,10 </span>arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function">printArr</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><h2 id="æ’å…¥æ’åº">æ’å…¥æ’åº</h2><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">InsertSort</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//æ’å…¥æ’åºå‰ææ˜¯ä¹‹å‰çš„æ•°ç»„éƒ½æ˜¯æ’å¥½åºçš„äº†</span><span class="token keyword">int</span> j <span class="token operator">=</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">int</span> x <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span>j <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">></span>x<span class="token punctuation">;</span><span class="token operator">--</span>j<span class="token punctuation">)</span>a<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>a<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>k <span class="token operator">&lt;</span> n<span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><h2 id="æ¡¶å¼æ’åº">æ¡¶å¼æ’åº</h2><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c"><span class="token comment">//æ¡¶å¼æ’åº</span><span class="token keyword">void</span> <span class="token function">BucketSort</span><span class="token punctuation">(</span><span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">int</span> MAX <span class="token operator">=</span> <span class="token function">findMax</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">// ä¸ºbucketåˆ†é…ç©ºé—´ï¼Œmaxå°½å¯èƒ½çš„å‡å°‘å¤šä½™çš„ç©ºé—´</span><span class="token keyword">int</span> <span class="token operator">*</span>bucket<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">calloc</span><span class="token punctuation">(</span>MAX<span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ä¸ºæ¯ä¸€ä¸ªarrçš„æ•°è®¾ç½®æ ‡è®°ä¸º 1</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> num<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>bucket<span class="token punctuation">[</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//æ‰“å°</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> MAX<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>bucket<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d  "</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><h2 id="åŸºæ•°æ’åº">åŸºæ•°æ’åº</h2><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c"><span class="token comment">// åŸºæ•°æ’åº</span><span class="token keyword">void</span> <span class="token function">RadixSort</span><span class="token punctuation">(</span><span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">,</span><span class="token keyword">int</span> base<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">int</span> <span class="token operator">*</span>count<span class="token punctuation">;</span><span class="token comment">//å¼€è¾Ÿæœ‰åŸºæ•°baseä¸ªå…ƒç´ çš„æ•°ç»„</span>count <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">*</span>base<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// å¼€è¾Ÿ baseè¡Œ numåˆ—çš„æ•°ç»„</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token operator">*</span>temp<span class="token punctuation">;</span><span class="token keyword">int</span> maxCount <span class="token operator">=</span> <span class="token function">findMaxCount</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> countNum <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>temp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">*</span> base<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> base<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>num<span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>a <span class="token operator">&lt;</span> maxCount<span class="token punctuation">;</span>a<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//å¯¹count å’Œ tempè¿›è¡Œ åˆå§‹åŒ–</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>j <span class="token operator">&lt;</span> base<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>count<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>k <span class="token operator">&lt;</span> num<span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span>temp<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//å¯¹arræ•°ç»„ä¸­æ¯ä¸€ä¸ªæ•° è¯¥ä½æ•°ä¸Šè¿›è¡Œåˆ¤æ–­å…¥æ¡¶</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> num<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">int</span> cNum <span class="token operator">=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> countNum<span class="token punctuation">;</span><span class="token keyword">int</span> leaveNum <span class="token operator">=</span> cNum <span class="token operator">%</span> base<span class="token punctuation">;</span><span class="token comment">// è¿›è¡Œæ ‡è®°</span>count<span class="token punctuation">[</span>leaveNum<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//ä¿å­˜</span>temp<span class="token punctuation">[</span>leaveNum<span class="token punctuation">]</span><span class="token punctuation">[</span>count<span class="token punctuation">[</span>leaveNum<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> base<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//å¯»æ‰¾è¯¥ä½ä¸Šæ˜¯å¦æœ‰æ•°ï¼ˆæœ‰æ ‡è®°ï¼‰</span><span class="token keyword">if</span> <span class="token punctuation">(</span>count<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>k <span class="token operator">&lt;</span> count<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//æ¯ä¸€ä¸ªä½æ•°æ“ä½œåå¯¹countNum*10 ä»¥ä¾¿å¾—åˆ°ä¸‹ä¸€ä¸ªä½æ•°</span>countNum<span class="token operator">*=</span> base<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/*for (int i = 0;i &lt; num;i++)printf("%d ", arr[i]);*/</span><span class="token punctuation">&#125;</span></code></pre></div><h2 id="å¿«é€Ÿæ’åº">å¿«é€Ÿæ’åº</h2><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">quickSort</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span><span class="token keyword">int</span> l <span class="token punctuation">,</span><span class="token keyword">int</span> r<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>l <span class="token operator">&lt;</span> r<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token function">getIndex</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span>l<span class="token punctuation">,</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">quickSort</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span>l<span class="token punctuation">,</span>index<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">quickSort</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span>index<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span><span class="token keyword">int</span> l<span class="token punctuation">,</span><span class="token keyword">int</span> r<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> temp <span class="token operator">=</span> nums<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> i <span class="token operator">=</span> l<span class="token punctuation">;</span>        <span class="token keyword">int</span> j <span class="token operator">=</span> r<span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">&lt;</span>j<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> j <span class="token operator">&amp;&amp;</span> temp <span class="token operator">&lt;=</span> nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                j<span class="token operator">--</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> j <span class="token operator">&amp;&amp;</span> temp <span class="token operator">></span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                i<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>        <span class="token keyword">return</span> i <span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>ç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JDBC å­¦ä¹ </title>
    <link href="/2019/12/22/JDBC%E5%AD%A6%E4%B9%A0/"/>
    <url>/2019/12/22/JDBC%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1>JDBC å­¦ä¹ </h1><hr><h2 id="JDBC">JDBC</h2><p>** JAVA DATABASE CONNECTIVITY**</p><ul><li>å®šä¹‰äº† æ“ä½œæ‰€æœ‰å…³ç³»å‹æ•°æ®åº“çš„è§„åˆ™ï¼ˆæ¥å£ï¼‰ â€”SUNå…¬å¸å®šä¹‰<br>å„ä¸ªæ•°æ®åº“å‚å•†å®ç°æ¥å£ ï¼Œæä¾›é©±åŠ¨jaråŒ… <strong>çœŸæ­£æ‰§è¡Œçš„ä»£ç æ˜¯jaråŒ…ä¸­çš„å®ç°ç±»</strong></li></ul><hr><span id="more"></span><h3 id="å¯¼å…¥é©±åŠ¨jaråŒ…">å¯¼å…¥é©±åŠ¨jaråŒ…</h3><h3 id="â€“æ³¨å†Œé©±åŠ¨-â€“">â€“æ³¨å†Œé©±åŠ¨ â€“</h3><h3 id="è·å–æ•°æ®åº“è¿æ¥å¯¹è±¡-Connection-â€“">è·å–æ•°æ®åº“è¿æ¥å¯¹è±¡ Connection â€“</h3><h3 id="å®šä¹‰sql-â€“">å®šä¹‰sql â€“</h3><h3 id="è·å–æ‰§è¡Œsqlè¯­å¥å¯¹è±¡statement-â€“">è·å–æ‰§è¡Œsqlè¯­å¥å¯¹è±¡statement â€“</h3><h3 id="æ‰§è¡Œsql-æ¥å—ç»“æœ">æ‰§è¡Œsql æ¥å—ç»“æœ-</h3><h3 id="å¤„ç†ç»“æœ">å¤„ç†ç»“æœ</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token comment">//æ³¨å†Œé©±åŠ¨ ï¼ŒåŠ è½½è¿›å†…å­˜  ï¼ˆå†…å«é™æ€ä»£ç å¿« å…¶ä¸­ä¾¿æ˜¯DriverManagerçš„æ³¨å†Œæ–¹æ³•ï¼‰ï¼ï¼</span><span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.mysql.cj.jdbc.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è·å–æ•°æ®åº“è¿æ¥å¯¹è±¡</span><span class="token class-name">Connection</span> conn<span class="token operator">=</span><span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql://localhost:3306/test_db?serverTimezone=UTC"</span><span class="token punctuation">,</span><span class="token string">"root"</span><span class="token punctuation">,</span><span class="token string">"Zyl2000215"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*DriverManager  é©±åŠ¨ç®¡ç†å¯¹è±¡ï¼ˆæ³¨å†Œé©±åŠ¨ --è·å–è¿æ¥ï¼‰    getConnection (url,user,password)    url :jdbc:mssql//ip :ç«¯å£ /æ•°æ®åº“åç§°    ç»†èŠ‚ï¼šè‹¥æ˜¯æœ¬æœºçš„mysqlæœåŠ¡å™¨ä¸”ç«¯å£ä¸º3306 å¯ä»¥ä¸å†™ipï¼šç«¯å£ */</span><span class="token comment">/*    Connection    1.è·å–æ‰§è¡Œsqlå¯¹è±¡    createStatement    2.ç®¡ç†äº‹åŠ¡ï¼š    å¼€å¯äº‹åŠ¡ setAutoCommit()    æäº¤äº‹åŠ¡ commitï¼ˆï¼‰    å›æ»šäº‹åŠ¡ rollback() */</span><span class="token class-name">String</span> sql1<span class="token operator">=</span><span class="token string">"update account set salary =3000"</span><span class="token punctuation">;</span><span class="token class-name">Statement</span> stat<span class="token operator">=</span>conn<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*     Statement :     1. æ‰§è¡Œsql     int executeupdateï¼ˆstring sqlï¼‰ï¼š æ‰§è¡Œ DML DDL  è¿”å›å€¼ï¼šå½±å“çš„è¡Œæ•°     ResultSet executeQuery æ‰§è¡ŒDQL è¯­å¥ */</span><span class="token keyword">int</span> count <span class="token operator">=</span>stat<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span>sql1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*    ResultSet :    1. next():æ¸¸æ ‡å‘ä¸‹ç§»åŠ¨ä¸€è¡Œ æ³¨æ„ï¼Œæœ€å¼€å§‹çš„ä»ç¬¬ä¸€è¡Œä¹‹å‰å¼€å§‹       getXXXï¼ˆæ•°æ®ç±»å‹ï¼‰(å‚æ•°):è·å–æ•°æ®       while(rs.next())å®ç°å¾ªç¯       1ï¼Œ å‚æ•°ä¸º int ï¼šåˆ—çš„ç¼–å·  ä»  -1- å¼€å§‹       2.  å‚æ•°ä¸ºString ï¼Œ åˆ—çš„åç§°             */</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>stat<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>conn<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><h2 id="æŠ½å–JDBC-å·¥å…·ç±»ï¼ˆfor-ç®€åŒ–ä¹¦å†™ï¼‰">æŠ½å–JDBC å·¥å…·ç±»ï¼ˆfor ç®€åŒ–ä¹¦å†™ï¼‰</h2><p>1.æ³¨å†Œé©±åŠ¨ä¹ŸæŠ½å–<br>2.æŠ½å–ä¸€ä¸ªæ–¹æ³•è·å–è¿æ¥å¯¹è±¡</p><ul><li><div class="code-wrapper"><pre class="language-none"><code class="language-none">** ä½¿ç”¨é…ç½®æ–‡ä»¶---ä½¿ç”¨é™æ€ä»£ç å— ** </code></pre></div></li></ul><p>3.æŠ½å–ä¸€ä¸ªæ–¹æ³•é‡Šæ”¾èµ„æº</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> url<span class="token punctuation">;</span>   <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> user<span class="token punctuation">;</span>   <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>   <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> driver<span class="token punctuation">;</span>   <span class="token comment">/*         é™æ€ä»£ç å—ï¼Œæ–‡ä»¶åŠ è½½æ—¶æ‰§è¡Œä¸€æ¬¡    */</span>   <span class="token keyword">static</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>           <span class="token class-name">Properties</span> pro<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">//ç±»åŠ è½½å™¨  é¿å…ç›´æ¥è¾“å…¥ç»å¯¹è·¯å¾„é€ æˆè·¯å¾„è½¬ç§»æ—¶é—®é¢˜</span>           <span class="token class-name">ClassLoader</span> classLoader<span class="token operator">=</span><span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token class-name">URL</span> res<span class="token operator">=</span>classLoader<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token string">"jdbc.properties"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token class-name">String</span> path<span class="token operator">=</span>res<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           pro<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           url<span class="token operator">=</span>pro<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           user<span class="token operator">=</span>pro<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           password<span class="token operator">=</span>pro<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           driver<span class="token operator">=</span>pro<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Connection</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span><span class="token punctuation">&#123;</span>           <span class="token keyword">return</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>user<span class="token punctuation">,</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">closeAll</span><span class="token punctuation">(</span><span class="token class-name">Statement</span> stmt<span class="token punctuation">,</span> <span class="token class-name">Connection</span> conn<span class="token punctuation">,</span> <span class="token class-name">ResultSet</span> rs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>rs<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>               rs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> throwables<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               throwables<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>stmt<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>               stmt<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> throwables<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               throwables<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>conn<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>               conn<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> throwables<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               throwables<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span></code></pre></div><h2 id="PreparedStatement-æ‰§è¡Œsql-çš„å¯¹è±¡">PreparedStatement :æ‰§è¡Œsql çš„å¯¹è±¡</h2><ol><li>sqlæ³¨å…¥é—®é¢˜<ol><li>ç›®çš„ï¼š ç”¨æˆ·è¾“å…¥çš„ä¸€äº›sqlçš„ç‰¹æ®Šå…³é”®å­—å‚ä¸æ‹¼æ¥ï¼Œé€ æˆå®‰å…¨æ€§é—®é¢˜</li><li>é¢„ç¼–è¯‘sqlï¼š å‚æ•°ä½¿ç”¨ ï¼Ÿ ä½œä¸ºå ä½ç¬¦</li><li>æ­¥éª¤éº»çƒ¦ ä½†å®‰å…¨ï¼š<ol><li><p>Connection.preparedSatementï¼ˆsqlï¼‰</p></li><li><p>ç»™ï¼Ÿèµ‹å€¼ï¼š setXXX(å‚æ•°1ï¼Œå‚æ•°2)<br>å‚æ•°1ï¼š ï¼Ÿçš„ä½ç½®ç¼–å·ï¼Œä»1å¼€å§‹<br>å‚æ•°2ï¼š ï¼Ÿçš„å€¼</p></li><li><p>resultset ä¼ å‚æ—¶ï¼Œä¸éœ€è¦å†ä¼ å‚sql<br>ç›¸å½“äºpreparedSatementä»£æ›¿äº†çˆ¶ç±»statement</p></li></ol></li></ol></li></ol><p>** åæœŸéƒ½ä¼šä½¿ç”¨åˆ°preparedStatementï¼ï¼ï¼**</p><hr><h2 id="JDBC-æ§åˆ¶äº‹åŠ¡">JDBC æ§åˆ¶äº‹åŠ¡</h2><p>conn.setAutoCommit.(false);<br>æŠ“å¼‚å¸¸å›æ»šæ—¶ï¼Œæ˜¯åœ¨å¼‚å¸¸catchä¸­æŠ“ conn.rollback();</p>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>JDBC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JVM å­¦ä¹ </title>
    <link href="/2019/12/22/JVM%E5%AD%A6%E4%B9%A0/"/>
    <url>/2019/12/22/JVM%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1>JVM å­¦ä¹ æ—¥å¿—</h1><p>[toc]</p><!-- toc --><hr><h2 id="ç®€ä»‹">ç®€ä»‹</h2><p>JVM :       Java HotSoit Virtual Machine</p><p>Write once,  run anywhere</p><p>â€‹    TIOBE è¯­è¨€çƒ­åº¦æ’è¡Œ</p><p>Java ç¨‹åº  -----&gt;ç¼–è¯‘ä¸ºå­—èŠ‚ç æ–‡ä»¶(æœ¬èº«å…·æœ‰è·¨å¹³å°æ€§)    ----&gt;ä¸åŒæ“ä½œç³»ç»Ÿä¸ŠJVM</p><h3 id="JRE-å’Œ-JDKçš„å…³ç³»">JRE å’Œ JDKçš„å…³ç³»</h3><p>JDKï¼šå®ƒæ˜¯Javaå¼€å‘è¿è¡Œç¯å¢ƒï¼Œåœ¨ç¨‹åºå‘˜çš„ç”µè„‘ä¸Šå½“ç„¶è¦å®‰è£…JDKï¼›<br>JREï¼šJava Runtime Environmentå®ƒæ˜¯Javaè¿è¡Œç¯å¢ƒï¼Œå¦‚æœä½ ä¸éœ€è¦å¼€å‘åªéœ€è¦è¿è¡ŒJavaç¨‹åºï¼Œé‚£ä¹ˆä½ å¯ä»¥å®‰è£…JREã€‚ä¾‹å¦‚ç¨‹åºå‘˜å¼€å‘å‡ºçš„ç¨‹åºæœ€ç»ˆå–ç»™äº†ç”¨æˆ·ï¼Œç”¨æˆ·ä¸ç”¨å¼€å‘ï¼Œåªéœ€è¦è¿è¡Œç¨‹åºï¼Œæ‰€ä»¥ç”¨æˆ·åœ¨ç”µè„‘ä¸Šå®‰è£…JREå³å¯ã€‚<br>JDKåŒ…å«äº†JREã€‚<br>JREä¸­åŒ…å«è™šæ‹ŸæœºJVM</p><h3 id="JVMè·¨è¯­è¨€çš„å¹³å°">JVMè·¨è¯­è¨€çš„å¹³å°</h3><p>JVMèµ·å§‹ ä»<strong>å­—èŠ‚ç </strong>å¼€å§‹</p><p>å­—èŠ‚ç æ–‡ä»¶å¯ä»¥ç”±ä¸åŒçš„ç¼–ç¨‹è¯­è¨€æä¾› åœ¨javaå¹³å°<strong>è§£é‡Š</strong>è¿è¡Œ</p><p>ç”±ä¸åŒçš„ç¼–ç¨‹è¯­è¨€æä¾›ä¸åŒçš„<strong>ç¼–è¯‘å™¨</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210224091832738.png" alt="image-20210224091832738"></p><h3 id="JVMçš„è¯­è¨€æ— å…³æ€§">JVMçš„è¯­è¨€æ— å…³æ€§</h3><p>Javaè™šæ‹Ÿæœºä¸å…³å¿ƒåœ¨å†…éƒ¨è¿è¡Œçš„ç¨‹åºæ˜¯ç”¨ä½•ç§ç¼–ç¨‹è¯­è¨€å†™çš„</p><p>åªå…³å¿ƒå­—èŠ‚ç æ–‡ä»¶</p><p>åªè¦å…¶ä»–ç¼–ç¨‹è¯­è¨€çš„ç¼–è¯‘ç»“æœæ»¡è¶³å¹¶åŒ…å«Javaè™šæ‹Ÿæœºçš„å†…éƒ¨æŒ‡ä»¤é›†ï¼Œç¬¦å·è¡¨ä»¥åŠè¯·ä»–ä¿¡æ¯ï¼Œä»–å°±å¯ä»¥è¢«è£…è½½å’Œè¿è¡Œ</p><h3 id="JVM-å­—èŠ‚ç ">(JVM) å­—èŠ‚ç </h3><p>é€šè¿‡ç¼–è¯‘å™¨ç¼–è¯‘èƒ½åœ¨JVMä¸Šè¿è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶æ ¼å¼</p><p>ä¸åŒçš„ç¼–è¯‘å™¨å¯ä»¥ç¼–è¯‘å‡ºç›¸åŒçš„å­—èŠ‚ç æ–‡ä»¶  å­—èŠ‚ç æ–‡ä»¶å¯ä»¥åœ¨ä¸åŒçš„JVMä¸Šè¿è¡Œ</p><h4 id="å¤šè¯­è¨€æ··åˆç¼–ç¨‹">å¤šè¯­è¨€æ··åˆç¼–ç¨‹</h4><p>JDK 1.5 â€”&gt; Java SE 5.0</p><h3 id="è™šæ‹Ÿæœº">è™šæ‹Ÿæœº</h3><p>è½¯ä»¶ï¼šæ‰§è¡Œä¸€ç³»åˆ—è™šæ‹Ÿè®¡ç®—æœºæŒ‡ä»¤</p><p>åˆ†ç±»  ï¼š</p><ul><li>ç³»ç»Ÿè™šæ‹Ÿæœº: æä¾›å¯è¿è¡Œå®Œæ•´æ“ä½œç³»ç»Ÿçš„è½¯ä»¶å¹³å°ï¼Œæ˜¯å¯¹ç‰©ç†è®¡ç®—æœºçš„ä»¿çœŸ</li><li>ç¨‹åºè™šæ‹Ÿæœº:ä¸“é—¨ä¸º<strong>æ‰§è¡Œå•ä¸ªè®¡ç®—æœºç¨‹åº</strong>è®¾è®¡çš„   Javaè™šæ‹Ÿæœºä¸­æ‰§è¡Œçš„æŒ‡ä»¤ â€” å­—èŠ‚ç æŒ‡ä»¤</li></ul><h4 id="ç‰¹ç‚¹ï¼š">ç‰¹ç‚¹ï¼š</h4><ol><li>ä¸€æ¬¡ç¼–è¯‘åˆ°å¤„è¿è¡Œ</li><li>è‡ªåŠ¨å†…å­˜ç®¡ç†</li><li>è‡ªåŠ¨åƒåœ¾å›æ”¶æœºåˆ¶</li></ol><h4 id="è™šæ‹Ÿæœºåœ¨è®¡ç®—æœºä¸­çš„ä½ç½®">è™šæ‹Ÿæœºåœ¨è®¡ç®—æœºä¸­çš„ä½ç½®</h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210224094303154.png" alt="image-20210224094303154"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210224094516957.png" alt="image-20210224094516957"></p><h3 id="å…¶ä»–">å…¶ä»–</h3><p>OpenJDK  åŠå¹´æ›´æ–°ä¸€æ¬¡  ç»´æŠ¤åŠå¹´  ä¹‹åä¸å†ç»´æŠ¤ å…è´¹å¼€æº</p><p>OracleJDK  ç»´æŠ¤æœŸä¸‰å¹´  ä»˜è´¹ å†…å®¹ç¨å¾®å°‘ä¸€äº›</p><p>ä¸¤è€…åœ¨ä»£ç çš„å®è´¨ä¸ŠåŸºæœ¬ä¸€è‡´</p><h2 id="æ­£å¼è¿›å…¥">æ­£å¼è¿›å…¥</h2><h3 id="Javaä»£ç çš„æ‰§è¡Œæµç¨‹">Javaä»£ç çš„æ‰§è¡Œæµç¨‹</h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210224095237677.png" alt="image-20210224095237677"></p><h3 id="JVMçš„æ¶æ„">JVMçš„æ¶æ„</h3><p>Javaç¼–è¯‘å™¨è¾“å…¥çš„æŒ‡ä»¤æµæ˜¯ ä¸€ç§<strong>åŸºäºæ ˆçš„æŒ‡ä»¤é›†æ¶æ„</strong>   ä¸æ˜¯åŸºäºå¯„å­˜å™¨çš„æŒ‡ä»¤é›†æ¶æ„</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210224095537650.png" alt="image-20210224095537650"></p><h3 id="JVMçš„ç”Ÿå‘½å‘¨æœŸ">JVMçš„ç”Ÿå‘½å‘¨æœŸ</h3><ol><li>å¯åŠ¨ï¼š bootstapclass loaderå¼•å¯¼ç±»åŠ è½½å™¨åˆ›å»ºçš„åˆå§‹ç±» initial class å®Œæˆçš„ (åŠ è½½çˆ¶ç±»ï¼Ÿï¼Ÿ)</li><li>æ‰§è¡Œï¼šä¸€ä¸ªè™šæ‹Ÿæœºå¯¹åº”ç€æ‰§è¡Œä¸€ä¸ªJavaç¨‹åº</li><li>é€€å‡ºï¼šå¼‚å¸¸ ã€ æ­£å¸¸æ‰§è¡Œå®Œæ¯•ã€æ“ä½œç³»ç»Ÿé”™è¯¯ã€exitæ–¹æ³•</li></ol><h2 id="ç±»åŠ è½½">ç±»åŠ è½½</h2><h3 id="ClassLoader">ClassLoader</h3><p>åªè´Ÿè´£class æ–‡ä»¶çš„åŠ è½½ï¼Œè‡³äºæ˜¯å¦èƒ½è¿è¡Œï¼Œç”±Execution Engineå†³å®š</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210224152835665.png" alt="image-20210224152835665"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210224153411382.png" alt="image-20210224153411382"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210224163801377.png" alt="image-20210224163801377"></p><h3 id="åŠ è½½Loadingï¼š">åŠ è½½Loadingï¼š</h3><ol><li>é€šè¿‡ç±»çš„å…¨é™å®šåè·å–å®šä¹‰æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµ</li><li>å°†è¯¥å­—èŠ‚æµä»£è¡¨çš„é™æ€å­˜å‚¨ç»“æ„è½¬åŒ–ä¸ºæ–¹æ³•çš„è¿è¡Œæ—¶æ•°æ®</li><li>å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨æ­¤ç±»çš„ java.lang.Classå¯¹è±¡ï¼Œä½œä¸ºæ–¹æ³•åŒºè¿™ä¸ªç±»çš„å„ä¸ªæ•°æ®çš„è®¿é—®å…¥å£</li></ol><h3 id="é“¾æ¥Linkingé˜¶æ®µï¼š">é“¾æ¥Linkingé˜¶æ®µï¼š</h3><h4 id="éªŒè¯-Verify">éªŒè¯ Verify</h4><p>ç¡®ä¿Classæ–‡ä»¶çš„å­—èŠ‚æµä¸€ä¸­åŒ…å«ä¿¡æ¯ç¬¦å·å½“å‰çš„è™šæ‹Ÿæœºè¦æ±‚ï¼Œä¿è¯<strong>åŠ è½½ç±»çš„æ­£ç¡®æ€§</strong>ï¼Œä¸å±å®³è™šæ‹Ÿæœºè‡ªèº«å®‰å…¨ã€‚</p><p>æ–‡ä»¶æ ¼å¼éªŒè¯ å…ƒæ•°æ®éªŒè¯  å­—èŠ‚ç éªŒè¯ ç¬¦å·å¼•ç”¨éªŒè¯</p><h4 id="å‡†å¤‡-Prepare">å‡†å¤‡ Prepare</h4><p>ä¸ºç±»å˜é‡åˆ†é…å†…å­˜å¹¶ä¸”è®¾ç½®è¯¥å†…å˜é‡çš„é»˜è®¤åˆå§‹å€¼ï¼Œå“ªæ€•æ˜¯a = 1 æœ€å¼€å§‹ä¹Ÿæ˜¯  a=0</p><p>ä¸åŒ…å«ç”¨finalä¿®é¥°çš„static  finalåœ¨ç¼–è¯‘é˜¶æ®µå°±ä¼šåˆ†é…äº†</p><h4 id="è§£æ-Resolve">è§£æ Resolve</h4><p>å°†å¸¸é‡æ± å†…çš„ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210228145418046.png" alt="image-20210228145418046"></p><h3 id="ç±»çš„åˆå§‹åŒ–">ç±»çš„åˆå§‹åŒ–</h3><p>æ‰§è¡Œç±»æ„é€ å™¨æ–¹æ³• clinit  çš„è¿‡ç¨‹</p><p>javac ç¼–è¯‘å™¨è‡ªåŠ¨æ”¶é›†ç±»ä¸­çš„æ‰€æœ‰<span style='color:red;'>ç±»å˜é‡</span>çš„<strong>èµ‹å€¼åŠ¨ä½œ</strong>å’Œ<strong>é™æ€ä»£ç å—ä¸­è¯­å¥</strong>åˆå¹¶è€Œæ¥</p><p>æœ‰é™æ€è¯­å¥ æˆ–è€… é™æ€å˜é‡ å°±ä¼šæœ‰ clinit æ–¹æ³•      ä¸åŒ…å«ä¸»æ–¹æ³•</p><p>clinit æ–¹æ³•ä¸€å®šæ˜¯å…ˆæ‰§è¡Œçˆ¶ç±»çš„ clinit åœ¨è¿›è¡Œå­ç±»çš„clinit</p><p>è™šæ‹Ÿæœºå¿…é¡»ä¿è¯ä¸€ä¸ªç±»çš„clinit æ–¹æ³•åœ¨å¤šçº¿ç¨‹ä¸‹è¢«åŒæ­¥åŠ é”</p><p>static ä»£ç å— å’Œ staticå˜é‡çš„èµ‹å€¼ æœ‰é¡ºåºçš„å…³ç³»ï¼Œé‚£ä¸ªåœ¨å é‚£ä¸ªåæ‰§è¡Œï¼Œä½†æ˜¯å¯ä»¥åœ¨staticè¯­å¥å—ä¸­èµ‹å€¼å†å®šä¹‰ ------æœ‰ä¸€ä¸ªæ³¨æ„ç‚¹  éæ³•çš„å‰å‘å¼•ç”¨ï¼ˆå¯ä»¥èµ‹å€¼ä½†ä¸èƒ½è°ƒç”¨ï¼‰</p><h5 id="å˜é‡åˆå§‹åŒ–è¿‡ç¨‹">å˜é‡åˆå§‹åŒ–è¿‡ç¨‹</h5><p>é»˜è®¤åˆå§‹åŒ–â€“æ˜¾ç¤ºåˆå§‹åŒ–- -æ„é€ å™¨åˆå§‹åŒ–â€“å¯¹è±¡.å±æ€§çš„åˆå§‹åŒ–</p><h3 id="åŠ è½½å™¨çš„åˆ†ç±»">åŠ è½½å™¨çš„åˆ†ç±»</h3><h4 id="BootStapClassLoad">BootStapClassLoad</h4><ul><li>ç”¨c/c++å®ç° åµŒå¥—åœ¨JVMå†…éƒ¨</li><li>ä¸ç»§æ‰¿ClassLoader</li></ul><p>ç³»ç»Ÿçš„æ ¸å¿ƒç±»åº“éƒ½æ˜¯ç”¨å¼•å¯¼ç±»åŠ è½½å™¨åŠ è½½çš„</p><p>ä¸èƒ½ç›´æ¥é€šè¿‡getClassLoaderè·å–</p><h4 id="AppClassLoader">AppClassLoader</h4><p>åŠ è½½ç¯å¢ƒå˜é‡classpathå’Œç³»ç»Ÿå±æ€§ java.class.path  æ˜¯ç¨‹åºä¸­çš„<strong>é»˜è®¤ç±»åŠ è½½å™¨</strong></p><h4 id="ExtensionLoader">ExtensionLoader</h4><p>ä»java.ext.dirsç³»ç»Ÿå±æ€§æŒ‡å®šçš„ç›®å½•ä¸­åŠ è½½ç±»åº“</p><h4 id="è‡ªå®šä¹‰ç±»åŠ è½½å™¨">è‡ªå®šä¹‰ç±»åŠ è½½å™¨</h4><p>ç›®çš„ï¼š</p><ul><li>éš”ç¦»åŠ è½½ç±»</li><li>ä¿®æ”¹ç±»åŠ è½½çš„æ–¹å¼</li><li>æ‰©å±•åŠ è½½æº</li><li>é˜²æ­¢æºç æ³„éœ²</li></ul><h2 id="åŒäº²å§”æ´¾æœºåˆ¶">åŒäº²å§”æ´¾æœºåˆ¶</h2><p>é—®é¢˜å¼•å…¥ï¼š</p><p>è‡ªå·±åˆ›å»º çš„ java.lang.String å’ŒåŸç”Ÿçš„å†²çª ä¼šå…ˆåŠ è½½åŸæ¥çš„</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210224173500988.png" alt="image-20210224173500988"></p><ol><li>ä¸€ä¸ªé›·åŠ è½½å™¨æ”¶åˆ°äº†ç±»åŠ è½½è¯·æ±‚ï¼Œä»–å¹¶ä¸ä¼šè‡ªå·±å…ˆåŠ è½½ï¼Œè€Œæ˜¯æŠŠè¿™ä¸ªè¯·æ±‚å§”æ‰˜ç»™çˆ¶ç±»çš„åŠ è½½å™¨æ‰§è¡Œã€‚</li><li>ä¸€æ¬¡é€’å½’è¯·æ±‚æœ€ç»ˆåˆ°è¾¾é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨</li><li>å¦‚æœçˆ¶ç±»çš„åŠ è½½å™¨æ— æ³•åŠ è½½ï¼ˆå¼•å¯¼ç±»åŠ è½½å™¨å’Œæ‹“å±•ç±»åŠ è½½å™¨åªåŠ è½½æŒ‡å®šç›®å½•çš„classï¼‰ï¼Œæ‰ä¼šå§”æ´¾ç»™å­ç±»çš„åŠ è½½å™¨åŠ è½½</li></ol><h3 id="ä¼˜ç‚¹">ä¼˜ç‚¹</h3><ol><li>ä¿æŠ¤ç¨‹åºå®‰å…¨ï¼Œé¿å…æ ¸å¿ƒAPIè¢«æ›´æ”¹</li><li>é¿å…ç±»çš„é‡å¤åŠ è½½</li></ol><h2 id="æ²™ç®±å®‰å…¨æœºåˆ¶">æ²™ç®±å®‰å…¨æœºåˆ¶</h2><p>æ²™ç®±å®‰å…¨æœºåˆ¶æ˜¯ç”±åŸºäºåŒäº²å§”æ´¾æœºåˆ¶ä¸Š é‡‡å–çš„ä¸€ç§JVMçš„è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶,å‡è®¾ä½ è¦å†™ä¸€ä¸ªjava.lang.String çš„ç±»,ç”±äºåŒäº²å§”æ´¾æœºåˆ¶çš„åŸç†,æ­¤è¯·æ±‚ä¼šå…ˆäº¤ç»™Bootstrapè¯•å›¾è¿›è¡ŒåŠ è½½,ä½†æ˜¯Bootstrapåœ¨åŠ è½½ç±»æ—¶é¦–å…ˆé€šè¿‡åŒ…å’Œç±»åæŸ¥æ‰¾rt.jarä¸­æœ‰æ²¡æœ‰è¯¥ç±»,æœ‰åˆ™ä¼˜å…ˆåŠ è½½rt.jaråŒ…ä¸­çš„ç±»,å› æ­¤å°±ä¿è¯äº†javaçš„è¿è¡Œæœºåˆ¶ä¸ä¼šè¢«ç ´å.</p><p>è™šæ‹Ÿæœºä¼šæŠŠæ‰€æœ‰ä»£ç åŠ è½½åˆ°ä¸åŒçš„ç³»ç»ŸåŸŸå’Œåº”ç”¨åŸŸï¼Œç³»ç»ŸåŸŸéƒ¨åˆ†ä¸“é—¨è´Ÿè´£ä¸å…³é”®èµ„æºè¿›è¡Œäº¤äº’ï¼Œè€Œå„ä¸ªåº”ç”¨åŸŸéƒ¨åˆ†åˆ™é€šè¿‡ç³»ç»ŸåŸŸçš„éƒ¨åˆ†ä»£ç†æ¥å¯¹å„ç§éœ€è¦çš„èµ„æºè¿›è¡Œè®¿é—®ã€‚è™šæ‹Ÿæœºä¸­ä¸åŒçš„å—ä¿æŠ¤åŸŸ (Protected Domain)ï¼Œå¯¹åº”ä¸ä¸€æ ·çš„æƒé™ (Permission)</p><h2 id="å…¶ä»–-v2">å…¶ä»–</h2><p>JVMä¸­åˆ¤æ–­ä¸¤ä¸ªclasså¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªç±»å­˜åœ¨çš„ä¸¤ä¸ªæ¡ä»¶</p><ol><li>ç±»çš„å®Œæ•´åç§°å¿…é¡»ä¸€è‡´</li><li>åŠ è½½è¿™ä¸ªç±»çš„åŠ è½½å™¨å¿…é¡»ç›¸åŒ</li></ol><h3 id="ç±»çš„ä¸»åŠ¨ä½¿ç”¨å’Œè¢«åŠ¨ä½¿ç”¨">ç±»çš„ä¸»åŠ¨ä½¿ç”¨å’Œè¢«åŠ¨ä½¿ç”¨</h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210224184726345.png" alt="image-20210224184726345"></p><h2 id="è¿è¡Œæ—¶æ•°æ®åŒº">è¿è¡Œæ—¶æ•°æ®åŒº</h2><p>RunTime Data Area        æ¡¥æ¢: CPU  â€” å†…å­˜ ---- ç¡¬ç›˜</p><p>ä¸åŒçš„JVMå¯¹å†…å­˜çš„åˆ’åˆ†æ–¹å¼å’Œç®¡ç†æœºåˆ¶å­˜åœ¨å·®å¼‚</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210225201740198.png" alt="image-20210225201740198"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210225201756298.png" alt="image-20210225201756298"></p><p><strong><span style='color:red;'>çº¢è‰² </span> ä¸€ä¸ªè¿›ç¨‹ä¸€ä»½</strong></p><p><strong>ç°è‰²  ä¸€ä¸ªçº¿ç¨‹ä¸€ä»½</strong></p><p><span style='color:red;'> ä¸€ä¸ªJVMå®ä¾‹å¯¹åº”ä¸€ä¸ªRunTimeå®ä¾‹</span></p><p>HotSpot JVMæ¯ä¸ªçº¿ç¨‹å¯¹åº”æ“ä½œèƒ¸è†›çš„æœ¬åœ°çº¿ç¨‹ç›´æ¥æ˜ å°„</p><h3 id="è™šæ‹Ÿæœºæ ˆ">è™šæ‹Ÿæœºæ ˆ</h3><h4 id="æ¦‚å¿µ-v4">æ¦‚å¿µ</h4><p>å†…éƒ¨ä¿å­˜ä¸€ä¸ªä¸ªçš„æ ˆå¸§ï¼Œå¯¹åº”ç€ä¸€æ¬¡æ¬¡çš„javaæ–¹æ³•è°ƒç”¨ï¼ˆçº¿ç¨‹ç§æœ‰ï¼‰</p><ul><li><p>ç”Ÿå‘½å‘¨æœŸå’Œçº¿ç¨‹ä¸€è‡´</p></li><li><p>æ ˆæ˜¯è¿è¡Œæ—¶å•ä½ï¼Œå †æ˜¯å­˜å‚¨å•ä½</p></li></ul><p>ä½œç”¨ï¼šä¸»ç®¡javaç¨‹åºçš„è¿è¡Œï¼Œä¿å­˜æ–¹æ³•çš„å±€éƒ¨å˜é‡ï¼Œéƒ¨åˆ†ç»“æœï¼Œå‚ä¸æ–¹æ³•çš„è°ƒç”¨å’Œè¿”å›</p><p>ä¼˜ç‚¹ï¼š è®¿é—®é€Ÿåº¦å¿«  <strong>ä¸å­˜åœ¨åƒåœ¾å›æ”¶é—®é¢˜</strong> <strong>GC</strong>   (åªæœ‰è¿›æ ˆå‡ºæ ˆæ“ä½œ) ä½†å¯èƒ½å­˜åœ¨OOM</p><p>è®¾ç½®æ ˆå¤§å° VMOptions: -Xss256k</p><h4 id="å¼‚å¸¸-v2">å¼‚å¸¸</h4><ul><li>JVMå…è®¸javaæ ˆå¤§å°æ˜¯åŠ¨æ€æˆ–è€…å›ºå®šçš„</li><li>æ ˆæº¢å‡ºå¼‚å¸¸ï¼š çº¿ç¨‹çš„è¯·æ±‚åˆ†é…çš„æ ˆå®¹é‡è¶…è¿‡JAVAè™šæ‹Ÿæœºå…è®¸çš„æœ€å¤§å®¹é‡ï¼Œå°†æŠ›å‡ºStack Overflowå¼‚å¸¸</li><li>OOMï¼š åŠ¨æ€æ‰©å±•æ—¶æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜å»ç”³è¯·æˆ–è€…åˆ›å»ºï¼Œåˆ™è·‘å‡ºOutofMemoryErrorå¼‚å¸¸</li></ul><h4 id="æ ˆå¸§">æ ˆå¸§</h4><p>æ ˆä¸­çš„æ•°æ®éƒ½æ˜¯ä»¥æ ˆå¸§æ–¹å¼å­˜åœ¨çš„ï¼Œæ¯ä¸ªæ–¹æ³•éƒ½å¯¹åº”ä¸€ä¸ªæ ˆå¸§</p><p>å½“å‰æ ˆå¸§ï¼šå½“å‰æ‰§è¡Œæ–¹æ³•ã€‚</p><p>ä¸åŒçº¿ç¨‹çš„æ ˆå¸§æ˜¯ä¸å…è®¸ç›¸äº’å¼•ç”¨çš„ï¼Œä¸èƒ½åœ¨ä¸€ä¸ªçº¿ç¨‹çš„æ–¹æ³•é‡Œå»è°ƒç”¨å¦ä¸€ä¸ªçº¿ç¨‹ä¸­çš„æ–¹æ³•</p><p>åŒ…å«ï¼š</p><h5 id="å±€éƒ¨å˜é‡è¡¨">å±€éƒ¨å˜é‡è¡¨</h5><p>(åŸºæœ¬å†³å®šæ ˆå¸§çš„å¤§å°)</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210228084320963.png" alt="image-20210228084320963"></p><ul><li><p>æ•°å­—æ•°ç»„ï¼Œå­˜å‚¨æ–¹æ³•å‚æ•°å’Œå®šä¹‰åœ¨æ–¹æ³•ä½“å†…çš„å±€éƒ¨å˜é‡ã€‚åŒ…å«åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå¯¹è±¡å¼•ç”¨  ï¼ˆ<strong>byte short boolean char è¢«è½¬æ¢ä¸ºint</strong>ï¼‰ï¼Œè¿”å›å€¼ç±»å‹</p></li><li><p><span style='color:red;font-size:24px'>åƒåœ¾å›æ”¶çš„é‡ç‚¹å†…å®¹</span></p></li><li><p>æ‰€éœ€å¤§å°æ˜¯ç¼–è¯‘å™¨ç¡®å®šä¸‹æ¥çš„ã€‚æœªè¢«èµ‹å€¼çš„å£°æ˜æ˜¯ä¸ä¼šåˆ—å…¥å±€éƒ¨å˜é‡è¡¨çš„slotï¼Œä½†ä¼šåˆ—å…¥locals(maximum local variables)ä¸­</p></li><li><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210228090243915.png" alt="image-20210228090243915"></p></li><li><p>Slot  æ§½ï¼šå±€éƒ¨å˜é‡è¡¨çš„åŸºæœ¬å•ä½</p><ul><li>32ä½ä»¥å†…çš„ç±»å‹åªå ç”¨ä¸€ä¸ªslot <strong>64ä½å ç”¨ä¸¤ä¸ªslotï¼Œåœ¨localsä¸­çœ‹å¾—å‡ºæ¥</strong><ul><li>åœ¨å¤–éƒ¨æ–¹æ³•ä¸­å¼•ç”¨è¯¥ç±»ä¸­å¯¹è±¡æˆ–è€…æ–¹æ³•æ—¶ï¼ˆä¸å¼•ç”¨ä¹Ÿä¼šæœ‰ï¼‰ slot index0 ä½ç½®ä¼šä¿å­˜ç±»çš„å¯¹è±¡å¼•ç”¨this</li><li>slotä¸­çš„å˜é‡å­˜åœ¨<strong>é‡å¤åˆ©ç”¨</strong>ï¼Œå†…éƒ¨åŸŸå˜é‡è¿‡æœŸåçš„slotä½ç½®å°†ç”±å¤–éƒ¨éå†æ›¿ä»£</li><li>å±€éƒ¨å˜é‡åˆå§‹åŒ–åå†ä½¿ç”¨æ—¶å¿…é¡»èµ‹å€¼ï¼Œå¦åˆ™ç¼–è¯‘ä¸é€šè¿‡</li></ul></li></ul></li></ul><h5 id="æ“ä½œæ•°æ ˆ">æ“ä½œæ•°æ ˆ</h5><p>æ•°ç»„ã€é“¾è¡¨å®ç° FILO</p><p>ä½œç”¨ï¼šæ ¹æ®å­—èŠ‚ç æŒ‡ä»¤ï¼Œåœ¨æ ˆä¸­å†™å…¥æ•°æ®ï¼Œå…¥æ ˆå’Œå‡ºæ ˆï¼Œä¿å­˜è®¡ç®—è¿‡ç¨‹çš„ä¸­é—´ç»“æœ</p><ul><li>a + b = cå®ä¾‹</li></ul><h6 id="ä»£ç è§£æ">ä»£ç è§£æ</h6><p>bipush: è¿™é‡Œçš„ bi ä»£è¡¨byte çš„æ•´å‹ï¼Œä¸ä»£ç ä¸­å®šä¹‰çš„int byteç±»å‹æ— å…³ï¼Œä»–åªä¸ç»“æœçš„å…·ä½“æ•°å€¼æœ‰å…³ï¼Œè½¬æ¢æˆæœ€æ¥è¿‘çš„ç±»å‹]</p><p>istore:å°†pushçš„byteå€¼è½¬æ¢ä¸ºjavaä¸­ç±»å‹å¯¹åº”çš„intå€¼</p><p>æ³¨æ„è¿™é‡Œistore_0å’Œistore_1çš„åŒºåˆ«ï¼Œå¦‚æœæ˜¯ä¸»æ–¹æ³•æˆ–è€…æ™®é€šæ–¹æ³•æ—¶ï¼Œè¦ä¹ˆä¿å­˜çš„æ˜¯å¯¹è±¡çš„å¼•ç”¨this è¦ä¹ˆå°±æ˜¯argså‚æ•°åœ¨index ä¸º0ä½ç½®ã€‚å¦‚æœæ˜¯ç±»çš„é™æ€æ–¹æ³•ä¸­æ—¶ï¼Œåˆ™å°±ä¸å­˜åœ¨å…¶ä»–çš„æ•°æ®ï¼Œä¸€ä¸ªæ•°æ®éƒ½ä¿å­˜åœ¨index0å¤„</p><p>iconstï¼šå½“intå–å€¼**-1~5<strong>æ—¶ï¼ŒJVMé‡‡ç”¨</strong>iconst**æŒ‡ä»¤å°†å¸¸é‡å‹å…¥æ ˆä¸­ã€‚</p><div class="code-wrapper"><pre class="language-none"><code class="language-none">0: bipush        10     2: istore_1     3: bipush        20     5: istore_2     6: iload_1     7: iload_2     8: iadd     9: istore_3    10: return</code></pre></div><ul><li>æ¯ä¸ªæ“ä½œæ•°æ ˆéƒ½æ‹¥æœ‰ä¸€ä¸ªæ˜ç¡®çš„æ ˆæ·±åº¦å­˜å‚¨æ•°å€¼ï¼Œç¼–è¯‘å™¨å°±å®šä¹‰å¥½</li></ul><p>Code â€” max_stackä¸­</p><ul><li>æ ˆå ç”¨å•ä½åŒslot</li><li>æ“ä½œæ•°æ ˆä¸­å­˜åœ¨å¤ç”¨</li><li>å¦‚æœè¢«è°ƒç”¨çš„æ–¹æ³•ä¸­å¸¦æœ‰è¿”å›å€¼çš„è¯ï¼Œå…¶è¿”å›å€¼å°†ä¼šè¢«å‹å…¥å½“å‰æ ˆå¸§æ“ä½œæ•°æ ˆä¸­ï¼Œå¹¶æ›´æ–°pcå¯„å­˜å™¨ä¸­çš„æŒ‡ä»¤</li></ul><h6 id="æ ˆé¡¶ç¼“å­˜æŠ€æœ¯">æ ˆé¡¶ç¼“å­˜æŠ€æœ¯</h6><p>å‡ºå‘ç‚¹ï¼šæ ˆç»“æ„ï¼Œé¢‘ç¹æ‰§è¡Œå†…å­˜è¯»å†™ï¼ˆå‡ºæ ˆå…¥æ ˆï¼‰</p><p>æ ˆé¡¶å…ƒç´ å…¨éƒ¨ç¼“å­˜åœ¨cpuå¯„å­˜å™¨ä¸­ï¼Œæå‡æ‰§è¡Œå¼•æ“çš„æ•ˆç‡</p><h5 id="åŠ¨æ€é“¾æ¥">åŠ¨æ€é“¾æ¥</h5><p>------è¿è¡Œæ—¶å¸¸é‡æ± çš„æ–¹æ³•å¼•ç”¨</p><p>æ¯ä¸€ä¸ªæ ˆå¸§å†…éƒ¨éƒ½åŒ…å«ä¸€ä¸ªæŒ‡å‘<strong>è¿è¡Œæ—¶å¸¸é‡æ± </strong>ä¸­è¯¥æ ˆå¸§æ‰€å±æ–¹æ³•çš„å¼•ç”¨</p><p>ç›®çš„ï¼šæ”¯æŒå½“å‰æ–¹æ³•çš„ä»£ç èƒ½å¤Ÿå®ç°åŠ¨æ€é“¾æ¥ï¼Œå°†ä¿å­˜å˜é‡å’Œæ–¹æ³•å¼•ç”¨çš„ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºè°ƒç”¨æ–¹æ³•çš„ç›´æ¥å¼•ç”¨</p><h6 id="æ–¹æ³•çš„è°ƒç”¨">æ–¹æ³•çš„è°ƒç”¨</h6><p>é™æ€é“¾æ¥å’ŒåŠ¨æ€é“¾æ¥</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210228141739834.png" alt="image-20210228141739834"></p><p>é™æ€é“¾æ¥ï¼šç›®æ ‡æ–¹æ³•åœ¨ç¼–è¯‘æœŸé—´å¯çŸ¥ä¸”è¿è¡ŒæœŸä¿æŒä¸å˜ï¼Œè¿™ç§æƒ…å†µä¸‹é™è°ƒç”¨æ–¹æ³•çš„ç¬¦å·åº”ç”¨è½¬æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ç§°ä¸ºé™æ€é“¾æ¥</p><p>åŠ¨æ€é“¾æ¥ï¼šç¼–è¯‘æ—¶æ— æ³•ç¡®å®š</p><p>æ–¹æ³•çš„ç»‘å®šæœºåˆ¶ï¼šæ—©æœŸç»‘å®šå’Œæ™šæœŸç»‘å®š</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210228142033732.png" alt="image-20210228142033732"></p><p>æ™šæœŸç»‘å®šï¼š</p><p>å¤šæ€ã€ç»§æ‰¿ï¼Œæ— æ³•ç¡®å®š  ----invokeVirtual</p><p>æ—©æœŸç»‘å®šï¼š</p><p>invokeSpecial</p><p>è™šæ–¹æ³•ï¼š</p><p>éè™šæ–¹æ³•ï¼š</p><ul><li><p>ç¼–è¯‘æœŸé—´ç¡®å®šç‰ˆæœ¬ï¼Œè¿è¡Œæ—¶ä¸å¯å˜</p></li><li><p>é™æ€æ–¹æ³•ã€ç§æœ‰æ–¹æ³•ã€finalæ–¹æ³•ã€ç¤ºä¾‹æ„é€ å™¨ã€çˆ¶ç±»æ–¹æ³•</p></li></ul><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210228143133793.png" alt="image-20210228143115307"></p><p>åœ¨å­ç±»ä¸­æœªæ˜¾ç¤ºçš„è°ƒç”¨çˆ¶ç±»æ–¹æ³•æ˜¯è™šæ–¹æ³•ï¼ˆå¯èƒ½å­ç±»è¿›è¡Œäº†é‡å†™ï¼‰</p><p><span style='font-size:24px;color:orange'>åŠ¨æ€ç±»å‹å’Œé™æ€ç±»å‹è¯­è¨€çš„åŒºåˆ«</span></p><p>å¯¹ç±»å‹çš„æ£€æŸ¥æ˜¯åœ¨ç¼–è¯‘æœŸé—´è¿˜æ˜¯åœ¨è¿è¡ŒæœŸé—´</p><ul><li><p>å‰è€…åˆ¤æ–­å˜é‡è‡ªèº«çš„ç±»å‹ä¿¡æ¯</p></li><li><p>åè€…åˆ¤æ–­å˜é‡å€¼çš„ç±»å‹ä¿¡æ¯ï¼Œå˜é‡æ˜¯æ²¡æœ‰ç±»å‹ä¿¡æ¯çš„ï¼ˆJavaScriptï¼‰</p></li></ul><p><span style='font-size:24px;color:orange'>è™šæ–¹æ³•è¡¨</span></p><p>ç›®çš„ï¼š é¿å…è‡ªä¸‹è€Œä¸Šé¢‘ç¹çš„ä½¿ç”¨åŠ¨æ€åˆ†é…</p><p>åˆ›å»ºé˜¶æ®µï¼š linking</p><p>æ¯ä¸ªç±»ä¸­éƒ½æœ‰ä¸€ä¸ªè™šæ–¹æ³•è¡¨</p><h5 id="æ–¹æ³•è¿”å›åœ°å€">æ–¹æ³•è¿”å›åœ°å€</h5><p>æ–¹æ³•æ­£å¸¸é€€å‡ºçš„å®šä¹‰ï¼ˆå¼‚å¸¸é€€å‡ºæ—¶ç”±å¼‚å¸¸è¡¨å†³å®šï¼‰</p><p>å­˜æ”¾è°ƒç”¨è¯¥æ–¹æ³•çš„<strong>pcå¯„å­˜å™¨</strong>çš„å€¼ ç±»ä¼¼retï¼Ÿï¼Ÿï¼Ÿ</p><p><span style='font-size:18px;color:cyan'>å¼‚å¸¸å¤„ç†è¡¨</span></p><p>classæ–‡ä»¶ä¸­   from  to  target</p><p>å¼‚å¸¸å®Œæˆå‡ºå£ä¸ä¼šç»™ä¸Šå±‚è°ƒç”¨è€…ä»»ä½•è¿”å›çš„ä¿¡æ¯</p><h5 id="é™„åŠ ä¿¡æ¯">é™„åŠ ä¿¡æ¯</h5><h3 id="æœ¬åœ°æ–¹æ³•æ ˆ">æœ¬åœ°æ–¹æ³•æ ˆ</h3><ul><li>çº¿ç¨‹ç§æœ‰</li><li>å†…å­˜ å›ºå®šæˆ–è€…åŠ¨æ€æ‰©å±•</li><li>æœ¬åœ°æ–¹æ³•ç”¨Cè¯­è¨€å®ç°</li><li>å®ç°ï¼šè™šæ‹Ÿæœºæ ˆä¸­ç™»è®°æœ¬åœ°æ–¹æ³•</li></ul><p>å½“çº¿ç¨‹è°ƒç”¨æœ¬åœ°æ–¹æ³•æ—¶ï¼Œå°±è¿›å…¥äº†ä¸€ä¸ªå…¨æ–°çš„ä¸å—è™šæ‹Ÿæœºé™åˆ¶çš„ ä¸–ç•Œï¼Œå’Œè™šæ‹Ÿæœºæœ‰ç›¸åŒçš„æƒé™</p><p>æœ¬åœ°æ–¹æ³•é€šè¿‡æœ¬åœ°æ–¹æ³•æ¥å£è®¿é—®è™šæ‹Ÿæœºå†…éƒ¨è¿è¡Œæ—¶æ•°æ®åŒº</p><h4 id="æœ¬åœ°æ–¹æ³•æ¥å£å’Œåº“">æœ¬åœ°æ–¹æ³•æ¥å£å’Œåº“</h4><p>Native Method : Java è°ƒç”¨éJavaä»£ç </p><h3 id="ç¨‹åºè®¡æ•°å™¨">ç¨‹åºè®¡æ•°å™¨</h3><p>ç”¨æ¥å­˜å‚¨æŒ‡å‘ä¸‹ä¸€æ¡æŒ‡ä»¤çš„çš„<strong>å­—èŠ‚ç </strong>åœ°å€( ProgramCounter Register)</p><ul><li><p>å¾ˆå°çš„å†…å­˜ç©ºé—´ï¼Œè¿è¡Œé€Ÿåº¦æœ€å¿«</p></li><li><p>çº¿ç¨‹ç§æœ‰ï¼Œç”Ÿå‘½å‘¨æœŸå’Œçº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸä¿æŒä¸€è‡´</p></li><li><p>å­˜å‚¨å½“å‰çº¿ç¨‹æ­£åœ¨æ‰§è¡Œæ–¹æ³•çš„JVMæŒ‡ä»¤åœ°å€ å¦‚æœæ‰§è¡Œnativeæ–¹æ³•åˆ™æ˜¯æœªæŒ‡å®šå€¼</p></li><li><p>å”¯ä¸€ä¸€ä¸ªåœ¨JVMè§„èŒƒä¸­æ²¡æœ‰è§„å®šä»»ä½•OOMæƒ…å†µçš„åŒºåŸŸ</p></li><li><p>çº¿ç¨‹åˆ†æ”¯å¾ªç¯è·³è½¬å¼‚å¸¸å¤„ç†ã€æ¢å¤ç­‰åŸºç¡€åŠŸèƒ½éƒ½éœ€è¦ä¾èµ–ä»–</p></li></ul><h4 id="PCå¯„å­˜å™¨çš„å¥½å¤„">PCå¯„å­˜å™¨çš„å¥½å¤„</h4><p>CPUä¼šä¸åœåˆ‡æ¢çº¿ç¨‹ï¼Œåˆ‡æ¢å›æ¥ä»¥åä¸çŸ¥é“ä»é‚£å¼€å§‹æ‰§è¡Œ</p><p>æŒ‡æ˜å½“å‰æ‰§è¡Œä»£ç çš„å­—èŠ‚ç æŒ‡ä»¤</p><h4 id="CPUæ—¶é—´ç‰‡">CPUæ—¶é—´ç‰‡</h4><ul><li><p>CPUåˆ†é…ç»™å„ä¸ªç¨‹åºçš„æ—¶é—´</p></li><li><p><strong>CPUä¸»é¢‘é«˜ï¼Œä¸æ–­çš„åˆ‡æ¢ï¼Œæ„Ÿè§‰åƒæ˜¯åœ¨å¹¶è¡Œï¼ˆä¸æ˜¯å¹¶å‘ï¼‰çš„æ‰§è¡Œ</strong>-------è¿™å°±å«å¹¶å‘</p></li><li><p>ä¸€ä¸ªå†…æ ¸ä¸€æ—¶åˆ»åªèƒ½æ‰§è¡Œä¸€æ¡æŒ‡ä»¤</p></li></ul><h3 id="å †">å †</h3><p>ä¸€ä¸ªJVMåªå­˜åœ¨ä¸€ä¸ªå †å†…å­˜      ä¸€ä¸ªè¿›ç¨‹å¯¹åº”ä¸€ä¸ªå †ï¼ŒJVMå¯åŠ¨æ—¶ å †è¢«åˆ›å»º  å…¶ç©ºé—´å¤§å°å°±ç¡®å®šäº†   ï¼Œä½†å †å†…å­˜çš„å¤§å°æ˜¯å¯ä»¥è°ƒèŠ‚çš„</p><p>å †å¯ä»¥å¤„äºç‰©ç†ä¸Šä¸è¿ç»­çš„ç©ºé—´ï¼Œä½†é€»è¾‘ä¸Šä»–æ˜¯è¿ç»­çš„</p><p>æ‰€æœ‰çš„çº¿ç¨‹å…±äº«JAVAå †ï¼Œè¿˜å¯ä»¥åˆ’åˆ†çº¿ç¨‹ç§æœ‰çš„åå†²å»   TLAB  THREAD LOCAL ALLOCATION BUFFER</p><p><strong>æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹åŠæ•°ç»„éƒ½åº”åœ¨è¿è¡Œæ—¶åˆ†é…åˆ°å †ä¸Š</strong></p><ul><li>æ–¹æ³•ç»“æŸåï¼Œå †çš„å¯¹è±¡ä¸ä¼šé©¬ä¸Šè¢«ç§»é™¤ï¼Œä»…ä»…åœ¨åƒåœ¾æ”¶é›†æ—¶æ‰ä¼šè¢«ç§»é™¤ï¼ˆåˆ¤æ–­æ˜¯å¦æœ‰å¼•ç”¨ï¼‰</li><li>å †æ˜¯ GC æ‰§è¡Œåƒåœ¾å›æ”¶çš„é‡ç‚¹åŒºåŸŸ</li></ul><h4 id="å †ç©ºé—´ç»†åˆ†ï¼ˆé€»è¾‘ä¸Šï¼‰">å †ç©ºé—´ç»†åˆ†ï¼ˆé€»è¾‘ä¸Šï¼‰</h4><ul><li><p>Java 7 æ–°ç”ŸåŒº  å…»è€åŒº  æ°¸ä¹…åŒº</p></li><li><p>Java 8  åŒ…æ‹¬ä»¥å   æ–°ç”ŸåŒº  å…»è€åŒº  å…ƒç©ºé—´</p></li></ul><h4 id="è®¾ç½®å †ç©ºé—´å¤§å°">è®¾ç½®å †ç©ºé—´å¤§å°</h4><p>-Xms   å †åŒºï¼ˆæ–°ç”Ÿä»£+è€å¹´ä»£ï¼‰çš„èµ·å§‹å†…å­˜</p><p>-Xmx    å †åŒºæœ€å¤§å†…å­˜</p><p>-X JVMè¿è¡Œå‚æ•°    -ms memory start</p><p>JVM å‚æ•°åœ°å€</p><p><a href="https://docs.oracle.com/javase/8/docs/technotes/tools/unix/java.html">https://docs.oracle.com/javase/8/docs/technotes/tools/unix/java.html</a></p><p>åˆå§‹å¤§å°   ç”µè„‘å†…å­˜ / 64     é»˜è®¤å¤§å°  ç”µè„‘å†…å­˜ / 4</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">totalMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div><p><span style='color:red;font-size:18sp' >é—®é¢˜ï¼š è®¾ç½®Xmsä¸º10mÂ  ä¸ºä»€ä¹ˆå¾—åˆ°çš„å†…å­˜&lt;10</span></p><ul><li>Eden åŒº åªèƒ½å’ŒSurvivor 1 æˆ– 2åŒº è¿›è¡Œå­˜å‚¨  è€Œä¸æ˜¯ä¸¤ä¸ªSurvivoråŒºéƒ½å¯ä»¥å­˜å‚¨</li></ul><h4 id="å †ç©ºé—´çš„OOM">å †ç©ºé—´çš„OOM</h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210302163155472.png" alt="image-20210302163155472"></p><h4 id="å¹´è½»ä»£ä¸è€å¹´ä»£">å¹´è½»ä»£ä¸è€å¹´ä»£</h4><p>YoungGen</p><p>å æ¯”1 / 3</p><ul><li>Survivor 0 ï¼š fromåŒº</li><li>Survivor 1 ï¼štoåŒº</li></ul><p>OldGen</p><p>â€‹    å æ¯”2 / 3</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210302163141130.png" alt="image-20210302163141130"></p><p>é»˜è®¤æ¯”ä¾‹</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210302163437852.png" alt="image-20210302163437852"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210302163456336.png" alt="image-20210302163456336"></p><p><span style='color:red;font-size:18sp' >é—®é¢˜ï¼š Edenå’ŒSurvivoræ¯”ä¾‹æ˜¯ 8:1Â  ä½†å®é™…æ˜¯ 6:1ï¼Ÿ</span></p><ul><li>è‡ªé€‚åº”æœºåˆ¶   -XX:-UseAdaptiveSizePolicy å…³é—­è‡ªé€‚åº”çš„å†…å­˜åˆ†é…</li><li>å¯é€šè¿‡ -XX:SurvivorRatio è°ƒæ•´</li></ul><p><span style='color:orange;font-size:24px'  >å‡ ä¹æ‰€æœ‰çš„Javaå¯¹è±¡éƒ½æ˜¯EdenåŒº ä¸­newå‡ºæ¥çš„</span></p><h4 id="å¯¹è±¡åˆ†é…è¿‡ç¨‹">å¯¹è±¡åˆ†é…è¿‡ç¨‹</h4><p><span style='color:#00CD66;font-size:18px' >YoungGC     Minor GC</span></p><ol><li>newçš„å¯¹è±¡å…ˆåˆ°EdenåŒº</li><li>EdenåŒºè¢«å¡«æ»¡å  JVm GCå™¨å¯¹ EdenåŒºè¿›è¡Œåƒåœ¾å›æ”¶ MinorGC  é”€æ¯æ²¡æœ‰å¼•ç”¨çš„å¯¹è±¡</li><li>å°†Edençš„å‰©ä½™å¯¹è±¡ç§»åŠ¨åˆ°Survivor 0 åŒº å¹¶åŠ ä¸Šage 1</li><li>å†æ¬¡è§¦å‘GCæ—¶  ä¸Šæ¬¡æ”¾åˆ°Seurvivor 0 åŒºçš„å°±ä¼š è¿›å…¥ 1 åŒº age ++</li><li>é˜ˆå€¼ age &gt;15 æ—¶ åˆ° Old Gen åŒº  <span style='color:red;font-size:18sp' >ä¹Ÿæœ‰å¯èƒ½ç ´æ ¼æ™‹å‡</span></li></ol><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210303084331819.png" alt=""></p><p><strong>æ³¨æ„ç‚¹</strong></p><ul><li><p>EdenåŒºæ»¡ ä¼šå°† Eden å’ŒSurvivor åŒºä¸€èµ·è¿›è¡Œå›æ”¶</p></li><li><p>SurvivoråŒºæ»¡ä¸ä¼šè¿›è¡Œå›æ”¶ï¼Survivoræ”¾ä¸ä¸‹ï¼Œç›´æ¥æ™‹å‡è€å¹´ä»£</p></li><li><p>0åŒº å’Œ1åŒºå¤åˆ¶ä¹‹åæœ‰äº¤æ¢ï¼Œè°ç©ºè°æ˜¯toåŒº</p></li><li><p>åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤æ–­</p><p>å¦‚æœSurvivor ä¸­ç›¸åŒå¹´é¾„çš„æ‰€æœ‰å¯¹è±¡å¤§å°çš„æ€»åˆå¤§äº è¯¥åŒºç©ºé—´çš„ä¸€åŠï¼Œåˆ™å¹´é¾„å¤§äºæˆ–ç­‰äºè¯¥å¹´é¾„çš„å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£(ä¼˜åŒ–)</p></li><li><p>å¤§å¯¹è±¡ç›´æ¥æ”¾å…¥è€å¹´ä»£ (ä¼˜åŒ–)</p></li></ul><h4 id="Minor-GCã€Major-GC-ã€Full-GC">Minor GCã€Major GC ã€Full GC</h4><p>STW  ï¼š stop the world</p><ul><li><p>éƒ¨åˆ†æ”¶é›†  Partial GC:</p><ul><li><p>Minor GC :</p><ul><li>æ‰§è¡Œé¢‘ç‡é«˜ï¼Œé€Ÿåº¦å¿«è§¦å‘ STW æš‚åœç”¨æˆ·çº¿ç¨‹</li></ul></li><li><p>Major GC:</p><ul><li>æ‰§è¡Œé€Ÿåº¦æ¯”minor GCæ…¢10å€ä»¥ä¸Š  STWæ—¶é—´æ›´é•¿</li><li>è€å¹´ä»£ç©ºé—´ä¸è¶³ï¼Œå…ˆå°è¯•minor GCå¦‚æœè¿˜ä¸è¶³ï¼Œå°±è§¦å‘Major GC</li></ul></li><li><p>Mixed GC: æ”¶é›†æ•´ä¸ªæ–°ç”Ÿä»£å’Œéƒ¨åˆ†è€å¹´ä»£çš„åƒåœ¾</p></li></ul></li><li><p>æ•´å †æ”¶é›† Full GCï¼š æ”¶é›†æ•´ä¸ªjavaå †å’Œæ–¹æ³•åŒºçš„åƒåœ¾</p><ul><li>è°ƒä¼˜ä¸­å°½é‡é¿å…</li><li>è§¦å‘æ¡ä»¶ï¼š<ol><li>è€å¹´ä»£ç©ºé—´ä¸è¶³</li><li>æ–¹æ³•åŒºç©ºé—´ä¸è¶³</li><li>System.gc()ä½†ä¸ä¸€å®šæ‰§è¡Œ</li><li>MinorGCè¿›å…¥è€å¹´ä»£çš„å¹³å‡å¤§å°å¤§äºè€å¹´ä»£çš„å¯ç”¨å†…å­˜</li><li>SurvivoråŒºè½¬å­˜åˆ°è€å¹´ä»£æ—¶å¯ç”¨å†…å­˜å°äºè¯¥å¯¹è±¡å¤§å°</li></ol></li></ul></li></ul><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210303160142447.png" alt="image-20210303160142447"></p><p><span style='color:red;font-size:18px' >ä¸ºä»€ä¹ˆè¦åˆ†ä»£</span></p><ul><li>ä¼˜åŒ–GCæ€§èƒ½   ç¼©å°å¯¹å †çš„æ‰«æèŒƒå›´</li></ul><h4 id="TLAB">TLAB</h4><p>é—®é¢˜ï¼šå †åŒºæ˜¯çº¿ç¨‹å…±äº«åŒºåŸŸ    å¹¶å‘ç¯å¢ƒä¸‹ä»å †åŒºåˆ’åˆ†å†…å­˜ç©ºé—´æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„</p><p>å®šä¹‰ï¼š æ¯ä¸ªçº¿ç¨‹ä¸­ç‹¬æœ‰ä¸€ä»½TLAB  å³ç§æœ‰ç¼“å­˜åŒºåŸŸ</p><p>ç›®çš„ï¼š</p><ul><li>å¤šçº¿ç¨‹åˆ†é…å†…å­˜ï¼Œèƒ½é¿å…ä¸€ç³»åˆ—çš„éçº¿ç¨‹å®‰å…¨é—®é¢˜</li><li>æå‡å†…å­˜åˆ†é…çš„ååé‡ï¼ˆå¿«é€Ÿåˆ†é…ç­–ç•¥ï¼‰</li></ul><p>JVMå°†TLAVä½œä¸ºå†…å­˜åˆ†é…çš„é¦–é€‰</p><p>TLABç©ºé—´å°  ä»…ä»…å æ•´ä¸ªEdençš„1% ,  ä¹Ÿå¯ä»¥è®¾ç½®</p><p>ä¸€æ—¦å¯¹è±¡åœ¨TLABç©ºé—´åˆ†é…å†…å­˜å¤±è´¥ï¼ŒJVMå°è¯•ä½¿ç”¨åŠ é”æœºåˆ¶ç¡®ä¿æ•°æ®æ“ä½œçš„åŸå­æ€§ï¼Œè¿›è€Œåœ¨Edenç©ºé—´åˆ†é…å†…å­˜</p><h4 id="é€ƒé€¸åˆ†æ">é€ƒé€¸åˆ†æ</h4><p>å°†å †ä¸Šçš„å¯¹è±¡åˆ†é…åˆ°æ ˆ</p><ul><li>å¯¹è±¡åœ¨<strong>æ–¹æ³•å†…éƒ¨ä¸­å®šä¹‰</strong>å  åª åœ¨å†…éƒ¨ä½¿ç”¨ï¼Œ åˆ™æ²¡æœ‰é€ƒé€¸   ------&gt;ä½¿ç”¨æ ˆä¸Šåˆ†é…</li><li>å¯¹è±¡åœ¨<strong>æ–¹æ³•å†…éƒ¨å®šä¹‰</strong>å  è¢«å¤–éƒ¨æ–¹æ³•æ‰€å¼•ç”¨ ã€‚åˆ™å‘ç”Ÿäº†é€ƒé€¸</li></ul><p><span style='color:red;font-size:18px' >å¦‚ä½•åˆ¤æ–­æ˜¯å¦å‘ç”Ÿé€ƒé€¸</span></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210303161641422.png" alt="image-20210303161641422"></p><p>ä¼˜åŒ–  å‰æ æœªå‘ç”Ÿé€ƒé€¸</p><h5 id="æ ˆä¸Šåˆ†é…">æ ˆä¸Šåˆ†é…</h5><p>åŸç† ï¼Ÿï¼Ÿ</p><p>å®ä¾‹nä¸ªå¯¹è±¡æ—¶ï¼Œå¼€å¯æ ˆä¸Šåˆ†é…ï¼Œ é€Ÿåº¦å¤§å¹…æé«˜ï¼Œå®ä¾‹æ•°é™ä½ã€‚</p><h5 id="åŒæ­¥çœç•¥">åŒæ­¥çœç•¥</h5><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210303162647795.png" alt="image-20210303162647795"></p><p>å»é™¤äº†åŒæ­¥æ“ä½œ</p><h5 id="ä»£ç ä¼˜åŒ–">ä»£ç ä¼˜åŒ–</h5><p>åˆ†ç¦»å¯¹è±¡æˆ–è€…æ ‡é‡æ›¿æ¢   è‚¢è§£</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210303163208358.png" alt="image-20210303163208358"></p><h3 id="å…ƒç©ºé—´">å…ƒç©ºé—´</h3><p>æ°¸ä¹…ä»£ â€”&gt;æ–¹æ³•åŒº -----&gt;å…ƒç©ºé—´</p><p>å›ºå®šå¤§å°æˆ–è€…åŠ¨æ€å˜åŒ–   è‡ªåŠ¨æ”¶ç¼©   é€»è¾‘ä¸Šè¿ç»­ ç‰©ç†ä¸Šä¸è¿ç»­</p><p>é€»è¾‘ä¸Šå±äºå †çš„ä¸€éƒ¨åˆ†</p><p><span style='color:#018531;font-size:30px' >æ–¹æ³•åŒºç”¨äºå­˜å‚¨å·²è¢«è™šæ‹ŸæœºåŠ è½½çš„ç±»å‹ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å¸¸é‡ã€å³æ—¶ç¼–è¯‘å™¨ï¼ˆJITï¼‰ç¼–è¯‘åçš„ä»£ç ç¼“å­˜â€¦</span></p><p><span style='color:orange;font-size:18px' >æ–¹æ³•åŒºçœ‹åšæ˜¯ä¸€å—ç‹¬ç«‹äºJavaå †çš„å†…å­˜ç©ºé—´</span></p><p><span style='color:orange;font-size:18px' >æ–¹æ³•åŒºçš„å¤§å°å†³å®šäº†ç³»ç»Ÿå¯ä»¥ä¿å­˜å¤šå°‘ä¸ªç±»ï¼Œå¦‚æœç³»ç»Ÿå®šä¹‰äº†å¤ªå¤šçš„ç±»ï¼Œæ–¹æ³•åŒºä¼šæº¢å‡º æŠ›å‡ºOOM</span></p><p><span style='color:#4169E1;font-size:18px' >å…ƒç©ºé—´å’Œæ°¸ä¹…ä»£æœ€å¤§çš„åŒºåˆ«</span></p><p>å…ƒç©ºé—´ä¸åœ¨è™šæ‹Ÿæœºçš„å†…å­˜ä¸­ï¼Œè€Œæ˜¯åœ¨æœ¬åœ°å†…å­˜ ï¼Œå†…éƒ¨ç»“æ„ä¹Ÿå‘ç”Ÿæ”¹å˜</p><h4 id="æ–¹æ³•åŒº-å †-æ ˆçš„äº¤äº’å…³ç³»">æ–¹æ³•åŒº å †  æ ˆçš„äº¤äº’å…³ç³»</h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210303164007274.png" alt="image-20210303164007274"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210303164100411.png" alt="image-20210303164100411"></p><h4 id="è®¾ç½®å…ƒç©ºé—´å¤§å°">è®¾ç½®å…ƒç©ºé—´å¤§å°</h4><p>-XX: MataSpaceSize=     è®¾ç½®åˆå§‹åˆ†é…ç©ºé—´ é»˜è®¤20.75M</p><p>-XXï¼šMaxMataSpaceSize  è®¾å®šæœ€å¤§å¯åˆ†é…æ§ä»¶   32ä½é»˜è®¤64M  64ä½é»˜è®¤82M    è®¾ç½®ä¸º-1åˆ™æ²¡æœ‰é™åˆ¶</p><p>JDK1.7ä»¥å‰    -PermSize</p><p>å¸¸ç”¨æŒ‡ä»¤  jps  jinfo -flag   xxxxx aaaa</p><p>è§¦åŠ21M  FULL GC é‡Šæ”¾æ²¡ç”¨çš„ç±»ï¼Œæ°´ä½çº¿é‡ç½®ï¼Œå¦‚æœé‡Šæ”¾ç©ºé—´è¿‡å¤šï¼Œåˆ™é™ä½è¯¥å€¼</p><p><span style='color:orange;font-size:18px' >å†…å­˜æ³„éœ²å’Œå†…å­˜æº¢å‡º</span></p><p>å†…å­˜æ³„éœ²   ç—…äººåº·å¤ ä½†æ˜¯å ç€åºŠä½</p><p>å†…å­˜æº¢å‡º  ç—…äººå¤ªå¤šï¼ŒåºŠä½ä¸å¤Ÿ</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210303171142462.png" alt="image-20210303171142462"></p><h4 id="å†…éƒ¨ç»“æ„">å†…éƒ¨ç»“æ„</h4><h5 id="ç±»å‹ä¿¡æ¯">ç±»å‹ä¿¡æ¯</h5><p>å®Œæ•´æœ‰æ•ˆåç§°    ç›´æ¥çˆ¶ç±»çš„å®Œæ•´æœ‰æ•ˆåç§°    ä¿®é¥°ç¬¦     ç›´æ¥æ¥å£çš„æœ‰åºåˆ—è¡¨</p><h5 id="æ–¹æ³•ä¿¡æ¯">æ–¹æ³•ä¿¡æ¯</h5><h5 id="åŸŸä¿¡æ¯">åŸŸä¿¡æ¯</h5><p>åŸŸåç§°ã€åŸŸç±»å‹ã€åŸŸä¿®é¥°ç¬¦</p><p><strong>æ³¨æ„ï¼šå¦‚æœæ˜¯privateç±»å‹çš„è¯ï¼Œæ˜¯çœ‹ä¸åˆ°åŸŸä¿¡æ¯çš„</strong></p><h5 id="non-finalç±»å˜é‡">non-finalç±»å˜é‡</h5><p>é™æ€å˜é‡ åœ¨å®ä¾‹å¯¹è±¡ä¸ºnullçš„æƒ…å†µä¸‹ä¾ç„¶å¯ä»¥è®¿é—®å¯¹è±¡ä¸­çš„é™æ€æ–¹æ³•æˆ–è€…å­—æ®µ</p><h5 id="å…¨å±€å¸¸é‡">å…¨å±€å¸¸é‡</h5><p>ç¼–è¯‘æ—¶åˆ†é…   (å‡†å¤‡é˜¶æ®µ)</p><p><span style='color:orange;font-size:18px' >ä¸é™æ€å˜é‡æ¯”è¾ƒ</span></p><p>é™æ€å˜é‡åœ¨å‡†å¤‡é˜¶æ®µåˆå§‹åŒ–  åœ¨initialé˜¶æ®µèµ‹å€¼   ä¹Ÿå°±æ˜¯åœ¨é™æ€è¯­å¥ä¸­ clinitç±»æ„é€ å™¨æ–¹æ³•ä¸­èµ‹å€¼ã€‚è€Œå…¨å±€å˜é‡åˆ™ä¸ä¼šå†è¿™ä¸ªé˜¶æ®µèµ‹å€¼</p><h4 id="è¿è¡Œæ—¶å¸¸é‡æ± ">è¿è¡Œæ—¶å¸¸é‡æ± </h4><h5 id="å­—èŠ‚ç çš„å¸¸é‡æ± ">å­—èŠ‚ç çš„å¸¸é‡æ± </h5><p>å­˜å‚¨å„ç§å­—é¢é‡å’Œå¯¹ç±»å‹ã€æ–¹æ³•å’ŒåŸŸçš„ç¬¦å·å¼•ç”¨</p><p>ç±»å¼•ç”¨ã€å­—æ®µå¼•ç”¨ã€æ–¹æ³•å¼•ç”¨ã€æ•°é‡å€¼ã€å­—ç¬¦ä¸²å€¼</p><p>å°†åœ¨ç±»åŠ è½½åå­˜æ”¾åˆ°æ–¹æ³•åŒºçš„è¿è¡Œæ—¶å¸¸é‡æ± ä¸­ï¼Œè¿™æ—¶ç¬¦å·åœ°å€å°±è½¬æ¢ä¸ºäº†çœŸå®åœ°å€</p><h5 id="åŠ¨æ€æ€§">åŠ¨æ€æ€§</h5><p>ä¸å¸¸é‡æ± çš„å·®åˆ«</p><h5 id="JDK1-6â€“1-7â€“1-8çš„è°ƒæ•´">JDK1.6â€“1.7â€“1.8çš„è°ƒæ•´</h5><p><span style='color:red;font-size:24px' >ä¸ºä»€ä¹ˆè¦ç”¨å…ƒç©ºé—´æ›¿ä»£æ°¸ä¹…ä»£ï¼Ÿ</span></p><ol><li>ä¸ºæ°¸ä¹…ä»£è®¾ç½®ç©ºé—´å¤§å°æ˜¯å¾ˆéš¾ç¡®å®šçš„</li><li>å¯¹æ°¸ä¹…ä»£çš„è°ƒä¼˜å¾ˆå›°éš¾</li></ol><p>é™æ€å˜é‡çš„ä½ç½®</p><p>1.6â€“1.7 å¯¹è±¡çš„å¼•ç”¨åæ”¾åœ¨Old Genä¸­  1.8 åœ¨å †ä¸­  ï¼Ÿ</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210304150244295.png" alt="image-20210304150244295"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210304150705423.png" alt="image-20210304150705423"></p><p>åªè¦æ˜¯å®ä¾‹å¯¹è±¡ å¿…ç„¶ä¼šåœ¨Javaå †ä¸­åˆ†é…</p><h5 id="åƒåœ¾å›æ”¶">åƒåœ¾å›æ”¶</h5><p>å›æ”¶å†…å®¹ï¼š</p><p>å¸¸é‡æ± ä¸­åºŸå¼ƒçš„å¸¸é‡å’Œä¸å†ä½¿ç”¨çš„ç±»å‹</p><p>è‹›åˆ»æ¡ä»¶ï¼š åˆ¤æ–­ä¸€ä¸ªç±»å·²ç»è¢«åºŸå¼ƒ</p><p><strong>æ€»ç»“</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210304145524447.png" alt="image-20210304145524447"></p><h2 id="å¯¹è±¡çš„å®ä¾‹åŒ–-é¢è¯•">å¯¹è±¡çš„å®ä¾‹åŒ–(é¢è¯•)</h2><h3 id="å¯¹è±¡çš„å®ä¾‹åŒ–">å¯¹è±¡çš„å®ä¾‹åŒ–</h3><ol><li>new</li><li>class.newInstance / constructor.new Instance  åå°„çš„æ–¹å¼<ul><li>åªèƒ½è°ƒç”¨ç©ºå‚çš„æ„é€ å™¨ï¼Œæƒé™å¿…é¡»æ˜¯public</li><li>constructorçš„newInstance è°ƒç”¨ç©ºå‚æˆ–è€…å¸¦å‚æ•°çš„æ„é€ å™¨ï¼Œæƒé™æ²¡æœ‰è¦æ±‚</li></ul></li><li>clone()<ul><li>éœ€è¦å®ç°Cloneableæ¥å£</li></ul></li><li>ååºåˆ—åŒ–<ul><li>ç½‘ç»œä¸­è·å–å¯¹è±¡çš„äºŒè¿›åˆ¶æµ</li></ul></li><li>ç¬¬ä¸‰æ–¹åº“Objenesis</li></ol><h3 id="å¯¹è±¡åˆ›å»ºæ­¥éª¤">å¯¹è±¡åˆ›å»ºæ­¥éª¤</h3><p>å­—èŠ‚ç ä¸­</p><p>new #x</p><p>åˆ†é…å†…å­˜ã€åˆå§‹åŒ–å€¼</p><p>dup ï¼šDuplicate the top value on the operand stack and push the duplicated value onto the operand stack.  å¤åˆ¶æ“ä½œæ•°å †æ ˆä¸Šçš„é¡¶å€¼ï¼Œå¹¶å°†å¤åˆ¶çš„å€¼æ¨é€åˆ°æ“ä½œæ•°å †æ ˆä¸Šã€‚</p><p>invokespecial #a</p><p>è°ƒç”¨initæ„é€ å™¨</p><p><span style='color: #DAA520;font-size:24px'>æµç¨‹</span></p><ol><li>åˆ¤æ–­å¯¹è±¡å¯¹åº”çš„ç±»æ˜¯å¦åŠ è½½ã€è¿æ¥ã€åˆå§‹åŒ–ï¼Œï¼ˆæ˜¯å¦æœ‰ç¬¦å·å¼•ç”¨ï¼‰</li></ol><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307084406633.png" alt="image-20210307084406633"></p><ol start="2"><li>ä¸ºå¯¹è±¡åˆ†é…å†…å­˜</li></ol><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307084458998.png" alt="image-20210307084458998"></p><ul><li><p>å¦‚æœå†…å­˜è§„æ•´  ------&gt; æŒ‡é’ˆç¢°æ’</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307084643494.png" alt="image-20210307084643494"></p></li><li><p>å†…å­˜ä¸è§„æ•´  -----&gt;è™šæ‹Ÿæœºéœ€è¦ç»´æŠ¤ä¸€ä¸ªåˆ—è¡¨    ç©ºé—²åˆ—è¡¨åˆ†é…</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307084721903.png" alt="image-20210307084721903"></p></li></ul><ol start="3"><li><p>å¤„ç†å¹¶å‘é—®é¢˜</p><p>CAS å¤±è´¥é‡è¯•  åŒºåŸŸåŠ é”ä¿è¯æ›´æ–°çš„åŸå­æ€§</p><p>æ¯ä¸ªçº¿ç¨‹é¢„å…ˆåˆ†é…ä¸€ä¸ªTLAB</p></li><li><p>åˆå§‹åŒ–åˆ†é…ç©ºé—´</p><p>æ‰€æœ‰å±æ€§å€¼é»˜è®¤å€¼ï¼Œä¿è¯å¯¹è±¡å®ä¾‹å­—æ®µåœ¨ä¸èµ‹å€¼æ—¶å¯ä»¥ç›´æ¥ä½¿ç”¨</p></li><li><p>è®¾ç½®å¯¹è±¡çš„å¯¹è±¡å¤´</p></li><li><p>initæ–¹æ³•è¿›è¡Œåˆå§‹åŒ–  ----&gt;èµ‹å€¼</p></li></ol><h3 id="å¯¹è±¡çš„å†…å­˜å¸ƒå±€">å¯¹è±¡çš„å†…å­˜å¸ƒå±€</h3><p>å¤§å‚é¢è¯•</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307090815341.png" alt="image-20210307090815341"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307090828271.png" alt="image-20210307090828271"></p><h4 id="å¯¹è±¡å¤´">å¯¹è±¡å¤´</h4><ol><li>è¿è¡Œæ—¶æºæ•°æ® Mark Work<ol><li>å“ˆå¸Œå€¼</li><li>GCåˆ†ä»£å¹´é¾„</li><li>é”çŠ¶æ€æ ‡å¿—</li><li>çº¿ç¨‹æŒæœ‰çš„é”</li><li>åå‘çº¿ç¨‹ID</li><li>åå‘æ—¶é—´æˆ³</li></ol></li><li>ç±»å‹æŒ‡é’ˆ  æŒ‡å‘ç±»å…ƒæ•°æ®ï¼Œç¡®å®šè¯¥å¯¹è±¡çš„æ‰€å±å±æ€§</li></ol><h4 id="å®ä¾‹æ•°æ®">å®ä¾‹æ•°æ®</h4><h4 id="Instance-Data">Instance Data</h4><p>å¯¹è±¡çœŸæ­£å­˜å‚¨çš„æœ‰æ•ˆä¿¡æ¯ï¼ŒåŒ…æ‹¬ç¨‹åºä»£ç å®šä¹‰çš„å„ç§ç±»å‹çš„å­—æ®µ</p><p>è§„åˆ™ï¼š å…¥å°‘å¹´å®«å›¾</p><h4 id="å¯¹é½å¡«å……">å¯¹é½å¡«å……</h4><p>å ä½ç¬¦ä½œç”¨</p><p>64ä½ JVM   å®é™…å¯¹è±¡å¿…é¡»æ˜¯8çš„æ•´æ•°ä½   åªæœ‰1byteå±æ€§ä¹Ÿè¦ç»™ä½ æ•´åˆ° 16 bytes</p><p>ä¸€ä¸ªç©ºçš„å¯¹è±¡</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210405171441583.png" alt="image-20210405171441583"></p><p>ä¸¤ä¸ªStringå±æ€§çš„å¯¹è±¡</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210405171535161.png" alt="image-20210405171535161"></p><p>ç½‘ä¸Šè¯´çš„  32bit  4 byte</p><p>æ•…  å¯¹è±¡å¤´å­—èŠ‚å›ºå®š ä¸º 12 å­—èŠ‚</p><p><strong>å¯¹è±¡å¤´ç”±ä»€ä¹ˆç»„æˆ</strong>ï¼Ÿ</p><ol><li><p>MarkWord   64 bit</p><p>å­˜å‚¨å¯¹è±¡çš„hashCodeã€é”ä¿¡æ¯æˆ–åˆ†ä»£å¹´é¾„æˆ–GCæ ‡å¿—ç­‰ä¿¡æ¯</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210405190427725.png" alt="image-20210405190427725"></p></li><li><p>Class Meta Address  32/64  bit(å¼€å¯æŒ‡é’ˆå‹ç¼©</p><p>ç±»å‹æŒ‡é’ˆæŒ‡å‘å¯¹è±¡çš„ç±»å…ƒæ•°æ®ï¼ŒJVMé€šè¿‡è¿™ä¸ªæŒ‡é’ˆç¡®å®šè¯¥å¯¹è±¡æ˜¯å“ªä¸ªç±»çš„å®ä¾‹</p></li></ol><p>å°ç«¯å­˜å‚¨ / å¤§ç«¯å­˜å‚¨</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210405184732813.png" alt="image-20210405184732813"></p><p><strong>å¯¹è±¡çŠ¶æ€</strong>ï¼š</p><ol><li>æ— çŠ¶æ€  newæ—¶</li><li>åå‘é”</li><li>è½»é‡</li><li>é‡é‡é”</li><li>gcæ ‡è®°ï¼ˆæ— å¼•ç”¨ï¼‰</li></ol><h4 id="æ€»ç»“å›¾ç¤º">æ€»ç»“å›¾ç¤º</h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307091320160.png" alt="image-20210307091320160"></p><h3 id="å¯¹è±¡è®¿é—®å®šä½">å¯¹è±¡è®¿é—®å®šä½</h3><p>JVMé€šè¿‡æ ˆå¸§ä¸­çš„å¯¹è±¡å¼•ç”¨è®¿é—®åˆ°å†…éƒ¨çš„å¯¹è±¡å®ä¾‹</p><h4 id="è®¿é—®æ–¹å¼">è®¿é—®æ–¹å¼</h4><ol><li><p>å¥æŸ„è®¿é—®</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307091748884.png" alt="image-20210307091748884"></p><ul><li>ç©ºé—´æµªè´¹</li><li>ç¨³å®š  å‘ç”Ÿç§»åŠ¨æ—¶å¤–éƒ¨æŒ‡å‘ä¸éœ€è¦ä¿®æ”¹</li></ul></li><li><p>ç›´æ¥æŒ‡é’ˆ HotSpotä½¿ç”¨</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307091828272.png" alt="image-20210307091828272"></p><ul><li>å‘ç”Ÿç§»åŠ¨æ—¶ å¤–éƒ¨referenceéœ€è¦ä¿®æ”¹æŒ‡å‘çš„åœ°å€</li></ul></li></ol><h2 id="ç›´æ¥å†…å­˜">ç›´æ¥å†…å­˜</h2><p>åŸºäºå…ƒç©ºé—´</p><p>Javaå †å¤–ï¼Œå‘ç³»ç»Ÿç”³è¯·çš„å†…å­˜ç©ºé—´</p><p>æ¥æºäºNIOï¼Œä¸–ç•Œä½¿ç”¨DirectByteBuffer</p><p>NIO ï¼šNon-Blocking IO  å…å»ä¸­é—´å•†</p><p>è®¿é—®ç›´æ¥å†…å­˜çš„é€Ÿåº¦ï¼Œä¼˜äºJavaå †</p><p>ç¼ºç‚¹ï¼š</p><ul><li>åˆ†é…å›æ”¶æˆæœ¬é«˜</li><li>ä¸å—JVMå†…å­˜å›æ”¶ç®¡ç†</li></ul><p>OOM  è®¾ç½®ï¼š MaxDirectMemorySize</p><p>ä¸çŸ¥é“ï¼Œåˆ™ä¸å †çš„æœ€å¤§å€¼ -Xmxå‚æ•°å€¼ä¸€è‡´</p><h2 id="æ‰§è¡Œå¼•æ“">æ‰§è¡Œå¼•æ“</h2><h3 id="æ¦‚è¿°-v2">æ¦‚è¿°</h3><p>ç‰©ç†æœºçš„æ‰§è¡Œå¼•æ“ï¼š</p><p>ç›´æ¥å»ºç«‹åœ¨å¤„ç†å™¨ã€ç¼“å­˜ã€æŒ‡ä»¤é›†å’Œæ“ä½œç³»ç»Ÿå±‚é¢ä¸Š</p><p>JVMçš„æ‰§è¡Œå¼•æ“ï¼š</p><p>è™šæ‹Ÿæœºçš„æ‰§è¡Œå¼•æ“ï¼Œç”±è½¯ä»¶è‡ªè¡Œå®ç°ï¼Œä¸å—ç‰©ç†æ¡ä»¶åˆ¶çº¦å®šå€¼æŒ‡ä»¤é›†å’Œæ‰§è¡Œå¼•æ“çš„ç»“æ„ä½“ç³»ï¼Œèƒ½æ‰§è¡Œä¸å—ç¡¬ä»¶ç›´æ¥æ”¯æŒçš„æŒ‡ä»¤é›†æ ¼å¼</p><p><span style='color:orange;font-size:24px'>JVMä¸»è¦ä»»åŠ¡</span></p><p>å­—èŠ‚ç æ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­å¹¶<strong>è§£é‡Šæ‰§è¡Œ</strong>ï¼Œ è§£é‡Š/ç¼–è¯‘ä¸ºå¯¹åº”å¹³å°ä¸Šçš„æœ¬åœ°æœºå™¨æŒ‡ä»¤</p><ul><li>æ‰§è¡Œå¼•æ“çš„æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤å®Œå…¨ä¾èµ–äºPCå¯„å­˜å™¨</li></ul><h3 id="Javaä»£ç ç¼–è¯‘ã€æ‰§è¡Œçš„è¿‡ç¨‹">Javaä»£ç ç¼–è¯‘ã€æ‰§è¡Œçš„è¿‡ç¨‹</h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307094756146.png" alt="image-20210307094756146"></p><p><span style='color:orange;font-size:24px'>æ©™è‰²ä¸javaè™šæ‹Ÿæœºæ— å…³</span></p><p><span style='color:#FA8072;font-size:24px'>è§£é‡Šå™¨ Interpreter</span></p><p>æ ¹æ®é¢„å®šä¹‰çš„è§„èŒƒå¯¹å­—èŠ‚ç é‡‡ç”¨é€è¡Œè§£é‡Šçš„æ–¹å¼æ‰§è¡Œ</p><p><span style='color:#FA8072;font-size:24px'>ç¼–è¯‘å™¨ Just In Time Compilerç¼–è¯‘å™¨</span></p><p>JVMå°†åŸç ç¼–è¯‘æˆå’Œæœ¬åœ°æœºå™¨å¹³å°ç›¸å…³çš„æœºå™¨æŒ‡ä»¤</p><p><span style='color:red;font-size:24px'>ä¸ºä»€ä¹ˆJavaæ˜¯åŠç¼–è¯‘åŠè§£é‡Šè¯­è¨€</span></p><p><span style='color: #00BFFF;font-size:18px'>JVMæ‰§è¡Œä»£ç æ—¶å°†è§£é‡Šæ‰§è¡Œå’Œç¼–è¯‘æ‰§è¡Œä¸¤è€…ç»“åˆèµ·æ¥è¿›è¡Œ</span></p><p><span style='color:#3CB371;font-size:24px'>å­—èŠ‚ç æ˜¯ä¸€ç§ä¸­é—´çŠ¶æ€çš„äºŒè¿›åˆ¶ä»£ç ï¼Œæ¯”æœºå™¨ç æŠ½è±¡ï¼Œéœ€è¦ç›´è¯‘å™¨è½¬è¯‘åæ‰èƒ½æˆä¸ºæœºå™¨ç </span></p><p>ä¸ºäº†å®ç°ç‰¹å®šè½¯ä»¶è¿è¡Œå’Œè½¯ä»¶ç¯å¢ƒï¼Œå’Œç¡¬ä»¶ç¯å¢ƒæ— å…³</p><p>ç¼–è¯‘å™¨å°†æºç ç¼–è¯‘æˆå­—èŠ‚ç ï¼Œ è™šæ‹Ÿæœºå™¨å°†å­—èŠ‚ç è½¬è¯‘å¯ä»¥ç›´æ¥æ‰§è¡Œçš„æŒ‡ä»¤</p><h3 id="è§£é‡Šå™¨çš„ä½¿ç”¨">è§£é‡Šå™¨çš„ä½¿ç”¨</h3><p>ä¸ºä»€ä¹ˆè¦åŠ å…¥å­—èŠ‚ç ï¼Ÿ</p><p>ä¸ºä»€ä¹ˆä¸ç›´æ¥ææˆJVMï¼Ÿ   åˆ†å‰²å·¥ä½œ</p><p>è§£é‡Šå™¨å‘å±•å†å²ï¼š</p><p>å­—èŠ‚ç è§£é‡Šå™¨  æ•ˆç‡ä½ä¸‹ï¼Œé€è¡Œç¿»è¯‘</p><p>æ¨¡æ¿è§£é‡Šå™¨  æ¯æ¡å­—èŠ‚ç å’Œæ¨¡æ¿å‡½æ•°ç›¸å…³ï¼Œæ¨¡æ¿å‡½æ•°ç›´æ¥äº§ç”Ÿè¿™æ¡å­—èŠ‚ç æ‰§è¡Œçš„æœºå™¨ç   æé«˜æ€§èƒ½</p><p>åŸºäºè§£é‡Šå™¨æ‰§è¡Œï¼š ä½æ•ˆ</p><h3 id="å³æ—¶ç¼–è¯‘-JITç¼–è¯‘å™¨">å³æ—¶ç¼–è¯‘  JITç¼–è¯‘å™¨</h3><p>é¿å…æ•°è¢«è§£é‡Šæ‰§è¡Œï¼Œå°†æ•´ä¸ªå‡½æ•°ä½“ç¼–è¯‘æˆæœºå™¨ç     é€Ÿåº¦å¿«</p><p><span style='color:#FA8072;font-size:24px'>HotSpoté‡‡ç”¨çš„æ˜¯è§£é‡Šå™¨ä¸å³æ—¶ç¼–è¯‘å™¨å¹¶å­˜çš„æ¶æ„ï¼Œäº’ç›¸åä½œå–é•¿è¡¥çŸ­ï¼Œé€‰æ‹©æœ€åˆé€‚çš„æ–¹å¼å»æƒè¡¡ç¼–è¯‘æœ¬åœ°ä»£ç </span></p><p>JVMå¯åŠ¨æ—¶ï¼Œè§£é‡Šå™¨é¦–å…ˆå‘æŒ¥ä½œç”¨ï¼Œéšç€ç¨‹åºæ—¶é—´æ¨ç§»ï¼ŒJITç¼–è¯‘å™¨é€æ¸å‘æŒ¥ä½œç”¨ï¼Œçƒ­ç‚¹æ¢æµ‹ï¼Œå°†æœ‰ä»·å€¼çš„å­—èŠ‚ç ç¼–è¯‘ä¸ºæœ¬åœ°æœºå™¨æŒ‡ä»¤ï¼Œä»¥æ¢å–æ›´é«˜çš„æ‰§è¡Œæ•ˆç‡</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307215507412.png" alt="image-20210307215507412"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307220023296.png" alt="image-20210307220023296"></p><h4 id="çƒ­ç‚¹ä»£ç å’Œæ¢æµ‹æ–¹å¼">çƒ­ç‚¹ä»£ç å’Œæ¢æµ‹æ–¹å¼</h4><p>ä½•æ—¶ä½¿ç”¨JIT ç¼–è¯‘å™¨ï¼Ÿ</p><p>é’ˆå¯¹è¿è¡Œæ—¶é¢‘ç¹è°ƒç”¨çš„çƒ­ç‚¹ä»£ç è¿›è¡Œæ·±åº¦ä¼˜åŒ–ï¼Œç›´æ¥ç¼–è¯‘ä¸ºå¯¹åº”å¹³å°çš„æœ¬åœ°æœºå™¨æŒ‡ä»¤   -----æ ˆä¸Šæ›¿æ¢ OSR</p><p>çƒ­ç‚¹æ¢æµ‹åŠŸèƒ½</p><p>åŸºäºè®¡æ•°å™¨</p><p>JVMä¸ºæ¯ä¸ªæ–¹æ³•å»ºç«‹2ä¸ªä¸åŒçš„è®¡æ•°å™¨</p><ul><li><p>æ–¹æ³•è°ƒç”¨è®¡æ•°å™¨</p><p>ç»Ÿè®¡æ–¹æ³•çš„è°ƒç”¨æ¬¡æ•°</p><p>é˜ˆå€¼ 1500 / 10000 æ¬¡</p><p>-XX: CompileThreshold</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307220456220.png" alt=""></p><p><span style='color: #DA70D6;font-size:24px'>çƒ­åº¦è¡°å‡</span></p><p>æ–¹æ³•è°ƒç”¨è®¡æ•°å™¨ç»Ÿè®¡çš„éƒ¨ç½²ç»å¯¹æ¬¡æ•°ï¼Œè€Œæ˜¯ç›¸å¯¹çš„æ‰§è¡Œæ•ˆç‡ï¼Œè¶…è¿‡ä¸€å®šæ—¶é—´çº¿åº¦ï¼Œå¦‚æœè°ƒç”¨æ¬¡æ•°ä»ç„¶ä¸è¶³åˆ™ä¼šå‡å°‘ä¸€åŠ   ï¼ŒåŠè¡°å‘¨æœŸ</p><p>-XX: UseCounterDecay  å…³é—­çƒ­åº¦è¡°å‡</p><p>-XXï¼š CounterHalfLifeTime è®¾ç½®åŠè¡°æœŸæ—¶é—´   s</p></li><li><p>å›è¾¹è®¡æ•°å™¨   ç»Ÿè®¡å¾ªç¯ä½“æ‰§è¡Œçš„å¾ªç¯æ¬¡æ•°</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307220949310.png" alt="image-20210307220949310"></p></li></ul><p>ä¿®æ”¹HotSpotçš„ç¼–è¯‘æ¨¡å¼,ä¼šå‘ç”Ÿå®è´¨çš„æ—¶é—´å˜åŒ–</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">long</span> s <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">long</span> e <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"=========="</span> <span class="token operator">+</span> <span class="token punctuation">(</span>e<span class="token operator">-</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p>-Xcomp    å³æ—¶ç¼–è¯‘ 3759</p><p>-Xint     è§£é‡Šç¼–è¯‘  9802</p><p>-Xmixed    3847</p><p>å¯ä»¥çœ‹å‡ºï¼Œä½¿ç”¨æ··åˆç¼–è¯‘ å’Œ å³æ—¶ç¼–è¯‘æ¨¡å¼ä¸‹ï¼Œç›¸å·®ä¸å¤§ï¼Œä½†è§£é‡Šç¼–è¯‘æ—¶å¾ˆæ…¢ä¸”ç›¸å·®å¾ˆå¤§</p><p>HotSpotæœ‰ ä¸¤ä¸ªJit ç¼–è¯‘å™¨  C1 å’Œ  C2</p><ul><li><p>64ä½ç‰ˆæœ¬  JVM é»˜è®¤ æ˜¯-serveræ¨¡å¼  ä½¿ç”¨C2  è€—æ—¶è¾ƒé•¿çš„ä¼˜åŒ–ï¼Œæ¿€è¿›ä¼˜åŒ–ï¼Œä¼˜åŒ–çš„ä»£ç æ‰§è¡Œæ•ˆç‡æ›´é«˜</p></li><li><p>-client æ¨¡å¼ï¼ŒC1ç¼–è¯‘å™¨ï¼Œ  å¯¹å­—èŠ‚ç è¿›è¡Œç®€å•å’Œå¯é çš„ä¼˜åŒ–ï¼Œè€—æ—¶çŸ­ï¼Œ æ›´å¿«çš„ç¼–è¯‘é€Ÿåº¦</p></li></ul><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307222415561.png" alt="image-20210307222415561"></p><p>åˆ†å±‚ç¼–è¯‘ç­–ç•¥</p><h3 id="Graalç¼–è¯‘å™¨å’ŒAOTç¼–è¯‘å™¨">Graalç¼–è¯‘å™¨å’ŒAOTç¼–è¯‘å™¨</h3><p>AOT Ahead Of Time Compiler  ç¨‹åºè¿è¡Œä¹‹å‰ï¼Œå°†å­—èŠ‚ç è½¬æ¢ä¸ºæœºå™¨å—  ä¸JIT ç¼–è¯‘å™¨å¯¹æ¯”</p><h2 id="StringTable">StringTable</h2><h3 id="åŸºæœ¬ç‰¹æ€§">åŸºæœ¬ç‰¹æ€§</h3><p>ä¸å¯å˜æ€§  å®ç°Serializebaleæ¥å£ ä¹‹å¤„åºåˆ—åŒ–   å®ç°Comparableæ¥å£ å¯æ¯”è¾ƒå¤§å°</p><p>JDK 8 åç”¨çš„æ˜¯char[]æ•°ç»„å­˜å‚¨ï¼Œ JDK9ä¹‹åä½¿ç”¨byte[] + ç¼–ç æ ‡è¯†å­˜å‚¨</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210308080434960.png" alt="image-20210308080434960"></p><ul><li>åœ¨æ–¹æ³•å†…éƒ¨é€šè¿‡å½¢å‚ä¼ é€’Stringå¯¹è±¡ï¼Œ å†…éƒ¨æ”¹å˜ï¼Œå¤–éƒ¨ä¸ä¼šæ”¹å˜</li><li>åº•å±‚æ˜¯å›ºå®šå¤§å°çš„HashTable  é»˜è®¤é•¿åº¦æ˜¯1009ï¼ŒString å¤šæ—¶ï¼ŒHashå†²çªï¼Œé“¾è¡¨å¾ˆé•¿ï¼Œå½±å“String.intern</li><li>-XX:tringTableSize è°ƒæ•´é•¿åº¦</li><li>jdk 7 ä¸­é»˜è®¤é•¿åº¦æ˜¯ 60013</li><li>jdk8 é•¿åº¦è¦æ±‚æœ€å°å€¼æ˜¯1009</li><li>æé«˜mapé•¿åº¦ï¼Œèƒ½å¤Ÿåœ¨ä¸€å®šç¨‹åº¦æé«˜Stringå­˜å‚¨çš„æ•ˆç‡</li></ul><h3 id="Stringçš„å†…å­˜åˆ†é…">Stringçš„å†…å­˜åˆ†é…</h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210308082215487.png" alt="image-20210308082215487"></p><p><span style='color:red;font-size:24px'>ä¸ºä»€ä¹ˆStringtableè¦è°ƒæ•´</span></p><p>permsizeé»˜è®¤æ¯”è¾ƒå°</p><p>æ°¸ä¹…ä»£åƒåœ¾å›æ”¶é¢‘ç‡ä½</p><p><strong>ç¼–è¯‘æœŸä¼˜åŒ–</strong></p><p><span style='color:orange;font-size:24px'>å¦‚æœæ‹¼æ¥çš„ç¬¦å·å‰åå‡ºç°äº†å˜é‡(ä¸æ˜¯å¸¸é‡)ï¼Œåˆ™ç›¸å½“äºåœ¨å¯¹ç©ºé—´ä¸­new String åœ°å€å°±ä¸ä¸€æ ·äº†</span></p><p>String s2= s1+â€œ123â€ != String s3 = s1 +s4;</p><p>String s3 = s1 +s2  å­—èŠ‚ç åŸç†</p><p>new StringBuilder   è°ƒç”¨çš„æ˜¯appendæ–¹æ³• append(s1)â€”&gt; append(s2) â€”&gt;StringBuilder. toStrihgæ–¹æ³•</p><p>ä¾‹å¦‚ï¼š</p><p>åœ¨å¾ªç¯ä½“ä¸­ ä½¿ç”¨ string s = s +â€œ123â€ æ˜¯å¾ˆè€—æ—¶çš„ï¼Œå› ä¸ºæ¯æ¬¡æ‹¼æ¥éƒ½new ä¸€ä¸ªStringBuilder ä»¥åŠString    è°ƒç”¨appendæ–¹æ³•ï¼Œååˆ†è€—æ—¶ï¼</p><p>StringBuilder æ‰©å®¹ä¼˜åŒ–  ç›´æ¥æŒ‡å®šé•¿åº¦  ä¸ªäººæµ‹è¯•åå‘ç°è¿™é‡Œå¹¶ä¸æ˜æ˜¾ï¼Ÿï¼Ÿ</p><h3 id="intern">intern()</h3><p>ç¡®ä¿å­—ç¬¦ä¸²åœ¨å†…å­˜ä¸­åªæœ‰ä¸€ä»½</p><p><span style='color:red;font-size:24px'>é¢è¯•é¢˜</span></p><ol><li><p>new String(â€œabâ€) ä¼šæ„å»ºå‡ ä¸ªå¯¹è±¡ï¼Ÿ</p><p>ä¸¤ä¸ª</p><p>ä¸€ä¸ªå¯¹è±¡æ˜¯newå…³é”®å­—åœ¨å †æ§ä»¶åˆ›å»ºçš„</p><p>ä¸€ä¸ªå¯¹è±¡æ˜¯å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­çš„å¯¹è±¡ï¼Œ  ldc</p><div class="code-wrapper"><pre class="language-none"><code class="language-none"> 0 new #4 &lt;java&#x2F;lang&#x2F;String&gt; 3 dup 4 ldc #5 &lt;123&gt; 6 invokespecial #6 &lt;java&#x2F;lang&#x2F;String.&lt;init&gt;&gt; 9 astore_110 return</code></pre></div></li><li><p>new Sting(â€œaâ€) + new String(â€œbâ€)å‘¢ï¼Ÿ</p><p>new String åˆ›å»ºåœ¨å †æ§ä»¶ä¸­</p><p>String a = &quot;a&quot;å¦‚æœå·²ç»æœ‰a ï¼Œåˆ™æ˜¯å¸¸é‡æ± ä¸­çš„å¯¹è±¡</p><p><strong>6ä¸ª</strong>  æ³¨æ„ + çš„æ‹¼æ¥æ“ä½œæ˜¯Stringbuilder  StringBuilderçš„toString ä¼šå†new ä¸€ä¸ªString</p><p><span style='color:orange;font-size:24px'>toStringæ–¹æ³•åœ¨å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­æ²¡æœ‰è¯¥Stringï¼</span>éªŒè¯åç¡®å®æ²¡æœ‰</p></li><li><p>åœ¨jdk 6 å’Œ jdk7/8çš„åŒºåˆ«</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210308162129529.png" alt="image-20210308162129529"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210308165709630.png" alt="image-20210308165709630"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210308161926144.png" alt="image-20210308161926144"></p><p>å¦‚æœå˜æ¢string s4=&quot;11&quot;å’Œs3.internçš„ä½ç½®åç»“æœå¦‚ä½•ï¼Ÿ</p></li></ol><p>â€‹jdk6 ä¸­ s3.intern åˆ›å»ºäº†æ–°çš„å¯¹è±¡â€œ11â€ï¼Œä¹Ÿå°±æ˜¯æœ‰æ–°çš„åœ°å€   å¸¸é‡æ± åœ¨æ°¸ä¹…ä»£ä¸­â€˜</p><p>å¦‚æœå¸¸é‡æ± ä¸­æ²¡æœ‰ï¼Œåˆ™å¤åˆ¶ä¸€ä»½ï¼Œæ”¾å…¥å¸¸é‡æ± ä¸­</p><p>â€‹jdk7 ä¸­ ç”±äºå¸¸é‡æ± æ”¾å…¥å †ç©ºé—´ä¸­ï¼Œä»–å°±ç›´æ¥æ‹¿å †ç©ºé—´çš„åœ°å€ã€‚ å¸¸é‡æ± è®°å½•çš„æ˜¯å †ç©ºé—´â€œ11â€åœ°å€  åªå å››ä¸ªå­—èŠ‚</p><p>â€‹JDK 1.7åï¼Œinternæ–¹æ³•è¿˜æ˜¯ä¼šå…ˆå»æŸ¥è¯¢å¸¸é‡æ± ä¸­æ˜¯å¦æœ‰å·²ç»å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™è¿”å›å¸¸é‡æ± ä¸­çš„å¼•ç”¨ï¼Œè¿™ä¸€ç‚¹ä¸ä¹‹å‰æ²¡æœ‰åŒºåˆ«ï¼ŒåŒºåˆ«åœ¨äºï¼Œå¦‚æœåœ¨å¸¸é‡æ± æ‰¾ä¸åˆ°å¯¹åº”çš„å­—ç¬¦ä¸²ï¼Œ<strong>åˆ™ä¸ä¼šå†å°†å­—ç¬¦ä¸²æ‹·è´åˆ°å¸¸é‡æ± </strong>ï¼Œè€Œ<strong>åªæ˜¯åœ¨å¸¸é‡æ± ä¸­ç”Ÿæˆä¸€ä¸ªå¯¹åŸå­—ç¬¦ä¸²çš„å¼•ç”¨</strong>ã€‚ç®€å•çš„è¯´ï¼Œå°±æ˜¯å¾€å¸¸é‡æ± æ”¾çš„ä¸œè¥¿å˜äº†ï¼šåŸæ¥åœ¨å¸¸é‡æ± ä¸­æ‰¾ä¸åˆ°æ—¶ï¼Œå¤åˆ¶ä¸€ä¸ªå‰¯æœ¬æ”¾åˆ°å¸¸é‡æ± ï¼Œ1.7ååˆ™æ˜¯å°†åœ¨å †ä¸Šçš„åœ°å€å¼•ç”¨å¤åˆ¶åˆ°å¸¸é‡æ± ã€‚</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> s1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>s1<span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> s2 <span class="token operator">=</span><span class="token string">"12"</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s1<span class="token operator">==</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p><span style='color: #DA70D6;font-size:24px'>ç–‘é—®ï¼šä¸ºä»€ä¹ˆinternåå†string s = â€œ123â€ç›¸åŒçš„å­—ç¬¦ä¸²ï¼Œè¿™æ—¶javaå †æ—¢æœ‰123åœ¨å †ä¸­å¼•ç”¨ï¼Œåˆæœ‰åœ¨å¸¸é‡æ± çš„å¯¹è±¡ï¼Œä¸ºä»€ä¹ˆæ¯”è¾ƒè¿˜æ˜¯ä¸€æ ·çš„ï¼Ÿ</span></p><p>è§£ç­”ï¼šåˆ›å»ºsä¼šç›´æ¥å»å¸¸é‡æ± ä¸­åˆ›å»ºï¼Œä½†å‘ç°æœ‰è¿™ä¸ªå¯¹è±¡äº†ï¼Œåˆ›å»ºçš„æ˜¯æŒ‡å‘åŸæ¥å †ä¸­å¯¹è±¡çš„ä¸€ä¸ªå¼•ç”¨     æ²¡çœ‹nativeå±‚æºç ï¼Œä¸æ˜¯éå¸¸æ¸…æ¥š</p><p><span style='color:#FA8072;font-size:24px'>æ˜“é”™ä¾‹é¢˜</span></p><blockquote><p>Qï¼šä¸‹åˆ—ç¨‹åºçš„è¾“å‡ºç»“æœï¼š<br>String s1 = â€œabcâ€;<br>String s2 = â€œaâ€;<br>String s3 = â€œbcâ€;<br>String s4 = s2 + s3;<br>System.out.println(s1 == s4);<br>Aï¼šfalseï¼Œå› ä¸ºs2+s3å®é™…ä¸Šæ˜¯ä½¿ç”¨StringBuilder.appendæ¥å®Œæˆï¼Œä¼šç”Ÿæˆä¸åŒçš„å¯¹è±¡ã€‚</p></blockquote><blockquote><p>Qï¼šä¸‹åˆ—ç¨‹åºçš„è¾“å‡ºç»“æœï¼š<br>String s1 = â€œabcâ€;<br>final String s2 = â€œaâ€;<br>final String s3 = â€œbcâ€;<br>String s4 = s2 + s3;<br>System.out.println(s1 == s4);<br>Aï¼štrueï¼Œå› ä¸ºfinalå˜é‡åœ¨ç¼–è¯‘åä¼šç›´æ¥æ›¿æ¢æˆå¯¹åº”çš„å€¼ï¼Œæ‰€ä»¥å®é™…ä¸Šç­‰äºs4=â€aâ€+â€bcâ€ï¼Œè€Œè¿™ç§æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨ä¼šç›´æ¥åˆå¹¶ä¸ºs4=â€abcâ€ï¼Œæ‰€ä»¥æœ€ç»ˆs1==s4ã€‚</p></blockquote><p>â€‹<strong>å®é™…æ“ä½œä¸­ æ·»åŠ å¤šä¸ªç›¸åŒçš„new Stringå¯¹è±¡ï¼Œ internæˆå€çš„å½±å“é€Ÿåº¦</strong></p><h2 id="åƒåœ¾å›æ”¶-v2">åƒåœ¾å›æ”¶</h2><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210309154809269.png" alt="image-20210309154809269"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210309155016450.png" alt="image-20210309155016450"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210309155037374.png" alt="image-20210309155037374"></p><ul><li>åƒåœ¾ï¼š è¿è¡Œç¨‹åºä¸­æ²¡æœ‰ä»»ä½•æŒ‡é’ˆæŒ‡å‘çš„å¯¹è±¡</li></ul><p>GCçš„ä¸»è¦ä½œç”¨åŸŸ ï¼š æ–¹æ³•åŒº å’Œ å †</p><h3 id="åƒåœ¾æ ‡è®°ç®—æ³•">åƒåœ¾æ ‡è®°ç®—æ³•</h3><h4 id="å¯¹è±¡å­˜æ´»åˆ¤æ–­">å¯¹è±¡å­˜æ´»åˆ¤æ–­</h4><h5 id="1-å¼•ç”¨è®¡æ•°æ³•">1. å¼•ç”¨è®¡æ•°æ³•</h5><p>â€‹æ¯ä¸ªå¯¹è±¡ä¿ç•™æ•´å‹çš„å¼•ç”¨è®¡æ•°å™¨å±æ€§  è®°å½•å¯¹è±¡è¢«å¼•ç”¨çš„æƒ…å†µ</p><p>â€‹å¼•ç”¨æ—¶ +1 å¼•ç”¨å¤±æ•ˆ -1</p><p>â€‹å¼•ç”¨ä¸º 0 è¿›è¡Œå›æ”¶</p><p>â€‹ä¼˜ç‚¹ï¼š ç®€å•ï¼Œä¾¿äºæ ‡è¯†ï¼Œåˆ¤æ–­æ•ˆç‡é«˜ï¼Œå›æ”¶æ— å»¶è¿Ÿ</p><p>â€‹ç¼ºç‚¹ï¼š å•ç‹¬çš„ç©ºé—´å­˜å‚¨å¼€é”€ï¼›æ¯æ¬¡åŠ å‡ ï¼Œæ—¶é—´å¼€é”€ï¼›<strong>æ— æ³•å¤„ç†å¾ªç¯å¼•ç”¨çš„æƒ…å†µ</strong>***ï¼ˆè‡´å‘½ï¼‰**{ç›¸äº’å¼•ç”¨ï¼Œæ°¸ä¸ä¸º0ï¼Œ 1â€“&gt;</p><p>â€‹2â€”&gt;3â€”&gt;2   æ”¾å¼ƒ1æ—¶ï¼Œ è¿˜å­˜åœ¨ 2â€“&gt;3â€“&gt;2çš„å¾ªç¯å¼•ç”¨}  å†…å­˜æ³„éœ²</p><p>â€‹<img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210309161215885.png" alt="image-20210309161215885"></p><h5 id="2-å¯è¾¾æ€§åˆ†æç®—æ³•">2. å¯è¾¾æ€§åˆ†æç®—æ³•</h5><p>â€‹JVM é€‰ç”¨</p><p>â€‹æœ‰æ•ˆè§£å†³äº†å¾ªç¯å¼•ç”¨é—®é¢˜ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼å‘ç”Ÿã€ç®€å•é«˜æ•ˆ</p><ul><li><p>GC Roots ï¼šä¸€ç»„å¿…é¡»æ´»è·ƒçš„å¼•ç”¨</p><ol><li><p>æŒ‰ç…§<strong>GC Roots</strong> ä¸ºèµ·å§‹ç‚¹ï¼Œä»ä¸Šè‡³ä¸‹ æœç´¢è¢«æ ¹å¯¹è±¡é›†åˆæ‰€è¿æ¥çš„ç›®æ ‡å¯¹è±¡æ˜¯å¦å¯è¾¾ã€‘</p></li><li><p>ä½¿ç”¨å¯è¾¾æ€§åˆ†æç®—æ³•åï¼Œå†…å­˜ä¸­å­˜æ´»çš„å¯¹è±¡éƒ½ä¼šè¢«æ ¹å¯¹è±¡é›†åˆ ç›´æ¥æˆ–é—´æ¥è¿æ¥ï¼Œæœç´¢æ‰€èµ°è¿‡çš„è·¯å¾„ç§°ä¸º<strong>å¼•ç”¨é“¾</strong></p></li><li><p>å¦‚æœç›®æ ‡å¯¹è±¡æ²¡æœ‰å’Œä»»ä½•å¼•ç”¨é“¾ç›¸è¿ï¼Œåˆ™ä¸å¯è¾¾ï¼Œæ ‡è®°ä¸ºåƒåœ¾å¯¹è±¡</p></li></ol></li><li><p>GC Roots å¯ä»¥æ˜¯ä»€ä¹ˆï¼š</p><ul><li>JVMæ ˆä¸­å¯¹è±¡  æ–¹æ³•ä¸­çš„å‚æ•°ã€å±€éƒ¨å˜é‡â€¦â€¦</li><li>JNIå¼•ç”¨çš„å¯¹è±¡</li><li>ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡</li><li>å¸¸é‡å¼•ç”¨çš„å¯¹è±¡ ï¼ˆStringTable ä¸­ï¼‰</li><li>è¢«synchæŒæœ‰çš„å¯¹è±¡</li><li>JVMå†…éƒ¨çš„å¼•ç”¨ Classå¯¹è±¡ï¼Œç³»ç»Ÿå†…åŠ è½½å™¨</li><li>ä¸€ä¸ªæŒ‡é’ˆï¼Œä¿å­˜äº†rootå †å†…å­˜çš„å¯¹è±¡ï¼Œä½†ä»–è‡ªå·±åˆæ²¡æœ‰åœ¨å †é‡Œè¾¹ï¼Œä»–å°±æ˜¯ä¸€ä¸ªroot</li></ul></li></ul><h4 id="å¯¹è±¡çš„finaliztionæœºåˆ¶">å¯¹è±¡çš„finaliztionæœºåˆ¶</h4><p>å¯¹è±¡é”€æ¯ä¹‹å‰å¯ä»¥è‡ªå®šä¹‰å¤„ç†é€»è¾‘</p><p>å¯¹è±¡å›æ”¶ä¹‹å‰ä¼šæ‰§è¡Œ finalize()æ–¹æ³• ï¼Œå¯ä»¥åœ¨å­ç±»é‡å†™è¯¥æ–¹æ³•</p><p><span style='color:red;font-size:24px'>æ°¸è¿œä¸è¦ä¸»åŠ¨çš„è°ƒç”¨å¯¹è±¡çš„finalizeæ–¹æ³•</span></p><ul><li>finalizeå¯èƒ½å¯¼è‡´å¯¹è±¡å¤æ´»</li><li>æ‰§è¡Œæ—¶é—´æ²¡æœ‰ä¿éšœï¼Œç”±GCçº¿ç¨‹å†³å®š</li><li>å¯èƒ½å½±å“GCæ€§èƒ½</li></ul><p>è™šæ‹Ÿæœºä¸­å¯¹è±¡çš„ä¸‰ç§çŠ¶æ€ï¼š</p><ol><li>å¯è§¦åŠçš„</li><li>å¯å¤æ´»çš„  æ‰€æœ‰å¼•ç”¨è¢«é‡Šæ”¾ï¼Œä½†å¯èƒ½åœ¨finalizeä¸­å¤æ´»</li><li>ä¸å¯è§¦åŠçš„  è°ƒç”¨finalize ä¸”æ²¡æœ‰å¤æ´»</li></ol><p>åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å¯å›æ”¶   è‡³å°‘ä¸¤æ¬¡æ ‡è®°</p><p><span style='color: #00BFFF;font-size:20px'>ç†è§£finalizeæ–¹æ³• â€” ä¸€ç”Ÿåªèƒ½ä½¿ç”¨ä¸€æ¬¡çš„å…æ­»é‡‘ç‰Œ</span></p><ol><li>åˆ°GC Rootsæ²¡æœ‰å¼•ç”¨è¿</li><li>ç­›é€‰ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰å¿…è¦æ‰§è¡Œfinalize<ol><li>æ²¡æœ‰é‡å†™ finalizeæ–¹æ³• ----æ²¡å¿…è¦    finalizeæ–¹æ³•è¢«è°ƒç”¨ ----æ²¡å¿…è¦æ‰§è¡Œ</li><li>é‡å†™äº†ä¸”æœªè¢«æ‰§è¡Œ   è¢«æ’å…¥F-Queueé˜Ÿåˆ—ä¸­   ç”±ä¼˜å…ˆçº§è¾ƒä½çš„Finalizerçº¿ç¨‹æ‰§è¡Œ</li><li>finalizeè°ƒç”¨æ˜¯å¯¹è±¡å”¯ä¸€èƒ½å¤æ´»çš„æœºä¼šï¼Œç¨åGCä¼šå¯¹F-Queueçš„å¯¹è±¡è¿›è¡ŒäºŒæ¬¡æ ‡è®°ï¼Œå¦‚æœåœ¨finalizeä¸­è¯¥å¯¹è±¡å’Œå¼•ç”¨é“¾ä»»ä½•ä¸€ä¸ªå¯¹è±¡å»ºç«‹äº†è”ç³»ï¼Œåˆ™ç¬¬äºŒæ¬¡æ ‡è®°ï¼Œè¯¥å¯¹è±¡ä¼šè¢«ç§»é™¤â€œå³å°†å›æ”¶â€é›†åˆï¼Œ å¦‚æœä¼ºå€™ï¼Œå¯¹è±¡å†æ¬¡å‡ºç°æ²¡æœ‰å¼•ç”¨å­˜åœ¨çš„æƒ…å†µï¼Œè¿™ä¸ªæ—¶å€™ç”±äºä¸€ä¸ªå¯¹è±¡çš„finalizeæ–¹æ³•åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œå¯¹è±¡ç›´æ¥å˜æˆä¸å¯è§¦åŠçŠ¶æ€</li></ol></li></ol><p>finalizeç”¨æ³•çš„æœ€å¥½å®è·µ</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java">    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Obj</span> obj<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">&#123;</span>        obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Obj</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>obj <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"obj is alive"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        obj <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">gc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ä¸€å®šè¦è°ƒç”¨gc </span>        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ³¨æ„ç‚¹</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>obj <span class="token operator">==</span> <span class="token keyword">null</span><span class="token operator">?</span><span class="token string">"null"</span><span class="token operator">:</span><span class="token string">"alive"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">finalize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">finalize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"xdmæˆ‘è¦è¢«å›æ”¶äº† æ•‘æˆ‘"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        obj <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">/*        obj is alive        xdmæˆ‘è¦è¢«å›æ”¶äº† æ•‘æˆ‘        -----2s        alive*/</span></code></pre></div><p>â€‹æ³¨æ„ç‚¹ï¼Œè¿™é‡Œä¸ºä»€ä¹ˆè¦ä¼‘çœ 2sï¼Ÿ</p><p>â€‹Finalizeræ˜¯ä½ä¼˜å…ˆçº§çš„çº¿ç¨‹ï¼Œ å¹¶å‘æ—¶ å¯èƒ½ä¼šæœ‰è€—æ—¶ ï¼Œç›´æ¥ä¸ä¼‘çœ çš„è¯ï¼Œä¼šæ˜¾ç¤ºä¸ºnull</p><p>â€‹</p><p>ä½¿ç”¨mat å’Œ JVisualVM æŸ¥çœ‹dumpå †</p><p>JProfiler è¿›è¡ŒGCæº¯æº</p><h3 id="åƒåœ¾æ¸…é™¤ç®—æ³•">åƒåœ¾æ¸…é™¤ç®—æ³•</h3><p>æˆåŠŸåˆ¤æ–­æ­»æ´»å¯¹è±¡åï¼Œå°±æ˜¯æ‰§è¡Œåƒåœ¾å›æ”¶æ“ä½œäº†ï¼Œé‡Šæ”¾æ— ç”¨å¯¹è±¡æ‰€å çš„ç©ºé—´</p><p>JVMå¸¸è§çš„ä¸‰ç§åƒåœ¾æ”¶é›†ç®—æ³•</p><ul><li>æ ‡è®°-æ¸…é™¤ç®—æ³•</li><li>å¤åˆ¶ç®—æ³•</li><li>æ ‡è®°-å‹ç¼©ç®—æ³•</li></ul><h4 id="æ ‡è®°-æ¸…é™¤-ç®—æ³•">æ ‡è®° - æ¸…é™¤ ç®—æ³•</h4><p>Mark - Sweep</p><p>å †ä¸­æœ‰æ•ˆå†…å­˜è€—å°½  â€” åœæ­¢æ•´ä¸ªç¨‹åº STW â€”æ ‡è®° / æ¸…é™¤</p><ul><li>æ ‡è®°ï¼šCollector ä»å¼•ç”¨æ ¹èŠ‚ç‚¹å¼€å§‹éå†ï¼Œæ ‡è®°æ‰€æœ‰<strong>è¢«å¼•ç”¨çš„å¯¹è±¡</strong>  ï¼Œåœ¨å¯¹è±¡å¤´ä¸­è®°å½•ä¸ºå¯è¾¾å¯¹è±¡</li><li>æ¸…é™¤ï¼šCollectorå¯¹å †å†…å­˜ä»å¤´åˆ°å°¾éå†ï¼ˆæ‰€æœ‰ï¼‰ï¼Œå¦‚æœå‘ç°å¯¹è±¡çš„å¯¹è±¡å¤´ä¸­æ²¡æœ‰æ ‡è®°ä¸ºå¯è¾¾ï¼Œåˆ™å›æ”¶</li></ul><p>ç¼ºç‚¹ï¼š</p><ol><li>æ•ˆç‡ä¸é«˜  ä¸¤æ¬¡éå†</li><li>GCæ—¶ä¼šSTW</li><li>æ¸…ç†å‡ºçš„å†…å­˜ç©ºé—´æ˜¯ä¸è¿ç»­çš„ï¼Œéœ€è¦ç»´æŠ¤ä¸€ä¸ªåˆ—è¡¨</li></ol><p>æ¸…é™¤ï¼Ÿ</p><p><strong>æ¸…é™¤ä¸æ˜¯ç½®ç©ºï¼Œæ˜¯æŠŠè¦æ¸…é™¤çš„å¯¹è±¡åœ°å€ï¼Œä¿å­˜åœ¨ç©ºé—´çš„åœ°å€åˆ—è¡¨ä¸­ï¼Œä¸‹æ¬¡æœ‰æ–°å¯¹è±¡è¦åŠ è½½æ—¶ï¼Œåˆ¤æ–­åƒåœ¾çš„ä½ç½®ç©ºé—´æ˜¯ä¸æ˜¯å¤Ÿï¼Œå¦‚æœå¤Ÿå°±è¦†ç›–</strong></p><h4 id="å¤åˆ¶ç®—æ³•">å¤åˆ¶ç®—æ³•</h4><p>è§£å†³ æ ‡è®°æ¸…é™¤ç®—æ³•åœ¨åƒåœ¾æ”¶é›†æ•ˆç‡çš„ç¼ºé™·</p><p>å°†æ´»ç€çš„å†…å­˜åˆ†ä¸ºä¸¤å—ï¼Œæ¯æ¬¡åªä½¿ç”¨ä¸€å—ï¼Œåƒåœ¾å›æ”¶æ—¶ï¼Œå°†ä½¿ç”¨çš„å†…å­˜çš„å­˜æ´»å¯¹è±¡å¤åˆ¶ï¼ˆå¤åˆ¶åçš„å°±æ˜¯è¿ç»­çš„ç©ºé—´äº†ï¼‰åˆ°æœªè¢«ä½¿ç”¨çš„å†…å­˜å—ä¸­ï¼Œä¹‹åæ¸…é™¤æ­£åœ¨ä½¿ç”¨çš„å†…å­˜å—ä¸­çš„æ‰€æœ‰å¯¹è±¡ï¼Œäº¤æ¢è§’è‰²  (ç±»æ¯”SurvivoråŒº)</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210309181613653.png" alt="image-20210309181613653"></p><p>ä¼˜ç‚¹ï¼š</p><ul><li>æ²¡æœ‰æ¸…é™¤æ ‡è®°çš„è¿‡ç¨‹ï¼Œå®ç°ç®€å•</li><li>å¤åˆ¶åçš„ç©ºé—´æ˜¯è¿ç»­çš„ï¼Œä¸éœ€è¦ç©ºé—²åˆ—è¡¨  ï¼Œä½¿ç”¨æŒ‡é’ˆç¢°æ’</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>å§‹ç»ˆå¯ç”¨çš„å†…å­˜ç©ºé—´ä¸º1/2</li><li>G1 åˆ†æ‹†æˆå¤§é‡regionçš„GCï¼Œå¤åˆ¶éœ€è¦ç»´æŠ¤regionä¹‹é—´å¯¹è±¡çš„å¼•ç”¨å…³ç³»ï¼Œä¹Ÿæœ‰æ—¶é—´å¼€é”€ ï¼ˆJavaå¯¹è±¡çš„è®¿é—®æ–¹å¼ï¼‰</li><li>ç³»ç»Ÿä¸­åƒåœ¾å¾ˆå¤š â€”å¯¼è‡´å¤åˆ¶ç®—æ³•å¾ˆæ…¢   é€‚ç”¨äºSurvivoråŒº ï¼ˆå›æ”¶æ€§ä»·æ¯”é«˜ï¼‰</li></ul><h4 id="æ ‡è®°-å‹ç¼©ç®—æ³•">æ ‡è®° - å‹ç¼©ç®—æ³•</h4><p>Mark - Compat</p><p>æ ‡è®°ï¼š ä¸ æ ‡è®°æ¸…é™¤ç®—æ³•ç›¸åŒ</p><p>å‹ç¼©ï¼šæ‰€æœ‰å­˜æ´»çš„å¯¹è±¡å‹ç¼©åˆ°å†…å­˜çš„ä¸€æ®µï¼Œ<strong>æŒ‰ç…§é¡ºåºæ’æ”¾</strong>ï¼Œä¹‹åæ¸…ç†è¾¹ç•Œå¤–çš„æ‰€æœ‰ç©ºé—´</p><p>å·®å¼‚ï¼š ç§»åŠ¨å¼çš„</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210309183437564.png" alt="image-20210309183437564"></p><p>å‹ç¼© åå†…å­˜è§„æ•´  å¯ä»¥ç”¨æŒ‡é’ˆç¢°æ’</p><p>ä¼˜ç‚¹ï¼š</p><ul><li><p>æ¶ˆé™¤äº†æ ‡è®°æ¸…é™¤ç®—æ³•ä¸­å†…å­˜åŒºåŸŸåˆ†æ•£çš„ç¼ºç‚¹ã€</p></li><li><p>æ¶ˆé™¤äº†èµ‹å€¼ç®—æ³•ä¸­å†…å­˜å‡åŠçš„é«˜é¢ä»£ä»·</p></li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>æ•ˆç‡ ä½äºå¤åˆ¶ç®—æ³•</li><li>ç§»åŠ¨å¯¹è±¡æ—¶ï¼Œå¦‚æœå¯¹è±¡è¢«å…¶ä»–å¯¹è±¡å¼•ç”¨ï¼Œè¿˜éœ€è¦è°ƒæ•´å¼•ç”¨çš„åœ°å€</li><li>ç§»åŠ¨è¿‡ç¨‹ä¸­ ï¼Œè§¦å‘STW</li></ul><h4 id="å¯¹æ¯”">å¯¹æ¯”</h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210309184113952.png" alt="image-20210309184113952"></p><h4 id="åˆ†ä»£æ”¶é›†ç®—æ³•">åˆ†ä»£æ”¶é›†ç®—æ³•</h4><p>ä¸åŒç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡é‡‡ç”¨ä¸åŒçš„æ”¶é›†æ–¹å¼ï¼Œæé«˜å›æ”¶æ•ˆç‡</p><p>å‡ ä¹æ‰€æœ‰çš„GCéƒ½é‡‡ç”¨</p><ol><li><p>Young Gen å›æ”¶é¢‘ç¹ã€ç”Ÿå‘½å‘¨æœŸçŸ­    Coping</p></li><li><p>Old Gen ç”Ÿå‘½å‘¨æœŸé•¿ã€å­˜æ´»ç‡é«˜    Sweep å’Œ Compat æ•´åˆ</p><p>Mark é˜¶æ®µå¼€é”€ä¸<strong>å­˜æ´»å¯¹è±¡</strong>æ­£æ¯”</p><p>Sweep ä¸ç®¡ç†åŒºåŸŸçš„å¤§å°æˆæ­£ç›¸å…³ï¼ˆå †çš„éå†ï¼‰</p><p>Compat ä¸å­˜æ´»å¯¹è±¡çš„æ•°æ®æ­£æ¯”</p></li></ol><h4 id="å¢é‡æ”¶é›†ç®—æ³•">å¢é‡æ”¶é›†ç®—æ³•</h4><p>åŸºæœ¬æ€æƒ³ï¼šGCçº¿ç¨‹å’Œä¸»çº¿ç¨‹  äº¤æ›¿è¿›è¡Œå¹¶å‘æ¸…ç†åƒåœ¾ï¼Œè®©ç”¨æˆ·æ„Ÿå—ä¸åˆ°STW</p><p>åŸºç¡€ï¼š Sweep å’Œ Compat</p><p>ç¼ºç‚¹ï¼š</p><p>çº¿ç¨‹åˆ‡æ¢å’Œä¸Šä¸‹æ–‡è½¬æ¢æœ‰æ¶ˆè€—ï¼Œä½¿å¾—åƒåœ¾å›æ”¶æ€»æˆæœ¬ä¸Šå‡ï¼Œç³»ç»Ÿååé‡ä¸‹é™</p><p>ï¼ˆåŒæ—¶åšä¸¤ä»¶äº‹ï¼Œç»“æœéƒ½åšçš„ä¸æ˜¯å¾ˆå¥½ï¼‰</p><h4 id="åˆ†åŒºç®—æ³•">åˆ†åŒºç®—æ³•</h4><p>å †ç©ºé—´è¶Šå¤§ GCæ—¶é—´è¶Šé•¿</p><p>åˆ†å‰²å†…å­˜åŒºåŸŸä¸ºå¤šä¸ªå°å— region ï¼Œå‡å°‘ç›®æ ‡åœé¡¿æ—¶é—´ï¼Œæ¯æ¬¡åˆç†åœ°å›æ”¶è‹¥å¹²ä¸ªå°ç©ºé—´ è€Œä¸æ˜¯æ•´ä¸ªå †ç©ºé—´</p><h3 id="æ¦‚å¿µ-v5">æ¦‚å¿µ</h3><h4 id="System-gy">System,gy()</h4><p>Runtijme.getRunTime().gc() æ˜¾ç¤ºè§¦å‘ Full GC</p><p>ä½†æ˜¯é™„å¸¦<strong>å…è´£å£°æ˜</strong>ï¼Œæ— æ³•ä¿è¯å¯¹åƒåœ¾æ”¶é›†å™¨çš„è°ƒç”¨</p><p>è°ƒç”¨System.runFinalization  å¼ºåˆ¶è°ƒç”¨ä½¿ç”¨å¼•ç”¨å¯¹è±¡çš„finalizeæ–¹æ³•</p><ul><li>ä¸»åŠ¨gcçš„å‡ ç§æƒ…å†µ</li></ul><h4 id="å†…å­˜æº¢å‡º">å†…å­˜æº¢å‡º</h4><p>å®šä¹‰ï¼š æ²¡æœ‰ç©ºé—²å†…å­˜ä¸”åƒåœ¾æ”¶é›†å™¨ä¹Ÿæ— æ³•æä¾›æ›´å¤šå†…å­˜ï¼ˆOOMå‰ä¼šè¿›è¡Œä¸€æ¬¡Full GCï¼‰</p><h4 id="å†…å­˜æ³„éœ²">å†…å­˜æ³„éœ²</h4><p>æ²¡æœ‰å¼•ç”¨ ï¼Œ ä½†GCä¸èƒ½è¿›è¡Œå›æ”¶</p><p>ä¾‹å¦‚ï¼š å•ä¾‹æ¨¡å¼ã€æœªè°ƒç”¨closeæ–¹æ³•</p><h4 id="STW">STW</h4><p>å¯è¾¾æ€§åˆ†æç®—æ³•ä¸­æšä¸¾æ ¹èŠ‚ç‚¹ GC Rootså¯¼è‡´æ‰€æœ‰çš„Javaçº¿ç¨‹åœé¡¿</p><ul><li>ç¡®ä¿åˆ†æå·¥ä½œåœ¨ä¸€ä¸ªä¸€è‡´æ€§çš„<strong>å¿«ç…§</strong>ä¸­è¿›è¡Œï¼Œä¾‹å¦‚JVisualVmç”Ÿæˆ å †dump ä¸åŒæ—¶é—´æ˜¯ä¸åŒçš„</li><li>ä¸€è‡´æ€§æŒ‡æ•´ä¸ªåˆ†ææœŸé—´ æ•´ä¸ªæ‰§è¡Œç³»ç»Ÿ åƒè¢«å†»ç»“åœ¨æŸä¸ªæ—¶é—´ç‚¹ä¸Š</li><li>å¦‚æœåˆ†æè¿‡ç¨‹ä¸­å¯¹è±¡çš„å¼•ç”¨å…³ç³»è¿˜åœ¨ä¸æ–­å˜åŒ–ï¼Œåˆ™åˆ†æç»“æœçš„å‡†ç¡®æ€§ä¹Ÿæ— æ³•ä¿è¯</li></ul><p>JVMåå°è‡ªåŠ¨å‘èµ·STW å¼€å‘ä¸­ä¸è¦ç”¨STW</p><p>ç†è§£ä»£ç :</p><div class="code-wrapper"><pre class="language-none"><code class="language-none"></code></pre></div><h4 id="åƒåœ¾å›æ”¶çš„å¹¶è¡Œå’Œå¹¶å‘">åƒåœ¾å›æ”¶çš„å¹¶è¡Œå’Œå¹¶å‘</h4><p>å¹¶å‘</p><p>å‡ ä¸ªç¨‹åºå¤„äºå¯åŠ¨çŠ¶æ€ä¸”éƒ½åœ¨åŒä¸€ä¸ªå¤„ç†å™¨ä¸Šå®Œæˆï¼Œæ—¶é—´ç‰‡</p><p>ï¼ˆåœ¨åŒä¸€æ—¶é—´æ®µå‘ç”Ÿï¼‰</p><p>åƒåœ¾å›æ”¶çš„å¹¶è¡Œï¼š  å¤šæ¡åƒåœ¾æ”¶é›†çº¿ç¨‹å¹¶è¡Œå·¥ä½œï¼Œä»åœ¨ STW</p><p><span style='color:red;font-size:24px'>å¤šæ ¸ä¸­å¹¶å‘æ˜¯æ€æ ·çš„</span></p><p>å¹¶è¡Œ</p><p>ç³»ç»Ÿå¤šä¸ªCPUæˆ–è€…å¤šæ ¸æ—¶ï¼Œä¸€ä¸ªCPUä¸€ä¸ªæ ¸æ‰§è¡Œä¸€ä¸ªè¿›ç¨‹ä¸å¦ä¸€ä¸ªCPUæˆ–è€…å¦ä¸€ä¸ªæ ¸åŒæ—¶æ‰§è¡Œä¸€ä¸ªçº¿ç¨‹ï¼Œå°±æ˜¯å¹¶è¡Œ</p><p>ï¼ˆåœ¨åŒä¸€æ—¶é—´ç‚¹å‘ç”Ÿï¼‰</p><p>åƒåœ¾å›æ”¶çš„å¹¶å‘ ï¼šç”¨æˆ·çº¿ç¨‹å’Œåƒåœ¾æ”¶é›†çº¿ç¨‹åŒæ—¶è¿›è¡Œï¼ˆäº¤æ›¿ï¼‰ï¼Œä¸ä¼šå¼•èµ·STW</p><p>åƒåœ¾æ”¶é›†ç¨‹åºåœ¨ä¸€ä¸ªæ ¸  ç”¨æˆ·ç¨‹åºåœ¨å¦ä¸€ä¸ªæ ¸</p><h4 id="å®‰å…¨ç‚¹å’Œå®‰å…¨åŒºåŸŸ">å®‰å…¨ç‚¹å’Œå®‰å…¨åŒºåŸŸ</h4><h5 id="å®‰å…¨ç‚¹">å®‰å…¨ç‚¹</h5><p>å¹¶ä¸æ˜¯æ‰€æœ‰çš„åœ°æ–¹éƒ½å¯ä»¥ç«‹é©¬åœä¸‹æ¥ GC   å¿…é¡»åœ¨ç‰¹å®šçš„åœ°æ–¹åœä¸‹æ¥ å³ Safe Point</p><p>å®‰å…¨ç‚¹å¤ªå°‘ ----  GCç­‰å¾…æ—¶é—´è¿‡é•¿</p><p>å¤ªå¤š ---- æ€§èƒ½é—®é¢˜</p><ul><li><p>æŠ¢å…ˆå¼ä¸­æ–­ï¼ˆæœªé‡‡ç”¨ï¼‰</p><p>æš‚åœæ‰€æœ‰çº¿ç¨‹ï¼Œå¦‚æœæœ‰çº¿ç¨‹ä¸åœ¨å®‰å…¨ç‚¹ä¸Šï¼Œå°±å›å¤çº¿ç¨‹ï¼Œè®©çº¿ç¨‹è·‘åˆ°å®‰å…¨ç‚¹ä¸Š</p></li><li><p>ä¸»åŠ¨å¼ä¸­æ–­</p><p>è®¾ç½®ä¸­æ–­æ ‡å¿—ï¼Œå„ä¸ªçº¿ç¨‹è·‘åˆ°Safe pointå»çœ‹è¿™ä¸ª æ ‡å¿—ï¼Œå¦‚æœæ˜¯çœŸçš„ï¼Œåˆ™æŒ‚èµ·</p></li></ul><h5 id="å®‰å…¨åŒº">å®‰å…¨åŒº</h5><p>ç¨‹åºblockæ—¶æ— æ³•å“åº” JVMä¸­æ–­   â€” Safe region è§£å†³</p><p>ä¸€æ®µä»£ç ç‰‡æ®µï¼Œ å¯¹è±¡çš„å¼•ç”¨å…³ç³»ä¸å˜ï¼Œ ä»»ä½•ä½ç½®å¼€å§‹GCéƒ½æ˜¯å®‰å…¨çš„ï¼ˆäºŒç»´çš„safe pointï¼‰</p><p>å®é™…æ‰§è¡Œ</p><ol><li>çº¿ç¨‹è·‘åˆ°safe regionæ—¶ï¼Œæ ‡è¯†è¿›å…¥äº†safe region å¦‚æœå‘ç”ŸGCï¼Œ åˆ™JVMå¿½ç•¥æ ‡è¯†ä¸ºSafe Regionçš„çº¿ç¨‹</li><li>å‡†å¤‡ç¦»å¼€Safe regionæ—¶ï¼Œä¼šæ£€æŸ¥JVMæ˜¯å¦å®Œæˆ GCï¼Œå¦‚æœå®Œæˆäº†åˆ™ç»§ç»­è¿è¡Œï¼Œå¦‚æœæ²¡å®ŒæˆGCï¼Œåˆ™çº¿ç¨‹å¿…é¡»ç­‰å¾…ï¼ŒçŸ¥é“æ”¶åˆ°äº†GCå®Œæˆçš„å‘½ä»¤ æ‰ä¼šç¦»å¼€Safe region</li></ol><h3 id="å¼•ç”¨">å¼•ç”¨</h3><p>å¸Œæœ›æœ‰è¿™ä¹ˆä¸€ç¾¤å¯¹è±¡ï¼Œå†…å­˜ç©ºé—´å¤Ÿï¼Œå°±åœ¨è¿™ï¼Œä¸å¤Ÿï¼Œå°±æŠŠä»–æŠ›å¼ƒ</p><p><span style='color:red;font-size:24px'>å¼ºå¼•ç”¨ã€è½¯å¼•ç”¨ã€å¼±å¼•ç”¨ã€è™šå¼•ç”¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œå…·ä½“ä½¿ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ</span></p><h4 id="å¼ºå¼•ç”¨">å¼ºå¼•ç”¨</h4><p>new Object  æ— è®ºä»»ä½•æƒ…å†µï¼Œåªè¦å¼ºå¼•ç”¨å…³ç³»è¿˜åœ¨ï¼Œåƒåœ¾æ”¶é›†å™¨å°±æ°¸è¿œä¸ä¼šå›æ”¶æ‰è¢«å¼•ç”¨çš„å¯¹è±¡</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Student</span> s1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Student</span> s2 <span class="token operator">=</span> s1<span class="token punctuation">;</span>s1 <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">gc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//sleep</span>syso s2<span class="token punctuation">.</span>name<span class="token punctuation">;</span></code></pre></div><p>ä¸Šè¿°ç»“æœèƒ½è¾“å‡ºs2çš„åå­—ï¼Œå› ä¸ºç”±äºæ˜¯å¼ºå¼•ç”¨ï¼Œs1è™½ç„¶æ²¡æœ‰å¼•ç”¨äº†ï¼Œä½†s2ä»ç„¶æŒæœ‰å †ç©ºé—´ä¸­å¯¹è±¡çš„å¼•ç”¨ï¼Œæ‰€ä»¥full gcæ—¶æ²¡æœ‰è¢«æ¸…ç†</p><h4 id="è½¯å¼•ç”¨Soft">è½¯å¼•ç”¨Soft</h4><p>OOMå‰ æˆ–è€… å†…å­˜<strong>å¿«è¦æ»¡äº†</strong>ï¼Œå°†ä¼šæŠŠè¿™äº›å¯¹è±¡æ”¾å…¥å›æ”¶èŒƒå›´ä¸­è¿›è¡ŒäºŒæ¬¡å›æ”¶ï¼Œå¦‚æœå›æ”¶å†…å­˜ä¸å¤Ÿï¼Œæ‰ä¼šæŠ¥OOM</p><p>æ³¨æ„è½¯å¼•ç”¨çš„ä½¿ç”¨æ–¹å¼  â€“  ä½¿ç”¨åè¦æŠŠå¼ºå¼•ç”¨ç»™ç½®ç©ºï¼Œä½¿å¾—å¼ºå¼•ç”¨æ— æ•ˆ</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java">   <span class="token class-name">Teacher1</span> teacher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Teacher1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token class-name">SoftReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Teacher1</span><span class="token punctuation">></span></span> softReference <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SoftReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Teacher1</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>teacher<span class="token punctuation">)</span><span class="token punctuation">;</span>   teacher <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>   softReference<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//System.out.println(teacher.getName()); Null pointer</span><span class="token comment">//-Xms10m -Xmx10m</span>   <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   <span class="token punctuation">&#125;</span><span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>       <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>softReference<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// nullpointer</span>   <span class="token punctuation">&#125;</span></code></pre></div><h4 id="å¼±å¼•ç”¨Weak">å¼±å¼•ç”¨Weak</h4><p>åªèƒ½ç”Ÿå­˜åˆ°ä¸‹ä¸€æ¬¡åƒåœ¾æ”¶é›†ä¹‹å‰</p><h5 id="WeakHashMap">WeakHashMap</h5><p>å­˜å‚¨å›¾ç‰‡ä¿¡æ¯ï¼Œå†…å­˜ä¸è¶³ï¼Œè‡ªåŠ¨æ¸…ç†   å†…éƒ¨Entryç»§æ‰¿äº†WeakReference</p><h4 id="è™šå¼•ç”¨PhantomReference">è™šå¼•ç”¨PhantomReference</h4><p>å”¯ä¸€ç›®çš„ï¼Œå¯¹è±¡è¢«æ”¶é›†å™¨å›æ”¶å‰æ”¶åˆ°ç³»ç»Ÿçš„é€šçŸ¥ï¼Œè®°å½•å›æ”¶æ—¶é—´</p><p>éœ€è¦æŒ‡å®šå¼•ç”¨é˜Ÿåˆ—</p><p>getæ‹¿ä¸åˆ°å¯¹è±¡</p><h2 id="åƒåœ¾å›æ”¶æœŸ">åƒåœ¾å›æ”¶æœŸ</h2><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210322141038714.png" alt="image-20210322141038714"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210322141151403.png" alt="image-20210322141151403"></p><p>-XX PrintCommandlineflags æŸ¥çœ‹é»˜è®¤åƒåœ¾æ”¶é›†å™¨</p><h3 id="æŒ‡æ ‡">æŒ‡æ ‡</h3><p><strong>ååé‡</strong>ï¼š è¿è¡Œç”¨æˆ·ä»£ç æ—¶é—´å æ€»è¿è¡Œæ—¶é—´çš„æ¯”ä¾‹</p><p>åƒåœ¾æ”¶é›†å¼€é”€ï¼š ååé‡çš„è¡¥æ•°ï¼Œåƒåœ¾æ”¶é›†æ‰€ç”¨æ—¶é—´ä¸æ€»è¿è¡Œæ—¶é—´æ¯”ä¾‹</p><p><strong>æš‚åœæ—¶é—´</strong>ï¼šä¸€ä¸ªæ—¶é—´æ®µå†…åº”ç”¨ç¨‹åºçº¿ç¨‹æš‚åœè®©GCçº¿ç¨‹æ‰§è¡Œ</p><p>å†…å­˜å ç”¨ï¼šJavaå †åŒºæ‰€å çš„å†…å¯¸å¤§å°</p><p>ååé‡ä¼˜å…ˆ ä¸ æ³¨é‡æš‚åœæ—¶é—´ï¼š</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210322150414860.png" alt="image-20210322150414860"></p><ul><li>é«˜ååé‡ï¼šç”¨æˆ·æ„Ÿè§‰åªåº”ç”¨çº¿ç¨‹åœ¨åšå·¥ä½œï¼Œè¿è¡Œå¿«</li><li>ä½æš‚åœæ—¶é—´ï¼šäº¤äº’æ›´å¥½</li><li>ä¸¤è€…ç›¸äº’çŸ›ç›¾</li></ul><p><strong>ç°åœ¨çš„æ ‡å‡†ï¼š åœ¨æœ€å¤§ååé‡ä¼˜å…ˆæƒ…å†µä¸‹ï¼Œé™ä½æš‚åœæ—¶é—´</strong></p><h3 id="Serial">Serial</h3><p>ä¸²è¡Œæ”¶é›†å™¨ï¼š å•çº¿ç¨‹ åªä½¿ç”¨ä¸€ä¸ªCPUæˆ–ä¸€æ¡æ”¶é›†çº¿ç¨‹å®Œæˆåƒåœ¾æ”¶é›†å·¥ä½œ  è¿˜ä¼šè§¦å‘ STW</p><p>å¹´ä»£ä¹…è¿œClient æ¨¡å¼ä¸‹é»˜è®¤  ã€ å¤åˆ¶ç®—æ³• ã€STWã€ä¸²è¡Œå›æ”¶</p><p><strong>Old</strong></p><p>æ ‡è®°-å‹ç¼©</p><p>Clientæ¨¡å¼é»˜è®¤</p><p>Serveræ¨¡å¼ ä¸æ–°ç”Ÿä»£ParallelScavengeé…åˆ  ã€ CMSåå¤‡åƒåœ¾æ”¶é›†æ–¹æ¡ˆ</p><p>ä¸²è¡Œæ”¶é›†å™¨é‡‡ç”¨å•çº¿ç¨‹stop-the-worldçš„æ–¹å¼è¿›è¡Œæ”¶é›†ã€‚å½“å†…å­˜ä¸è¶³æ—¶ï¼Œä¸²è¡ŒGCè®¾ç½®åœé¡¿æ ‡è¯†ï¼Œå¾…æ‰€æœ‰çº¿ç¨‹éƒ½è¿›å…¥å®‰å…¨ç‚¹(Safepoint)æ—¶ï¼Œåº”ç”¨çº¿ç¨‹æš‚åœï¼Œä¸²è¡ŒGCå¼€å§‹å·¥ä½œï¼Œé‡‡ç”¨å•çº¿ç¨‹æ–¹å¼å›æ”¶ç©ºé—´å¹¶æ•´ç†å†…å­˜ã€‚å•çº¿ç¨‹ä¹Ÿæ„å‘³ç€å¤æ‚åº¦æ›´ä½ã€å ç”¨å†…å­˜æ›´å°‘ï¼Œä½†åŒæ—¶ä¹Ÿæ„å‘³ç€ä¸èƒ½æœ‰æ•ˆåˆ©ç”¨å¤šæ ¸ä¼˜åŠ¿ã€‚äº‹å®ä¸Šï¼Œä¸²è¡Œæ”¶é›†å™¨ç‰¹åˆ«é€‚åˆå †å†…å­˜ä¸é«˜ã€å•æ ¸ç”šè‡³åŒæ ¸CPUçš„åœºåˆã€‚</p><p><strong>ä¼˜ç‚¹</strong></p><p>ç®€å•é«˜æ•ˆ   æ²¡æœ‰çº¿ç¨‹äº¤äº’çš„å¼€é”€</p><p>é€‚ç”¨å•æ ¸ ã€ åµŒå…¥å¼</p><p>-XX ï¼š+UserSerialGC</p><h3 id="ParNew">ParNew</h3><p>Parllel New å¯¹æ–°ç”Ÿä»£å¹¶è¡Œå›æ”¶</p><p>æ–°ç”Ÿä»£å›æ”¶æ¬¡æ•°é¢‘ç¹ï¼Œç”¨å¹¶è¡Œé«˜æ•ˆ</p><p>å¤åˆ¶ç®—æ³• â€“ STW</p><p><strong>æ˜¯å¦ParNewçš„å¹¶è¡Œæ”¶é›†å°±ä¸€å®šæ¯”Serialä¸²è¡Œå¿«ï¼Ÿ</strong></p><p>â€‹å•CPUç¯å¢ƒä¸‹ï¼ŒParNewå°±æ²¡æœ‰Serialæ”¶é›†å™¨é«˜ï¼Œå› ä¸ºè¿™æ—¶CPUä¸éœ€è¦é¢‘ç¹åœ°åšä»»åŠ¡åˆ‡æ¢ï¼Œå› æ­¤å¯ä»¥æœ‰æ•ˆé¿å…çº¿ç¨‹äº¤äº’è¿‡ç¨‹ä¸­ä¸å¿…è¦å¼€é”€</p><p>-XXL ParallelGCThreadss num é™åˆ¶çº¿ç¨‹æ•°é‡ default å’ŒCPUæ•°æ®ç›¸åŒçš„çº¿ç¨‹</p><h3 id="Parallel">Parallel</h3><p>å¤åˆ¶ã€å¹¶è¡Œã€STW</p><p>å¹´è½»ä»£é‡‡ç”¨å¤åˆ¶ç®—æ³•ï¼Œè€å¹´ä»£é‡‡ç”¨æ ‡è®°-æ•´ç†ï¼Œåœ¨å›æ”¶çš„åŒæ—¶è¿˜ä¼šå¯¹å†…å­˜è¿›è¡Œå‹ç¼©</p><p>ä¸ParNewä¸åŒç‚¹ï¼š</p><ul><li><p>ååé‡ä¼˜å…ˆï¼Œç›®çš„ä¸ºåˆ°è¾¾å¯æ§åˆ¶çš„ååé‡</p></li><li><p>è‡ªé€‚åº”è°ƒèŠ‚ç­–ç•¥</p></li></ul><p>é«˜ååé‡ é«˜æ•ˆåˆ©ç”¨CPUæ—¶é—´ é€‚åˆåœ¨åå°è¿ç®—ä¸éœ€è¦å¤ªå¤šäº¤äº’ã€æœåŠ¡å™¨ä¸­</p><p>JDK1.6 ç”¨Parallel Old æ›¿ä»£äº† è€å¹´ä»£çš„Serial Old</p><p>-XX +UseParallel(Old)GC  äº’ç›¸æ¿€æ´»</p><p>-XXï¼šParallelGCThreads num è®¾ç½®å¹´è½»ä»£å¹¶è¡Œæ”¶é›†å™¨çº¿ç¨‹æ•°</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210322145201261.png" alt="image-20210322145201261"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210322145313728.png" alt="image-20210322145313728"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210322145728931.png" alt="image-20210322145728931"></p><h3 id="CMS">CMS</h3><p>Concurrent Mark Sweep  é’ˆå¯¹è€å¹´ä»£ â€”ParNew</p><p>ä½å»¶è¿Ÿï¼Œç¬¬ä¸€æ¬¡å®ç°äº†è®©åƒåœ¾æ”¶é›†çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹åŒæ—¶å·¥ä½œ</p><p>å°½å¯èƒ½ç¼©çŸ­åƒåœ¾æ”¶é›†æ—¶ç”¨æˆ·çº¿ç¨‹çš„åœé¡¿æ—¶é—´</p><p>G1 æ•´ä½“ä¸Šé‡‡ç”¨æ ‡è®°-æ•´ç†ç®—æ³•ï¼Œå±€éƒ¨æ˜¯é€šè¿‡å¤åˆ¶ç®—æ³•ï¼Œä¸ä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡ã€‚</p><p>åƒåœ¾æ”¶é›†ç®—æ³•é‡‡ç”¨æ ‡è®°-æ¸…é™¤ç®—æ³•</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210324080947878.png" alt="image-20210324080947878"></p><ul><li>åˆå§‹æ ‡è®° ï¼šSTW æ ‡è®°GC Roots <strong>ç›´æ¥</strong>å…³è”åˆ°çš„å¯¹è±¡</li><li>å¹¶å‘æ ‡è®°ï¼šä»ç›´æ¥å…³è”å¯¹è±¡å¼€å§‹éå†æ•´ä¸ªå¯¹è±¡å›¾çš„è¿‡ç¨‹ï¼Œé‡Šæ”¾å†…å­˜ç©ºé—´ï¼Œä¸ç”¨æˆ·çº¿ç¨‹åŒæ—¶è¿è¡Œ</li><li>é‡æ–°æ ‡è®°ï¼šSTW ä¿®æ•´å¹¶å‘æ ‡è®°æœŸé—´ï¼Œæ ‡è®°äº§ç”Ÿå˜åŠ¨çš„å¯¹è±¡ã€‚æ—¶é—´ç¨çŸ­</li><li>å¹¶å‘æ¸…é™¤ï¼šæ¸…ç†åˆ æ‰æ ‡è®°é˜¶æ®µåˆ¤æ–­çš„å·²ç»æ­»äº¡çš„å¯¹è±¡ï¼Œé‡Šæ”¾å†…å­˜ç©ºé—´ã€</li></ul><p>å¹¶å‘æ—¶æœŸï¼Œè¦ç¡®ä¿ç¨‹åºç”¨æˆ·çº¿ç¨‹æœ‰è¶³å¤Ÿçš„å†…å­˜å¯ä»¥ç”¨ã€‚å› æ­¤CMSæ”¶é›†å™¨ä¸èƒ½åƒå…¶ä»–æ”¶é›†å™¨é‚£æ ·ç­‰åˆ°è€è™å¹´ä»£å‡ ä¹è¢«å¡«æ»¡å†å›æ”¶ã€‚å½“å †å†…å­˜ä½¿ç”¨ç‡è¾¾åˆ°ä¸€å®šé˜ˆå€¼ï¼Œä¾¿å¼€å§‹å›æ”¶ï¼Œç¡®ä¿åº”ç”¨ç¨‹åºåœ¨CMSå·¥ä½œè¿‡ç¨‹ä¸­ï¼Œä¾ç„¶æœ‰è¶³å¤Ÿçš„æ§ä»¶æ”¯æŒåº”ç”¨ç¨‹åºè¿è¡Œã€‚å¦‚æœCMSè¿è¡ŒæœŸé—´é¢„ç•™çš„å†…å­˜æ— æ³•æ»¡è¶³ç¨‹åºéœ€è¦ï¼Œå°±ä¼šå‡ºç°ä¸€æ¬¡Concurrent Mode Failureå¤±è´¥ï¼ŒJVMå¯åŠ¨åå¤‡æ–¹æ¡ˆï¼Œç”¨Serial Oldæ”¶é›†å™¨é‡æ–°è¿›è¡Œè€å¹´ä»£çš„åƒåœ¾æ”¶é›†ï¼Œåœé¡¿æ—¶é—´é•¿</p><p>ç¼ºç‚¹ï¼š</p><ul><li>æ ‡è®°æ¸…é™¤ç®—æ³•ï¼Œäº§ç”Ÿç¢ç‰‡ï¼Œåªèƒ½é€‰æ‹©ç©ºé—²åˆ—è¡¨æ‰§è¡Œå†…å­˜åˆ†é…ï¼Œä¸èƒ½æ”¾å…¥å¤§å¯¹è±¡</li><li>å¯¹CPUèµ„æºæ•æ„Ÿï¼Œå¹¶å‘æ—¶å ç”¨ä¸€éƒ¨åˆ†çº¿ç¨‹ï¼Œæ€»ååé‡é™ä½</li><li>æ— æ³•å¤„ç†<strong>æµ®åŠ¨åƒåœ¾</strong>ï¼šç”¨æˆ·çº¿ç¨‹äº§ç”Ÿæ–°çš„åƒåœ¾ï¼Œå¹¶å‘æ ‡è®°æ—¶äº§ç”Ÿçš„åƒåœ¾æ— æ³•è¢«æ ‡è®°ï¼ˆæ³¨æ„ é‡æ–°æ ‡è®°æ˜¯ä¿®æˆå¹¶å‘æ ‡è®°å·²æ ‡è®°çš„å¯¹è±¡ï¼Œå³å·²ç»æ˜¯åƒåœ¾çš„å¯èƒ½åˆä¸æ˜¯åƒåœ¾äº†[ä¿é™©æ“ä½œ]ï¼‰</li></ul><p><strong>ä¸ºä»€ä¹ˆä¸æ¢æˆMark Compactï¼Ÿ</strong></p><p>å‹ç¼©æ—¶ä¼šå¯¹å†…å­˜è¿›è¡Œæ•´ç†ï¼Œä½†æ˜¯æ¸…ç†çš„æ—¶å€™æ˜¯å¹¶å‘æ‰§è¡Œçš„ï¼Œä¸èƒ½æ”¹å˜ä½¿ç”¨å¯¹è±¡çš„åœ°å€</p><p>JDK9 åºŸå¼ƒ   JDK14 å·²ç»æŠŠCMSç§»é™¤äº†</p><p>-XXï¼š+UseConcMarkSweepGC æ‰‹åŠ¨æŒ‡å®šä½¿ç”¨CMS</p><p>-XX: CMSlinitialtingOccupanyFraction  è®¾ç½®å †å†…å­˜ä½¿ç”¨ç‡é˜ˆå€¼  é»˜è®¤ 92</p><h3 id="G1">G1</h3><p>åŒºåŸŸåŒ–åˆ†ä»£å¼</p><p>JDK 9 å¼€å§‹é‡‡ç”¨ï¼Œé¢å‘æœåŠ¡ç«¯åº”ç”¨</p><p>é€‚åº”ä¸æ–­æ‰©å¤§çš„å†…å­˜å’Œä¸æ–­å¢åŠ çš„å¤„ç†å™¨æ•°é‡  é™ä½æš‚åœæ—¶é—´ä¸”å…¼é¡¾è‰¯å¥½çš„ååé‡</p><p><strong>ä¸ºä»€ä¹ˆ å«G1?</strong></p><p>â€‹å¹¶è¡Œæ”¶é›†å™¨ï¼Œåˆ’åˆ†å †å†…å­˜  ï¼Œä½¿ç”¨ä¸åŒRegionè¡¨ç¤ºEden Survivorws Old Genç­‰</p><p>åƒåœ¾ä¼˜å…ˆï¼š</p><p>â€‹G1 GC æœ‰è®¡ åˆ’é¿å…äº†è¿™ä¸ªå †ä¸­è¿›è¡Œå…¨åŒºåŸŸçš„åƒåœ¾å›æ”¶ï¼Œè·Ÿè¸ªä¸åŒçš„Regionåƒåœ¾å †ç§¯çš„ä»·å€¼å¤§å°ï¼Œå›æ”¶æ‰€è·å¾—çš„ç©ºé—´å¤§å°ä¸å›æ”¶æ‰€éœ€æ—¶é—´çš„ç»éªŒå€¼ã€‚  ç»´æŠ¤ä¸€ä¸ªä¼˜å…ˆåˆ—è¡¨ï¼Œæ ¹æ®å…è®¸çš„æ”¶é›†æ—¶é—´ï¼Œä¼˜å…ˆå›æ”¶ä»·å€¼æœ€å¤§çš„Region</p><p><strong>ç‰¹ç‚¹ï¼š</strong></p><ol><li><p>å¹¶è¡Œå¹¶å‘å…¼å…·ï¼š</p><p>æœ‰å¤šä¸ªGCçº¿ç¨‹å·¥ä½œï¼Œåˆ©ç”¨å¤šæ ¸  STW</p><p>èƒ½å¤Ÿä¸åº”ç”¨ç¨‹åºäº¤æ›¿æ‰§è¡Œï¼Œä¸ä¼šSTW</p></li><li><p>åˆ†ä»£æ”¶é›†ï¼š</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210324084815558.png" alt="image-20210324084815558"></p><p>å †ç©ºé—´åˆ†æˆè‹¥å¹²Regionï¼Œå¯ä»¥ä¸è¿ç»­è€Œä¸”æ¯ä¸ªå°åŒºåŸŸçš„è§’è‰²æ˜¯å¯ä»¥å˜æ¢çš„ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</p><p>G1åŒæ—¶å…¼é¡¾è€å¹´ä»£å’Œå¹´è½»ä»£ã€‚</p></li><li><p>ç©ºé—´æ•´åˆï¼š</p><p>å†…å­˜å›æ”¶ä»¥regionä¸ºåŸºæœ¬å•ä½ï¼Œregionä¹‹é—´æ˜¯å¤åˆ¶ç®—æ³•ï¼Œä½†æ•´ä½“å¯ä»¥çœ‹æˆæ˜¯Mark Compactç®—æ³•ï¼ˆå› ä¸ºåˆ†regionï¼‰ã€‚æœ‰åˆ©äºç¨‹åºé•¿æ—¶é—´è¿è¡Œ</p></li><li><p>å¯é¢„æµ‹çš„åœé¡¿æ—¶é—´æ¨¡å‹(è½¯å®æ—¶ Soft Real-Time)</p><p>è®©ä½¿ç”¨è€…æ˜ç¡®æŒ‡å®šåœ¨é•¿åº¦ä¸ºM msæ—¶é—´æ®µå†…ï¼Œæ¶ˆè€—åœ¨åƒåœ¾æ”¶é›†ä¸Šçš„æ—¶é—´ä¸å¾—è¶…è¿‡N ms  â€“ å°½å¯èƒ½</p><p>æ ¹æ®å…è®¸çš„æ”¶é›†æ—¶é—´ï¼Œä¼˜å…ˆå›æ”¶ä»·å€¼é«˜çš„region    æ”¶é›†æ•ˆç‡é«˜</p></li></ol><p>JVM GCçº¿ç¨‹å¤„ç†é€Ÿåº¦æ…¢æ—¶ï¼Œç³»ç»Ÿä¼šè°ƒç”¨åº”ç”¨ç¨‹åºçº¿ç¨‹å¸®åŠ©åŠ é€Ÿåƒåœ¾å›æ”¶è¿‡ç¨‹</p><p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p><p>æœåŠ¡ç«¯ï¼Œå¤§å†…å­˜ï¼Œå¤šå¤„ç†å™¨</p><p>50%Javaå †æ´»åŠ¨æ•°æ®å ç”¨ã€å¯¹è±¡åˆ†é…é¢‘ç‡æˆ–å¹´ä»£æå‡é¢‘ç‡å˜åŒ–å¤§ã€GCåœé¡¿æ—¶é—´é•¿</p><p><strong>åˆ†åŒºRegion</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210324091225275.png" alt="image-20210324091225275"></p><p>åˆ’åˆ†æ•´ä¸ªå †ä¸º2048ä¸ªå¤§å°ç›¸åŒçš„ç‹¬ç«‹Region æ¯ä¸ªregionæ§åˆ¶åœ¨1 - 32 M ä¹‹é—´ï¼Œæ¯ä¸ªregionå¤§å°ç›¸åŒï¼Œåœ¨JVMç”Ÿå‘½å‘¨æœŸå†…ä¸ä¼šè¢«æ”¹å˜ã€‚æ–°ç”Ÿä»£å’Œè€å¹´ä»£é€šè¿‡regionçš„åŠ¨æ€åˆ†é…å®ç°é€»è¾‘ä¸Šçš„è¿ç»­</p><p>G1è¿˜å¢åŠ äº†æ–°çš„å†…å­˜åŒºåŸŸ  Humonogous å­˜å‚¨å¤§å¯¹è±¡ã€‚å› ä¸ºå°†ä¸€ä¸ªçŸ­æœŸå­˜åœ¨çš„å¤§å¯¹è±¡æ”¾å…¥è€å¹´ä»£ï¼Œä¼šå¯¹åƒåœ¾æ”¶é›†å™¨é€ æˆå½±å“ã€‚å¦‚æœå•ä¸ªHåŒºè£…ä¸ä¸‹ä¸€ä¸ªå¤§å¯¹è±¡ï¼Œä¼šæ‰¾ä¸€ä¸ªè¿ç»­çš„HåŒºå­˜å‚¨ï¼Œå¦‚æœè¿˜æ‰¾ä¸åˆ°å°±Full GCäº†  ï¼Œå¯å°†HåŒºçœ‹åšè€å¹´ä»£ä½†ä¸å®Œå…¨ç›¸ç­‰</p><p>å¯¹å•ä¸ªRegion  åˆ†é…è§„åˆ™ç±»ä¼¼æŒ‡é’ˆç¢°æ’ï¼Œä¹Ÿå¯ä»¥åœ¨regionä¸­ç»™å•ä¸ªçº¿ç¨‹åˆ†é…TLAB</p><p>å†…å­˜å ç”¨ã€é¢å¤–æ‰§è¡Œè´Ÿè½½ æ¯”CMSé«˜      ï¼ˆè®°å¿†é›†ï¼‰</p><p>å°å†…å­˜åº”ç”¨ä¸Š CMSä¼˜äº G1  å¤§å†…å­˜G1æ›´ä¼˜</p><p><strong>å‚æ•°ï¼š</strong></p><p>-XX:+UseG1GC</p><p>-XX:G1HeapRegionSize region  num   å¤§å°ï¼Œ2çš„ num æ¬¡æ–¹ï¼ŒèŒƒå›´æ˜¯1m â€” 32m</p><p>â€“XX:MaxGCPauseMills è®¾ç½®æœŸæœ›çš„æœ€å¤§GCåœé¡¿æ—¶é—´   é»˜è®¤ 200ms</p><p>-XX ParallelGCThread  STWå·¥ä½œçº¿ç¨‹æ•°ï¼Œæœ€å¤š 8</p><p>-XX ConcGCThreads è®¾ç½®å¹¶å‘æ ‡è®°çš„çº¿ç¨‹æ•°   nè®¾ç½®ä¸ºå¹¶è¡Œåƒåœ¾æ”¶é›†çº¿ç¨‹æ•°çš„1/4å·¦å³</p><p>-XX InitiaingHeapOccupancyPercent  è§¦å‘å¹¶å‘GCå‘¨æœŸçš„Javaå †å ç”¨é˜ˆå€¼ï¼Œè¶…è¿‡æ­¤å€¼ è§¦å‘ GCï¼Œé»˜è®¤45</p><p>â€‹<strong>åƒåœ¾å›æ”¶è¿‡ç¨‹</strong></p><ol><li><p>YoungGC</p></li><li><p>è€å¹´ä»£å¹¶å‘æ ‡è®°è¿‡ç¨‹concurrent Marking</p></li><li><p>Mixed GC</p></li><li><p>å¦‚æœéœ€è¦ï¼ŒFull GCè¿˜æ˜¯å­˜åœ¨çš„ï¼Œæä¾›ä¸€ç§å¤±è´¥ä¿æŠ¤æœºåˆ¶ï¼Œå¼ºåŠ›å›æ”¶  â€” å•çº¿ç¨‹ã€ç‹¬å å¼ã€é«˜å¼ºåº¦</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210326155145913.png" alt="image-20210326155145913"></p></li></ol><h4 id="RemeberedSet-è®°å¿†é›†">RemeberedSet è®°å¿†é›†</h4><ul><li>ä¸€ä¸ªå¯¹è±¡å¯èƒ½è¢«ä¸åŒåŒºåŸŸçš„å¯¹è±¡å¼•ç”¨  OldåŒº å¼•ç”¨äº† EdenåŒº ã€‚åˆ¤æ–­å¯¹è±¡æ˜¯å¦å­˜æ´»ï¼Œæ˜¯å¦è¦æ‰«å–µæ•´ä¸ªå †ï¼Ÿ</li><li>å›æ”¶æ–°ç”Ÿä»£ï¼Œä¸å¾—ä¸æ‰«æè€å¹´ä»£ ï¼Œ é™ä½Minor GCæ•ˆç‡</li></ul><p>è§£å†³</p><ul><li>ä½¿ç”¨RemberedSetè¿›è¡Œå…¨å±€æ‰«æ</li><li><strong>æ¯ä¸ªRegionéƒ½æœ‰ä¸€ä¸ªRemebered Set</strong></li><li>æ¯æ¬¡å¼•ç”¨ç±»å‹æ•°æ®è¿›è¡Œå†™æ“ä½œæ—¶ï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ªWrite Barrier  ï¼ˆå†™å±éšœï¼‰ ä¸­æ–­ ï¼Œ æ£€æŸ¥è¦å†™å…¥çš„å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡æ˜¯å¦å’Œè¯¥å¼•ç”¨ç±»å‹æ•°æ®åœ¨ä¸åŒçš„region</li><li>å¦‚æœä¸åŒï¼Œé€šè¿‡CardTableæŠŠç›¸å…³å¼•ç”¨ä¿¡æ¯è®°å½•åˆ°å¼•ç”¨æŒ‡å‘å¯¹è±¡æ‰€åœ¨regionå¯¹åº”çš„RS ä¸­(æœ¬ä½“)</li><li>è¿›è¡Œåƒåœ¾æ”¶é›†æ—¶ï¼Œåœ¨GCæ ¹èŠ‚ç‚¹çš„æšä¸¾èŒƒå›´åŠ å…¥RSï¼Œä¿è¯ä¸è¿›è¡Œå…¨å±€æ‰«æä¹Ÿä¸ä¼šæœ‰é—æ¼</li></ul><h4 id="å›æ”¶å…·ä½“è¿‡ç¨‹">å›æ”¶å…·ä½“è¿‡ç¨‹</h4><p><strong>YoungGC</strong></p><p>Edenç©ºé—´ï¼ŒG1è§¦å‘YoungGC  åªå›æ”¶Eden SurvivoråŒº</p><p>YoungGC é¦–å…ˆG1åœæ­¢STW ï¼ŒG1åˆ›å»ºå›æ”¶é›† CS ï¼Œå³éœ€è¦èƒŒå›æ”¶çš„å†…å­˜åˆ†æ®µé›†åˆï¼ŒYoungGC çš„ CSåŒ…å«EdenåŒºå’ŒSurvivorã€åŒºçš„æ‰€æœ‰å†…å­˜åˆ†æ®µ</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210326161642195.png" alt="image-20210326161642195"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210326162531425.png" alt="image-20210326162531425"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210326162602055.png" alt="image-20210326162602055"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210326164133102.png" alt="image-20210326164133102"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210326164237342.png" alt="image-20210326164237342"></p><p><a href="https://blog.csdn.net/coderlius/article/details/79272773">https://blog.csdn.net/coderlius/article/details/79272773</a></p><h1>æ·±å…¥ç¯‡</h1><h2 id="å­—èŠ‚ç ">å­—èŠ‚ç </h2><h3 id="ç¼–è¯‘">ç¼–è¯‘</h3><p>javacç¼–è¯‘å™¨</p><p>å°†javaæºç ç¼–è¯‘æˆå­—èŠ‚ç çš„å‰ç«¯ç¼–è¯‘å™¨   IDEA é»˜è®¤</p><p>ç±»ä¼¼çš„  ECJ (Eclipse Compiler for Java) ç¼–è¯‘æ•ˆç‡é«˜ï¼Œç¼–è¯‘æ—¶å¹¶éå…¨é‡ç¼–è¯‘ï¼Œåªç¼–è¯‘ä¸ºç¼–è¯‘éƒ¨åˆ†çš„æºç è¿›è¡Œç¼–è¯‘</p><p>Eclipse å’Œ Tomcaté»˜è®¤ä½¿ç”¨</p><h4 id="-v3"></h4><p><span style='color:red;font-size:24px'>Integerçš„è‡ªåŠ¨è£…ç®±</span></p><p>å†…ç½®çš„IntegerCache</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Integer</span> a <span class="token operator">=</span> <span class="token number">127</span><span class="token punctuation">;</span><span class="token class-name">Integer</span> b <span class="token operator">=</span> <span class="token number">127</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a <span class="token operator">==</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//false </span><span class="token comment">//å­—èŠ‚ç  æ¯”è¾ƒæ—¶æ¶‰åŠåˆ°intValueæ–¹æ³•</span><span class="token comment">//newæ—¶æ¶‰åŠvalueOfæ–¹æ³• </span></code></pre></div><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> value<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Integer</span> <span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">>=</span> <span class="token class-name">IntegerCache</span><span class="token punctuation">.</span>low <span class="token operator">&amp;&amp;</span> i <span class="token operator">&lt;=</span> <span class="token class-name">IntegerCache</span><span class="token punctuation">.</span>high<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token class-name">IntegerCache</span><span class="token punctuation">.</span>cache<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token class-name">IntegerCache</span><span class="token punctuation">.</span>low<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Integer</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">IntegerCache</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> low <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">128</span><span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> high<span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Integer</span> cache<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// high value may be configured by property</span>        <span class="token keyword">int</span> h <span class="token operator">=</span> <span class="token number">127</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> integerCacheHighPropValue <span class="token operator">=</span>            sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span>VM<span class="token punctuation">.</span><span class="token function">getSavedProperty</span><span class="token punctuation">(</span><span class="token string">"java.lang.Integer.IntegerCache.high"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å¯ä»¥è‡ªè¡Œè®¾ç½®maxçš„æœ€å¤§å€¼</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>integerCacheHighPropValue <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>integerCacheHighPropValue<span class="token punctuation">)</span><span class="token punctuation">;</span>                i <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// Maximum array size is Integer.MAX_VALUE</span>                h <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token operator">-</span>low<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span><span class="token punctuation">(</span> <span class="token class-name">NumberFormatException</span> nfe<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">// If the property cannot be parsed into an int, ignore it.</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        high <span class="token operator">=</span> h<span class="token punctuation">;</span>        cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Integer</span><span class="token punctuation">[</span><span class="token punctuation">(</span>high <span class="token operator">-</span> low<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> j <span class="token operator">=</span> low<span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> cache<span class="token punctuation">.</span>length<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span>            cache<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Integer</span><span class="token punctuation">(</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// range [-128, 127] must be interned (JLS7 5.1.7)</span>        <span class="token keyword">assert</span> <span class="token class-name">IntegerCache</span><span class="token punctuation">.</span>high <span class="token operator">>=</span> <span class="token number">127</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token class-name">IntegerCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p>æ¶‰åŠåˆ°çš„é™æ€å†…éƒ¨ç±»çš„çŸ¥è¯†</p><p>é™æ€å†…éƒ¨ç±»åªä¼šåœ¨ä½¿ç”¨åˆ°è¯¥å†…éƒ¨ç±»æ—¶æ‰ä¼šåŠ è½½ï¼Œå¦åˆ™æ˜¯ä¸ä¼šåŠ è½½çš„ï¼Œä¹Ÿå°±æ˜¯åªæœ‰ä½¿ç”¨åˆ°new Integerçš„valueOfæ–¹æ³•æ—¶ï¼Œæ‰ä¼šåŠ è½½è¯¥å†…éƒ¨ç±»</p><h3 id="æ¦‚å¿µ-v6">æ¦‚å¿µ</h3><p>å­—èŠ‚ç æŒ‡ä»¤æ˜¯ä¸€ä¸ªä¸€ä¸ªå­—èŠ‚é•¿åº¦ï¼Œä»£è¡¨æŸç§ç‰¹å®šå«ä¹‰çš„æ“ä½œç ï¼Œä»¥åŠè·Ÿéšå…¶åçš„å‚æ•°â€”æ“ä½œæ•°æ„æˆçš„ã€‚</p><h4 id="Classæ–‡ä»¶">Classæ–‡ä»¶</h4><p>ä¸ä¸€å®šä»¥ç£ç›˜æ–‡ä»¶å½¢å¼å­˜åœ¨ï¼Œæ˜¯ä¸€ç»„ä»¥8å­—èŠ‚ä¸ºåŸºç¡€å•ä½çš„äºŒè¿›åˆ¶æµ</p><p>å­˜å‚¨æ ¼å¼   æ— ç¬¦å·æ•° + è¡¨</p><p>æ— æ³•åŒ…å«æ³¨é‡Šä¿¡æ¯</p><ul><li><p>æ— ç¬¦å·æ•°ï¼š åŸºæœ¬æ•°æ®ç±»å‹   ç”¨u1ã€u2ã€u4.ã€u8â€¦ è¡¨ç¤ºå¤šå°‘ä¸ªå­—èŠ‚çš„æ— ç¬¦å·æ•°</p></li><li><p>è¡¨ï¼š ç”±å¤šä¸ªæ— ç¬¦å·æ•°æˆ–è€…å…¶ä»–è¡¨ä½œä¸ºæ•°æ®é¡¹æ„æˆçš„å¤åˆæ•°æ®ç±»å‹</p><p>è¡¨åˆ_info ç»“å°¾    æ•´ä¸ªclassæ–‡ä»¶å°±æ˜¯ä¸€å¼ è¡¨</p></li></ul><h3 id="Classæ–‡ä»¶ç»“æ„">Classæ–‡ä»¶ç»“æ„</h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210313171015628.png" alt="image-20210313171015628"></p><h4 id="é­”æ•°">é­”æ•°</h4><p>cafebabe  è¯†åˆ«å­—èŠ‚ç æ–‡ä»¶  4ä¸ªå­—èŠ‚çš„æ— ç¬¦å·æ•´æ•°</p><h4 id="Classæ–‡ä»¶ç‰ˆæœ¬">Classæ–‡ä»¶ç‰ˆæœ¬</h4><p>ä¸»ç‰ˆæœ¬ã€å‰¯ç‰ˆæœ¬  â€” ä¾æ®JDK</p><p>å‘ä¸‹å…¼å®¹ï¼š é«˜ç‰ˆæœ¬JVMå¯è¿è¡Œä½ç‰ˆæœ¬JDKç¼–è¯‘å™¨ç”Ÿæˆçš„classæ–‡ä»¶</p><p>UnsupportedClassVersionError</p><h4 id="å¸¸é‡æ± ">å¸¸é‡æ± </h4><p>å­—é¢é‡ä»1å¼€å§‹è€Œä¸æ˜¯ä»0 å¼€å§‹  ä½†æ˜¯è®¡æ•°å™¨ä»0å¼€å§‹è®¡æ•°</p><p>å­˜æ”¾å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ â€” ç±»åŠ è½½æ—¶æ”¾åœ¨æ–¹æ³•åŒºçš„è¿è¡Œæ—¶å¸¸é‡æ± ä¸­</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210315163802015.png" alt="image-20210315163802015"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210315162456278.png" alt="image-20210315162456278"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210315162921696.png" alt="image-20210315162921696"></p><p>è§£æ</p><p>ç¬¬ä¸€ä¸ªå­—èŠ‚æŒ‡å‡ºæ˜¯ä»€ä¹ˆç±»å‹ï¼ˆConstant-utf8_infoä¹‹ç±»çš„ï¼‰ï¼Œç„¶ååœ¨çœ‹å¯¹åº”ç±»å‹ æœ‰ä»€ä¹ˆæ ·çš„å­—èŠ‚ï¼Œå…·ä½“ä¼šä¸ä¸€æ ·</p><h4 id="è®¿é—®æ ‡å¿—">è®¿é—®æ ‡å¿—</h4><h4 id="ç±»ç´¢å¼•ã€çˆ¶ç±»ç´¢å¼•ã€æ¥å£ç´¢å¼•é›†åˆ">ç±»ç´¢å¼•ã€çˆ¶ç±»ç´¢å¼•ã€æ¥å£ç´¢å¼•é›†åˆ</h4><h4 id="å­—æ®µè¡¨é›†åˆ">å­—æ®µè¡¨é›†åˆ</h4><h4 id="æ–¹æ³•è¡¨é›†åˆ">æ–¹æ³•è¡¨é›†åˆ</h4><h4 id="å±æ€§è¡¨é›†åˆ">å±æ€§è¡¨é›†åˆ</h4><h2 id="æŸ¥æ¼è¡¥ç¼ºç¯‡">æŸ¥æ¼è¡¥ç¼ºç¯‡</h2><h3 id="æ‹…ä¿æœºåˆ¶">æ‹…ä¿æœºåˆ¶</h3><p>survivoråŒºè£…ä¸ä¸‹äº†æ€ä¹ˆåŠ</p><h3 id="æ™‹å‡åŸç†">æ™‹å‡åŸç†</h3><p>å¤§å¯¹è±¡æ˜¯å¦‚ä½•åˆ†é…çš„</p><h3 id="String">String</h3><p>String ä½œä¸ºå‚æ•°åœ¨æ–¹æ³•å†…éƒ¨æ”¹å˜ä¸ºä»€ä¹ˆä¸ä¼šæ”¹å˜å®é™…çš„å€¼</p><h3 id="ç±»åŠ è½½æœºåˆ¶">ç±»åŠ è½½æœºåˆ¶</h3><h4 id="ç±»åŠ è½½-v2">ç±»åŠ è½½</h4><p>å°†Javaç±»çš„å­—èŠ‚ç æ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­  å¹¶åœ¨å†…å­˜ä¸­æ„å»ºå‡ºjavaç±»çš„åŸå‹ï¼Œç±»æ¨¡æ¿å¯¹è±¡</p><ul><li><p>é€šè¿‡ç±»çš„å…¨åï¼Œè·å–ç±»çš„äºŒè¿›åˆ¶æ•°æ®æµ</p><p>è·å–æ–¹å¼ï¼š</p><ul><li>classæ–‡ä»¶</li><li>jar zipæ–‡ä»¶</li><li>æ•°æ®åº“ä¸­çš„äºŒè¿›åˆ¶</li><li>httpç½‘ç»œåè®®</li><li>è¿è¡Œæ—¶åŠ¨æ€ç”ŸæˆClassçš„äºŒè¿›åˆ¶ä¿¡æ¯</li></ul></li><li><p>è§£æç±»çš„äºŒè¿›åˆ¶æ•°æ®æµä¸ºæ–¹æ³•åŒºçš„æ•°æ®ç»“æ„  Javaç±»æ¨¡å‹</p></li><li><p>åˆ›å»ºjava.lang.Class ç±»çš„å®ä¾‹ï¼Œè¡¨ç¤ºè¯¥ç±»å‹ï¼Œä½œä¸ºæ–¹æ³•åŒºè¿™ä¸ªç±»çš„å„ç§æ•°æ®çš„è®¿é—®å…¥å£</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210320150701121.png" alt=""></p><p>æ•°ç»„ç±»å‹çš„åŠ è½½ï¼Œæ•°ç»„ç±»æœ¬èº«å¹¶ä¸ç”±ç±»åŠ è½½å™¨è´Ÿè´£åˆ›å»ºã€‚ç”±JVMè¿è¡Œæ—¶æ ¹æ®éœ€è¦ç›´æ¥åˆ›å»ºçš„ï¼Œæ•°ç»„çš„å…ƒç´ ç±»å‹ä»ç„¶éœ€è¦ä¾é ç±»åŠ è½½å™¨åˆ›å»º ï¼Œå¦‚æœæ•°ç»„çš„å…ƒç´ ç±»å‹æ˜¯å¼•ç”¨ç±»å‹ï¼Œåˆ™æ•°ç»„ç±»çš„å¯è®¿é—®æ€§å°±ç”±å…ƒç´ ç±»å‹çš„å¯è®¿é—®æ€§å†³å®šï¼Œç¼ºçœå®šä¹‰ä¸ºpublic</p></li></ul><h4 id="é“¾æ¥">é“¾æ¥</h4><h5 id="éªŒè¯">éªŒè¯</h5><p>ä¿è¯åŠ è½½çš„å­—èŠ‚ç åˆæ³• è§„èŒƒ</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210320151441865.png" alt="image-20210320151441865"></p><p><strong>æ ¼å¼éªŒè¯</strong></p><p>å’ŒåŠ è½½è¿‡ç¨‹ä¸€èµ·è¿›è¡Œï¼ŒéªŒè¯é€šè¿‡åï¼Œç±»åŠ è½½å™¨æ‰ä¼šæˆåŠŸå°†è¯¥ç±»çš„äºŒè¿›åˆ¶æ•°æ®ä¿¡æ¯åŠ è½½åˆ°æ–¹æ³•åŒºä¸­ï¼Œæ ¼å¼éªŒè¯ä¹‹å¤–çš„æ“ä½œåœ¨æ–¹æ³•åŒºä¸­è¿è¡Œ</p><p><strong>è¯­ä¹‰éªŒè¯</strong></p><p>æ˜¯å¦ç´ æœ‰çš„ç±»éƒ½æœ‰çˆ¶ç±»çš„å­˜åœ¨</p><p>æ˜¯å¦ä¸€äº›å®šä¹‰ä¸ºfinalçš„æ–¹æ³•æˆ–è€…ç±»è¢«é‡å†™æˆ–è€…ç»§æ‰¿äº†</p><p>éæŠ½è±¡ç±»æ˜¯å¦å®ç°äº†æ‰€æœ‰æŠ½è±¡æ–¹æ³• æˆ–è€…æ¥å£æ–¹æ³•</p><p>æ˜¯å¦å­˜åœ¨ä¸å…¼å®¹çš„æ–¹æ³•  æ–¹æ³•çš„ç­¾åé™¤äº†è¿”å›å€¼éƒ½ä¸€æ ·çš„æƒ…å†µ</p><p><strong>å­—èŠ‚ç éªŒè¯</strong></p><p>è¾ƒä¸ºå¤æ‚çš„è¿‡ç¨‹</p><p>å­—èŠ‚ç æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ˜¯å¦ä¼šè·³è½¬åˆ°ä¸€æ¡ä¸å­˜åœ¨çš„æŒ‡ä»¤ã€</p><p>å‡½æ•°è°ƒç”¨æ˜¯å¦ä¼ é€’äº†æ­£ç¡®ç±»å‹çš„å‚æ•°</p><p>å˜é‡</p><p>èµ‹å€¼æ˜¯ä¸æ˜¯ç»™äº†æ­£ç¡®çš„æ•°æ®ç±»å‹</p><p>æ ˆæ˜ å°„å¸§  â€“ StackMapTableç”¨äºæ£€æµ‹åœ¨ç‰¹å®šçš„å­—èŠ‚ç å‡ºï¼Œå±€éƒ¨å˜é‡è¡¨å’Œæ“ä½œæ•°æ ˆæ˜¯å¦æœ‰æ­£ç¡®çš„æ•°æ®ä¿¡æ¯</p><p><strong>ç¬¦å·å¼•ç”¨</strong></p><p>æ£€æŸ¥ è‡ªå·±è¦ä½¿ç”¨å…¶ä»–ç±» æˆ–è€…æ–¹æ³• æ˜¯å¦å­˜åœ¨    ï¼ˆåœ¨å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­ï¼‰</p><h5 id="å‡†å¤‡">å‡†å¤‡</h5><p>ä¸ºç±»çš„é™æ€å˜é‡åˆ†é…å†…å­˜</p><p>æ³¨æ„ç‚¹ï¼šjavaå¹¶ä¸æ”¯æŒboolean  å¯¹äºboolean å†…éƒ¨å®ç°æ˜¯intï¼Œé»˜è®¤å€¼æ˜¯0ï¼Œæ•…booleançš„é»˜è®¤å€¼å°±æ˜¯false</p><ul><li>ä¸åŒ…å«åŸºæœ¬æ•°æ®ç±»å‹ç”¨static finalä¿®é¥°çš„æƒ…å†µï¼Œå› ä¸ºfinalåœ¨ç¼–è¯‘æ—¶åˆ†é…ï¼Œä¸”åœ¨å‡†å¤‡é˜¶æ®µä¼šæ˜¾ç¤ºèµ‹å€¼</li><li>éfinalä¿®é¥°çš„å˜é‡ï¼Œè§£æé˜¶æ®µè¿›è¡Œé»˜è®¤åˆå§‹åŒ–èµ‹å€¼ï¼Œfinalä¿®é¥°åï¼Œåœ¨è§£æç¯èŠ‚ç›´æ¥æ˜¾ç¤ºèµ‹å€¼</li><li>finalç±»å˜é‡ä¸èƒ½å£°æ˜ ä½†ä¸å¤åˆ¶</li><li>å¦‚æœä»¥éè‡ªå˜é‡çš„å½¢å¼ åˆå§‹åŒ–static final String ï¼Œä¸ä¼šåƒæœ‰å…·ä½“çš„ä»£ç æ‰§è¡Œ</li></ul><h5 id="è§£æ">è§£æ</h5><p>å°†å¸¸é‡æ± ä¸­ç±»ã€æ¥å£ã€å­—æ®µã€æ–¹æ³•çš„ ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºç›´æ¥å¼•ç”¨  ï¼ˆçœŸå®å†…å­˜ä¸­çš„åœ°å€ï¼‰</p><p>ä¾‹å¦‚ JVMä¸ºæ¯ä¸ªç±»å‡†å¤‡äº†æ–¹æ³•è¡¨ï¼Œ è°ƒç”¨ä¸€ä¸ªç±»çš„æ–¹æ³•æ—¶ï¼Œåªè¦çŸ¥é“è¿™ä¸ªæ–¹æ³•åœ¨æ–¹æ³•è¡¨ä¸­çš„åç§»é‡å°±å¯ä»¥ç›´æ¥è°ƒç”¨è¯¥æ–¹æ³•ã€‚é€šè¿‡è§£ææ“ä½œï¼Œç¬¦å·å¼•ç”¨å°±è½¬å˜ä¸ºç›®æ ‡æ–¹æ³•åœ¨<strong>ç±»ä¸­æ–¹æ³•è¡¨çš„ä½ç½®</strong></p><h4 id="åˆå§‹åŒ–">åˆå§‹åŒ–</h4><p>æ˜¾ç¤ºèµ‹å€¼  è£…è½½çš„æœ€åä¸€ä¸ªé˜¶æ®µ</p><p>æ–¹æ³•çš„è°ƒç”¨ ã€ æ„é€ å™¨çš„æ”¯æŒ  åˆ™åœ¨clinitä¸­è°ƒç”¨</p><p>é‡è¦å·¥ä½œ ï¼š æ‰§è¡Œç±»çš„åˆå§‹åŒ–æ–¹æ³• clinit</p><ul><li><p>è¯¥æ–¹æ³•åªèƒ½ç”±Javaç¼–è¯‘å™¨ ç”Ÿæˆå¹¶ç”±JVMè°ƒç”¨</p></li><li><p>ç”±ç±»é™æ€æˆå‘˜çš„èµ‹å€¼è¯­å¥ä»¥åŠstaticè¯­å¥å—åˆå¹¶äº§ç”Ÿçš„</p></li><li><p>é™æ€çš„ç±»å˜é‡ï¼Œå¦‚æœæ²¡æœ‰æ˜¾ç¤ºèµ‹å€¼ï¼Œåˆ™ä¸ä¼šè°ƒç”¨clinitæ–¹æ³•</p></li><li><p>æ˜¾ç¤ºèµ‹å€¼çš„static final å¸¸é‡ â€“ åœ¨å‡†å¤‡é˜¶æ®µå·²ç»æ˜¾ç¤ºèµ‹å€¼äº†ï¼Œä¸ä¼šè°ƒç”¨clinitæ–¹æ³•</p></li><li><p>å¼•ç”¨æ•°æ®ç±»å‹æ˜¾ç¤ºèµ‹å€¼éƒ½æ˜¯åœ¨åˆå§‹åŒ–é˜¶æ®µï¼ŒåŸºæœ¬ç±»å‹ é€šè¿‡åº“æ–¹æ³•èµ‹å€¼ ä¹Ÿä¼šåœ¨åˆå§‹åŒ–é˜¶æ®µ</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">199</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div></li></ul><h4 id="clinitçš„çº¿ç¨‹å®‰å…¨æ€§">clinitçš„çº¿ç¨‹å®‰å…¨æ€§</h4><p>å¤šçº¿ç¨‹ç¯å¢ƒè¢«æ­£ç¡®çš„åŠ é”ã€åŒæ­¥ ã€‚å¤šçº¿ç¨‹ä¸­å°è¯•åŠ è½½ä¸€ä¸ªç±»ï¼Œæ²¡æŠ¢åˆ°é”çš„ä¼šé˜»å¡ï¼Œè‹¥clnitä¸­æœ‰è€—æ—¶å¾ˆé•¿çš„æ“ä½œï¼Œå¯èƒ½å¼•å‘æ­»é”</p><p>clnitä¸­æ–¹æ³• Access flagsè®¿é—®æ ‡è¯†  æ— synchronized  éšå¼é”</p><h4 id="ç±»çš„ä¸»åŠ¨ä½¿ç”¨å’Œè¢«åŠ¨ä½¿ç”¨-v2">ç±»çš„ä¸»åŠ¨ä½¿ç”¨å’Œè¢«åŠ¨ä½¿ç”¨</h4><p>åŒºåˆ«ï¼š æ˜¯å¦ä¼šè°ƒç”¨clinitæ–¹æ³•</p><p>æ³¨æ„ç‚¹ï¼š <strong>æ²¡æœ‰åˆå§‹åŒ–çš„ç±» ä¸ä¸€å®šæ²¡æœ‰åŠ è½½</strong></p><h5 id="ä¸»åŠ¨ä½¿ç”¨">ä¸»åŠ¨ä½¿ç”¨</h5><ol><li>new ã€åå°„ã€å…‹éš†ã€ååºåˆ—åŒ–</li><li>è°ƒç”¨ç±»çš„é™æ€æ–¹æ³•  inovokestatic</li><li>ä½¿ç”¨ç±»ã€æ¥å£çš„é™æ€å­—æ®µæ—¶<ul><li>å¦‚æœä¸æ˜¯finalï¼Œåˆ™å°±æ˜¯ä¸»åŠ¨ä½¿ç”¨</li><li>å¦‚æœæ˜¯final ç±»å‹ï¼Œ åˆ™å¦‚æœæ˜¯å­—é¢é‡å½¢å¼ï¼Œåˆ™ä¸æ˜¯ä¸»åŠ¨ä½¿ç”¨ï¼Œå¦‚æœæ˜¯å‡½æ•°å½¢å¼ æ¯”å¦‚ a = new Random().nextIntç±»å‹ï¼Œå½“å°è¯•è°ƒç”¨aæ—¶ï¼Œåˆ™æ˜¯ä¸»åŠ¨ä½¿ç”¨ï¼ˆå› ä¸ºå‡½æ•°å½¢å¼çš„èµ‹å€¼éƒ½åœ¨clinitä¸­æ‰§è¡Œï¼‰</li></ul></li><li>Class.forName()</li><li>å­ç±»æ„é€ æ—¶ä¼šå…ˆè¿›è¡Œçˆ¶ç±»çš„åˆå§‹åŒ– -XX traceClassLoad è¾“å‡ºæ‰€æœ‰ç±»åŠ è½½é¡ºåº<ul><li>åˆå§‹åŒ–ç±»æ—¶ï¼Œä¸ä¼šå…ˆåˆå§‹åŒ–ä»–é”å®ç°çš„æ¥å£ï¼Œä½†ä¼šåŠ è½½è¿™ä¸ªæ¥å£Load</li><li>åˆå§‹åŒ–æ¥å£æ—¶ï¼Œä¸ä¼šåˆå§‹åŒ–ä»–çš„çˆ¶æ¥å£ï¼Œä½†æ˜¯ä¹Ÿä¼šåŠ è½½Load</li></ul></li><li>æ¥å£å®šä¹‰äº†defaultæ–¹æ³•ï¼Œç›´æ¥ã€é—´æ¥å®ç°è¯¥æ–¹æ³•æ¥å£çš„ç±»åˆå§‹åŒ–ï¼ˆåªè¦ä½¿ç”¨åˆ°äº†è¿™ä¸ªæ¥å£çš„å­—æ®µæˆ–è€…æ–¹æ³•çš„ï¼‰ éƒ½ä¼šå¯¼è‡´è¿™ä¸ªæ¥å£åœ¨è¿™ä¹‹å‰åˆå§‹åŒ–</li><li>åˆå§‹åŒ–mainæ‰€åœ¨ç±»</li><li>MethodHandle</li></ol><h5 id="è¢«åŠ¨ä½¿ç”¨">è¢«åŠ¨ä½¿ç”¨</h5><ol><li>è®¿é—®é™æ€å­—æ®µï¼Œåªæœ‰çœŸæ­£å£°æ˜è¿™ä¸ªå­—æ®µçš„ç±»æ‰ä¼šè¢«åˆå§‹åŒ–<ul><li>é€šè¿‡å­ç±»å¼•ç”¨çˆ¶ç±»çš„é™æ€å˜é‡ï¼Œä¸ä¼šå¯¼è‡´å­ç±»åˆå§‹åŒ–ï¼Œä½†å­ç±»ä¼šåŠ è½½</li></ul></li><li>å£°æ˜å¯¹è±¡æ•°ç»„ï¼Œä¸å¤åˆ¶ï¼Œä¸ä¼šå¼•èµ·åˆå§‹åŒ–</li><li>å¼•ç”¨å¸¸é‡ä¸ä¼šçš„è§¦å‘ç±»æˆ–è€…æ¥å£çš„åˆå§‹åŒ–  ï¼ˆé“¾æ¥é˜¶æ®µå·²ç»èµ‹å€¼ï¼‰</li><li>ClassLoaderçš„loadClassæ–¹æ³•åŠ è½½ä¸€ä¸ªç±»ï¼Œä¸æ˜¯å¯¹ç±»çš„ä¸»åŠ¨ä½¿ç”¨ï¼Œæ³¨æ„ä¸forNameåŒºåˆ†å¼€</li></ol><h4 id="ç±»å¸è½½-Unloading">ç±»å¸è½½ Unloading</h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210322092551016.png" alt="image-20210322092551016"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210322092757484.png" alt="image-20210322092757484"></p><p>ä¸€ä¸ªç±»ç»“æŸç”Ÿå‘½å‘¨æœŸï¼Œå…³é”®åœ¨äºå…¶Classå¯¹è±¡ ç»“æŸç”Ÿå‘½å‘¨æœŸ</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210322093200611.png" alt="image-20210322093200611"></p><p>ä¸å¤ªå¯èƒ½</p><h3 id="åŠ¨æ€ç»‘å®šä¸é™æ€ç»‘å®š">åŠ¨æ€ç»‘å®šä¸é™æ€ç»‘å®š</h3><p>Javaå¯¹å¯¹è±¡å±æ€§ æ˜¯é™æ€ç»‘å®š ï¼Œæ–¹æ³•æ˜¯åŠ¨æ€ç»‘å®š</p><p><strong>æ ¹æ®fatheråœ¨å †ä¸­å®é™…åˆ›å»ºçš„å¯¹è±¡ç±»å‹Sonæ¥ç¡®å®šf1æ–¹æ³•æ‰€åœ¨çš„ä½ç½®</strong></p><p>è°ƒç”¨è™šæ–¹æ³•æ—¶ï¼ŒJavaé‡‡ç”¨çš„æ˜¯<strong>å»¶è¿Ÿç»‘å®š / åŠ¨æ€åˆ†æ´¾</strong>çš„è¯­ä¹‰ï¼Œæ ¹æ®è¢«è°ƒç”¨å¯¹è±¡ï¼ˆreceiverï¼‰çš„å®é™…ç±»å‹æ¥å†³å®šé€‰æ‹©å“ªä¸ªç‰ˆæœ¬çš„è™šæ–¹æ³•ã€‚</p><p>é‡è½½çš„æ–¹æ³•åœ¨ç¼–è¯‘æ—¶æ ¹æ®å‚æ•°çš„<strong>å£°æ˜ç±»å‹</strong>é™æ€ç»‘å®šåˆ°å…·ä½“æ–¹æ³•ä¸Šï¼Œä¸è¿è¡Œæ—¶è¯¥å‚æ•°çš„å®é™…ç±»å‹æ— å…³</p><p>æ–¹æ³•çš„é‡è½½æ˜¯é™æ€ç¼–è¯‘</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token class-name">Father</span> f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Son</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">new</span> <span class="token class-name">Test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">public</span>  <span class="token keyword">void</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Father</span> father<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>     <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"fatherfather"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">public</span> <span class="token keyword">void</span> get <span class="token punctuation">(</span><span class="token class-name">Son</span> son<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>     <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"sonso3n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></code></pre></div><h3 id="åŒäº²å§”æ´¾æœºåˆ¶-v2">åŒäº²å§”æ´¾æœºåˆ¶</h3><p>JDK  1.2</p><p><strong>ä¼˜ç‚¹</strong></p><ol><li>é¿å…ç±»é‡å¤åŠ è½½ï¼Œç¡®ä¿ç±»çš„å…¨å±€å”¯ä¸€æ€§ â€” GC æœ‰å…³ï¼Ÿ</li><li>å®‰å…¨ï¼Œé¿å…æ„é€ åŒåŒ…çš„æ¶æ„ä»£ç </li></ol><p>æ²™ç®±å®‰å…¨æœºåˆ¶</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210404170719177.png" alt="image-20210404170719177"></p>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>Study</tag>
      
      <tag>JVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Webå­¦ä¹ </title>
    <link href="/2019/08/22/Web%E5%AD%A6%E4%B9%A0/"/>
    <url>/2019/08/22/Web%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1>JAVA WEB çŸ¥è¯†</h1><!-- toc --><hr><h2 id="çŸ¥è¯†å›é¡¾">çŸ¥è¯†å›é¡¾</h2><div class="code-wrapper"><pre class="language-none"><code class="language-none">1. IPï¼š è®¡ç®—æœºåœ¨ç½‘ç»œä¸­çš„å”¯ä¸€æ ‡è¯†2. ç«¯å£å·ï¼š åº”ç”¨ç¨‹åºåœ¨è®¡ç®—æœºä¸­çš„å”¯ä¸€æ ‡è¯† 0~655363. ä¼ è¾“åè®®ï¼š è§„å®šæ•°æ®ä¼ è¾“çš„è§„åˆ™ 1. åŸºç¡€åè®®ï¼š    1. Tcpï¼š å®‰å…¨åè®®ï¼Œä¸‰æ¬¡æ¡æ‰‹ï¼Œé€Ÿåº¦ç¨æ…¢    2. Udpï¼šä¸å®Œå…¨ï¼Œé€Ÿåº¦å¿«</code></pre></div><h2 id="WebæœåŠ¡å™¨è½¯ä»¶">WebæœåŠ¡å™¨è½¯ä»¶</h2><ul><li>æœåŠ¡å™¨ï¼šå®‰è£…äº†æœåŠ¡å™¨è½¯ä»¶çš„è®¡ç®—æœº</li><li>æœåŠ¡å™¨è½¯ä»¶ï¼šæ¥å—ç”¨æˆ·è¯·æ±‚ï¼Œå¤„ç†è¯·æ±‚ï¼Œåšå‡ºå“åº”</li><li>WebæœåŠ¡å™¨è½¯ä»¶ï¼šç»“æŸåç”¨æˆ·è¯·æ±‚ï¼Œå¤„ç†è¯·æ±‚ï¼Œä½œå‡ºå“åº”<ul><li>webæœåŠ¡å™¨è½¯ä»¶ï¼Œå¯ä»¥éƒ¨ç½²webé¡¹ç›®ï¼Œç”¨æˆ·é€šè¿‡æµè§ˆå™¨æ¥è®¿é—®é¡¹ç›®</li><li>webå®¹å™¨</li></ul></li></ul><span id="more"></span><h2 id="Tomcat">Tomcat</h2><h3 id="ç›®å½•ç»“æ„">ç›®å½•ç»“æ„</h3><ol><li>bin ï¼š å¯æ‰§è¡Œæ–‡ä»¶</li><li>confï¼šé…ç½®æ–‡ä»¶</li><li>libï¼šå¯åŠ¨ä¾èµ–çš„jaråŒ…</li><li>logsï¼š æ—¥å¿—æ–‡ä»¶</li><li>tempï¼šä¸´æ—¶æ–‡ä»¶</li><li><strong>webapps</strong>ï¼šæ”¾å…¥webé¡¹ç›®æ–‡ä»¶</li><li>workï¼šå­˜æ”¾è¿è¡Œæ—¶æ•°æ®</li></ol><h3 id="è¿è¡Œ">è¿è¡Œ</h3><ol><li><p>å¯åŠ¨æ–¹å¼ï¼š binâ€“startup.bat</p></li><li><p>æŸ¥æ‰¾ï¼š</p><ol><li>127.0.0.1:8080</li><li>localhost:8080</li><li>è‡ªå·±çš„ip:8080</li></ol></li><li><p>ä¿®æ”¹ç«¯å£å·ï¼š confâ€“server.xml----â€œportâ€</p></li><li><p>å…³é—­ï¼š</p><ol><li>æ­£å¸¸å…³é—­ï¼š<ul><li>shutdown.bat</li><li>ctrl+c(å‘½ä»¤è¡Œä¸­)</li></ul></li><li>å¼ºåˆ¶å…³é—­ï¼š<ul><li>ç›´æ¥å…³é—­.batçª—å£ï¼Œå¯èƒ½é€ æˆæ–‡ä»¶æŸå¤±ã€æœªä¿å­˜</li></ul></li></ol></li><li><p>éƒ¨ç½²ï¼š</p><ol><li><p>ç›´æ¥æ”¾é¡¹ç›®è¿›å…¥webapps ï¼ˆ/é¡¹ç›®æ–‡ä»¶å¤¹/htmlï¼‰</p></li><li><p>ç®€å•éƒ¨ç½²ï¼š</p><ol><li>ç›´æ¥å°†htmlç”¨waræ‰“åŒ…è½¯ä»¶æˆ.waræ ¼å¼</li><li>ç›´æ¥å¤åˆ¶åˆ°webapps ä¸­</li><li>waråŒ…è‡ªåŠ¨è§£å‹ç¼©</li></ol></li><li><p>é…ç½®conf/serveræ–‡ä»¶</p><ul><li><p>&lt;HOST</p><p>&lt;Context docbase=â€œxxxâ€ path=&quot;/xxxx &quot;å³æ›¿æ¢ä¸ºxxxx</p></li></ul></li><li><p>conf-Catalina-Localhost -åˆ›å»ºxmlæ–‡ä»¶ï¼Œå¤åˆ¶3ä¸­çš„ä»£ç </p><p>â€‹<Context docbase="xxx " />å³å¯</p><p>è™šæ‹Ÿç›®å½•ï¼š xmlæ–‡ä»¶çš„åç§°  (æ¨è)ï¼ˆä¸éœ€è¦é‡å¯æœåŠ¡å™¨ï¼‰</p></li></ol></li></ol><h3 id="é™æ€é¡¹ç›®ä¸åŠ¨æ€é¡¹ç›®">é™æ€é¡¹ç›®ä¸åŠ¨æ€é¡¹ç›®</h3><p>åŠ¨æ€é¡¹ç›®ï¼š</p><ul><li>web-inf<ul><li>web.xml é¡¹ç›®çš„æ ¸å¿ƒé…ç½®æ–‡ä»¶</li><li>calssesç›®å½•ï¼šå­—èŠ‚ç æ–‡ä»¶</li><li>libï¼šä¾èµ–çš„jaråŒ…</li></ul></li></ul><h3 id="ç”¨IEDA-é…ç½®TOMCAT">ç”¨IEDA é…ç½®TOMCAT</h3><h2 id="Servlet">Servlet</h2><ul><li><p>æ¦‚å¿µï¼šè¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„å°ç¨‹åº</p><ul><li>å…¶å®å°±æ˜¯ä¸€ä¸ªå€Ÿå£ï¼Œå®šä¹‰äº† javaç±»è¢«æµè§ˆå™¨è®¿é—®åˆ°çš„è§„åˆ™</li></ul></li><li><p>å®é™…æ“ä½œï¼š</p><ol><li>åˆ›å»ºjava EEé¡¹ç›®</li><li>å†™å…¥servletåŒ…</li><li>åˆ›å»ºç±» å®ç° servletæ¥å£</li><li>é…ç½®servlet â€”äº web.xmlä¸­é…ç½®servlet</li></ol></li><li><div class="code-wrapper"><pre><code class="language-xml"> &lt;servlet&gt;        &lt;servlet-name&gt;demo_1&lt;/servlet-name&gt;        &lt;servlet-class&gt;Servelet.Myservlet_1&lt;/servlet-class&gt;    &lt;/servlet&gt;      &lt;servlet-mapping&gt;        &lt;servlet-name&gt;demo_1&lt;/servlet-name&gt;        &lt;url-pattern&gt;/urldemo_1&lt;/url-pattern&gt;    &lt;/servlet-mapping&gt;<pre class="language-none"><code class="language-none">  1. å…ˆé€šè¿‡urlpattern åˆ¤æ–­ åœ°å€æ˜¯å¦å’Œè¾“å…¥ç›¸ç­‰  2. ç›¸ç­‰åˆ™ä¸Šç§»ï¼Œæ‰¾åˆ°servelet-name  3. servlet-name å†æ‰¾åˆ°servlet  4. servletå†ä¸‹ç§»åˆ°servet-class  5. åŠ è½½ç±»è¿›å…¥å†…å­˜ Class.forname....  6. åˆ›é€ ç±»å¯¹è±¡   getInstance()  7. å®ç°æ–¹æ³•### Servlet ç”Ÿå‘½å‘¨æœŸ1. init() Servletè¢«åˆ›å»ºæ—¶æ‰§è¡Œ ä¸€æ¬¡   * å¯ä»¥é€šè¿‡åœ¨&lt;servlet&gt;æ ‡ç­¾ä¸‹é…ç½®æ”¹å˜ servletçš„åˆ›å»ºæ—¶æœº   * &lt;load -on-startup&gt; x&lt;&#x2F;load -on-startup&gt;   * x: è´Ÿæ•°  ï¼š ç¬¬ä¸€æ¬¡è¢«è®¿é—®æ—¶   * x: 0æˆ–æ­£æ•´æ•°   ï¼šæœåŠ¡å™¨å¯åŠ¨æ—¶2. service() æ¯ä¸€æ¬¡Servletè¢«è®¿é—®æ—¶æ‰§è¡Œï¼ˆé¡µé¢çš„åˆ·æ–°ï¼‰ å¤šæ¬¡3. destroy() Servletè¢«å…³é—­æ—¶æ‰§è¡Œ  ä¸€æ¬¡   * æ¡ä»¶ï¼š æœåŠ¡å™¨**æ­£å¸¸å…³é—­** (ä¸´ç»ˆé—è¨€)### Servlet 3.01. å¥½å¤„ï¼š æ”¯æŒæ³¨è§£é…ç½®ï¼Œä¸ç”¨xml2. å…³é”®æ­¥éª¤ï¼š **ç±»ä¸Šä½¿ç”¨@Servletæ³¨è§£**ï¼Œå¯ä»¥ä¸ç”¨web.xml### Servlet ä½“ç³»ç»“æ„1. Servlet 2. GenericServlet   * æŠ½è±¡ç±» ä¸ç”¨å°†Servletæ¥å£ç±»çš„æ–¹æ³•å®Œå…¨å®ç°ã€‚å…¶ä»–æ–¹æ³•ä¸ºç©ºå®ç°ï¼Œæ›´ç®€æ´ ä¸€ç‚¹ï¼Œ ä¸€èˆ¬è¿˜æ˜¯ä¸ç”¨3. HttpServlet   * å°è£…ç±»ï¼Œæ¯”è¾ƒå¸¸ç”¨ï¼Œä¸ç”¨å†åˆ¤æ–­è¯·æ±‚æ–¹å¼æ˜¯GET&#x2F;POST   * å¤å†™ doGet &#x2F;doPost æ–¹æ³•   ä¸€ä¸ªServletèƒ½å¤Ÿå®šä¹‰å¤šä¸ªè®¿é—®è·¯å¾„4.  å®šä¹‰æ–¹å¼ï¼š    * &#x2F;user   è·¯å¾„åŒ¹é…   * &#x2F;user&#x2F;aaa  å¤šå±‚è·¯å¾„   * &#x2F;user&#x2F;* ï¼šå“ªç§éƒ½å¯ä»¥è®¿é—®åˆ°   * *.do  ï¼š å‰é¢åŠ ä»€ä¹ˆéƒ½å¯ä»¥ï¼Œåé¢å¿…é¡»è·Ÿdo   æ‰©å±•ååŒ¹é…## HTTP è¶…æ–‡æœ¬ä¼ è¾“### **1. Hyper Text Translation Protocol*** ç›®çš„ï¼š å®šä¹‰äº†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨é€šä¿¡æ—¶ï¼Œå‘é€çš„æ•°æ®æ ¼å¼* ç‰¹ç‚¹ï¼š   1. åŸºäºTCP&#x2F;IPçš„é«˜çº§åè®®  2. é»˜è®¤ç«¯å£å· ï¼š80  3. åŸºäºå“åº”å’Œè¯·æ±‚ä¸€ä¸€å¯¹åº”çš„æ¨¡å¼  4. æ— çŠ¶æ€çš„ï¼š æ¯æ¬¡è¯·æ±‚é—´ç›¸äº’ç‹¬ç«‹ï¼Œæ¯æ¬¡è¯·æ±‚ä¸€ä¸ªèµ„æºéƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œåˆ†æ­¥è¿›è¡Œçš„* å†å²ç‰ˆæœ¬ï¼š  * 1.0 æ¯ä¸€æ¬¡ è¯·æ±‚éƒ½ä¼šé‡æ–°å»ºç«‹é“¾æ¥  * 1.1 å¤ç”¨äº†é“¾æ¥ï¼ŒèŠ‚çº¦èµ„æº### 2. è¯·æ±‚æ¶ˆæ¯æ•°æ®æ ¼å¼1. è¯·æ±‚è¡Œ   * è¯·æ±‚æ–¹å¼ è¯·æ±‚url è¯·æ±‚åè®®&#x2F;ç‰ˆæœ¬      (GET&#x2F; login.html HTTP&#x2F;1.1)     * GETï¼š        1. è¯·æ±‚å‚æ•°åœ¨è¯·æ±‚è¡Œä¸­       2. è¯·æ±‚urlé•¿åº¦æœ‰é™       3. ä¸å¤ªå®‰å…¨     * POST:        1. è¯·æ±‚å‚æ•°åœ¨è¯·æ±‚ä½“ä¸­ï¼ˆä¸“é—¨å°è£…äº†ï¼‰       2. è¯·æ±‚urlé•¿åº¦æ— é™       3. ç›¸å¯¹å®‰å…¨2. è¯·æ±‚å¤´ ï¼š æµè§ˆå™¨å‘Šè¯‰æœåŠ¡å™¨çš„ä¿¡æ¯   * è¯·æ±‚å¤´åç§°ï¼š è¯·æ±‚å¤´å€¼ï¼ˆé”®å€¼å¯¹ï¼‰     å¸¸è§çš„è¯·æ±‚å¤´:     * User-Agent: æµè§ˆå™¨å‘Šè¯‰æœåŠ¡å™¨ï¼Œæ‰€ä½¿ç”¨çš„çš„æµè§ˆå™¨ç‰ˆæœ¬ä¿¡æ¯ï¼Œè§£å†³æµè§ˆå™¨å…¼å®¹é—®é¢˜  åŒ…å«æµè§ˆå™¨çš„å…³é”®å­—ï¼ˆChrom Firfox......ï¼‰      * Accept: è§£æä»€ä¹ˆæ ·æ ¼å¼çš„é¡µé¢     * ......     * Refererï¼šå‘Šè¯‰æœåŠ¡å™¨  å½“å‰è¯·æ±‚ä»å“ªé‡Œæ¥ ï¼ˆé˜²æ­¢ç›—å–è¿æ¥ã€ä¾¿äºç»Ÿè®¡å·¥ä½œï¼‰       * ç›—å–è¶…é“¾æ¥ï¼šrefereræ¥åˆ¤æ–­å½“å‰è¯·æ±‚è¿æ¥æ˜¯å¦åœ¨æŒ‡å®šç½‘ç«™ è·å–è€Œæ¥       * ç»Ÿè®¡å·¥ä½œï¼š     * Connection: è¿æ¥æ˜¯å¦èƒ½è¢«å¤ç”¨3. è¯·æ±‚ç©ºè¡Œ   * ç©ºè¡Œ4. è¯·æ±‚ä½“ï¼ˆæ­£æ–‡ï¼‰ï¼š   * å°è£…postè¯·æ±‚å°å¿ƒçš„è¯·æ±‚å‚æ•°  ä¾‹å¦‚ï¼š     username&#x3D;111;   1. ä»æµå¯¹è±¡ä¸­æ‹¿å»æ•°æ®</code></pre></div></code></pre></li></ul><p>GET /Tomcat_2_war_exploded/index2.html HTTP/1.1<br>Host: localhost:8080<br>Connection: keep-alive<br>Cache-Control: max-age=0<br>Upgrade-Insecure-Requests: 1<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,<em>/</em>;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Sec-Fetch-Site: none<br>Sec-Fetch-Mode: navigate<br>Sec-Fetch-User: ?1<br>Sec-Fetch-Dest: document<br>Accept-Encoding: gzip, deflate, br<br>Accept-Language: zh-CN,zh;q=0.9<br>Cookie: JSESSIONID=1B454411C9ADDC7AAFFE3D5BF306E302</p><div class="code-wrapper"><pre class="language-none"><code class="language-none">### 3. Request 1. åŸç†   1. Request Responseå¯¹è±¡ å‡ç”±æœåŠ¡å™¨åˆ›å»ºï¼Œæˆ‘ä»¬ä½¿ç”¨2.  Requestï¼š è·å–è¯·æ±‚æ“ä½œ   1. ç»§æ‰¿ç»“æ„ï¼š      * ServletRequest æ¥å£      * HttpServletRequest  ç»§æ‰¿è¯¥æ¥å£ ä»ç„¶æ˜¯æ¥å£      * Tomcat ä¸­çš„ç±» RequestFacedeæ¥å®ç° è¯¥æ¥å£3. Request åŠŸèƒ½ï¼š   1. è·å–è¯·æ±‚è¡Œæ•°æ®      * è·å–è¯·æ±‚æ–¹å¼ String getMethod();      * **è·å–è™šæ‹Ÿç›®å½•** String getContextPath();      * è·å–Servlet è·¯å¾„: /demo1   getServletPath();      * è·å–getæ–¹å¼è¯·æ±‚å‚æ•° getQueryString();      * **è·å–è¯·æ±‚çš„URI ** getRequestURL()        * URL: ç»Ÿä¸€èµ„æºå®šä½ç¬¦           * URI: ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦   èŒƒå›´&gt;URL       * è·å–åè®®å’Œç‰ˆæœ¬ï¼š getProtocal()      * è·å–å®¢æˆ·æœºçš„IP: getRemoteAddress();           2. è·å–è¯·æ±‚å¤´æ•°æ®      1. æ–¹æ³•ï¼š         * getHeaderï¼ˆnameï¼‰ ï¼šé€šè¿‡è¯·æ±‚å¤´åç§°è·å–è¯·æ±‚å¤´çš„å€¼         * getHeaderNames(): è·å–æ‰€æœ‰è¯·æ±‚å¤´çš„åç§°      3. è·å–è¯·æ±‚ä½“æ•°æ®         æ­¥éª¤ï¼š         1. è·å–æµå¯¹è±¡         * bufferedReader getReader() å­—ç¬¦æ•°æ®æµ         * ServletInputStream getInputStrea() è·å–å­—èŠ‚è¾“å…¥æµ      2. ä»æµå¯¹è±¡ä¸­æ‹¿å»æ•°æ®   4. å…¶ä»–åŠŸèƒ½ï¼š   1. è·å–è¯·æ±‚å‚æ•°é€šç”¨æ–¹å¼ï¼š       1. getParameter(string) æ ¹æ®å‚æ•°åç§°è·å–å‚æ•°å€¼      2. getParameterValuesï¼ˆï¼‰ è¿”å›å‚æ•°åç§°è¿”å›å‚æ•°å€¼çš„æ•°ç»„ï¼ˆå¤é€‰æ¡†ï¼‰      3. getParameterNames() è·å–æ‰€æœ‰è¯·æ±‚çš„å‚æ•°åç§°      4. Map&lt;str,str[]&gt; getParameterMap() è·å–æ‰€æœ‰å‚æ•°çš„mapé›†   2. ä¸­æ–‡ä¹±ç é—®é¢˜ï¼š      * get æ–¹å¼åœ¨tomcat 8 å·²ç» è¢«è§£å†³      * post åœ¨è¾“å…¥ä¸­æ–‡æ—¶æ˜“ä¹±ç       * åœ¨è·å–å‚æ•°å‰ä¿®æ”¹ ç¼–ç  ä½¿å…¶è·Ÿhtmlç¼–ç ç›¸åŒ      * request.setcharartorEncodingï¼ˆ&quot;utf-8&quot;ï¼‰   3. è¯·æ±‚è½¬å‘ï¼š ä¸€ç§åœ¨æœåŠ¡å™¨å†…éƒ¨çš„èµ„æºè·³è½¬æ–¹å¼      1. request. getrequestdispatcher(/uri).forward(request,respose)      2. ç‰¹ç‚¹ï¼š          1. æµè§ˆå™¨åœ°å€æ è·¯å¾„ æœªå‘ç”Ÿå˜åŒ–          2. åªèƒ½è½¬å‘åˆ°**å½“å‰çš„æœåŠ¡å™¨**å†…éƒ¨èµ„æºä¸­         3. è½¬å‘ æ˜¯ä¸€æ¬¡è¯·æ±‚ï¼Œå¤šä¸ªèµ„æºé—´ä½¿ç”¨åŒä¸€ä¸ªè¯·æ±‚    4. å…±äº«æ•°æ®ï¼š      1. åŸŸå¯¹è±¡ï¼š ä¸€ä¸ªæœ‰ä½œç”¨èŒƒå›´çš„å¯¹è±¡ï¼Œå¯ä»¥å†èŒƒå›´å†…å…±äº«æ•°æ®      2. requeståŸŸï¼š ä»£è¡¨ä¸€æ¬¡è¯·æ±‚ï¼Œä¸€èˆ¬ç”¨äºè¯·æ±‚è½¬å‘çš„å¤šä¸ªèµ„æºå…±äº«æ•°æ®      3. æ–¹æ³•ï¼š         1. setAttribute(name,obj) å­˜å‚¨æ•°æ®         2. getAttribute(name) é€šè¿‡é”®è·å–å€¼         3. removeAttribute(String name) é€šè¿‡é”®åˆ é™¤å€¼   5.  è·å–ServletContextï¼ˆï¼‰  å¯¹è±¡### 4. å“åº”æ¶ˆæ¯æ•°æ®æ ¼å¼1. å“åº”è¡Œ   * ç»„æˆ ï¼šåè®®/ç‰ˆæœ¬  å“åº”çŠ¶æ€ç   çŠ¶æ€ç æè¿°   * å“åº”çŠ¶æ€ç ï¼š æœåŠ¡å™¨å‘Šè¯‰å®¢æˆ·ç«¯ æµè§ˆå™¨æœ¬æ¬¡è¯·æ±‚å’Œå“åº”çš„ä¸€ä¸ªçŠ¶æ€   * çŠ¶æ€ç éƒ½æ˜¯ä¸‰ä½æ•°å­—     * 1. 1XX: æœåŠ¡å™¨æœåŠ¡å™¨æ¥æ”¶å®¢æˆ·ç«¯æ¶ˆæ¯ æœªæ¥æ”¶å®Œæˆï¼Œç­‰å¾…ä¸€æ®µæ—¶é—´å å‘é€1xx çŠ¶æ€ç        2. 2XXï¼š æ¥æ”¶æˆåŠŸï¼        3. 3XXï¼š 302: é‡å®šå‘  èµ„æºè·³è½¬   304: ç¼“å­˜       4. 4XXï¼šå®¢æˆ·ç«¯é”™è¯¯          1. 404ï¼š è¯·æ±‚è·¯å¾„æ— å¯¹åº”èµ„æº          2. 405ï¼šè¯·æ±‚æ–¹å¼æ²¡æœ‰å¯¹åº”çš„doPost/doGetæ–¹æ³•       5. 5XXï¼šæœåŠ¡å™¨ç«¯é”™è¯¯ï¼ˆæ¯”å¦‚ ç±»ä¸­æ–¹æ³•å¼‚å¸¸ï¼‰2. å“åº”å¤´   1. å¸¸è§çš„å“åº”å¤´ï¼š      1. Content-typeï¼š æœåŠ¡å™¨å‘Šè¯‰å®¢æˆ·ç«¯å“åº”å¤´çš„æ•°æ®æ ¼å¼ã€ç¼–ç æ ¼å¼      2. Content-dispostionï¼š æœåŠ¡å™¨å‘Šè¯‰å®¢æˆ·ç«¯ ä»¥ä»€ä¹ˆæ ¼å¼æ‰“å¼€å“åº”å¤´         1. in-line é»˜è®¤å€¼ï¼š åœ¨å½“å‰é¡µé¢æ‰“å¼€         2. attachmentï¼š ä»¥é™„ä»¶å½¢å¼æ‰“å¼€ï¼ˆå¼¹å‡ºæ–°çª—å£ï¼‰3. å“åº”ç©ºè¡Œ4. å“åº”ä½“   1. å‘é€çš„æ•°æ® ï¼Œ&lt;html&gt;å½¢å¼### 5. Responseå¯¹è±¡åŠŸèƒ½ï¼šè®¾ç½®å“åº”æ¶ˆæ¯ 1. è®¾ç½®å“åº”è¡Œ   1. è®¾ç½®çŠ¶æ€ç ï¼š setStatus(int x)2. è®¾ç½®å“åº”å¤´   1. setHeader(String name,String value)3. è®¾ç½®å“åº”ä½“   1. è·å–è¾“å‡ºæµ      1. å­—ç¬¦è¾“å‡ºæµ getWriter()         1. **è·å–æµå¯¹è±¡ä¹‹å‰**è®¾ç½®ç¼–ç ï¼š resp.setCharsetEncodeing(&quot;xxx&quot;)         2. **è®¾ç½®æµè§ˆå™¨ç¼–ç **            resp.setHeader(&quot;content-type&quot;,&quot;text/html;charset=utf-8&quot;)         3. **ç®€å•å½¢å¼**ï¼š             resp.setContentType(&quot;text/html;charset=utf-8&quot;)               2. å­—èŠ‚è¾“å‡ºæµ getoutputStream()         1. op.write(&quot;xx&quot;.getBytes(&quot;utf-8&quot;))         2. ä¹Ÿè¦setContentTypeï¼         3. å­—èŠ‚è¾“å‡ºæµä¸€èˆ¬ç”¨äºè¾“å‡ºå›¾ç‰‡   2. ä½¿ç”¨æµï¼Œå°†æ•°æ®è¾“å‡ºåˆ°å®¢æˆ·ç«¯æµè§ˆå™¨#### æ¡ˆä¾‹ï¼š1. é‡å®šå‘çš„ç‰¹ç‚¹ï¼š   1. åœ°å€æ å‘ç”Ÿå˜åŒ–    2. å¯ä»¥è®¿é—®å…¶ä»–æœåŠ¡å™¨çš„èµ„æº&quot;www.baidu.com&quot;   3. ä¸¤æ¬¡è¯·æ±‚ï¼Œä¸èƒ½å†ç”¨requestå¯¹è±¡å…±äº«æ•°æ®2. è½¬å‘çš„ç‰¹ç‚¹   1. æœåŠ¡å™¨åœ°å€ä¸å˜   2. åªèƒ½è®¿é—®å½“å‰æœåŠ¡å™¨ä¸‹çš„èµ„æº   3. ä¸€æ¬¡è¯·æ±‚ï¼Œå¯ä»¥ç”¨requestå¯¹è±¡å…±äº«æ•°æ®3. è·¯å¾„å†™æ³•ï¼š   1. ç›¸å¯¹è·¯å¾„ï¼š ä¸èƒ½ç¡®å®šå”¯ä¸€èµ„æº      * ./index.html        * ä¸ä»¥/å¼€å¤´ ï¼Œä»¥. å¼€å¤´      * è§„åˆ™ï¼šç¡®å®šè®¿é—®å½“å‰èµ„æºå’Œç›®æ ‡èµ„æºçš„ç›¸å¯¹å…³ç³»        * è¯­æ³• : ./å½“å‰ç›®å½•        â€‹../ åé€€ä¸€çº§çš„ç›®å½•   2. ç»å¯¹è·¯å¾„ï¼šç¡®å®šå”¯ä¸€èµ„æº      * â€‹å¦‚ :http:///ssxxxx.x..xx..x       /xxx/xxx      * â€‹    ä»¥ /å¼€å¤´çš„      * è§„åˆ™ï¼š å®šä¹‰çš„è·¯å¾„ç»™è°ç”¨        * ç»™å®¢æˆ·ç«¯ç”¨ï¼š åŠ è™šæ‹Ÿç›®å½•        * ç»™æœåŠ¡å™¨ï¼š ä¸ç”¨åŠ è™šæ‹Ÿç›®å½•   3. åŠ¨æ€è·å–è™šæ‹Ÿç›®å½•      * req.getContextPath(),è·å–ä¸Šä¸€çº§ç›®å½•### ServletContext    (interface)1. ä»£è¡¨ï¼š æ•´ä¸ªWebåº”ç”¨ï¼Œå¯ä»¥å’Œç¨‹åºçš„å®¹å™¨ï¼ˆæœåŠ¡å™¨ï¼‰æ¥é€šä¿¡2. è·å–æ–¹å¼ï¼š   1. req.getServletContext();   2. this.getServletContext();(å¿…é¡»ç»§æ‰¿HttpServlet)3. åŠŸèƒ½ï¼š   1. è·å–MIMEç±»å‹ï¼š      * MIME: äº’è”ç½‘é€šä¿¡è¿‡ç¨‹ä¸­å®šä¹‰çš„ä¸€ç§æ–‡ä»¶æ•°æ®ç±»å‹        * æ¯”å¦‚ï¼š text/html    image/jpeg      * è·å–ï¼š getMimeType(str file)   2. åŸŸå¯¹è±¡ï¼šå…±äº«æ•°æ®      1. setAttribute()      2. getAttribute()      3. removeAttribute()         * servletContextåŸŸçš„èŒƒå›´:æ‰€æœ‰ç”¨æˆ·è¯·æ±‚çš„æ•°æ®ï¼ˆç±»ä¼¼äºä¸€ä¸ªå…¨å±€çš„ç±»å¯¹è±¡ï¼‰ï¼Œä½¿ç”¨è¦è°¨æ…ï¼Œè€Œä¸”å…¶ç”Ÿå‘½å‘¨æœŸå¾ˆé•¿   3. è·å–æ–‡ä»¶çš„çœŸå®è·¯å¾„      1.  getRealPath(str)         1. &quot;/b.txt&quot; ---Web ç›®å½•ä¸‹çš„         2. &quot;/WEB-INF/b.txt&quot;  ---WEB-INFç›®å½•ä¸‹çš„         3. &quot;/WEB-INF/classes/a.txt&quot;  ----srcç›®å½•ä¸‹çš„            å› ä¸ºä¼šè‡ªåŠ¨å­˜å‚¨åœ¨WEB-INFçš„classesä¸­çš„      2. æ³¨æ„ï¼š ClassLoaderåªèƒ½è·å–srcä¸‹çš„è·¯å¾„ï¼ˆå±€é™ï¼‰## **Cookie** 1. ä¼šè¯ï¼š ä¸€æ¬¡ä¼šè¯ä¸­åŒ…å«çš„å¤šæ¬¡è¯·æ±‚å’Œå“åº”      1. ä¸€æ¬¡ä¼šè¯ï¼š æµè§ˆå™¨ç¬¬ä¸€æ¬¡ç»™æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œç›´åˆ°ä¸€æ–¹æ–­å¼€ä¸ºæ­¢2. åŠŸèƒ½ï¼šåœ¨ä¸€æ¬¡ä¼šè¯èŒƒå›´å†…çš„å¤šæ¬¡è¯·æ±‚é—´ **å…±äº«æ•°æ® **3. æ–¹å¼ï¼š   1. å®¢æˆ·ç«¯ä¼šè¯ï¼š Cookie  æ•°æ®å­˜å…¥åˆ°å®¢æˆ·ç«¯      1. ä½¿ç”¨æ­¥éª¤ï¼š         1. åˆ›å»ºå¯¹åƒ   API  ç»‘å®šæ•°æ®         2. å‘é€Cookie         3. è·å–Cookieï¼Œæ‹¿åˆ°æ•°æ®               2. åˆ›å»ºï¼š new Cookie();         * resp.addCookie(cookie)å¸¦ç€Cookie å»ä¸‹ä¸€ä¸ªåœ°æ–¹         * req.getCookies()               3. å®é™…åŸç†ï¼š                  * å“åº”å¤´ ï¼š set-cookie: msg=hello, å˜æˆäº†é”®å€¼å¯¹çš„å½¢å¼ï¼Œå®¢æˆ·ç«¯ä¼šæŠŠè¿™ä¸ªæ•°æ®ä¿å­˜åˆ°æœ¬åœ°ï¼Œç„¶åå¸¦åˆ°ç¬¬äºŒä¸ªè¯·æ±‚çš„è¯·æ±‚å¤´ä¸­ Cookie: msg=hello               4. Cookie ç»†èŠ‚ï¼š         1. ä¸€æ¬¡èƒ½å‘é€å¤šä¸ªCookieå—ï¼Ÿ                     * å¯                    2. Cookieåœ¨æµè§ˆå™¨é‡çš„ä¿å­˜æ—¶é—´            * Cookie ä¸è®¾ç½®ä¸‹ï¼Œå…³é—­æµè§ˆå™¨å†è®¿é—®å°±æ²¡æœ‰äº†            * è®¾ç½®ç”Ÿå‘½å‘¨æœŸï¼š              * setMaxAgeï¼ˆint secondsï¼‰              * åœ¨åˆ›å»ºCookieæ—¶ä½¿ç”¨              * x&gt;0 æŒä¹…åŒ–å†™å…¥åˆ°ç¡¬ç›˜æ–‡ä»¶ï¼Œxä»£è¡¨å­˜æ´»ç§’æ•°ï¼Œå…³é—­æµè§ˆå™¨å†æ‰“å¼€ï¼Œä¹Ÿå¯ä»¥è®¿é—®åˆ°              * x&lt;0 é»˜è®¤å€¼              * x=0 åˆ é™¤ä¿¡æ¯                     3. Tomcat 8 ä¹‹åæ‰èƒ½ç›´æ¥å­˜ä¸­æ–‡          4. Cookie è·å–èŒƒå›´            1. setPathï¼ˆï¼‰ è®¾ç½®è™šæ‹Ÿç›®å½•            2. åŒä¸€ä¸ªæœåŠ¡å™¨ä¸‹çš„å¤šé¡¹ç›®                     5. Cookie  å•ä¸ªï¼š4kb            â€‹åŒä¸€ä¸ªåŸŸåä¸‹ ï¼š20ä¸ª         6. Cookie ç”¨æ¥å­˜å‚¨**å°‘é‡ä¸å¤ªæ•æ„Ÿ**çš„æƒ…å†µ         7. åœ¨ä¸ç™»é™†çš„æƒ…å†µä¸‹ï¼Œå®Œæˆ**æœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯**çš„è¯†åˆ«## Session 1. request.getSessionï¼ˆï¼‰ getAttribute setAttribute remove....2. ä»…æ­¤åœ¨ä¸€æ¬¡ä¼šè¯ä¸­è®¿é—®å¯¹è±¡  ï¼Œ å…³é—­æµè§ˆå™¨å°±æ²¡æœ‰äº† 3. åŸç†ï¼šä¾èµ–äºCookie4. ç»†èŠ‚ï¼š   1. å®¢æˆ·ç«¯å…³é—­åï¼Œä¸¤æ¬¡è·å–çš„sessionä¸æ˜¯åŒä¸€ä¸ª      é»˜è®¤ä¸æ˜¯ï¼Œè®¾ç½®ï¼š ç”¨Cookieä¿å­˜ id   2. å®¢æˆ·ç«¯ä¸å…³é—­ï¼ŒæœåŠ¡å™¨å…³é—­åä¸¤æ¬¡è·å–çš„sessionä¸æ˜¯åŒä¸€ä¸ª      ä½†è¦ç¡®ä¿æ•°æ®ä¸ä¸¢å¤±      *  sessionçš„é’åŒ–ï¼š æœåŠ¡å™¨æ­£å¸¸å…³é—­å‰ï¼Œå°†sessionå¯¹è±¡åºåˆ—åŒ–å­˜åˆ°ç¡¬ç›˜ä¸Š      * sessionçš„æ´»åŒ–ï¼š æœåŠ¡å™¨å¯åŠ¨åï¼Œå°†sessionæ–‡ä»¶è½¬åŒ–åˆ°å†…å­˜ä¸­çš„sessionå¯¹è±¡   3. é”€æ¯ï¼š      1. æœåŠ¡å™¨å…³é—­      2. è°ƒç”¨invaliddateæ–¹æ³•      3. 30minåè‡ªåŠ¨å…³é—­   4. **sessionå¯å­˜å‚¨ä»»æ„å¤§å°ä»»æ„ çš„æ•°æ®  ï¼Œ æ›´å®‰å…¨**## JSP (Java Server Pages)1. æ¦‚å¿µï¼šæ—¢å¯ä»¥æœ‰htmlæ ‡ç­¾ ä¹Ÿå¯ä»¥æœ‰javaä»£ç    2. ç›®çš„ï¼šç®€åŒ–ä¹¦å†™3. åŸç†   * JSP æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªServlet     * .jsp ----&gt; .java/.class4. JSPè„šæœ¬ï¼š å£°æ˜javaä»£ç çš„æ–¹å¼       1. &lt;% ......   %&gt;ï¼šå®šä¹‰çš„javaä»£ç ï¼Œåœ¨serviceæ–¹æ³•ä¸­å¯ä»¥å®šä¹‰çš„éƒ½å¯   2. &lt;%!  ...%&gt;ï¼šå®šä¹‰æˆå‘˜å˜é‡å’Œæˆå‘˜æ–¹æ³•   3. &lt;%= ..%&gt;ï¼šè¾“å‡ºè¯­å¥ ï¼Œï¼ˆè¾“å‡ºæˆå‘˜å˜é‡å€¼ï¼‰   4. å†…ç½®å¯¹è±¡ï¼š request  response outï¼Œå…¶å‡¡æ˜¯åœ¨jspServiceä¸­å®šä¹‰çš„ï¼Œéƒ½å¯ä»¥ç”¨      1. **response ç¼“å†²æ°¸è¿œå…ˆäº out è¾“å‡ºä¸è®ºé¡ºåº**ï¼Œä¼šå…ˆæ‰¾åˆ°responseç¼“å†²åŒºå¹¶æ‹¼æ¥åˆ°serviceä¸­      2. æ‰€ä»¥ï¼šå°½é‡ä¸ç”¨response.getWriter()å†™   5. å¯ä»¥æˆªæ–­ï¼š åœ¨ä¸­éƒ¨ç”¨&#123; &#125; é˜¶æ®µ å¹¶æ’å…¥htmlè¯­å¥</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Mysql å­¦ä¹ </title>
    <link href="/2019/07/22/Mysql%E5%AD%A6%E4%B9%A0/"/>
    <url>/2019/07/22/Mysql%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1>æ•°æ®åº“å­¦ä¹ </h1><!-- toc --><h2 id="DDL">DDL :</h2><p>æ“ä½œæ•°æ®åº“ï¼šCRUD  åŠŸèƒ½    ï¼ˆåˆ›å»ºã€æŸ¥è¯¢ã€æ›´æ–°ã€åˆ é™¤ï¼‰</p><p>1.<strong>æŸ¥è¯¢ä¸åˆ›å»º</strong></p><p>show databasesã€  create database  xxx  ã€show create  database xxx(æŸ¥è¯¢åç§°å’Œå­—ç¬¦ç±»å‹)\</p><p>â€‹create database xxx if not exists XX(ä¸ä¼šæŠ¥é”™)</p><p>â€‹create database xx character set xxx(utf-8)</p><p>â€‹å¯ä»¥è¿ç”¨è¯­å¥   create database xxx if not exists XX character set xxx</p><span id="more"></span><ol start="2"><li><p>ä¿®æ”¹</p><p>alter database xxx  character set xxxx        è®¾ç½®å·²åˆ›å»ºçš„æ•°æ®åº“çš„å­—ç¬¦ç±»å‹</p></li><li><p>åˆ é™¤</p><p>â€‹drop database  (if exists xxx)  *è¦å…ˆè½¬åˆ°å½“å‰çš„database</p><p>4.ä½¿ç”¨æ•°æ®åº“</p></li></ol><p>â€‹æŸ¥è¯¢å½“å‰çš„æ•°æ®åº“   Select database();</p><p>â€‹ä½¿ç”¨æ•°æ®åº“            use xxxx;</p><h2 id="æ•°æ®ç»“æ„">æ•°æ®ç»“æ„</h2><h3 id="æ•´å‹">æ•´å‹</h3><p>é»˜è®¤æ˜¯æœ‰ç¬¦å·çš„ , unsigned æŒ‡å®šæ— ç¬¦å·ï¼Œä¼šè®¾ç½®é»˜è®¤é•¿åº¦ï¼Œè¿™é‡Œ<strong>é•¿åº¦ä¸ä»£è¡¨èŒƒå›´ï¼ŒèŒƒå›´æœ‰ç±»å‹å†³å®š</strong>ï¼Œé•¿åº¦æŒ‡çš„æ˜¯å€¼çš„æ˜¾ç¤ºå®½åº¦ï¼Œå¦‚æœå°äºæŒ‡å®šé•¿åº¦ï¼Œåˆ™è¡¥é½0ï¼ˆä½†å¿…é¡»æ­é…zerofillæ‰è¡Œï¼Œä¸”åŠ ä¸Šåå°±é»˜è®¤å˜æˆunsignedäº†ï¼ˆä¸æ”¯æŒè´Ÿæ•°ï¼‰ï¼‰</p><ul><li>Tinyint</li><li>Smallint</li><li>Mediumint</li><li>Intã€integer</li><li>Bigint</li></ul><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211008193310011.png" alt="image-20211008193310011"></p><p>è¶…å‡ºèŒƒå›´ æ’å…¥æ—¶ç›´æ¥æŠ¥é”™</p><h3 id="å°æ•°">å°æ•°</h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211009124043616.png" alt="image-20211009124043616"></p><ul><li>æµ®ç‚¹å‹<ul><li>float</li><li>double</li></ul></li><li>å®šç‚¹å‹<ul><li>dec</li><li>decimal</li></ul></li></ul><p>M ä»£è¡¨æ•´æ•°éƒ¨ä½ + å°æ•°éƒ¨ä½<br>D ä»£è¡¨å°æ•°éƒ¨ä½(è‡ªç„¶å°±é™åˆ¶äº†æ•´æ•°çš„ä½æ•°)<br>å¦‚æœè¶…è¿‡èŒƒå›´ï¼Œåˆ™æŠ¥é”™ã€‚éƒ½çœç•¥ï¼Œdecimalé»˜è®¤ç²¾åº¦æ˜¯(10,0)</p><h3 id="å­—ç¬¦å‹">å­—ç¬¦å‹</h3><ul><li><p>è¾ƒçŸ­æ–‡æœ¬</p><ul><li><p>charï¼Œå›ºå®šé•¿åº¦ï¼Œå‰©ä½™çš„ç”¨ç©ºæ ¼è¡¥é½,æ€§èƒ½æ›´é«˜ï¼Œé»˜è®¤é•¿åº¦ä¸º1ï¼ˆæŒ‡å­—ç¬¦æ•°ï¼‰charçš„å­˜å‚¨æ–¹å¼æ˜¯ï¼Œå¯¹è‹±æ–‡å­—ç¬¦ï¼ˆASCIIï¼‰å ç”¨1ä¸ªå­—èŠ‚ï¼Œå¯¹ä¸€ä¸ªæ±‰å­—å ç”¨ä¸¤ä¸ªå­—èŠ‚ï¼›</p></li><li><p>varcharï¼Œå¯å˜é•¿åº¦ã€‚varcharçš„å­˜å‚¨æ–¹å¼æ˜¯ï¼Œå¯¹æ¯ä¸ªè‹±æ–‡å­—ç¬¦å ç”¨2ä¸ªå­—èŠ‚ï¼Œ<strong><s>æ±‰å­—ä¹Ÿå ç”¨2ä¸ªå­—èŠ‚</s>ã€‚</strong></p><ul><li>utf-8mb3ä¸‹æ±‰å­—å 3ä¸ªå­—èŠ‚. mn4å 4ä¸ªå­—èŠ‚</li><li>gbkä¸‹æ±‰å­—å 2ä¸ªå­—èŠ‚</li></ul></li><li><p>Enumæšä¸¾ ENUM(â€˜ç”·â€™,â€˜å¥³â€™)ç±»ä¼¼è¿™æ ·ï¼Œåªèƒ½æ’å…¥å…¶ä¸­ä¸€ä¸ª</p></li><li><p>Setç±»å‹ï¼Œå¯ä»¥é€‰æ‹©å¤šä¸ªæ’å…¥ã€‚æ’å…¥æ–¹å¼â€¦values(â€˜aâ€™,â€˜bâ€™,â€˜câ€™)</p></li><li><p>binary â€“ varbinary ä¿å­˜è¾ƒçŸ­çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211009125026467.png" alt="image-20211009125026467"></p></li></ul></li><li><p>è¾ƒé•¿æ–‡æœ¬</p><ul><li><p>textï¼Œåªèƒ½ä¿å­˜å­—ç¬¦æ•°æ®ï¼Œä¾‹å¦‚æ—¥è®°</p></li><li><p>blobï¼Œä¿å­˜äºŒè¿›åˆ¶æ•°æ®ï¼Œåªèƒ½å­˜å­—èŠ‚ï¼Œä¾‹å¦‚ç…§ç‰‡ï¼ˆä½†ä¸€èˆ¬ä¸ä¼šè¿™æ ·ï¼‰</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211009130912386.png" alt="image-20211009130912386"></p></li></ul></li></ul><h3 id="æ—¥æœŸ">æ—¥æœŸ</h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211009130250988.png" alt="image-20211009130250988"></p><p>timestampå’Œå®é™…æ—¶åŒºæœ‰å…³ï¼ˆmysqlçš„time-zoneï¼‰ï¼Œæ›´èƒ½ååº”å®é™…çš„æ—¥æœŸï¼Œdatetimeåªèƒ½ååº”æ’å…¥æ—¶çš„å½“åœ°æ—¶åŒºã€‚<br>timestampåªæ”¯æŒåˆ°1970åˆ°2038å¹´çš„æŸæ—¶åˆ»ã€‚datetimeå¯ä»¥ä»1000åˆ°9999</p><h2 id="æ“ä½œè¡¨">æ“ä½œè¡¨</h2><p>â€‹CRUD</p><ol><li><p>æŸ¥è¯¢    show tablesï¼›</p><p>æŸ¥è¯¢è¡¨ç»“æ„  desc xxx(è¡¨å)</p></li><li><p>åˆ›å»º    create table xxxï¼ˆ</p><p>â€‹            åˆ—å1  æ•°æ®ç±»å‹1ï¼Œ</p><p>â€‹åˆ—å2  æ•°æ®ç±»å‹2ï¼Œ</p><p>â€‹â€¦</p><p>â€‹åˆ—ån  æ•°æ®ç±»å‹n</p><p>â€‹);</p><p>æ•°æ®åº“ä¸­çš„æ•°æ®ç±»å‹(int ã€doubleï¼ˆn,mï¼‰æœ€å¤šnä½ï¼Œå°æ•°ç‚¹åmä½</p><p>â€‹ã€dateï¼ˆyyyy-MM-ddï¼‰ã€datetime(yyyy-mm-dd HH:mm:ss)</p><p>â€‹timestampï¼ˆæ—¶é—´æˆ³ï¼Œè‹¥ä¸ç»™è¿™ä¸ªå­—æ®µèµ‹å€¼ï¼Œåˆ™é»˜è®¤ä½¿ç”¨å½“å‰ç³»ç»Ÿæ—¶é—´ï¼‰</p><p>â€‹varchar(éœ€æŒ‡å®šæœ€å¤§å­—ç¬¦)</p><p>)</p></li></ol><p>3.åˆ é™¤          drop table xxx /   (if exists xxx)</p><p>4.ä¿®æ”¹è¡¨      ä¿®æ”¹è¡¨å :  alter table xxx rename to ï¼ˆnewxxxï¼‰</p><p>â€‹ä¿®æ”¹è¡¨çš„å­—ç¬¦é›†  :alter table xxx character set utf-8</p><p>â€‹æ·»åŠ ä¸€åˆ—  ï¼š    alter table xx add aaa(new colume)  bbb(æ•°æ®ç±»å‹)</p><p>â€‹ä¿®æ”¹åˆ—å ç±»å‹ï¼š alter table è¡¨å change åˆ—å æ–°åˆ—åå­—  æ–°æ•°æ®ç±»å‹</p><p>â€‹alter table è¡¨å  modify åˆ—å æ–°æ•°æ®ç±»å‹</p><p>â€‹åˆ é™¤åˆ—ï¼š alter table è¡¨å drop åˆ—å;</p><p><strong>5. å¤åˆ¶è¡¨</strong></p><ul><li>create table copyxxx like â€¦ ä»…å¤åˆ¶è¡¨ç»“æ„</li><li>create table copyxxx select * from anotherTable; å¤åˆ¶è¡¨ç»“æ„ + æ•°æ®</li><li>2çš„åŸºç¡€åŠ where   åªå¤åˆ¶éƒ¨åˆ†æ•°æ®</li></ul><ol start="6"><li><p>æŸ¥çœ‹è¡¨ç»“æ„</p><p>show index from  xxx  æŸ¥çœ‹ç´¢å¼•</p><p>desc xxx</p></li></ol><h2 id="DML-å¢åˆ æ”¹è¡¨ä¸­æ•°æ®">DML å¢åˆ æ”¹è¡¨ä¸­æ•°æ®</h2><ol><li><p>æ·»åŠ æ•°æ®</p><p><strong>values æ–¹å¼</strong></p><p>â€‹insert into (è¡¨å)(column , ~, , ,) values  (x,x,x)  // åˆ—åä¸å€¼å¿…é¡»å¯¹åº”</p><p>â€‹inster into ï¼ˆè¡¨åï¼‰valuse ï¼ˆxxxxxï¼‰ç»™æ‰€æœ‰çš„è¡Œåˆ—åŠ ä¸Šå€¼ï¼Œå¦åˆ™æŠ¥é”™</p></li></ol><p>â€‹                  é™¤äº†æ•°å­—ç±»å‹ï¼Œå…¶ä»–çš„å¿…é¡»å¼•å·ï¼Œå•åŒéƒ½å¯ï¼Œæ”¯æŒæ’å…¥å¤šè¡Œã€å­æŸ¥è¯¢ï¼Œé€—å·éš”å¼€</p><p>â€‹<strong>set æ–¹å¼</strong></p><p>â€‹    insert into table set col1 = x,col2 =y â€¦</p><ol start="2"><li><p>åˆ é™¤æ•°æ®</p><ul><li>delete from (table) where xxx (condition) æ²¡æœ‰where æ¡ä»¶çš„è¯åˆ™å®Œå…¨åˆ é™¤</li><li>truncate table xxx ï¼Œä¸å…è®¸åŠ whereï¼Œç›´æ¥åˆ é™¤è¡¨</li></ul><p><strong>deleteåˆ é™¤åï¼Œè‡ªå¢é•¿çš„å€¼ä»æ–­ç‚¹å¼€å§‹ï¼Œtruncateæ¸…ç©ºåï¼Œè‡ªå¢é•¿çš„å€¼ä»1å¼€å§‹</strong></p><p><strong>deleteåˆ é™¤åæœ‰è¿”å›å€¼ï¼Œtruncateæ— è¿”å›å€¼ï¼ˆ0è¡Œå—åˆ°å½±å“ï¼‰</strong></p><p><strong>truncateä¸èƒ½å›æ»š</strong></p><div class="code-wrapper"><pre class="language-none"><code class="language-none">  Truncate table åˆ é™¤è¡¨ä¸­æ‰€æœ‰è®°å½•  æ¯”  deleye from table  æ•ˆç‡æ›´é«˜</code></pre></div></li></ol><p>â€‹3. ä¿®æ”¹æ•°æ®ï¼š</p><p>â€‹update table set colume =x1, â€¦ (where  ,)ä¸€æ ·å¯ä»¥åŠ å…¥æ¡ä»¶<br>â€‹ä¸åŠ æ¡ä»¶åˆ™ä¼šå°†è¡¨ä¸­æ‰€æœ‰æ•°æ® éƒ½æ›´æ”¹</p><h2 id="DQL-æŸ¥è¯¢è¡¨ä¸­è®°å½•-ï¼ˆ-ï¼‰">DQL æŸ¥è¯¢è¡¨ä¸­è®°å½• ï¼ˆ*ï¼‰</h2><hr><ol><li>æ™®é€šæŸ¥è¯¢   select * from è¡¨å</li><li>è¯­æ³•ï¼š  select  å­—æ®µåˆ—è¡¨   from è¡¨ååˆ—è¡¨ where æ¡ä»¶åˆ—è¡¨  group by åˆ†ç»„å­—æ®µ  <br>          order by æ’åº   limit  åˆ†é¡µé™å®š<BR/>          å»é™¤é‡å¤å…³é”®å­—ï¼š  DISTINCT<BR/>         èµ·åˆ«åå…³é”®å­—ï¼š AS xxx</li><li>åŸºç¡€æŸ¥è¯¢ï¼š<br/> 1. å¤šä¸ªå­—æ®µçš„æŸ¥è¯¢ï¼š  <BR/>            select (DISTINCT)xxx  ,yyy   from table <br/>             select (DISTINCT)xxx +yyy   (AS æ€»åˆ†)  from table æ±‚æ€»åˆä¸”èƒ½å¤Ÿæ¢åå­— <br/>             select (DISTINCT)xxx +IFNULL(yyy,0)   from table è§£å†³nullæ— æ³•ç›¸åŠ é—®é¢˜</li><li>æ¡ä»¶æŸ¥è¯¢<br > 1.  æ¡ä»¶è¯­å¥ä¸­çš„= åªæœ‰ä¸€ä¸ª=ç¬¦å·  <br /> 2. &lt;&gt; ä¸!=  ç­‰ä»·    ã€å¯ä»¥ç”¨&amp;&amp;ä½†æ¨èä½¿ç”¨ AND<BR> 3. BETWEEN  AND å…³é”®å­— ä¹Ÿèƒ½å¤„ç†ä¸­é—´é‡</li><li>æ¨¡ç³ŠæŸ¥è¯¢<br>setlect * from table WHERE  xxx LIKE '_ /â€˜%â€™<br>_  :  å•ä¸ªå­—ç¬¦  %  :å¤šä¸ªå­—ç¬¦<br>â€”è‹¥å‰é¢æ²¡æœ‰å­—ç¬¦ â€˜â€™%x%&quot; ä¸€æ ·èƒ½æŸ¥å‡ºè¯¥æ¡æ•°æ®ï¼ï¼</li><li>æ’åºæŸ¥è¯¢ï¼šâ€™<br>select     â€¦  order by xxx DESC/ASC ,aaa â€¦ï¼ˆé™åºã€å‡åºï¼‰</li><li>èšåˆå‡½æ•°ï¼š(è¿ç®—ä¼šæ’é™¤nullå€¼)<br>count \max\min\sum\avg<br>select xxx(colume) from table ;<br>select count (ifnull (column,0)) from student;ï¼ˆå°†nullå€¼æ›¿æ¢ä¸º0ï¼‰</li><li>åˆ†ç»„æŸ¥è¯¢ï¼š<br>select sex ,avg(column) AS å¹³å‡å€¼ï¼Œcount (id) from table Where â€¦ GROUP BY sex Having count(column)â€¦;<br>â€”AS xxx èµ·åˆ«åï¼Œæ³¨æ„é€—å·<br>â€”å…¶åå¯ä»¥è·Ÿ èšåˆå‡½æ•°<br>â€”æ¡ä»¶è¯­å¥åœ¨ GROUP BY ä¹‹å‰    <strong>ä¸æ»¡è¶³ åˆ™ä¸å‚ä¸åˆ†ç»„</strong><br>â€”èšåˆå‡½æ•°åœ¨ GROUP BY ä¹‹å ä¸”æœ‰havingå…³é”®å­—  <strong>ä¸æ»¡è¶³ åˆ™ä¸æ˜¾ç¤º</strong></li><li>åˆ†é¡µæŸ¥è¯¢ï¼š<br>select * from student LIMIT a,b;<br>â€”a : èµ·å§‹çš„é¡µæ•° (0æ˜¯ç¬¬ä¸€æ¡)  b: ç»“å°¾çš„é¡µæ•°+1 [a,b);</li></ol><h2 id="çº¦æŸ">çº¦æŸ</h2><p>ä¸€ç§é™åˆ¶ï¼Œé™åˆ¶è¡¨ä¸­è¡Œåˆ—æ•°æ®ï¼Œä¿è¯æœ€ç»ˆæ·»åŠ åˆ°è¡¨ä¸­çš„æ•°æ®æ˜¯å¯é çš„</p><ul><li>not null</li><li>deafult ï¼Œå­—æ®µæœ‰é»˜è®¤å€¼</li><li>primary key ä¸»é”®ï¼Œä¿è¯è¯¥å­—æ®µçš„å€¼çš„<strong>å”¯ä¸€æ€§ã€éç©ºæ€§</strong><ul><li>å¯ä»¥æœ‰ç»„åˆä¸»é”®ï¼ˆä¸¤ä¸ªæˆ–è€…å¤šä¸ªä¸èƒ½<strong>éƒ½</strong>ç›¸åŒï¼‰</li></ul></li><li>unique å”¯ä¸€æ€§ï¼Œä½†å¯ä»¥ä¸ºç©ºï¼Œä½†åªèƒ½ä¸ºä¸€ä¸ªnull</li><li>checkï¼Œæ£€æŸ¥çº¦æŸï¼ˆmysqlä¸æ”¯æŒï¼‰ï¼Œå¯¹å…·ä½“å¡«å…¥å€¼çš„é™åˆ¶</li><li>foreign key å¤–é”®çº¦æŸï¼Œåœ¨ä»è¡¨ä¸­æ·»åŠ ï¼Œé™åˆ¶ä¸¤ä¸ªè¡¨çš„å…³ç³»ï¼Œè¯¥å­—æ®µçš„å€¼å¿…é¡»æ¥è‡ªä¸»è¡¨çš„å…³è”å€¼<ul><li>ä¸»è¡¨çš„å…³è”åˆ—(Dep)ä¸€èˆ¬æ˜¯ä¸€ä¸ªé”®(ä¸»é”®ã€å”¯ä¸€é”®)</li></ul></li></ul><p>çº¦æŸä¹Ÿåˆ†ä¸ºåˆ—çº§çº¦æŸã€è¡¨çº§çº¦æŸ</p><p><strong>è¡¨çº§çº¦æŸæ·»åŠ </strong></p><p>å¯ä»¥ä½¿ç”¨constraint + è‡ªå®šä¹‰keyname  æˆ–è€…ç›´æ¥ä½¿ç”¨é»˜è®¤</p><p>constraint xxx(casual constraint name) primary key(id)â€¦<br>primary key (id)</p><p><strong>ä¿®æ”¹è¡¨æ—¶æ·»åŠ çº¦æŸ</strong></p><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql">alter table xxx modify column aaa int not null; # åˆ—çº§çº¦æŸalter table xxx add primary key(id);# è¡¨çº§çº¦æŸ# ä¿®æ”¹è¡¨æ—¶åˆ é™¤çº¦æŸalter table xxx modify column aaa int ; # ä¸è¦not null ...äº†# åˆ é™¤ä¸»é”®çš„ä¸¤ç§æ–¹æ³•alter table xxx modify column aaa int;alter table xxx modify drop primary key;  # åˆ é™¤å”¯ä¸€é”®alter table xxx drop index key_name;alter table xxx drop foreign key key_name;</code></pre></div><h3 id="å¤–é”®çº¦æŸ">å¤–é”®çº¦æŸ</h3><ol><li><p>åˆ›å»ºï¼š create table xxx(</p><p>â€‹å¤–é”®åˆ—</p><p>â€‹costraint å¤–é”®å foreign key ï¼ˆå¤–é”®åˆ—åç§°ï¼‰ï¼ˆæ­¤å¤„æ‹¬å·å¿…é¡»åŠ ï¼‰      references ä¸»è¡¨åç§°(ä¸»è¡¨åˆ—åç§°)ï¼ˆä¸€èˆ¬æ˜¯ä¸»é”®ï¼‰</p><p>);</p><p>*<em>å¤–é”®å…³è”åä¸»è¡¨ä¸èƒ½è¢«åˆ é™¤</em> *</p></li></ol><p>â€‹    2.åˆ é™¤ ï¼š Alter  table xxx drop foreign key å¤–é”®å;</p><p>â€‹    3.æ·»åŠ ï¼š  Alter  table xxx add costraint å¤–é”®å foreign key å¤–é”®åˆ—åç§° references ä¸»è¡¨åç§°(ä¸»è¡¨åˆ—åç§°)ï¼ˆä¸€èˆ¬æ˜¯ä¸»é”®ï¼‰;</p><ol start="4"><li><p><em><strong>çº§è”</strong></em>  ï¼ˆå¤–é”®å¯ä»¥ä¸ºNULL ï¼‰</p><ul><li>åˆ›å»ºè¡¨åçº§è”æ›´æ–°ï¼šAlter table ï¼ˆforeign tableï¼‰ ADD CONSTRAINT â€¦ ON UPDATE  CASCADE;  (ON DELELTE CASCADE)</li></ul></li></ol><h2 id="æ ‡è¯†åˆ—">æ ‡è¯†åˆ—</h2><p>auto_increment   è‡ªå¢é•¿åˆ—ï¼Œç³»ç»Ÿè‡ªåŠ¨æä¾›å€¼,æ ‡è¯†åˆ—å¿…é¡»æ˜¯ä¸€ä¸ªkeyï¼Œä¸”åªèƒ½æœ‰ä¸€ä¸ªæ ‡è¯†åˆ—</p><p>è®¾ç½®èµ·å§‹å€¼å’Œæ­¥é•¿</p><p>variable ï¼š auto_increment _incrementæ­¥é•¿         auto_increment_offsetèµ·å§‹å€¼ï¼ˆmysqlä¸æ”¯æŒä¿®æ”¹ï¼‰<br>set auto_increment _increment = 3;</p><h2 id="æ•°æ®åº“è®¾è®¡èŒƒå¼">æ•°æ®åº“è®¾è®¡èŒƒå¼</h2><p><strong>ç›®çš„ï¼šè§£å†³æ•°æ®åº“ä¸­çš„é—®é¢˜</strong></p><ol><li>ç¬¬ä¸€èŒƒå¼ï¼š æ¯ä¸€åˆ—éƒ½æ˜¯ä¸å¯åˆ†å‰²çš„åŸå­æ•°æ®é¡¹</li><li>ç¬¬äºŒèŒƒå¼ï¼šåœ¨ç¬¬ä¸€èŒƒå¼åŸºç¡€ä¸Šï¼Œéç å±æ€§å¿…é¡»å®Œå…¨ä¾èµ–äºå€™é€‰ç <ul><li>å‡½æ•°ä¾èµ– ï¼š é€šè¿‡Aå±æ€§ï¼ˆç»„ï¼‰çš„å€¼ å¯ä»¥ç¡®å®š å”¯ä¸€Bå±æ€§çš„å€¼  (Bä¾èµ–äºA)</li><li>å®Œå…¨å‡½æ•°ä¾èµ–ï¼š Aæ˜¯å±æ€§ç»„  åˆ™Bå±æ€§å€¼çš„ç¡®å®š éœ€è¦Aå±æ€§ç»„ä¸­<strong>æ‰€æœ‰çš„å±æ€§å€¼</strong></li><li>éƒ¨åˆ†å‡½æ•°ä¾èµ–ï¼š Aæ˜¯å±æ€§ç»„  ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚åªéœ€è¦ä¾èµ–Aä¸­çš„éƒ¨åˆ†å±æ€§å€¼</li><li>ä¼ é€’å‡½æ•°ä¾èµ–ï¼šA (ç»„)ç¡®å®š å”¯ä¸€Bï¼Œ B(ç»„)  ç¡®å®šå”¯ä¸€C  åˆ™Cä¼ é€’å‡½æ•°ä¾èµ–äºA</li><li>ç ï¼š ä¸€å¼ è¡¨ä¸­çš„ ä¸€ä¸ªå±æ€§æˆ–å±æ€§ç»„è¢«å…¶ä»–æ‰€æœ‰å±æ€§å®Œå…¨ä¾èµ–ï¼Œåˆ™è¿™ä¸ªå±æ€§ä¸ºè¯¥      è¡¨çš„ç <ul><li>ä¸»å±æ€§ï¼šç å±æ€§ç»„ä¸­çš„æ‰€æœ‰å±æ€§</li></ul></li></ul></li><li>ç¬¬ä¸‰èŒƒå¼ï¼Œåœ¨ç¬¬äºŒèŒƒå¼åŸºç¡€ä¸Šï¼Œä»»ä½•éä¸»å±æ€§ä¸ä¾èµ–å…¶ä»–éä¸»å±æ€§</li></ol><h2 id="æ•°æ®åº“çš„å¤‡ä»½å’Œè¿˜åŸ">æ•°æ®åº“çš„å¤‡ä»½å’Œè¿˜åŸ</h2><ol><li>å‘½ä»¤è¡Œï¼š<ul><li>mysqldump -uuser -ppassword xxx(database)&gt;path</li><li>ä½¿ç”¨å¤‡ä»½æ–‡ä»¶ source path;</li></ul></li></ol><hr><h2 id="å¤šè¡¨æŸ¥è¯¢">å¤šè¡¨æŸ¥è¯¢</h2><div class="code-wrapper"><pre class="language-none"><code class="language-none">* è¯­æ³•ï¼šselect * from  aaa,bbb,......ï¼ˆç¬›å¡å°”ç§¯æ–¹å¼ï¼‰</code></pre></div><ul><li><p>å¤šè¡¨æŸ¥è¯¢çš„åˆ†ç±»</p><ol><li>å†…è¿æ¥æŸ¥è¯¢ï¼š</li><li>éšå¼å†…è¿æ¥æŸ¥è¯¢ï¼š<br>Select *(<a href="http://emp.name">emp.name</a>)  from aaa,bbb WHERE <a href="http://emp.id=dept.id">emp.id=dept.id</a>;<br>è§„èŒƒå†™æ³•<br>Select <a href="http://t1.name">t1.name</a>,<a href="http://t2.name">t2.name</a><br>from  emp t1, dept t2<br>WHERE <a href="http://t1.id=t2.id">t1.id=t2.id</a>;</li><li>æ˜¾ç¤ºå†…è¿æ¥ï¼š<br>select xxx from table (INNER) JOIN table2 on <a href="http://emp.id=dept.id">emp.id=dept.id</a>;</li><li>å¤–è¿æ¥æŸ¥è¯¢ï¼š<br>å·¦å¤–è¿æ¥ï¼š<br>SELECT XX FROM TABLE LEFT [OUTER] JOIN table2 ON <a href="http://table.id=table2.id">table.id=table2.id</a>;<br><strong>æŸ¥è¯¢å·¦è¡¨æ‰€æœ‰æ•°æ®ä»¥åŠäº¤é›†éƒ¨åˆ† ï¼ˆé¿å…on æŸ¥è¯¢ä¸­çš„ç©ºå€¼ç°è±¡ï¼‰</strong><br>å³å¤–è¿æ¥ï¼šåŒä¸Š</li><li>å­æŸ¥è¯¢ï¼š<ol><li>ç»“æœæ˜¯å•è¡Œå•åˆ—ï¼š<br>å¯ä½œä¸ºæ¡ä»¶ï¼Œç”¨è¿ç®—ç¬¦åˆ¤æ–­ ï¼ˆæ¯”å¦‚avg maxâ€¦ï¼‰</li><li>ç»“æœæ˜¯å¤šè¡Œå•åˆ—(å¤šä¸ªidå€¼)<br>in(â€¦)</li><li>ç»“æœæ˜¯å¤šè¡Œå¤šåˆ—çš„<br>å­æŸ¥è¯¢å¯ä½œä¸ºä¸€å¼ è™šæ‹Ÿè¡¨ï¼Œä½œä¸ºè¡¨çš„æŸ¥è¯¢</li></ol></li></ol><hr><h2 id="äº‹åŠ¡">äº‹åŠ¡</h2><ol><li>åŸºæœ¬ä»‹ç»<ul><li>æ¦‚å¿µï¼šåŒ…å«å¤šä¸ªæ“ä½œçš„ä¸šåŠ¡ï¼Œè¢«äº‹åŠ¡ç®¡ç†æ—¶ï¼Œè¦ä¹ˆåŒæ—¶æˆåŠŸè¦ä¹ˆåŒæ—¶å¤±è´¥ï¼ˆä¾‹å¦‚è½¬è´¦ï¼‰</li><li>æ“ä½œï¼š<ul><li><ol><li>å¼€å¯äº‹åŠ¡-start transaction;</li></ol></li><li><ol start="2"><li>å›æ»š-rollback(å‘ç°é—®é¢˜æ—¶å›æ»š);</li></ol></li><li><ol start="3"><li>æäº¤-commit;</li></ol></li><li>Mysqlæ•°æ®åº“ä¸­äº‹åŠ¡é»˜è®¤è‡ªåŠ¨æäº¤:ä¸€æ¡DMLè‡ªåŠ¨æäº¤ä¸€æ¬¡äº‹åŠ¡<br>ï¼ˆOracleæ˜¯æ‰‹åŠ¨æäº¤çš„ï¼‰<br>æŸ¥çœ‹é»˜è®¤æäº¤æ–¹å¼ select @@autocommit<br>ä¿®æ”¹ ï¼š  set â€¦ =0ï¼› ï¼ˆæ‰‹åŠ¨æäº¤ï¼‰<br>2.äº‹åŠ¡çš„å››å¤§ç‰¹å¾</li></ul></li></ul><ol><li>åŸå­æ€§ï¼š æ˜¯ä¸å¯åˆ†å‰²çš„æœ€å°æ“ä½œå•ä½</li><li>æŒä¹…æ€§ï¼š äº‹åŠ¡ä¸€æ—¦æäº¤æˆ–å›æ»šï¼Œæ•°æ®åº“å°†æŒä¹…çš„ä¿å­˜æ•°æ®</li><li>éš”ç¦»æ€§ï¼š å¤šä¸ªäº‹åŠ¡ä¹‹é—´ï¼Œç›¸äº’ç‹¬ç«‹</li><li>ä¸€è‡´æ€§ï¼š äº‹åŠ¡æ“ä½œå‰åï¼Œæ•°æ®æ€»é‡ä¸å˜ï¼ˆå®ˆæ’ï¼‰<br>3.äº‹åŠ¡çš„éš”ç¦»çº§åˆ«</li></ol><ul><li>æ¦‚å¿µï¼š å¤šä¸ªäº‹åŠ¡æ“ä½œåŒä¸€æ‰¹æ•°æ®ï¼Œå¼•å‘ä¸€äº›é—®é¢˜ï¼Œè®¾ç½®éš”ç¦»çº§åˆ«ä¾¿å¯ä»¥è§£å†³     è¿™äº›é—®é¢˜</li><li>å­˜åœ¨é—®é¢˜ï¼š<ol><li>è„è¯»ï¼š ä¸€ä¸ªäº‹åŠ¡è¯»å–åˆ°å¦ä¸€ä¸ªäº‹åŠ¡ä¸­æœªæäº¤çš„æ•°æ®</li><li>ä¸å¯é‡å¤è¯»ï¼ˆè™šè¯»ï¼‰ï¼šåŒä¸€ä¸ªäº‹åŠ¡ä¸­ä¸¤æ¬¡å¾—åˆ°çš„æ•°æ®ä¸ä¸€è‡´</li><li>å¹»è¯»ï¼šä¸€ä¸ªäº‹åŠ¡æ“ä½œDMLæ•°æ®è¡¨ä¸­æ‰€æœ‰è®°å½•ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡æ·»åŠ äº†ä¸€æ¡     æ•°æ®ï¼Œåˆ™ç¬¬ä¸€ä¸ªäº‹åŠ¡æŸ¥è¯¢ä¸åˆ°è‡ªå·±çš„ä¿®æ”¹</li></ol></li><li>éš”ç¦»çº§åˆ«ï¼š<ol><li>read uncommittedï¼š è¯»æœªæäº¤ ï¼ˆè„è¯»ã€è™šåº¦ã€å¹»è¯»ï¼‰</li><li>read committed ï¼š è¯»å·²æäº¤ ï¼ˆä¸å¯é‡å¤è¯»ï¼Œå¹»è¯»ï¼‰</li><li>repeatable readï¼šå¯é‡å¤åº¦ ï¼ˆå¹»è¯»ï¼‰(é»˜è®¤)</li><li>seriablizableï¼š ä¸²è¡Œæ¢ï¼ˆè§£å†³æ‰€æœ‰é—®é¢˜ï¼‰</li></ol></li><li>æŸ¥è¯¢éš”ç¦»çº§åˆ«ï¼š<br>select @tx_isolation;<br>*è®¾ç½®ï¼š set global transaction isolation level â€¦;</li></ul></li></ol></li></ul><h2 id="DCL-ï¼šç®¡ç†ç”¨æˆ·ï¼Œæˆæƒ-ï¼š">DCL  ï¼šç®¡ç†ç”¨æˆ·ï¼Œæˆæƒ  ï¼š</h2><p>DBA: æ•°æ®åº“ç®¡ç†å‘˜ï¼š<br>1. ç®¡ç†ç”¨æˆ·ï¼š<br>* æŸ¥è¯¢ï¼šåˆ‡æ¢mysqlæ•°æ®åº“ï¼Œ æŸ¥è¯¢userè¡¨<br>% è¡¨ç¤ºå¯ä»¥å†ä»»æ„ä¸»æœºä½¿ç”¨ç”¨æˆ·ç™»å½•æ•°æ®åº“<br>* åˆ›å»ºï¼š Create user â€˜namexxx@â€˜ä¸»æœºåâ€™ indentified by â€˜passwordâ€™<br>* åˆ é™¤ï¼š DROP USER â€˜namexxx@â€˜ä¸»æœºåâ€™<br>2. ä¿®æ”¹ç”¨æˆ·å¯†ç ï¼š<br>UPDATE USER SET password = password(â€˜xxxâ€™) where user =â€˜xxxâ€™â€™<br>set password dor â€˜nameâ€™@â€˜zhujiâ€™ =password(â€˜newpasswordâ€™)â€™<br>å¿˜è®°å¯†ç åï¼š<br>1. net stop mysql  â€”åœæ­¢æœåŠ¡ ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰<br>2. mysqld --skip-grant-tablesâ€”ä½¿ç”¨æ— éªŒè¯æ–¹å¼å¯åŠ¨<br>3. æ‰“å¼€æ–°çš„cmd çª—å£ï¼Œç›´æ¥è¾“å…¥mysql å‘½ä»¤<br>4. user mysql<br>5. ä½¿ç”¨å‘½ä»¤æ›´æ”¹ â€¦<br>6. å…³é—­çª—å£<br>7. æ‰“å¼€ä»»åŠ¡ç®¡ç†å™¨ï¼Œæ‰‹åŠ¨ç»“æŸmysqldè¿›ç¨‹<br>3. æˆæƒï¼š<br>1. æŸ¥è¯¢æƒé™<br>show grants for â€˜userâ€™@â€˜hostxxxâ€™;<br>2. æˆäºˆæƒé™<br>grant æƒé™åˆ—è¡¨ on xxxdatabase .xxxtable to â€˜xxxUserâ€™@â€˜hostâ€™;<br>allï¼ˆæ‰€æœ‰æƒé™ï¼‰<br>3. æ’¤é”€æƒé™<br>revoke xxx on xxxdatabase.xxtable to  â€˜xxxUserâ€™@â€˜hostâ€™;</p><hr><h2 id="JDBC-Template-ä¸-è¿æ¥æ± ">JDBC Template ä¸ è¿æ¥æ± </h2><h3 id="æ•°æ®åº“è¿æ¥æ± ">æ•°æ®åº“è¿æ¥æ± </h3><ol><li><p>ç›®çš„ï¼šï¼ˆé¿å…ä½¿ç”¨åå°±å¼€é™¤çš„ç°è±¡ï¼‰ èŠ‚çº¦ç”¨æˆ·æ—¶é—´ï¼Œé‡å¤ä½¿ç”¨è¿æ¥å¯¹è±¡ã€‚</p></li><li><p>æ¦‚å¿µï¼š å®¹å™¨ã€‚å­˜æ”¾æ•°æ®åº“è¿æ¥ï¼Œç³»ç»Ÿåˆå§‹åå®¹å™¨è¢«åˆ›å»ºï¼Œå®¹å™¨ä¸­ç”³è¯·ä¸€äº›è¿æ¥å¯¹è±¡ï¼Œç”¨   æˆ·è®¿é—®æ•°æ®åº“æ—¶ï¼Œä»å®¹å™¨ä¸­è·å–è¿æ¥å¯¹è±¡ï¼Œè®¿é—®åå°†å½’è¿˜è¿™äº›è¿æ¥å¯¹è±¡</p></li><li><p>æœ‰ç‚¹ï¼š èŠ‚çº¦èµ„æºï¼Œ ç”¨æˆ·è®¿é—®é«˜æ•ˆ</p></li><li><p>å®ç°ï¼š</p><ol><li><p>æ¥å£ï¼šdatasource</p><ul><li>æ–¹æ³•getConnection()è·å–è¿æ¥</li><li>è‹¥æ˜¯ä»è¿æ¥æ± ä¸­ï¼Œåˆ™connection.closeï¼ˆï¼‰ä»£è¡¨å½’è¿˜è¿™ä¸€ä¸ª è¿æ¥</li><li>ç”±æ•°æ®åº“å‚å•†æ¥å®ç°<br>2.C3P0:æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯</li></ul><ol><li>å¯¼å…¥jaråŒ… ä»¥åŠä¾èµ–çš„jaråŒ… æ”¾å…¥libsä¸­</li><li><strong>å®šä¹‰é…ç½®æ–‡ä»¶(properties OR xml )å¹¶ ç›´æ¥æ”¾å…¥srcç›®å½•</strong><br>*ä¸€ä¸ªé…ç½®æ–‡ä»¶å¯ä»¥æœ‰å¤šä¸ªé…ç½® ï¼Œä»¥é…ç½®ååŒºåˆ«<ul><li>è®¾ç½®URL user password</li><li>è®¾ç½®æœ€å¤§è¿æ¥æ•°ä¸è¶…æ—¶è¿æ¥ç§’æ•°</li></ul></li><li>åˆ›å»ºæ ¸å¿ƒå¯¹è±¡<br>DataSource ss = new ComboPooledDataSourceï¼ˆxï¼‰<br>å‚æ•°ä¸ºç©ºï¼š é»˜è®¤é…ç½®<br>å‚æ•°ä¸ºConfignameï¼šæŒ‡å®šé…ç½®<br>Connection con=ds.getConnection</li><li>è¿æ¥</li></ol></li><li><p>Druidï¼šæ•°æ®åº“è”æœºåƒå®ç°æŠ€æœ¯ï¼Œbyé˜¿é‡Œå·´å·´ï¼ˆæ€§èƒ½å¥½ï¼‰</p><ol><li><p>å¯¼å…¥jaråŒ…</p></li><li><p>é…ç½®æ–‡ä»¶</p><ul><li>properties</li><li>å¯ä»¥ä»»æ„åç§° ä»»æ„è·¯å¾„ï¼Œä¸è‡ªåŠ¨åŠ è½½</li></ul></li><li><p>è·å–æ•°æ®åº“è¿æ¥æ± å¯¹è±¡ ï¼šé€šè¿‡å·¥å‚ç±»è·å–<br>ds=DruidDataSourceFactory.creteDataSourceï¼ˆéœ€è¦proå¯¹è±¡ï¼‰</p><p>thiscalss.class.getClassloaaer()â€¦getReourcesAsStream(â€œxxx.xxâ€)</p></li><li><p>è¿æ¥<br>conn=ds.getConnection();</p></li></ol></li><li><p>**å®šä¹‰å·¥å…·ç±» **</p></li></ol><h3 id="Spring-JDBCâ€“JDBC-Template">Spring JDBCâ€“JDBC Template</h3><div class="code-wrapper"><pre class="language-none"><code class="language-none"> *Spring æ¡†æ¶å¯¹JDBCçš„ç®€å•å°è£…</code></pre></div><p>1.å¯¼å…¥jaråŒ…<br>2.åˆ›å»ºjdbctemplateå¯¹è±¡ï¼Œä¾èµ–äºdataSource<br>jdbctemplate t=new jdbctemplate(dsï¼‰<br>3.è°ƒç”¨å…¶ä¸­æ–¹æ³•å®Œæˆcrudæ“ä½œ**ï¼ˆå»ºè®®æŸ¥çœ‹æºç ï¼‰**<br>1. update(sql,?1ï¼Œï¼Ÿ2,?3,?4â€¦)<br>ä¸éœ€è¦æ‰‹åŠ¨å…³é—­è¿æ¥ â€¦è‡ªåŠ¨å½’è¿˜è¿æ¥<br>2. queryformap() <strong>ï¼ˆåªèƒ½æ˜¯ä¸€ä¸ªæ•°æ®è¡Œï¼‰</strong><br>3. queryforlist()  å¯å…ˆå°†æ¯ä¸ªè®¡åˆ’ å°è£…æˆmap å† å°†mapä½œä¸ºlistçš„æ³›å‹<br>4. query() è¿”å›å¯¹è±¡ä¸ºjavabean<br>1. å‚æ•°ï¼ˆsql,new RowMapper<T>(){</p><div class="code-wrapper"><pre class="language-none"><code class="language-none"> &#125;ï¼‰ï¼›åŒ¿åå†…éƒ¨ç±»ï¼Œè‡ªå·±å®ç°æŸ¥æ‰¾æ–¹å¼ 2. ï¼ˆsqlï¼Œnew BeanPropertyRowMapper&lt;T&gt;(T.class)ï¼‰ æ³¨æ„ï¼šå¯¹äºæ•°æ®è¡¨ä¸­ä¸ºnullçš„å€¼ï¼Œæ™®é€šç±»å‹æ— æ³•è¯†åˆ«ï¼Œä¼šæŠ¥é”™ï¼Œè¿™é‡Œä½¿ç”¨åŒ…è£…ç±» è¿›è¡Œè§£å†³ 5. querForobject (sql, xxx.classï¼ˆxxx:æ•°æ®ç±»å‹ï¼‰)</code></pre></div></li></ol><h2 id="åŸºç¡€å‡½æ•°">åŸºç¡€å‡½æ•°</h2><h4 id="æ—¥æœŸ-v2">æ—¥æœŸ</h4><p>now() è¿”å›å½“å‰ç³»ç»Ÿæ—¥æœŸ+æ—¶é—´</p><p>curdate() è¿”å›å½“å‰æ—¶é—´ï¼Œä¸åŒ…æ‹¬å…·ä½“æ—¶åˆ†ç§’</p><p>select year((now)) month\monthnameâ€¦åŒç†è·å¾—å½“å‰æ—¶é—´</p><p>str_to_date(xxxxxxx,%c-%m-%Yâ€™)  ï¼šæ—¥æœŸæ ¼å¼å­—ç¬¦è½¬æ¢æˆåˆ¶å®šæ ¼å¼</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211005161627866.png" alt="image-20211005161627866"></p><p>date_format:æ—¥æœŸè½¬æ¢æˆå­—ç¬¦ï¼Œä¸€æ ·éµå¾ªä»¥ä¸Šæ ¼å¼</p><h4 id="æµç¨‹æ§åˆ¶å‡½æ•°">æµç¨‹æ§åˆ¶å‡½æ•°</h4><p><strong>ifå‡½æ•°</strong></p><p>if(e1,e2,e3)    ä¸‰å…ƒè¿ç®—ç¬¦</p><p><strong>caseå‡½æ•°</strong></p><p>case â€¦<br>when x then y;<br>when a then b;<br>â€¦<br>else n;<br>end</p><h3 id="åˆ†ç»„å‡½æ•°">åˆ†ç»„å‡½æ•°</h3><p>ç”¨åšç»Ÿè®¡ä½¿ç”¨ï¼Œåˆå«èšåˆå‡½æ•°</p><p>sum avg max min count</p><ul><li>å¿½ç•¥nullå€¼ï¼Œæœ‰nullå€¼çš„æ¯”å¦‚avgä¹Ÿå°±ä¸åšåˆ†æ¯</li><li>countå¿½ç•¥nullå€¼</li><li>maxã€minã€countå¤„ç†ä»»ä½•ç±»å‹â€˜sumã€avgå¤„ç†æ•°å€¼ç±»å‹â€™</li><li>å’Œdistinctæ­é…ï¼Œå»é‡</li></ul><h3 id="åˆ†ç»„æŸ¥è¯¢">åˆ†ç»„æŸ¥è¯¢</h3><p>ç­›é€‰åˆ†æˆåˆ†ç»„å‰å’Œåˆ†ç»„åçš„ç­›é€‰</p><p><strong>åˆ†ç»„å‰</strong></p><p>åŒä¸€åˆ—åˆ†ç»„  group byä¸€èˆ¬åœ¨fromå           å…³é”®å­— ï¼š<strong>where</strong></p><p>ä½¿ç”¨group byéœ€è¦æ³¨æ„è¡Œæ•°ç»Ÿä¸€ï¼Œå¯ä»¥è¿›è¡Œå¤šä¸ªåˆ†ç»„</p><p><strong>åˆ†ç»„å</strong></p><p>å…³é”®å­—ï¼š<strong>having</strong></p><p>å¯¹group byçš„å…·ä½“é™åˆ¶ã€‚ å±äºåˆ†ç»„åçš„ç­›é€‰</p><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql">select count(*),dep_id from staff group by dep_id having count(*) &gt;&#x3D; 2;</code></pre></div><h3 id="è¿æ¥æŸ¥è¯¢ï¼ˆå¤šè¡¨æŸ¥è¯¢ï¼‰">è¿æ¥æŸ¥è¯¢ï¼ˆå¤šè¡¨æŸ¥è¯¢ï¼‰</h3><p>sq92</p><p><strong>ç­‰å€¼è¿æ¥</strong></p><p>where <a href="http://s.id">s.id</a> = <a href="http://d.id">d.id</a>,æ¬¡æ¬¡è½®å¾ªåŒ¹é…</p><p><strong>éç­‰å€¼è¿æ¥</strong></p><p><strong>è‡ªè¿æ¥</strong></p><p>emp e,emp e2</p><p>sq99 1999å¹´çš„æ–°çš„sqlæ ‡å‡†</p><p><strong>å†…è¿æ¥</strong></p><p>select â€¦ from â€¦  <strong>ï¼ˆinner ï¼‰join</strong>   emp p  <strong>on</strong> â€¦</p><p>æ‹¿ä¸€å¼ è¡¨å»åŒ¹é…å¦å¤–ä¸€å¼ è¡¨</p><p><strong>å¤–è¿æ¥</strong></p><p>ä¸€ä¸ªè¡¨æœ‰ï¼Œå¦ä¸€ä¸ªè¡¨æ²¡æœ‰çš„æƒ…å†µ = å†…è¿æ¥ç»“æœ+ä¸»è¡¨ä¸­æœ‰ä½†ä»è¡¨æ²¡æœ‰çš„è®°å½•</p><p>left outer å·¦è¾¹çš„æ˜¯ä¸»è¡¨  right outer å³è¾¹çš„æ˜¯ä¸»è¡¨</p><p><strong>å…¨å¤–è¿æ¥</strong></p><p>ä»è¡¨ä¸­æœ‰ä¸»è¡¨ä¸­æ²¡æœ‰çš„ä¹Ÿèƒ½æŸ¥å‡ºæ¥</p><p><strong>äº¤å‰è¿æ¥</strong></p><p>cross join   ç¬›å¡å°”ä¹˜ç§¯</p><h3 id="å­æŸ¥è¯¢">å­æŸ¥è¯¢</h3><p>å­æŸ¥è¯¢å‡ºç°ä½ç½®</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211006164521956.png" alt="image-20211006164521956"></p><h4 id="whereã€havingå">whereã€havingå</h4><ol><li><p>æ ‡é‡å­æŸ¥è¯¢</p><p>ä¸€èˆ¬ç”¨ &gt; &lt; = è¿™ç±»çš„ç¬¦å·è¿æ¥</p><div class="code-wrapper"><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> salary<span class="token keyword">from</span> staff<span class="token keyword">where</span> salary <span class="token operator">></span>      <span class="token punctuation">(</span><span class="token keyword">select</span> salary <span class="token keyword">from</span> staff          <span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">'èµµäº‘é¾™'</span><span class="token punctuation">)</span></code></pre></div></li><li><p>åˆ—å­æŸ¥è¯¢</p><p>ä½¿ç”¨å¤šè¡Œæ¯”è¾ƒæ“ä½œç¬¦</p><p>in/ not inï¼ˆä»»æ„ä¸€ä¸ªï¼‰  any/some(æŸä¸€ä¸ª)  all(æ‰€æœ‰)</p></li><li><p>è¡Œå­æŸ¥è¯¢</p><p>å¤šä¸ªå­—æ®µå½“æˆä¸€è¡Œæ¥ç”¨</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211006165928954.png" alt="image-20211006165928954"></p></li></ol><h4 id="selectå">selectå</h4><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># æŸ¥è¯¢éƒ¨é—¨çš„äººæ•°,ä¹Ÿå¯ä»¥ç”¨è¿æ¥æŸ¥è¯¢...select d.name,(    select count(*)    from staff s    where s.dep_id &#x3D; d.id    )from Dep d;</code></pre></div><h4 id="fromå">fromå</h4><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># æ³¨æ„ï¼šfromåçš„å­æŸ¥è¯¢çš„è¡¨éœ€è¦èµ·åˆ«åselect salaryfrom (     select * from staff    where salary &lt; 30000         ) as staff;</code></pre></div><h4 id="existså">existså</h4><p><strong>ç›¸å…³å­æŸ¥è¯¢</strong></p><p>1 è¡¨ç¤ºæœ‰å€¼      0 è¡¨ç¤ºæ²¡æœ‰æŸ¥åˆ°</p><h3 id="åˆ†é¡µæŸ¥è¯¢">åˆ†é¡µæŸ¥è¯¢</h3><p>æ•°æ®å¤ªå¤š</p><p>limit startOffsetï¼Œsize;ï¼ˆèµ·å§‹ç´¢å¼•ä» <strong>0</strong> å¼€å§‹ï¼‰</p><h3 id="è”åˆæŸ¥è¯¢">è”åˆæŸ¥è¯¢</h3><p>å°†å¤šæ¡æŸ¥è¯¢è¯­å¥åˆå¹¶æˆä¸€ä¸ªç»“æœ</p><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql">select * from staff where dep_id &#x3D; 3 union select * from staff where id &lt; 10;# equivalent to select * from staff where dep_od &#x3D; 3 or id &lt; 10;# ç²—æš´æ‹¼æ¥ï¼Œä¸è€ƒè™‘è¡¨ç±»å‹æ˜¯å¦ç›¸åŒï¼Œä¸”æŸ¥è¯¢åˆ—æ•°é‡å¿…é¡»ç›¸åŒï¼ŒæŸ¥è¯¢é¡ºåºå¯ä»¥ä¸åŒï¼Œå¯ä»¥ä¸å¯¹åº”# å¹¶ä¸”ä¼šå»æ‰é‡å¤é¡¹ï¼ˆæŸ¥è¯¢å‡ºçš„å€¼å®Œå…¨ç›¸åŒï¼‰ --ä¸æƒ³å»é‡:  union allselect id,name from Dep where id &lt; 10 union select levelDes,id from level where id &lt; 10;</code></pre></div><h2 id="åŸºç¡€è¿›é˜¶">åŸºç¡€è¿›é˜¶</h2><h3 id="äº‹åŠ¡-v2">äº‹åŠ¡</h3><p>TCL  Transaction Control Language äº‹åŠ¡æ§åˆ¶è¯­è¨€</p><p>ä¸€ç»„sqlè¯­å¥ç»„æˆä¸€ä¸ªæ‰§è¡Œå•å…ƒï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œ</p><h4 id="å­˜å‚¨å¼•æ“">å­˜å‚¨å¼•æ“</h4><p>mysqlä¸­çš„æ•°æ®ç”¨å„ç§ä¸åŒçš„æŠ€æœ¯å­˜å‚¨åœ¨æ–‡ä»¶ä¸­ï¼ˆå†³å®šç”¨ä»€ä¹ˆæ–¹å¼æ¥å­˜ï¼‰</p><p>show engines</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211009204408842.png" alt="image-20211009204408842"></p><p>innodb æ”¯æŒäº‹åŠ¡ï¼Œå…¶ä»–çš„åˆ™ä¸æ”¯æŒ</p><h4 id="äº‹åŠ¡çš„ACIDå±æ€§"><strong>äº‹åŠ¡çš„ACIDå±æ€§</strong></h4><ul><li>åŸå­æ€§ Atomicity<ul><li>æŒ‡äº‹åŠ¡æ˜¯ä¸€ä¸ª<strong>ä¸å¯åˆ†å‰²</strong>çš„å·¥ä½œå•ä½ï¼Œäº‹åŠ¡ä¸­çš„æ“ä½œè¦ä¹ˆéƒ½å‘ç”Ÿï¼Œè¦ä¹ˆéƒ½ä¸å‘ç”Ÿ</li></ul></li><li>ä¸€è‡´æ€§ Consistency<ul><li>äº‹åŠ¡å¿…é¡»ä½¿æ•°æ®åº“ä»ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€è½¬æ¢åˆ°å¦ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€</li></ul></li><li>éš”ç¦»æ€§ Isolation<ul><li>ä¸€ä¸ªäº‹ç‰©çš„æ‰§è¡Œä¸èƒ½è¢«å…¶ä»–äº‹åŠ¡å¹²æ‰°ï¼Œä¸€ä¸ªäº‹åŠ¡å†…éƒ¨çš„æ“ä½œåŠä½¿ç”¨çš„æ•°æ®å¯¹å¹¶å‘çš„å…¶ä»–äº‹åŠ¡çš„éš”ç¦»çš„ã€‚</li></ul></li><li>æŒä¹…æ€§ Durability<ul><li>ä¸€ä¸ªäº‹åŠ¡ä¸€æ—¦è¢«æäº¤ï¼Œå®ƒå¯¹æ•°æ®åº“ä¸­çš„æ•°æ®æ”¹å˜å°±æ˜¯æ°¸ä¹…æ€§çš„ï¼ˆæ³¨æ„commitçš„åœ°ä½ï¼‰</li></ul></li></ul><h4 id="äº‹åŠ¡çš„åˆ›å»º">äº‹åŠ¡çš„åˆ›å»º</h4><h5 id="éšå¼äº‹åŠ¡">éšå¼äº‹åŠ¡</h5><p>insert update delete    ï¼ˆä½†å¤šä¸ªsqlåˆåœ¨ä¸€èµ·å°±ä¸æ˜¯äº†ï¼‰</p><p>variable ï¼šautocommitå†³å®šæ˜¯å¦å¼€å¯éšå¼äº‹åŠ¡</p><h5 id="æ˜¾å¼äº‹åŠ¡">æ˜¾å¼äº‹åŠ¡</h5><ol><li>å‰æï¼šå…ˆè®¾ç½®autocommit ä¸º 0 ï¼ˆåªé’ˆå¯¹å½“å‰ä¼šè¯ï¼‰</li><li>start transactionï¼ˆå¯ä¸å†™ï¼Œé»˜è®¤ï¼‰</li><li>å†™sqlï¼Œæ‰§è¡Œååœ¨è¡¨ä¸­å€¼å·²ç»è¢«æ›´æ”¹ä½†æœªè¢«commit</li><li>æäº¤äº‹åŠ¡ commitï¼ˆæˆ–è€…åœ¨commitä¹‹å‰å›æ»šäº‹åŠ¡ï¼Œæ¢å¤åˆ°ä¹‹å‰çš„çŠ¶æ€ï¼‰</li></ol><h4 id="äº‹åŠ¡çš„éš”ç¦»çº§åˆ«">äº‹åŠ¡çš„éš”ç¦»çº§åˆ«</h4><p>åŒæ—¶è¿è¡Œå¤šä¸ªäº‹åŠ¡ï¼Œè®¿é—®ç›¸åŒçš„æ•°æ®æ—¶ï¼Œæ²¡æœ‰é€‚å½“çš„éš”ç¦»æœºåˆ¶ï¼Œå°±ä¼šå¯¼è‡´å„ç§å¹¶å‘é—®é¢˜</p><ul><li><strong>è„è¯»</strong>ï¼šä¸¤ä¸ªäº‹åŠ¡ï¼ŒT1è¯»å–äº†T2æ›´æ–°äº†ä½†æœªcommitçš„å­—æ®µï¼Œè‹¥T2å›æ»šï¼Œåˆ™T1è¯»å–çš„æ•°æ®å°±æ˜¯æ— æ•ˆçš„</li><li><strong>ä¸å¯é‡å¤è¯»</strong>ï¼šT1è¯»å–äº†ä¸€ä¸ªå­—æ®µï¼Œç„¶åT2æ›´æ–°äº†è¯¥å­—æ®µ(æäº¤)ï¼Œä¹‹åT1å†æ¬¡è¯»å–åï¼Œå€¼å°±ä¸ä¸€æ ·äº†ï¼ˆä»è‡ªèº«çš„è§’åº¦è¯´ï¼Œâ€œæˆ‘ä»€ä¹ˆéƒ½æ²¡å¹²ï¼Œä½†ç»“æœå´ä¸ä¸€æ ·äº†â€ï¼‰</li><li><strong>å¹»è¯»</strong>ï¼šT1è¯»äº†ä¸€ä¸ªå­—æ®µï¼Œä½†T2åœ¨è¡¨ä¸­æ’å…¥äº†ä¸€äº›æ–°çš„è¡Œï¼Œå¦‚æœT1å†è¯»ï¼Œå°±ä¼šå¤šå‡ºå‡ è¡Œ<ul><li>æ¯”å¦‚updateçš„æ—¶å€™ï¼Œä¸€ä¸ªäº‹åŠ¡å·²ç»æäº¤äº†ï¼Œä½†å¯¹å¦ä¸€ä¸ªäº‹åŠ¡æ¥è¯´ï¼Œselectåªçœ‹åˆ°ä¸‰æ¡ï¼Œä½†æœ€ç»ˆæ¯”å¦‚æ›´æ–°årowçš„å½±å“æ¡æ•°æ˜¯äº”æ¡</li></ul></li></ul><p><strong>äº‹åŠ¡ä¸­deleteè¡¨åè¿˜å¯ä»¥å›æ»šï¼Œä½†truncateä¸å¯å›æ»šï¼</strong></p><p>Mysqlä¸­æä¾›çš„4ç§éš”ç¦»çº§åˆ«</p><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># æŸ¥çœ‹å½“å‰çš„éš”ç¦»çº§åˆ«select @@tx_isolation# è®¾ç½®éš”ç¦»çº§åˆ«ï¼ˆåªé’ˆå¯¹å½“å‰è¿æ¥ï¼‰set (global ä»£è¡¨è®¾ç½®å…¨å±€çš„)session transaction isolation level xxxx;# å®éªŒå‰æï¼šä¸¤ä¸ªä¼šè¯éƒ½éœ€è¦éƒ½å¼€å¯ä¸€ä¸ªäº‹åŠ¡ set autocommit &#x3D; 0;</code></pre></div><ul><li>read- uncommitted è¯»æœªæäº¤<ul><li>å•¥éƒ½åšä¸äº†</li></ul></li><li>read committed è¯»å·²æäº¤<ul><li>é¿å…è„è¯»ï¼Œä½†ä¸å¯é‡å¤è¯»ã€å¹»è¯»ä¸èƒ½é¿å…</li></ul></li><li>repeatable read å¯é‡å¤è¯»<ul><li>é¿å…è„è¯»+ä¸å¯é‡å¤è¯»</li></ul></li><li>serializable ä¸²è¡ŒåŒ–<ul><li>éƒ½å¯é¿å…</li><li>ä¼šé˜»å¡ä½,æ€§èƒ½ååˆ†ä½ä¸‹</li></ul></li></ul><h4 id="ä¿å­˜ç‚¹">ä¿å­˜ç‚¹</h4><p><strong>savepoint x</strong>åªæ­é…<strong>rollback to x</strong>ä½¿ç”¨</p><h4 id="è§†å›¾">è§†å›¾</h4><p>ä¸€ç§è™šæ‹Ÿè¡¨ï¼Œ5.1ç‰ˆæœ¬åçš„æ–°ç‰¹æ€§ï¼Œé€šè¿‡è¡¨åŠ¨æ€ç”Ÿæˆçš„æ•°æ®ï¼ˆç±»ä¼¼ä¸´æ—¶æ‹¼å‡‘çš„è¡¨ï¼Œå¯é‡å¤åˆ©ç”¨ï¼‰</p><p>åªä¿å­˜sqlé€»è¾‘ï¼Œä¸ä¿å­˜æŸ¥è¯¢ç»“æœ</p><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql">create view v1asselect id,namefrom staffwhere dep_id &#x3D; 3;select * from v1;</code></pre></div><ul><li><strong>è§†å›¾å¯é‡ç”¨ï¼›å‡å°‘sqlæ“ä½œ</strong></li><li><strong>ä¸å¿…çŸ¥é“æŸ¥è¯¢ç»†èŠ‚</strong></li><li><strong>ä¿æŠ¤æ•°æ®ï¼Œæé«˜å®‰å…¨æ€§</strong></li></ul><p><strong>æ“ä½œè§†å›¾</strong></p><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># ä¿®æ”¹è§†å›¾create or replace viewas...alter view xxxas...# åˆ é™¤è§†å›¾drop view xxx# æŸ¥çœ‹è§†å›¾ç»“æ„desc view;# æ›´æ–°è§†å›¾ï¼ˆåŸå§‹è¡¨ä¹Ÿä¼šæœ‰ï¼‰insert into xxx values(.....); update xxx set ....; delete from xxx where ... ;#è§†å›¾æƒé™ï¼ˆä¸€èˆ¬çš„è§†å›¾é‡Œæ˜¯ä¸å…è®¸æ›´æ–°åˆ°çœŸå®è¡¨ä¸­çš„ï¼‰</code></pre></div><h4 id="è§†å›¾æƒé™">è§†å›¾æƒé™</h4><p>å…·æœ‰ä¸€ä¸‹å…³é”®å­—çš„sqlè¯­å¥çš„è§†å›¾ï¼Œæ˜¯ä¸èƒ½æ›´æ–°çš„</p><ul><li>group by  ï¼ˆè‚¯å®šï¼Œå› ä¸ºä¸çŸ¥é“æ€ä¹ˆæ”¹ï¼‰</li><li>å¸¸é‡è§†å›¾<ul><li>create view xxx as  select â€˜johnâ€™ name;</li><li>update xxx set name =â€˜avadâ€™;</li></ul></li><li>selectä¸­èƒ½å¤ŸåŒ…å«å­æŸ¥è¯¢</li><li>joinæˆ–è€…è¿æ¥ï¼ˆå¯æ›´æ–°ä¸å¯æ’å…¥ï¼‰</li><li>fromä¸€ä¸ªä¸èƒ½æ›´æ–°çš„è§†å›¾</li><li>whereå­å¥çš„å­æŸ¥è¯¢å¼•ç”¨äº†fromå­å¥ä¸­çš„è¡¨<ul><li><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211010220425178.png" alt="image-20211010220425178"></li></ul></li></ul><p><strong>è§†å›¾å’Œè¡¨çš„åŒºåˆ«</strong></p><ul><li>åˆ›å»ºè¯­æ³•ä¸åŒ</li><li>è§†å›¾åŸºæœ¬ä¸å®é™…å ç”¨ç‰©ç†ç©ºé—´ï¼ˆåªä¿å­˜sqlé€»è¾‘ï¼Œä¸ä¿å­˜æ•°æ®ï¼‰</li><li></li></ul><h3 id="å˜é‡-v2">å˜é‡</h3><h4 id="ç³»ç»Ÿå˜é‡">ç³»ç»Ÿå˜é‡</h4><p>500æ¡ï¼Œæ¯”è¾ƒå¤š</p><ul><li>å…¨å±€å˜é‡<ul><li>æœåŠ¡å™¨æ¯æ¬¡å¯åŠ¨ï¼Œå°†ä¸ºæ‰€æœ‰å…¨å±€å˜é‡èµ‹åˆå§‹å€¼</li><li>é’ˆå¯¹æ‰€æœ‰ä¼šè¯è¿æ¥æœ‰æ•ˆï¼Œä½†ä¸èƒ½è·¨é‡å¯ï¼ˆæœåŠ¡å™¨é‡å¯é»˜è®¤ï¼Œéœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼‰</li></ul></li><li>ä¼šè¯å˜é‡<ul><li>é’ˆå¯¹å½“å‰ä¼šè¯</li></ul></li></ul><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># æŸ¥çœ‹å…¨å±€&#x2F;ä¼šè¯å˜é‡show global | session variables (like &#39;....&#39;);# æŸ¥çœ‹åˆ¶å®šçš„ç³»ç»Ÿå˜é‡çš„å€¼select @@global.key_name;# èµ‹å€¼ï¼ˆåªè¦æ²¡åŠ globalï¼Œå°±æ˜¯sessionï¼‰set global|session key_name &#x3D; xxx;set @@global|@@session.key_name &#x3D; xxxx;</code></pre></div><h4 id="è‡ªå®šä¹‰å˜é‡">è‡ªå®šä¹‰å˜é‡</h4><ul><li>ç”¨æˆ·å˜é‡<ul><li>ä½œç”¨åŸŸï¼šé’ˆå¯¹å½“å‰ä¼šè¯</li><li>ä½¿ç”¨ï¼šå£°æ˜ã€èµ‹å€¼ã€ä½¿ç”¨</li></ul></li><li>å±€éƒ¨å˜é‡<ul><li><strong>ä»…åœ¨å®šä¹‰å®ƒçš„begin endå—ä¸­æœ‰æ•ˆ</strong></li></ul></li></ul><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># ç”¨æˆ·å˜é‡å£°æ˜ ã€èµ‹å€¼set @user_key_name &#x3D; xx;set @user_key_name:&#x3D;xx;select @user_key_name:&#x3D;xx;# å°†æŸ¥è¯¢çš„ç»“æœèµ‹å€¼ç»™å˜é‡select xxx into @user_key_name from xxxxtable;# å±€éƒ¨å˜é‡å£°æ˜declare key_name type (default xxx);# èµ‹å€¼ä¸ä»¥ä¸Šç›¸åŒï¼Œä½†setæ—¶ä¸åŠ @ï¼Œç¬¬ä¸€ç§selectæ—¶éœ€è¦åŠ @</code></pre></div><h3 id="å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°">å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°</h3><p>mysqlæ•°æ®åº“ä¸­ procè¡¨åŒ…å«äº†function å’Œ functionçš„ç»Ÿè®¡</p><p>ç›®çš„ï¼š éƒ½æ˜¯ä¸€å †ä¸œè¥¿ï¼Œæ‰“ä¸ªåŒ…ï¼Œç®€åŒ–ä¸€ä¸‹</p><ul><li>å­˜å‚¨è¿‡ç¨‹<ul><li>æœ‰0ä¸ªæˆ–å¤šä¸ªè¿”å›ï¼Œé€‚åˆ<strong>æ‰¹é‡æ’å…¥ã€æ›´æ–°</strong></li></ul></li><li>å‡½æ•°<ul><li>æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªè¿”å›ï¼Œé€‚åˆåšå¤„ç†æ•°æ®åè¿”å›ä¸€ä¸ªç»“æœ</li></ul></li></ul><h4 id="å­˜å‚¨è¿‡ç¨‹">å­˜å‚¨è¿‡ç¨‹</h4><p>ä¸€ç»„é¢„å…ˆç¼–è¯‘å¥½çš„SQLé›†åˆï¼ˆç±»ä¼¼æ‰¹å¤„ç†è¯­å¥ï¼‰</p><ul><li>æé«˜ä»£ç é‡ç”¨æ€§</li><li>ç®€åŒ–æ“ä½œ</li><li>å‡å°‘äº† ç¼–è¯‘æ¬¡æ•°ã€å‡å°‘äº†å’Œæ•°æ®åº“æœåŠ¡å™¨çš„è¿æ¥æ¬¡æ•°ï¼Œæé«˜äº†æ•ˆç‡</li></ul><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># åˆ›å»ºcreate procedure a_name(param_columns...)begin...(legal sql dialects)# å­˜å‚¨è¿‡ç¨‹æä¸­çš„æ¯æ¡SQLè¯­å¥å¿…é¡»åŠ åˆ†å·# å­˜å‚¨è¿‡ç¨‹å€Ÿä½ä½¿ç”¨DELIMITERé‡æ–°è®¾ç½®end# param_columns ï¼šå‚æ•°æ¨¡å¼ + å‚æ•°å + å‚æ•°ç±»å‹# in&#x2F;out&#x2F;inout name varchar(20)# ç»“æŸæ ‡è®°,äº‹å…ˆè®¾ç½®DELIMITER $$#è°ƒç”¨æ–¹æ³•call a_name(params...);</code></pre></div><p>æ³¨æ„å‚æ•°æ¨¡å¼ï¼Œ</p><ul><li>inï¼Œå¯ä»¥ä½œä¸ºè¾“å…¥ï¼Œè¯¥å‚æ•°éœ€è¦è°ƒç”¨æ–¹æ³•ä¼ å…¥å€¼</li><li>outï¼Œè¯¥å‚æ•°å¯ä»¥ä½œä¸ºè¾“å‡ºï¼Œå³å‚æ•°å¯ä»¥ä½œä¸ºè¿”å›å€¼</li><li>inout</li></ul><h5 id="ç©ºå‚åˆ—è¡¨">ç©ºå‚åˆ—è¡¨</h5><h5 id="inæ¨¡å¼">inæ¨¡å¼</h5><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql">delimiter $;create procedure proc2(in sname varchar(20))begin    select name from staff  s where s.name &#x3D; sname;end $# è°ƒç”¨call proc2(&#39;èµµäº‘é¾™&#39;);</code></pre></div><p>é—®é¢˜ï¼š å‚æ•°åå­—å’Œåˆ—åå†²çªï¼ˆåŠ è¡¨åï¼›ä¹Ÿå¯ä»¥declareä¸€ä¸ªå±€éƒ¨å˜é‡ï¼‰</p><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql">declare temp varchar(29) default &#39;&#39;;select xxx into temp;</code></pre></div><h5 id="outæ¨¡å¼">outæ¨¡å¼</h5><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql">create procedure proc3(in sname varchar(20),out selfstr varchar(50) )begin    select self_intro into selfstr # intoç”¨æ¥å¤åˆ¶ï¼Œåå¯è·Ÿå¤šä¸ªoutå‚æ•°    from staff  s    where s.name &#x3D; sname;end;# é€šè¿‡è‡ªå®šä¹‰ç”¨æˆ·å˜é‡æ¥æ¥æ”¶è¿™äº›outå€¼CALL proc3(&#39;èµµäº‘é¾™&#39;,@selfStr);select @selfStr;</code></pre></div><h5 id="inoutæ¨¡å¼">inoutæ¨¡å¼</h5><p>ä¾‹å¦‚ï¼Œä¼ å…¥çš„å‚æ•°éƒ½æ”¹å˜çš„æƒ…å†µï¼ŒèŠ‚çœäº†å‚æ•°ä¸ªæ•°</p><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># **å­˜å‚¨è¿‡ç¨‹çš„åˆ é™¤**drop procedure xxx# æŸ¥çœ‹å­˜å‚¨è¿‡ç¨‹show create procedure xxx;</code></pre></div><h4 id="å‡½æ•°-v3">å‡½æ•°</h4><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># åˆ›å»ºcreate function xxx(params...) returns returntypebegin...end# parmas: å‚æ•°å + å‚æ•°ç±»å‹# å‡½æ•°ä½“æœ‰returnè¯­å¥ï¼Œä½†æ²¡æœ‰ä¹Ÿä¸æŠ¥é”™# è°ƒç”¨select xxx(params);# examplecreate function myf3(name varchar(20)) returns varchar(20)begin    declare c varchar(20) default 0;    select self_intro into c    from staff    where staff.name &#x3D; name;    return c;end $;select   myf3(&#39;èµµäº‘é¾™&#39;);# æŸ¥çœ‹å‡½æ•°show create function xxx;# åˆ é™¤drop function xxx;</code></pre></div><p>é”™è¯¯ç¤ºèŒƒ,ä¸èƒ½ä½¿ç”¨å¤šè¡Œ</p><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql">create function myf2(name varchar(20)) returns intbegin    declare c int default 0;    select * into c    from staff;    return c;end $;select myf2(&#39;èµµäº‘é¾™&#39;);# The used SELECT statements have a different number of columns</code></pre></div><h4 id="åŒºåˆ«">åŒºåˆ«</h4><ul><li>å­˜å‚¨è¿‡ç¨‹ä¸»è¦æ˜¯é¢å‘è¿‡ç¨‹ï¼ŒåŠŸèƒ½æ¯”è¾ƒå¤æ‚ï¼›åªèƒ½ç›´æ¥æ‰§è¡Œï¼›é¢„ç¼–è¯‘ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œéœ€è¦æ—¶ç›´æ¥ä»åº“ä¸­è°ƒç”¨ï¼Œçœå»äº†ç¼–è¯‘çš„æ—¶é—´ï¼›æé«˜äº†è¿è¡Œé€Ÿåº¦ï¼Œé™ä½ç½‘ç»œæ•°æ®ä¼ è¾“é‡</li><li>å‡½æ•°é’ˆå¯¹æ€§å¼ºï¼Œé’ˆå¯¹æŸä¸ªç‰¹å®šçš„åŠŸèƒ½ï¼Œè§†ä¸ºä¸ºå…¶ä»–ç¨‹åºæœåŠ¡ï¼Œåªèƒ½è¿”å›ä¸€ä¸ªå˜é‡ï¼›å¯ä»¥ä½œä¸ºä¸€ä¸ªsqlè¯­å¥çš„ä¸€éƒ¨åˆ†æ¥è°ƒç”¨</li></ul><h3 id="æµç¨‹æ§åˆ¶ç»“æ„">æµç¨‹æ§åˆ¶ç»“æ„</h3><ul><li>é¡ºåºç»“æ„ï¼šè‡ªä¸Šè€Œä¸‹</li><li>åˆ†æ”¯ç»“æ„ï¼šå¯é€‰åˆ†æ”¯</li><li>å¾ªç¯ç»“æ„</li></ul><h4 id="åˆ†æ”¯ç»“æ„">åˆ†æ”¯ç»“æ„</h4><p><strong>if å‡½æ•°</strong></p><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql">if a  and b then ...elseif  ... thenelseif ... then...else...endif;</code></pre></div><p><strong>caseç»“æ„</strong></p><ul><li>æƒ…å†µä¸€ï¼šç±»ä¼¼javaä¸­switchè¿›è¡Œç­‰å€¼åˆ¤æ–­ã€‚whençš„æ˜¯è¦åˆ¤æ–­çš„å€¼<ul><li>å¯ä»¥ä½œä¸ºè¡¨è¾¾å¼ï¼Œå¯ä»¥æ”¾åœ¨ä»»ä½•åœ°æ–¹</li></ul></li><li>æƒ…å†µäºŒï¼šç±»ä¼¼å¤šé‡ifè¯­å¥ï¼Œç”¨äºå®ç°åŒºé—´åˆ¤æ–­ã€‚whençš„æ˜¯è¦åˆ¤æ–­çš„æ¡ä»¶ï¼Œthençš„æ˜¯è¦åšçš„åŠ¨ä½œ<ul><li>å¯ä»¥ä½œä¸ºç‹¬ç«‹çš„è¯­å¥ã€‚åªèƒ½æ”¾åœ¨begin endä¸­</li></ul></li></ul><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql">case ...when .... then ...when ... then ...else ...end case;</code></pre></div><p>å¦‚æœelseçœç•¥ï¼Œä¸”æ— åŒ¹é…ï¼Œåˆ™è¿”å›null;</p><h4 id="å¾ªç¯ç»“æ„">å¾ªç¯ç»“æ„</h4><p><strong>while</strong></p><p>ä¸ä¸€å®šæ‰§è¡Œ</p><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql">[tag:] while xxx do# å¾ªç¯ä½“end while[tag];# åŠ ä¸Štagå¯ä»¥è¿›è¡Œå¤šå±‚çš„å¾ªç¯æ§åˆ¶</code></pre></div><p><strong>loop</strong></p><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># å¯ä»¥ç”¨æ¥æ¨¡æ‹Ÿç®€å•çš„æ­»å¾ªç¯[tag:] loop# å¾ªç¯ä½“end loop[tag];</code></pre></div><p><strong>repeat</strong></p><p>è‚¯å®šæ‰§è¡Œä¸€æ¬¡</p><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql">[tag:] repeat# å¾ªç¯ä½“until ...end repeat[tag];</code></pre></div><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># å¹³å¸¸ä¾‹å­create procedure pro_while1(in insertcount int)begin    declare i int default 1;    while i&lt;&#x3D;insertcount do        insert into tcl_test values (1000+i,concat(&#39;1000&#39;,i),(1000+i)*10.0);        set i&#x3D;i+1;        end while ;end $;# å¸¦tagå’Œifåˆ¤æ–­é€€å‡ºçš„å¾ªç¯è¯­å¥# æ³¨æ„leaveçš„ä½¿ç”¨create procedure pro_while2(in insertcount int)begin    declare i int default 1;    xx: while i&lt;&#x3D;insertcount do        insert into tcl_test values (1500+i,concat(&#39;1000&#39;,i),(1500+i)*10.0);        if i&gt;20 then leave xx;        end if;        set i&#x3D;i+1;        end while xx;end $;</code></pre></div><p>iterator  : ç±»ä¼¼javaä¸­çš„continue;</p><h2 id="è¿›é˜¶-v4">è¿›é˜¶</h2><h3 id="è‡ªå¯åŠ¨æœåŠ¡">è‡ªå¯åŠ¨æœåŠ¡</h3><p>æ—©å°±æƒ³è®¾ç½®äº†ï¼Œèµ£ï¼</p><p>/usr/lib/systemd/systemä¸‹æ–°å»ºxx.serviceæ–‡ä»¶</p><p><strong>åŸºæœ¬ä½ç½®</strong></p><ul><li>/var/lib/mysqlæ•°æ®åº“æ–‡ä»¶å­˜æ”¾è·¯å¾„</li><li>/var/share/mysql     é…ç½®æ–‡ä»¶ç›®å½•</li><li>/usr/bin                 ç›¸å…³å‘½ä»¤è„šæœ¬</li><li>/etc/init.d/mysql    å¯åœè„šæœ¬</li></ul><div class="code-wrapper"><pre class="language-shell" data-language="shell"><code class="language-shell"># æŸ¥çœ‹å®‰è£…ç›®å½•ps -ef | grep mysqlmysql        530       1  0 09:50 ?        00:00:00 &#x2F;usr&#x2F;bin&#x2F;mariadbdpplong      3841    3006  0 10:06 pts&#x2F;1    00:00:00 grep --color&#x3D;auto --exclude-dir&#x3D;.bzr --exclude-dir&#x3D;CVS --exclude-dir&#x3D;.git --exclude-dir&#x3D;.hg --exclude-dir&#x3D;.svn --exclude-dir&#x3D;.idea --exclude-dir&#x3D;.tox mysql# æŸ¥çœ‹æ•°æ®æ–‡ä»¶ä½ç½®select @@datadir</code></pre></div><h3 id="åŸºæœ¬">åŸºæœ¬</h3><h4 id="ä¸»è¦é…ç½®æ–‡ä»¶">ä¸»è¦é…ç½®æ–‡ä»¶</h4><ul><li>äºŒè¿›åˆ¶æ—¥å¿— log-in  ä¸»ä»å¤åˆ¶</li><li>é”™è¯¯æ—¥å¿— log-error  é»˜è®¤å…³é—­ï¼Œè®°å½•ä¸¥é‡çš„é”™è¯¯å’Œè­¦å‘Šä¿¡æ¯ï¼Œæ¯æ¬¡å¯åŠ¨å’Œå…³é—­çš„ä¿¡æ¯</li><li>æŸ¥è¯¢æ—¥å¿—log      é»˜è®¤å…³é—­ï¼Œè®°å½•æŸ¥è¯¢çš„sqlè¯­å¥</li><li>æ•°æ®æ–‡ä»¶    /var/lib/mysql</li></ul><h4 id="é€»è¾‘æ¶æ„">é€»è¾‘æ¶æ„</h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211020103933579.png" alt="image-20211020103933579"></p><ul><li>è¿æ¥å±‚ï¼šæä¾›æœ¬åœ°Socké€šä¿¡å’Œå¤§å¤šæ•°åŸºäºB-SæœåŠ¡ç«¯å·¥å…·å®ç°çš„ç±»ä¼¼TCP/IPé€šä¿¡ï¼Œå®Œæˆè¿æ¥å¤„ç†ã€æˆæƒè®¤è¯çš„å·¥ä½œã€‚å¼•å…¥äº†<strong>çº¿ç¨‹æ± æ¦‚å¿µ</strong>ï¼Œä¸ºé€šè¿‡è®¤è¯å®‰å…¨ä»‹å…¥çš„å®¢æˆ·ç«¯æä¾›çº¿ç¨‹ã€‚å¯ä»¥å®ç°åŸºäºSSLçš„å®‰å…¨é“¾æ¥ã€‚</li><li>ä¸šåŠ¡é€»è¾‘å¤„ç†å±‚ï¼šå®Œæˆå¤§å¤šæ•°æ ¸å¿ƒåŠŸèƒ½ï¼ŒSQLæ¥å£ï¼ŒSQLåˆ†æã€ä¼˜åŒ–ã€å†…ç½®å‡½æ•°ã€‚è§£ææŸ¥è¯¢ç—…åˆ›å»ºå†…éƒ¨è§£ææ ‘ï¼Œå¯¹å®Œæˆç›¸åº”çš„ä¼˜åŒ–ã€‚å¯¹SELECTè¿˜ä¼šæŸ¥è¯¢å†…éƒ¨ç¼“å­˜<ul><li>Parserï¼š Lex + YACC</li><li>Optimizerï¼š ä¼˜åŒ–SQL</li></ul></li><li>æ•°æ®å­˜å‚¨å¼•æ“å±‚ï¼š çœŸæ­£è´Ÿè´£äº†MySQLæ•°æ®çš„å­˜å‚¨å’Œè¯»å–ï¼ŒæœåŠ¡å™¨é€šè¿‡APIä¸å­˜å‚¨å¼•æ“è¿›è¡Œé€šä¿¡ï¼Œä¸åŒå­˜å‚¨å¼•æ“æœ‰ä¸åŒåŠŸèƒ½ã€‚ï¼ˆMyISAMå’ŒInnoDBï¼‰[ç›®å‰åªæœ‰Mysqlå®ç°äº†åº•å±‚æ•°æ®å­˜å‚¨å¼•æ“çš„æ’ä»¶å¼ç®¡ç†  --&gt; Mysqlå¯æ’æ‹”å­˜å‚¨å¼•æ“ç‰¹è‰²]</li><li>æ•°æ®å­˜å‚¨å±‚ï¼šå°†æ•°æ®å­˜å‚¨åœ¨è¿è¡Œäºè£¸è®¾å¤‡çš„æ–‡ä»¶ç³»ç»Ÿä¸Šï¼Œå®Œæˆä¸å­˜å‚¨å¼•æ“çš„äº¤äº’</li></ul><h4 id="å­˜å‚¨å¼•æ“-v2">å­˜å‚¨å¼•æ“</h4><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># æŸ¥è¯¢å½“å‰çš„å­˜å‚¨å¼•æ“, ç›®å‰é»˜è®¤æ˜¯InnoDBshow variables like &#39;%storage_engine%&#39;; # åˆ›å»ºè¡¨æ—¶å¯ä»¥æŒ‡å®š Engine &#x3D; xxx</code></pre></div><p>Mysqlä¸­çš„å­˜å‚¨å¼•æ“åŠå…¶ç‰¹ç‚¹ï¼š</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211020105635279.png" alt="image-20211020105635279"></p><h5 id="MyIASMå’ŒInnoDB">MyIASMå’ŒInnoDB</h5><p><a href="https://www.runoob.com/w3cnote/mysql-different-nnodb-myisam.html">Mysqlå’ŒInnoDBåŒºåˆ«</a></p><h4 id="-v9"></h4><h3 id="ä¼˜åŒ–åŸå› ">ä¼˜åŒ–åŸå› </h3><h4 id="Sqlæ€§èƒ½ä¸‹é™åŸå› ">Sqlæ€§èƒ½ä¸‹é™åŸå› </h4><ol><li><strong>æŸ¥è¯¢è¯­å¥å¤ªçƒ‚</strong></li><li><strong>ç´¢å¼•å¤±æ•ˆ</strong><ol><li>å•å€¼</li><li>å¤åˆ</li></ol></li><li>å…³è”æŸ¥è¯¢å¤ªå¤šï¼ˆjoinï¼‰</li><li>æœåŠ¡å™¨è°ƒä¼˜è®¾ç½®</li></ol><h4 id="Sqlæ‰§è¡Œé¡ºåº">Sqlæ‰§è¡Œé¡ºåº</h4><ol><li>from .æ ¹æ®æŸ¥è¯¢æŒ‡å®šçš„è¡¨æ ¼ï¼Œfromè®¡ç®—ç¬›å¡å°”ç§¯ã€‚</li><li>onæ ¹æ®join_conditionè¿‡æ»¤æ•°æ®ã€‚</li><li>joinæ·»åŠ ç›¸å…³å¤–éƒ¨è¡¨æ ¼æ•°æ®ã€‚</li><li>whereæ ¹æ®where_conditionè¿‡æ»¤æ•°æ®ã€‚</li><li>group byåˆ†ç»„ã€‚</li><li>havingæ ¹æ®having_conditionè¿‡æ»¤æ•°æ®ã€‚</li><li>é€‰æ‹©æŒ‡å®šçš„åˆ—ã€‚</li><li>distinctæŒ‡å®šåˆ—å»é‡ã€‚</li><li>orderbyæŒ‰order_by_conditionæ’åºã€‚</li><li>å–å‡ºæŒ‡å®šçš„è®°å½•é‡ã€‚</li></ol><p><strong>ä¸ƒç§JOIN</strong></p><p>é’ˆå¯¹A\Bäº¤å¹¶é›†æƒ…å†µ</p><h3 id="ç´¢å¼•-v2">ç´¢å¼•</h3><h4 id="æ¦‚å¿µ-v7">æ¦‚å¿µ</h4><p>ä¸€ç§ <strong>æ’å¥½åºçš„å¿«é€ŸæŸ¥æ‰¾æ•°æ®ç»“æ„</strong></p><h4 id="ä¼˜ç¼ºç‚¹">ä¼˜ç¼ºç‚¹</h4><ul><li><strong>ä¼˜ç‚¹ï¼š</strong><ul><li>æé«˜æ•°æ®æ£€ç´¢çš„æ•ˆç‡ï¼Œé™ä½æ•°æ®åº“IOæˆæœ¬</li><li>é€šè¿‡ç´¢å¼•åˆ—å¯¹æ•°æ®è¿›è¡Œæ’åºï¼Œé™ä½äº†æ•°æ®æ’åºçš„æˆæœ¬ï¼Œé™ä½CPUæ¶ˆè€—</li></ul></li><li><strong>ç¼ºç‚¹ï¼š</strong><ul><li>å æ®ç£ç›˜ç©ºé—´</li><li>é™ä½æ›´æ–°è¡¨çš„æ•ˆç‡ï¼Œæ¯æ¬¡å¯¹è¡¨è¿›è¡Œæ“ä½œï¼ŒMysqlä¸ä»…è¦ä¿å­˜æ•°æ®ï¼Œè¿˜è¦ä¿å­˜å’Œæ›´æ–°å¯¹åº”çš„ç´¢å¼•æ–‡ä»¶</li></ul></li></ul><p>åœ¨æ•°æ®ä¹‹å¤–ï¼Œæ•°æ®åº“ç³»ç»Ÿè¿˜ç»´æŠ¤è¿™æ»¡è¶³ç‰¹å®šæŸ¥æ‰¾ç®—æ³•çš„æ•°æ®ç»“æ„ï¼Œä»¥æŸç§æ–¹å¼æŒ‡å‘æ•°æ®ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨è¿™äº›æ•°æ®ç»“æ„ä¸Šå®ç°é«˜çº§æŸ¥æ‰¾ç®—æ³•</p><h4 id="Bæ ‘">Bæ ‘</h4><p>ä¼˜åŒ–é‡ç‚¹ï¼šå°½é‡å‡å°‘ç£ç›˜çš„IOæ“ä½œï¼Œå› ä¸ºæ¯æ¬¡è®¿é—®äºŒå‰æ ‘çš„ä¸€ä¸ªèŠ‚ç‚¹å°±ä¼šå‘ç”Ÿä¸€ä¸ªIO<br>æƒ³å‡å°‘IOæ“ä½œ  ----&gt; å°½é‡<strong>é™ä½æ ‘çš„é«˜åº¦</strong></p><p>Mysqlçš„InnoDBå­˜å‚¨å¼•æ“ä¸€æ¬¡IOè¯»å–ä¸€é¡µ(16K)çš„æ•°æ®é‡ï¼Œå³äºŒå‰æ ‘ä¸€æ¬¡IOæœ‰æ•ˆæ•°æ®é‡åªæœ‰16Kï¼Œç©ºé—´åˆ©ç”¨ç‡ä½</p><p><strong>ç‰¹ç‚¹</strong></p><ul><li>Bæ ‘çš„èŠ‚ç‚¹å­˜å‚¨å¤šä¸ªå…ƒç´ ï¼Œæ¯ä¸ªå†…èŠ‚ç‚¹æœ‰å¤šä¸ªåˆ†å‰</li><li>èŠ‚ç‚¹çš„å…ƒç´ åŒ…å«å¥å€¼å’Œæ•°æ®ï¼Œå¥å€¼ä»å¤§åˆ°å°æ’åº</li><li>çˆ¶èŠ‚ç‚¹ä¸­çš„å…ƒç´ ä¸ä¼šå‡ºç°åœ¨å­èŠ‚ç‚¹ä¸­</li><li>ç´ æœ‰å¶å­èŠ‚ç‚¹ä½äºåŒä¸€å±‚ï¼Œå¶èŠ‚ç‚¹å…·æœ‰ç›¸åŒçš„æ·±åº¦ï¼Œå¶èŠ‚ç‚¹ä¹‹é—´æ— è¿æ¥</li></ul><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211020114931955.png" alt="image-20211020114931955"></p><p>ç›¸æ¯”å¹³è¡¡äºŒå‰æ ‘ï¼Œæ¯”è¾ƒçš„æ¬¡æ•°æ²¡æœ‰æ˜æ˜¾å‡å°‘ï¼Œä½†ç£ç›˜IOæ¬¡æ•°ä¼šå¤§å¤§å‡å°‘(æ¯”è¾ƒåœ¨å†…å­˜ä¸­è¿›è¡Œï¼Œè€—æ—¶å¾ˆå°‘ï¼Ÿï¼Ÿï¼Ÿ)</p><p><strong>å¯ä¼˜åŒ–ä¹‹å¤„</strong></p><ol><li>Bæ ‘ä¸æ”¯æŒèŒƒå›´æŸ¥è¯¢çš„å¿«é€ŸæŸ¥æ‰¾ï¼Œä¾‹å¦‚æŸ¥ 10 -35 çš„æ•°æ®ï¼ŒæŸ¥åˆ°15åï¼Œå°±éœ€è¦è¿”å›åˆ°æ ¹èŠ‚ç‚¹ï¼Œé‡æ–°éå†æŸ¥æ‰¾ã€‚(éœ€è¦ä»æ ¹èŠ‚ç‚¹å¤šæ¬¡éå†)</li><li>å¦‚æœdataå­˜å‚¨çš„æ˜¯è¡Œè®°å½•ï¼Œåˆ™è¡Œçš„å¤§å°éšç€åˆ—æ•°çš„å¢å¤šï¼Œå ç”¨ç©ºé—´å˜å¤§ï¼Œä¸€é¡µä¸­å¯å­˜å‚¨çš„æ•°æ®é‡å°±ä¼šå˜å°‘----&gt; æ ‘å¢é«˜â€”&gt;ç£ç›˜IOæ¬¡æ•°å¢å¤š</li></ol><p>å› æ­¤ï¼Œå°±æœ‰äº† â€”â€”â€“&gt;</p><h4 id="B-æ ‘">B+æ ‘</h4><p>ä¸Bæ ‘åŒºåˆ«ï¼š åªæœ‰å¶å­èŠ‚ç‚¹æ‰ä¼šå­˜å‚¨æ•°æ®ï¼Œéå¶å­èŠ‚ç‚¹å­˜å‚¨å¥å€¼ï¼Œå¶å­èŠ‚ç‚¹ä¹‹é—´ä½¿ç”¨åŒå‘æŒ‡é’ˆé“¾æ¥ï¼Œæœ€åº•å±‚çš„å¶å­èŠ‚ç‚¹å½¢æˆäº†ä¸€ä¸ªåŒå‘æœ‰åºé“¾è¡¨</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211020115655060.png" alt="image-20211020115655060"></p><p>æ•°æ®éƒ½åœ¨æœ€åº•å±‚çš„å¶å­èŠ‚ç‚¹ä¸Š ---- &gt; æ¯æ¬¡æŸ¥æ‰¾éœ€è¦åˆ°æœ€åº•å±‚å¶å­èŠ‚ç‚¹æ‰èƒ½æ‰¾åˆ°ï¼ˆè¿™é‡Œç¬¬äºŒå±‚ä¸æ˜¯å®é™…æ•°æ®ï¼Œåªæ˜¯ä¸€ä¸ªå‚è€ƒå€¼ï¼‰<br>æ¯æ¬¡çš„ç£ç›˜IOå’Œæ ‘é«˜æœ‰ç›´æ¥å…³ç³»<br>åœ¨å¶å­èŠ‚ç‚¹çš„æœç´¢è¿™é‡Œé‡‡ç”¨çš„æ˜¯é€ä¸ªæ¯”è¾ƒ</p><p>å…·ä½“æœç´¢è¿‡ç¨‹å¯å‚è§ <a href="https://blog.csdn.net/qq_35190492/article/details/109257302?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522163470018116780264064360%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=163470018116780264064360&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-109257302.pc_search_ecpm_flag&amp;utm_term=Mysql%E7%B4%A2%E5%BC%95&amp;spm=1018.2226.3001.4187">ä¸€æ–‡ææ‡‚MySQLç´¢å¼•æ‰€æœ‰çŸ¥è¯†ç‚¹</a></p><h4 id="æ“ä½œ">æ“ä½œ</h4><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># åˆ›å»ºç´¢å¼•create  index idx_name on table(column(xxx))alter table xx add index idx_name on (column(xx))</code></pre></div><h4 id="ç´¢å¼•ç±»å‹">ç´¢å¼•ç±»å‹</h4><ol><li>ä¸»é”®ç´¢å¼•ï¼š ç´¢å¼•åˆ—ä¸­å€¼å”¯ä¸€ï¼Œä¸å…è®¸æœ‰ç©ºå€¼</li><li>æ™®é€šç´¢å¼•ï¼š</li><li>å”¯ä¸€ç´¢å¼•ï¼š å”¯ä¸€ï¼Œå¯ç©º</li><li>å…¨æ–‡ç´¢å¼•ï¼š åªèƒ½åœ¨æ–‡æœ¬ç±»å‹CHAR VARCHAR TEXTç±»å‹å­—æ®µä¸Šåˆ›å»º</li><li>ç©ºé—´ç´¢å¼•ï¼š</li><li>å‰ç¼€ç´¢å¼•ï¼š</li></ol><p><strong>å“ªäº›æƒ…å†µéœ€è¦ç´¢å¼•</strong>ï¼Ÿ</p><ul><li>ä¸»é”®è‡ªåŠ¨å»ºç«‹å”¯ä¸€ç´¢å¼•</li><li>é¢‘ç¹ä½œä¸ºæŸ¥è¯¢æ¡ä»¶çš„å­—æ®µ</li><li>æŸ¥è¯¢ä¸­ä¸å…¶ä»–è¡¨å…³è”çš„å­—æ®µï¼Œå¤–é”®å…³ç³»</li><li>é¢‘ç¹æ›´æ–°çš„å­—æ®µä¸é€‚åˆåˆ›å»ºç´¢å¼•</li><li>Whereæ¡ä»¶é‡Œç”¨ä¸åˆ°çš„å­—æ®µä¸åˆ›å»ºç´¢å¼•</li><li>å•é”®/ç»„åˆç´¢å¼•å¦‚ä½•é€‰æ‹©(é«˜å¹¶å‘â€”&gt;ç»„åˆ)</li><li>æŸ¥è¯¢ä¸­æ’åºçš„å­—æ®µï¼Œæ’åºå­—æ®µé€šè¿‡ç´¢å¼•å»è®¿é—®å°†å¤§å¹…æé«˜æ’åºé€Ÿåº¦</li><li>æŸ¥è¯¢ä¸­ç»Ÿè®¡æˆ–è€…åˆ†ç»„çš„å­—æ®µ</li></ul><h3 id="æ€§èƒ½åˆ†æ">æ€§èƒ½åˆ†æ</h3><ol><li>æ…¢æŸ¥è¯¢æ—¥å¿—çš„å¼€å¯å’Œæ•è·</li><li>explain+SQLåˆ†æ</li><li>show profileæŸ¥è¯¢SQLåœ¨mysqlæœåŠ¡å™¨çš„æ‰§è¡Œç»†èŠ‚å’Œç”Ÿå‘½å‘¨æœŸ</li><li>sqlæœåŠ¡å™¨å‚æ•°è°ƒä¼˜</li></ol><h4 id="Explain">Explain</h4><p>å¯ä»¥æ¨¡æ‹Ÿä¼˜åŒ–å™¨æ‰§è¡ŒSQLæŸ¥è¯¢è¯­å¥ï¼Œä»è€ŒçŸ¥é“Mysqlæ˜¯å¦‚ä½•å¤„ç†SQLè¯­å¥çš„</p><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql">explain select * from xxx; </code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211020145916673.png" alt="image-20211020145916673"></p><ul><li><p><strong>id</strong></p><p><strong>1. idç›¸åŒï¼Œé¡ºåºæ‰§è¡Œ</strong> ï¼ˆæ³¨æ„è¿™é‡Œçš„æ‰§è¡Œé¡ºåºæ ¹æ®SQLçš„æ‰§è¡Œé¡ºåºæ¥çš„ï¼‰</p><p><strong>2. id ä¸åŒå¦‚æœæ˜¯å­æŸ¥è¯¢ï¼Œåˆ™idå€¼è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ï¼Œå…ˆè¢«æ‰§è¡Œ</strong></p><p><strong>3. idç›¸åŒï¼Œä¸›ä¸Šå¾€ä¸‹é¡ºåºæ‰§è¡Œï¼Œæ‰€æœ‰ç»„ä¸­ï¼Œidå€¼è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜</strong></p></li><li><p>select_type</p><ul><li>simpleï¼šæœ€ç®€å•çš„selectæŸ¥è¯¢ï¼ŒæŸ¥è¯¢ä¸­ä¸åŒ…å«å­æŸ¥è¯¢å’Œunion</li><li>primaryï¼šæŸ¥è¯¢ä¸­è‹¥åŒ…å«å¤æ‚çš„å­—éƒ¨åˆ†ï¼Œåˆ™å¤–å±‚æŸ¥è¯¢è¢«æ ‡è®°ä¸ºæ­¤</li><li>subqueryï¼šselectæˆ–è€…whereè¡¨ä¸­åŒ…å«äº†å­æŸ¥è¯¢</li><li>derivedï¼šfromåˆ—è¡¨ä¸­åŒ…å«äº†å­æŸ¥è¯¢</li><li>unionï¼šç¬¬äºŒä¸ªselectå‡ºç°åœ¨unionä¹‹å</li><li>union resultï¼šä»unionè¡¨ä¸­è·å–çš„ç»“æœçš„sleect</li></ul></li><li><p>typeï¼šè®¿é—®ç±»å‹ï¼ˆå¥½åˆ°å,è‡³å°‘è¾¾åˆ°rangeå’Œrefçº§åˆ«ï¼‰</p><ul><li><p>systemï¼šè¡¨åªæœ‰ä¸€è¡Œè®°å½•ï¼Œæ˜¯constçš„ç‰¹åˆ—</p></li><li><p>constï¼šé€šè¿‡ä¸€æ¬¡ç´¢å¼•å°±èƒ½å¤Ÿæ‰¾åˆ°ï¼Œç”¨äºæ¯”è¾ƒprimary keyå’Œuniqueç´¢å¼•ï¼ŒåªåŒ¹é…ä¸€è¡Œæ•°æ®ï¼Œå¾ˆå¿«</p></li><li><p>eq_refï¼šå”¯ä¸€æ€§ç´¢å¼•æ‰«æï¼Œå¯¹æ¯ä¸ªç´¢å¼•å»ºï¼Œè¡¨ä¸­åªæœ‰ä¸€æ¡è®°å½•ä¸ä¹‹åŒ¹é…</p><ul><li><div class="code-wrapper"><pre><code class="language-mysql">explain select * from t1 ,article where t1.id = article.id  # primary = primary<pre class="language-none"><code class="language-none">* refï¼šéå”¯ä¸€æ€§ç´¢å¼•æ‰«æï¼Œè¿”å›åŒ¹é…æŸä¸ªå•ç‹¬å€¼çš„æ‰€æœ‰è¡Œï¼Œæœ¬è´¨æ˜¯ä¸€ç§ç´¢å¼•è®¿é—®ã€‚å¯èƒ½ç»™æ‰¾åˆ°å¤šä¸ªåŒ¹é…çš„è¡Œ  *      &#96;&#96;&#96;mysql    explain select * from t10 where col2 &#x3D; 1 # col2 is an index</code></pre></div></code></pre></li></ul></li><li><p>rangeï¼šåªæ£€ç´¢ç»™å®šèŒƒå›´çš„è¡Œ(between\in&lt; &gt;)ï¼Œåªéœ€è¦å¼€å§‹ç´¢å¼•çš„æŸä¸€ç‚¹ï¼Œç»“æŸäºå¦å¤–ä¸€ç‚¹ï¼Œä¸ç”¨æ‰«æå…¨éƒ¨ç´¢å¼•</p></li><li><p>indexï¼šå…¨ç´¢å¼•æ‰«æï¼Œåªéå†ç´¢å¼•æ ‘ï¼Œå› ä¸ºç´¢å¼•æ–‡ä»¶é€šå¸¸æ¯”æ•°æ®æ–‡ä»¶å°ã€è™½ç„¶allå’Œindexéƒ½æ˜¯è¯»å…¨è¡¨ï¼Œä½†indexä»ç´¢å¼•ä¸­è¯»ï¼Œallä»ç¡¬ç›˜ä¸­è¯»</p><ul><li><div class="code-wrapper"><pre><code class="language-mysql">explain select col2 from t10 ; # col2 is an index<pre class="language-none"><code class="language-none">  * allï¼šæ‰«æå…¨è¡¨ï¼Œä¾‹å¦‚(select t1.name from t1)* possible_keys: æ˜¾ç¤º**å¯èƒ½**åº”ç”¨åœ¨è¿™å¼ è¡¨ä¸­çš„ç´¢å¼•  * å¯èƒ½æœ‰possible_key &#x3D; null ä½† keyæœ‰å€¼çš„æƒ…å†µ* keyï¼šå®é™…ç”¨çš„ç´¢å¼•ï¼Œå¦‚æœæŸ¥è¯¢ä¸­ä½¿ç”¨äº†è¦†ç›–ç´¢å¼•ï¼Œå°†ä¼šåœ¨keyä¸­å‡ºç°  * è¦†ç›–ç´¢å¼•ï¼šselectæŸ¥è¯¢çš„å­—æ®µï¼Œå’Œå»ºç´¢å¼•çš„å¤åˆç´¢å¼•çš„å­—æ®µçš„ä¸ªæ•°å’Œé¡ºåºå»åˆ* key_lenï¼šç´¢å¼•ä¸­ä½¿ç”¨çš„å­—èŠ‚æ•°ï¼Œåœ¨ä¸æŸå¤±ç²¾åº¦çš„æƒ…å†µä¸‹ï¼Œé•¿åº¦è¶ŠçŸ­è¶Šå¥½ï¼Œken_lenæ˜¾ç¤ºçš„æ˜¯ç´¢å¼•å­—æ®µçš„æœ€å¤§å¯èƒ½é•¿åº¦ï¼Œå¹¶éå®é™…ä½¿ç”¨é•¿åº¦ã€‚æ ¹æ®è¡¨å®šä¹‰å¾—å‡ºï¼Œè€Œä¸æ˜¯  * å˜é•¿å­—æ®µéœ€è¦é¢å¤–2å­—èŠ‚ï¼Œå¯ç©ºå­—æ®µéœ€è¦é¢å¤–1å­—èŠ‚* ref ï¼šæ˜¾ç¤ºç´¢å¼•çš„å“ªä¸€åˆ—å¼•ç”¨äº†å•¥  * &#96;&#96;&#96;mysql    explain select * from t10,t11 where t10.col2 &#x3D; 1  and t10.col1 &#x3D; t11.col3; #col2-- index   col1 -- index  col3 --any</code></pre></div></code></pre></li></ul></li></ul></li><li><p>rowï¼šæ ¹æ®è¡¨ç»Ÿè®¡ä¿¡æ¯ä»¥åŠç´¢å¼•é€‰ç”¨æƒ…å†µï¼Œå¤§è‡´ä¼°ç®—å¤„æ‰¾åˆ°æ‰€éœ€è¦è®°å½•æ‰€éœ€è¦è¯»å–çš„è¡Œæ•°</p></li><li><p>extraï¼šå…¶ä»–ä¿¡æ¯</p><ul><li>using filesortï¼šè¯´æ˜mysqlå¯¹æ•°æ®ä½¿ç”¨å¤–éƒ¨çš„ç´¢å¼•æ’åºï¼Œè€Œä¸æ˜¯æŒ‰ç…§è¡¨å†…çš„ç´¢å¼•è¿›è¡Œè¯»å–ã€‚æ— æ³•é€šè¿‡ç´¢å¼•å®Œæˆçš„æ’åºç§°ä½œâ€œæ–‡ä»¶æ’åºâ€ ---- ä¸å¤ªå¥½çš„æƒ…å†µ</li><li>using temporaryï¼šä½¿ç”¨äº†ä¸´æ—¶è¡¨ä¿å­˜ä¸­é—´ç»“æœï¼ˆå¯¹æŸ¥è¯¢ç»“æœè¿›è¡Œæ’åºæ—¶ï¼‰  â€” éå¸¸ä¸å¥½çš„æƒ…å†µ</li><li>using indexï¼šç›¸åº”çš„ selectæ“ä½œä½¿ç”¨äº†è¦†ç›–ç´¢å¼•ï¼Œé¿å…äº†è¡¨çš„æ•°æ®è¡Œï¼Œæ•ˆç‡é«˜ã€‚<ul><li>åŒæ—¶å‡ºç°using whereï¼Œè¡¨æ˜ç´¢å¼•è¢«ç”¨æ¥æ‰§è¡Œç´¢å¼•é”®å€¼çš„æŸ¥æ‰¾</li><li>æ²¡æœ‰åŒæ—¶å‡ºç°using  whereï¼Œè¡¨æ˜ç´¢å¼•ç”¨æ¥è¯»å–æ•°æ®è€Œå¹¶éæ‰§è¡ŒæŸ¥æ‰¾åŠ¨ä½œ</li><li>ç´¢å¼•è¦†ç›–ï¼šselectçš„æ•°æ®åˆ—åªç”¨ä»ç´¢å¼•ä¸­å°±èƒ½å¤Ÿå–å¾—ï¼Œä¸å¿…è¯»å–æ•°æ®è¡Œã€‚</li></ul></li><li>using whereï¼šä½¿ç”¨whereè¿‡æ»¤</li><li>using join buffer ï¼šä½¿ç”¨è¿æ¥ç¼“å­˜</li><li>impossible whereï¼šwhereçš„å¥å­å€¼æ€»æ˜¯false</li><li>select tables optimized away</li><li>distinctï¼šä¼˜åŒ–distinctï¼Œåœ¨æ‰¾åˆ°ç¬¬ä¸€åŒ¹é…çš„å…ƒç¥–ååœæ­¢æ‰¾åŒæ ·å€¼çš„åŠ¨ä½œ</li></ul></li></ul><p><strong>å“ªäº›æƒ…å†µä¸éœ€è¦ç´¢å¼•ï¼Ÿ</strong></p><ul><li>è¡¨è®°å½•å¤ªå°‘</li><li>ç»å¸¸å¢åˆ æ”¹çš„è¡¨</li><li>æ•°æ®é‡å¤ä¸”åˆ†å¸ƒå¹³å‡çš„è¡¨å­—æ®µ</li></ul><h4 id="ä¸ªäººæµ‹è¯•">ä¸ªäººæµ‹è¯•</h4><p>è¿™é‡Œæˆ‘ç”¨</p><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql">create table t1(    id int primary key not null ,    name varchar(20),    sex char(1) default &#39;ç”·&#39;,    rand_id int);# proceduredelimiter $$create procedure init_tens(in num int)begin    declare cols int default 1;    declare scope int default num*10;    declare isex char default &#39;ç”·&#39;;    loop_x1: while cols &lt; num        do        set cols &#x3D; cols + 1;        if(cols % 2 &#x3D; 0)        then             set isex &#x3D; &#39;å¥³&#39;;        else             set isex &#x3D; &#39;ç”·&#39;;        end if;        insert into pp_test.t1 values (cols,                               concat(&#39;id:&#39;,cols),                                isex,                               round(rand()*scope)                              );        end while loop_x1;end $$</code></pre></div><p>è¿™æ ·çš„ä¸€å¼ è¡¨å»æµ‹è¯•é€Ÿåº¦ï¼Œå½“ç„¶callè¿™ä¸ªprocedure num = 500 000æ—¶ï¼Œæœºå™¨è·‘äº†æ¥è¿‘6min,æ•°æ®å®¹é‡åœ¨20MBï¼ˆ10000æ¡è·‘7s,å·®ä¸å¤šï¼‰</p><p>é€šè¿‡primary key å»queryï¼Œæ„Ÿè§‰æ—¶é—´ä¸Šéƒ½æ˜¯msçº§åˆ«ï¼Œæ²¡å•¥å·®åˆ«<br>ä½†é€šè¿‡rand_idå»queryæ—¶ï¼Œæ—¶é—´å°±éå¸¸çš„æ…¢ï¼Œè‡³å°‘æ˜¯20å€</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211021233658608.png" alt="image-20211021233658608"></p><h4 id="å­¦ä¹ æµ‹è¯•">å­¦ä¹ æµ‹è¯•</h4><h5 id="å•è¡¨">å•è¡¨</h5><p>æµ‹è¯•ç”¨ä¾‹</p><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql">create table if not exists article(    id int(10) unsigned  not null primary key auto_increment,    auther_id int unsigned not null,    category_id int not null ,    views int not null ,    comments int not null ,    title varbinary(255) not null ,    content text not null);explain select id , auther_id from article where category_id &#x3D; 1 and comments &gt;1 order by  views desc limit 1;# å¦‚ä½•é¿å…å‡ºç°filesort å’Œ allçš„typeï¼Ÿ</code></pre></div><ol><li><p>whereåè¦å»º</p><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql">create index idx_article_ccv on article (category_id,comments,views)create index idx_article_ccv on article (category_id,comments,views)# è§£å†³å…¨è¡¨æ‰«æé—®é¢˜</code></pre></div></li><li><div class="code-wrapper"><pre><code class="language-mysql">explain select id , auther_id from article where category_id = 1 and comments = 1 order by  views desc limit 1;#  comments &gt; 1 çš„æ•ˆç‡å®Œå…¨ä¸ä¸€æ · ----&gt; ç´¢å¼•å¤±æ•ˆ<pre class="language-none"><code class="language-none">   ##### ä¸¤è¡¨&#96;&#96;&#96;mysqlcreate table class(    id int not null auto_increment,    card int not null ,    primary key (id));create table book(    bookid int not null auto_increment,    card int not null ,    primary key (bookid));explain select * from class left join book on class.card &#x3D; book.card</code></pre></div></code></pre></li></ol><p><strong>æœ‰ä¸»å¤–é”®åï¼Œç´¢å¼•åœ¨å“ªå¼ è¡¨å»ºï¼Ÿ</strong></p><p>å·¦å³è¿æ¥çš„åˆ¤æ–­å°±æ˜¯ï¼Œå“ªå¼ è¡¨æ˜¯å…¨çš„ï¼Œå°±ä¸ç®¡ä»–ï¼Œåªå…³å¿ƒæ®‹ç¼ºè¡¨çš„æŸ¥è¯¢</p><p><strong>å¤šè¡¨</strong></p><h4 id="ç´¢å¼•å¤±æ•ˆ">ç´¢å¼•å¤±æ•ˆ</h4><ol><li><strong>æœ€ä½³å·¦å‰ç¼€æ³•åˆ™</strong></li></ol><p>å»ºç«‹ç´¢å¼•çš„ç¬¬ä¸€ä¸ªindexå¿…é¡»æœ‰ï¼Œæ‰èƒ½å¤Ÿä½¿ç”¨ç´¢å¼•æŸ¥è¯¢</p><ul><li><strong>å…¨å€¼åŒ¹é…æœ€ä½³</strong></li><li><strong>ä¸­é—´å…„å¼Ÿä¸èƒ½æ–­</strong>ï¼Œæ–­äº†åˆ™åªèƒ½ä½¿ç”¨åˆ°æ–­ä¹‹å‰çš„é‚£ä¸€ä¸ªï¼ˆç±»ä¼¼é˜¶æ¢¯ï¼‰</li></ul><ol start="2"><li><p>åœ¨ç´¢å¼•åˆ—ä¸Šå·¦ä»»ä½•æ“ä½œï¼ˆè®¡ç®—ã€å‡½æ•°ã€ç±»å‹è½¬æ¢ï¼‰ï¼Œä¼šå¯¼è‡´<strong>ç´¢å¼•å¤±æ•ˆ</strong>è€Œè½¬å‘å…¨è¡¨æ‰«æ</p></li><li><p>å­˜å‚¨å¼•æ“ä¸èƒ½ä½¿ç”¨ç´¢å¼•ä¸­èŒƒå›´æ¡ä»¶å³è¾¹çš„åˆ—</p><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql">explain select * from t20 where col3 &#x3D; 1 and col4 &#x3D; 2 and ool5 &#x3D; 10;# ref &#x3D; const const constexplain select * from t20 where col3 &#x3D; 1 and col4 &gt; 2 and ool5 &#x3D; 10;# ref &#x3D; null# åˆ°äº†èŒƒå›´æŸ¥æ‰¾æ—¶ï¼Œå°±ç”¨ä¸ä¸Šåé¢çš„indexäº†</code></pre></div></li><li><p>å°½é‡ä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼ˆåªè®¿é—®ç´¢å¼•çš„æŸ¥è¯¢â€” æŸ¥è¯¢åˆ—å’Œç´¢å¼•åˆ—ä¸€è‡´  ----&gt; äº§ç”Ÿusing indexï¼‰ï¼Œé¿å…select *</p></li><li><p>ä½¿ç”¨!= &lt; &gt;æ— æ³•ä½¿ç”¨ç´¢å¼• â€” å¯¼è‡´å…¨å±€æ‰«æ</p><ol><li>ä½†manjaro â€“ mariadb10.6.4 æ˜¯ä¸ä¼šå¤±æ•ˆçš„</li></ol></li><li><p>is null is not null æ— æ³•ä½¿ç”¨ç´¢å¼•</p><ol><li>åŒä¸Šï¼Œæœªå¤±æ•ˆ</li></ol></li><li><p>likeä»¥é€šé…ç¬¦%å¼€å¤´ï¼Œmysqlç´¢å¼•å¤±æ•ˆ</p><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql">explain select * from t20 where name like &#39;%123&#39;;# type and possible key is nullexplain select * from t20 where name like &#39;123%&#39;;# type : range ,key is using# å¦‚ä½•è§£å†³ %...% æƒ…å†µ</code></pre></div><p><strong>è¦†ç›–ç´¢å¼•</strong></p><p>åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå…¶ä»–åˆ—çš„ï¼Œè¿™æ—¶åªè¦æŸ¥è¯¢åˆ—ä¸­ä»…æœ‰ä¸»é”®å’Œè¿™äº›é”®å€¼çš„ç»„åˆï¼Œå°±èƒ½å¤Ÿä½¿å¾—typeå˜ä¸ºindexï¼Œä¸”ä½¿ç”¨åˆ°key(å…¶ä»–çš„ç´¢å¼•æ˜¯ä¸è¡Œçš„)</p></li><li><p><strong>å­—ç¬¦ä¸²ä¸åŠ å•å¼•å·ä¼šä½¿å¾—ç´¢å¼•å¤±æ•ˆ</strong></p><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql">explain select col3 from t20 where name &#x3D; 200;# mysqlå†…éƒ¨è‡ªåŠ¨å°†200éšå¼è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ç±»å‹# ä½¿å¾—possible_key !&#x3D; null ä½†keyä¸ºnull type ä¸ºnull</code></pre></div></li><li><p>orå¯¼è‡´ç´¢å¼•å¤±æ•ˆ</p><p>possible_key != null  ä½† keyä¸ºnull</p></li></ol><h4 id="show-profile">show profile</h4><h4 id="å°è¡¨é©±åŠ¨å¤§è¡¨">å°è¡¨é©±åŠ¨å¤§è¡¨</h4><p>åŸç”±ï¼šæ•°æ®åº“çš„è¿æ¥å’Œé‡Šæ”¾è€—æ—¶</p><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql">select * from A where id in (select id from b)# &#x3D; å…ˆå»select id from b# å¦‚æœBçš„æ•°æ®é›† &lt; Açš„æ•°æ®é›†ï¼Œåˆ™in ä¼˜äº existsï¼Œåä¹‹åˆ™existä¼˜äºinselect * from A where exists (select 1 from B where B.id &#x3D; A.id)# æ³¨æ„ ä¸Šé¢çš„ä¸¤å¥è¯­å¥è¯­ä¹‰ç›¸åŒï¼Œè¿™é‡Œexistså«ä¹‰ä¸èƒ½ä»whereç›´æ¥trueæˆ–è€…falseå»ç†è§£</code></pre></div><h4 id="order-byæ’åº">order byæ’åº</h4><p>Mysqlæ”¯æŒä¸¤ç§æ–¹å¼æ’åºï¼Œfilesortå’Œindexï¼Œå°½é‡ç”¨indexæ–¹å¼æ’åºï¼Œæ•ˆç‡é«˜ï¼ˆå°½å¯èƒ½åœ¨ç´¢å¼•åˆ—ä¸Šæ’åºï¼‰</p><ul><li>ç´¢å¼•æœ€å·¦å‰ç¼€</li><li>whereè‡ªå±…å’Œorder byè‡ªå±…æ¡ä»¶å’§ç»„åˆæ»¡è¶³æœ€å·¦å‰ç¼€</li></ul><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql">select * from t1 where col1 &gt; 20 order by col1; # ä¼šäº§ç”Ÿfilesortå—(col1 is index)select * from t1 where col1 &gt; 20 order by col2; #col1-col2 is co-index  --- using filesortselect * from t1 order by col1 asc,col2 desc; # col1-col2 is co-index  --- indexé»˜è®¤æ˜¯ascé¡ºåº</code></pre></div><p>å¦‚æœä¸åœ¨ç´¢å¼•åˆ—ä¸Šï¼Œfilesortæœ‰ä¸¤ç§æ’åºç®—æ³•ï¼š</p><ul><li>åŒè·¯æ’åºï¼š4.1ä¹‹å‰ï¼š ä¸¤æ¬¡æ‰«æç£ç›˜ ã€‚è¯»å–è¡ŒæŒ‡é’ˆå’Œorderbyåˆ—ï¼Œè¿›è¡Œæ’åºï¼Œç„¶åæ‰«æå·²ç»æ’åºå¥½çš„åˆ—è¡¨ï¼ŒæŒ‰ç…§åˆ—è¡¨ä¸­çš„å€¼é‡æ–°ä»åˆ—è¡¨ä¸­è¯»å–å¯¹åº”çš„æ•°æ®ï¼ˆä¹Ÿå³ï¼šä»ç£ç›˜è¯»å–æ’åºå­—æ®µï¼Œåœ¨bufferè¿›è¡Œæ’åºï¼Œå†ä»ç£ç›˜è¯»å–å…¶ä»–å­—æ®µï¼‰</li><li>å•è·¯æ’åºï¼š4.1ä¹‹åï¼Œç£ç›˜è¯»å–æŸ¥è¯¢éœ€è¦çš„æ‰€æœ‰åˆ—ï¼ŒæŒ‰order byåœ¨bufferè¿›è¡Œæ’åºï¼Œç„¶åæ‰«ææ’åºåçš„åˆ—è¡¨è¾“å‡ºã€‚<ul><li>æ•ˆç‡å¿«ï¼Œé¿å…äºŒæ¬¡è¯»å–æ•°æ®</li><li>æŠŠéšæœºIOå˜æˆé¡ºåºIO</li><li>å ç”¨æ›´å¤šç©ºé—´ï¼Œå› ä¸ºæ¯ä¸€è¡Œéƒ½ä¿å­˜åœ¨å†…å­˜ä¸­</li><li>å­˜åœ¨é—®é¢˜ï¼šå¦‚æœè¯»å–çš„bufferçš„å®¹é‡å°äºè¯»çš„å®¹é‡ï¼Œå°±ä¼šå¯¼è‡´æ¯æ¬¡åªèƒ½å–åˆ°bufferçš„å¤§å°ï¼Œæ’å®Œä¸€æ¬¡ï¼Œåˆ›å»ºä¸´æ—¶æ–‡ä»¶ï¼Œå†æ’ä¸€æ¬¡ï¼Œè¿˜è¦è¿›è¡Œå¤šä¸ªä¸´æ—¶æ–‡ä»¶çš„å¤šè·¯åˆå¹¶<ul><li>å¢å¤§sore_buffer_size</li><li>å¢å¤§ max_length_for_sort_data</li><li>é¿å…select *</li></ul></li></ul></li></ul><h3 id="è¡¥å……">è¡¥å……</h3><p>ä¸€ä¸ªèŠ‚ç‚¹çš„å¤§å° = ä¸€é¡µå¤§å° ï¼Œä¸€é¡µå¤§å°é»˜è®¤æ˜¯16K</p><h2 id="åŸç†-v4">åŸç†</h2><h3 id="InnoDB">InnoDB</h3><p>ä¸»è¦ä¼˜åŠ¿ï¼š</p><ul><li>éµå¾ªACIDæ¨¡å‹ï¼Œæœ‰äº‹åŠ¡æ§åˆ¶</li><li>è¡Œé”</li><li>æœ‰èšé›†ç´¢å¼•çš„ä¸»é”®ç´¢å¼•</li><li>æ”¯æŒå¤–é”®çº¦æŸ</li><li>å´©æºƒåä¿®å¤ï¼šInnoDBå´©æºƒå›å¤åä¼šè‡ªåŠ¨å®Œæˆå´©æºƒä¹‹å‰æäº¤çš„æ›´æ”¹ï¼Œç—…æ’¤é”€æ­£åœ¨è¿›è¡Œä½†å¹¶æœªæäº¤çš„æ›´æ”¹</li><li>ç»´æŠ¤è‡ªå·±çš„ç¼“å†²æ± ï¼Œåœ¨ä½å†…å­˜ç¼“å­˜è¡¨å’Œç´¢å¼•æ•°æ®ã€‚ç»å¸¸ä½¿ç”¨çš„æ•°æ®ç›´æ¥ä»å†…å­˜å¤„ç†</li><li>å…è®¸å¯¹åŒæ„è¡¨è¿›è¡Œå¹¶å‘è¯»å†™è®¿é—® ï¼Œç¼“å­˜æ›´æ”¹çš„æ•°æ®ä»¥ç®€åŒ–ç£ç›˜IO</li><li>è‡ªé€‚åº”å“ˆå¸Œç´¢å¼• â€” ä»è¡¨ä¸­é‡å¤è®¿é—®ç›¸åº”çš„è¡Œ</li></ul><h4 id="æ¶æ„">æ¶æ„</h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211023214352512.png" alt="image-20211023214352512"></p><h4 id="å†…å­˜ç»“æ„">å†…å­˜ç»“æ„</h4><h5 id="ç¼“å†²æ± ">ç¼“å†²æ± </h5><p>ä¸»å†…å­˜ä¸­çš„ä¸€ä¸ªåŒºåŸŸï¼Œç”¨äºåœ¨InnoDBè®¿é—®æ—¶ç¼“å­˜è¡¨å’Œç´¢å¼•æ•°æ®ï¼Œå…è®¸ç›´æ¥ä»å†…å­˜è®¿é—®ç»å¸¸ä½¿ç”¨çš„æ•°æ®</p><p>ä¸ºäº†æé«˜å¤§é‡è¯»å–æ“ä½œçš„æ•ˆç‡ï¼Œç¼“å†²æ± è¢«åˆ’åˆ†å¯èƒ½åŒ…å«å¤šè¡Œçš„é¡µé¢<br>ä¸ºäº†ç¼“å­˜ç®¡ç†çš„æ•ˆç‡ï¼Œç¼“å†²æ± è¢«å®ç°ä¸ºé¡µé¢çš„é“¾è¡¨</p><p><strong>LRUç®—æ³•</strong></p><p>å½“éœ€è¦ç©ºé—´å°†æ–°é¡µé¢åŠ å…¥åˆ°ç¼“å†²æ± æ—¶ï¼Œæœ€å°‘ä½¿ç”¨çš„é¡µé¢å°†ä¼šè¢«é€å‡ºï¼Œå¹¶ä¸”æ–°é¡µé¢ä¼šåŠ å…¥åˆ°åˆ—è¡¨<strong>ä¸­é—´</strong><br>åˆ—è¡¨åˆ’åˆ†ä¸ºä¸¤ä¸ªå­åˆ—è¡¨</p><ul><li>æœ€è¿‘è®¿é—®çš„æ–°çš„ å¹´è½»çš„é¡µé¢çš„ å­åˆ—è¡¨</li><li>æœ€è¿‘è®¿é—®çš„ä¹…é¡µé¢çš„å­åˆ—è¡¨ï¼ˆå¯èƒ½è¢«é©±é€çš„ä¾¯é€‰é¡µï¼‰</li></ul><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211023214750401.png" alt="image-20211023214750401"></p><ul><li>é»˜è®¤ç¼“å†²æ± çš„3/8ä¸ºæ—§çš„å­åˆ—è¡¨</li><li>åˆ—è¡¨çš„é‡ç‚¹æ˜¯æ–°çš„å­åˆ—è¡¨å°¾éƒ¨å’Œæ—§å­åˆ—è¡¨çš„å¤´éƒ¨ç›¸äº¤ä¹‹å¤„</li><li>é¡µé¢æ’å…¥åˆ°ç¼“å†²æ± æ—¶ï¼Œæ˜¯æ’å…¥åˆ°åˆ—è¡¨ä¸­ç‚¹</li><li>è®¿é—®æ—§å­é¡µé¢ä¸­çš„åˆ—è¡¨å°†ä½¿å¾—å®ƒå˜youngï¼Œç§»åŠ¨åˆ°æ–°å­åˆ—è¡¨çš„å¤´éƒ¨<ul><li>å¦‚æœé¡µé¢æ˜¯å› ä¸ºç”¨æˆ·å¯åŠ¨çš„æ“ä½œéœ€è¦å®ƒè€Œè¢«è¯»å–ï¼Œåˆ™ç¬¬ä¸€æ¬¡è®¿é—®ä¼šç«‹å³å‘ç”Ÿï¼Œå¹¶ä¸”é¡µé¢ä¼šå˜å¹´è½»ã€‚</li><li>å¦‚æœé¡µé¢æ˜¯ç”±äº<strong>é¢„è¯»</strong>æ“ä½œè€Œè¯»å–çš„ï¼Œåˆ™ç¬¬ä¸€æ¬¡è®¿é—®ä¸ä¼šç«‹å³å‘ç”Ÿï¼Œå¹¶ä¸”åœ¨é¡µé¢è¢«é€å‡ºä¹‹å‰å¯èƒ½æ ¹æœ¬ä¸ä¼šå‘ç”Ÿã€‚</li></ul></li></ul><p>é€šè¿‡show engine innodb status æŸ¥çœ‹ç¼“å†²æ± çš„å‚æ•°æŒ‡æ ‡</p><h5 id="Change-Buffer">Change Buffer</h5><p>æ›´æ”¹ç¼“å†²æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ•°æ®ç»“æ„ï¼Œå½“äºŒçº§ç¼“å­˜é¡µä¸åœ¨ç¼“å†²æ± ä¸­æ—¶ï¼Œå®ƒä¼šç¼“å­˜å¯¹äºŒçº§ç´¢å¼•é¡µçš„æ›´æ”¹</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211023215943712.png" alt="image-20211023215943712"></p><h5 id="è‡ªé€‚åº”å“ˆå¸Œç´¢å¼•">è‡ªé€‚åº”å“ˆå¸Œç´¢å¼•</h5><p>é€šè¿‡innodb_adaptive_hash_indexå˜é‡å¯åŠ¨ã€‚æ ¹æ®è§‚å¯Ÿåˆ°çš„æœç´¢æ¨¡å¼ï¼Œä½¿ç”¨ç´¢å¼•å»ºçš„å‰ç¼€æ„å»ºå“ˆå¸Œç´¢å¼•ï¼ˆå°†ç´¢å¼•å€¼è½¬åŒ–æˆæŒ‡é’ˆï¼‰</p><h4 id="ç£ç›˜ç»“æ„">ç£ç›˜ç»“æ„</h4><h5 id="ç´¢å¼•-v3">ç´¢å¼•</h5><p><strong>èšé›†ç´¢å¼•</strong>ï¼šä¸ä¸»é”®åŒä¹‰ï¼Œå­˜å‚¨è¡Œæ•°æ®</p><ul><li>åœ¨<code>PRIMARY KEY</code>è¡¨ä¸Šå®šä¹‰ aæ—¶ï¼Œ <code>InnoDB</code>å°†å…¶ç”¨ä½œèšé›†ç´¢å¼•ã€‚åº”è¯¥ä¸ºæ¯ä¸ªè¡¨å®šä¹‰ä¸€ä¸ªä¸»é”®ã€‚å¦‚æœæ²¡æœ‰é€»è¾‘å”¯ä¸€ä¸”éç©ºçš„åˆ—æˆ–åˆ—é›†ä½¿ç”¨ä¸»é”®ï¼Œè¯·æ·»åŠ è‡ªåŠ¨å¢é‡åˆ—ã€‚è‡ªåŠ¨é€’å¢åˆ—å€¼æ˜¯å”¯ä¸€çš„ï¼Œå¹¶åœ¨æ’å…¥æ–°è¡Œæ—¶è‡ªåŠ¨æ·»åŠ ã€‚</li><li>å¦‚æœæ‚¨æ²¡æœ‰<code>PRIMARY KEY</code>ä¸ºè¡¨å®šä¹‰ a ï¼Œåˆ™<code>InnoDB</code>ä½¿ç”¨ç¬¬ä¸€ä¸ª <code>UNIQUE</code>ç´¢å¼•ï¼Œå¹¶å°†æ‰€æœ‰é”®åˆ—å®šä¹‰ä¸º<code>NOT NULL</code>èšé›†ç´¢å¼•ã€‚</li><li>å¦‚æœè¡¨æ²¡æœ‰ç´¢å¼•<code>PRIMARY KEY</code>æˆ–æ²¡æœ‰åˆé€‚çš„ <code>UNIQUE</code>ç´¢å¼•ï¼Œåˆ™<code>InnoDB</code> ç”Ÿæˆä»¥<code>GEN_CLUST_INDEX</code>åŒ…å«è¡Œ ID å€¼çš„åˆæˆåˆ—å‘½åçš„éšè—èšé›†ç´¢å¼• ã€‚è¡ŒæŒ‰<code>InnoDB</code>åˆ†é…çš„è¡Œ ID æ’åºã€‚è¡Œ ID æ˜¯ä¸€ä¸ª 6 å­—èŠ‚çš„å­—æ®µï¼Œéšç€æ’å…¥æ–°è¡Œè€Œå•è°ƒå¢åŠ ã€‚å› æ­¤ï¼ŒæŒ‰è¡Œ ID æ’åºçš„è¡Œåœ¨ç‰©ç†ä¸Šæ˜¯æŒ‰æ’å…¥é¡ºåºæ’åˆ—çš„ã€‚</li></ul><p>åœ¨ <code>InnoDB</code>ä¸­ï¼Œ<strong>äºŒçº§ç´¢å¼•ä¸­çš„æ¯æ¡è®°å½•éƒ½åŒ…å«è¯¥è¡Œçš„ä¸»é”®åˆ—</strong>ï¼Œä»¥åŠä¸ºäºŒçº§ç´¢å¼•æŒ‡å®šçš„åˆ—ã€‚</p><h4 id="æ–‡ä»¶ç»“æ„">æ–‡ä»¶ç»“æ„</h4><p>æŸ¥çœ‹é¡µçš„å¤§å° innodb_page_sizeï¼Œå¤šå°‘é¡µå°±æ˜¯ibdå¤§å°/ page_size .</p><h5 id="frm">frm</h5><p>è¡¨å®šä¹‰æ–‡ä»¶</p><h5 id="ibd">ibd</h5><p>ç´¢å¼•å’Œæ•°æ®æ–‡ä»¶</p><h2 id="ä¸€äº›é—®é¢˜-v4">ä¸€äº›é—®é¢˜</h2><p><strong>Mysqlå’ŒMariadbçš„åŒºåˆ«</strong></p><ul><li>MyISamï¼š<ul><li>ä¸æ”¯æŒå¤–é”®</li><li>ä¸æ”¯æŒäº‹åŠ¡</li><li>ä¸æ”¯æŒå¤–é”®</li><li>éèšé›†ç´¢å¼•</li><li>æ”¯æŒFULLTEXTç±»å‹çš„å…¨æ–‡ç´¢å¼•</li><li>æœ€å°ç²’åº¦é”æ˜¯è¡¨é”</li><li>å­˜å‚¨ç»“æ„<ul><li>.frmæ–‡ä»¶ï¼šè¡¨çš„å®šä¹‰</li><li>.MYDï¼šæ•°æ®æ–‡ä»¶</li><li>.MYIï¼šç´¢å¼•æ–‡ä»¶</li></ul></li></ul></li><li>Innodbï¼š<ul><li>æ”¯æŒå¤–é”®</li><li>æ”¯æŒäº‹åŠ¡ï¼ˆMysqlé»˜è®¤å¼•æ“ä¸ºInnoDBçš„é‡è¦åŸå› ï¼‰</li><li>æ”¯æŒå¤–é”®</li><li>èšé›†ç´¢å¼•</li><li>ä¸æ”¯æŒFULLTEXTç±»å‹çš„å…¨æ–‡ç´¢å¼•</li><li>æœ€å°çš„é”ç²’åº¦æ˜¯è¡Œé”</li><li>å­˜å‚¨ç»“æ„<ul><li>Frmæ–‡ä»¶ï¼šè¡¨çš„å®šä¹‰æ–‡ä»¶</li><li>Ibdæ–‡ä»¶ï¼šæ•°æ®å’Œç´¢å¼•å­˜å‚¨æ–‡ä»¶ï¼Œæ•°æ®ä»¥ä¸»é”®å­˜å‚¨ï¼ŒçœŸæ­£çš„æ•°æ®åœ¨å¶å­èŠ‚ç‚¹ä¸­</li></ul></li></ul></li></ul><p><strong>è§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•</strong></p><ul><li><p>èšç°‡ç´¢å¼•ï¼šæ•°æ®å­˜å‚¨å’Œç´¢å¼•æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ï¼Œç´¢å¼•ç»“æ„çš„å¶å­èŠ‚ç‚¹ä¿å­˜äº†è¡Œæ•°æ®ï¼ˆç´¢å¼•é¡¹çš„é¡ºåºå’Œè¡¨ä¸­è®°å½•çš„ç‰©ç†é¡ºåºä¸€è‡´ï¼‰</p><ul><li><p>é»˜è®¤æ˜¯ä¸»é”®</p></li><li><p>å¦‚æœä¹ˆæœ‰å®šä¹‰ä¸»é”®ï¼ŒInnoDBä¼šé€‰æ‹©ä¸€ä¸ªå”¯ä¸€çš„éç©ºç´¢å¼•ä»£æ›¿</p></li><li><p>å¦‚æœæ²¡å“Ÿè¿™æ ·çš„ç´¢å¼•ï¼Œå°†ä¼šåœ¨å†…éƒ¨ç”Ÿæˆä¸€ä¸ªåä¸ºGEN_CLUST_INDEXçš„éšå¼èšç°‡ç´¢å¼•</p></li><li><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211023211744223.png" alt="image-20211023211744223"></p><p>æ³¨æ„è¾…åŠ©ç´¢å¼•å­˜å‚¨çš„æ˜¯ä¸»é”®çš„key</p></li></ul></li><li><p>éèšç°‡ç´¢å¼•ï¼š æ•°æ®ä¸ç´¢å¼•åˆ†å¼€å­˜å‚¨ï¼Œè¡¨æ•°æ®å­˜å‚¨é¡ºåºä¸ç´¢å¼•é¡ºåºæ— å…³</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211023211734818.png" alt="image-20211023211734818"></p></li></ul><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql">explain select * from t20 where col3 &#x3D; 1 and col4 &gt; 0 and ool5 &#x3D; 1;# myisamä¸­ typeä¸ºsystem ä½†innodbå´ä¸ºrangeï¼Ÿ(idx_col_345)</code></pre></div><p><strong>ä¸ºå•¥Mysqlæ”¾å¼ƒFull Joinï¼Ÿ</strong></p><p><strong>order byæ€ä¹ˆå®ç°æ’åºçš„ï¼Ÿ</strong></p><p><strong>Mysqlä¸­æ•°æ®æ˜¯å¦‚ä½•åŠ å¯†çš„</strong></p><p><strong>å¤åˆç´¢å¼•å’Œæœ€å·¦åŸåˆ™</strong></p><ul><li>å•ä¸€ç´¢å¼•ï¼šæ–°å»ºç´¢å¼•çš„è¯­å¥åªå®æ–½åœ¨ä¸€åˆ—ä¸Š</li><li>å¤åˆç´¢å¼•ï¼šå¤šä¸ªåˆ—ä¸Šå»ºç«‹ç´¢å¼•<ul><li>æ•°æ®åº“æ“ä½œæœŸé—´å¼€é”€å°ï¼Œèƒ½ä»£æ›¿å¤šä¸ªå•ä¸€ç´¢å¼•</li><li>ä½•æ—¶ä½¿ç”¨ï¼Ÿæ ¹æ®<strong>whereæ¡ä»¶</strong>åå¤šå­—æ®µ</li></ul></li><li>æœ€å·¦åŸåˆ™ï¼šå¤åˆç´¢å¼•çš„ç¬¬ä¸€ä¸ªå­—æ®µå¿…é¡»å‡ºç°åœ¨æŸ¥è¯¢è¯­å¥ä¸­ï¼Œè¿™æ ·ç´¢å¼•æ‰èƒ½å¤Ÿè¢«ä½¿ç”¨ï¼ˆç±»ä¼¼æŸ¥å­—å…¸ï¼‰</li></ul><p><strong>sq92 å’Œ 99çš„è¿æ¥å†™æ³•æœ‰å®é™…å·®åˆ«å—ï¼Ÿ</strong></p><p><strong>Mysqlç´¢å¼•ä¸ºå•¥é€‰æ‹©B+æ ‘ï¼Ÿ</strong></p><ul><li>å“ˆå¸Œç´¢å¼•ï¼šå¾ˆå¿«ï¼Œä½†æ— åºâ€”ä¸èƒ½è¿›è¡ŒèŒƒå›´æŸ¥æ‰¾ã€æ’åºæ“ä½œï¼Œä¸èƒ½é€šè¿‡keyå»åšä¸»é”®ã€‚è¿˜å¯èƒ½å­˜åœ¨å“ˆå¸Œç¢°æ’é—®é¢˜</li><li>AVLï¼šæ ‘çš„é«˜åº¦ â€” è¯»å–ç£ç›˜æ¬¡æ•°å¢åŠ ï¼Œå¯èƒ½æœ‰å›è¡¨çš„ç°è±¡ï¼ˆæŸ¥æ‰¾èŒƒå›´åŒºé—´ï¼‰</li><li>Bå’ŒB+æ ‘å‰é¢æœ‰è¯´ï¼šä¸»è¦è¿˜æ˜¯é™ä½äº†æ ‘çš„é«˜åº¦</li></ul><p><strong>Mysqç´¢å¼•ä¸ºå•¥ä¼šå¤±æ•ˆ</strong></p><p>ä¸»è¦æ˜¯è”åˆç´¢å¼•</p><p>æ³¨æ„è”åˆç´¢å¼•ä¸­çš„å€¼<strong>é¡ºåºå­˜å‚¨</strong>çš„æ–¹å¼ ----- &gt; è”åˆç´¢å¼•å¦‚ä½•æ’åºï¼Ÿ</p><ul><li>å¯¹å·¦å‰ç¼€åŸåˆ™ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰ç¬¬ä¸€ä¸ªç´¢å¼•å€¼å°±ä¼šå¤±æ•ˆå‘¢ï¼Ÿ<ul><li>æ— æ³•é€šè¿‡ç¬¬ä¸€ä¸ªå€¼å»å®šä½ç´¢å¼•æ‰€åœ¨çš„ä½ç½®å‘€ ---- ç”±è”åˆç´¢å¼•çš„<strong>é¡ºåºæ’åº</strong>å¯¼è‡´çš„ï¼ˆç±»ä¼¼%abcï¼‰</li></ul></li><li>å¯¹èŒƒå›´æŸ¥æ‰¾ï¼Œä¸ºä»€ä¹ˆä¹‹åç´¢å¼•çš„å°±ä¼šå¤±æ•ˆå‘¢ï¼Ÿ<ul><li>å¯¹ç¬¦åˆæ¡ä»¶çš„æƒ…å†µï¼Œå¶å­èŠ‚ç‚¹å’Œéå¶å­èŠ‚ç‚¹å¯èƒ½æ˜¯æ— åºçš„ â€” &gt; ä¸èƒ½é€šè¿‡äºŒåˆ†æŸ¥æ‰¾å»æ‰¾ä¹‹åç´¢å¼•çš„æ•°æ®ï¼ˆä¸æ‡‚å°±ç”»å›¾ï¼‰</li></ul></li></ul><h2 id="ä¸€äº›é“¾æ¥">ä¸€äº›é“¾æ¥</h2><p><a href="https://blog.csdn.net/ThinkWon/article/details/104778621?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522163470018116780264064360%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=163470018116780264064360&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-2-104778621.pc_search_ecpm_flag&amp;utm_term=Mysql%E7%B4%A2%E5%BC%95&amp;spm=1018.2226.3001.4187">Mysqlé¢è¯•é¢˜</a></p><h2 id="å¸¸ç”¨è¯­æ³•">å¸¸ç”¨è¯­æ³•</h2><p><strong>æŸ¥çœ‹æŸä¸ªæ•°æ®åº“çš„å¤§å°å ç”¨</strong></p><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql">select    table_schema as &#39;æ•°æ®åº“&#39;,    sum(table_rows) as &#39;è®°å½•æ•°&#39;,    sum(truncate(data_length&#x2F;1024&#x2F;1024, 2)) as &#39;æ•°æ®å®¹é‡(MB)&#39;,    sum(truncate(index_length&#x2F;1024&#x2F;1024, 2)) as &#39;ç´¢å¼•å®¹é‡(MB)&#39;from information_schema.tableswhere table_schema&#x3D;&#39;pp_test&#39;;</code></pre></div><p><strong>æŸ¥çœ‹æŸè¡¨çš„æ‰€æœ‰ç´¢å¼•</strong></p><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql">show index from article</code></pre></div><p><strong>æŸ¥çœ‹æ•°æ®åº“çš„è¡¨çŠ¶æ€</strong></p><div class="code-wrapper"><pre class="language-mysql" data-language="mysql"><code class="language-mysql">show table status from pp_test# æŸ¥çœ‹è¡¨ä¸­æ‰€æœ‰åˆ—çš„å­—ç¬¦é›†show full columns from t22;</code></pre></div><p>f</p>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>Study</tag>
      
      <tag>Mysql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ•°æ®ç»“æ„</title>
    <link href="/2019/03/29/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    <url>/2019/03/29/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/</url>
    
    <content type="html"><![CDATA[<h1>æ•°æ®ç»“æ„</h1><!--toc--><h2 id="äºŒå‰æœç´¢æ ‘">äºŒå‰æœç´¢æ ‘</h2><h3 id="æ·»åŠ ">æ·»åŠ </h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addNode</span><span class="token punctuation">(</span><span class="token class-name">Node</span> node<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>node <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>i<span class="token operator">&lt;</span><span class="token keyword">this</span><span class="token punctuation">.</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>left <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>left <span class="token operator">=</span> node<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>left<span class="token punctuation">.</span><span class="token function">addNode</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>right <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>right <span class="token operator">=</span> node<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>right<span class="token punctuation">.</span><span class="token function">addNode</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p>ä¸­åºéå†</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">midLook</span><span class="token punctuation">(</span><span class="token class-name">Node</span> root<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>root <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">midLook</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">midLook</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>å±‚åºéå†</p><p><strong>ä¼˜å…ˆé˜Ÿåˆ—æ–¹å¼ï¼</strong></p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">floorList</span><span class="token punctuation">(</span><span class="token class-name">Node</span> root<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Node</span><span class="token punctuation">></span></span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    queue<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">Node</span> node <span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>queue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        node <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>left <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            queue<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>right <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            queue<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>æ•°æ®ç»“æ„</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LeetCodeé¢˜åº“</title>
    <link href="/2019/01/22/LeetCode%E5%88%B7%E9%A2%98/"/>
    <url>/2019/01/22/LeetCode%E5%88%B7%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1>LeetCode é¢˜åº“</h1><link href="/css/code-tag-label.css" rel="stylesheet" type="text/css"/><p style="display:inline;">&#x1F30D  å½“å‰é¢˜åº“é¢˜ç›®æ•°: &nbsp<p id="issue-count" style="display:inline;"></p></p><!-- toc --><span id="more"></span><div class="echart-block" style="max-height:500px"><center>    <img id="chart-block-img" src="/img/loading.gif" style="width: 400px;height:400px;margin-top:50px;display=inline-block;">    <div id="leetcode-type-chart" style="width: 600px;height:500px;display=none;"></div></center></div><p><strong>WANTED</strong> ğŸ“œ ï¼š</p><ul><li><p><a href="https://leetcode-cn.com/problems/two-sum-ii-input-array-is-sorted/">LeetCode167 ä¸¤æ•°ä¹‹å’Œ II - è¾“å…¥æœ‰åºæ•°ç»„</a></p></li><li><p>LeetCode 28 å­—ç¬¦ä¸²åŒ¹é…</p></li><li><p><a href="https://leetcode-cn.com/problems/max-consecutive-ones-iii/">LeetCode 1004. æœ€å¤§è¿ç»­1çš„ä¸ªæ•° III</a></p></li><li><p><a href="https://leetcode-cn.com/problems/longest-repeating-character-replacement/">LeetCode 424. æ›¿æ¢åçš„æœ€é•¿é‡å¤å­—ç¬¦</a></p></li></ul><h2 id="JZ-03-ä¸¤æ•°ç›¸åŠ -â­">JZ-03. ä¸¤æ•°ç›¸åŠ  â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-hash">Hash</div><div class="code-tag-label code-tag-label-math">Replace</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210308090153998.png" alt="image-20210308090153998"></p><h3 id="æ€è€ƒï¼š">æ€è€ƒï¼š</h3><p>æœªæ’åºã€æœ‰é‡å¤æ•°å­—ã€æ‰¾å‡ºçš„æ˜¯ä»»æ„çš„é‡å¤æ•°å­—ã€æ‰€æœ‰æ•°å­—å¤§å°éƒ½åœ¨0â€”n-1çš„èŒƒå›´å†…ã€è¾“å‡ºçš„æ˜¯é‡å¤çš„é‚£ä¸ªæ•°å­—</p><h3 id="1-åŸºäºå“ˆå¸Œè¡¨">1. åŸºäºå“ˆå¸Œè¡¨</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Map</span> map <span class="token operator">=</span> <span class="token keyword">new</span>  <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">&lt;</span>nums<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>     <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>map<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>         <span class="token keyword">return</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span>     map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     i<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210308092439462.png" alt="image-20210308092439462"></p><p>æ—¶é—´å¤æ‚åº¦ O(N)  ç©ºé—´å¤æ‚åº¦  O(N)</p><h3 id="2-åŸåœ°ç½®æ¢-nb">2. åŸåœ°ç½®æ¢  nb</h3><p>è¿™é‡Œç¡®å® åº”è¯¥å¤šçœ‹é¢˜ç›®ç»™çš„æ•°å­—èŒƒå›´åœ¨0â€“n-1æ€è€ƒï¼Œè¿™æ˜¯è§£è¿™é“é¢˜çš„å…³é”®ï¼Œä¹‹å‰çš„å“ˆå¸Œè¡¨æ˜¯æ²¡æœ‰ç”¨åˆ°è¿™ä¸ªæ¡ä»¶çš„</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> temp<span class="token punctuation">;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">while</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> nums<span class="token punctuation">[</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                   <span class="token keyword">return</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>               temp <span class="token operator">=</span> nums<span class="token punctuation">[</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>               nums<span class="token punctuation">[</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>               nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>      <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span></code></pre></div><p>ç†è§£è¿™é‡Œçš„æ€æƒ³ä¸»è¦æ˜¯è‡ªå·±æƒ³ä¸€ä¸ªæ•°ç»„ä¸€æ­¥æ­¥å»è¿›è¡Œ    æœ‰ç‚¹æ¡¶æ’åºçš„æ„Ÿè§‰ï¼Ÿ</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210308124958004.png" alt="image-20210308124958004"></p><p>è¿™é‡Œæœ€åå‘ç°é—®é¢˜çš„å…³é”®æ˜¯   n-1èŒƒå›´å†…ï¼Œ ç´¢å¼•ä¸ºiå¯¹åº”çš„ä½ç½®ä¸Šè‚¯å®šæ˜¯ i ï¼Œç„¶åå»åˆ¤æ–­æ—¶ å‘ç°é‡å¤çš„å…ƒç´ ï¼Œè‚¯å®šæ˜¯åœ¨ä»–çš„å€¼å¯¹åº”çš„ç´¢å¼•ä¸Šå»æ‰¾çš„ï¼Œå¦‚æœæœ‰è¿™ä¸ªå€¼ï¼Œåˆ™æ‰¾åˆ°äº†ï¼Œæ²¡æœ‰ï¼Œåˆ™è¯´æ˜è¿˜æœªå¡«ä¸Šï¼Œåˆ™å¡«ä¸Šã€‚</p><p><span style='color: #00BFFF;font-size:24px'>è¿™é‡Œä¸»è¦æ˜¯è¿˜æ˜¯è¦æŒæ¡æ¡¶æ’åºçš„æ€æƒ³ï¼Œå…ˆå»æ€è€ƒèƒ½ä¸èƒ½é€šè¿‡OÂ  Nçš„æ–¹å¼è§£å†³é—®é¢˜</span></p><h2 id="JZ-04-äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾-â­â­">JZ-04. äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾ â­â­</h2><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210310083059606.png" alt="image-20210310083059606"></p><h3 id="è§‚å¯Ÿï¼š">è§‚å¯Ÿï¼š</h3><p>æ¯è¡Œé€’å¢ã€æ¯åˆ—é€’å¢</p><h3 id="1-è‡ªå·±æƒ³çš„çŸ©é˜µåˆ†å‰²æ³•">1. è‡ªå·±æƒ³çš„çŸ©é˜µåˆ†å‰²æ³•</h3><h3 id="2-ç¿»è½¬çŸ©é˜µ-çº¿æ€§æœç´¢">2.  ç¿»è½¬çŸ©é˜µ / çº¿æ€§æœç´¢</h3><p>â€‹çŸ©é˜µçš„å³ä¸Šè§’å¼€å§‹</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> j <span class="token operator">=</span> matrix<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">&lt;</span><span class="token number">0</span><span class="token operator">||</span>j<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>matrix<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">></span>num<span class="token punctuation">)</span> j<span class="token operator">--</span><span class="token punctuation">;</span>    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>matrix<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&lt;</span>num<span class="token punctuation">)</span> i<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>matrix<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> num<span class="token punctuation">)</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><h2 id="JZ-10-é’è›™è·³å°é˜¶-â­">JZ-10. é’è›™è·³å°é˜¶ â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-dp">DP</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210315090449362.png" alt="image-20210315090449362"></p><h3 id="æ€è€ƒ">æ€è€ƒ</h3><p>å°±æ˜¯æ‹¼ç –å¤´çš„é€’å½’æ€æƒ³</p><p>è¿”å›æ ¼å¼  ()+1</p><h3 id="1-é€’å½’ï¼ˆè¶…æ—¶ï¼‰">1. é€’å½’ï¼ˆè¶…æ—¶ï¼‰</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">if</span><span class="token punctuation">(</span>num <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> num <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span>   <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span>num <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">return</span> <span class="token function">getMax</span><span class="token punctuation">(</span>num<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">getMax</span><span class="token punctuation">(</span>num <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">;</span></code></pre></div><p>é€’å½’çš„æ—¶é—´å¤æ‚åº¦æ˜¯On*n ç©ºé—´å¤æ‚åº¦ On æ‰€ä»¥è‚¯å®šè¶…æ—¶äº†</p><h3 id="2-åŠ¨æ€è§„åˆ’">2.  åŠ¨æ€è§„åˆ’</h3><p>å…¸å‹çš„æ–æ³¢é‚£å¥‘æ•°åˆ—é—®é¢˜ï¼Œè‰¹,å°±æ˜¯ä¸€ä¸ªä¸‰ä¸ªç¼“å­˜æ•°è¿›è¡Œæ–æ³¢é‚£å¥‘æ•°åˆ—çš„è¿ç®—</p><p><strong>ä¸ºä»€ä¹ˆæ˜¯æ–æ³¢é‚£å¥‘ï¼Ÿ</strong></p><p><strong>ä»¥åçœ‹ç®—æ³•é¢˜çš„æ—¶å€™ï¼Œå…ˆçœ‹å…¶é€šé¡¹ç»“æ„</strong></p><p>f(n) = f(n-1) + f(n-2)</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>   <span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>   <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span> num<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   sum <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token operator">+</span>b<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">1000000007</span><span class="token punctuation">;</span>   a <span class="token operator">=</span> b<span class="token punctuation">;</span>   b <span class="token operator">=</span> sum<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> a<span class="token punctuation">;</span></code></pre></div><p>æ—¶é—´å¤æ‚åº¦ On ç©ºé—´å¤æ‚åº¦ O1</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210315092525503.png" alt="image-20210315092525503"></p><h2 id="JZ-14-I-å‰ªç»³å­-â­â­">JZ-14 -I å‰ªç»³å­ â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-math">Formula</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210330163524643.png" alt="image-20210330163524643"></p><h3 id="æ€è€ƒï¼š-v2">æ€è€ƒï¼š</h3><p>åŠ¨æ€è§„åˆ’ã€é€šé¡¹å¼ã€è´ªå¿ƒç®—æ³•ï¼Ÿ</p><p>åæ¥å‘ç°åœ¨æ±‚Onçš„æ—¶å€™æœ‰å¤æ‚çš„æƒ…å†µï¼Œå°±æ”¾å¼ƒäº†ï¼Œåº”è¯¥æ˜¯æ•°å­¦æ–¹é¢çš„é—®é¢˜ï¼Œä¸åº”è¯¥æš´åŠ›è¿­ä»£</p><h3 id="O-1">O (1):</h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210330163659124.png" alt="image-20210330163659124"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210330163712589.png" alt="image-20210330163712589"></p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">cuttingRope</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">return</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> a <span class="token operator">=</span> n <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">,</span> b <span class="token operator">=</span> n <span class="token operator">%</span> <span class="token number">3</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>b <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>b <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> a <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>ä½œè€…ï¼šjydé“¾æ¥ï¼šhttps<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>leetcode<span class="token operator">-</span>cn<span class="token punctuation">.</span>com<span class="token operator">/</span>problems<span class="token operator">/</span>jian<span class="token operator">-</span>sheng<span class="token operator">-</span>zi<span class="token operator">-</span>lcof<span class="token operator">/</span>solution<span class="token operator">/</span>mian<span class="token operator">-</span>shi<span class="token operator">-</span>ti<span class="token operator">-</span><span class="token number">14</span><span class="token operator">-</span>i<span class="token operator">-</span>jian<span class="token operator">-</span>sheng<span class="token operator">-</span>zi<span class="token operator">-</span>tan<span class="token operator">-</span>xin<span class="token operator">-</span>si<span class="token operator">-</span>xiang<span class="token operator">-</span>by<span class="token operator">/</span></code></pre></div><h2 id="JZ-22-é“¾è¡¨ä¸­å€’æ•°ç¬¬kä¸ªèŠ‚ç‚¹-â­">JZ-22. é“¾è¡¨ä¸­å€’æ•°ç¬¬kä¸ªèŠ‚ç‚¹ â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-dfs">DFS</div><div class="code-tag-label code-tag-label-foreach">TwinPointer</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210315222551714.png" alt="image-20210315222551714"></p><h3 id="æ€è€ƒ-v2">æ€è€ƒ</h3><p>æ­£å¸¸æƒ…å†µä¸‹ï¼ŒO n+nï¼Ÿ</p><h3 id="1-é€’å½’å¯»æ‰¾ï¼Ÿ"><s>1. é€’å½’å¯»æ‰¾ï¼Ÿ</s></h3><p>æˆ‘æœ€å¼€å§‹å‡†å¤‡æ˜¯ getNode(node.next)å…ˆå¾€ä¸‹å»æ‰¾ï¼Œæ‰¾åˆ°nextä¸ºnullæ—¶å†å‘ä¸Šè¿”å›ï¼Œä½†æ˜¯è¿™æ—¶å€™å¦‚ä½•å»å‡kå€¼æˆ‘å°±ä¸çŸ¥é“äº†</p><p>è¿™ä¸ªæœ€ååœ¨ç¬¬ä¸‰ç‚¹ä¸­å¾—åˆ°è§£å†³ğŸ‘</p><h3 id="2-å¦™å¦™åŒæŒ‡é’ˆ">2. å¦™å¦™åŒæŒ‡é’ˆ</h3><p>è®©å‰æŒ‡é’ˆå…ˆèµ°kæ­¥ï¼Œç„¶ååæŒ‡é’ˆè·Ÿéšè€…å‰æŒ‡é’ˆä¸€èµ·èµ°</p><p>æ ¸å¿ƒçš„ç‚¹æ˜¯åœ¨å½“preä¸ºnullæ—¶ï¼Œä¹Ÿå°±æ˜¯èµ°åˆ°å¤´äº†ï¼Œè¿™æ—¶å€™formerä¸preå·®kæ­¥ï¼Œä¹Ÿå°±æ˜¯å€’æ•°ç¬¬kä¸ªå…ƒç´ ã€‚</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">ListNode</span> premer <span class="token operator">=</span> head<span class="token punctuation">;</span>   <span class="token class-name">ListNode</span> former <span class="token operator">=</span> head<span class="token punctuation">;</span>   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>k<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>              premer <span class="token operator">=</span> premer<span class="token punctuation">.</span>next<span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>   <span class="token keyword">while</span><span class="token punctuation">(</span>premer <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       premer <span class="token operator">=</span> premer<span class="token punctuation">.</span>next<span class="token punctuation">;</span>       former <span class="token operator">=</span> former<span class="token punctuation">.</span>next<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">return</span> former<span class="token punctuation">;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210315225759099.png" alt="image-20210315225759099"></p><p>æ—¶é—´å¤æ‚åº¦O n ç©ºé—´å¤æ‚åº¦ O2</p><p><strong>å¦‚æœè¿™ç§é—®é¢˜é€’å½’ä¸è¡Œçš„è¯ï¼Œå°±æƒ³æƒ³åŒæŒ‡é’ˆä¼šæ€ä¹ˆåšå§</strong></p><h3 id="3-å›æº¯">3. å›æº¯</h3><p>ğŸ“† 2022.10.30 å›é¡¾æƒ³çš„è§£æ³•ï¼Œä¸»è¦æ˜¯è§£å†³ä¸¤ä¸ªé—®é¢˜</p><ol><li>å›æº¯æ—¶å€’æ•°ç¬¬kä¸ª å¦‚ä½•åˆ¤æ–­ï¼Œå¦‚ä½•åˆ¤æ–­å½“å‰æ˜¯å€’æ•°ç¬¬å‡ ä¸ªå…ƒç´ </li><li>å›æº¯æ—¶å¦‚ä½•æ—¢æœ‰å½“å‰å…ƒç´ çš„é€†åºæ•°ï¼Œåˆæœ‰å½“å‰å…ƒç´ çš„æŒ‡é’ˆï¼Ÿ</li></ol><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">ListNode</span> <span class="token function">getKthFromEnd</span><span class="token punctuation">(</span><span class="token class-name">ListNode</span> head<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">ListNode</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">method</span><span class="token punctuation">(</span>head<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// Object[0] å½“å‰ç»“ç‚¹çš„é€†åºæ•°(m == k æ—¶è¿”å›çš„æ˜¯ç»“ç‚¹çš„dataå€¼)</span> <span class="token comment">// Object[1] å½“å‰å…ƒç´ ï¼šåªæœ‰é€†åºæ•°ä¸kç›¸ç­‰æ—¶æ‰ä¸ä¸ºç©º</span>    <span class="token keyword">public</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">method</span><span class="token punctuation">(</span><span class="token class-name">ListNode</span> head<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>head <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>             <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> object <span class="token operator">=</span> <span class="token function">method</span><span class="token punctuation">(</span>head<span class="token punctuation">.</span>next<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>object<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>m <span class="token operator">==</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>head<span class="token punctuation">.</span>val<span class="token punctuation">,</span> head<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>object<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> object<span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>m<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå›æº¯æ—¶å¹¶ä¸æ˜¯åªæœ‰m==kåå°±ä¸å›æº¯äº†ï¼Œè€Œæ˜¯ä¹‹åä¸€ç›´åˆ°å¤´ç»“ç‚¹éƒ½æœ‰å›æº¯åˆ°è¿‡ç¨‹ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­è¦çµæ´»å¤„ç†è¿”å›åˆ°Object[] ç¡®ä¿å®ƒå°±ä¸ºm==kæ—¶çš„é‚£ä¸ªå€¼</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20221030195355851.png" alt="image-20221030195355851"></p><p>é€’å½’ï¼Ÿ</p><h2 id="JZ-24-åè½¬é“¾è¡¨-â­">JZ-24. åè½¬é“¾è¡¨ â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-recursion">Recursion</div><div class="code-tag-label code-tag-label-foreach">TwinPointer</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210308212250360.png" alt="image-20210308212250360"></p><h3 id="æ€è€ƒ-v3">æ€è€ƒ</h3><p>ä¼¼ä¹æ²¡ä»€ä¹ˆï¼Œæ³¨æ„  null</p><h3 id="1-è‡ªå·±å†™çš„-pre-æŒ‡é’ˆä»£ç ">1. è‡ªå·±å†™çš„ pre æŒ‡é’ˆä»£ç </h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">if</span><span class="token punctuation">(</span>head <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>head<span class="token punctuation">.</span>next <span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> head<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>       <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token class-name">ListNode</span> prer<span class="token punctuation">;</span>        <span class="token class-name">ListNode</span> pre<span class="token punctuation">;</span>        <span class="token class-name">ListNode</span> <span class="token class-name">Lastpre</span><span class="token punctuation">;</span>              <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            pre <span class="token operator">=</span> head<span class="token punctuation">;</span>            <span class="token class-name">Lastpre</span> <span class="token operator">=</span> head<span class="token punctuation">;</span>            <span class="token keyword">try</span><span class="token punctuation">&#123;</span>                pre <span class="token operator">=</span> pre<span class="token punctuation">.</span>next<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">NullPointerException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                pre <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> i<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                pre <span class="token operator">=</span> pre<span class="token punctuation">.</span>next<span class="token punctuation">;</span>                <span class="token class-name">Lastpre</span> <span class="token operator">=</span> <span class="token class-name">Lastpre</span><span class="token punctuation">.</span>next<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            prer <span class="token operator">=</span> pre<span class="token punctuation">.</span>next<span class="token punctuation">;</span>            <span class="token class-name">Lastpre</span><span class="token punctuation">.</span>next <span class="token operator">=</span> prer<span class="token punctuation">;</span>            pre<span class="token punctuation">.</span>next <span class="token operator">=</span> head<span class="token punctuation">;</span>            head <span class="token operator">=</span> pre<span class="token punctuation">;</span>            i<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>prer <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> head<span class="token punctuation">;</span></code></pre></div><p>â€‹å†™äº†å¾ˆä¹…ï¼Œç»“æœå¤ªæ‹‰äº†ï¼Œè‡ªå·±éƒ½ä¸æƒ³åˆ†æäº†</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210308224413999.png" alt="image-20210308224413999"></p><h3 id="2-åŒæŒ‡é’ˆ">2. åŒæŒ‡é’ˆ</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">ListNode</span> cur <span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span><span class="token class-name">ListNode</span> pre <span class="token operator">=</span> head<span class="token punctuation">;</span><span class="token class-name">ListNode</span> t <span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>pre <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    t <span class="token operator">=</span> pre<span class="token punctuation">.</span>next<span class="token punctuation">;</span>    pre<span class="token punctuation">.</span>next <span class="token operator">=</span> cur<span class="token punctuation">;</span>    cur <span class="token operator">=</span> pre<span class="token punctuation">;</span>  <span class="token comment">// â‘ æ ‡è®°</span>    pre <span class="token operator">=</span> t<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> cur<span class="token punctuation">;</span></code></pre></div><p>è¿™é‡Œä¸»è¦è¿˜æ˜¯è‡ªå·±ä»¥å‰çš„è€é—®é¢˜ï¼Œå°±æ˜¯æ ‡è®°1å¤„ï¼Œè¿™é‡Œå°±ç†è§£ä¸ºæ˜¯å•çº¯çš„èµ‹å€¼å°±è¡Œäº†</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210308224939792.png" alt="image-20210308224939792"></p><h3 id="3-é€’å½’">3. é€’å½’</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span>head <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> head<span class="token punctuation">.</span>next <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> head<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">ListNode</span> ret <span class="token operator">=</span> <span class="token function">reverseList</span><span class="token punctuation">(</span>head<span class="token punctuation">.</span>next<span class="token punctuation">)</span><span class="token punctuation">;</span>head<span class="token punctuation">.</span>next<span class="token punctuation">.</span>next <span class="token operator">=</span> head<span class="token punctuation">;</span><span class="token comment">// 5.next = head;</span>head<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token comment">//æ­¤å¤„ç½®ç©ºçš„æ—¶å€™ä¸€å®šè¦æ³¨æ„å…³æ³¨ç‚¹æ˜¯ret è€Œä¸æ˜¯head...</span><span class="token keyword">return</span> ret<span class="token punctuation">;</span></code></pre></div><p>é€’å½’ç†è§£èµ·æ¥æœ‰ä¸€å®šçš„éš¾åº¦</p><p>ç‰¹åˆ«æ˜¯æ³¨æ„ret å’Œ headçš„åŒ…å«å…³ç³», å¦‚æœç†è§£ä¸äº†çš„æ—¶å€™å°±æŠ¥head.next.next ç”¨å¦ä¸€ä¸ªéå†æ›¿æ¢  head.next = ret é›†ä¸­å…³æ³¨åœ¨retä¸Šï¼Œå› ä¸ºé€’å½’ï¼Œæ‰€ä»¥å†…å­˜æ¶ˆè€—è‚¯å®šå¾ˆå¤šå•¦</p><p><span style='color:#3CB371;font-size:20px'>è¿™ç§é€’å½’ç»™æˆ‘çš„å¯ç¤ºæ˜¯ä»¥ååˆ†ä¸æ¸…nextçš„æ—¶å€™æˆ–è€…ç­‰ä»·å…³ç³»ï¼Œå°±ç”¨ä¸­é—´å˜é‡å»è§£è€¦ï¼Œæˆ–è€…ç”¨å·²çŸ¥æŒ‡é’ˆæ›¿æ¢ï¼Œè¿™æ ·ä¼šæ›´å¥½ç†è§£ä¸€äº›</span></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210308232940772.png" alt="image-20210308232940772"></p><h2 id="Jz-47-ç¤¼ç‰©çš„æœ€å¤§ä»·å€¼-â­â­">Jz-47. ç¤¼ç‰©çš„æœ€å¤§ä»·å€¼ â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-dp">DP</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210315082753010.png" alt="image-20210315082753010"></p><h3 id="1-é€’å½’">1. é€’å½’</h3><h3 id="2-åŠ¨æ€è§„åˆ’-v2">2. åŠ¨æ€è§„åˆ’</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java">    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getMax</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> matrix<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>          <span class="token keyword">for</span><span class="token punctuation">(</span> <span class="token keyword">int</span> i <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span> matrix<span class="token punctuation">.</span>length <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>              <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>matrix<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                  <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">0</span><span class="token operator">&amp;&amp;</span> j <span class="token operator">==</span><span class="token number">0</span> <span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>                  <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                      matrix<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+=</span> matrix<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                  <span class="token punctuation">&#125;</span>                  <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>j <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                      matrix<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+=</span> matrix<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>                  <span class="token punctuation">&#125;</span>                  <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                      matrix<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>matrix<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>matrix<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>          <span class="token keyword">return</span> matrix<span class="token punctuation">[</span>matrix<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>matrix<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p>æ—¶é—´å¤æ‚åº¦ O m*n ç©ºé—´å¤æ‚åº¦ O 1</p><p>å›é¡¾åŠ¨æ€è§„åˆ’çš„æ€æƒ³ï¼Œè¿™ç§é—®é¢˜è¿˜æ˜¯å¾ˆå…¸å‹ï¼Œè¿™ç§åŠ¨æ€è§„åˆ’çš„æ€æƒ³ä¼šç ´ååŸæœ‰çŸ©é˜µ</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210315090005261.png" alt="image-20210315090005261"></p><p>ç»§ç»­ä¼˜åŒ–</p><p>å¯¹çŸ©é˜µå¾ˆå¤§çš„æƒ…å†µï¼Œå¾ˆå°‘æœ‰å¯èƒ½ä¼šåœ¨ç¬¬ä¸€è¡Œæˆ–è€…ç¬¬ä¸€åˆ—è¿›è¡ŒåŠ ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™å¯ä»¥å…ˆè¿›è¡Œåˆå§‹åŒ–ã€‚ç„¶åç›¸å½“äºä»[1] [1]å¼€å§‹</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> m <span class="token operator">=</span> grid<span class="token punctuation">.</span>length<span class="token punctuation">,</span> n <span class="token operator">=</span> grid<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>     <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment">// åˆå§‹åŒ–ç¬¬ä¸€è¡Œ</span>         grid<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+=</span> grid<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>     <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment">// åˆå§‹åŒ–ç¬¬ä¸€åˆ—</span>         grid<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+=</span> grid<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>     <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>         <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>              grid<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>grid<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> grid<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">return</span> grid<span class="token punctuation">[</span>m <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre></div><p>è‡ªå·±å¯¹åŠ¨æ€è§„åˆ’è¿˜æ˜¯ä¸ç†Ÿæ‚‰</p><h2 id="Jz-48-æœ€é•¿çš„ä¸å«é‡å¤å­—ç¬¦çš„å­å­—ç¬¦ä¸²-â­â­">Jz-48. æœ€é•¿çš„ä¸å«é‡å¤å­—ç¬¦çš„å­å­—ç¬¦ä¸² â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-dp">DP</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210318165801690.png" alt="image-20210318165801690"></p><h3 id="æ€è€ƒ-v4">æ€è€ƒ</h3><p>å¹³å¸¸è§£ æ—¶é—´å¤æ‚åº¦</p><p>å…³é”®æ˜¯æ¯ä¸€æ¬¡indexåˆ°ä¸€ä¸ªæ•°éƒ½éœ€è¦å’Œå½“å‰å­—ç¬¦ä¸²çš„å­—æ¯è¿›è¡Œå¯¹æ¯”ï¼Œèƒ½é¿å…å—ï¼Ÿå®è´¨æ˜¯ç›¸åŒå­—æ¯çš„æœ€å¤§é—´è·ï¼Œä¹Ÿå¯èƒ½ä¸æ˜¯ã€‚</p><h3 id="1-åŠ¨æ€è§„åˆ’">1. åŠ¨æ€è§„åˆ’</h3><h2 id="JZ-54-äºŒå‰æœç´¢æ ‘ç¬¬kå¤§èŠ‚ç‚¹-â­">JZ-54. äºŒå‰æœç´¢æ ‘ç¬¬kå¤§èŠ‚ç‚¹ â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-foreach">InOrder Traversal</div><div class="code-tag-label code-tag-label-tree">Tree</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210405161703797.png" alt="image-20210405161703797"></p><h3 id="æ€è€ƒ-v5">æ€è€ƒ</h3><p>é€’å½’  ï¼Ÿ</p><h3 id="ä¸­åºéå†">ä¸­åºéå†</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> res <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> m <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">kthLargest</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> root<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        m <span class="token operator">=</span> k<span class="token punctuation">;</span>        <span class="token function">getMax</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">getMax</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> node<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>node <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">getMax</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>m <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">--</span>m <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            res <span class="token operator">=</span> node<span class="token punctuation">.</span>val<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">getMax</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p>æ—¶é—´å¤æ‚åº¦ On  ç©ºé—´å¤æ‚åº¦ O1</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210405164353990.png" alt="image-20210405164353990"></p><p>è¿™é“é¢˜ä¸»è¦ä¸€ç›´åœ¨çº ç»“é€’å½’çš„è¿”å›å‚æ•°é—®é¢˜ï¼Œæ€è€ƒçš„æ—¶å€™æ²¡æœ‰æ€è€ƒæ·±å…¥ï¼Œ æ²¡æœ‰æƒ³æ¸…æ¥šæœ¬è´¨ï¼Œä»¥åé‡åˆ°è¿™ç§é—®é¢˜è¿˜æ˜¯è¦å¤šæƒ³ä¸€å“ˆï¼Œä¸è¿‡æ„Ÿè§‰é€’å½’è¿˜æ˜¯ä¸ªäººçš„å¼±ç‚¹â€¦</p><p><strong>æ¶‰åŠåˆ°äºŒå‰æœç´¢æ ‘ï¼Œå°±è¦æƒ³æ¸…æ¥šä»–çš„æ€§è´¨ï¼Œä¸­åºéå†æ˜¯ä»å°åˆ°å¤§çš„æ’åºæ•°ç»„</strong></p><h2 id="JZ-56-æ•°ç»„ä¸­æ•°å­—å‡ºç°çš„æ¬¡æ•°-I-â­â­">JZ-56 æ•°ç»„ä¸­æ•°å­—å‡ºç°çš„æ¬¡æ•° I â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-hash">Hash</div><div class="code-tag-label code-tag-label-math">XOR</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210402213300125.png" alt="image-20210402213300125"></p><h3 id="æ€è€ƒ-v6">æ€è€ƒ</h3><p>On æ—¶é—´å¤æ‚åº¦ O1 ç©ºé—´å¤æ‚åº¦</p><p>å“ˆå¸Œè¡¨è‚¯å®šç”¨ä¸äº†  å–æ¨¡ç®—ä¸äº†    åŠ¨æ€è§„åˆ’ç®—ä¸äº†    åŒæŒ‡é’ˆ     æ•°ç»„è‚¯å®šæ˜¯å¶æ•°é•¿åº¦çš„</p><p>ä¸¤æ¬¡éå†ï¼Ÿ æ’åºï¼Ÿ</p><h3 id="1-My-hashTable">1. My hashTable</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">singleNumbers</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> max <span class="token operator">=</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> result <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>max<span class="token operator">&lt;</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>                max <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> hash <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>max<span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>max<span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            hash<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i  <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> x <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>hash<span class="token punctuation">[</span>x<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                hash<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">*</span>x<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                hash<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">*</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>hash<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">*</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                    result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>            <span class="token keyword">return</span> result<span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span></code></pre></div><p>å±…ç„¶è¿˜ä¸é”™ï¼Ÿ</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210402220633539.png" alt="image-20210402220633539"></p><h3 id="2-My-HashMap">2. My HashMap</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">singleNumbers</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> hashMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> result <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>hashMap<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>               hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>hashMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token keyword">if</span><span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                   result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                   result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> result<span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210402221317356.png" alt="image-20210402221317356"></p><h3 id="3-å¼‚æˆ–å¤§æ³•">3. å¼‚æˆ–å¤§æ³•</h3><p>ç†ç”±ï¼š ç›¸åŒçš„ä¸¤ä¸ªæ•°å­—å¼‚æˆ–ç»“æœè‚¯å®šä¸º 0 ï¼Œä¸”<strong>å¼‚æˆ–å…·æœ‰äº¤æ¢æ€§</strong></p><p>åˆ†ç»„ï¼šæ‰¾åˆ°ä¸åŒçš„a,bä¸åŒçš„ä½æ•° è¿›è¡Œåˆ†ç»„</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">singleNumbers</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> total <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token operator">:</span>nums<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>         total <span class="token operator">^=</span> num<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">int</span> mask <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>mask <span class="token operator">&amp;</span> total<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        mask <span class="token operator">&lt;&lt;=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">int</span> a <span class="token operator">=</span><span class="token number">0</span> <span class="token punctuation">,</span>b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token operator">:</span>nums<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>mask <span class="token operator">&amp;</span> num<span class="token punctuation">)</span> <span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            a <span class="token operator">^=</span> num<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            b <span class="token operator">^=</span> num<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>a<span class="token punctuation">,</span>b<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210403095612566.png" alt="image-20210403095612566"></p><h2 id="Jz-63-è‚¡ç¥¨çš„æœ€å¤§åˆ©æ¶¦-â­â­">Jz-63. è‚¡ç¥¨çš„æœ€å¤§åˆ©æ¶¦ â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-dp">DP</div><div class="code-tag-label code-tag-label-foreach">TwinPointer</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210316215457375.png" alt="image-20210316215457375"></p><h3 id="æ€è€ƒ-v7">æ€è€ƒ</h3><p>åŒæŒ‡é’ˆï¼Ÿæ’åºï¼Ÿ</p><p>å‰åéå†  O 2N</p><h3 id="1-åŒæŒ‡é’ˆéå†">1. åŒæŒ‡é’ˆéå†</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">maxProfit</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> prices<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>prices<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">int</span> maxInterval <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> preIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> lasIndex <span class="token operator">=</span> prices<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>preIndex <span class="token operator">!=</span> lasIndex<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>lasIndex <span class="token operator">!=</span> preIndex<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>prices<span class="token punctuation">[</span>lasIndex<span class="token punctuation">]</span> <span class="token operator">-</span> prices<span class="token punctuation">[</span>preIndex<span class="token punctuation">]</span> <span class="token operator">></span>maxInterval<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                maxInterval <span class="token operator">=</span> prices<span class="token punctuation">[</span>lasIndex<span class="token punctuation">]</span> <span class="token operator">-</span> prices<span class="token punctuation">[</span>preIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            lasIndex <span class="token operator">--</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        preIndex <span class="token operator">++</span><span class="token punctuation">;</span>        lasIndex <span class="token operator">=</span> prices<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> maxInterval<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>æ—¶é—´å¤æ‚åº¦ On*n ç©ºé—´å¤æ‚åº¦ O1</p><h3 id="2-åŠ¨æ€è§„åˆ’-v3">2. åŠ¨æ€è§„åˆ’</h3><p>æ ¸å¿ƒæ€æƒ³</p><p>åˆ›å»ºä¸€ä¸ªæ•°ç»„ dp[i]ä»£è¡¨çš„æ˜¯iå¤©å–å‡ºæ—¶çš„æœ€å¤§æ”¶ç›Š</p><p>åˆå¯ç­‰äº ç¬¬i-1å¤©çš„æœ€å¤§æ”¶ç›Š æˆ–è€… ç¬¬iå¤©ä»·æ ¼ - å‰i-1å¤©ä»·æ ¼çš„æœ€ä½ä»·</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">maxProfit</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> prices<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">int</span> minValue <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>       <span class="token keyword">int</span> profit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>prices<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           minValue <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>minValue<span class="token punctuation">,</span>prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           profit <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>profit<span class="token punctuation">,</span>prices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>minValue<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> profit<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210316225500458.png" alt="image-20210316225500458"></p><p>æ—¶é—´å¤æ‚åº¦On ç©ºé—´å¤æ‚åº¦O1</p><p>è¿˜æ˜¯ï¼Œå¤šå»æ‰¾é€šé¡¹å…¬å¼ï¼Œä¸ä¸€å®šæ˜¯ç¬¦å·è¡¨è¾¾çš„ï¼Œèƒ½ç”¨è¯­è¨€åˆ»ç”»çš„ä¸€æ ·å¯ä»¥</p><h2 id="JD-17-09-ç¬¬Kä¸ªæ•°-â­â­">JD-17.09. ç¬¬Kä¸ªæ•° â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-dp">DP</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210428183546466.png" alt="image-20210428183546466"></p><h3 id="æ€è€ƒ-v8">æ€è€ƒ</h3><p>é€’å½’ã€åŠ¨æ€è§„åˆ’ æ— æœ</p><h3 id="1-åŠ¨æ€è§„åˆ’-v2">1. åŠ¨æ€è§„åˆ’</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getKthMagicNumber</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> numList<span class="token operator">=</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token keyword">int</span> p3<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>p5<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>p7<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>       numList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>k<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           numList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>numList<span class="token punctuation">[</span>p3<span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">,</span>numList<span class="token punctuation">[</span>p5<span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>numList<span class="token punctuation">[</span>p7<span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>numList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>numList<span class="token punctuation">[</span>p3<span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">)</span> p3<span class="token operator">++</span><span class="token punctuation">;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>numList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>numList<span class="token punctuation">[</span>p5<span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">5</span><span class="token punctuation">)</span> p5<span class="token operator">++</span><span class="token punctuation">;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>numList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>numList<span class="token punctuation">[</span>p7<span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">7</span><span class="token punctuation">)</span> p7<span class="token operator">++</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> numList<span class="token punctuation">[</span>k<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210428183707107.png" alt="image-20210428183707107"></p><p>è¿™æ˜¯åˆå¹¶å­åºåˆ—é—®é¢˜ï¼Œå½“è¿™ç§å¯é€‰æ‹©çš„ï¼Œå¯åˆ†æˆä¸åŒæ•°ç»„çš„Ié—®é¢˜ï¼Œå¯ä»¥é‡‡ç”¨<strong>åˆå¹¶å­åºåˆ—æ–¹æ³•</strong>ï¼Œå¤šç´¢å¼•åˆ¤æ–­</p><h2 id="1-ä¸¤æ•°ä¹‹å’Œ-â­">1. ä¸¤æ•°ä¹‹å’Œ â­</h2><div class="code-tag-time">2021/3/7 23:02:00</div><div class="code-tag-label code-tag-label-foreach">TwinPointer</div><div class="code-tag-label code-tag-label-hash">Hash</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307223505616.png" alt="image-20210307223505616"></p><p>å…ˆå®¡é¢˜ï¼Œ ä¸¤ä¸ªæ•´æ•°ï¼Œè¿”å›æ•°ç»„ä¸‹æ ‡ï¼Œç»™å‡ºçš„æ•°ç»„ä¸æ˜¯æ’åºçš„ï¼Œè¿”å›çš„æ•°ç»„æ˜¯æ’åºçš„ï¼Ÿ</p><p>å›è¿‡å¤´æ‰å‘ç°å¿½ç•¥çš„å› ç´ ï¼š  æ•°ç»„æ˜¯å¦æœ‰ç›¸åŒå…ƒç´ ï¼Ÿ</p><h3 id="æ€è·¯-v2">æ€è·¯</h3><ol><li>äºŒåˆ†ï¼Ÿ</li><li>æ’åºåæ‰¾ï¼Ÿ</li><li></li></ol><p>æˆ‘çš„ä»£ç ï¼š</p><h3 id="1-åŒå¤´æŒ‡é’ˆ">1.  åŒå¤´æŒ‡é’ˆ</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java">   <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token keyword">int</span> i<span class="token punctuation">,</span>j<span class="token punctuation">;</span><span class="token comment">//ä¸€ä¸ªå‘å‰ ä¸€ä¸ªå‘åï¼Œé¿å…é‡å¤æŸ¥æ‰¾</span>   <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span>j <span class="token operator">=</span> nums<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> j<span class="token operator">></span>i<span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span>nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> target<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>               result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> j<span class="token punctuation">;</span>               <span class="token keyword">return</span> result<span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307224350988.png" alt="image-20210307224350988"></p><p>æ—¶é—´å¤æ‚åº¦  O(N<sup>2</sup>)   ç©ºé—´å¤æ‚åº¦ O(1)</p><h3 id="2-å“ˆå¸Œè¡¨">2. å“ˆå¸Œè¡¨</h3><p>ç¡®å®ï¼Œæœ€å¼€å§‹æƒ³åˆ°äº†éƒ‘è€æ¿å‡ºé¢˜çš„æ—¶å€™è¿™ä¸ªï¼Œåªæ˜¯æ€•æ”¾å…¥mapé›†åˆåˆä¼šæ¶ˆè€—ä¸€å®šçš„æ—¶é—´ï¼Œå“â€¦</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Map</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> j <span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    j <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>map<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>j <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>j<span class="token punctuation">,</span>i<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>target <span class="token operator">-</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210307230039420.png" alt="image-20210307230039420"></p><p>æ—¶é—´å¤æ‚åº¦ :  O(N)   ç©ºé—´å¤æ‚åº¦ O(N) å“ˆå¸Œè¡¨çš„å¼€é”€</p><p>è¿™é‡Œç”±äºå“ˆå¸Œè¡¨ çš„getæ–¹æ³•æ˜¯ O(1)çš„å¼€é”€ï¼Œæ‰€ä»¥è€ƒè™‘å“ˆå¸Œè¡¨çš„æ–¹å¼ç›´æ¥æŸ¥æ‰¾ï¼Œç²¾å¦™ä¹‹å¤„åœ¨ä¸å…¶ç´¢å¼•keyçš„çµæ´»ä½¿ç”¨</p><h2 id="4-å¯»æ‰¾ä¸¤ä¸ªæ­£åºæ•°ç»„çš„ä¸­ä½æ•°-â­â­â­">4. å¯»æ‰¾ä¸¤ä¸ªæ­£åºæ•°ç»„çš„ä¸­ä½æ•° â­â­â­</h2><div class="code-tag-time">2022/11/8 21:12:00</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20221108211139910.png" alt="image-20221108211139910"></p><h3 id="æ€è·¯-v3">æ€è·¯</h3><ul><li>æš´åŠ›è§£æ³•ï¼šå°†ä¸¤ä¸ªæ•°ç»„åˆäºŒä¸ºä¸€ç„¶åç›´æ¥å–ä¸­ä½æ•°å³å¯ï¼Œæ—¶é—´ã€ç©ºé—´å¤æ‚åº¦O(m + n)</li><li>åŸºäºæ•°ç»„æ˜¯æ­£åºçš„æ¥æ€è€ƒ</li></ul><h3 id="1-åŒæŒ‡é’ˆ-æœªè¾¾æ ‡">1. åŒæŒ‡é’ˆ (æœªè¾¾æ ‡)</h3><p>å¹¶ä¸éœ€è¦å¾—åˆ°æ•´ä¸ªæ•°ç»„å†å»ç”¨O1çš„æ—¶é—´æ‰¾ï¼Œåªéœ€è¦åœ¨å®šä½åˆ°ä¸­ä½æ•°ï¼Œå³å“ªä¸ªæ•°åœ¨æ•°ç»„ï¼Œä¹Ÿå°±æ˜¯ä½äº (m + n) / 2 æˆ–è€… (m + n) / 2ä¸ (m + n) / 2 - 1çš„ä½ç½®ï¼Œåœ¨æ­¤ä¹‹å‰æ•°ç»„éƒ½æ˜¯æ­£åºæ’åºçš„ã€‚æ‰€ä»¥åªéœ€è¦åœ¨ä¸¤ä¸ªæ•°ç»„ä¸­ç­›é€‰å‡ºå‰(m + n) / 2ä¸ªæ•°å³å¯ã€‚</p><p>ä»£ç ä¸å¤Ÿä¼˜é›…ï¼Œæœ‰å¾…æ”¹è¿›ã€‚</p><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c"><span class="token keyword">double</span> <span class="token function">findMedianSortedArrays</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span> nums1<span class="token punctuation">,</span> <span class="token keyword">int</span> nums1Size<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">*</span> nums2<span class="token punctuation">,</span> <span class="token keyword">int</span> nums2Size<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">double</span> arr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>i <span class="token operator">+</span> j  <span class="token operator">&lt;=</span> <span class="token punctuation">(</span>nums1Size <span class="token operator">+</span> nums2Size<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token comment">// ç”¨äºä¿å­˜(nums1Size + nums2Size) / 2çš„å…ƒç´ åˆ°å¦ä¸€ä¸ªå˜é‡ä¸­</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">+</span> j <span class="token operator">==</span> <span class="token punctuation">(</span>nums1Size <span class="token operator">+</span> nums2Size<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            index <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">>=</span> nums1Size<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            arr<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> nums2<span class="token punctuation">[</span>j<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>j <span class="token operator">>=</span> nums2Size<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            arr<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> nums1<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>nums1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> nums2<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            arr<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> nums1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> nums2<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">?</span> nums1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">:</span>nums2<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>            j<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            arr<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> nums1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> nums2<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">?</span> nums1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">:</span>nums2<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>            i<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>  <span class="token comment">// åˆ¤æ–­ä¸­ä½æ•°æ˜¯ä¸€ä¸ªè¿˜æ˜¯ä¸¤ä¸ª</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>nums1Size <span class="token operator">+</span> nums2Size<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p>æ—¶é—´å¤æ‚åº¦O(m + n)</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20221108211307933.png" alt="image-20221108211307933"></p><h3 id="2-äºŒåˆ†æŸ¥æ‰¾">2. äºŒåˆ†æŸ¥æ‰¾</h3><p>å¯ä»¥æ€è€ƒä¸€ç§åœ¨Ologæ—¶é—´å¤æ‚åº¦å†…åˆ°æ–¹æ³•ï¼Œå·§å¦™</p><h2 id="6-Z-å­—å½¢å˜æ¢â­â­">6. Z å­—å½¢å˜æ¢â­â­</h2><div class="code-tag-time">2022/3/3 20:32:00</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><div class="code-tag-label code-tag-label-math">Formula</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220303191539454.png" alt="image-20220303191539454"></p><h3 id="å®¡é¢˜">å®¡é¢˜</h3><ul><li>Zå­—å½¢æ’åºä¸»è¦é’ˆå¯¹åˆ— numRowé™å®šè¡Œæ•°ï¼Œå¤šçš„è¡Œæ•°å¯èƒ½ä¼šå¢åŠ éš¾åº¦</li><li>å¯èƒ½çš„æ•°æ®ç»“æ„ã€æ•°å­¦å…¬å¼ï¼Ÿ</li><li>åˆ†æï¼š<ul><li>ç®€å•ï¼šå…ˆåˆ›å»ºäºŒç»´å­—ç¬¦çŸ©é˜µï¼Œç„¶åæ ¹æ®å¡«å¥½çš„çŸ©é˜µæŒ‰ç…§æ¬¡åºè¾“å‡ºï¼Œä½†è¿™æ ·çš„ç©ºé—´å¤æ‚åº¦é«˜</li><li>è¿›é˜¶ï¼šæŒ‰ç…§è§„å¾‹ç›´æ¥åˆ’åˆ†ä¸€ç»´çš„æ•°ç»„</li></ul></li><li>åšååæ€ç‚¹ï¼š<ul><li>rowä¸ä¸º1å’Œnå’Œä¸º1å’Œnçš„æ—¶å€™çš„ç‰¹æ®Šæƒ…å†µï¼Œä¸€æ¬¡å­˜åœ¨2ä¸ªç‚¹å’Œåªå­˜åœ¨ä¸€ä¸ªç‚¹</li></ul></li></ul><h3 id="1-æš´åŠ›">1. æš´åŠ›</h3><p>å…ˆåˆ’åˆ†å¥½äºŒç»´å­—ç¬¦çŸ©é˜µï¼Œç„¶åå†æŒ‰ç…§Zå­—å½¢æ’åºä¾æ¬¡å¡«å…¥çŸ©é˜µä¸­ï¼Œæœ€åä»çŸ©é˜µä¸­ä¾ç…§è¡Œåˆ—é¡ºåºè¯»å°±è¡Œäº†ã€‚</p><p>ç¼ºç‚¹ï¼šè€—è´¹O(numRow * actCol)çš„ç©ºé—´å¤æ‚åº¦</p><h3 id="2-æ•°å­¦å…¬å¼">2. æ•°å­¦å…¬å¼</h3><p>ä¸€ç»´å­—ç¬¦æ•°ç»„æœ¬æ¥ä¸ç”¨æ’åˆ°äºŒç»´çŸ©é˜µä¸­å°±æœ‰çš„Zå­—å½¢é€»è¾‘ï¼Œé€»è¾‘ä¸Šé€šè¿‡ç­‰å·®æ•°åˆ—ä¹Ÿå¯ä»¥å¾—åˆ°</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">convert</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span> numRows<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// ç‰¹æ®Šæƒ…å†µåˆ¤æ–­ï¼Œé¿å…åé¢é™¤æ³•å‡ºç°åˆ†æ¯ä¸º0çš„æƒ…å†µ</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>numRows <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> s<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">StringBuilder</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> actCol <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>numRows <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> numRows<span class="token punctuation">;</span>        <span class="token keyword">int</span> curRow <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>curRow <span class="token operator">&lt;=</span> numRows<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>curRow <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">||</span> curRow <span class="token operator">==</span> numRows<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> actCol<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>curRow <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> i <span class="token operator">*</span> <span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                        sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>curRow <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> i <span class="token operator">*</span> <span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>                curRow<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>curRow <span class="token operator">&lt;=</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>curRow <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> actCol<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">if</span><span class="token punctuation">(</span>curRow <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> i <span class="token operator">*</span> <span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>curRow<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token operator">&lt;=</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                        sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>curRow <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> i <span class="token operator">*</span> <span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>curRow<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                    <span class="token keyword">if</span><span class="token punctuation">(</span>curRow <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> i <span class="token operator">*</span> <span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                        sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>curRow <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> i <span class="token operator">*</span> <span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>                curRow<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> sb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220303202830051.png" alt="image-20220303202830051"></p><p>è¿˜ä¸é”™ï¼Onçš„æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦ï¼ŒsbèŠ‚çœäº†ä¸€å®šçš„æ—¶é—´</p><h3 id="3-é¡ºåºéå†-åˆ†è¡Œå­˜å‚¨-è½¬">3. é¡ºåºéå† åˆ†è¡Œå­˜å‚¨ (è½¬)</h3><p>æ€è·¯å°±æ˜¯æŒ‰ç…§é¡ºåºéå†ï¼Œé€šè¿‡ç´¢å¼•flagåŒºåˆ†åˆ°å“ªä¸€è¡Œäº†ï¼Œåˆ°Zå­—å½¢è½¬æŠ˜ç‚¹æ—¶å°±flagâ€“ï¼Œéå¸¸çš„å·§å¦™ã€‚æ€è·¯çœŸçš„æ˜¯éå¸¸çš„å¥½æƒ³ï¼Œä¸ºä»€ä¹ˆæˆ‘å¼€å§‹æ²¡æœ‰æƒ³åˆ°è¿™ä¹ˆå¥½æ»´æ€è·¯ï¼Ÿæ„Ÿè§‰è‡ªå·±ä¸€ä¸‹å°±è·³è¿‡é¡ºåºéå†è¿™ç§æƒ³æ³•äº†ï¼Œå¯èƒ½å› ä¸ºè§‰å¾—åˆ†è¡Œå­˜å‚¨ä¸å¥½åšå§ï¼ˆä½†å®é™…è¿˜æ˜¯å¯ä»¥çš„ï¼‰</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">convert</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span> numRows<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>numRows <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">return</span> s<span class="token punctuation">;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">StringBuilder</span><span class="token punctuation">></span></span> rows <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">StringBuilder</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> numRows<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> rows<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> flag <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">char</span> c <span class="token operator">:</span> s<span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            rows<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> i <span class="token operator">==</span> numRows <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> flag <span class="token operator">=</span> <span class="token operator">-</span> flag<span class="token punctuation">;</span>            i <span class="token operator">+=</span> flag<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">StringBuilder</span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">StringBuilder</span> row <span class="token operator">:</span> rows<span class="token punctuation">)</span> res<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// ä½œè€…ï¼šjyd</span><span class="token comment">// é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/zigzag-conversion/solution/zzi-xing-bian-huan-by-jyd/</span></code></pre></div><p>ä½†å› ä¸ºä½¿ç”¨äº†å¤šä¸ªSBï¼Œæ‰€ä»¥è¿™é‡Œçš„ç©ºé—´å ç”¨ç‡ç•¥é«˜ï¼Œè¿˜å­˜åœ¨å¤šä¸ªsbåˆå¹¶çš„åˆå¹¶çš„æƒ…å†µï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦ä¹Ÿç›¸å¯¹è¾ƒé«˜ï¼Œä½†æ˜¯æ€è·¯ç¡®å®æ˜¯éå¸¸çš„æ¸…æ™°çš„ã€‚</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220303204028214.png" alt="image-20220303204028214"></p><h3 id="åæ€">åæ€</h3><p>è¿˜æ˜¯åšé¢˜çš„æ—¶å€™çš„ä¸€äº›é—®é¢˜ï¼š</p><ol><li>å¯„â€¦ èŠ±äº†å¾ˆå¤šæ—¶é—´ï¼Œä¸­é—´å¡äº†å¾ˆä¹…ï¼Œç»“æœæ˜¯å› ä¸ºè‡ªå·±åšé¢˜æ˜¯è®¾äº†ä¸ªnï¼Œé»˜è®¤çš„æ˜¯numRowsï¼Œä½†åº”ç”¨çš„æ—¶å€™æ²¡æœ‰å†™ï¼Œå¯¼è‡´æŸ¥äº†åŠå¤©bugã€‚è¿˜æ˜¯å†™çš„æ—¶å€™ä¸¥è°¨ä¸€ç‚¹ï¼Œå°½å¯èƒ½ç”¨å®ƒç»™çš„å‚æ•°ï¼Œå¦åˆ™å°±è‡ªå·±æå‰è¯´æ˜å¥½æ¥</li><li>æ•°å­¦å¤ªæ’‡ï¼Œç­‰å·®å…¬å¼è¿˜çœ‹é”™äº†â€¦</li><li>è¿˜æœ‰charAtå’Œè‡ªå·±å†™çš„rowèµ·å§‹ç´¢å¼•ä¸ä¸€è‡´å¯¼è‡´åç»­æ›´æ¢é—®é¢˜ï¼Œæœ¬æ¥æ˜¯0å¼€å§‹ï¼Œæˆ‘è‡ªå·±ä¸ºäº†æ–¹ä¾¿ä»1å¼€å§‹ï¼Œä½†åç»­å°±éœ€è¦-1ï¼Œå¦‚æœæ²¡å‘ç°è¿™ä¸ªé—®é¢˜çš„è¯è¿˜ä¼šæœ‰é”™è¯¯</li></ol><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201009182029446.png" alt="image-20201009182029446"></p><h2 id="7-æ•´æ•°åè½¬-â­â­">7. æ•´æ•°åè½¬ â­â­</h2><blockquote><p>Time : 2022 / 4 / 6 9 :46<br>TAG : Overflow / Decimal</p></blockquote><div class="code-tag-time">2022/4/6 09:46:00</div><div class="code-tag-label code-tag-label-math">Math</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220405204338443.png" alt="image-20220405204338443"></p><h3 id="å®¡é¢˜-v2">å®¡é¢˜</h3><ul><li>ç¿»è½¬åæ•´æ•°è¶…è¿‡32ä½signed èŒƒå›´å°±è¿”å›0</li><li>ç¯å¢ƒä¸å‡†å­˜å‚¨64ä½æ•´æ•°</li><li>æ€è·¯ï¼š<ul><li>ç›´æ¥ï¼š<ul><li>åè¿›åˆ¶æŒ‰ä½å–ï¼Œç„¶åå†æ‹¼å‡‘</li><li>ä½è¿ç®—ï¼Ÿ</li></ul></li></ul></li></ul><h3 id="1-åè¿›åˆ¶æŒ‰ä½è®¡ç®—">1. åè¿›åˆ¶æŒ‰ä½è®¡ç®—</h3><p>æŒ‰åè¿›åˆ¶å–ä½ï¼Œç„¶åå†åè¿‡æ¥ä¹˜ï¼Œç»„æˆæ–°çš„åè¿›åˆ¶ã€‚ä½†éœ€è¦æ³¨æ„ä»¥ä¸‹é—®é¢˜ï¼š</p><ul><li><strong>è´Ÿæ•°å–æ¨¡é—®é¢˜</strong>ï¼štempå–ç»å¯¹å€¼ï¼Œå› ä¸ºè´Ÿæ•°çš„ç¬¦å·å½±å“ä¹‹åçš„åŠ å‡æ³•</li><li><strong>å¦‚ä½•æ­£ç¡®åˆ¤æ–­æº¢å‡ºçš„æƒ…å†µï¼Ÿ</strong></li></ul><p>å†—ä½™ï¼šæˆ‘è¿™é‡ŒArrayListå®Œå…¨æ²¡å¿…è¦ï¼Œå› ä¸ºåé¢çš„è®¡ç®—é¡ºåºæ˜¯ä»åå¾€å‰ç®—ï¼Œå…¶å®ä¹Ÿå¯ä»¥ä»å‰å¾€åç®—</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">reverse</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">int</span> temp <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token keyword">int</span> flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token keyword">int</span> paw <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>       <span class="token keyword">while</span><span class="token punctuation">(</span>temp <span class="token operator">/</span> <span class="token number">10</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>temp <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           temp <span class="token operator">=</span> temp <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>temp <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">int</span> i <span class="token operator">=</span>  list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">while</span><span class="token punctuation">(</span>i <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">int</span> tmp <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token operator">--</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> tmp <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>               <span class="token comment">// Overflow detection</span>               <span class="token keyword">if</span><span class="token punctuation">(</span>res <span class="token operator">></span> tmp <span class="token operator">*</span> paw <span class="token operator">+</span> res<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>               res <span class="token operator">=</span> <span class="token punctuation">(</span>tmp <span class="token operator">*</span> paw<span class="token punctuation">)</span> <span class="token operator">+</span>res<span class="token punctuation">;</span>               flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>               paw <span class="token operator">*=</span> <span class="token number">10</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>    <span class="token comment">// overflow detection.not rigorous</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>res <span class="token operator">%</span> <span class="token number">10</span> <span class="token operator">!=</span> list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">return</span> <span class="token operator">-</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> res<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p>O(n)çš„æ—¶é—´å¤æ‚åº¦ï¼ŒåŠ å‡æ³•å’Œæ¨¡10è€—æ—¶</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220405212648589.png" alt="image-20220405212648589"></p><h4 id="é¢˜è§£çš„ä¼˜åŒ–">é¢˜è§£çš„ä¼˜åŒ–</h4><p>å®˜æ–¹é¢˜è§£çš„ä¼˜åŒ–ç¡®å®æ¯”æˆ‘å†™çš„è¦å¥½å¾—å¤šï¼Œç”¨ &lt; Integer.xxx_VALUE / 10 æ¥åˆ¤æ–­æ˜¯å¦æº¢å‡ºï¼Œè¿™ç§æ–¹æ³•éå¸¸çš„ç®€ä¾¿å¿«é€Ÿ</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">reverse</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">int</span> rev <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token keyword">while</span> <span class="token punctuation">(</span>x <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span>rev <span class="token operator">&lt;</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MIN_VALUE <span class="token operator">/</span> <span class="token number">10</span> <span class="token operator">||</span> rev <span class="token operator">></span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">int</span> digit <span class="token operator">=</span> x <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">;</span>           x <span class="token operator">/=</span> <span class="token number">10</span><span class="token punctuation">;</span>           rev <span class="token operator">=</span> rev <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">+</span> digit<span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> rev<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220406093819912.png" alt="image-20220406093819912"></p><h4 id="æ³¨æ„ç‚¹-v2">æ³¨æ„ç‚¹</h4><p>é¢˜è§£çš„æ–¹æ³•è·Ÿæˆ‘æ–¹æ³•å·®è·è¿™ä¹ˆå¤§ä¸»è¦æ˜¯æœ‰ä¸€ä¸ªåŸå› ï¼š</p><ul><li><p>å½“é¡ºåºå–æ¨¡10çš„æ•°ï¼Œå³ä»ä½åˆ°é«˜ä½ï¼Œåˆ™</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java">rev <span class="token operator">=</span> rev <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">+</span> digit<span class="token punctuation">;</span></code></pre></div></li><li><p>å½“é€†åºå–æ¨¡10çš„æ•°ï¼Œå³ä»é«˜åˆ°ä½ä½ï¼Œåˆ™</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java">res <span class="token operator">=</span> <span class="token punctuation">(</span>digit <span class="token operator">*</span> paw<span class="token punctuation">)</span> <span class="token operator">+</span>res<span class="token punctuation">;</span></code></pre></div></li></ul><p>ä¸¤ç§æ€è·¯ä¸ä¸€æ ·ï¼Œäº§ç”Ÿçš„è§£å†³æ–¹æ³•ä¹Ÿå°±ä¸ä¸€æ ·ï¼Œç¬¬ä¸€ç§çš„è§£å†³æ–¹æ³•èƒ½åœ¨ä¸€æ¬¡éå†å†…å°±è§£å†³ï¼Œè€Œæˆ‘è¿™ä¸€ç§è¦å…ˆéå†ä¸€æ¬¡å¹¶å­˜å‚¨ï¼Œå†ä»é›†åˆä¸­å»å–ï¼Œç»å†ä¸¤æ¬¡è¿ç®—å’Œé›†åˆæ“ä½œï¼Œè‡ªç„¶å°±è¦æ…¢ä¸€ç‚¹ã€‚</p><p><strong>æ‰€ä»¥è¿˜æ˜¯å¯¹ä¸€ç§å·²çŸ¥æ–¹æ³•å°±æ•°å­¦é—®é¢˜ä¸Šè¦æ€è€ƒä¸€ä¸‹æœ‰æ²¡æœ‰å…¶ä»–çš„æ–¹å¼èƒ½å¾—åˆ°è¿™ä¸ªå€¼ï¼Œå¤šæ€è€ƒå‡ ç§æ–¹æ¡ˆå–æœ€ç®€æ´çš„é‚£ä¸€ç§</strong></p><h3 id="2-å­—ç¬¦ä¸²åè½¬">2. å­—ç¬¦ä¸²åè½¬</h3><p>çªå‘å¥‡æƒ³ï¼Œç”¨ç±»åº“è¿›è¡Œå­—ç¬¦ä¸²åè½¬ï¼Œå†Catch Exceptionå»æ•è·æº¢å‡ºæ—¶è½¬æ¢çš„å¼‚å¸¸ï¼Œæ¯”è¾ƒæ…¢ä½†æ˜¯ç®—æ˜¯ä¸€ç§æ–¹æ³•â€¦</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">reverse</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token char">'0'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token comment">// æˆªå–å°¾æ•°è¿ç»­ä¸º0çš„éƒ¨åˆ†</span>        s<span class="token operator">=</span>s<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>         <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">try</span><span class="token punctuation">&#123;</span>            res <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">NumberFormatException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>x <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token operator">-</span>res<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220406093556481.png" alt="image-20220406093556481"></p><h2 id="11-ç››æœ€å¤šæ°´çš„å®¹å™¨-â­â­">11. ç››æœ€å¤šæ°´çš„å®¹å™¨ â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><h3 id="ä¸€æ¬¡éå†-ï¼ˆåŒæŒ‡é’ˆï¼‰">ä¸€æ¬¡éå† ï¼ˆåŒæŒ‡é’ˆï¼‰</h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201010183940869.png" alt="image-20201010183940869"></p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">waterV_1</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>         <span class="token keyword">int</span> max<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>tmp<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>         <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>j<span class="token operator">=</span>a<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>         <span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">&lt;</span>j<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>             <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span>a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>                 tmp<span class="token operator">=</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">(</span>j<span class="token operator">-</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">></span>a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>                 tmp<span class="token operator">=</span>a<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">(</span>j<span class="token operator">--</span> <span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token keyword">if</span><span class="token punctuation">(</span>max<span class="token operator">&lt;</span>tmp<span class="token punctuation">)</span>                 max<span class="token operator">=</span>tmp<span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>         <span class="token keyword">return</span> max<span class="token punctuation">;</span>         <span class="token comment">/*             æ—¶é—´å¤æ‚åº¦ï¼šO(N)O(N)ï¼ŒåŒæŒ‡é’ˆæ€»è®¡æœ€å¤šéå†æ•´ä¸ªæ•°ç»„ä¸€æ¬¡ã€‚             ç©ºé—´å¤æ‚åº¦ï¼šO(1)O(1)ï¼Œåªéœ€è¦é¢å¤–çš„å¸¸æ•°çº§åˆ«çš„ç©ºé—´ã€‚          */</span>     <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201010182820360.png" alt="image-20201010182820360"></p><p>è§£é¢˜æ€è·¯ï¼š</p><p>â€‹ç”±æš´åŠ›çš„ä¸¤é‡forå¾ªç¯ï¼Œ è€ƒè™‘åˆ° å·¦å³ä¸¤ä¾§çš„å¯ç§»åŠ¨æ€§ï¼Œè¿›è€Œæƒ³åˆ°åŒæŒ‡é’ˆ</p><hr><h2 id="12-æ•´æ•°è½¬ç½—é©¬æ•°å­—-â­â­">12. æ•´æ•°è½¬ç½—é©¬æ•°å­— â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-hash">Hash</div><div class="code-tag-label code-tag-label-greedy">Greedy</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201012085753307.png" alt="image-20201012085753307"></p><p>æˆ‘çš„ä»£ç ï¼š</p><h3 id="HaspMap-å­˜å‚¨é”®å€¼å¯¹-åˆ¤æ–­">HaspMap å­˜å‚¨é”®å€¼å¯¹ åˆ¤æ–­</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">getOne</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>     <span class="token class-name">StringBuilder</span> stringBuilder<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">,</span><span class="token number">900</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>     <span class="token keyword">int</span> i<span class="token operator">=</span>a<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>     <span class="token class-name">Map</span> hashMap<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"I"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">"IV"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token string">"IX"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token string">"XL"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token string">"XC"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token string">"CD"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">900</span><span class="token punctuation">,</span><span class="token string">"CM"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token string">"X"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token string">"L"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token string">"C"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token string">"M"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>         <span class="token keyword">if</span><span class="token punctuation">(</span>n<span class="token operator">/</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>             n<span class="token operator">=</span>n<span class="token operator">-</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>             stringBuilder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>hashMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>             i<span class="token operator">--</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>     <span class="token punctuation">&#125;</span>     <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>stringBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201012090037059.png" alt="image-20201012090037059"></p><h3 id="è´ªå¿ƒæ³•int-String-åŸºæœ¬æ•°ç»„-å¯¹åº”å­˜å‚¨"><strong>è´ªå¿ƒæ³•</strong>int String åŸºæœ¬æ•°ç»„ å¯¹åº”å­˜å‚¨</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">intToRoman</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token class-name">StringBuilder</span> stringBuilder<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">900</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>     <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> s <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"M"</span><span class="token punctuation">,</span><span class="token string">"CM"</span><span class="token punctuation">,</span><span class="token string">"D"</span><span class="token punctuation">,</span><span class="token string">"CD"</span><span class="token punctuation">,</span><span class="token string">"C"</span><span class="token punctuation">,</span><span class="token string">"XC"</span><span class="token punctuation">,</span><span class="token string">"L"</span><span class="token punctuation">,</span><span class="token string">"XL"</span><span class="token punctuation">,</span><span class="token string">"X"</span><span class="token punctuation">,</span><span class="token string">"IX"</span><span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">,</span><span class="token string">"IV"</span><span class="token punctuation">,</span><span class="token string">"I"</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>     <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>     <span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">&lt;</span>a<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>         <span class="token keyword">if</span><span class="token punctuation">(</span>num<span class="token operator">>=</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>             num<span class="token operator">=</span>num<span class="token operator">-</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>             stringBuilder<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>             i<span class="token operator">++</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>     <span class="token punctuation">&#125;</span>     <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>stringBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201012090139984.png" alt="image-20201012090139984"></p><h3 id="æ€è€ƒ-v9">æ€è€ƒ</h3><ul><li>å¯¹äºåˆ¤æ–­ å’Œ è¾“å‡ºå¯¹äºå­—ç¬¦çš„æ€è·¯ï¼Œæˆ‘çš„æ€è·¯ä¸Šä¸é¢˜è®¾å¤§ä½“ä¸€è‡´</li><li>ä¸èƒ½è§£å†³ 4 -9 çš„é—®é¢˜ï¼Œå°±åªèƒ½å­˜å‚¨è¿›æ•°ç»„ä¸­ï¼Œé€šè¿‡ç´¢å¼•è§£å†³</li></ul><h4 id="HashMap-ä¸­çš„getæ–¹æ³•æ—¶é—´å¤æ‚åº¦æ˜¯å¦ä¸ºOï¼ˆ1ï¼‰ï¼Ÿ">HashMap ä¸­çš„getæ–¹æ³•æ—¶é—´å¤æ‚åº¦æ˜¯å¦ä¸ºOï¼ˆ1ï¼‰ï¼Ÿ</h4><p>åœ¨hashä¸å‘ç”Ÿå†²çªçš„æƒ…å†µä¸‹ï¼Œ æ˜¯Oï¼ˆ1ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæœ€ä¼˜æƒ…å†µæ‰æ˜¯O(1)ï¼Œæ²¡æœ‰ç¬¬äºŒç§æ–¹æ³•ç›´æ¥å»ºç«‹int a[] å’ŒString s[]çš„ç›´æ¥å¯¹åº”è”ç³»æ¥çš„ å¿«</p><h2 id="17-ç”µè¯å·ç çš„å­—æ¯ç»„åˆ-â­â­">17. ç”µè¯å·ç çš„å­—æ¯ç»„åˆ  â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201012205456540.png" alt="image-20201012205456540"></p><p>æˆ‘çš„ä»£ç ï¼š</p><h3 id="Stringç±»å‹çš„è¿­ä»£">Stringç±»å‹çš„è¿­ä»£</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java">    <span class="token keyword">private</span> <span class="token class-name">String</span> letterMap<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">" "</span><span class="token punctuation">,</span>    <span class="token comment">//0</span>            <span class="token string">""</span><span class="token punctuation">,</span>     <span class="token comment">//1</span>            <span class="token string">"abc"</span><span class="token punctuation">,</span>  <span class="token comment">//2</span>            <span class="token string">"def"</span><span class="token punctuation">,</span>  <span class="token comment">//3</span>            <span class="token string">"ghi"</span><span class="token punctuation">,</span>  <span class="token comment">//4</span>            <span class="token string">"jkl"</span><span class="token punctuation">,</span>  <span class="token comment">//5</span>            <span class="token string">"mno"</span><span class="token punctuation">,</span>  <span class="token comment">//6</span>            <span class="token string">"pqrs"</span><span class="token punctuation">,</span> <span class="token comment">//7</span>            <span class="token string">"tuv"</span><span class="token punctuation">,</span>  <span class="token comment">//8</span>            <span class="token string">"wxyz"</span>  <span class="token comment">//9</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> res<span class="token punctuation">;</span>   <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> <span class="token function">letterCombinations</span><span class="token punctuation">(</span><span class="token class-name">String</span> digits<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>digits<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span>           <span class="token keyword">return</span> list<span class="token punctuation">;</span>       <span class="token keyword">else</span><span class="token punctuation">&#123;</span>           <span class="token function">getString</span><span class="token punctuation">(</span>digits<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">return</span> list<span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">void</span>  <span class="token function">getString</span><span class="token punctuation">(</span><span class="token class-name">String</span> digits<span class="token punctuation">,</span><span class="token keyword">int</span> index<span class="token punctuation">,</span><span class="token class-name">String</span> tmp<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>index<span class="token operator">==</span>digits<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">char</span> c<span class="token operator">=</span>digits<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> letter<span class="token operator">=</span>arrstr<span class="token punctuation">[</span>c<span class="token operator">-</span><span class="token char">'0'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>letter<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">getString</span><span class="token punctuation">(</span>digits<span class="token punctuation">,</span>index<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>tmp<span class="token operator">+</span>letter<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201012212830953.png" alt="image-20201012212830953"></p><h3 id="StringBuilder-å®ç°çš„è¿­ä»£">StringBuilder å®ç°çš„è¿­ä»£</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token comment">//ä¸€ä¸ªæ˜ å°„è¡¨ï¼Œç¬¬äºŒä¸ªä½ç½®æ˜¯"abcâ€œ,ç¬¬ä¸‰ä¸ªä½ç½®æ˜¯"def"ã€‚ã€‚ã€‚</span><span class="token comment">//è¿™é‡Œä¹Ÿå¯ä»¥ç”¨mapï¼Œç”¨æ•°ç»„å¯ä»¥æ›´èŠ‚çœç‚¹å†…å­˜</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> letter_map <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">" "</span><span class="token punctuation">,</span><span class="token string">"*"</span><span class="token punctuation">,</span><span class="token string">"abc"</span><span class="token punctuation">,</span><span class="token string">"def"</span><span class="token punctuation">,</span><span class="token string">"ghi"</span><span class="token punctuation">,</span><span class="token string">"jkl"</span><span class="token punctuation">,</span><span class="token string">"mno"</span><span class="token punctuation">,</span><span class="token string">"pqrs"</span><span class="token punctuation">,</span><span class="token string">"tuv"</span><span class="token punctuation">,</span><span class="token string">"wxyz"</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> <span class="token function">letterCombinations</span><span class="token punctuation">(</span><span class="token class-name">String</span> digits<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//æ³¨æ„è¾¹ç•Œæ¡ä»¶</span><span class="token keyword">if</span><span class="token punctuation">(</span>digits<span class="token operator">==</span><span class="token keyword">null</span> <span class="token operator">||</span> digits<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">iterStr</span><span class="token punctuation">(</span>digits<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//æœ€ç»ˆè¾“å‡ºç»“æœçš„list</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//é€’å½’å‡½æ•°</span><span class="token keyword">void</span> <span class="token function">iterStr</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">,</span> <span class="token class-name">StringBuilder</span> letter<span class="token punctuation">,</span> <span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//é€’å½’çš„ç»ˆæ­¢æ¡ä»¶ï¼Œæ³¨æ„è¿™é‡Œçš„ç»ˆæ­¢æ¡ä»¶çœ‹ä¸Šå»è·ŸåŠ¨æ€æ¼”ç¤ºå›¾æœ‰äº›ä¸åŒï¼Œä¸»è¦æ˜¯åšäº†ç‚¹ä¼˜åŒ–</span><span class="token comment">//åŠ¨æ€å›¾ä¸­æ˜¯æ¯æ¬¡æˆªå–å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼Œ"234"ï¼Œå˜æˆ"23"ï¼Œå†å˜æˆ"3"ï¼Œæœ€åå˜æˆ""ï¼Œè¿™æ ·æ€§èƒ½ä¸ä½³</span><span class="token comment">//è€Œç”¨indexè®°å½•æ¯æ¬¡éå†åˆ°å­—ç¬¦ä¸²çš„ä½ç½®ï¼Œè¿™æ ·æ€§èƒ½æ›´å¥½</span><span class="token keyword">if</span><span class="token punctuation">(</span>index <span class="token operator">==</span> str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>letter<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//è·å–indexä½ç½®çš„å­—ç¬¦ï¼Œå‡è®¾è¾“å…¥çš„å­—ç¬¦æ˜¯"234"</span><span class="token comment">//ç¬¬ä¸€æ¬¡é€’å½’æ—¶indexä¸º0æ‰€ä»¥c=2ï¼Œç¬¬äºŒæ¬¡indexä¸º1æ‰€ä»¥c=3ï¼Œç¬¬ä¸‰æ¬¡c=4</span><span class="token comment">//subStringæ¯æ¬¡éƒ½ä¼šç”Ÿæˆæ–°çš„å­—ç¬¦ä¸²ï¼Œè€Œindexåˆ™æ˜¯å–å½“å‰çš„ä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥æ•ˆç‡æ›´é«˜ä¸€ç‚¹</span><span class="token keyword">char</span> c <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//map_stringçš„ä¸‹è¡¨æ˜¯ä»0å¼€å§‹ä¸€ç›´åˆ°9ï¼Œ c-'0'å°±å¯ä»¥å–åˆ°ç›¸å¯¹çš„æ•°ç»„ä¸‹æ ‡ä½ç½®</span><span class="token comment">//æ¯”å¦‚c=2æ—¶å€™ï¼Œ2-'0'ï¼Œè·å–ä¸‹æ ‡ä¸º2,letter_map[2]å°±æ˜¯"abc"</span><span class="token keyword">int</span> pos <span class="token operator">=</span> c <span class="token operator">-</span> <span class="token char">'0'</span><span class="token punctuation">;</span><span class="token class-name">String</span> map_string <span class="token operator">=</span> letter_map<span class="token punctuation">[</span>pos<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//éå†å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ç¬¬ä¸€æ¬¡å¾—åˆ°çš„æ˜¯2ï¼Œé¡µå°±æ˜¯éå†"abc"</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>map_string<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        letter<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>map_string<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//å¦‚æœæ˜¯Stringç±»å‹åšæ‹¼æ¥æ•ˆç‡ä¼šæ¯”è¾ƒä½</span><span class="token comment">//iterStr(str, letter+map_string.charAt(i), index+1);</span>            <span class="token function">iterStr</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> letter<span class="token punctuation">,</span> index<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//è¿™ä¸ªæ–¹æ³•ä¿è¯äº†æ¯ä¸€æ¬¡å¤§å¾ªç¯åå¾—åˆ°çš„stringbuilderéƒ½æ˜¯æ–°çš„</span>            <span class="token comment">//æ³¨æ„ï¼š è¿™é‡Œçš„åˆ é™¤æ–¹æ³•å¾ˆé‡è¦ï¼ï¼</span>            letter<span class="token punctuation">.</span><span class="token function">deleteCharAt</span><span class="token punctuation">(</span>letter<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201012205626708.png" alt="image-20201012205626708"></p><h3 id="æ€è€ƒ-v10">æ€è€ƒ</h3><p>StringBuilder ç¡®å®æ“ä½œæ¯” Stringç±»å‹å¿«å¾ˆå¤šå¾ˆå¤šï¼Œä¸”åœ¨ ç©ºé—´å ç”¨ä¸Šä¹Ÿè¿œè¿œä½äº String</p><p>è¿™è¿˜å¾—å½’ç»“äºString ç›¸åŠ æ—¶ æ€»ä¼šæ–°åˆ†é…ä¸€ä¸ªStringå¯¹è±¡è¿›è¡Œèµ‹å€¼</p><hr><h2 id="21-åˆå¹¶ä¸¤ä¸ªæœ‰åºåˆ—è¡¨-â­">21. åˆå¹¶ä¸¤ä¸ªæœ‰åºåˆ—è¡¨ â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><div class="code-tag-label code-tag-label-recursion">Recursion</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201016083409297.png" alt="image-20201016083409297"></p><h3 id="1-è¿­ä»£">1. è¿­ä»£</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token comment">/*é¢˜ç›®ç»™çš„æ˜¯ï¼š  æœ‰ åº çš„æ•°ç»„ï¼Œè¿™ç‚¹å¾ˆé‡è¦*/</span><span class="token keyword">public</span>  <span class="token class-name">ListNode</span> <span class="token function">mergeTwoLists</span><span class="token punctuation">(</span><span class="token class-name">ListNode</span> l1<span class="token punctuation">,</span> <span class="token class-name">ListNode</span> l2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">ListNode</span> nodehead <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ListNode</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ListNode</span> pre <span class="token operator">=</span> nodehead<span class="token punctuation">;</span><span class="token comment">// ç†è§£è¿™é‡Œpre=nodehead çš„æŒ‡å‘é—®é¢˜</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>l1 <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> l2 <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>l1<span class="token punctuation">.</span>val <span class="token operator">&lt;=</span> l2<span class="token punctuation">.</span>val<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    pre<span class="token punctuation">.</span>next <span class="token operator">=</span> l1<span class="token punctuation">;</span> <span class="token comment">// è¿™é‡Œçš„ä¸¤æ­¥éƒ½èƒ½æƒ³åˆ°</span>                    l1 <span class="token operator">=</span> l1<span class="token punctuation">.</span>next<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                    pre <span class="token punctuation">.</span>next<span class="token operator">=</span> l2<span class="token punctuation">;</span>                    l2 <span class="token operator">=</span> l2<span class="token punctuation">.</span>next<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token comment">// è¿™é‡Œæ³¨æ„ï¼ å…³é”®ç‚¹  æ˜¯æŒ‡é’ˆèŠ‚ç‚¹åç§»çš„æ­¥éª¤</span>                <span class="token comment">// é‚£preä¹‹å‰çš„æ•°å‘¢ï¼Ÿ ---ä¼ ç»™nodeheadäº† </span>                pre <span class="token operator">=</span> pre<span class="token punctuation">.</span>next<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">NullPointerException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">//æŠ“ä¸€ä¸‹æœ€åå‡ ä¸ªèŠ‚ç‚¹ï¼Œå¯èƒ½ä¸æ­¢ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä½†ä»–æ˜¯æœ‰åºçš„ï¼Œå°±æ— å¦¨äº†</span>        pre<span class="token punctuation">.</span>next<span class="token operator">=</span>l1<span class="token operator">==</span><span class="token keyword">null</span><span class="token operator">?</span>l2<span class="token operator">:</span>l1<span class="token punctuation">;</span>        <span class="token keyword">return</span> nodehead<span class="token punctuation">.</span>next<span class="token punctuation">;</span>       <span class="token comment">/**    *    æ—¶é—´å¤æ‚åº¦O(n+m) ç©ºé—´å¤æ‚åº¦O(1) ï¼ˆpre å’Œnodepreä½œä¸ºå˜é‡ï¼‰    */</span>    <span class="token punctuation">&#125;</span></code></pre></div><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201016083455230.png" alt="image-20201016083455230" style="zoom:150%;" /><h3 id="2-é€’å½’">2. é€’å½’</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span>  <span class="token class-name">ListNode</span> <span class="token function">mergeTwoLists</span><span class="token punctuation">(</span><span class="token class-name">ListNode</span> l1<span class="token punctuation">,</span> <span class="token class-name">ListNode</span> l2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>l1<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> l2<span class="token punctuation">;</span>        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>l2<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> l1<span class="token punctuation">;</span>    <span class="token comment">//åˆ°è¿™é‡Œéƒ½æ²¡é—®é¢˜</span>        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>l1<span class="token punctuation">.</span>val<span class="token operator">&lt;=</span>l2<span class="token punctuation">.</span>val<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">//æ­¤å¤„ æ€»çˆ± ç›´æ¥returnä¸€ä¸ª å‡½æ•°æ–¹æ³•ä½“ å…¶å®æ˜¯ä¸å¯¹çš„ ï¼Œå…·ä½“å¾—åˆ°çš„æ˜¯è°å‘¢ï¼Ÿ</span>    <span class="token comment">// ç”¨ node.nextèƒ½å¤Ÿå®ç°å¯¹å…ƒç´ çš„ä¿å­˜</span>            l1<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token function">mergeTwoLists</span><span class="token punctuation">(</span>l1<span class="token punctuation">.</span>next<span class="token punctuation">,</span> l2<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> l1<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        l2<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token function">mergeTwoLists</span><span class="token punctuation">(</span>l1<span class="token punctuation">,</span> l2<span class="token punctuation">.</span>next<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> l2<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**    *    æ—¶é—´å¤æ‚åº¦O(n+m) ç©ºé—´å¤æ‚åº¦O(m+n) ï¼ˆé€’å½’å‡½æ•°çš„è°ƒç”¨ï¼‰     æ‰€ä»¥ æ‰§è¡Œç»“æœå†…å­˜æ¶ˆè€—ç¨å¾®æ…¢äº è¿­ä»£    */</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201016084013216.png" alt="image-20201016084013216"></p><h3 id="åˆ†æï¼š">åˆ†æï¼š</h3><p>è‡ªå·±åšçš„æ—¶å€™ï¼Œå¼€å§‹æ˜¯éƒ½æƒ³åˆ°äº†è¿™ä¸¤ç§ç®—æ³•ï¼Œä¸è¿‡åæ¥æ€»è§‰å¾—å“ªé‡Œè¡Œä¸é€šï¼Œå°±æ”¾å¼ƒäº†é€’å½’ï¼Œé‡‡ç”¨è¿­ä»£ã€‚åˆ†æé—®é¢˜çš„åŸå› ï¼š</p><ol><li>é—®é¢˜ç”¨é‚£ç§æ–¹æ³•è§£å†³ï¼Ÿ<ol><li>ä»å¤´éƒ¨è§£å†³ï¼š     --------<strong>è¿­ä»£</strong><ul><li>ç”¨å¤´å…ƒç´ è®°å½• ï¼Œæ ‡å…µå…ƒç´ å»ç§»åŠ¨</li></ul></li><li>ä»å°¾éƒ¨è§£å†³ï¼š     --------<strong>é€’å½’</strong><ul><li>ä¸ºäº†å¾—åˆ°ä¿å­˜ç»“æœ ç”¨nextæŒ‡é’ˆç»§ç»­ä¸‹ä¸€æ¬¡åˆ¤æ–­</li></ul></li></ol></li><li>ä¸¤è€…çš„å…³é”®ç‚¹ éƒ½æ˜¯ å·§å¦™çš„ä½¿ç”¨  nextæŒ‡é’ˆ</li></ol><hr><h2 id="26-åˆ é™¤æ’åºæ•°ç»„ä¸­çš„é‡å¤é¡¹-â­">26. åˆ é™¤æ’åºæ•°ç»„ä¸­çš„é‡å¤é¡¹ â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201018171723036.png" alt="image-20201018171723036"></p><h3 id="1-æš´åŠ›ä¸‰å¾ªç¯-è§£éæ’åºæ•°ç»„">1. æš´åŠ›ä¸‰å¾ªç¯ --è§£éæ’åºæ•°ç»„</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token comment">/** * åˆ é™¤æ•°ç»„ä¸­é‡å¤å…ƒç´ çš„ * åˆ†æï¼š é€ æˆ æ—¶é—´å¤æ‚åº¦é«˜çš„æ­¥éª¤ï¼š åˆ¤æ–­ ä¹‹åçš„å…ƒç´ æ˜¯å¦ç›¸ç­‰å’Œ ç§»åŠ¨æ•°ç»„ */</span><span class="token comment">// for     ä¸‰å±‚å¾ªç¯æ¥åš  ç®—æ³•ä¸ç¨³å®š  O(N3)/Ok(1)</span><span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">deleteSameNode</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> total<span class="token operator">=</span>nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span>    <span class="token comment">// è®¾ç½®total ç”¨äº å¾ªç¯ä½“ä¸­ é¿å…é‡å¤åˆ¤æ–­</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>total<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>total<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                total<span class="token operator">-=</span><span class="token number">1</span><span class="token punctuation">;</span>                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token operator">=</span>j<span class="token punctuation">;</span>k<span class="token operator">&lt;</span>total<span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                        nums<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">=</span>nums<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                j<span class="token operator">--</span><span class="token punctuation">;</span>       <span class="token comment">//æ³¨æ„è¿™é‡Œçš„ j--</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> total<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>æ³¨æ„ç‚¹ï¼š</p><ul><li>j-- ï¼šé¿å…å¤šä¸ªé‡å¤çš„æ•°åœ¨ä¸€èµ·è€Œè¢«æ¼æ‰</li><li>totalä½œä¸ºå¾ªç¯åˆ¤æ–­çš„ä¾æ®ï¼š    é¿å…å¤šä¸ªé‡å¤çš„æ•°åœ¨ä¸€èµ·è€Œè¢«æ¼æ‰ æˆ–è€… é‡å¤åˆ¤æ–­äº†ç§»åŠ¨åˆ°æœ«å°¾çš„æ•°å­—</li></ul><h3 id="2-åŒæŒ‡é’ˆå•å¾ªç¯-â€”-è§£æ’åºæ•°ç»„">2. åŒæŒ‡é’ˆå•å¾ªç¯ â€” è§£æ’åºæ•°ç»„</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">deleteSameNode_2</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">!=</span>nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               i<span class="token operator">++</span><span class="token punctuation">;</span>               nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201018231302964.png" alt="image-20201018231302964"></p><h3 id="åæ€-v2">åæ€</h3><p>è¿™é‡Œæˆ‘æ€è€ƒçš„æ—¶å€™ ï¼Œæ²¡æœ‰çœ‹é¢˜ç›®è¦æ±‚ï¼Œ ç›´æ¥æŒ‰ç…§ä¸€èˆ¬çš„æ•°ç»„æ¥è§£å†³äº†ï¼Œå…¶å® é¢˜ç›®ç»™çš„ æœ‰åºæ•°ç»„ ï¼ŒåŒå¾ªç¯å†æƒ³åˆ°å•å¾ªç¯åŒæŒ‡é’ˆ ï¼Œæ˜¯éå¸¸å¥½è§£å†³çš„ã€‚æ­¤å¤„ä¹Ÿæä¾›äº†ä¸€ç§æ€è·¯ï¼Œ å…ˆå°† æ•°ç»„ æœ‰åºåŒ– ï¼Œå†é€šè¿‡è¿™ç§æ–¹å¼ è¿›è¡ŒO(n) çš„è¿ç®—</p><h2 id="28-å®ç°strStr-â­â­">28. å®ç°strStr() â­â­</h2><blockquote><p>Time : 2022 / 3 / 26 10 : 23<br>TAG : KMPã€è¿­ä»£</p></blockquote><div class="code-tag-time">2022/3/26 10:23:00</div><div class="code-tag-label code-tag-label-math">KMP</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220326095118494.png" alt="image-20220326095118494"></p><h3 id="å®¡é¢˜-v3">å®¡é¢˜</h3><ul><li>è¿”å›åŒ¹é…çš„å­å­—ç¬¦ä¸²åœ¨æ¯å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</li><li>æ¯ä¸²é•¿åº¦ä¸ºn å­—ç¬¦ä¸²é•¿åº¦ä¸ºm</li></ul><h3 id="1-æš´åŠ›è¿­ä»£">1. æš´åŠ›è¿­ä»£</h3><p>åœ¨æ¯ä¸²ä¸­ä¾æ¬¡æŸ¥æ‰¾ï¼Œæ—¶é—´å¤æ‚åº¦O(nm)</p><h3 id="2-KMP">2. KMP</h3><p>å…³äºKMPï¼Œåœ¨å­—ç¬¦ä¸²åŒ¹é…ä¸­çš„åº”ç”¨æ˜¯ååˆ†é‡è¦çš„ï¼Œå› ä¸ºå®ƒæŠŠO(mn)çš„æ—¶é—´å¤æ‚åº¦é™ä½è‡³O(m + n)</p><p><strong>Knuth-Morris-Pratt</strong> ç®—æ³•ï¼Œç®€ç§° KMP ç®—æ³•ï¼Œç”± Donald Knuthã€James H. Morris å’Œ Vaughan Pratt ä¸‰äººäº 1977 å¹´è”åˆå‘è¡¨</p><p>KMPçš„æ ¸å¿ƒæ­¥éª¤ï¼š</p><ol><li>æ ¹æ®ç›®æ ‡å­ä¸²ç”Ÿæˆnextæ•°ç»„(é‡ç‚¹)</li><li>åœ¨æ¯ä¸²ä¸­ä¾æ®ç›®æ ‡å­ä¸²å’Œnextæ•°ç»„è¿›è¡ŒæŸ¥æ‰¾</li></ol><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">strStr</span><span class="token punctuation">(</span><span class="token class-name">String</span> haystack<span class="token punctuation">,</span> <span class="token class-name">String</span> needle<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>needle<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>haystack<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> next <span class="token operator">=</span> <span class="token function">kmp_gen_next</span><span class="token punctuation">(</span>needle<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token function">is_son_str</span><span class="token punctuation">(</span>haystack<span class="token punctuation">,</span> needle<span class="token punctuation">,</span> next<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">is_son_str</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">,</span> <span class="token class-name">String</span> son<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> next<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>i <span class="token operator">&lt;=</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> j <span class="token operator">&lt;=</span> son<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>j <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> son<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                i<span class="token operator">++</span><span class="token punctuation">;</span>                j<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                j <span class="token operator">=</span> next<span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>j <span class="token operator">></span> son<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> i <span class="token operator">-</span> j<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>     <span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">kmp_gen_next</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> next <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        next<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>i <span class="token operator">&lt;</span> next<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>j <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                i<span class="token operator">++</span><span class="token punctuation">;</span>                j<span class="token operator">++</span><span class="token punctuation">;</span>                next<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> j<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                j <span class="token operator">=</span> next<span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> next<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220326100442552.png" alt="image-20220326100442552"></p><h4 id="ä¼˜åŒ–">ä¼˜åŒ–</h4><p>é’ˆå¯¹nextæ•°ç»„ä¼˜åŒ–ï¼Œå› ä¸ºå¦‚æœfather_str[i] != son_str[j] ä¸” son_str[j] == son_str[next[j]]æ—¶ï¼Œå°±ä¼šå‡ºç°ä¸å¿…è¦çš„é‡å¤åˆ¤æ–­ï¼Œå› ä¸ºä¹‹å‰åˆ¤æ–­ä¸¤è€…ä¸ç›¸ç­‰ï¼Œè€Œè½¬åŒ–jåå†å»åˆ¤æ–­ï¼Œï¼ˆä½†son_str[j] == son_str[next[j]]ï¼‰æ‰€ä»¥ä¸¤è€…è‚¯å®šè¿˜æ˜¯ä¸ç›¸ç­‰ï¼Œå°±ä¼˜åŒ–äº†nextæ•°ç»„</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">kmp_gen_next_modified</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> next <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>       <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       next<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token keyword">while</span><span class="token punctuation">(</span>i <span class="token operator">&lt;</span> next<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>j <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               i<span class="token operator">++</span><span class="token punctuation">;</span>               j<span class="token operator">++</span><span class="token punctuation">;</span>               <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">!=</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                   next<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> j<span class="token punctuation">;</span>               <span class="token keyword">else</span>                   next<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> next<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>               j <span class="token operator">=</span> next<span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> next<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p>ä¸æ˜æ˜¾ï¼Œå¯èƒ½æ˜¯ç”Ÿæˆnextæ—¶å¤šäº†ä¸€äº›åˆ¤æ–­ï¼Ÿ</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220326100339847.png" alt="image-20220326100339847"></p><h4 id="äºŒåˆ·-Cè¯­è¨€ç‰ˆæœ¬">äºŒåˆ·-Cè¯­è¨€ç‰ˆæœ¬</h4><p>è‡ªå·±è§‰å¾—KMPéš¾ç†è§£çš„ç‚¹ï¼ˆé…åˆå›¾æ¥ç†è§£ï¼‰ï¼š</p><ol><li>å…ˆç†è§£å‰ç¼€å’Œåç¼€ï¼ŒKMPæ˜¯é€šè¿‡å­ä¸²çš„å‰åç¼€æ¥è¿›è¡Œçº¿æ€§åˆ¤æ–­çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœå­ä¸²æœ‰ç›¸åŒçš„æœ€é•¿å‰ã€åç¼€ï¼Œåˆ™å°±å¯ä»¥è¿›è¡Œç§»ä½æ¯”è¾ƒ</li><li>æ¥ä¸‹æ¥ï¼Œå¦‚ä½•è®¡ç®—è¿™ä¸ªæœ€é•¿çš„å‰åç¼€ï¼Ÿé—®é¢˜çš„å…³é”®ä¹Ÿå°±å˜æˆäº†è®¡ç®—nextæ•°ç»„äº†ï¼Œé‚£nextæ•°ç»„æ˜¯ä»€ä¹ˆï¼Ÿnextæ•°ç»„æ˜¯æŒ‡ç¤ºæˆªæ­¢å½“å‰å…ƒç´ ä¸ºæ­¢ï¼Œå½“å‰é•¿åº¦çš„æ•°ç»„æœ€é•¿å‰åç¼€çš„é•¿åº¦æ˜¯å¤šå°‘ï¼Ÿä¾‹å¦‚abcabcdï¼Œdå¤„çš„æ•°å€¼ä¾¿æ˜¯3ï¼ˆå› ä¸ºæœ‰æœ€é•¿å‰åç¼€abcï¼‰ã€‚è®¡ç®—nextæ•°ç»„æ—¶çš„ä¸€ä¸ªéš¾ç‚¹ï¼Œä¹Ÿæ˜¯æˆ‘è®¤ä¸ºæ¯”è¾ƒéš¾ä»¥ç†è§£çš„ä¸€ä¸ªåœ°æ–¹ï¼šåœ¨æ¯”è¾ƒè®¡ç®—ç¬¬kä¸ªç´¢å¼•å…ƒç´ çš„å€¼æ—¶ã€‚å…ˆçœ‹å‰ä¸€ä¸ªå…ƒç´ çš„å€¼ï¼Œä¹Ÿå°±æ˜¯çœ‹åˆ°å‰ä¸€ä¸ªæ•°ä¸ºæ­¢å½“å‰æ•°ç»„çš„æœ€å¤§å‰åç¼€ï¼Œè‹¥å€¼ä¸ºmã€‚<ol><li>åˆ™æ¯”è¾ƒç¬¬m+1ä¸ªå…ƒç´ ä¸å½“å‰å…ƒç´ æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœç›¸ç­‰ï¼Œå°±è¯´æ˜åˆ°å½“å‰å…ƒç´ ä¸ºæ­¢ï¼Œæ•°ç»„èƒ½æ„æˆä¸€ä¸ªæ›´é•¿çš„å‰åç¼€ï¼ˆè¿™é‡Œå¯ä»¥ç”»å›¾ç†è§£ï¼‰ï¼Œæ‰€ä»¥å½“å‰å…ƒç´ çš„å€¼=å‰ä¸€ä¸ªå…ƒç´ å€¼+1</li><li>å¦‚æœä¸æƒ³ç­‰çš„è¯ï¼Œåˆ™è¦å»æ‰¾æ¬¡é•¿çš„å‰åç¼€ï¼Œç„¶å<strong>æ¯”è¾ƒæ¬¡é•¿çš„å‰ç¼€ å’Œ åŠ äº†æ–°å…ƒç´ çš„åç¼€</strong>æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœæ‰¾åˆ°äº†å°±ç­‰äºæ¬¡é•¿å‰ç¼€é•¿åº¦ + 1ï¼Œå¦‚æœæ²¡æ‰¾åˆ°ï¼Œå°±é‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°æ²¡æœ‰æœ€é•¿å‰åç¼€ï¼Œæ­¤æ—¶å½“å‰å…ƒç´ çš„å€¼ä¸º0ï¼ˆä¹Ÿå°±æ˜¯æ²¡æœ‰æœ€é•¿å‰åç¼€ï¼‰ã€‚</li></ol></li></ol><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token operator">*</span> <span class="token function">genNext</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span> needle<span class="token punctuation">,</span> <span class="token keyword">int</span> length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> <span class="token operator">*</span>next <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">calloc</span><span class="token punctuation">(</span>length<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> cur_hop <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>i <span class="token operator">&lt;</span> length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>needle<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> needle<span class="token punctuation">[</span>cur_hop<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            cur_hop<span class="token operator">++</span><span class="token punctuation">;</span>            next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> cur_hop<span class="token punctuation">;</span>            i<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>cur_hop <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                next<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>                i<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span><span class="token punctuation">&#123;</span>                cur_hop <span class="token operator">=</span> next<span class="token punctuation">[</span>cur_hop <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> next<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">strStr</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span> haystack<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span> needle<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>needle<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> out_length <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>haystack<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> <span class="token operator">*</span>next <span class="token operator">=</span> <span class="token function">genNext</span><span class="token punctuation">(</span>needle<span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>i <span class="token operator">&lt;</span> out_length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>haystack<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> needle<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            j<span class="token operator">++</span><span class="token punctuation">;</span>            i<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>j <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            j <span class="token operator">=</span> next<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            i<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>j <span class="token operator">>=</span> length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> i <span class="token operator">-</span> j<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20221103213544861.png" alt="image-20221103213544861"></p><h2 id="29-ä¸¤æ•°ç›¸é™¤-â­â­">29. ä¸¤æ•°ç›¸é™¤ â­â­</h2><blockquote><p>Time: 2021 10 12 4:06pm</p></blockquote><div class="code-tag-time">2021/10/12 16:06:00</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><div class="code-tag-label code-tag-label-binary">Bin</div><div class="code-tag-label code-tag-label-iteration">Iteration</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211012150254273.png" alt="image-20211012150254273"></p><h3 id="å®¡é¢˜-v4">å®¡é¢˜</h3><ul><li>ä¸å¾—ä½¿ç”¨* / modï¼Œä¹Ÿå°±æ˜¯è¯´+ -  ä½è¿ç®—éƒ½å¯ä»¥ç”¨ã€</li><li>è¿”å›[å•†]</li><li>é™¤æ•°ä¸ä¸º0</li><li>å¯ä»¥ä¸ºè´Ÿæ•°</li><li>æ’é™¤é€’å½’ã€dpâ€¦</li></ul><h3 id="1-æš´åŠ›-v2">1. æš´åŠ›</h3><h3 id="-v6"></h3><h3 id="2-äºŒåˆ†æŸ¥æ‰¾-è½¬">2. äºŒåˆ†æŸ¥æ‰¾(è½¬)</h3><ol><li>å…ˆæŠŠç‰¹æ®Šæƒ…å†µç½—åˆ—</li><li>å› ä¸ºæº¢å‡ºçš„å¯èƒ½ï¼Œæ‰€ä»¥éƒ½å–æˆè´Ÿæ•°</li><li>åœ¨åˆ¤æ–­æº¢å‡ºæ—¶ç”¨è´Ÿæ•°å’Œç§»åŠ¨ä¸ç­‰å¼ä¸¤è¾¹å»è¿›è¡Œå·§å¦™åˆ¤æ–­</li></ol><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">divide</span><span class="token punctuation">(</span><span class="token keyword">int</span> dividend<span class="token punctuation">,</span> <span class="token keyword">int</span> divisor<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// è€ƒè™‘è¢«é™¤æ•°ä¸ºæœ€å°å€¼çš„æƒ…å†µ</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>dividend <span class="token operator">==</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MIN_VALUE<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>divisor <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MIN_VALUE<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>divisor <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// è€ƒè™‘é™¤æ•°ä¸ºæœ€å°å€¼çš„æƒ…å†µ</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>divisor <span class="token operator">==</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MIN_VALUE<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> dividend <span class="token operator">==</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MIN_VALUE <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// è€ƒè™‘è¢«é™¤æ•°ä¸º 0 çš„æƒ…å†µ</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>dividend <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>                <span class="token comment">// ä¸€èˆ¬æƒ…å†µï¼Œä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾</span>        <span class="token comment">// å°†æ‰€æœ‰çš„æ­£æ•°å–ç›¸åæ•°ï¼Œè¿™æ ·å°±åªéœ€è¦è€ƒè™‘ä¸€ç§æƒ…å†µ</span>        <span class="token keyword">boolean</span> rev <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>dividend <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            dividend <span class="token operator">=</span> <span class="token operator">-</span>dividend<span class="token punctuation">;</span>            rev <span class="token operator">=</span> <span class="token operator">!</span>rev<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>divisor <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            divisor <span class="token operator">=</span> <span class="token operator">-</span>divisor<span class="token punctuation">;</span>            rev <span class="token operator">=</span> <span class="token operator">!</span>rev<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>                <span class="token keyword">int</span> left <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> right <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">,</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>left <span class="token operator">&lt;=</span> right<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// æ³¨æ„æº¢å‡ºï¼Œå¹¶ä¸”ä¸èƒ½ä½¿ç”¨é™¤æ³•</span>            <span class="token keyword">int</span> mid <span class="token operator">=</span> left <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>right <span class="token operator">-</span> left<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">boolean</span> check <span class="token operator">=</span> <span class="token function">quickAdd</span><span class="token punctuation">(</span>divisor<span class="token punctuation">,</span> mid<span class="token punctuation">,</span> dividend<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>check<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                ans <span class="token operator">=</span> mid<span class="token punctuation">;</span>                <span class="token comment">// æ³¨æ„æº¢å‡º</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>mid <span class="token operator">==</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                left <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                right <span class="token operator">=</span> mid <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> rev <span class="token operator">?</span> <span class="token operator">-</span>ans <span class="token operator">:</span> ans<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// å¿«é€Ÿä¹˜</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">quickAdd</span><span class="token punctuation">(</span><span class="token keyword">int</span> y<span class="token punctuation">,</span> <span class="token keyword">int</span> z<span class="token punctuation">,</span> <span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// x å’Œ y æ˜¯è´Ÿæ•°ï¼Œz æ˜¯æ­£æ•°</span>        <span class="token comment">// éœ€è¦åˆ¤æ–­ z * y >= x æ˜¯å¦æˆç«‹</span>        <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> add <span class="token operator">=</span> y<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>z <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>z <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">// éœ€è¦ä¿è¯ result + add >= x</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">&lt;</span> x <span class="token operator">-</span> add<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                result <span class="token operator">+=</span> add<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>z <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">// éœ€è¦ä¿è¯ add + add >= x</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>add <span class="token operator">&lt;</span> x <span class="token operator">-</span> add<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                add <span class="token operator">+=</span> add<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token comment">// ä¸èƒ½ä½¿ç”¨é™¤æ³•</span>            z <span class="token operator">>>=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211012155401725.png" alt="image-20211012155401725"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20211012155418405.png" alt="image-20211012155418405"></p><h3 id="3-ç±»äºŒåˆ†æŸ¥æ‰¾-è½¬">3. ç±»äºŒåˆ†æŸ¥æ‰¾(è½¬)</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">divide</span><span class="token punctuation">(</span><span class="token keyword">int</span> dividend<span class="token punctuation">,</span> <span class="token keyword">int</span> divisor<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// è€ƒè™‘è¢«é™¤æ•°ä¸ºæœ€å°å€¼çš„æƒ…å†µ</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>dividend <span class="token operator">==</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MIN_VALUE<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>divisor <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MIN_VALUE<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>divisor <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// è€ƒè™‘é™¤æ•°ä¸ºæœ€å°å€¼çš„æƒ…å†µ</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>divisor <span class="token operator">==</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MIN_VALUE<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> dividend <span class="token operator">==</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MIN_VALUE <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// è€ƒè™‘è¢«é™¤æ•°ä¸º 0 çš„æƒ…å†µ</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>dividend <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>                <span class="token comment">// ä¸€èˆ¬æƒ…å†µï¼Œä½¿ç”¨ç±»äºŒåˆ†æŸ¥æ‰¾</span>        <span class="token comment">// å°†æ‰€æœ‰çš„æ­£æ•°å–ç›¸åæ•°ï¼Œè¿™æ ·å°±åªéœ€è¦è€ƒè™‘ä¸€ç§æƒ…å†µ</span>        <span class="token keyword">boolean</span> rev <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>dividend <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            dividend <span class="token operator">=</span> <span class="token operator">-</span>dividend<span class="token punctuation">;</span>            rev <span class="token operator">=</span> <span class="token operator">!</span>rev<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>divisor <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            divisor <span class="token operator">=</span> <span class="token operator">-</span>divisor<span class="token punctuation">;</span>            rev <span class="token operator">=</span> <span class="token operator">!</span>rev<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> candidates <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        candidates<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>divisor<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token comment">// æ³¨æ„æº¢å‡º</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>candidates<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token operator">>=</span> dividend <span class="token operator">-</span> candidates<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            candidates<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>candidates<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token operator">+</span> candidates<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token operator">++</span>index<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token comment">// æ²¡çœ‹æ‡‚</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> candidates<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>candidates<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">>=</span> dividend<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                ans <span class="token operator">+=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">;</span>                dividend <span class="token operator">-=</span> candidates<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> rev <span class="token operator">?</span> <span class="token operator">-</span>ans <span class="token operator">:</span> ans<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><h3 id="4-é€’å½’-è½¬">4. é€’å½’(è½¬)</h3><p>æ„Ÿè§‰è¿™ä¸ªæ¯”ä¸Šé¢çš„å¥½æ‡‚ä¸€ç‚¹</p><p>ä¸¾ä¸ªä¾‹å­ï¼š11 é™¤ä»¥ 3 ã€‚<br>é¦–å…ˆ11æ¯”3å¤§ï¼Œç»“æœè‡³å°‘æ˜¯1ï¼Œ ç„¶åæˆ‘è®©3ç¿»å€ï¼Œå°±æ˜¯6ï¼Œå‘ç°11æ¯”3ç¿»å€åè¿˜è¦å¤§ï¼Œé‚£ä¹ˆç»“æœå°±è‡³å°‘æ˜¯2äº†ï¼Œé‚£æˆ‘è®©è¿™ä¸ª6å†ç¿»å€ï¼Œå¾—12ï¼Œ11ä¸æ¯”12å¤§ï¼Œå“æ­»æˆ‘äº†ï¼Œå·®ç‚¹è®©å°±è®©åˆšæ‰çš„æœ€å°è§£2ä¹Ÿç¿»å€å¾—åˆ°4äº†ã€‚ä½†æ˜¯æˆ‘çŸ¥é“æœ€ç»ˆç»“æœè‚¯å®šåœ¨2å’Œ4ä¹‹é—´ã€‚ä¹Ÿå°±æ˜¯è¯´2å†åŠ ä¸ŠæŸä¸ªæ•°ï¼Œè¿™ä¸ªæ•°æ˜¯å¤šå°‘å‘¢ï¼Ÿæˆ‘è®©11å‡å»åˆšæ‰æœ€åä¸€æ¬¡çš„ç»“æœ6ï¼Œå‰©ä¸‹5ï¼Œæˆ‘ä»¬è®¡ç®—5æ˜¯3çš„å‡ å€ï¼Œä¹Ÿå°±æ˜¯é™¤æ³•ï¼Œçœ‹ï¼Œé€’å½’å‡ºç°äº†ã€‚è¯´å¾—å¾ˆä¹±ï¼Œä¸ä¸¥è°¨ï¼Œå¤§å®¶çœ‹ä¸ªå¤§æ¦‚ï¼Œç„¶åè‡ªå·±åœ¨çº¸ä¸Šç”»ä¸€ç”»ï¼Œæˆ–è€…ç›´æ¥çœ‹æˆ‘ä»£ç å°±å¥½å•¦ï¼</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">int</span> <span class="token function">divide</span><span class="token punctuation">(</span><span class="token keyword">int</span> dividend<span class="token punctuation">,</span> <span class="token keyword">int</span> divisor<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>dividend <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>divisor <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> dividend<span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>divisor <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>dividend<span class="token operator">></span>INT_MIN<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span>dividend<span class="token punctuation">;</span><span class="token comment">// åªè¦ä¸æ˜¯æœ€å°çš„é‚£ä¸ªæ•´æ•°ï¼Œéƒ½æ˜¯ç›´æ¥è¿”å›ç›¸åæ•°å°±å¥½å•¦</span>            <span class="token keyword">return</span> INT_MAX<span class="token punctuation">;</span><span class="token comment">// æ˜¯æœ€å°çš„é‚£ä¸ªï¼Œé‚£å°±è¿”å›æœ€å¤§çš„æ•´æ•°å•¦</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">long</span> a <span class="token operator">=</span> dividend<span class="token punctuation">;</span>        <span class="token keyword">long</span> b <span class="token operator">=</span> divisor<span class="token punctuation">;</span>        <span class="token keyword">int</span> sign <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token operator">></span><span class="token number">0</span><span class="token operator">&amp;&amp;</span>b<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>a<span class="token operator">&lt;</span><span class="token number">0</span><span class="token operator">&amp;&amp;</span>b<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            sign <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        a <span class="token operator">=</span> a<span class="token operator">></span><span class="token number">0</span><span class="token operator">?</span>a<span class="token operator">:</span><span class="token operator">-</span>a<span class="token punctuation">;</span>        b <span class="token operator">=</span> b<span class="token operator">></span><span class="token number">0</span><span class="token operator">?</span>b<span class="token operator">:</span><span class="token operator">-</span>b<span class="token punctuation">;</span>        <span class="token keyword">long</span> res <span class="token operator">=</span> <span class="token function">div</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>sign<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">return</span> res<span class="token operator">></span>INT_MAX<span class="token operator">?</span>INT_MAX<span class="token operator">:</span>res<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token operator">-</span>res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">int</span> <span class="token function">div</span><span class="token punctuation">(</span><span class="token keyword">long</span> a<span class="token punctuation">,</span> <span class="token keyword">long</span> b<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token comment">// ä¼¼ä¹ç²¾é«“å’Œéš¾ç‚¹å°±åœ¨äºä¸‹é¢è¿™å‡ å¥</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token operator">&lt;</span>b<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">long</span> count <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">long</span> tb <span class="token operator">=</span> b<span class="token punctuation">;</span> <span class="token comment">// åœ¨åé¢çš„ä»£ç ä¸­ä¸æ›´æ–°b</span>        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>tb<span class="token operator">+</span>tb<span class="token punctuation">)</span><span class="token operator">&lt;=</span>a<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            count <span class="token operator">=</span> count <span class="token operator">+</span> count<span class="token punctuation">;</span> <span class="token comment">// æœ€å°è§£ç¿»å€</span>            tb <span class="token operator">=</span> tb<span class="token operator">+</span>tb<span class="token punctuation">;</span> <span class="token comment">// å½“å‰æµ‹è¯•çš„å€¼ä¹Ÿç¿»å€</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> count <span class="token operator">+</span> <span class="token function">div</span><span class="token punctuation">(</span>a<span class="token operator">-</span>tb<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></code></pre></div><h2 id="34-åœ¨æ’åºæ•°ç»„ä¸­æŸ¥æ‰¾å…ƒç´ çš„ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªä½ç½®-â­â­">34. åœ¨æ’åºæ•°ç»„ä¸­æŸ¥æ‰¾å…ƒç´ çš„ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªä½ç½® â­â­</h2><div class="code-tag-time">2022/4/6 14:50:00</div><div class="code-tag-label code-tag-label-binary">BinaryS</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220406102748986.png" alt="image-20220406102748986"></p><h3 id="å®¡é¢˜-v5">å®¡é¢˜</h3><ul><li>å‡åºæ’åˆ—çš„æ•°ç»„ï¼Œæœ‰é‡å¤æ•°å­—ï¼Œæ•°å­—å¯ä¸ºè´Ÿæ•°</li><li>æ‰¾çš„æ•°ä¸å­˜åœ¨ï¼Œè¿”å›[-1,-1]</li><li>æ€è·¯ï¼š<ul><li>ç›´æ¥ï¼š<ul><li>è¿­ä»£</li></ul></li><li>è¿›é˜¶ï¼š<ul><li>äºŒåˆ†æŸ¥æ‰¾ï¼šé—®é¢˜ï¼Œå¦‚ä½•æ‰¾åˆ°èµ·å§‹çš„ç‚¹ï¼Ÿ</li></ul></li></ul></li></ul><h3 id="1-é¡ºåºéå†">1. é¡ºåºéå†</h3><p>æ—¶é—´å¤æ‚åº¦O(n)ï¼Œæ²¡æœ‰å……åˆ†åˆ©ç”¨åˆ°å‡åºæ•°ç»„è¿™ä¸ªæ¡ä»¶</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">searchRange</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> target<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> start <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> end <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>target <span class="token operator">&lt;</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>target <span class="token operator">==</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> start <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                start <span class="token operator">=</span> i<span class="token punctuation">;</span>                end <span class="token operator">=</span> i<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>target <span class="token operator">==</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                end<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> start<span class="token punctuation">;</span>        res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> end<span class="token punctuation">;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220406103252339.png" alt="image-20220406103252339"></p><h3 id="2-äºŒåˆ†æŸ¥æ‰¾-v2">2. äºŒåˆ†æŸ¥æ‰¾</h3><p>ä¸ä»…å¯¹æ•´ä½“äºŒåˆ†æŸ¥æ‰¾ï¼Œè¿˜äºŒåˆ†æŸ¥æ‰¾ä¸­ç‚¹targetçš„å·¦å³ç«¯ç‚¹ã€‚</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">searchRange</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> target<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> f1 <span class="token operator">=</span> <span class="token function">binarySearch</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>nums<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>f1 <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> left <span class="token operator">=</span> f1<span class="token punctuation">;</span>            <span class="token keyword">int</span> right <span class="token operator">=</span> f1<span class="token punctuation">;</span>            <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">// ä¸´æ—¶ä¿å­˜binarSearchç»“æœï¼Œé¿å…é‡å¤è¿ç®—</span>                <span class="token keyword">int</span> l_temp<span class="token punctuation">;</span>                <span class="token keyword">int</span> r_temp<span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>left <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> right <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>left <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    l_temp <span class="token operator">=</span> <span class="token function">binarySearch</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>left <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span><span class="token punctuation">(</span>l_temp <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> left<span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                    left <span class="token operator">=</span> l_temp<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>right <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    r_temp <span class="token operator">=</span> <span class="token function">binarySearch</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span>right <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>nums<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span><span class="token punctuation">(</span>r_temp <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> right<span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                    right <span class="token operator">=</span> r_temp<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token comment">// äºŒåˆ†æŸ¥æ‰¾</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">binarySearch</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">,</span><span class="token keyword">int</span> t<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>l <span class="token operator">&lt;</span> r<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> r<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">// é å·¦è¾¹</span>            <span class="token comment">// æ³¨æ„è¿™é‡Œ+1 å’Œ -1ï¼Œå¿…è¦çš„</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>m<span class="token punctuation">]</span> <span class="token operator">&lt;</span> t<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                l <span class="token operator">=</span> m<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>m<span class="token punctuation">]</span> <span class="token operator">></span> t<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                r <span class="token operator">=</span> m<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> m<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// å¦‚æœl==rè¿˜è¦åˆ¤æ–­ä¸­é—´å€¼</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>l <span class="token operator">==</span> r<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">==</span> t<span class="token punctuation">)</span>                <span class="token keyword">return</span> r<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220406113758421.png" alt="image-20220406113758421"></p><p>**è¡¥å……ï¼š**å®˜æ–¹é¢˜è§£çš„æ–¹æ³•æ˜¯è®¾ç½®boolå€¼æ¥è¡¨æ˜æ˜¯æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå¤§äºtargetå’Œç¬¬ä¸€ä¸ªå¤§äºç­‰äºtargetçš„å€¼</p><h3 id="åæ€-v3">åæ€</h3><ul><li>äºŒåˆ†æ³•æƒ³èµ·å®¹æ˜“ï¼Œå†™èµ·æ¥è¿˜æ˜¯ååˆ†è´¹åŠ²ï¼Œè‡ªå·±å†™æœ‰å¾ˆå¤šçš„bug</li></ul><h2 id="36-æœ‰æ•ˆçš„æ•°ç‹¬-â­â­">36. æœ‰æ•ˆçš„æ•°ç‹¬ â­â­</h2><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210917143810318.png" alt="image-20210917143810318"></p><h3 id="å®¡é¢˜-v6">å®¡é¢˜</h3><ul><li>åˆ†åŒºåŸŸ ï¼Œæ¯è¡Œæ¯åˆ—æ¯ä¹å®«æ ¼</li></ul><p>â€¦å·²ç»ä¸çŸ¥é“è‡ªå·±æœ‰å¤šè ¢äº†ï¼Œé¢˜çš„æ„æ€æ˜¯æ±‚å‡ºé¢˜ä¸­æ‰€ç»™ç¼ºé™·æ•°ç‹¬æ˜¯å¦ç¬¦åˆè§„èŒƒï¼ï¼è€Œä¸æ˜¯æ±‚æ˜¯å¦èƒ½ç”Ÿæˆä¸€ä¸ªæ•°ç‹¬ã€‚ã€‚ã€‚æè¿™åšäº†åŠå¤©ä¸€ç›´ä¸å¯¹ã€‚ã€‚ã€‚</p><p><strong>çœ‹é¢˜ï¼ï¼ï¼çœ‹é¢˜ï¼ï¼ï¼çœ‹é¢˜ï¼ï¼ï¼</strong></p><p>æœ€åæ‘˜ä¸€é“é¢˜è§£ï¼Œæ—¥åå†åšä¸€ä¸‹</p><h3 id="1-é¡ºåºæ£€éªŒï¼ˆè½¬ï¼‰">1. é¡ºåºæ£€éªŒï¼ˆè½¬ï¼‰</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java">bool <span class="token function">isValidSudoku</span><span class="token punctuation">(</span>vector<span class="token generics"><span class="token punctuation">&lt;</span>vector<span class="token punctuation">&lt;</span><span class="token keyword">char</span><span class="token punctuation">></span><span class="token punctuation">></span></span><span class="token operator">&amp;</span> board<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">int</span> row<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">// å“ˆå¸Œè¡¨å­˜å‚¨æ¯ä¸€è¡Œçš„æ¯ä¸ªæ•°æ˜¯å¦å‡ºç°è¿‡ï¼Œé»˜è®¤åˆå§‹æƒ…å†µä¸‹ï¼Œæ¯ä¸€è¡Œæ¯ä¸€ä¸ªæ•°éƒ½æ²¡æœ‰å‡ºç°è¿‡</span>       <span class="token comment">// æ•´ä¸ªboardæœ‰9è¡Œï¼Œç¬¬äºŒç»´çš„ç»´æ•°10æ˜¯ä¸ºäº†è®©ä¸‹æ ‡æœ‰9ï¼Œå’Œæ•°ç‹¬ä¸­çš„æ•°å­—9å¯¹åº”ã€‚</span>       <span class="token keyword">int</span> col<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">// å­˜å‚¨æ¯ä¸€åˆ—çš„æ¯ä¸ªæ•°æ˜¯å¦å‡ºç°è¿‡ï¼Œé»˜è®¤åˆå§‹æƒ…å†µä¸‹ï¼Œæ¯ä¸€åˆ—çš„æ¯ä¸€ä¸ªæ•°éƒ½æ²¡æœ‰å‡ºç°è¿‡</span>       <span class="token keyword">int</span> box<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">// å­˜å‚¨æ¯ä¸€ä¸ªboxçš„æ¯ä¸ªæ•°æ˜¯å¦å‡ºç°è¿‡ï¼Œé»˜è®¤åˆå§‹æƒ…å†µä¸‹ï¼Œåœ¨æ¯ä¸ªboxä¸­ï¼Œæ¯ä¸ªæ•°éƒ½æ²¡æœ‰å‡ºç°è¿‡ã€‚æ•´ä¸ªboardæœ‰9ä¸ªboxã€‚</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">9</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span><span class="token number">9</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token comment">// éå†åˆ°ç¬¬iè¡Œç¬¬jåˆ—çš„é‚£ä¸ªæ•°,æˆ‘ä»¬è¦åˆ¤æ–­è¿™ä¸ªæ•°åœ¨å…¶æ‰€åœ¨çš„è¡Œæœ‰æ²¡æœ‰å‡ºç°è¿‡ï¼Œ</span>               <span class="token comment">// åŒæ—¶åˆ¤æ–­è¿™ä¸ªæ•°åœ¨å…¶æ‰€åœ¨çš„åˆ—æœ‰æ²¡æœ‰å‡ºç°è¿‡</span>               <span class="token comment">// åŒæ—¶åˆ¤æ–­è¿™ä¸ªæ•°åœ¨å…¶æ‰€åœ¨çš„boxä¸­æœ‰æ²¡æœ‰å‡ºç°è¿‡</span>               <span class="token keyword">if</span><span class="token punctuation">(</span>board<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'.'</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>               <span class="token keyword">int</span> curNumber <span class="token operator">=</span> board<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'0'</span><span class="token punctuation">;</span>               <span class="token keyword">if</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>curNumber<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>col<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>curNumber<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>               <span class="token keyword">if</span><span class="token punctuation">(</span>box<span class="token punctuation">[</span>j<span class="token operator">/</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i<span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span>curNumber<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>               row<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>curNumber<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">// ä¹‹å‰éƒ½æ²¡å‡ºç°è¿‡ï¼Œç°åœ¨å‡ºç°äº†ï¼Œå°±ç»™å®ƒç½®ä¸º1ï¼Œä¸‹æ¬¡å†é‡è§å°±èƒ½å¤Ÿç›´æ¥è¿”å›falseäº†ã€‚</span>               col<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>curNumber<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>               box<span class="token punctuation">[</span>j<span class="token operator">/</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i<span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span>curNumber<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p>é™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥è€ƒè™‘ä½è¿ç®—çš„æ–¹æ³•ï¼Œè¿™é‡Œçš„ç†è§£ä¹Ÿæ¯”è¾ƒå·§å¦™</p><h2 id="38-å¤–è§‚æ•°åˆ—-â­">38. å¤–è§‚æ•°åˆ— â­</h2><div class="code-tag-label code-tag-label-recursion">Recursion</div><h3 id="String-ä¸-StringBuilder-å…³äºæ•ˆç‡å’Œé€’å½’çš„ä½¿ç”¨">* String ä¸ StringBuilder å…³äºæ•ˆç‡å’Œé€’å½’çš„ä½¿ç”¨</h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201027184424039.png" alt="image-20201027184424039"></p><h3 id="1-é€’å½’-v2">1. é€’å½’</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token comment">/**         * æ€è·¯ï¼š è¿™ç§é—®é¢˜çœ‹èµ·æ¥å¾ˆæ²¡æœ‰æ€è·¯ä½†æ˜¯å®é™…ä¸Šåˆå’Œå‰ä¸€é¡¹æœ‰è”ç³»         *  è€ƒè™‘åˆ°è¿½æ ¹æº¯æº --- ä»å°¾éƒ¨è§£å†³ ç„¶åå¯¹æ¯ä¸€å±‚è¿›è¡Œåˆ†æ         */</span>        <span class="token comment">//Stringçš„å¢åˆ æ•ˆç‡ä½ ä½†æ˜¯è¿™é‡Œæˆ‘çš„æ•ˆç‡ä¾ç„¶å¾ˆä½....  </span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">countAndSay</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>n<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">"1"</span><span class="token punctuation">;</span>            <span class="token class-name">StringBuilder</span> str<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> bcstr<span class="token operator">=</span><span class="token function">countAndSay</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>bcstr<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token operator">=</span>i<span class="token punctuation">;</span>k<span class="token operator">&lt;</span>bcstr<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>bcstr<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">==</span>bcstr<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    j<span class="token operator">++</span><span class="token punctuation">;</span>                    i<span class="token operator">++</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">else</span> <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            str<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token operator">+</span>bcstr<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201027184706268.png" alt="image-20201027184706268"></p><p>è¿™ç§åšæ³•èƒ½åšå‡ºæ¥ï¼Œä½†æˆ‘è§‰å¾—åŸºäºè¿­ä»£çš„ ç©ºé—´å¤æ‚åº¦ è¿˜æœ‰Stringè‡ªèº«çš„å¢æ·»éº»çƒ¦ï¼Œä¸”æ¯ä¸€æ¬¡è¿­ä»£éƒ½ä¼šæ–°å»ºStringBuilderå¯¹è±¡ï¼Œæ˜¯ä¼šæ•ˆç‡ä¸é«˜ã€‚</p><h3 id="2-çœ‹é¢˜è§£åçš„ç»†èŠ‚è°ƒæ•´">2. çœ‹é¢˜è§£åçš„ç»†èŠ‚è°ƒæ•´</h3><p>ç»†èŠ‚åˆ†æï¼š è¿™é‡Œçš„ä¸»è¦æ•ˆç‡ä¸é«˜çš„æ‹–å»¶ç‚¹åœ¨äºstr.append çš„æ“ä½œ</p><p>â€‹å¯èƒ½æ˜¯ç”±äº           str.append(String.valueOf(j)+bcstr.charAt(i));  ä½¿å¾—ä¸¤ä¸ªå­—ç¬¦ä¸²å†æ¬¡ç›¸åŠ å¾—åˆ°çš„æ–°å­—ç¬¦ä¸²ï¼Œå†å°†æ–°çš„å­—ç¬¦ä¸²èµ‹å€¼ä¸Šå»ï¼Œä½¿å¾—åœ¨è¿™é‡Œå‡ºç°çš„Stringç±»å‹çš„å¢åˆ ã€‚ ä¸”append(int ) æ·»åŠ çš„æ˜¯Stringç±»å‹çš„æ•°å­—ï¼Œä½†ç”±äºappend(int+char)å‹çš„æ˜¯ä¼šå…ˆå°†char è½¬æ¢æˆåŠ ä¸Šintçš„char å†èµ‹å€¼ç»™builderï¼Œ æ‰€ä»¥è¿™é‡Œè¿ç”¨append æ›´å¥½ã€‚</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java">str<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>bcstr<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201027185740882.png" alt="image-20201027185740882"></p><h2 id="42-æ¥é›¨æ°´-â­â­â­">42. æ¥é›¨æ°´ â­â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><div class="code-tag-label code-tag-label-stack">Stack</div><div class="code-tag-label code-tag-label-dp">DP</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220117101802334.png" alt="image-20220117101802334"></p><h3 id="å®¡é¢˜-v7">å®¡é¢˜</h3><ul><li>åŒºé—´å’Œé«˜åº¦å†³å®šäº†èƒ½å¤Ÿæ¥å¤šå°‘æ°´ï¼Œä»¥æ¥è¿‘åŒºé—´çš„æœ€é«˜ç‚¹å’Œèµ·ç‚¹å†³å®šï¼Ÿ</li><li>ç®—æ¯ä¸€ä¸ªå¯æ¥å•å…ƒçš„æ¯ä¸€å±‚å—ï¼Ÿ</li><li>åšæ³•ï¼šå…ˆåœ¨LogNçš„æ—¶é—´ç‚¹æ‰¾åˆ°æ¯ä¸ªåŒºé—´ï¼Œç„¶ååœ¨åŒºé—´å†…è¿›è¡Œè¿ç®—</li><li>åšåæ€è€ƒï¼šå¦‚ä½•åœ¨Onçš„æƒ…å†µä¸‹è®¡ç®—ï¼Ÿ</li></ul><h3 id="1-æš´åŠ›â€“é¡ºåºæœç´¢">1. æš´åŠ›â€“é¡ºåºæœç´¢</h3><p>ä»¥èµ·å§‹ç‚¹å¤§å°ä¸ºåˆ¤æ–­æ¡ä»¶ï¼Œæ‰¾åˆ°æœ«ç‚¹å¤§äºèµ·å§‹ç‚¹çš„ç‚¹ï¼Œåˆ†æƒ…å†µè®¨è®ºï¼š</p><ul><li>å¦‚æœæ‰¾åˆ°äº† ï¼Œåˆ™åœ¨æ­¤åŸºç¡€ä¸Šä»¥è¾ƒå°çš„èµ·å§‹ç‚¹ä¸ºé¡¶ï¼Œèµ·å§‹ç‚¹ - å„ç‚¹çš„å€¼é€æ¸ç´¯åŠ </li><li>æ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™æ‰¾ç¬¬äºŒå¤§çš„ç‚¹ï¼Œå¹¶ä»¥æœ«ç‚¹ä¸ºé¡¶â€¦</li></ul><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">trap</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> height<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">int</span> total <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> height<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> height<span class="token punctuation">.</span>length <span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              <span class="token comment">// confirm a region</span>              <span class="token keyword">if</span><span class="token punctuation">(</span>height<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">>=</span>  height<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> j<span class="token punctuation">;</span> k <span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                      total <span class="token operator">+=</span> height<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> height<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>                  <span class="token punctuation">&#125;</span>                  i <span class="token operator">=</span> j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>                  <span class="token keyword">break</span><span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span>              <span class="token comment">// if can`t find a number bigger than height[i]</span>              <span class="token keyword">if</span><span class="token punctuation">(</span>j <span class="token operator">==</span> height<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> height<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;</span> height<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                  <span class="token keyword">int</span> temp <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>                  <span class="token keyword">for</span><span class="token punctuation">(</span>j <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> height<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                      <span class="token keyword">if</span><span class="token punctuation">(</span>height<span class="token punctuation">[</span>temp<span class="token punctuation">]</span> <span class="token operator">&lt;</span> height<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>                          temp <span class="token operator">=</span> j<span class="token punctuation">;</span>                  <span class="token punctuation">&#125;</span>                  j <span class="token operator">=</span> temp<span class="token punctuation">;</span>                  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> j<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                      total <span class="token operator">+=</span> height<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-</span> height<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>                   <span class="token punctuation">&#125;</span>                  i <span class="token operator">=</span> j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>                  <span class="token keyword">break</span><span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">return</span> total<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220117154832631.png" alt="image-20220117154832631"></p><p>ä¸ºä»€ä¹ˆè¿™ä¹ˆæ…¢ï¼Ÿ<br>è€ƒè™‘åˆ°å†…éƒ¨å…¶å®æœ‰ä¸‰å±‚å¾ªç¯ï¼ˆä½†å®é™…ä¸Šåªæœ‰ä¸¤å±‚ï¼‰ï¼Œæœ€åæ—¶å¯èƒ½å¯¹æ¯ä¸€ä¸ªèµ·ç‚¹ï¼Œéƒ½æ²¡æœ‰ä¸€ä¸ªæ¯”ä»–å¤§çš„ç‚¹ï¼Œå¹¶ä¸”ç¬¬äºŒå¤§çš„ç‚¹éƒ½åœ¨æœ«å°¾æ’åˆ—ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦æ¥åˆ°äº†O(n^2)<br>å¦‚ä½•æ¶ˆé™¤å¹³æ–¹çš„æ—¶é—´å¤æ‚åº¦å…³é”®è¦ä¹ˆæ¢ç®—æ³•ç±»å‹è¦ä¹ˆå°±è§£å†³å¦‚ä½•æ‰¾ç¬¬äºŒå¤§çš„ç‚¹</p><h3 id="2-åŠ¨æ€ç¼–ç¨‹-ï¼ˆè½¬-éªŒï¼‰">2. åŠ¨æ€ç¼–ç¨‹ ï¼ˆè½¬ - éªŒï¼‰</h3><p>ç¡®å®ï¼Œè¿™ä¸ªé¢˜ç¬¦åˆåŠ¨æ€ç¼–ç¨‹çš„ç‰¹ç‚¹ã€‚è¦æƒ³çŸ¥é“è¯¥ç‚¹å¤„çš„ç§¯æ°´é‡ï¼Œå³<strong>æ‰¾åˆ°è¯¥ç‚¹å·¦å³ä¸¤ä¾§æœ€å¤§å€¼ä¸­è¾ƒå°çš„é‚£ä¸ª</strong>ï¼Œè¿™é‡Œç”¨Onçš„ç©ºé—´å¤æ‚åº¦å»ä¿å­˜è¿™äº›ç‚¹ï¼Œä»¥ä¾¿èƒ½å®ç°O1çš„è®¡ç®—ï¼Œæ‰€ä»¥èƒ½åœ¨Onçš„æ—¶é—´å¤æ‚åº¦å†…å®Œæˆã€‚</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">trap</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> height<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">int</span> total <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> right_max <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>height<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> left_max <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>height<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>       right_max<span class="token punctuation">[</span>height<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> height<span class="token punctuation">[</span>height<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       left_max<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> height<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> height<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           left_max<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>left_max<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> height<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           right_max<span class="token punctuation">[</span>height<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">-</span> i<span class="token punctuation">]</span> <span class="token operator">=</span>  <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>height<span class="token punctuation">[</span>height<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">-</span> i<span class="token punctuation">]</span><span class="token punctuation">,</span> right_max<span class="token punctuation">[</span>height<span class="token punctuation">.</span>length  <span class="token operator">-</span> i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> height<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           total <span class="token operator">+=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>left_max<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> right_max<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> height<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> total<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220117161221631.png" alt="image-20220117161221631"></p><h3 id="3-æ ˆå­˜å‚¨-ï¼ˆè½¬-éªŒï¼‰">3. æ ˆå­˜å‚¨ ï¼ˆè½¬ - éªŒï¼‰</h3><p>æ€è·¯ä¸ 1 ä¸€è‡´ï¼Œæœ‰ç‚¹åƒ1ã€2çš„ç»“åˆï¼Œä¸éœ€è¦å…ˆéå†ï¼Œæœ‰è¡¥å¿æœºåˆ¶ã€‚Onçš„æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦ã€‚ä½†ä¸çŸ¥é“ä¸ºå•¥è¿™ä¹ˆæ…¢</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> total <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token class-name">Deque</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> stack <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> distance<span class="token punctuation">,</span> rel_height<span class="token punctuation">;</span>      <span class="token keyword">while</span><span class="token punctuation">(</span>index <span class="token operator">&lt;</span> height<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>stack<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> height<span class="token punctuation">[</span>index<span class="token punctuation">]</span>  <span class="token operator">></span> height<span class="token punctuation">[</span>stack<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              <span class="token keyword">int</span> pop <span class="token operator">=</span> stack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token keyword">if</span><span class="token punctuation">(</span>stack<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                  <span class="token keyword">break</span><span class="token punctuation">;</span>              distance <span class="token operator">=</span> index <span class="token operator">-</span> stack<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>              rel_height <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>height<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> height<span class="token punctuation">[</span>stack<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> height<span class="token punctuation">[</span>pop<span class="token punctuation">]</span><span class="token punctuation">;</span>              total <span class="token operator">+=</span> rel_height <span class="token operator">*</span> distance<span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>          stack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>index<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">return</span> total<span class="token punctuation">;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220117163209828.png" alt="image-20220117163209828"></p><h3 id="4-è¶…å¦™åŒæŒ‡é’ˆ-ï¼ˆè½¬ï¼‰">4. è¶…å¦™åŒæŒ‡é’ˆ ï¼ˆè½¬ï¼‰</h3><p>Onçš„æ—¶é—´å¤æ‚åº¦  O1çš„ç©ºé—´å¤æ‚åº¦  ã€‚éå¸¸çš„å¦™ï¼Œä»¥ç›¸å‘çš„åŒæŒ‡é’ˆå¤„çš„å€¼çš„å½“å‰å·®å€¼æ¥å†³å®šä»å“ªè¾¹è¿›è¡Œè¡¥å¿ï¼Œå¹¶å­˜å‚¨äº†å¯¹åº”ä¸¤è¾¹çš„æœ€å¤§å€¼ã€‚è€Œåˆç”±äºå…¶åŒæŒ‡é’ˆå·®å€¼é€‰æ‹©é¿å¼€äº†å‡ºç°è¾ƒå°çš„å€¼å¯¼è‡´é”™è¯¯è¡¥å¿çš„å¯èƒ½</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">trap</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> height<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> right <span class="token operator">=</span> height<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> left_max <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> right_max <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>left <span class="token operator">&lt;</span> right<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>height<span class="token punctuation">[</span>left<span class="token punctuation">]</span> <span class="token operator">&lt;</span> height<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>height<span class="token punctuation">[</span>left<span class="token punctuation">]</span> <span class="token operator">>=</span> left_max<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                left_max <span class="token operator">=</span> height<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                ans <span class="token operator">+=</span> <span class="token punctuation">(</span>left_max <span class="token operator">-</span> height<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token operator">++</span>left<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>height<span class="token punctuation">[</span>right<span class="token punctuation">]</span> <span class="token operator">>=</span> right_max<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                right_max <span class="token operator">=</span> height<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                ans <span class="token operator">+=</span> <span class="token punctuation">(</span>right_max <span class="token operator">-</span> height<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token operator">--</span>right<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> ans<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/trapping-rain-water/solution/jie-yu-shui-by-leetcode/</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220117164109645.png" alt="image-20220117164109645"></p><h2 id="43-å­—ç¬¦ä¸²ç›¸ä¹˜">43. å­—ç¬¦ä¸²ç›¸ä¹˜</h2><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210403103757421.png" alt="image-20210403103757421"></p><h3 id="æ€è€ƒï¼š-v3">æ€è€ƒï¼š</h3><p>ä¸èƒ½ç”¨Bigdemical   å¤§æ•°ç›¸ä¹˜   æ³¨æ„æœ€é«˜ä½æ•°   è¿”å›ç±»å‹ä¸ºString   longå¯èƒ½æœ‰æº¢å‡º</p><p>ä½è¿ç®—ï¼Ÿ</p><h3 id="1-My-è‡ªå®ç°çš„è¿›ä½æœºåˆ¶">1. My è‡ªå®ç°çš„è¿›ä½æœºåˆ¶</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">if</span><span class="token punctuation">(</span>num1<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"0"</span><span class="token punctuation">)</span><span class="token operator">||</span>num2<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token string">"0"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> l1 <span class="token operator">=</span> num1<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> l2 <span class="token operator">=</span> num2<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> l3 <span class="token operator">=</span> l1 <span class="token operator">+</span> l2<span class="token punctuation">;</span><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>l3<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span><span class="token number">0</span> <span class="token punctuation">;</span>i<span class="token operator">&lt;</span>l3<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    result<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'0'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//å†—æ‚</span><span class="token keyword">int</span> min <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>l1<span class="token punctuation">,</span>l2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>l1 <span class="token operator">==</span> min<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> temp  <span class="token operator">=</span>num1<span class="token punctuation">;</span>    num1 <span class="token operator">=</span> num2<span class="token punctuation">;</span>    num2 <span class="token operator">=</span> temp<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//é€‰å‡ºæœ€å°çš„æ•°</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> num2<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> num1<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> j<span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> mr <span class="token operator">=</span>  <span class="token punctuation">(</span>num1<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">48</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>num2<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">48</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        result<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token punctuation">(</span> <span class="token keyword">char</span> <span class="token punctuation">)</span><span class="token punctuation">(</span>mr <span class="token operator">%</span> <span class="token number">10</span> <span class="token punctuation">)</span> <span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>result<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token number">58</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            result<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>            result<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>result<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">//è¿™é‡Œæœ‰å†—æ‚çš„æˆåˆ†</span>        result<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token punctuation">]</span> <span class="token operator">+=</span> mr<span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>result<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token number">58</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            result<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>            result<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">10</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'0'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>æ—¶é—´å¤æ‚åº¦ O(m * n ) ç©ºé—´å¤æ‚åº¦ O(m+n)</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210403200458765.png" alt="image-20210403200458765"></p><p>æ•´è§£çš„æ€è·¯å·®ä¸å¤šï¼Œä½†æ˜¯åœ¨å¤„ç†result[i+j-1]è¿™ä¸€å—æ›´åŠ ç®€æ´</p><h2 id="50-Pow-x-n-â­â­">50. Pow(x,n) â­â­</h2><blockquote><p>Time : 2022 / 4 / 5 10 : 46<br>TAG : Iteration / Recursion / Complement / Bits</p></blockquote><div class="code-tag-time">2022/4/5 10:46:00</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><div class="code-tag-label code-tag-label-recursion">Recursion</div><div class="code-tag-label code-tag-label-math">Bits</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220402195616362.png" alt="image-20220402195616362"></p><h3 id="å®¡é¢˜-v8">å®¡é¢˜</h3><ul><li>xæ˜¯å°æ•°ï¼Œè¿”å›çš„ä¹Ÿæ˜¯doubleç±»å‹æ•°å­—.æŒ‡æ•°å¯èƒ½ä¸ºè´Ÿæ•°</li><li>å¯èƒ½çš„åšæ³•ï¼š</li><li>æ€è·¯ï¼š<ul><li>ç®€å•ï¼šé€’å½’ï¼›é€’å½’</li><li>è¿›é˜¶ï¼šèƒ½å¦åœ¨å¯¹æ•°æ—¶é—´å¤æ‚åº¦å†…å®Œæˆ</li></ul></li></ul><h3 id="1-é€’å½’ï¼ˆStack-Overï¼‰">1. é€’å½’ï¼ˆStack Overï¼‰</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">myPow</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token function">myPow</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>x<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">1.0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token function">myPow</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span>x<span class="token punctuation">,</span><span class="token operator">-</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span></code></pre></div><p><strong>ä¼˜åŒ–</strong>(Stack OF)</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">myPow</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">return</span> <span class="token function">myPow</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">myPow</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">long</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">return</span> <span class="token number">1.0</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">return</span> <span class="token function">myPow</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span>x<span class="token punctuation">,</span><span class="token operator">-</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">/</span> <span class="token number">3</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">return</span> <span class="token function">myPow</span><span class="token punctuation">(</span>x <span class="token operator">*</span> x <span class="token operator">*</span> x <span class="token punctuation">,</span> n <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">myPow</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>n <span class="token operator">%</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">return</span> <span class="token function">myPow</span><span class="token punctuation">(</span>x <span class="token operator">*</span> x<span class="token punctuation">,</span>n <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>n <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token operator">?</span>x<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">return</span> x<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220402205928765.png" alt="image-20220402205928765"></p><h3 id="2-è¿­ä»£ï¼ˆOverTimeï¼‰">2. è¿­ä»£ï¼ˆOverTimeï¼‰</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">myPow</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">return</span> <span class="token number">1.0D</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           n <span class="token operator">=</span> <span class="token operator">-</span>n<span class="token punctuation">;</span>           x <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span>x<span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">double</span> res <span class="token operator">=</span> x<span class="token punctuation">;</span>       <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">--</span>n <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           res <span class="token operator">=</span> res <span class="token operator">*</span> x<span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p><strong>ä¼˜åŒ–</strong></p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">myPow</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">1.0D</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">Long</span> longx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Long</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            longx <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>longx<span class="token punctuation">)</span><span class="token punctuation">;</span>            x <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span>x<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>longx <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> x<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">double</span> res <span class="token operator">=</span> <span class="token number">1.0d</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>longx <span class="token operator">/</span> <span class="token number">2</span><span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            res <span class="token operator">=</span> res <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>longx <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token operator">?</span><span class="token number">1.0</span><span class="token operator">:</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>            x <span class="token operator">=</span> x <span class="token operator">*</span> x <span class="token punctuation">;</span>            longx <span class="token operator">/=</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        res <span class="token operator">*=</span> x<span class="token punctuation">;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220402205324791.png" alt="image-20220402205324791"></p><h3 id="é—®é¢˜-v4">é—®é¢˜</h3><p>è¿™é‡Œè¿˜æ¶‰åŠåˆ°äº†è‡ªå·±çš„ä¸€ä¸ªå­¦ä¹ æ¼æ´ï¼Œå¯¹è¡¥ç çš„ç†è§£å’Œè®¡ç®—æœºä½è¡¨ç¤ºçš„æ··ä¹±ç†è§£ï¼š</p><blockquote><p>å…·ä½“è§£æå‚è§æ–‡ç« ã€Šè®¡ç®—æœºç»„æˆåŸç†ã€‹ [è¡¥ç çš„åŠ å‡æ³•]ç« èŠ‚</p></blockquote><p>è¿™é“é¢˜æˆ‘çš„é—®é¢˜ä¸»è¦åœ¨äºï¼šsigned int (1 &gt;&gt; 31 - 1)ç­‰äºå¤šå°‘ï¼Œè¿™é‡Œåº”è¯¥ä»ä½çš„è§’åº¦å…ˆå»ç†è§£ï¼Œè®¡ç®—-1çš„è¡¥ç ç„¶åäºŒè€…ç›¸åŠ ï¼Œå› ä¸ºæ˜¯è¡¥ç è¿ç®—ï¼Œæ‰€ä»¥ç¬¦å·ä½å›Šæ‹¬åœ¨è®¡ç®—è¿‡ç¨‹ä¸­ã€‚ï¼ˆè€Œ-a = ~a+1ï¼Œè¿™ä¸€ç‚¹ä¹Ÿå¾ˆé‡è¦ï¼Œç®€åŒ–ç†è§£è¿‡ç¨‹ï¼‰ï¼Œå¾—åˆ°äºŒè¿›åˆ¶å­˜å‚¨åï¼Œå†æ ¹æ®å¯¹åº”çš„æ•°æ®ç±»å‹å»è½¬åŒ–ï¼Œè¿™é‡Œå¾—åˆ°çš„å…¶å®æ˜¯1&gt;&gt;31ï¼Œè€Œåˆæ˜¯signed intï¼Œæ‰€ä»¥ç»“æœåˆæ ¹æ®åŸç -&gt;è¡¥ç çš„åæ“ä½œæ¥æ±‚è¡¥ç -&gt;åŸç ï¼Œå¾—åˆ°åŸç çš„å€¼åº”è¯¥æ˜¯-1&gt;&gt;31ã€‚</p><p>æ€»ç»“ä¸€ä¸‹å°±æ˜¯ï¼š<strong>å®Œå…¨æŒ‰ç…§è®¡ç®—æœºçš„æ­¥éª¤æ¥ï¼Œä¸è¦è‡ªå·±ä¸€ä¼šè¡¥ç è¿ç®—ä¸€ä¼šåŸç ç›¸åŠ ï¼ŒæŠŠè‡ªå·±éƒ½ææ··äº†</strong></p><h3 id="æ€»ç»“-v3">æ€»ç»“</h3><p>ä¸€ç›´æƒ³åšè¿™é“é¢˜ï¼Œä»Šå¤©ç»ˆäºè¿˜æ˜¯æŠ½æ—¶é—´å†™äº†è¿™é“é¢˜ã€‚è¿™é“é¢˜è¸©åˆ°å‘äº†ï¼Œæœ€å¼€å§‹ç”¨è¿­ä»£å’Œé€’å½’ï¼Œéƒ½æ²¡åšå‡ºæ¥ï¼Œè¦ä¹ˆè¶…æ—¶è¦ä¹ˆStackOFã€‚ä»¥ä¸ºæ˜¯ç®—æ³•æœ¬èº«çš„é—®é¢˜ï¼Œä½†åæ¥å®åœ¨æ²¡åŠæ³•ï¼Œæƒ³äº†æƒ³åè§‰å¾—å¥‡æ€ªã€‚ä¸€è°ƒè¯•å‘ç°ä¸€ä¸ªé‡è¦çš„é—®é¢˜ï¼ä¹Ÿæ˜¯éå¸¸åŸºç¡€çš„é—®é¢˜ï¼ˆåªæ€ªè‡ªå·±åŸºç¡€ä¸ç‰¢å›ºï¼‰</p><p>$$int \ n = Integer.MIN_VALUE  \quad then \quad -n = n$$</p><h2 id="53-æœ€å¤§å­åºå’Œ-â­">53. æœ€å¤§å­åºå’Œ â­</h2><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210405093158517.png" alt="image-20210405093158517"></p><h3 id="æ€è€ƒ-v11">æ€è€ƒ</h3><p>O n çš„è§£æ³•</p><p>åŠ¨æ€è§„åˆ’ï¼Ÿ</p><h3 id="1-My-DP">1. My DP</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">maxSubArray</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> max <span class="token operator">=</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> dp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>nums<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>     dp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>dp<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        max <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>max<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> max<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>dp åºåˆ—æ±‚ï¼Œæœ€å¼€å§‹é¢˜æ²¡çœ‹æ¸…æ¥šä»¥ä¸ºæ±‚çš„æ˜¯æ•°ç»„å­åºåˆ—ï¼Œ è®¾ç½®äº†end å’Œbeginï¼Œåæ¥ä¸€çœ‹åªæ±‚æœ€å¤§å€¼  â€¦</p><p>ç©ºé—´å¤æ‚åº¦ On æ—¶é—´å¤æ‚åº¦ On</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210405094811575.png" alt="image-20210405094811575"></p><h3 id="æ”¹è¿›">æ”¹è¿›</h3><p>åŠ¨æ€è§„åˆ’éœ€è¦é¢å¤–çš„æ•°ç»„ä¸€èˆ¬æ˜¯å¯ä»¥æ”¹è¿›çš„</p><p>æ‰€ä»¥è¿™é‡Œæˆ‘æ”¹è¿›äº†ä¹‹å</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">maxSubArray</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> max <span class="token operator">=</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> dp_pre <span class="token operator">=</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        dp_pre <span class="token operator">=</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>dp_pre<span class="token operator">+</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        max <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>dp_pre<span class="token punctuation">,</span>max<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> max<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>ç©ºé—´å¤æ‚åº¦å˜ä¸ºO 1</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210405095134634.png" alt="image-20210405095134634"></p><h3 id="3-åˆ†æ²»-çº¿æ®µæ ‘">3. åˆ†æ²»  çº¿æ®µæ ‘</h3><p>â€¦</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210405161553429.png" alt="image-20210405161553429"></p><h2 id="55-è·³è·ƒæ¸¸æˆ-â­â­">55. è·³è·ƒæ¸¸æˆ â­â­</h2><div class="code-tag-time">2022/3/20 20:12:00</div><div class="code-tag-label code-tag-label-dfs">DFS</div><div class="code-tag-label code-tag-label-greedy">Greedy</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220320183910326.png" alt="image-20220320183910326"></p><h3 id="å®¡é¢˜-v9">å®¡é¢˜</h3><ul><li>éè´Ÿæ•´æ•°æ•°ç»„ï¼Œä»£è¡¨æœ€å¤§å¯è·³æ­¥æ•°ï¼Œåˆ¤æ–­çš„æ˜¯èƒ½å¦è·³åˆ°æœ€åä¸€ä¸ªä¸‹æ ‡</li><li>å¯èƒ½çš„ç®—æ³•ï¼šDFS / dp</li><li>å¯ä»¥åšä¸€äº›ä¼˜åŒ–ï¼Œæ¯”å¦‚å…ƒç´ å€¼éƒ½å¤§äº0ï¼Œåˆ™true</li><li>æ€è·¯ï¼š<ul><li>ç®€å•ï¼š<ul><li>DFSï¼šæ„å»ºå›æº¯æ–¹æ³•ï¼Œå½“å‰ç´¢å¼•ï¼Œå½“å‰æ‰€è·³æ­¥æ•°</li></ul></li><li>è¿›é˜¶ï¼šä¸€æ¬¡éå†åæ˜¯å¦å¯è¡Œï¼ŸæŒ‰ç†è¯´å¯ä»¥<ul><li>DPï¼š</li></ul></li></ul></li></ul><h3 id="1-DFS-OverTime">1. DFS(OverTime)</h3><p>è¶…æ—¶ï¼Œä½†ç»“æœåº”è¯¥æ˜¯å¯¹çš„ã€‚IDEAä¸Šæµ‹1000æ¬¡è¶…æ—¶æ•°ç»„ï¼Œæ­¤æ–¹æ³•ç”¨æ—¶14msï¼Œdpç”¨æ—¶3msï¼Œè¶…æ—¶æ²¡é—®é¢˜</p><p>ä¸‰æ¬¡æœç´¢ï¼Œä¸‰ç§æƒ…å†µçš„å¹¶é›†ï¼ˆéœ€è¦è€ƒè™‘åˆ¤æ–­æ­£è´Ÿçš„æ¡ä»¶ï¼‰ï¼š</p><ol><li>å½“å‰æœ€å¤§æ­¥æ•°ä¸‹çš„ä¸‹ä¸€ä¸ªç´¢å¼•ä½ç½®</li><li>é‚»æ¥çš„ä¸‹ä¸€ä¸ªç´¢å¼•å¼€å§‹</li><li>å½“å‰æ­¥æ•°-1æœç´¢</li></ol><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span>     <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">canJump</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">boolean</span> res <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">boolean</span> allPositive <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>                allPositive <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>allPositive<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        res <span class="token operator">=</span> <span class="token function">dfs</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> res <span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> index<span class="token punctuation">,</span> <span class="token keyword">int</span> cur_step<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>index <span class="token operator">>=</span> nums<span class="token punctuation">.</span>length <span class="token operator">||</span> <span class="token punctuation">(</span>cur_step <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> index <span class="token operator">!=</span> nums<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">+</span> index <span class="token operator">==</span> nums<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">||</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> nums<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">boolean</span> longJmp <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">boolean</span> nextJmp <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">boolean</span> decreaseJmp <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>cur_step <span class="token operator">+</span> index <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            longJmp <span class="token operator">=</span>  <span class="token function">dfs</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span>index <span class="token operator">+</span> cur_step<span class="token punctuation">,</span> nums<span class="token punctuation">[</span>index <span class="token operator">+</span>cur_step<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>index <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            nextJmp <span class="token operator">=</span>  <span class="token function">dfs</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span>index<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>index<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        decreaseJmp <span class="token operator">=</span> <span class="token function">dfs</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span>index<span class="token punctuation">,</span> cur_step <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> longJmp <span class="token operator">|</span> nextJmp <span class="token operator">|</span> decreaseJmp <span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><h3 id="2-DP-è´ªå¿ƒ">2. <s>DP</s> / è´ªå¿ƒ</h3><p>DP ï¼ æˆ‘æ»´è¶…äººï¼ï¼ˆå…¶å®æ˜¯è´ªå¿ƒhhhï¼‰<br>æ¿€åŠ¨çš„å¿ƒï¼Œé¢¤æŠ–çš„æ‰‹ï¼Œè¿™é“é¢˜çš„ç­”æ¡ˆæˆ‘KO</p><p>å½“ç„¶ç†è®ºè¿˜æ˜¯å› ä¸ºä¸¤ç‚¹ï¼š</p><ol><li>å¯ä»¥é€šè¿‡ä¸€æ¬¡éå†å¾—åˆ°</li><li>å½“å‰booleanå€¼å¯ä»¥ç”±ä¸Šä¸€ä¸ªå…ƒç´ çš„æ˜¯å¦å¯è¡Œçš„booleanå€¼æ¨å‡º</li></ol><p>DPçš„æ¨å¯¼ï¼š<br>dpä¸­è®°å½•çš„æ˜¯åˆ°äº†å½“å‰è¿™ä¸€ä¸ªç´¢å¼•ï¼Œ<strong>è¿˜å‰©ä¸‹</strong>å¤šå°‘æ­¥æ•°ï¼ˆä¹Ÿå°±æ˜¯æœ€å¤§æ­¥æ•°ï¼Œæ‰€ä»¥æ˜¯<strong>è´ªå¿ƒ</strong>ï¼‰å¯ä»¥èµ°ï¼ˆå› ä¸ºæ­¥æ•°è‚¯å®šæ˜¯è¿ç»­çš„ï¼Œä»0 - mï¼‰</p><ol><li>dp[i - 1]  &lt;= 0ä¸èƒ½å¤Ÿåˆ°è¾¾dp[i]</li><li>dp[i - 1] &gt; 0 èƒ½åˆ°è¾¾ï¼Œè¿™æ—¶è¦è€ƒè™‘dp[i]çš„å€¼çš„å–èˆï¼Œå› ä¸ºä¿æŒçš„æ˜¯å½“å‰ç´¢å¼•è¿˜å‰©ä¸‹çš„<strong>æœ€å¤§æ­¥æ•°</strong>ï¼Œä¸ºç¡®ä¿æœ€å¤§ï¼Œåˆ™éœ€è¦åœ¨nums[i]å’Œdp[i - 1] - 1ä¸Šåšå‡ºå–èˆï¼Œå–æœ€å¤§å€¼ã€‚</li></ol><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">canJump</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">boolean</span> res <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">boolean</span> allPositive <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// ä¼˜åŒ–ä¸€ï¼Œä¸€æ¬¡éå† èƒ½ç¡®å®štrueä½†ä¸èƒ½ç¡®å®šfalse </span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>                allPositive <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>allPositive<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// å¯ä¼˜åŒ–ç‚¹ä¸‰ï¼Œdp[] -> dp (int)</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> dp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>nums<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>        dp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// ä¼˜åŒ–äºŒï¼Œå¯ç›´æ¥è°ƒåˆ°æœ€åä¸€ä¸ªï¼Œå°±å¯ä»¥ç›´æ¥åˆ¤æ–­æ­£</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> i <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">>=</span> nums<span class="token punctuation">.</span>length <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> dp<span class="token punctuation">[</span>nums<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p>è¿™ä¸ªç»“æœæˆ‘éå¸¸æ»¡æ„å“ˆå“ˆå“ˆ</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220320193010949.png" alt="image-20220320193010949"></p><h4 id="ä¼˜åŒ–çš„é‡è¦æ€§">ä¼˜åŒ–çš„é‡è¦æ€§</h4><p>å¯èƒ½æ˜¯é¢˜åº“ç»™çš„æµ‹è¯•æ•°æ®åå‘é—®é¢˜ï¼Œè¿™é‡Œæˆ‘å»æ‰äº†å‰é¢çš„ä¸€æ¬¡éå†ï¼ˆåˆ¤æ–­æ˜¯å¦éƒ½ä¸ºæ­£æ•°çš„æƒ…å†µï¼Œå› ä¸ºå…¨éƒ¨ä¸ºæ­£æ•°åˆ™è‚¯å®šå¯ä»¥é€šè¿‡ï¼‰ã€‚ç»“æœç›¸å½“å“‡å¡</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220320193142772.png" alt="image-20220320193142772"></p><p><s>æ²¡æƒ³åˆ°å»æ‰äº†åŸä»¥ä¸ºå½±å“ä¸å¤§çš„ä¸€æ¬¡éå†ï¼ŒO(n)ä¸Šä¸ä¼šæœ‰å½±å“ï¼Œä½†å®é™…å´è¿˜æ˜¯ç›¸å·®ç”šè¿œï¼Œä¼˜åŒ–çš„é‡è¦æ€§æ˜¯ä¸è¨€è€Œå–»çš„</s>.è¿™é‡Œä¹‹ååº”è¯¥æ˜¯æŸå‡ æ¬¡åå·®ï¼Œåˆ é™¤ååˆè¯•äº†ä¸‹ï¼Œæ¢å¤æ­£å¸¸94%ï¼Œå› ä¸ºé¢˜è§£æ–¹æ³•æœ€æ…¢éƒ½æ˜¯O(n)ï¼Œåªæ˜¯æ“ä½œä¸Šå¤šåšäº†å‡ æ­¥åˆ¤æ–­ï¼Œè¿™é‡Œè¿™æ ·åšå…¶å®æ„ä¹‰ä¸æ˜¯å¾ˆå¤§ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªä¼˜åŒ–å°±æ˜¯å¯ç›´æ¥ä¸€æ­¥è·³åˆ°æœ€åä¸€æ ¼ï¼Œåˆ™åˆ¤æ­£ï¼ˆä¸è¿‡è²Œä¼¼åŠ ä¸Šå½±å“ä¸å¤§ï¼Œè¿˜ä¸æ·»åŠ ä½ç½®æœ‰å…³ç³»ï¼‰</p><p><strong>dpæœ€æ ¹æœ¬çš„ä¼˜åŒ–</strong></p><p>å¿˜è®°äº†dpæœ€æ ¹æœ¬çš„ä¼˜åŒ–æ€è·¯ï¼Œå³æŠŠ<strong>æ•°ç»„æ›¿æ¢æˆå•ä¸ªå˜é‡</strong>ï¼</p><h3 id="3-ç®€æ´çš„æ€è·¯ï¼ˆè½¬ï¼‰">3. ç®€æ´çš„æ€è·¯ï¼ˆè½¬ï¼‰</h3><p>è¡¨ç¤ºå½“å‰ç´¢å¼•ä¸‹è¿˜å¯ä»¥è·³å¤šè¿œï¼Œæ€è·¯ç›¸ä¼¼</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">canJump</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>nums <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">//å‰n-1ä¸ªå…ƒç´ èƒ½å¤Ÿè·³åˆ°çš„æœ€è¿œè·ç¦»</span>        <span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> k<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">//ç¬¬iä¸ªå…ƒç´ èƒ½å¤Ÿè·³åˆ°çš„æœ€è¿œè·ç¦»</span>            <span class="token keyword">int</span> temp <span class="token operator">=</span> i <span class="token operator">+</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token comment">//æ›´æ–°æœ€è¿œè·ç¦»</span>            k <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> temp<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//å¦‚æœæœ€è¿œè·ç¦»å·²ç»å¤§äºæˆ–ç­‰äºæœ€åä¸€ä¸ªå…ƒç´ çš„ä¸‹æ ‡,åˆ™è¯´æ˜èƒ½è·³è¿‡å»,é€€å‡º. å‡å°‘å¾ªç¯</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>k <span class="token operator">>=</span> nums<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">//æœ€è¿œè·ç¦»kä¸å†æ”¹å˜,ä¸”æ²¡æœ‰åˆ°æœ«å°¾å…ƒç´ </span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><h3 id="åæ€-v4">åæ€</h3><ul><li>On ä¸€æ¬¡éå†çš„æ€è·¯å¸®å¤§å¿™ï¼Œä¼˜åŒ–çš„æ€è·¯è¿˜æ˜¯ä¸é”™</li><li>dpæœ€ç»ˆä¼˜åŒ–æ²¡æœ‰æƒ³åˆ°ï¼ŒåŒ–æ•°ç»„ä¸ºå•å˜é‡</li><li>DFSä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œå¥½åœ¨ç£¨äº†ä¸€ä¼šåæƒ³åˆ°äº†</li></ul><h2 id="68-æ–‡æœ¬å·¦å³å¯¹å…¶-â­â­â­">68. æ–‡æœ¬å·¦å³å¯¹å…¶ â­â­â­</h2><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210909101658006.png" alt="image-20210909101658006"></p><h3 id="å®¡é¢˜-v10">å®¡é¢˜</h3><p>æ¯è¡Œè‡³å°‘æœ‰ä¸€ä¸ªword</p><p>è¦æ±‚å°½å¯èƒ½å‡åŒ€åˆ†é…å•è¯é—´çš„ç©ºæ ¼æ•°é‡ã€‚å¦‚æœæŸä¸€è¡Œå•è¯é—´çš„ç©ºæ ¼ä¸èƒ½å‡åŒ€åˆ†é…ï¼Œåˆ™å·¦ä¾§æ”¾ç½®çš„ç©ºæ ¼æ•°è¦å¤šäºå³ä¾§çš„ç©ºæ ¼æ•°ã€‚</p><p>æ–‡æœ¬çš„æœ€åä¸€è¡Œåº”ä¸ºå·¦å¯¹é½ï¼Œä¸”å•è¯ä¹‹é—´ä¸æ’å…¥<strong>é¢å¤–çš„</strong>ç©ºæ ¼ã€‚</p><p>ç©ºæ ¼æƒ…å†µï¼š å‡åˆ†ã€ä¸å‡åˆ†</p><h3 id="1-æ ¸å¿ƒæ­¥éª¤æ‹†åˆ†æ³•ç¡¬è§£â€¦">1. æ ¸å¿ƒæ­¥éª¤æ‹†åˆ†æ³•ç¡¬è§£â€¦</h3><p>ç›´æ¥ç¡¬è§£ï¼Œæ ¸å¿ƒéƒ¨åˆ†æ‹†åˆ†æˆä¸¤ä¸ªæ–¹æ³•</p><ul><li>ä¸€è¡Œä¸­å¤šå°‘ä¸ªå•è¯</li><li>ä¸€è¡Œä¸­çš„å•è¯å¦‚ä½•æ’åˆ—<ul><li>å‡åˆ†</li><li>ä¸å‡åˆ†æƒ…å†µ</li><li>æœ€åä¸€æ’</li><li>åªæœ‰ä¸€ä¸ªå•è¯æƒ…å†µ</li></ul></li></ul><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"> <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> <span class="token function">fullJustify</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> words<span class="token punctuation">,</span> <span class="token keyword">int</span> maxWidth<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// detect how many numbers it can contain</span>       <span class="token keyword">int</span> column <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token class-name">String</span> newLine<span class="token punctuation">;</span>       <span class="token keyword">while</span><span class="token punctuation">(</span>index <span class="token operator">&lt;</span> words<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token function">getMaxNumInSingle</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span>maxWidth<span class="token punctuation">,</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token class-name">String</span> single <span class="token operator">=</span> <span class="token function">makeSingleStr</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span>maxWidth<span class="token punctuation">,</span>index<span class="token punctuation">,</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>           result<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>single<span class="token punctuation">)</span><span class="token punctuation">;</span>           index<span class="token operator">+=</span>size<span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> result<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span><span class="token comment">// è·å–å•è¡Œæœ‰å¤šå°‘ä¸ªå­—æ¯</span>   <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getMaxNumInSingle</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> words<span class="token punctuation">,</span> <span class="token keyword">int</span> maxWidth<span class="token punctuation">,</span> <span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token punctuation">;</span>index<span class="token operator">&lt;</span>words<span class="token punctuation">.</span>length<span class="token punctuation">;</span>index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>length <span class="token operator">+</span> words<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token operator">==</span> maxWidth<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               size <span class="token operator">++</span><span class="token punctuation">;</span>               <span class="token keyword">break</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>length <span class="token operator">+</span> words<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> maxWidth<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">break</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>length <span class="token operator">+</span> words<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> maxWidth<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token comment">// åŠ 1 æ˜¯å› ä¸ºç©ºæ ¼ï¼Œè¿™é‡Œä¸‹åŠ ä¸Šä¸åŠ å¾ˆé‡è¦</span>               length <span class="token operator">+=</span> words<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>               size <span class="token operator">++</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> size<span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span><span class="token comment">// è·å–å•è¡Œå•è¯æ’åˆ—åString  StringBuilderæ­¤å¤„å¯ä¼˜åŒ–</span>   <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">makeSingleStr</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> words<span class="token punctuation">,</span> <span class="token keyword">int</span> maxWidth<span class="token punctuation">,</span> <span class="token keyword">int</span> index<span class="token punctuation">,</span> <span class="token keyword">int</span> size<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">int</span> i <span class="token operator">=</span> index<span class="token punctuation">;</span>       <span class="token keyword">int</span> allLength <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token class-name">StringBuilder</span> str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// ä¸€ä¸ªå•è¯æƒ…å†µ</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>size <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           str<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>maxWidth<span class="token operator">-</span>words<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               str<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>              <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span>       <span class="token comment">// æœ€åä¸€è¡Œæƒ…å†µ</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>index<span class="token operator">+</span>size <span class="token operator">==</span> words<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> index<span class="token punctuation">;</span> k<span class="token operator">&lt;</span>index<span class="token operator">+</span>size<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               str<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               str<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           str<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>index<span class="token operator">+</span>size<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">int</span> strLength <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k<span class="token operator">&lt;</span>maxWidth<span class="token operator">-</span>strLength<span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               str<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>            <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">&lt;</span>index<span class="token operator">+</span>size<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           allLength <span class="token operator">+=</span> words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           i<span class="token operator">++</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>             <span class="token keyword">int</span> curSpaces <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> index<span class="token punctuation">;</span> k <span class="token operator">&lt;</span> index<span class="token operator">+</span>size<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> k<span class="token operator">++</span> <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           str<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">int</span> temp <span class="token operator">=</span> curSpaces<span class="token punctuation">;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>maxWidth <span class="token operator">-</span> allLength <span class="token operator">-</span> temp<span class="token punctuation">)</span><span class="token operator">%</span> <span class="token punctuation">(</span>index<span class="token operator">+</span>size<span class="token operator">-</span>k<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token punctuation">(</span>maxWidth <span class="token operator">-</span> allLength <span class="token operator">-</span> temp<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>index<span class="token operator">+</span>size<span class="token operator">-</span>k<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   str<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   curSpaces <span class="token operator">++</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token punctuation">(</span>maxWidth <span class="token operator">-</span> allLength <span class="token operator">-</span> temp<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>index<span class="token operator">+</span>size<span class="token operator">-</span>k<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   str<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   curSpaces<span class="token operator">++</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       str<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>index<span class="token operator">+</span>size<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210909114750596.png" alt="image-20210909114750596"></p><p>è¿™é“é¢˜åšèµ·æ¥çœŸçš„è¿˜æ˜¯å¾ˆæ…¢ï¼Œ1hâ€¦å‰å‰ååå¤ªå¤šå°é”™è¯¯æ²¡æœ‰é¡¾å¿Œåˆ°ï¼Œå¦å¤–Stringçš„é•¿åº¦æ˜¯length()è€Œä¸æ˜¯lengthâ€¦</p><p>StringBuilderå¤„å¯ä¼˜åŒ–</p><p>ä¹Ÿæä¾›äº†ä¸€ç§è§£é¢˜æ€è·¯å§ï¼Œä»¥åé¢å¯¹è¿™ç§æ­¥éª¤æ€§å¼ºçš„é¢˜ï¼Œè‡ªå·±å¯ä»¥åˆ†æˆå‡ æ­¥ï¼Œç„¶ååˆ†æ­¥è§£å†³ï¼Œæ€è·¯ä¼šæ¸…æ™°å¾ˆå¤šã€‚</p><p>çœ‹äº†é¢˜è§£çš„æ–¹æ³•ï¼Œé€šè¿‡<strong>æ¨¡æ‹Ÿ</strong>ï¼Œ<strong>åˆ—ä¸¾å‡ºå„ç§æƒ…å†µ</strong>ï¼Œ<strong>å¯¹è¿™äº›æƒ…å†µä¸€ä¸€è®¨è®º</strong>ï¼Œå’Œæˆ‘è¿™é‡Œçš„æ€è·¯æ¯”è¾ƒç›¸ä¼¼ï¼Œä¸è¿‡åœ¨å¤„ç†å¤šä¸ªå•è¯ä¸Šï¼Œä»–çš„åšæ³•æ›´å¥½</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210909120051637.png" alt="image-20210909120051637"></p><p>è¿™é‡Œå­¦ä¹ ä¸€ä¸‹è¿™ç§æ–¹æ³•â€¦</p><h2 id="69-x-çš„å¹³æ–¹æ ¹-â­">69. x çš„å¹³æ–¹æ ¹ â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-math">NewTon Iteration</div><div class="code-tag-label code-tag-label-binary">Binary</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220405111251379.png" alt="image-20220405111251379"></p><h3 id="ç‰›é¡¿è¿­ä»£æ³•ï¼š">ç‰›é¡¿è¿­ä»£æ³•ï¼š</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">sqrtByNewton</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">long</span> i<span class="token operator">=</span>x<span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span>i<span class="token operator">*</span>i<span class="token operator">></span>x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        i<span class="token operator">=</span><span class="token punctuation">(</span>i<span class="token operator">+</span>x<span class="token operator">/</span>i<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>i<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201009180452249.png" alt="image-20201009180452249"></p><h3 id="äºŒåˆ†æ³•">äºŒåˆ†æ³•:</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">sqrtWithBinary</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token keyword">long</span> result<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>     <span class="token keyword">long</span> left<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>right<span class="token operator">=</span>x<span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>mid<span class="token punctuation">;</span>     <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>         mid<span class="token operator">=</span><span class="token punctuation">(</span>right<span class="token operator">+</span>left<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>         <span class="token keyword">if</span><span class="token punctuation">(</span>mid<span class="token operator">*</span>mid<span class="token operator">></span>x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>             right<span class="token operator">=</span>mid<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>mid<span class="token operator">*</span>mid<span class="token operator">&lt;</span>x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>             left<span class="token operator">=</span>mid<span class="token punctuation">;</span>             result<span class="token operator">=</span>mid<span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>             <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>mid<span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>         <span class="token keyword">if</span><span class="token punctuation">(</span>left<span class="token operator">>=</span>right<span class="token punctuation">)</span>             <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>right<span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span>    <span class="token comment">/*    åˆ†æï¼š æ­¤å¤„mid=(right+left+1)/2; å¿…é¡»æ˜¯åœ¨å³ä¸­éƒ¨ã€‚å› ä¸ºåœ¨å·¦ä¸­éƒ¨å®¹æ˜“å‡ºç°æ— é™å¾ªç¯çš„ç°è±¡    */</span> <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201009180734101.png" alt="image-20201009180734101"></p><h3 id="ç”¨é™¤æ³•é¿å…-int-æº¢å‡ºçš„æƒ…å†µ">ç”¨é™¤æ³•é¿å… int æº¢å‡ºçš„æƒ…å†µ</h3><p>ç”¨ int å‹æµ‹è¯•è¾ƒå¤§æ•°å­—æ—¶ï¼Œ ç”±äº i*i å¯èƒ½æº¢å‡ºï¼Œæ‰€ä»¥ éœ€è¦æå‰è®¾ç½®ä¸ºlong å‹ ï¼Œè€Œåå¼ºè½¬ä¸º int</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java">    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">mySqrt</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">==</span><span class="token number">1</span><span class="token operator">||</span>x<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">return</span> x<span class="token punctuation">;</span>        <span class="token keyword">int</span> left<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>right<span class="token operator">=</span>x<span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>left<span class="token operator">&lt;</span>right<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> mid<span class="token operator">=</span>left<span class="token operator">+</span><span class="token punctuation">(</span>right<span class="token operator">-</span>left<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">/</span>mid<span class="token operator">==</span>mid<span class="token operator">||</span><span class="token punctuation">(</span>x<span class="token operator">/</span>mid<span class="token operator">></span>mid<span class="token operator">&amp;&amp;</span>x<span class="token operator">/</span><span class="token punctuation">(</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token punctuation">(</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//åˆšå¥½</span>                <span class="token keyword">return</span> mid<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">/</span>mid<span class="token operator">></span>mid<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//midæ¯”æ ¹å°</span>                left<span class="token operator">=</span>mid<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token comment">//midæ¯”æ ¹å¤§</span>                right<span class="token operator">=</span>mid<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><h2 id="75-é¢œè‰²åˆ†ç±»-â­â­">75. é¢œè‰²åˆ†ç±» â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-foreach">Double Pointer</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220115145212197.png" alt="image-20220115145212197"></p><h3 id="å®¡é¢˜-v11">å®¡é¢˜</h3><ul><li>åŸåœ°æ’åºï¼Œè¿”å›çš„è¿˜æ˜¯åŸæ¥çš„æ•°ç»„</li><li>æƒ³æ³•ï¼šä¸‰æŒ‡é’ˆæ ‡è¯†å½“å‰ä½ç½®.éš¾ç‚¹ï¼šå‰æ®µçš„æ’å…¥ä¼šå¯¼è‡´åä¸€æ®µå‘åç§»åŠ¨ã€‚æƒ³æ³•å˜æ›´ï¼šå…ˆç»Ÿè®¡æ¬¡æ•°ï¼Œç„¶åæå‰è®¾ç½®å¥½åˆ†ç•Œç‚¹</li></ul><h3 id="1-é¡ºåºç§»ä½ï¼ˆXï¼‰">1. é¡ºåºç§»ä½ï¼ˆXï¼‰</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span>  <span class="token keyword">void</span> <span class="token function">sortColors</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> color <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token keyword">int</span> temp <span class="token operator">=</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           color<span class="token punctuation">[</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cntColor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token keyword">while</span><span class="token punctuation">(</span>i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           temp <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>cntColor<span class="token punctuation">[</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">==</span> color<span class="token punctuation">[</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               i<span class="token operator">++</span><span class="token punctuation">;</span>               <span class="token keyword">continue</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">int</span> min<span class="token punctuation">,</span>max<span class="token punctuation">,</span>k<span class="token punctuation">;</span>           min <span class="token operator">=</span> max <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>           <span class="token keyword">for</span><span class="token punctuation">(</span>k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               min <span class="token operator">+=</span> color<span class="token punctuation">[</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           max <span class="token operator">=</span> min <span class="token operator">+</span> color<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">&lt;</span> max <span class="token operator">&amp;&amp;</span> i <span class="token operator">>=</span> min<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               i<span class="token operator">++</span><span class="token punctuation">;</span>               <span class="token keyword">continue</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">int</span> total <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>           <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> z <span class="token operator">&lt;</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> z<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               total <span class="token operator">+=</span> color<span class="token punctuation">[</span>z<span class="token punctuation">]</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>cntColor<span class="token punctuation">[</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">+</span> total<span class="token punctuation">]</span><span class="token punctuation">;</span>           nums<span class="token punctuation">[</span>cntColor<span class="token punctuation">[</span>temp<span class="token punctuation">]</span> <span class="token operator">+</span> total<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>           cntColor<span class="token punctuation">[</span>temp<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">>=</span> max <span class="token operator">||</span> i <span class="token operator">&lt;</span> min<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token keyword">continue</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           i<span class="token operator">++</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span></code></pre></div><p>é€šè¿‡ç”¨ä¾‹ 85/87â€¦</p><p>åŸºäºä¸‰æŒ‡é’ˆ</p><h3 id="2-å•æŒ‡é’ˆâ€“å¤šè¶Ÿï¼ˆRï¼‰">2. å•æŒ‡é’ˆâ€“å¤šè¶Ÿï¼ˆRï¼‰</h3><p>åˆ©ç”¨å•æŒ‡é’ˆï¼Œå…ˆä¸€éå°†0æ’å¥½ï¼Œå†å°†1æ’å¥½ï¼Œåœ¨LogNçš„æ—¶é—´å¤æ‚åº¦å†…è§£å†³é—®é¢˜ã€‚è¦æ³¨æ„ptrç©¶ç«Ÿä»£è¡¨äº†ä»€ä¹ˆ â€”&gt; å½“å‰æœ€å°æ•°å­—çš„æœ€è¿œç´¢å¼•</p><div class="note note-primary">            <p>ä¸è¦å°ç§è¿™ç§åœ¨LogNçš„å¤æ‚åº¦å†…å¤šæ¬¡éå†çš„æƒ…å†µï¼Œå› ä¸ºæœ€ç»ˆä¹Ÿä»£è¡¨äº†LogNçš„å¤æ‚åº¦</p>          </div><h3 id="3-åŒæŒ‡é’ˆï¼ˆRï¼‰">3. åŒæŒ‡é’ˆï¼ˆRï¼‰</h3><p>é’ˆå¯¹0 å’Œ 1çš„é¡ºåºåŒæŒ‡é’ˆ</p><p>æ³¨æ„ï¼šææ¸…æ¥šP1 å’Œ P2åˆ°åº•æŒ‡å‘ä»€ä¹ˆâ€”&gt; å¼€å§‹å¤„é‚£ä¹ˆæˆ‘ä»¬å¯èƒ½ä¼šæŠŠä¸€ä¸ª 1 äº¤æ¢å‡ºå»ã€‚å½“ p_0 &lt; p_1æ—¶ï¼Œæˆ‘ä»¬å·²ç»å°†ä¸€äº› 1è¿ç»­åœ°æ”¾åœ¨å¤´éƒ¨ï¼Œæ­¤æ—¶ä¸€å®šä¼šæŠŠä¸€ä¸ª 1äº¤æ¢å‡ºå»ï¼Œå¯¼è‡´ç­”æ¡ˆé”™è¯¯</p><h3 id="4-åŒæŒ‡é’ˆï¼ˆRï¼‰">4. åŒæŒ‡é’ˆï¼ˆRï¼‰</h3><p>é’ˆå¯¹0 å’Œ 2 çš„ç›¸å‘åŒæŒ‡é’ˆ</p><p>ç›¸æ¯”ä¹‹å‰çš„åšæ³•ï¼Œä¹Ÿæœ‰éœ€è¦æ³¨æ„çš„ç‚¹ï¼šå³2çš„æŒ‡é’ˆäº¤æ¢iå¤„ä½ç½®åï¼Œè¦è€ƒè™‘äº¤æ¢çš„æ˜¯ä»€ä¹ˆï¼Œä¸èƒ½äº¤æ¢å®Œå°±è¿›è¡Œä¸‹ä¸€å¤„äº¤æ¢äº†ï¼Œå› ä¸ºå¯èƒ½äº¤æ¢ånums[i]çš„å€¼æ˜¯0æˆ–2.æ‰€ä»¥éœ€è¦ä¸åœäº¤æ¢ï¼Œç›´è‡³ä¸ä¸º2.</p><h2 id="104-äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦-â­">104. äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦ â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-recursion">Recursion</div><div class="code-tag-label code-tag-label-tree">Tree</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201013151647518.png" alt="image-20201013151647518"></p><p>æˆ‘çš„ä»£ç ï¼š</p><h3 id="é€’å½’æ³•">é€’å½’æ³•</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">maxDepth</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> root<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">int</span> left<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>right<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">/*    try catch æŠ“nullpointerå¼‚å¸¸ï¼Œé¿å…æŠ¥é”™    */</span>       <span class="token keyword">try</span><span class="token punctuation">&#123;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>left<span class="token operator">==</span><span class="token keyword">null</span><span class="token operator">&amp;&amp;</span>root<span class="token punctuation">.</span>right<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       left<span class="token operator">=</span> <span class="token number">1</span><span class="token operator">+</span><span class="token function">maxDepth</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>    right<span class="token operator">=</span> <span class="token number">1</span><span class="token operator">+</span><span class="token function">maxDepth</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">NullPointerException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> left<span class="token operator">></span>right<span class="token operator">?</span>left<span class="token operator">:</span>right<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201013151715852.png" alt="image-20201013151715852"></p><h3 id="æ€è€ƒ-v12">æ€è€ƒ</h3><ul><li><p>åˆ¤æ–­ Null å‹å¯¹è±¡ä»¥å è¿˜æ˜¯åŠ ä¸Štry -catch è¯­å¥æ›´å¥½</p></li><li><p>å­¦ä¼šä½¿ç”¨</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java">left<span class="token operator">=</span> <span class="token number">1</span><span class="token operator">+</span><span class="token function">maxDepth</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>right<span class="token operator">=</span> <span class="token number">1</span><span class="token operator">+</span><span class="token function">maxDepth</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p>ç±»çš„é€’å½’æ–¹æ³•</p></li></ul><hr><h2 id="105-å‰ä¸­åºæ„é€ äºŒå‰æ ‘-â­â­">105. å‰ä¸­åºæ„é€ äºŒå‰æ ‘ â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><div class="code-tag-label code-tag-label-stack">Stack</div><div class="code-tag-label code-tag-label-hash">Hash</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210409123330409.png" alt="image-20210409123330409"></p><h3 id="æ€è·¯-v4">æ€è·¯</h3><p>é€’å½’  node.left = â€¦</p><h3 id="1-My-é€’å½’">1. My é€’å½’</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">TreeNode</span> <span class="token function">buildTree</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> preorder<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> inorder<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token function">addLR</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>preorder<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">TreeNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>preorder<span class="token punctuation">,</span>inorder<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">TreeNode</span> <span class="token function">addLR</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span><span class="token keyword">int</span> r<span class="token punctuation">,</span><span class="token class-name">TreeNode</span> node<span class="token punctuation">,</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> preorder<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> inorder<span class="token punctuation">,</span><span class="token keyword">int</span> i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>l<span class="token operator">></span>r<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>l<span class="token operator">==</span>r<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TreeNode</span><span class="token punctuation">(</span>inorder<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token function">lookForPre</span><span class="token punctuation">(</span>preorder<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>inorder<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>node <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>            node <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TreeNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        node<span class="token punctuation">.</span>val <span class="token operator">=</span> inorder<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>        node<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token function">addLR</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>index<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>node<span class="token punctuation">.</span>left<span class="token punctuation">,</span>preorder<span class="token punctuation">,</span>inorder<span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        node<span class="token punctuation">.</span>right <span class="token operator">=</span> <span class="token function">addLR</span><span class="token punctuation">(</span>index<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>node<span class="token punctuation">.</span>right<span class="token punctuation">,</span>preorder<span class="token punctuation">,</span>inorder<span class="token punctuation">,</span>i<span class="token operator">+</span>index<span class="token operator">-</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> node<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">lookForPre</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> inorder<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> j<span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>j <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>inorder<span class="token punctuation">.</span>length<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>num <span class="token operator">==</span> inorder<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token keyword">return</span> j<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210409123449155.png" alt="image-20210409123449155"></p><p>æ—¶é—´å¤æ‚åº¦ Onï¼Ÿ  ç©ºé—´å¤æ‚åº¦ On</p><h3 id="2-hashmapçš„å°æ”¹è¿›">2. hashmapçš„å°æ”¹è¿›</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> hashMap<span class="token punctuation">;</span>   <span class="token keyword">public</span> <span class="token class-name">TreeNode</span> <span class="token function">buildTree</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> preorder<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> inorder<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       hashMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>preorder<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>inorder<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> <span class="token function">addLR</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>preorder<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">TreeNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>preorder<span class="token punctuation">,</span>inorder<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">public</span> <span class="token class-name">TreeNode</span> <span class="token function">addLR</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span><span class="token keyword">int</span> r<span class="token punctuation">,</span><span class="token class-name">TreeNode</span> node<span class="token punctuation">,</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> preorder<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> inorder<span class="token punctuation">,</span><span class="token keyword">int</span> i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>l<span class="token operator">></span>r<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>l<span class="token operator">==</span>r<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TreeNode</span><span class="token punctuation">(</span>inorder<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token function">lookForPre</span><span class="token punctuation">(</span>preorder<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>node <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>           node <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TreeNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       node<span class="token punctuation">.</span>val <span class="token operator">=</span> inorder<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>       node<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token function">addLR</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>index<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>node<span class="token punctuation">.</span>left<span class="token punctuation">,</span>preorder<span class="token punctuation">,</span>inorder<span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       node<span class="token punctuation">.</span>right <span class="token operator">=</span> <span class="token function">addLR</span><span class="token punctuation">(</span>index<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>r<span class="token punctuation">,</span>node<span class="token punctuation">.</span>right<span class="token punctuation">,</span>preorder<span class="token punctuation">,</span>inorder<span class="token punctuation">,</span>i<span class="token operator">+</span>index<span class="token operator">-</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">return</span> node<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">lookForPre</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>          <span class="token keyword">return</span> hashMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p>hashmapå¢åŠ äº†Onçš„å ç”¨ç©ºé—´ä½†åœ¨get numåœ¨ä¸­åºæ•°ç»„ä¸­çš„ä½ç½®æ—¶éå¸¸å¿«â€¦</p><p><strong>çœ‹æ¥hashmapåœ¨ç®—æ³•é¢˜ä¸­è¿˜æ˜¯å¾ˆé‡è¦ï¼Œè®¾è®¡åˆ°forå¾ªç¯æŸ¥æ‰¾æ—¶è¿˜æ˜¯è¦è€ƒè™‘ä¸€ä¸‹</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210409124022095.png" alt="image-20210409124022095"></p><h3 id="3-è¿­ä»£-æ ˆ">3. è¿­ä»£ + æ ˆ</h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210409124118335.png" alt="image-20210409124118335"></p><p>ä¹Ÿæ˜¯ç±»ä¼¼é˜¿é‡Œæ ˆç®—æ³•çš„é‚£é“é¢˜ï¼Œæ¯”è¾ƒéš¾æƒ³â€¦</p><h2 id="121-ä¹°å–è‚¡ç¥¨-â­">121. ä¹°å–è‚¡ç¥¨ â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><div class="code-tag-label code-tag-label-dp">DP</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201007090522974.png" alt="image-20201007090522974"></p><p>æˆ‘çš„ä»£ç ï¼š</p><h3 id="æš´åŠ›æ³•">æš´åŠ›æ³•</h3><ol><li><div class="code-wrapper"><pre><code class="language-java">//æš´åŠ›æ³•ï¼š    foräºŒé‡å¾ªç¯ ä¸¤æŒ‡é’ˆç´¢å¼• éå†    //ç¼ºç‚¹ ï¼š æ—¶é—´æ…¢ï¼Œ æœ‰é‡å¤è®¡ç®—           //æ—¶é—´å¤æ‚åº¦ï¼š  O(n^2)  ç©ºé—´å¤æ‚åº¦ O(1)--ä¸€ä¸ªå¸¸é‡public static int maxProfit(int[] prices) &#123;        int max=0;        for(int i=0;i&lt;prices.length;i++)&#123;            for(int j=prices.length-1;j&gt;i;j--)&#123;                if(prices[j]-prices[i]&gt;max) &#123;                    max = prices[j] - prices[i];                &#125;            &#125;        &#125;        return max;    &#125;<pre class="language-none"><code class="language-none">   ![image-20201007090734202](https:&#x2F;&#x2F;s401177923-1302493622.cos.ap-nanjing.myqcloud.com&#x2F;mdImages&#x2F;image-20201007090734202.png)### åŠ¨æ€è§„åˆ’&#96;&#96;&#96;java&#x2F;&#x2F;åŠ¨æ€è§„åˆ’  ä¸€æ¬¡éå†&#x2F;&#x2F;åŸå› ï¼š  ä¹°å…¥çš„ è‚¡ç¥¨ä»·æ ¼æ€»æ˜¯åœ¨æœ€å‰é¢ï¼ï¼ï¼&#x2F;&#x2F;æ—¶é—´å¤æ‚åº¦ï¼š O(n)  ç©ºé—´å¤æ‚åº¦ O(1)--ä¸¤ä¸ªå¸¸é‡public static int maxProfit_2(int[] prices) &#123;        int max&#x3D;0,min&#x3D;Integer.MAX_VALUE;        for(int i&#x3D;0;i&lt;prices.length;i++)&#123;           if(prices[i]&lt;min)                min&#x3D;prices[i];            else if(prices[i]-min&gt;max)&#x2F;&#x2F;è¿™ä¸€æ­¥å¾ˆé‡è¦                max&#x3D;prices[i]-min;        &#125;        return max;    &#125;</code></pre></div></code></pre></li></ol><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201007092356306.png" alt="image-20201007092356306"></p><hr><h2 id="134-åŠ æ²¹ç«™-â­â­">134. åŠ æ²¹ç«™ â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><div class="code-tag-label code-tag-label-math">Math</div><p>åœ¨æ‰€æ±‚ç‚¹åçš„è¿‡ç¨‹é‡ &gt;= 0 çš„æƒ…å†µ</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220228202154091.png" alt="image-20220228202154091"></p><h3 id="å®¡é¢˜-v12">å®¡é¢˜</h3><ul><li>æ²¹ç®±å®¹é‡æ˜¯æ— é™çš„ï¼Œå¼€å§‹æ²¹ç®±ä¸ºç©º ï¼› è‹¥å­˜åœ¨è§£ åˆ™è§£å”¯ä¸€ã€</li><li>å¯èƒ½çš„æ•°æ®ç»“æ„ï¼š</li><li>å¯èƒ½çš„ç®—æ³•ï¼šè¿­ä»£ï¼ŸåŠ¨æ€è§„åˆ’ï¼Ÿ</li><li>å…ˆå°è¯•æœ€ç®€å•çš„ï¼šä¾æ¬¡å¾ªç¯</li></ul><h3 id="1-æš´åŠ›è¿­ä»£-v2">1. æš´åŠ›è¿­ä»£</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">canCompleteCircuit</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> gas<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cost<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> res <span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> gas<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> gas<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">+</span> j <span class="token operator">>=</span> gas<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    res <span class="token operator">+=</span> gas<span class="token punctuation">[</span>i <span class="token operator">+</span> j <span class="token operator">-</span> gas<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>                    res <span class="token operator">-=</span> cost<span class="token punctuation">[</span>i <span class="token operator">+</span> j<span class="token operator">-</span> gas<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                    res <span class="token operator">+=</span> gas<span class="token punctuation">[</span>i <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span>                    res <span class="token operator">-=</span> cost<span class="token punctuation">[</span>i <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>res <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>res <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> i<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p>ç†æ‰€åº”å½“çš„è¶…æ—¶â€¦</p><p>ç¨ç¨ä¼˜åŒ–ï¼štemp[i] = gas[i] - cost[i];</p><h3 id="2-ä¸€æ¬¡éå†">2. ä¸€æ¬¡éå†</h3><p>ææ±å·¨èªæ˜ï¼Œæ ¸å¿ƒè¿˜æ˜¯ä¸¤ä¸ªæ•°ç»„å·®å€¼ç»„æˆçš„æ–°æ•°ç»„åˆ°è¾¾æŸä¸€é™åº¦çš„åˆ¤å®šé—®é¢˜ã€‚æ ¸å¿ƒï¼š</p><ul><li>beforeï¼šç®¡ä¹‹å‰æ²¡æœ‰è¾¾æ ‡çš„é‚£ä¸€éƒ¨åˆ†æ•°ï¼Œå°±ä¸ç”¨ä¹‹åå†å›å½’å¤´ç®—ä¸€æ¬¡äº†</li><li>resï¼šç®¡å½“å‰å¯èƒ½çš„ç´¯è®¡å’Œï¼Œæœ‰å¯èƒ½ä¸ä¼š&lt;0ï¼Œä¹Ÿå¯èƒ½&lt;0ã€‚å¦‚æœ&lt;0ï¼Œåˆ™å°±éœ€è¦ç´¯åŠ åˆ°beforeä¸Šå¹¶æ¸…é›¶è¿™ä¸ªres</li><li>è‹¥æœ€ç»ˆbefore  + res &lt; 0 åˆ™ä¸å­˜åœ¨è¿™æ ·çš„ç‚¹ï¼Œå› ä¸ºéå†äº†æ‰€æœ‰çš„ç‚¹éƒ½ä¸è¡Œ</li></ul><p>è¿™é‡Œæˆ‘ä¼˜åŒ–äº†ä¸€ä¸‹ï¼š</p><ul><li>èƒ½å¤Ÿåˆ°è¾¾åŠ æ²¹ç«™çš„å¿…è¦æ¡ä»¶ï¼šå·®å€¼æ•°ç»„å’Œå¿…é¡»å¤§äº0</li></ul><p>è¿™é‡Œå•ç‹¬æŠŠå·®å€¼æ•°ç»„æå‰ç®—å‡ºæ¥æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œæµªè´¹äº†Onçš„ç©ºé—´ï¼Œæ‰€æœ‰ç»“æœçš„ç©ºé—´å¤æ‚åº¦è¿™ä¹ˆé«˜ï¼Œå…¶ä½™çš„è¯åº”è¯¥éƒ½æ˜¯æœ€ä¼˜çš„ã€‚</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">canCompleteCircuit</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> gas<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cost<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">int</span> n <span class="token operator">=</span> gas<span class="token punctuation">.</span>length<span class="token punctuation">;</span>       <span class="token keyword">int</span> res<span class="token punctuation">;</span>       <span class="token keyword">int</span> before <span class="token punctuation">;</span>       <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> temp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> gas<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> cost<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           sum <span class="token operator">+=</span> temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>sum <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>           <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>       before <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> res <span class="token operator">+</span> temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token keyword">if</span><span class="token punctuation">(</span>res <span class="token operator">+</span> temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                   before <span class="token operator">+=</span> res <span class="token operator">+</span> temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>                   res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                   index <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>               res <span class="token operator">+=</span> temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>res <span class="token operator">+</span> before <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>           <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>       <span class="token keyword">return</span> index<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220301213651013.png" alt="image-20220301213651013"></p><p>è§£å†³ä¸€ä¸ªè‡ªå·±å¾ˆè ¢çš„é—®é¢˜ï¼š<br>æ•°ç»„è¶…å‡ºé•¿åº¦åå›åˆ°å¤´éƒ¨ï¼š(i+cnt)%arr.lengthâ€¦ä¸è¦å†ç”¨ä»€ä¹ˆif elseåˆ¤æ–­äº†</p><h3 id="3-æŠ˜çº¿å›¾çš„æ€æƒ³">3. æŠ˜çº¿å›¾çš„æ€æƒ³</h3><p>ä¸€ç§å¾ˆå·§å¦™çš„æ–¹æ³•ï¼Œä¹Ÿæ˜¯ä¸å®¹æ˜“æƒ³é€šçš„ã€‚æ‰¾å‡ºå·®å€¼çš„æœ€å°å€¼ç‚¹ï¼ŒæŠ˜çº¿å›¾è¡¨ç¤ºçš„æ˜¯ä»¥0åŠ æ²¹ç«™ä¸ºèµ·ç‚¹çš„ï¼ˆåœ¨0åŠ æ²¹ç«™æ—¶æ²¡åŠ æ²¹ä¹Ÿæ²¡è€—æ²¹ï¼‰æ²¹è€—æƒ…å†µï¼Œç»¿è‰²ä»£è¡¨gas é»„è‰²ä»£è¡¨costã€‚</p><p>æŠ˜çº¿å›¾è¡¨ç¤ºçš„è‚¯å®šæ˜¯ä¸€ä¸ªæˆ–è€…å¤šä¸ªVå½¢çš„èµ°åŠ¿ï¼Œé‚£åªéœ€è¦æŠŠæœ€å°çš„é‚£ä¸ªç‚¹æ‰¾å‡ºæ¥ï¼Œä»¥é‚£ä¸ªç‚¹çš„ä¸‹ä¸€ä¸ªç«™ä¸ºèµ·ç‚¹ï¼Œåœ¨<strong>æœ€ç»ˆæ²¹é‡å‰©ä½™é‡ &gt;= 0</strong>çš„æƒ…å†µä¸‹ï¼Œè‚¯å®šè¿‡ç¨‹æ²¹é‡çš„&gt;=0çš„ï¼ˆå› ä¸ºå›¾çš„èµ·ç‚¹ä¸ä¸€æ ·äº†ï¼Œä»¥é‚£ä¸ªç«™ç‚¹ä¸ºèµ·ç‚¹ï¼Œåˆ™ä¸å¯èƒ½å†å‡ºç°Xè½´çš„æƒ…å†µï¼‰ <strong>å¯ä»¥ç†è§£æ˜¯æŠŠå›¾åƒç«–ç›´å¹³ç§»å†æ°´å¹³å¹³ç§»ï¼ˆæ›´æ¢äº†ç«™ç‚¹ï¼‰</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220301221158225.png" alt="image-20220301221158225"></p><blockquote><p>å›¾æ‘˜è‡ªé“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/gas-station/solution/shi-yong-tu-de-si-xiang-fen-xi-gai-wen-ti-by-cyayc/">https://leetcode-cn.com/problems/gas-station/solution/shi-yong-tu-de-si-xiang-fen-xi-gai-wen-ti-by-cyayc/</a></p></blockquote><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">canCompleteCircuit</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> gas<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cost<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> len <span class="token operator">=</span> gas<span class="token punctuation">.</span>length<span class="token punctuation">;</span>    <span class="token keyword">int</span> spare <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> minSpare <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>    <span class="token keyword">int</span> minIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        spare <span class="token operator">+=</span> gas<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> cost<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>spare <span class="token operator">&lt;</span> minSpare<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            minSpare <span class="token operator">=</span> spare<span class="token punctuation">;</span>            minIndex <span class="token operator">=</span> i<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> spare <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">:</span> <span class="token punctuation">(</span>minIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> len<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// ä½œè€…ï¼šcyaycz</span><span class="token comment">// é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/gas-station/solution/shi-yong-tu-de-si-xiang-fen-xi-gai-wen-ti-by-cyayc/ã€‚</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220301221650883.png" alt="image-20220301221650883"></p><p>ä½œè€…çš„ç»“æœæ˜¾ç¤ºå†…å­˜æ¶ˆè€—ä¸º 72%ï¼Œå¯èƒ½æœ‰è¯¯å·®ï¼Œä½†è¿™ç¡®å®ä¹Ÿä»å›¾åƒçš„æ–¹å‘ä¸Šæä¾›äº†ä¸€ä¸ªéå¸¸å¥½çš„æ€è·¯</p><h2 id="137-åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—II-â­">137. åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—II â­</h2><p>åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—I -----</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220504190821760.png" alt="image-20220504190821760"></p><h3 id="å®¡é¢˜-v13">å®¡é¢˜</h3><h3 id="1-Hash-Listç¼“å­˜">1. Hash + Listç¼“å­˜</h3><p>è¿™ä¸ªåšæ³•æ²»æ ‡ä¸æ²»æœ¬ï¼Œå› ä¸ºä»–å¹¶æ²¡æœ‰åŒºåˆ†æ˜¯å…¶ä»–æ•°å­—éƒ½é‡å¤äº†ä¸‰æ¬¡ï¼Œå¦‚æœå…¶ä»–æ•°å­—é‡å¤äº†Næ¬¡ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è¿™ä¸ªåšæ³•æ¥ç®—ï¼Œæ‰€ä»¥ä»–ä¸å¤ªå¯èƒ½æ˜¯é’ˆå¯¹å½“å‰ç®—æ³•çš„æœ€å¥½è§£æ³•ï¼Œåªèƒ½è¯´æ˜¯é€šè§£</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">singleNumber</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> temp <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">++</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span>list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>O(2N)çš„æ—¶é—´å¤æ‚åº¦ O(N)çš„ç©ºé—´å¤æ‚åº¦ã€‚ç›´æ¥éå†Hashè¡¨çš„é”®å€¼å¯¹ä¹Ÿå¯ä»¥ï¼Œè¿™æ ·ç©ºé—´å¤æ‚åº¦èƒ½æåˆ°70%</p><p><img src="/home/pplong/.config/Typora/typora-user-images/image-20220504192025161.png" alt="image-20220504192025161"></p><h3 id="2-æœ‰é™çŠ¶æ€è‡ªåŠ¨æœºï¼ˆè½¬ï¼‰">2. æœ‰é™çŠ¶æ€è‡ªåŠ¨æœºï¼ˆè½¬ï¼‰</h3><h2 id="146-LRUç¼“å­˜-â­â­">146. LRUç¼“å­˜ â­â­</h2><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210411092859009.png" alt="image-20210411092859009"></p><h3 id="æ€è€ƒ-v13">æ€è€ƒ</h3><p>get å’Œ putçš„æ–¹æ³•è¯´æ˜</p><h3 id="1-My-LruHashMap">1. My LruHashMap</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Node</span> <span class="token punctuation">&#123;</span>       <span class="token class-name">Node</span> next<span class="token punctuation">,</span>prev<span class="token punctuation">;</span>       <span class="token keyword">int</span> key<span class="token punctuation">;</span>       <span class="token keyword">int</span> value<span class="token punctuation">;</span>       <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token keyword">int</span> key<span class="token punctuation">,</span><span class="token keyword">int</span> value<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">this</span><span class="token punctuation">.</span>key <span class="token operator">=</span> key<span class="token punctuation">;</span>           <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">private</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">Node</span><span class="token punctuation">></span></span> cache<span class="token punctuation">;</span>   <span class="token keyword">private</span>  <span class="token keyword">int</span> size<span class="token punctuation">;</span>   <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token class-name">MaxSize</span><span class="token punctuation">;</span>   <span class="token keyword">private</span> <span class="token class-name">Node</span> head<span class="token punctuation">,</span>tail<span class="token punctuation">;</span>   <span class="token keyword">public</span> <span class="token class-name">LRUCache</span><span class="token punctuation">(</span><span class="token keyword">int</span> capacity<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token class-name">MaxSize</span> <span class="token operator">=</span> capacity<span class="token punctuation">;</span>       head <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       tail <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       tail<span class="token punctuation">.</span>prev  <span class="token operator">=</span> head<span class="token punctuation">;</span>       head<span class="token punctuation">.</span>next <span class="token operator">=</span> tail<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> key<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token class-name">Node</span> res <span class="token operator">=</span> cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>res <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token function">addToTail</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">return</span> res<span class="token punctuation">.</span>value<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token keyword">int</span> key<span class="token punctuation">,</span> <span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>size <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token class-name">Node</span> node <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>           head <span class="token operator">=</span> node<span class="token punctuation">;</span>           tail <span class="token operator">=</span> node<span class="token punctuation">;</span>           size<span class="token operator">++</span><span class="token punctuation">;</span>           cache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>           <span class="token class-name">Node</span> temp <span class="token operator">=</span> cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span>temp <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               temp<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>               <span class="token function">addToTail</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>               <span class="token class-name">Node</span> node <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>               cache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> node<span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token function">addNewToTaile</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>               size<span class="token operator">++</span><span class="token punctuation">;</span>               <span class="token keyword">if</span> <span class="token punctuation">(</span>size <span class="token operator">></span> <span class="token class-name">MaxSize</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   <span class="token function">removeEldest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   size<span class="token operator">--</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addNewToTaile</span><span class="token punctuation">(</span><span class="token class-name">Node</span> node<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       node<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>       node<span class="token punctuation">.</span>prev <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>       node<span class="token punctuation">.</span>prev <span class="token operator">=</span> tail<span class="token punctuation">;</span>       tail<span class="token punctuation">.</span>next <span class="token operator">=</span> node<span class="token punctuation">;</span>       tail <span class="token operator">=</span> node<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addToTail</span><span class="token punctuation">(</span><span class="token class-name">Node</span> node<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>head <span class="token operator">==</span> tail<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">return</span> <span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>node <span class="token operator">==</span> tail<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">return</span> <span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>node <span class="token operator">==</span> head<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token class-name">Node</span> temp<span class="token punctuation">;</span>           temp <span class="token operator">=</span> node<span class="token punctuation">.</span>next<span class="token punctuation">;</span>           head <span class="token operator">=</span> temp<span class="token punctuation">;</span>           head<span class="token punctuation">.</span>prev <span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>           <span class="token class-name">Node</span> prev<span class="token punctuation">,</span>next<span class="token punctuation">;</span>           prev <span class="token operator">=</span> node<span class="token punctuation">.</span>prev<span class="token punctuation">;</span>           next <span class="token operator">=</span> node<span class="token punctuation">.</span>next<span class="token punctuation">;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>prev <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               tail <span class="token operator">=</span> node<span class="token punctuation">.</span>next<span class="token punctuation">;</span>               tail<span class="token punctuation">.</span>prev <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>next <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>               node<span class="token punctuation">.</span>prev<span class="token punctuation">.</span>next <span class="token operator">=</span> next<span class="token punctuation">;</span>               node<span class="token punctuation">.</span>next<span class="token punctuation">.</span>prev <span class="token operator">=</span> prev<span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token function">addNewToTaile</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">removeEldest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token class-name">Node</span> temp <span class="token punctuation">;</span>       cache<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>head<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>       temp <span class="token operator">=</span> head<span class="token punctuation">.</span>next<span class="token punctuation">;</span>       head <span class="token operator">=</span> temp<span class="token punctuation">;</span>       head<span class="token punctuation">.</span>prev <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span><span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Node</span> <span class="token punctuation">&#123;</span>       <span class="token class-name">Node</span> next<span class="token punctuation">,</span>prev<span class="token punctuation">;</span>       <span class="token keyword">int</span> key<span class="token punctuation">;</span>       <span class="token keyword">int</span> value<span class="token punctuation">;</span>       <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token keyword">int</span> key<span class="token punctuation">,</span><span class="token keyword">int</span> value<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">this</span><span class="token punctuation">.</span>key <span class="token operator">=</span> key<span class="token punctuation">;</span>           <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">private</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">Node</span><span class="token punctuation">></span></span> cache<span class="token punctuation">;</span>   <span class="token keyword">private</span>  <span class="token keyword">int</span> size<span class="token punctuation">;</span>   <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token class-name">MaxSize</span><span class="token punctuation">;</span>   <span class="token keyword">private</span> <span class="token class-name">Node</span> head<span class="token punctuation">,</span>tail<span class="token punctuation">;</span>   <span class="token keyword">public</span> <span class="token class-name">LRUCache</span><span class="token punctuation">(</span><span class="token keyword">int</span> capacity<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token class-name">MaxSize</span> <span class="token operator">=</span> capacity<span class="token punctuation">;</span>       head <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       tail <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       tail<span class="token punctuation">.</span>prev  <span class="token operator">=</span> head<span class="token punctuation">;</span>       head<span class="token punctuation">.</span>next <span class="token operator">=</span> tail<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> key<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token class-name">Node</span> res <span class="token operator">=</span> cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>res <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token function">addToTail</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">return</span> res<span class="token punctuation">.</span>value<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token keyword">int</span> key<span class="token punctuation">,</span> <span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>size <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token class-name">Node</span> node <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>           head <span class="token operator">=</span> node<span class="token punctuation">;</span>           tail <span class="token operator">=</span> node<span class="token punctuation">;</span>           size<span class="token operator">++</span><span class="token punctuation">;</span>           cache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>           <span class="token class-name">Node</span> temp <span class="token operator">=</span> cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span>temp <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               temp<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>               <span class="token function">addToTail</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>               <span class="token class-name">Node</span> node <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>               cache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> node<span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token function">addNewToTaile</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>               size<span class="token operator">++</span><span class="token punctuation">;</span>               <span class="token keyword">if</span> <span class="token punctuation">(</span>size <span class="token operator">></span> <span class="token class-name">MaxSize</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   <span class="token function">removeEldest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   size<span class="token operator">--</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addNewToTaile</span><span class="token punctuation">(</span><span class="token class-name">Node</span> node<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       node<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>       node<span class="token punctuation">.</span>prev <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>       node<span class="token punctuation">.</span>prev <span class="token operator">=</span> tail<span class="token punctuation">;</span>       tail<span class="token punctuation">.</span>next <span class="token operator">=</span> node<span class="token punctuation">;</span>       tail <span class="token operator">=</span> node<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addToTail</span><span class="token punctuation">(</span><span class="token class-name">Node</span> node<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>head <span class="token operator">==</span> tail<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">return</span> <span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>node <span class="token operator">==</span> tail<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">return</span> <span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>node <span class="token operator">==</span> head<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token class-name">Node</span> temp<span class="token punctuation">;</span>           temp <span class="token operator">=</span> node<span class="token punctuation">.</span>next<span class="token punctuation">;</span>           head <span class="token operator">=</span> temp<span class="token punctuation">;</span>           head<span class="token punctuation">.</span>prev <span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>           <span class="token class-name">Node</span> prev<span class="token punctuation">,</span>next<span class="token punctuation">;</span>           prev <span class="token operator">=</span> node<span class="token punctuation">.</span>prev<span class="token punctuation">;</span>           next <span class="token operator">=</span> node<span class="token punctuation">.</span>next<span class="token punctuation">;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>prev <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               tail <span class="token operator">=</span> node<span class="token punctuation">.</span>next<span class="token punctuation">;</span>               tail<span class="token punctuation">.</span>prev <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>next <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>               node<span class="token punctuation">.</span>prev<span class="token punctuation">.</span>next <span class="token operator">=</span> next<span class="token punctuation">;</span>               node<span class="token punctuation">.</span>next<span class="token punctuation">.</span>prev <span class="token operator">=</span> prev<span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token function">addNewToTaile</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">removeEldest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token class-name">Node</span> temp <span class="token punctuation">;</span>       cache<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>head<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>       temp <span class="token operator">=</span> head<span class="token punctuation">.</span>next<span class="token punctuation">;</span>       head <span class="token operator">=</span> temp<span class="token punctuation">;</span>       head<span class="token punctuation">.</span>prev <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p>æ ¹æ®LinkedHashMap è€Œæ¥ â€” å†…éƒ¨èŠ‚ç‚¹å‰åæŒ‡é’ˆï¼Œå¹¶ä¸”å­˜å‚¨é€šè¿‡ Key,Node&lt;Key,Value&gt;å­˜</p><p>æ³¨æ„<strong>ç‰¹æ®Šæƒ…å†µåˆ¤æ–­</strong>ï¼ˆè¿™é‡Œä¸€ä¸ªbugå¡äº†å¾ˆä¹…å¾ˆä¹…ï¼‰ï¼Œæ³¨æ„æ’å…¥ æ—¶å®¹é‡åˆ¤æ–­é—®é¢˜</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210411111403208.png" alt="image-20210411111403208"></p><h2 id="155-æœ€å°æ ˆ-â­">155. æœ€å°æ ˆ â­</h2><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210426175732260.png" alt="image-20210426175732260"></p><h3 id="æ€è€ƒ-v14">æ€è€ƒ</h3><h3 id="1-è‡ªå®šä¹‰">1. è‡ªå®šä¹‰</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">MinStack</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/** initialize your data structure here. */</span>    <span class="token keyword">class</span> <span class="token class-name">Node</span><span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> val<span class="token punctuation">;</span>        <span class="token class-name">Node</span> next<span class="token punctuation">;</span>        <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>val <span class="token operator">=</span> val<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token class-name">Node</span> head<span class="token punctuation">;</span>    <span class="token class-name">Node</span> min<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">MinStack</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        head <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        min <span class="token operator">=</span> head<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Node</span> node <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>        node<span class="token punctuation">.</span>next <span class="token operator">=</span> head<span class="token punctuation">;</span>        head <span class="token operator">=</span> node<span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>min <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            min <span class="token operator">=</span> head<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>min<span class="token punctuation">.</span>val <span class="token operator">></span> val<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            min <span class="token operator">=</span> node<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>head<span class="token punctuation">.</span>val <span class="token operator">==</span> min<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token class-name">Node</span> node <span class="token operator">=</span> head<span class="token punctuation">.</span>next<span class="token punctuation">;</span>            min <span class="token operator">=</span> node<span class="token punctuation">;</span>            <span class="token keyword">while</span><span class="token punctuation">(</span>node <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                min <span class="token operator">=</span> node<span class="token punctuation">.</span>val<span class="token operator">></span>min<span class="token punctuation">.</span>val <span class="token operator">?</span>  min<span class="token operator">:</span>node<span class="token punctuation">;</span>                node <span class="token operator">=</span> node<span class="token punctuation">.</span>next<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        head <span class="token operator">=</span> head<span class="token punctuation">.</span>next<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> head<span class="token punctuation">.</span>val<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getMin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> min<span class="token punctuation">.</span>val<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210426181131420.png" alt="image-20210426181131420"></p><p>æ€è·¯å°±æ˜¯ç»´æŠ¤ä¸€ä¸ªå¤´æŒ‡é’ˆï¼Œå’Œä¸€ä¸ªæœ€å°æŒ‡é’ˆï¼Œåœ¨popæ—¶è¿›è¡Œåˆ¤æ–­ï¼Œè™½ç„¶ä¼šæœ‰å¶å°”çš„Onæ—¶é—´å¤æ‚åº¦ï¼Œä½†æ•´ä½“æ¥è¯´æ˜¯å¥½çš„ã€‚ä»Lruä¸­å­¦åˆ°</p><h2 id="162-å¯»æ‰¾å³°å€¼-â­â­">162. å¯»æ‰¾å³°å€¼ â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><div class="code-tag-label code-tag-label-binary">Binary</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210915162321698.png" alt="image-20210915162321698"></p><h3 id="å®¡é¢˜-v14">å®¡é¢˜</h3><ul><li>ä¸¥æ ¼å¤§äº</li><li>åŒ…å«å¤šä¸ªï¼Œè¿”å›ä»»æ„ä¸€ä¸ª</li><li>æ—¶é—´å¤æ‚åº¦Oï¼ˆlognï¼‰ï¼Œæƒ³åˆ°äº†äºŒåˆ†ï¼Ÿ</li><li>è¿”å›çš„æ˜¯ç´¢å¼•å€¼è€Œä¸æ˜¯å€¼</li></ul><h3 id="1-é¡ºåºåˆ¤æ–­">1. é¡ºåºåˆ¤æ–­</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"> <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">findPeakElement</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">return</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">></span> nums<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">?</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>       <span class="token keyword">while</span><span class="token punctuation">(</span>index <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">></span> nums<span class="token punctuation">[</span>index<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span>               nums<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">></span> nums<span class="token punctuation">[</span>index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   <span class="token keyword">return</span> index<span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">&lt;</span> nums<span class="token punctuation">[</span>index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               index<span class="token operator">++</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>               index <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>nums<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">></span> nums<span class="token punctuation">[</span>nums<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">return</span> nums<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210915184419620.png" alt="image-20210915184419620"></p><p>è¿™é‡Œæˆ‘æœ€å¼€å§‹æƒ³åˆ°äºŒåˆ†æŸ¥æ‰¾ï¼Œä½†æ²¡æƒ³åˆ°å¦‚ä½•äºŒåˆ†ï¼Œindex+=2æœ‰ç‚¹äºŒåˆ†çš„æ„æ€ï¼Œä½†è¿™é‡Œä¸æ»¡è¶³Olognçš„æ—¶é—´å¤æ‚åº¦(ä¾‹å¦‚{1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ï¼Œ6ï¼Œ7})</p><h3 id="2-äºŒåˆ†æŸ¥æ‰¾ï¼ˆè½¬ï¼‰">2. äºŒåˆ†æŸ¥æ‰¾ï¼ˆè½¬ï¼‰</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">findPeakElement</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> right <span class="token operator">=</span> nums<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> left <span class="token operator">&lt;</span> right<span class="token punctuation">;</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> mid <span class="token operator">=</span> left <span class="token operator">+</span> <span class="token punctuation">(</span>right <span class="token operator">-</span> left<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">></span> nums<span class="token punctuation">[</span>mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                right <span class="token operator">=</span> mid<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                left <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> left<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p>ç›®çš„æ˜¯ï¼šåœ¨åŒºé—´å†…æœ‰å³°å€¼</p><p>é¦–å…ˆè¦æ³¨æ„é¢˜ç›®æ¡ä»¶ï¼Œåœ¨é¢˜ç›®æè¿°ä¸­å‡ºç°äº† <strong>nums[-1] = nums[n] = -âˆ</strong>ï¼ˆè¿™æ˜¯å…³é”®ï¼ï¼‰ï¼Œè¿™å°±ä»£è¡¨ç€ åªè¦æ•°ç»„ä¸­å­˜åœ¨ä¸€ä¸ªå…ƒç´ æ¯”ç›¸é‚»å…ƒç´ å¤§ï¼Œé‚£ä¹ˆæ²¿ç€å®ƒä¸€å®šå¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå³°å€¼</p><p>æ„Ÿè§‰è¿˜æ˜¯å®¡é¢˜æ²¡æœ‰ä»”ç»†ã€‚ã€‚ã€‚</p><h2 id="172-é˜¶ä¹˜åçš„é›¶-â­â­">172. é˜¶ä¹˜åçš„é›¶ â­â­</h2><div class="code-tag-time">2022/3/28 21:20:00</div><div class="code-tag-label code-tag-label-math">Math</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220326102711274.png" alt="image-20220326102711274"></p><h3 id="å®¡é¢˜-v15">å®¡é¢˜</h3><ul><li>è¿”å›çš„æ˜¯ç»“æœä¸­å«æœ‰çš„é›¶çš„ä¸ªæ•°ï¼ˆ0ä¸ç®—ï¼Œè¦å°¾éšï¼‰</li><li>æ•°å­¦å±‚é¢ï¼š<ul><li>2 * 5 = 0</li></ul></li><li>æ€è·¯ï¼š<ul><li>ç›´æ¥ï¼šç®—å‡ºæ•°ï¼Œç„¶åä¾æ¬¡ / 10  % 10çœ‹0çš„ä¸ªæ•°ã€‚ä¸è¡Œï¼šå› ä¸ºå®é™…è¿ç®—å­˜åœ¨æº¢å‡º</li><li>è¿›é˜¶ï¼š<ul><li>ä½è¿ç®—ï¼Ÿkcmï¼Ÿdp</li><li>ğŸ‘   å› å¼åˆ†è§£  çœ‹2 å’Œ 5çš„ä¸ªæ•°, å› ä¸ºæ˜¯å°¾éšæ‰€ä»¥å¯ä»¥è¿™æ ·åš</li><li>é›¶çš„ä¸ªæ•° = åŸæœ¬æœ‰çš„ +  è¿›ä½äº§ç”Ÿçš„</li><li>èƒ½å¦åœ¨On æˆ– Ocçš„æ—¶é—´å¤æ‚åº¦å†…è®¡ç®—å‡ºï¼Ÿ</li></ul></li></ul></li></ul><h3 id="1-å› å¼åˆ†è§£">1. å› å¼åˆ†è§£</h3><p>æˆ‘æ˜¯å‚»æ¯ä¹‹ä¸è¯»é¢˜â€¦â€¦é¢˜çš„æ„æ€æ˜¯<strong>å°¾éšçš„é›¶çš„ä¸ªæ•°</strong>ï¼Œæ˜¯æœ€åå‡ ä½å…¨æ˜¯é›¶çš„ä¸ªæ•°ï¼Œè€Œä¸æ˜¯æ±‚æ€»çš„é›¶çš„ä¸ªæ•°</p><p>æ•…åªéœ€è¦æ‰¾åˆ° 2 å’Œ 5çš„ä¸ªæ•°å³å¯ï¼Œå–æœ€å°å€¼å› ä¸ºé™¤2 * 5å¤–ï¼Œ<strong>å…¶ä»–çš„æ•°ç›¸ä¹˜éƒ½ä¸å¯èƒ½æ„æˆå°¾éšé›¶</strong>ï¼ˆä½†æœ‰å¯èƒ½æ„æˆä¸­é—´é›¶ï¼‰</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">trailingZeroes</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> temp<span class="token punctuation">;</span>        <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>n <span class="token operator">>=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            temp <span class="token operator">=</span> n<span class="token punctuation">;</span>            <span class="token keyword">while</span><span class="token punctuation">(</span>temp <span class="token operator">%</span> <span class="token number">5</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> temp <span class="token operator">/</span><span class="token number">5</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                temp <span class="token operator">/=</span> <span class="token number">5</span><span class="token punctuation">;</span>                b<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">while</span><span class="token punctuation">(</span>temp <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> temp <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                temp <span class="token operator">=</span> temp <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">;</span>                a<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            n<span class="token operator">--</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p>æ—¶é—´å¤æ‚åº¦åœ¨Onä¹‹ä¸Š</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220326112031199.png" alt="image-20220326112031199"></p><h4 id="åå‘ä¼˜åŒ–">åå‘ä¼˜åŒ–</h4><p>è¯´ç™½äº†æ˜¯æ‰¾5çš„ä¸ªæ•°ï¼Œä½†æ˜¯è¿­ä»£æ—¶ä¼šæœ‰é‡å¤çš„5çš„å€æ•°çš„è®°å½•ï¼Œå› æ­¤ä¹‹ç±»ç”¨mapå»æ›¿ä»£ï¼Œä½†æ•ˆæœç”šè‡³æ›´å·®</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">trailingZeroes</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">initHashMap</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> map<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            b <span class="token operator">+=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> b<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">void</span> <span class="token function">initHashMap</span><span class="token punctuation">(</span><span class="token keyword">int</span> n <span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> map<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> origin<span class="token punctuation">;</span>        <span class="token keyword">int</span> temp <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>        origin <span class="token operator">=</span> temp<span class="token punctuation">;</span>        <span class="token keyword">int</span> lastNum <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>temp <span class="token operator">&lt;=</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> div <span class="token operator">=</span> temp <span class="token operator">/</span> <span class="token number">5</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>temp <span class="token operator">%</span> <span class="token number">5</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    lastNum <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>                    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> lastNum<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                    lastNum <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> lastNum<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            temp <span class="token operator">=</span> origin<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span></code></pre></div><h4 id="ä¼˜åŒ–-v2">ä¼˜åŒ–</h4><p>å…¶å®2çš„ä¸ªæ•°æ˜¯è¿œå¤§äº5çš„ä¸ªæ•°çš„ï¼Œæ‰€ä»¥åªç”¨ç»Ÿè®¡5çš„ä¸ªæ•°å³å¯</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">trailingZeroes</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token keyword">int</span> temp <span class="token operator">=</span> n<span class="token punctuation">;</span>       <span class="token keyword">while</span><span class="token punctuation">(</span>temp <span class="token operator">></span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">while</span><span class="token punctuation">(</span>temp <span class="token operator">%</span> <span class="token number">5</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> temp <span class="token operator">/</span> <span class="token number">5</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               temp <span class="token operator">=</span> temp <span class="token operator">/</span> <span class="token number">5</span><span class="token punctuation">;</span>               b<span class="token operator">++</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           temp <span class="token operator">=</span> <span class="token operator">--</span>n<span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> b<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220328192949855.png" alt="image-20220328192949855"></p><h3 id="2-æ•°å­¦å…¬å¼-v2">2. æ•°å­¦å…¬å¼</h3><p>å¿ƒæ€å°ç‚¸ï¼Œä½†è¿˜æ˜¯æƒ³å‡ºæ¥äº†</p><p>å®é™…ä¸Šå°±æ˜¯æ•°å­¦é—®é¢˜ï¼Œæ‰¾nä¸­å«æœ‰5çš„ä¸ªæ•°ï¼Œç„¶åæŠŠè¿™äº›NåŠ èµ·æ¥ï¼Œå…¶å®å¯ä»¥<strong>æ›´å®è§‚çš„æ¥çœ‹</strong>ï¼Œä¸ç”¨ä»æ¯ä¸ªæ•°çš„è§’åº¦æ¥çœ‹ã€‚å› ä¸ºæœ¬èº«åŸºäºæ•°å­¦ï¼Œæ‰€ä»¥è‚¯å®šæ˜¯æœ‰æ•°å­¦è§„å¾‹çš„ï¼Œè§„å¾‹ï¼š</p><p><strong>æ¯éš”5^n - 1ä¸ªæ•°ï¼Œå°±æ€»è®¡ä¼šæœ‰nä¸ª5å‡ºç°</strong>     ï¼ˆæ€è€ƒæ€è·¯å¯ä»¥ä» <strong>é¢å¤–è´¡çŒ®</strong>æ¥çœ‹ï¼‰</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">trailingZeroes</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> temp <span class="token operator">=</span> n<span class="token punctuation">;</span>        <span class="token keyword">int</span> par <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>temp <span class="token operator">/</span> <span class="token number">5</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            res <span class="token operator">+=</span> n <span class="token operator">/</span> par<span class="token punctuation">;</span>            par <span class="token operator">*=</span> <span class="token number">5</span><span class="token punctuation">;</span>            temp <span class="token operator">/=</span> <span class="token number">5</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p>O(log_5{N})çš„æ—¶é—´å¤æ‚åº¦</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220328210847131.png" alt="image-20220328210847131"></p><h4 id="ä¼˜åŒ–-v3">ä¼˜åŒ–</h4><p>LeetCodeé¢˜è§£ï¼Œæ€è·¯ç›¸åŒï¼Œä½†ä»£ç ç®€æ´è®¸å¤š</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">trailingZeroes</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>n <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        n <span class="token operator">/=</span> <span class="token number">5</span><span class="token punctuation">;</span>        ans <span class="token operator">+=</span> n<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> ans<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><h3 id="åæ€-v5">åæ€</h3><ul><li>å°±ä¼°è®¡è¿™é“é¢˜æ˜¯æ•°å­¦é—®é¢˜ï¼Œå› ä¸ºæœ¬æ¥æœ€å¼€å§‹ä½¿ç”¨æ–¹æ³•åŠ ä¸Šä¼˜åŒ–å·²ç»è¿˜ä¸é”™äº†ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰é—®é¢˜ï¼Œä¼°è®¡è‚¯å®šæœ‰æœ€ç®€æ´çš„æ•°å­¦å…¬å¼åœ¨Ocçš„æ—¶é—´å¤æ‚åº¦å†…è®¡ç®—å‡ºæ¥</li><li>åº”ç”¨æ¨¡å‹ ğŸ‘‰ æ•°å­¦é—®é¢˜çš„è½¬åŒ–è¿˜ä¸èƒ½å¾ˆæ˜æ˜¾çš„æ„ŸçŸ¥ï¼ˆæ¯”å¦‚è¿™é‡Œæ‰¾2 å’Œ 5  ç„¶åå†åˆ°æ‰¾5çš„è¿™ä¸ªè¿‡ç¨‹æ˜¯ä¸å¤ªå¿«é€Ÿçš„ï¼‰</li><li>âš ï¸ <strong>çœ‹é—®é¢˜æœ‰æ—¶å€™å¤ªç»†è‡´ï¼Œä¸å¤Ÿå®è§‚</strong>ï¼Œæœ‰æ—¶å€™ä»å¾®è§‚åˆ°å®è§‚ï¼Œä»è¿­ä»£åˆ°æ•´ä½“è€ƒè™‘ï¼Œå¯èƒ½ä¼šæœ‰æ–°çš„å‘ç°</li><li>æœ‰ç‚¹æ­»ç£•â€¦</li></ul><h2 id="189-è½®è½¬æ•°ç»„-â­â­">189. è½®è½¬æ•°ç»„ â­â­</h2><div class="code-tag-time">2022/11.1 21:00:00</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20221101205933184.png" alt="image-20221101205933184"></p><h3 id="å®¡é¢˜-v16">å®¡é¢˜</h3><ul><li>éœ€è¦æ€è€ƒçš„é—®é¢˜ï¼Œæƒ³é€šè¿‡ä¸€æ¬¡ç§»ä½æ¥è§£å†³ï¼Œä½†éœ€è¦ç¡®ä¿ç§»ä½åçš„ åŸæ¥ä½ç½®çš„å…ƒç´ çš„ä¿å­˜ä»¥åŠç§»ä½ï¼Œè¦è§£å†³å½¢æˆçš„é€’å½’å…³ç³»éš¾</li></ul><h3 id="1-å¤šæ¬¡å•æ¬¡ç§»ä½">1. å¤šæ¬¡å•æ¬¡ç§»ä½</h3><p>è¶…æ—¶</p><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">rotate</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> numsSize<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> k<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">rotateByOne</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> numsSize<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">rotateByOne</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>nums<span class="token punctuation">,</span> <span class="token keyword">int</span> numsSize<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> temp <span class="token operator">=</span> nums<span class="token punctuation">[</span>numsSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> numsSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><h3 id="2-æ ‡å¿—-åŒå±‚å‰è¿›">2. æ ‡å¿—+åŒå±‚å‰è¿›</h3><p>ç±»ä¼¼è´ªå©ªç®—æ³•ï¼Œç»´æŠ¤ä¸€ä¸ªå½“å‰çš„æŒ‡æ ‡indexï¼Œindexå‰çš„å…ƒç´ éƒ½æ˜¯å·²ç»å³ç§»kä½çš„ã€‚å¦‚æœå¯¹ç¬¬indexä½ï¼Œå³ç§»kä½åï¼Œå¦‚æœç¬¬ (index+k) % sizeä½æ²¡æœ‰è¢«å³ç§»ï¼Œåˆ™å°†è¯¥ä½å³ç§»ï¼Œä¾æ¬¡è¿­ä»£é‡å¤ã€‚æ—¶é—´å¤æ‚åº¦åœ¨On</p><p>ç¼ºç‚¹ï¼šéœ€è¦ç©ºé—´ä¸ºOnçš„æ•°ç»„æ¥ä¿å­˜å½“å‰ç´¢å¼•ä½ä¸Šæ˜¯å¦è¢«å³ç§»çš„æ ‡å¿—ã€‚</p><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">rotate</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> numsSize<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> <span class="token operator">*</span>bucket <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">calloc</span><span class="token punctuation">(</span>numsSize<span class="token punctuation">,</span>  <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> x1<span class="token punctuation">,</span> x2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>index <span class="token operator">&lt;</span> numsSize<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> cur_index <span class="token operator">=</span> index<span class="token punctuation">;</span>        x1 <span class="token operator">=</span> nums<span class="token punctuation">[</span>cur_index<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>bucket<span class="token punctuation">[</span>cur_index<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// exchange relavant nums</span>            x2 <span class="token operator">=</span> nums<span class="token punctuation">[</span><span class="token punctuation">(</span>cur_index <span class="token operator">+</span> k<span class="token punctuation">)</span><span class="token operator">%</span>numsSize<span class="token punctuation">]</span><span class="token punctuation">;</span>            nums<span class="token punctuation">[</span><span class="token punctuation">(</span>cur_index <span class="token operator">+</span> k<span class="token punctuation">)</span> <span class="token operator">%</span> numsSize<span class="token punctuation">]</span> <span class="token operator">=</span> x1<span class="token punctuation">;</span>            bucket<span class="token punctuation">[</span>cur_index<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            cur_index <span class="token operator">=</span> <span class="token punctuation">(</span>cur_index <span class="token operator">+</span> k<span class="token punctuation">)</span><span class="token operator">%</span>numsSize<span class="token punctuation">;</span>            x1 <span class="token operator">=</span> x2<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        index<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20221101220112436.png" alt="image-20221101220112436"></p><h3 id="3-åŒå±‚ç§»ä½-gcd">3. åŒå±‚ç§»ä½+gcd</h3><p>åŸºäºä¹‹å‰çš„é€’å½’ç±»çš„å³ç§»ï¼Œä¹Ÿå°±æ˜¯ä¸€æ¬¡æ€§æŠŠä¸€ä¸ªç´¢å¼•ä½çš„å…ƒç´  ä»¥åŠå³ç§»kä½çš„å…ƒç´  ä»¥åŠå³ç§»2kä½çš„å…ƒç´ è¿›è¡Œå³ç§»ï¼Œä¹Ÿå°±æ˜¯å…ˆå¤„ç†ä¸€ä¸ªå¾ªç¯å‘¨æœŸå†…çš„å…ƒç´ â€¦è¿™é‡Œä¸»è¦åˆ†ä¸¤ç±»è®¨è®ºï¼Œè®¾å…ƒç´ ä¸ªæ•°ä¸ºnï¼Œå³ç§»æ¬¡æ•°ä¸ºk</p><ol><li>n æ°å¥½èƒ½è¢«kæ•´é™¤ï¼Œå³èƒ½åœ¨ä¸€è¶Ÿè·‘é n/kä¸ªå…ƒç´ ï¼Œéœ€è¦è·‘kèººï¼š</li><li>nä¸èƒ½è¢«kæ•´é™¤ï¼Œåˆ†ä¸¤ç§æƒ…å†µï¼ˆå…¶å®åˆèµ·æ¥æ˜¯ä¸€ç§æƒ…å†µï¼‰ï¼š<ol><li>ä¸€è¶Ÿå†…è·‘énä¸ªå…ƒç´ ï¼Œä¾‹å¦‚ï¼ˆn = 7ï¼Œ k=3ï¼‰</li><li>ä¸€è¶Ÿå†…è·‘ä¸énä¸ªå…ƒç´ ï¼Œåªèƒ½è·‘å®Œéƒ¨åˆ†çš„å…ƒç´ ï¼Œä¹‹åä¾¿ä¼šé™·å…¥é‡å¤ï¼ˆn = 8ï¼Œk=6ï¼‰</li></ol></li></ol><p>æ­¤æ—¶å­˜åœ¨çš„æ•°å­¦å…³ç³»ï¼š $$æœ€ç»ˆæ¯ä¸ªè¶Ÿéå†å…ƒç´ æ•° = n / gcd(n, k) $$</p><p>æ­¤æ—¶å°±èƒ½åœ¨Onçš„æ—¶é—´å¤æ‚åº¦å’ŒO1çš„ç©ºé—´å¤æ‚åº¦å†…è§£å†³é—®é¢˜ï¼ˆä»£ç éƒ¨åˆ†æœ‰å¾…ä¼˜åŒ–ï¼‰</p><div class="code-wrapper"><pre class="language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">gcd</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> t <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>a <span class="token operator">%</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        t <span class="token operator">=</span> a<span class="token operator">%</span>b<span class="token punctuation">;</span>        a <span class="token operator">=</span> b<span class="token punctuation">;</span>        b <span class="token operator">=</span> t<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> t<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">rotate</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> numsSize<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>k <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> nums<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">int</span> x1<span class="token punctuation">,</span> x2<span class="token punctuation">,</span> max <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> out_foreach_count <span class="token operator">=</span> k<span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>numsSize <span class="token operator">%</span> k <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        max <span class="token operator">=</span> numsSize <span class="token operator">/</span> <span class="token function">gcd</span><span class="token punctuation">(</span>numsSize<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>        out_foreach_count <span class="token operator">=</span> numsSize <span class="token operator">/</span> max<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        max <span class="token operator">=</span> numsSize <span class="token operator">/</span> k <span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span><span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> out_foreach_count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> cur_index <span class="token operator">=</span> i<span class="token punctuation">;</span>        x1 <span class="token operator">=</span> nums<span class="token punctuation">[</span>cur_index<span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token keyword">while</span><span class="token punctuation">(</span>count <span class="token operator">&lt;</span> max<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// exchange relavant nums</span>            x2 <span class="token operator">=</span> nums<span class="token punctuation">[</span><span class="token punctuation">(</span>cur_index <span class="token operator">+</span> k<span class="token punctuation">)</span><span class="token operator">%</span>numsSize<span class="token punctuation">]</span><span class="token punctuation">;</span>            nums<span class="token punctuation">[</span><span class="token punctuation">(</span>cur_index <span class="token operator">+</span> k<span class="token punctuation">)</span> <span class="token operator">%</span> numsSize<span class="token punctuation">]</span> <span class="token operator">=</span> x1<span class="token punctuation">;</span>            cur_index <span class="token operator">=</span> <span class="token punctuation">(</span>cur_index <span class="token operator">+</span> k<span class="token punctuation">)</span><span class="token operator">%</span>numsSize<span class="token punctuation">;</span>            x1 <span class="token operator">=</span> x2<span class="token punctuation">;</span>            count<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20221102201002428.png" alt="image-20221102201002428"></p><h3 id="4-æ•°ç»„ç¿»è½¬Â®">4. æ•°ç»„ç¿»è½¬Â®</h3><p>LeetCodeä¸Šæä¾›çš„ä¸€ç§æ–¹æ³•ï¼Œä¹Ÿéå¸¸çš„å·§å¦™ã€‚æœ‰æ—¶é—´å¯ä»¥å†çœ‹ä¸€ä¸‹ã€‚</p><h2 id="198-æ‰“å®¶åŠ«èˆ-â­â­">198. æ‰“å®¶åŠ«èˆ â­â­</h2><div class="code-tag-time">2022/4/14 22:17:00</div><div class="code-tag-label code-tag-label-dp">DP</div><div class="code-tag-label code-tag-label-greedy">Greedy</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220414200221714.png" alt="image-20220414200221714"></p><h3 id="å®¡é¢˜-v17">å®¡é¢˜</h3><ul><li>ä¸èƒ½åœ¨ç›¸é‚»çš„æˆ¿é—´å†…å·çªƒï¼Œé—®é¢˜è½¬æ¢ï¼šåˆ¤æ–­ä¸€ä¸ªæ•°ç»„åœ¨é€‰å®šæ•°æ— ç›¸é‚»æƒ…å†µä¸‹çš„å’Œçš„æœ€å¤§å€¼</li><li>ç‰¹æ®Šæƒ…å†µï¼šå¯ä»¥ä¸€æ¬¡è·³å¤šä¸ªæ•°å­—ï¼Œ[6,1,2,9]ï¼Œè¿™ç§æƒ…å†µå°±å¯ä»¥è·³2æ ¼ï¼Œå› ä¸º1-2çš„å€¼å°äº0</li><li>å¯èƒ½çš„ç®—æ³•ï¼šè´ªå¿ƒï¼ŸDPï¼Ÿ</li><li>æ€è·¯ï¼š<ul><li>ç›´æ¥ï¼š</li><li>DPï¼šåˆå§‹åŒ–æ•°ç»„ï¼Œæ•°ç»„ä¸­çš„å€¼è¿˜æœ‰æ˜¯å¦æ‹œè®¿äº†å½“å‰å€¼çš„æ ‡è®°ï¼Œç¬¬nç§çš„æ€è·¯å¯ä»¥ç­‰äºç­‰1 ~ n-1ç§ä¹‹å’Œï¼Œå–n-1æ—¶åˆ™å…¶ä¸èƒ½æ‹œè®¿å½“å‰çš„å€¼</li></ul></li></ul><h3 id="1-DP">1. DP</h3><p>è´ªå¿ƒå’ŒDPçš„æ€æƒ³ï¼šæˆ‘å½“å‰å·åˆ°ç¬¬næˆ·æ—¶æˆ‘éƒ½ä¿æŒäº†æœ€å¤§èƒ½å·çš„é’±æ•°ï¼Œé‚£ä¹ˆåœ¨å·ç¬¬N+1å®¶æ—¶ï¼Œæˆ‘éœ€è¦æ³¨æ„ï¼š</p><ul><li>æ˜¯å¦èƒ½å·è¿™å®¶ï¼Ÿä¹Ÿå°±æ˜¯æ˜¯å¦å·äº†ä¸Šå®¶<ul><li>èƒ½å·åˆ™ç›´æ¥å·äº†å› ä¸ºè‚¯å®šå·äº†æ¯”æ²¡å·å¥½å•Š</li><li>ä¸èƒ½å·ï¼Œé‚£è¦ä¹ˆä¸å·ä¸Šå®¶å·è¿™å®¶ï¼Œè¦ä¹ˆå·ä¸Šå®¶ä¸å·è¿™å®¶<ul><li>å·ä¸Šä¸Šå®¶+å·è¿™å®¶çš„é’± &gt; å·ä¸Šå®¶ä¸å·è¿™å®¶çš„é’±ï¼Œåˆ™å·è¿™å®¶é’±çš„æœ€å¤§å€¼å°±ç­‰äºå‰è€…ï¼Œå¹¶ä¸”è¿˜è¦è¯´æ˜å·äº†è¿™å®¶</li><li>å·ä¸Šä¸Šå®¶+å·è¿™å®¶çš„é’± &lt; å·ä¸Šå®¶ä¸å·è¿™å®¶çš„é’±ï¼Œåˆ™å·è¿™å®¶é’±çš„æœ€å¤§å€¼ç­‰äºåè€…</li></ul></li></ul></li></ul><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">rob</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">return</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span>     <span class="token keyword">int</span> i<span class="token punctuation">;</span>     <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> isGo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>nums<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>     <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> curMax <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>nums<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>     curMax<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>     isGo<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>     <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">if</span><span class="token punctuation">(</span>isGo<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>             <span class="token keyword">if</span><span class="token punctuation">(</span>curMax<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> nums<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> curMax<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                 curMax<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> curMax<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                 curMax<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> curMax<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> nums<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                 isGo<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span>         <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>             curMax<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> curMax<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> nums<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>             isGo<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>     <span class="token punctuation">&#125;</span>     <span class="token keyword">return</span> curMax<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre></div><p>O(N)çš„æ—¶é—´å¤æ‚åº¦  O(N)çš„ç©ºé—´å¤æ‚åº¦</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220414202724884.png" alt="image-20220414202724884"></p><h4 id="ä¼˜åŒ–-v4">ä¼˜åŒ–</h4><p><strong>DPä»æ•°ç»„åˆ°å¸¸é‡ä¸ªå˜é‡çš„ç»å…¸ä¼˜åŒ–</strong>ï¼šå› ä¸ºå®é™…è®¡ç®—å€¼åªä¸curMax[i-1]ã€curMax[i-2]å’ŒisGo[i-1]æœ‰å…³ï¼Œå› æ­¤å‡å¯ä¼˜åŒ–ä¸ºå¸¸é‡çº§åˆ«çš„æ•°ç»„ï¼Œä»¥æ­¤é™ä½ç©ºé—´å¤æ‚åº¦åˆ°OÂ© ã€‚</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">rob</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span> i<span class="token punctuation">;</span>        <span class="token keyword">int</span> isGo <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> curMax <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        curMax<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        isGo <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>isGo <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>curMax<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> curMax<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    curMax<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> curMax<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                    curMax<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> curMax<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>                    isGo <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                curMax<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> curMax<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>                isGo <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            curMax<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> curMax<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            curMax<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> curMax<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> curMax<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220414220207768.png" alt="image-20220414220207768"></p><p>é¢˜è§£ç”¨Math.maxä¼˜åŒ–äº†åˆ†æ”¯ä»£ç ï¼Œå–æ¶ˆäº†isGoçš„éå†ï¼Œè¿™ä¸ªä¼˜åŒ–éœ€è¦æ³¨æ„ï¼ä½¿å¾—ä»£ç éå¸¸ç®€ä¾¿</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> temp <span class="token operator">=</span> second<span class="token punctuation">;</span>            second <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>first <span class="token operator">+</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> second<span class="token punctuation">)</span><span class="token punctuation">;</span>            first <span class="token operator">=</span> temp<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span></code></pre></div><h3 id="æ€»ç»“-v4">æ€»ç»“</h3><ul><li>è¿™é“é¢˜åšçš„å¾ˆå¿«ï¼Œå› ä¸ºæ€è·¯å¾ˆæ¸…æ¥šï¼Œä¸ºä»€ä¹ˆæ€è·¯æ¸…æ¥šï¼Ÿå› ä¸ºæåˆ°äº†é’±ï¼Œè®¨è®º<strong>é’±çš„æœ€å¤§å€¼</strong>å†åŠ ä¸Šæœ¬èº«<strong>é—®é¢˜æœ‰è¿­ä»£æ€§è´¨å› ç´ </strong>ï¼Œæ‰€ä»¥æƒ³åˆ°äº†è´ªå¿ƒå’ŒDP</li><li><strong>ç„¶åå…ˆæƒ³æ¸…æ¥šäº†å¤§è‡´æ€è·¯æ‰å†™çš„ä»£ç ï¼ŒæŠŠä¸€äº›å‘ç»™é¿å¼€äº†ï¼Œè¿™ç‚¹å¾ˆé‡è¦</strong></li></ul><h2 id="206-åè½¬é“¾è¡¨-â­">206. åè½¬é“¾è¡¨ â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><div class="code-tag-label code-tag-label-recursion">Recursion</div><h3 id="1-è¿­ä»£-v2">1. è¿­ä»£</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">ListNode</span> <span class="token function">reverseList</span><span class="token punctuation">(</span><span class="token class-name">ListNode</span> head<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token class-name">ListNode</span> cur <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>       <span class="token class-name">ListNode</span> pre <span class="token operator">=</span> head<span class="token punctuation">;</span>       <span class="token class-name">ListNode</span> temp<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>       <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">while</span> <span class="token punctuation">(</span>pre <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               temp <span class="token operator">=</span> pre<span class="token punctuation">.</span>next<span class="token punctuation">;</span>               pre<span class="token punctuation">.</span>next <span class="token operator">=</span> cur<span class="token punctuation">;</span>               cur <span class="token operator">=</span> pre<span class="token punctuation">;</span>               pre <span class="token operator">=</span> temp<span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">NullPointerException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token punctuation">&#125;</span>           <span class="token keyword">return</span> cur<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201016183423559.png" alt="image-20201016183423559"></p><h3 id="2-é€’å½’-v2">2. é€’å½’</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">ListNode</span> <span class="token function">reverseList</span><span class="token punctuation">(</span><span class="token class-name">ListNode</span> head<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token class-name">ListNode</span> cur<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>      <span class="token keyword">try</span><span class="token punctuation">&#123;</span>   <span class="token keyword">if</span><span class="token punctuation">(</span>head<span class="token punctuation">.</span>next<span class="token operator">==</span><span class="token keyword">null</span><span class="token operator">||</span>head<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>          <span class="token keyword">return</span> head<span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>             cur<span class="token operator">=</span><span class="token function">reverseList</span><span class="token punctuation">(</span>head<span class="token punctuation">.</span>next<span class="token punctuation">)</span><span class="token punctuation">;</span>            head<span class="token punctuation">.</span>next<span class="token punctuation">.</span>next<span class="token operator">=</span>head<span class="token punctuation">;</span>      head<span class="token punctuation">.</span>next<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">NullPointerException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">return</span> cur<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201016184502839.png" alt="image-20201016184502839"></p><hr><h2 id="212-å•è¯æœç´¢-II-â­â­â­">212. å•è¯æœç´¢ II â­â­â­</h2><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210916143557702.png" alt="image-20210916143557702"></p><h3 id="å®¡é¢˜-v18">å®¡é¢˜</h3><ul><li>å•è¯å¿…é¡»æŒ‰ç…§å­—æ¯é¡ºåºï¼Œé€šè¿‡ <strong>ç›¸é‚»çš„å•å…ƒæ ¼</strong> å†…çš„å­—æ¯æ„æˆï¼Œå…¶ä¸­â€œç›¸é‚»â€å•å…ƒæ ¼æ˜¯é‚£äº›æ°´å¹³ç›¸é‚»æˆ–å‚ç›´ç›¸é‚»çš„å•å…ƒæ ¼ã€‚åŒä¸€ä¸ªå•å…ƒæ ¼å†…çš„å­—æ¯åœ¨ä¸€ä¸ªå•è¯ä¸­ä¸å…è®¸è¢«é‡å¤ä½¿ç”¨ã€‚</li><li>ç±»ä¼¼DFSï¼Ÿ</li><li>è¿™é‡Œæ¯ä¸€ä¸ªå•è¯é¦–å­—æ¯å¯»æ‰¾è‚¯å®šè¦è€—è´¹æ—¶é—´ï¼Œèƒ½ä¸èƒ½ç”¨dpè§„åˆ’å‡ºæ¯ä¸ªå­—æ¯çš„ç›¸é‚»ä½ç½®çš„å­—æ¯</li><li>æ³¨æ„ç›¸åŒå­—æ¯å¯èƒ½åœ¨è¡¨ä¸­å‡ºç°å¤šæ¬¡</li></ul><h3 id="1-æˆ‘çš„ä»£ç ">1. æˆ‘çš„ä»£ç </h3><p>è¿™é‡Œæ²¡æœ‰åšå‡ºæ¥ï¼Œå› ä¸ºåé¢æ¶‰åŠåˆ°äº†DFSï¼Œæ²¡æœ‰è€ƒè™‘åˆ°</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> <span class="token function">findWords</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> board<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> words<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> m <span class="token operator">=</span> board<span class="token punctuation">.</span>length<span class="token punctuation">;</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> board<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>        <span class="token keyword">int</span> shouldExit <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> dp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>m<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span>i <span class="token operator">&lt;</span> m<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span>j <span class="token operator">&lt;</span> n<span class="token operator">+</span><span class="token number">2</span> <span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token number">0</span><span class="token operator">||</span>i<span class="token operator">==</span>m<span class="token operator">+</span><span class="token number">1</span><span class="token operator">||</span>j<span class="token operator">==</span><span class="token number">0</span><span class="token operator">||</span>j<span class="token operator">==</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">' '</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                    dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> board<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">;</span>i <span class="token operator">&lt;</span> m<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>shouldExit <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">;</span>j <span class="token operator">&lt;</span> n<span class="token operator">+</span><span class="token number">1</span> <span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> words<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">int</span> wordsLength <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                    <span class="token keyword">int</span> x <span class="token operator">=</span> i<span class="token punctuation">;</span>                    <span class="token keyword">int</span> y <span class="token operator">=</span> j<span class="token punctuation">;</span>                    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> his <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>words<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                    his<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>                    his<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> j<span class="token punctuation">;</span>                    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span>wordsLength <span class="token operator">==</span> words<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                            result<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                            index<span class="token operator">++</span><span class="token punctuation">;</span>                            i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span>                            j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                            <span class="token keyword">break</span><span class="token punctuation">;</span>                        <span class="token punctuation">&#125;</span>                                            <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> twin <span class="token operator">=</span> <span class="token function">isCharInAround</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>wordsLength<span class="token punctuation">)</span><span class="token punctuation">,</span>dp<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>his<span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span>twin <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                            <span class="token keyword">break</span><span class="token punctuation">;</span>                        <span class="token punctuation">&#125;</span>                        his<span class="token punctuation">[</span>wordsLength<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> twin<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                        his<span class="token punctuation">[</span>wordsLength<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> twin<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                        x <span class="token operator">=</span> twin<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                        y <span class="token operator">=</span> twin<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                        wordsLength<span class="token operator">++</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>                              <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> m <span class="token operator">&amp;&amp;</span> j <span class="token operator">==</span> n <span class="token operator">&amp;&amp;</span> index <span class="token operator">&lt;</span> words<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                    j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                    index<span class="token operator">++</span><span class="token punctuation">;</span>                                   <span class="token punctuation">&#125;</span>                  <span class="token keyword">if</span><span class="token punctuation">(</span>index <span class="token operator">==</span>  words<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    shouldExit <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> result<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">isCharInAround</span><span class="token punctuation">(</span><span class="token keyword">char</span> target<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> board<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">,</span><span class="token keyword">int</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> his<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>board<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> target<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>            res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>board<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> target<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>            res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>board<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> target<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>              res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>            res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> j<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>board<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> target<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>              res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>            res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> j<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span> his<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>his<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> his<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><h3 id="2-å‰ç¼€æ ‘-å›æº¯-è½¬">2. å‰ç¼€æ ‘+å›æº¯ (è½¬)</h3><p>è¿™é‡Œå‰ç¼€æ ‘ä¹‹å‰æ²¡äº†è§£è¿‡ï¼Œçœ‹äº†ä¸‹ç»“æ„ï¼Œä¸é”™</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> dirs <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> <span class="token function">findWords</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> board<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> words<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Trie</span> trie <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Trie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> word <span class="token operator">:</span> words<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            trie<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token comment">// ç»†èŠ‚ï¼Œå»é‡</span>        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> ans <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> board<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> board<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token function">dfs</span><span class="token punctuation">(</span>board<span class="token punctuation">,</span> trie<span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> ans<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> board<span class="token punctuation">,</span> <span class="token class-name">Trie</span> now<span class="token punctuation">,</span> <span class="token keyword">int</span> i1<span class="token punctuation">,</span> <span class="token keyword">int</span> j1<span class="token punctuation">,</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> ans<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>now<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>board<span class="token punctuation">[</span>i1<span class="token punctuation">]</span><span class="token punctuation">[</span>j1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">char</span> ch <span class="token operator">=</span> board<span class="token punctuation">[</span>i1<span class="token punctuation">]</span><span class="token punctuation">[</span>j1<span class="token punctuation">]</span><span class="token punctuation">;</span>        now <span class="token operator">=</span> now<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token string">""</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>now<span class="token punctuation">.</span>word<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            ans<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>now<span class="token punctuation">.</span>word<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token comment">// é¿å…æ‰¾åˆ°é‡å¤çš„ä½ç½®ï¼ˆä¹Ÿæ˜¯æˆ‘æ€è·¯ä¸­å¡å£³çš„åœ°æ–¹ï¼‰</span>        board<span class="token punctuation">[</span>i1<span class="token punctuation">]</span><span class="token punctuation">[</span>j1<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'#'</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> dir <span class="token operator">:</span> dirs<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> i2 <span class="token operator">=</span> i1 <span class="token operator">+</span> dir<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> j2 <span class="token operator">=</span> j1 <span class="token operator">+</span> dir<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>i2 <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> i2 <span class="token operator">&lt;</span> board<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> j2 <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> j2 <span class="token operator">&lt;</span> board<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token function">dfs</span><span class="token punctuation">(</span>board<span class="token punctuation">,</span> now<span class="token punctuation">,</span> i2<span class="token punctuation">,</span> j2<span class="token punctuation">,</span> ans<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// è¿˜åŸ</span>        board<span class="token punctuation">[</span>i1<span class="token punctuation">]</span><span class="token punctuation">[</span>j1<span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">Trie</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> word<span class="token punctuation">;</span>    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Character</span><span class="token punctuation">,</span> <span class="token class-name">Trie</span><span class="token punctuation">></span></span> children<span class="token punctuation">;</span>    <span class="token keyword">boolean</span> isWord<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">Trie</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>word <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>children <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Character</span><span class="token punctuation">,</span> <span class="token class-name">Trie</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">String</span> word<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Trie</span> cur <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> word<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">char</span> c <span class="token operator">=</span> word<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cur<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                cur<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Trie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            cur <span class="token operator">=</span> cur<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        cur<span class="token punctuation">.</span>word <span class="token operator">=</span> word<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210916155107007.png" alt="image-20210916155107007"></p><p>å¤æ‚åº¦åˆ†æ</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210916154957941.png" alt="image-20210916154957941"></p><p>æœ‰æ—¶é—´å¾—çœ‹ä¸€ä¸‹å‰ç¼€æ ‘ï¼Œå¸¸ç”¨äº<strong>å­—ç¬¦ä¸²çš„æŸ¥æ‰¾</strong>ï¼Œä»¥åé‡åˆ°è¿™ç§é—®é¢˜å¯ä»¥çº³å…¥è€ƒè™‘</p><h3 id="3-åˆ é™¤è¢«åŒ¹é…çš„å•è¯">3. åˆ é™¤è¢«åŒ¹é…çš„å•è¯</h3><h2 id="213-æ‰“å®¶åŠ«èˆ-II-â­â­">213. æ‰“å®¶åŠ«èˆ II â­â­</h2><div class="code-tag-time">2021/4/20 18:48:00</div><div class="code-tag-label code-tag-label-dp">DP</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220417193550616.png" alt="image-20220417193550616"></p><h3 id="å®¡é¢˜-v19">å®¡é¢˜</h3><ul><li>æˆ¿å±‹å›´æˆä¸€åœˆï¼Œä¸èƒ½å·ç›¸é‚»çš„</li></ul><h3 id="1-DP-ï¼ˆè½¬ï¼‰">1. DP ï¼ˆè½¬ï¼‰</h3><p>å¯„ï¼Œæƒ³å¤æ‚äº†ã€‚ã€‚ã€‚ã€‚ã€‚</p><p>å…¶å®åªæœ‰ä¸‰ç§æƒ…å†µï¼š</p><ul><li>æˆ¿é—´æ•°=1ï¼Œåˆ™å°±ç›´æ¥å·</li><li>æˆ¿é—´æ•°=2ï¼Œé€‰æœ€å¤šé’±çš„å·</li><li>æˆ¿é—´æ•°&gt;2ï¼Œçœ‹å·ä¸å·ç¬¬ä¸€å®¶<ul><li>å·ç¬¬ä¸€å®¶ï¼Œåˆ™ä¸èƒ½å·æœ€åä¸€å®¶</li><li>ä¸å·ä¸€å®¶ï¼Œåˆ™èƒ½å¤Ÿå·ï¼ˆä½†ä¸ä¸€å®šä¼šå·ï¼‰æœ€åä¸€å®¶</li></ul></li></ul><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">rob</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> length <span class="token operator">=</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>length <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>length <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token function">robRange</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> length <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">robRange</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">robRange</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> start<span class="token punctuation">,</span> <span class="token keyword">int</span> end<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> first <span class="token operator">=</span> nums<span class="token punctuation">[</span>start<span class="token punctuation">]</span><span class="token punctuation">,</span> second <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>start<span class="token punctuation">]</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>start <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> start <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> end<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> temp <span class="token operator">=</span> second<span class="token punctuation">;</span>            second <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>first <span class="token operator">+</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> second<span class="token punctuation">)</span><span class="token punctuation">;</span>            first <span class="token operator">=</span> temp<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> second<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220420184557190.png" alt="image-20220420184557190"></p><h3 id="åæ€-v6">åæ€</h3><ul><li>è¿™ä¸ªé¢˜è‡ªå·±æƒ³å¤æ‚äº†ï¼Œæƒ³æˆå¾ªç¯é“¾è¡¨åˆæƒ³åˆ°å¦‚ä½•åŠ¨æ€è§„åˆ’</li><li>æ²¡æœ‰å…³æ³¨ç›¸æ¯” I é¢˜å˜æ¢çš„æœ¬è´¨ï¼šä»…ä»…æ˜¯é¦–å°¾çš„å˜æ¢ï¼Œä¸å½±å“ä¸­é—´å…ƒç´ ã€‚</li></ul><h2 id="219-å­˜åœ¨é‡å¤å…ƒç´ II-â­">219. å­˜åœ¨é‡å¤å…ƒç´ II â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><div class="code-tag-label code-tag-label-hash">Hash</div><div class="code-tag-label code-tag-label-sort">Sort</div><div class="code-tag-label code-tag-label-sw">Slide-Window</div><p>â²ï¸ 2022 / 1 / 19 11:30 AM</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220119102137168.png" alt="image-20220119102137168"></p><h3 id="å®¡é¢˜-v20">å®¡é¢˜</h3><ul><li>å¯èƒ½åšæ³•: éå†è‚¯å®šè¡Œï¼›åŒæŒ‡é’ˆï¼Ÿæ»‘åŠ¨çª—å£ï¼Ÿæ ˆï¼Ÿ</li><li>æ³¨æ„ï¼šä¸å¿…å®Œå…¨æ‰¾å‡ºæ¥æ‰€æœ‰çš„å¯èƒ½å•Šï¼</li><li>æœ‰ç‚¹æŠ½å±‰åŸç†çš„æ„Ÿè§‰</li></ul><h3 id="1-éå†">1. éå†</h3><p>å¯¹æ•°ç»„è¿›è¡Œéå†ï¼Œå¯¹æ¯ä¸€ä¸ª i å‘å‰çœ‹kä¸ªæ•°ï¼Œæœ€ç»ˆå¾—åˆ°æ—¶é—´å¤æ‚åº¦ä¸º$$O(N * K)$$</p><p>ä¼¼ä¹è¿˜è¡Œï¼Ÿ</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">containsNearbyDuplicate</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> j <span class="token operator">&lt;=</span> i <span class="token operator">+</span> k<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220119102849895.png" alt="image-20220119102849895"></p><p>å¯„ï¼Œå½“Kæ¥è¿‘Nçš„æ—¶å€™ï¼Œå°±å˜æˆ$$O(N^2)$$çš„æ—¶é—´å¤æ‚åº¦äº†ï¼Œæ…¢æ˜¯æ­£å¸¸çš„â€¦è€ƒè™‘ä¸‹ä¸€ç§</p><h3 id="2-å“ˆå¸Œ">2. å“ˆå¸Œ</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">containsNearbyDuplicate</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> hashmap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> temp <span class="token operator">=</span> hashmap<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>temp <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                hashmap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">-</span> temp <span class="token operator">&lt;=</span> k<span class="token punctuation">)</span>                     <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                hashmap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220119104042709.png" alt="image-20220119104042709"></p><p>Onçš„æ—¶é—´å¤æ‚åº¦,Onä»¥ä¸Šçš„ç©ºé—´å¤æ‚åº¦ï¼ˆå“ˆå¸Œè¡¨æ‰©å®¹ï¼‰ï¼Œæ—¶é—´è¿˜æ˜¯æ¯”è¾ƒæ…¢</p><p><strong>ä¼˜åŒ–å</strong></p><p>setä¿è¯å•ä¸€<br>removeä¿è¯æ²¡æœ‰è¿‡æœŸå…ƒç´ </p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">containsNearbyDuplicate</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>set<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>set<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            set<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i <span class="token operator">-</span> k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><h3 id="3-æ¡¶">3. æ¡¶</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> max<span class="token punctuation">,</span> min<span class="token punctuation">;</span>        max <span class="token operator">=</span> min <span class="token operator">=</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> max<span class="token punctuation">)</span>                max <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> min<span class="token punctuation">)</span>                min <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bucket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>max <span class="token operator">-</span> min <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> bucket<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            bucket<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> temp <span class="token operator">=</span> bucket<span class="token punctuation">[</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> min<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>temp <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                bucket<span class="token punctuation">[</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> min<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">-</span> bucket<span class="token punctuation">[</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> min<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> k<span class="token punctuation">)</span>                    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                bucket<span class="token punctuation">[</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> min<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span></code></pre></div><p>å¤±è´¥ï¼Œè¶…å‡ºå†…å­˜é™åˆ¶</p><h3 id="4-æ’åº">4. æ’åº</h3><p>O(N * (logN))çš„å¿«æ’ï¼Œç„¶åéå†æ¯”è¾ƒå°±è¡Œ<br>è¿˜éœ€è¦ä¸€ä¸ªæ•°ç»„æ¥ç»´æŠ¤ç´¢å¼•çš„é¡ºåº Onçš„ç©ºé—´å¤æ‚åº¦</p><h3 id="5-æ»‘åŠ¨çª—å£-Hashï¼ˆè½¬ï¼‰">5. æ»‘åŠ¨çª—å£ + Hashï¼ˆè½¬ï¼‰</h3><p>éå†è¿‡ç¨‹ä¸­ç”¨å“ˆå¸Œè¡¨å­˜å‚¨å…ƒç´ å¹¶åŒæ—¶åˆ¤æ–­çª—å£å¤§å°æ˜¯å¦è¶…è¿‡äº†Kã€‚ç”¨å“ˆå¸ŒSetè¿™é‡Œä¹Ÿå°±ä¸ç”¨è‡ªå·±åˆ¤æ–­äº†</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">containsNearbyDuplicate</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> k <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               cache<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i <span class="token operator">-</span> k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cache<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220119112251084.png" alt="image-20220119112251084"></p><p>ç‰›é€¼â€¦</p><h3 id="æ€»ç»“-v5">æ€»ç»“</h3><p>è¿™é‡Œæœ€å¼€å§‹åšçš„æ—¶å€™æ€è·¯å¤§ä½“æ˜¯å¯¹çš„ï¼Œè¦æ•°å­—å†³å®šçš„ç´¢å¼•ä¹‹é—´çš„å·®å€¼å…³ç³»ï¼Œå°±è€ƒè™‘ç”¨æ¡¶æˆ–è€…å“ˆå¸Œï¼Œä½†è‡ªå·±ç”¨äº†å“ˆå¸Œåæ„Ÿè§‰ç”¨æ¡¶æ’åºä¼šæ›´å¿«ï¼Œä½†åé¢ä¸€ç›´çº ç»“å®ç°æ¡¶æ’åºä½†æœªè€ƒè™‘æœ€å¤§å€¼è€Œè¶…å‡ºäº†å†…å­˜é™åˆ¶ã€‚æ„Ÿè§‰è‡ªå·±è¿˜æ˜¯ä¸€ç›´çº ç»“æŠŠç´¢å¼•ä¿å­˜ä¸‹æ¥ï¼Œä½†å…¶å®è¿™é‡Œä¸ç”¨ä¿å­˜ç´¢å¼•å…³ç³»ï¼Œè€ƒè™‘äº†æ»‘åŠ¨çª—å£çš„é—®é¢˜åªéœ€è¦ç•™ä¸€æ®µçª—å£å†…çš„å€¼å°±è¡Œäº†å‘€â€¦</p><ul><li>çœ‹åˆ°å€¼å†³å®šçš„ç´¢å¼•é—´å…³ç³»é—®é¢˜è€ƒè™‘ç”¨å“ˆå¸Œ</li><li>é‡å¤å…ƒç´ åˆ¤åˆ«é—®é¢˜è€ƒè™‘Setï¼Œå¯èƒ½æ¯”Hashå¿«</li><li>æ•°ç»„ä¸€å®šèŒƒå›´å†…çš„é—®é¢˜è€ƒè™‘æ»‘åŠ¨çª—å£ï¼Œæ»‘åŠ¨çª—å£å®ç°æ–¹å¼å¯ä»¥æ˜¯å¤šç§å¤šæ ·çš„ï¼Œä¸ä¸€å®šæ˜¯æ•°ç»„å“¦ï¼</li></ul><h2 id="223-çŸ©å½¢é¢ç§¯-â­â­">223. çŸ©å½¢é¢ç§¯ â­â­</h2><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210930110121794.png" alt="image-20210930110121794"></p><h3 id="å®¡é¢˜-v21">å®¡é¢˜</h3><ul><li>ä¸¤ç§æƒ…å†µï¼š<ul><li>æœªè¦†ç›–</li><li>è¦†ç›–ï¼ˆå¯èƒ½å®Œå…¨åŒ…å«ï¼‰</li></ul></li><li>å¦‚ä½•åˆ¤æ–­æ˜¯å¦è¦†ç›–ï¼Ÿ</li><li>å…³é”®ï¼š å¦‚ä½•è®¡ç®—è¦†ç›–åŒºåŸŸçš„é¢ç§¯ï¼Ÿ</li><li>éš¾é“æ˜¯æ¨¡æ‹Ÿï¼Ÿ  åˆ†ç±»å¤ªå¤šï¼Œç›´æ¥æ”¾å¼ƒ</li></ul><h2 id="260-åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—III-â­â­">260. åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—III â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-math">Bit</div><div class="code-tag-label code-tag-label-hash">Hash</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220307183103546.png" alt="image-20220307183103546"></p><h3 id="å®¡é¢˜-v22">å®¡é¢˜</h3><ul><li>æ°å¥½ä¸¤ä¸ªå…ƒç´ åªå‡ºç°ä¸€æ¬¡ï¼Œ<strong>å…¶ä»–å…ƒç´ å‡å‡ºç°ä¸¤æ¬¡</strong>ï¼›æ•°ç»„ â€”&gt; ä¸€æ¬¡éå†å³ä¸ºè¾ƒä¼˜ç§€çš„ç®—æ³•</li><li>è€ƒè™‘çº¿æ€§æ—¶é—´å¤æ‚åº¦çš„ç®—æ³•å’Œå¸¸æ•°ç©ºé—´å¤æ‚åº¦</li><li>å¯èƒ½çš„åšæ³•ï¼šå“ˆå¸Œ</li><li>æƒ³æ³•ï¼š<ul><li>ç®€å•ï¼šæš´åŠ›å¾ªç¯ã€‚éœ€è¦O(n^2)çš„æ—¶é—´å¤æ‚åº¦</li><li>è¿›é˜¶ï¼šå“ˆå¸Œä¸¤æ¬¡å¤–å¾ªç¯ï¼Œéœ€è¦O(n)æ—¶é—´å¤æ‚åº¦å’ŒO(n)ç©ºé—´å¤æ‚åº¦</li><li>é«˜çº§ï¼šOnçš„ç©ºé—´å¤æ‚åº¦ï¼Œæƒ³ä¸å‡ºæ¥â€¦</li></ul></li></ul><h3 id="1-å“ˆå¸Œ-ä¸¤æ¬¡éå†">1. å“ˆå¸Œ ä¸¤æ¬¡éå†</h3><p>ç¬¬ä¸€æ¬¡éå†å¡«å€¼ï¼Œç¬¬äºŒæ¬¡éå†åˆ¤æ–­</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">singleNumber</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                res<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>                index<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220307183936426.png" alt="image-20220307183936426"></p><p>Onçš„æ—¶é—´å¤æ‚åº¦ï¼Œä½†å—åˆ°Mapæ‰©å®¹æ–¹é¢çš„é—®é¢˜</p><h3 id="2-ä½è¿ç®—ï¼ˆè½¬ï¼‰">2. ä½è¿ç®—ï¼ˆè½¬ï¼‰</h3><p>ç›´æ¥å¿˜å¾—ä¸€å¹²äºŒå‡€ï¼Œä¹‹å‰è¿˜ä¸“é—¨æœ‰åšè¿‡ä¸€æ¨¡ä¸€æ ·çš„é¢˜ï¼Œå¿˜äº†ã€‚æ¯”è¾ƒæœ‰æŠ€å·§æ€§ã€‚ä¸€ä¸ªå¼‚æˆ–çš„å…¬å¼è¯´æ˜ä¸€åˆ‡é—®é¢˜ï¼š</p><p>$$a \oplus b \oplus a =b$$  å¼‚æˆ–å…·æœ‰äº¤æ¢å¾‹ã€ç»“åˆå¾‹ã€è‡ªåå¾‹</p><p>æ€è·¯ï¼šæ‰€æœ‰å¼‚æˆ–ç»“æœæœ€ç»ˆä¸º$a_1 \oplus a_2 $ï¼Œè‚¯å®šä¸ç­‰äº0ã€‚ç„¶åå†éå†ä¸€æ¬¡ï¼Œæ¯ä¸€æ¬¡ç”¨nums[i]å»åš&amp;è¿ç®—ï¼Œæ£€éªŒæ˜¯å¦==1ï¼ˆ&gt;0ï¼‰ï¼Œä¸ç­‰äº0åˆ™type1^=nums[i]ï¼Œå¾—åˆ°ä¸€ç±»çš„æ•°ï¼Œç­‰äº0åˆ™type2 ^=nums[i]ï¼Œå¾—åˆ°å¦ä¸€ç±»çš„æ•°ã€‚<br>å…³é”®æ˜¯ç†è§£è¿™ä¸ªä¸¤ä¸ªä¸åŒçš„æ•°é€šè¿‡&amp;è¿ç®—è¢«åˆ†é…åˆ°ä¸¤ä¸ªä¸åŒç±»ä¸­</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">singleNumber</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> xorsum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> num <span class="token operator">:</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            xorsum <span class="token operator">^=</span> num<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// é˜²æ­¢æº¢å‡º</span>        <span class="token keyword">int</span> lsb <span class="token operator">=</span> <span class="token punctuation">(</span>xorsum <span class="token operator">==</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MIN_VALUE <span class="token operator">?</span> xorsum <span class="token operator">:</span> xorsum <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token operator">-</span>xorsum<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> type1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> num <span class="token operator">:</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>num <span class="token operator">&amp;</span> lsb<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                type1 <span class="token operator">^=</span> num<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                type2 <span class="token operator">^=</span> num<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>type1<span class="token punctuation">,</span> type2<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// ä½œè€…ï¼šLeetCode-Solution</span><span class="token comment">// é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/single-number-iii/solution/zhi-chu-xian-yi-ci-de-shu-zi-iii-by-leet-4i8e/</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220307194816611.png" alt="image-20220307194816611"></p><h3 id="åæ€-v7">åæ€</h3><ul><li>ä¸»è¦è¿˜æ˜¯èƒ½é€šè¿‡ä¸¤ä¸ªç›¸åŒçš„æ•°æƒ³åˆ°å¼‚æˆ–ï¼Œè¿™æ˜¯è§£é¢˜çš„å…³é”®ï¼Œæƒ³ä¸åˆ°å°±ç›´æ¥å¯„â€¦</li><li>èµ°æŠ•æ— è·¯æ—¶æƒ³æƒ³åŸºæœ¬çš„æ–¹æ³•ï¼Œè¿™é‡Œæˆ‘dp é˜Ÿåˆ—æ ˆ éƒ½è€ƒè™‘è¿‡ï¼Œä½†å› ä¸ºæ¡ä»¶å¤ªå°‘ï¼Œé¢˜ç›®ç®€å•ï¼Œè¿˜æ˜¯æƒ³ä¸åˆ°æ–¹æ³•ï¼Œè¿˜å¿˜äº†åŸºæœ¬çš„ä½è¿ç®—ï¼Œç¡®å®æ¡ä»¶è¶Šå°‘å°±è¶Šè¯¥è€ƒè™‘ã€‚</li></ul><h2 id="263-ä¸‘æ•°-â­">263. ä¸‘æ•° â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><div class="code-tag-label code-tag-label-recursion">Recursion</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210410093526939.png" alt="image-20210410093526939"></p><h3 id="æ€è€ƒ-v15">æ€è€ƒ</h3><p>ä½è¿ç®—ï¼Ÿ</p><h3 id="1-ç®€å•é€’å½’">1. ç®€å•é€’å½’</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isUgly</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>n <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token function">isUgly</span><span class="token punctuation">(</span>n<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>n <span class="token operator">%</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token function">isUgly</span><span class="token punctuation">(</span>n<span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>n <span class="token operator">%</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token function">isUgly</span><span class="token punctuation">(</span>n<span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210410094617676.png" alt="image-20210410094617676"></p><p>æ—¶é—´å¤æ‚åº¦On</p><h3 id="2-è¿­ä»£">2.  è¿­ä»£</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java">  <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isUgly</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">boolean</span> bool <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span> n<span class="token operator">!=</span><span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>n <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                n<span class="token operator">=</span>n<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>n <span class="token operator">%</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                n<span class="token operator">=</span>n<span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>n <span class="token operator">%</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                n<span class="token operator">=</span>n<span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            bool  <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> bool<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210410095627239.png" alt="image-20210410095627239"></p><p>è¿˜æ˜¯å¾ˆæœ‰æ„Ÿè§¦ï¼Œè¿™è¿­ä»£è¿˜æ˜¯å¾ˆå¿« â€¦ æ‰€ä»¥èƒ½ç”¨è¿­ä»£è¿˜æ˜¯ç”¨è¿­ä»£æŠŠ</p><h2 id="279-å®Œå…¨å¹³æ–¹æ•°-â­â­">279. å®Œå…¨å¹³æ–¹æ•° â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-dp">DP</div><div class="code-tag-label code-tag-label-bfs">BFS</div><div class="code-tag-label code-tag-label-math">Formula</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220119202324149.png" alt="image-20220119202324149"></p><h3 id="å®¡é¢˜-v23">å®¡é¢˜</h3><ul><li>å®Œå…¨å¹³æ–¹æ•°è¦æœ€å°‘ã€‚å¯èƒ½çš„ç»„åˆé‚£å°±æœ€å¥½æ˜¯ä¸€ä¸ªå¤§çš„å®Œå…¨å¹³æ–¹æ•°å’Œå‡ ä¸ªå°çš„å®Œå…¨å¹³æ–¹æ•°ç›¸åŠ   æˆ–è€…æ˜¯ å‡ ä¸ªä¸­ç­‰çš„å®Œå…¨å¹³æ–¹æ•°ç›¸åŠ </li><li>å¯¹äºå•ä¸ªæ•°çš„åˆ¤åˆ«æ–¹æ³•ï¼šDFS.åŸæ•°å‡å»è¿™ä¸ªæ•°ï¼Œå‰©ä½™çš„æ•°é‡å¤ä¹‹å‰çš„æ“ä½œï¼Œè‹¥ä¸ªæ•°å¤šäº†ï¼Œåˆ™æ¢æˆè¾ƒå°çš„ç»§ç»­</li><li>å¯èƒ½çš„åšæ³•ï¼š DFSï¼›æ ‘ç»“æ„ï¼ŸåŠ¨æ€è§„åˆ’</li></ul><h3 id="1-åŠ¨æ€è§„åˆ’-v3">1. åŠ¨æ€è§„åˆ’</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">numSquares</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> methods <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       methods<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       methods<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">int</span> min_x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>           <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> x <span class="token operator">&lt;</span> i<span class="token punctuation">;</span> x<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">if</span><span class="token punctuation">(</span>methods<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">+</span> methods<span class="token punctuation">[</span>i <span class="token operator">-</span> x<span class="token punctuation">]</span> <span class="token operator">&lt;</span> methods<span class="token punctuation">[</span>min_x<span class="token punctuation">]</span> <span class="token operator">+</span> methods<span class="token punctuation">[</span>i <span class="token operator">-</span> min_x<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   min_x <span class="token operator">=</span> x<span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">int</span> temp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>temp <span class="token operator">*</span> temp <span class="token operator">==</span> i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               methods<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>               methods<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> methods<span class="token punctuation">[</span>min_x<span class="token punctuation">]</span> <span class="token operator">+</span> methods<span class="token punctuation">[</span>i <span class="token operator">-</span> min_x<span class="token punctuation">]</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> methods<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220119205450918.png" alt="image-20220119205450918"></p><p>æ‹‰è·¨æ‹‰è·¨ï¼Œå› ä¸ºæœ‰$O(N^2)$çš„æ—¶é—´å¤æ‚åº¦å“Ÿï¼Œè¿˜æœ‰Onçš„ç©ºé—´å¤æ‚åº¦ï¼Œå¾ˆå¤šæ•°çš„è¿ç®—æ˜¯æµªè´¹äº†çš„ï¼Œå› ä¸ºæ ¹æœ¬ç”¨ä¸åˆ°</p><h4 id="1-2-ä¼˜åŒ–åçš„åŠ¨æ€è§„åˆ’-ï¼ˆè½¬ï¼‰">1.2. ä¼˜åŒ–åçš„åŠ¨æ€è§„åˆ’ ï¼ˆè½¬ï¼‰</h4><p>å‡è®¾æœ€å¼€å§‹éƒ½æ˜¯æœ€å¤šæ•°ç›®çš„ï¼Œå³éƒ½åª+1ã€‚åŠ¨æ€è§„åˆ’æ–¹ç¨‹çš„æ„ä¹‰åœ¨äºï¼š</p><p>$$è‡ªç„¶æ•° i å¯¹åº”çš„æœ€å°æ•°ç›® = min(å½“å‰å€¼, i - ä¹‹å‰çš„ä¸€ä¸ªå®Œå…¨å¹³æ–¹æ•°çš„æœ€å°æ•°ç›® å† + 1$$</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">numSquares</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> dp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// é»˜è®¤åˆå§‹åŒ–å€¼éƒ½ä¸º0</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span> <span class="token comment">// æœ€åçš„æƒ…å†µå°±æ˜¯æ¯æ¬¡+1</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">-</span> j <span class="token operator">*</span> j <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                 dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> dp<span class="token punctuation">[</span>i <span class="token operator">-</span> j <span class="token operator">*</span> j<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åŠ¨æ€è½¬ç§»æ–¹ç¨‹</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> dp<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220120113331761.png" alt="image-20220120113331761"></p><p>Onçš„ç©ºé—´å¤æ‚åº¦ Onlognçš„æ—¶é—´å¤æ‚åº¦</p><h3 id="2-BFS-å‰ªæ-ï¼ˆè½¬ï¼‰">2. BFS + å‰ªæ ï¼ˆè½¬ï¼‰</h3><p>BFSç¡®ä¿äº†å½“åˆ°è¿™ä¸€å±‚æ—¶ï¼Œå¦‚æœä¸ºä½™æ•°ä¸º0ï¼Œåˆ™ä¸€å®šæ˜¯æœ€å°çš„æ•°ç›®ã€‚<br>æ³¨æ„è¿™é‡Œvisitedç¡®ä¿çš„æ˜¯ä¸é‡å¤ï¼Œç¬¬äºŒå±‚æœ‰ä¸€ä¸ª3ï¼Œç¬¬ä¸‰å±‚åˆæœ‰ä¸€ä¸ª3ï¼Œé‚£è‚¯å®šè¿˜æ˜¯ç¬¬äºŒå±‚çš„3çš„æ•°ç›®&lt;èµ°ç¬¬ä¸‰å±‚çš„3çš„æ•°ç›®ï¼Œæ‰€ä»¥æ²¡å¿…è¦è¦ç¬¬ä¸‰å±‚çš„ã€‚</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">numSquares</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token class-name">Queue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> visited <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> level <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>      queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>      visited<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>queue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">int</span> size <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// ç»å…¸åšæ³•ï¼Œç”¨æ¥æ§åˆ¶æ¯å±‚çš„å¾ªç¯çš„</span>          <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              <span class="token keyword">int</span> head <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token keyword">int</span> sq <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> sq<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                  <span class="token keyword">int</span> tmp <span class="token operator">=</span> head <span class="token operator">-</span> j <span class="token operator">*</span> j<span class="token punctuation">;</span>                  <span class="token comment">// æ‰¾åˆ°äº†ç¬¬ä¸€ä¸ªå…¨ç”± å®Œå…¨å¹³æ–¹æ•° ç»„æˆçš„ç»„åˆï¼Œå‡åˆ°0äº†å·²ç»</span>                  <span class="token keyword">if</span><span class="token punctuation">(</span>tmp <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                      <span class="token keyword">return</span> level<span class="token punctuation">;</span>                  <span class="token punctuation">&#125;</span>                  <span class="token comment">// æ¯”å¦‚åŒä¸€å±‚ï¼Œå·²ç»æœ‰äº†1ä¸ª1ï¼Œé‚£å°±ä¸éœ€è¦å†æ”¾è¿›å»äº†</span>                  <span class="token comment">// å› ä¸ºéƒ½åœ¨åŒä¸€å±‚ï¼Œå¾€åçš„å±‚æ•°ç»“æœè‚¯å®šæ˜¯ä¸€æ ·çš„å•Šï¼Œå°±æ˜¯å‰ªæï¼ï¼ï¼</span>                  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>visited<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                      visited<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>                      queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>          level<span class="token operator">++</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">return</span> level<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220120121648349.png" alt="image-20220120121648349"></p><p>ç©ºé—´å¤æ‚åº¦å¤§äºOn<br>æ—¶é—´å¤æ‚åº¦Onï¼Ÿ</p><h3 id="3-æ•°å­¦å…¬å¼-ï¼ˆè½¬ï¼‰">3. æ•°å­¦å…¬å¼ ï¼ˆè½¬ï¼‰</h3><div class="note note-primary">            <p><strong>å››å¹³æ–¹å’Œå®šç†</strong>ï¼šä»»æ„ä¸€ä¸ªæ­£æ•´æ•°éƒ½å¯ä»¥è¢«è¡¨ç¤ºä¸ºè‡³å¤šå››ä¸ªæ­£æ•´æ•°çš„å¹³æ–¹å’Œã€‚å½“å‰ä»…å½“$$n \neq 4^k \times (8m+7) $$ï¼Œnå¯ä»¥è¢«è¡¨ç¤ºä¸ºè‡³å¤šä¸‰ä¸ªæ­£æ•´æ•°çš„å¹³æ–¹å’Œï¼Œè€Œå¦‚æœç›¸ç­‰æ—¶ï¼Œåˆ™nä»…å¯ä»¥è¡¨ç¤ºä¸ºå››ä¸ªæ­£æ•´æ•°çš„å¹³æ–¹å’Œ</p>          </div><p>ç”±ä»¥ä¸Šå®šç†ï¼Œåˆ™N !=â€¦æ—¶ï¼Œæœ‰ä¸‰ç§æƒ…å†µï¼š</p><ul><li>1ç§ï¼Œåˆ™å¿…ä¸ºnçš„å®Œå…¨å¹³æ–¹æ•°</li><li>2ç§ï¼Œn = a^2 + b^2 ï¼Œåªéœ€è¦æšä¸¾æ‰€æœ‰çš„aï¼Œåˆ¤æ–­n - a^2æ˜¯å¦ä¸ºå®Œå…¨å¹³æ–¹æ•°å³å¯</li><li>3ç§ï¼Œæ’é™¤æ³•</li></ul><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220120120554207.png" alt="image-20220120120554207"></p><p>ç©ºé—´å¤æ‚åº¦ O1<br>æ—¶é—´å¤æ‚åº¦ $$O(\sqrt n)$$</p><h3 id="æ€»ç»“-v6">æ€»ç»“</h3><p>åšè¿™ä¸€é¢˜çš„æ—¶å€™æ€è·¯å¤§æ¦‚ä¸Šè¿˜æ˜¯å¯¹çš„ï¼Œæƒ³åˆ°äº†åŠ¨æ€è§„åˆ’ï¼Œä¹‹åæƒ³åˆ°äº†è‡ªå®šä¹‰é“¾è¡¨è¿›è€Œæƒ³åˆ°äº†DFSï¼Œä½†è¿™é“é¢˜æ˜¯BFSè§£çš„â€¦</p><ul><li>ä»æ ‘çš„è§’åº¦ï¼šå¯¹å¤šå‰æ ‘çš„å±‚æ•°è§£æ³•è€ƒè™‘BFS</li><li>ä»æ•°ç»„çš„è§’åº¦ï¼šåä¸€ä¸ªå€¼ä¾èµ–äºå‰å‡ ä¸ªå€¼ï¼Œè€ƒè™‘dp</li></ul><h2 id="292-Nimæ¸¸æˆ-â­â­">292. Nimæ¸¸æˆ â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-math">Inference</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210918150909064.png" alt="image-20210918150909064"></p><h3 id="å®¡é¢˜-v24">å®¡é¢˜</h3><ul><li>â€œä½ ä½œä¸ºå…ˆæ‰‹â€</li><li>ä¸¤ä¸ªäººï¼ŒåŒæ–¹éƒ½å°½åŠ›å‘æ‹¿èµ°å…¨éƒ¨çŸ³å¤´</li><li>â€œæ˜¯å¦â€ ï¼Œâ€œå¦‚æœâ€</li><li>é€’å½’ï¼Ÿæ ‘ï¼Ÿ</li></ul><p>Failedï¼šæ²¡åšå‡ºæ¥ï¼Œä¸€ç›´æŠ“ç€é€’å½’æ¥åšï¼Œåœ¨â€œå¦‚ä½•èªæ˜çš„åˆ¤æ–­å‰©ä¸‹çš„çŸ³å¤´æ˜¯å¦èƒ½å®Œå…¨ä½¿å¯¹æ–¹è¾“æ‰â€è¿™ä¸ªé—®é¢˜ä¸Šçº ç»“ã€‚ã€‚</p><h3 id="1-æ•°å­¦æ¨ç†ï¼ˆè½¬ï¼‰">1. æ•°å­¦æ¨ç†ï¼ˆè½¬ï¼‰</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token comment">/*è®©æˆ‘ä»¬è€ƒè™‘ä¸€äº›å°ä¾‹å­ã€‚æ˜¾è€Œæ˜“è§çš„æ˜¯ï¼Œå¦‚æœçŸ³å¤´å †ä¸­åªæœ‰ä¸€å—ã€ä¸¤å—ã€æˆ–æ˜¯ä¸‰å—çŸ³å¤´ï¼Œé‚£ä¹ˆåœ¨ä½ çš„å›åˆï¼Œä½ å°±å¯ä»¥æŠŠå…¨éƒ¨çŸ³å­æ‹¿èµ°ï¼Œä»è€Œåœ¨æ¸¸æˆä¸­å–èƒœï¼›å¦‚æœå †ä¸­æ°å¥½æœ‰å››å—çŸ³å¤´ï¼Œä½ å°±ä¼šå¤±è´¥ã€‚å› ä¸ºåœ¨è¿™ç§æƒ…å†µä¸‹ä¸ç®¡ä½ å–èµ°å¤šå°‘çŸ³å¤´ï¼Œæ€»ä¼šä¸ºä½ çš„å¯¹æ‰‹ç•™ä¸‹å‡ å—ï¼Œä»–å¯ä»¥å°†å‰©ä½™çš„çŸ³å¤´å…¨éƒ¨å–å®Œï¼Œä»è€Œä»–å¯ä»¥åœ¨æ¸¸æˆä¸­æ‰“è´¥ä½ ã€‚å› æ­¤ï¼Œè¦æƒ³è·èƒœï¼Œåœ¨ä½ çš„å›åˆä¸­ï¼Œå¿…é¡»é¿å…çŸ³å¤´å †ä¸­çš„çŸ³å­æ•°ä¸º 44 çš„æƒ…å†µã€‚æˆ‘ä»¬ç»§ç»­æ¨ç†ï¼Œå‡è®¾å½“å‰å †é‡Œåªå‰©ä¸‹äº”å—ã€å…­å—ã€æˆ–æ˜¯ä¸ƒå—çŸ³å¤´ï¼Œä½ å¯ä»¥æ§åˆ¶è‡ªå·±æ‹¿å–çš„çŸ³å¤´æ•°ï¼Œæ€»æ˜¯æ°å¥½ç»™ä½ çš„å¯¹æ‰‹ç•™ä¸‹å››å—çŸ³å¤´ï¼Œä½¿ä»–è¾“æ‰è¿™åœºæ¯”èµ›ã€‚ä½†æ˜¯å¦‚æœçŸ³å¤´å †é‡Œæœ‰å…«å—çŸ³å¤´ï¼Œä½ å°±ä¸å¯é¿å…åœ°ä¼šè¾“æ‰ï¼Œ ********å› ä¸ºä¸ç®¡ä½ ä»ä¸€å †çŸ³å¤´ä¸­æŒ‘å‡ºä¸€å—ã€ä¸¤å—è¿˜æ˜¯ä¸‰å—ï¼Œä½ çš„å¯¹æ‰‹éƒ½å¯ä»¥é€‰æ‹©ä¸‰å—ã€ä¸¤å—æˆ–ä¸€å—ï¼Œä»¥ç¡®ä¿åœ¨å†ä¸€æ¬¡è½®åˆ°ä½ çš„æ—¶å€™ï¼Œä½ ä¼šé¢å¯¹å››å—çŸ³å¤´*********ã€‚æ˜¾ç„¶æˆ‘ä»¬ç»§ç»­æ¨ç†ï¼Œå¯ä»¥çœ‹åˆ°å®ƒä¼šä»¥ç›¸åŒçš„æ¨¡å¼ä¸æ–­é‡å¤ n = 4, 8, 12, 16, \ldotsn=4,8,12,16,â€¦ï¼ŒåŸºæœ¬å¯ä»¥çœ‹å‡ºå¦‚æœå †é‡Œçš„çŸ³å¤´æ•°ç›®ä¸º 44 çš„å€æ•°æ—¶ï¼Œä½ ä¸€å®šä¼šè¾“æ‰æ¸¸æˆã€‚å¦‚æœæ€»çš„çŸ³å¤´æ•°ç›®ä¸º 44 çš„å€æ•°æ—¶ï¼Œå› ä¸ºæ— è®ºä½ å–å¤šå°‘çŸ³å¤´ï¼Œå¯¹æ–¹æ€»æœ‰å¯¹åº”çš„å–æ³•ï¼Œè®©å‰©ä½™çš„çŸ³å¤´çš„æ•°ç›®ç»§ç»­ä¸º 44 çš„å€æ•°ã€‚å¯¹äºä½ æˆ–è€…ä½ çš„å¯¹æ‰‹å–çŸ³å¤´æ—¶ï¼Œæ˜¾ç„¶æœ€ä¼˜çš„é€‰æ‹©æ˜¯å½“å‰å·±æ–¹å–å®ŒçŸ³å¤´åï¼Œè®©å‰©ä½™çš„çŸ³å¤´çš„æ•°ç›®ä¸º 44 çš„å€æ•°ã€‚å‡è®¾å½“å‰çš„çŸ³å¤´æ•°ç›®ä¸º xxï¼Œå¦‚æœ xx ä¸º 44 çš„å€æ•°æ—¶ï¼Œåˆ™æ­¤æ—¶ä½ å¿…ç„¶ä¼šè¾“æ‰æ¸¸æˆï¼›å¦‚æœ xx ä¸ä¸º 44 çš„å€æ•°æ—¶ï¼Œåˆ™æ­¤æ—¶ä½ åªéœ€è¦å–èµ° x \bmod 4xmod4 ä¸ªçŸ³å¤´æ—¶ï¼Œåˆ™å‰©ä½™çš„çŸ³å¤´æ•°ç›®å¿…ç„¶ä¸º 44 çš„å€æ•°ï¼Œä»è€Œå¯¹æ‰‹ä¼šè¾“æ‰æ¸¸æˆã€‚*/</span><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">canWinNim</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> n <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p>è¿™é‡Œè¿˜æ˜¯é€šè¿‡ç‰¹æ®Šæƒ…å†µ4çš„åˆ¤æ–­ï¼Œå’¬å®šäº†4ä½œä¸ºå”¯ä¸€çš„ç‰¹æ®Šæƒ…å†µï¼Œå»¶ä¼¸æ¨ç†å‡º4çš„å€æ•°ã€‚æ¯”è¾ƒå·§å¦™çš„æ˜¯</p><ul><li>å…ˆæ‰‹</li><li>ç”±äºå…ˆæ‰‹ï¼Œæ— è®ºä½ æ‹¿å‡ ä¸ªï¼Œåªè¦æˆ‘ä¿è¯åœ¨4çš„å€æ•°ï¼Œå°±æ— æ³•å–å¾—èƒœåˆ©</li></ul><h2 id="300-æœ€é•¿é€’å¢å­åºåˆ—-â­â­">300. æœ€é•¿é€’å¢å­åºåˆ— â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-dp">DP</div><div class="code-tag-label code-tag-label-greedy">Greedy</div><div class="code-tag-label code-tag-label-binary">Binary</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210330164045435.png" alt="image-20210330164045435"></p><h3 id="æ€è€ƒ-v16">æ€è€ƒ</h3><p>å¯ä»¥ä¸è¿ç»­ï¼Œ  åŠ¨æ€è§„åˆ’ dp   é€šé¡¹å¼</p><h3 id="1-è‡ªå·±å†™çš„dp">1. è‡ªå·±å†™çš„dp</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> dp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>nums<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> max <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MIN_VALUE<span class="token punctuation">;</span>dp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> inmax <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MIN_VALUE<span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>i<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&lt;</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">></span>inmax <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            inmax <span class="token operator">=</span> nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>            k <span class="token operator">=</span> j<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>inmax <span class="token operator">!=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MIN_VALUE<span class="token operator">&amp;&amp;</span> dp<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">&lt;</span> dp<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span> nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            k <span class="token operator">=</span> j<span class="token punctuation">;</span>            inmax <span class="token operator">=</span> nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>inmax <span class="token operator">==</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MIN_VALUE<span class="token punctuation">)</span> dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">==</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> dp<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">else</span> dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> dp<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>max<span class="token operator">&lt;=</span>dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        max <span class="token operator">=</span> dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> max<span class="token punctuation">;</span></code></pre></div><p>æ¡ä»¶åˆ¤æ–­å¤ªå¤šäº†  è¾£é¸¡</p><p>æ—¶é—´å¤æ‚åº¦ O(n<sup>2</sup>)</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210330173053621.png" alt="image-20210330173053621"></p><h3 id="2-çœŸæ­£çš„dp">2. çœŸæ­£çš„dp</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">lengthOfLIS</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> dp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>nums<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>        dp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> maxans <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> i<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> dp<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            maxans <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>maxans<span class="token punctuation">,</span> dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> maxans<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>ä½œè€…ï¼š<span class="token class-name">LeetCode</span><span class="token operator">-</span><span class="token class-name">Solution</span>é“¾æ¥ï¼šhttps<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>leetcode<span class="token operator">-</span>cn<span class="token punctuation">.</span>com<span class="token operator">/</span>problems<span class="token operator">/</span>longest<span class="token operator">-</span>increasing<span class="token operator">-</span>subsequence<span class="token operator">/</span>solution<span class="token operator">/</span>zui<span class="token operator">-</span>chang<span class="token operator">-</span>shang<span class="token operator">-</span>sheng<span class="token operator">-</span>zi<span class="token operator">-</span>xu<span class="token operator">-</span>lie<span class="token operator">-</span>by<span class="token operator">-</span>leetcode<span class="token operator">-</span>soluti<span class="token operator">/</span>æ¥æºï¼šåŠ›æ‰£ï¼ˆ<span class="token class-name">LeetCode</span>ï¼‰è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210330173937247.png" alt="image-20210330173937247"></p><h3 id="è´ªå¿ƒ-äºŒåˆ†">è´ªå¿ƒ+äºŒåˆ†</h3><p>æ²¡çœ‹æ‡‚ -------</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210330174705748.png" alt="image-20210330174705748"></p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">lengthOfLIS</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> d <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        d<span class="token punctuation">[</span>len<span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> d<span class="token punctuation">[</span>len<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                d<span class="token punctuation">[</span><span class="token operator">++</span>len<span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> r <span class="token operator">=</span> len<span class="token punctuation">,</span> pos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// å¦‚æœæ‰¾ä¸åˆ°è¯´æ˜æ‰€æœ‰çš„æ•°éƒ½æ¯” nums[i] å¤§ï¼Œæ­¤æ—¶è¦æ›´æ–° d[1]ï¼Œæ‰€ä»¥è¿™é‡Œå°† pos è®¾ä¸º 0</span>                <span class="token keyword">while</span> <span class="token punctuation">(</span>l <span class="token operator">&lt;=</span> r<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">int</span> mid <span class="token operator">=</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> r<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>d<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">&lt;</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        pos <span class="token operator">=</span> mid<span class="token punctuation">;</span>                        l <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                        r <span class="token operator">=</span> mid <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>                d<span class="token punctuation">[</span>pos <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> len<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>ä½œè€…ï¼š<span class="token class-name">LeetCode</span><span class="token operator">-</span><span class="token class-name">Solution</span>é“¾æ¥ï¼šhttps<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>leetcode<span class="token operator">-</span>cn<span class="token punctuation">.</span>com<span class="token operator">/</span>problems<span class="token operator">/</span>longest<span class="token operator">-</span>increasing<span class="token operator">-</span>subsequence<span class="token operator">/</span>solution<span class="token operator">/</span>zui<span class="token operator">-</span>chang<span class="token operator">-</span>shang<span class="token operator">-</span>sheng<span class="token operator">-</span>zi<span class="token operator">-</span>xu<span class="token operator">-</span>lie<span class="token operator">-</span>by<span class="token operator">-</span>leetcode<span class="token operator">-</span>soluti<span class="token operator">/</span>æ¥æºï¼šåŠ›æ‰£ï¼ˆ<span class="token class-name">LeetCode</span>ï¼‰è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</code></pre></div><h2 id="322-é›¶é’±å…‘æ¢-â­â­">322. é›¶é’±å…‘æ¢ â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-dp">DP</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210407093902378.png" alt="image-20210407093902378"></p><h3 id="æ€è€ƒ-v17">æ€è€ƒ</h3><p>æ²¡æœ‰æƒ³dp â€¦å¾ˆæ‹‰  æœ‰æƒ³åˆ°DFS ä¸è¿‡æ²¡æœ‰å®ç°</p><h3 id="1-è®°å¿†DFS">1. è®°å¿†DFS</h3><h3 id="2-DP">2. DP</h3><h2 id="326-3çš„å¹‚-â­">326. 3çš„å¹‚ â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-recursion">Recursion</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210923151745526.png" alt="image-20210923151745526"></p><h3 id="å®¡é¢˜-v25">å®¡é¢˜</h3><ul><li>é€’å½’</li><li>è¿­ä»£</li><li>ä½è¿ç®—ï¼Ÿ</li></ul><h3 id="1-é€’å½’-v3">1. é€’å½’</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isPowerOfThree</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>n  <span class="token operator">==</span> <span class="token number">3</span> <span class="token operator">||</span> n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">||</span> n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token function">isPowerOfThree</span><span class="token punctuation">(</span>n <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210923152724999.png" alt="image-20210923152724999"></p><h3 id="2-è¿­ä»£-v2">2. è¿­ä»£</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isPowerOfThree</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">3</span> <span class="token operator">||</span> n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token keyword">break</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">||</span> n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           n <span class="token operator">=</span> n <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210923153242918.png" alt="image-20210923153242918"></p><h2 id="344-åè½¬å­—ç¬¦ä¸²-â­">344. åè½¬å­—ç¬¦ä¸² â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-recursion">Recursion</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201008231317959.png" alt="image-20201008231317959"></p><p>æˆ‘çš„ä»£ç ï¼š</p><h3 id="ä¸€æ¬¡éå†">ä¸€æ¬¡éå†</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">reverse</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//ä¸€æ¬¡éå†ï¼Ÿ ç©ºé—´å¤æ‚åº¦O(n)=1 ,æ—¶é—´å¤æ‚åº¦O(n)=n;</span>        <span class="token keyword">char</span> temp<span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>s<span class="token punctuation">.</span>length<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            temp<span class="token operator">=</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>s<span class="token punctuation">[</span>s<span class="token punctuation">.</span>length<span class="token operator">-</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            s<span class="token punctuation">[</span>s<span class="token punctuation">.</span>length<span class="token operator">-</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>temp<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><h3 id="é€’å½’æ³•-v2">é€’å½’æ³•</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">static</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">reverse_1</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span>s<span class="token punctuation">,</span> <span class="token keyword">int</span> left<span class="token punctuation">,</span> <span class="token keyword">int</span> right<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//é€’å½’æ³•</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>left<span class="token operator">&lt;</span>right<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">char</span> temp<span class="token punctuation">;</span>        temp <span class="token operator">=</span> s<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">;</span>        s<span class="token punctuation">[</span>left<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">;</span>        s<span class="token punctuation">[</span>right<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">reverse_1</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> left <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> right <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> s<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>è®¡ç®—ç»“æœï¼š</p><p>â€‹<strong>ä¸€æ¬¡éå†</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201008231524846.png" alt="image-20201008231524846"></p><p>â€‹<strong>é€’å½’</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20201008232649376.png" alt="image-20201008232649376"></p><p>åˆ†ææ€è€ƒï¼š</p><div class="code-wrapper"><pre class="language-none"><code class="language-none">1. åŒæŒ‡é’ˆ æ–¹æ³•ï¼Œ æŒ‡å‘å¤´å°¾æŒ‡é’ˆï¼Œä¸¤æ ‡å…µå‘ä¸­éƒ¨é é½ï¼Œifå¾ªç¯å’Œwhileåˆ¤æ–­éƒ½å¯ä»¥2. é‡‡ç”¨é€’å½’ï¼Œå†…å­˜å ç”¨ä¼šé«˜ä¸€ç‚¹ ï¼Œæ‰§è¡Œç”¨æ—¶ä¹Ÿéå¸¸æ…¢</code></pre></div><h2 id="357-ç»Ÿè®¡å„ä½æ•°å­—éƒ½ä¸åŒçš„çš„æ•°å­—ä¸ªæ•°-â­â­">357. ç»Ÿè®¡å„ä½æ•°å­—éƒ½ä¸åŒçš„çš„æ•°å­—ä¸ªæ•° â­â­</h2><div class="code-tag-time">2022/4/12 19:37:00</div><div class="code-tag-label code-tag-label-dp">DP</div><div class="code-tag-label code-tag-label-math">Decimal</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220411155253559.png" alt="image-20220411155253559"></p><h3 id="å®¡é¢˜-v26">å®¡é¢˜</h3><ul><li><p>åªæœ‰ä½æ•°æœ‰ä¸¤ä¸ªä½æ•°ç›¸åŒåˆ™å°±ä¸æ»¡è¶³ï¼Œç»™å®šçš„nä»£è¡¨10çš„næ¬¡æ–¹</p></li><li><p>æ€è·¯ï¼š</p><ul><li><p>ç›´æ¥ï¼š</p><ul><li>æŒ‰åè¿›åˆ¶æ‹†åˆ†æ¯”è¾ƒï¼Œé€’å½’\è¿­ä»£,ä½†å„ä½æ•°å­—</li></ul></li><li><p>è¿›é˜¶ï¼š</p><ul><li><p>æ•°å­¦å…¬å¼ï¼š100ä»¥å†…æœ‰9ä¸ªï¼ˆå› ä¸ºåä½å’Œä¸ªä½ï¼‰<br>1000ä»¥å†…æœ‰ï¼ˆåä½ä¸ªä½+ä¸ªä½ç™¾ä½åä½ç™¾ä½+ä¸ªä½åä½ç™¾ä½ï¼‰ä½†è¦åŒºåˆ†å†—ä½™</p><ul><li>ä¸¤ä½é‡å¤ï¼šä¹Ÿå°±æ˜¯æ¯ä¸¤ä½é‡å¤çš„æ€»æ•°ä¸º9 * 9 * 2 + 9 *  9  2</li><li>ä¸‰ä½é‡å¤ï¼š9</li></ul><p>å¯¹4ä½æ•°æ¥è¯´ï¼š</p><ul><li>ä¸¤ä½é‡å¤ï¼š<s>3 * (9 * 9 * 8 ) + 3 * (9 * 8 * 9)</s></li><li>ä¸‰ä½é‡å¤ï¼š2 * 9 * 9+  2 * (9 * 9 )</li><li>å››ä½é‡å¤ï¼š9</li></ul></li></ul></li></ul></li></ul><h3 id="1-æŒ‰åè¿›åˆ¶éå†ï¼ˆOverTimeï¼‰">1.  æŒ‰åè¿›åˆ¶éå†ï¼ˆOverTimeï¼‰</h3><p>æŒ‰ç…§åè¿›åˆ¶ä½æ•°å»å–ï¼Œç„¶åé€šè¿‡bucketæ¥å“ˆå¸Œåˆ¤æ–­æ˜¯å¦é‡å¤ï¼Œè¶…æ—¶ï¼Œæ„æ–™ä¹‹ä¸­</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">countNumbersWithUniqueDigits</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">10</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> max <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> max<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> temp <span class="token operator">=</span> i<span class="token punctuation">;</span>            <span class="token keyword">int</span> flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">while</span><span class="token punctuation">(</span>temp  <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>buc<span class="token punctuation">[</span>temp <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                buc<span class="token punctuation">[</span>temp <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>                temp <span class="token operator">/=</span> <span class="token number">10</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            res <span class="token operator">+=</span> flag<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><h3 id="2-æ’åˆ—ç»„åˆï¼ˆè½¬ï¼‰">2. æ’åˆ—ç»„åˆï¼ˆè½¬ï¼‰</h3><p>å¯¹n &gt; 1çš„æƒ…å†µ,nç”±n-1çš„å€¼(0 ~ 10 ^ (n-2)) å† åŠ ä¸Š (10 ^(n-1) ~ 10 ^(n - 1))å†³å®šï¼Œä¹Ÿå°±æ˜¯ä¸ªä½ä¸º1-9ï¼Œä¸ä¸º0ï¼Œåˆ™å‰©ä¸‹çš„ä½æ•°åˆ™åªèƒ½æœ‰9 - 8 - 7 â€¦ç§å–æ³•ï¼Œï¼ˆæ³¨æ„ n &gt; 8åå¿…ç„¶ä¼šæœ‰é‡å¤å–å€¼ï¼Œæ‰€ä»¥æœ€å¤§å€¼åœ¨n = 8æ—¶å–å¾—ï¼‰ã€‚ è¿™é‡Œçš„åšæ³•å…¶å®ä¹Ÿå¯ä»¥æœ‰dpçš„æ€æƒ³</p><p>$$dp[i] = dp[i - 1] + (dp[i-1] - dp[i - 2]) * (10- (i - 1))$$</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">countNumbersWithUniqueDigits</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">10</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> cur <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            cur <span class="token operator">*=</span> <span class="token number">9</span> <span class="token operator">-</span> i<span class="token punctuation">;</span>            res <span class="token operator">+=</span> cur<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// ä½œè€…ï¼šLeetCode-Solution</span><span class="token comment">// é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/count-numbers-with-unique-digits/solution/tong-ji-ge-wei-shu-zi-du-bu-tong-de-shu-iqbfn/</span></code></pre></div><p>è€—æ—¶å°±ä¸çœ‹äº† 100%ã€‚è¿™é“é¢˜è‡ªå·±åšçš„å¾ˆé­ï¼Œæœ€å¼€å§‹ æ˜¯æƒ³ç®—å‡ºæ¯ä¸€å±‚çš„ä¸æ»¡è¶³æ¡ä»¶çš„æ•°ï¼Œå°±åˆ†äº†å¾ˆå¤šç§æƒ…å†µï¼Œæƒ³ç´¯åŠ åˆ°ä¸€èµ·ï¼Œä½†ä¸€ç›´æœ‰ä¸ªå·®ä¸€äº›ï¼Œä¸çŸ¥é“æ˜¯å“ªé‡Œç®—é”™äº†ã€‚é¢˜è§£ç”¨æ­£å‘æ±‚è§£çš„æ–¹æ³•ç»“åˆæ’åˆ—ç»„åˆåšèµ·æ¥å°±å¾ˆå®¹æ˜“ï¼Œè‡ªå·±é‚£ç§æ–¹æ³•æƒ³äº†å¾ˆä¹…è¿˜æƒ³ä¸å¯¹<br>åæ€ï¼ä¹‹åå‘ç°é”™è¯¯æ¥æºï¼Œå¯¹å››ä½æ•°ï¼Œåªæœ‰2ä½é‡å¤çš„ï¼Œ<strong>æˆ‘è€ƒè™‘äº†aabcè¿™ç§ç±»å‹ï¼Œå´æ²¡æœ‰è€ƒè™‘aabbè¿™ç§ç±»å‹</strong>ï¼Œä¹Ÿæ˜¯2ä½é‡å¤çš„ï¼Œå¯¼è‡´æˆ‘ç®—çš„ç»“æœä¸€ç›´æ¯”æ­£ç¡®ç»“æœå°‘äº†243ï¼Œæ­£é¢å»è¯æ˜ç¡®å®ä¸æ˜¯å¾ˆå¥½è¯´æ˜</p><h3 id="åæ€-v8">åæ€</h3><ul><li>åˆ«çœ‹çš„å¤ªç»†è‡´ï¼Œæœ‰æ—¶å€™å®è§‚è€ƒè™‘</li></ul><h2 id="371-ä¸¤æ•´æ•°ä¹‹å’Œ-Â®-â­â­">371. ä¸¤æ•´æ•°ä¹‹å’Œ Â® â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-math">Permutation and Combination</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210926185614618.png" alt="image-20210926185614618"></p><h3 id="å®¡é¢˜-v27">å®¡é¢˜</h3><ul><li>ä½è¿ç®—</li></ul><h3 id="1-äºŒè¿›åˆ¶è®¡ç®—å™¨">1. äºŒè¿›åˆ¶è®¡ç®—å™¨</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getSum</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> aArr <span class="token operator">=</span> <span class="token function">getBinaryArr</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bArr <span class="token operator">=</span> <span class="token function">getBinaryArr</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> maxArr<span class="token punctuation">;</span>       <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> minArr<span class="token punctuation">;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>aArr<span class="token punctuation">.</span>length <span class="token operator">></span> bArr<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           maxArr <span class="token operator">=</span> aArr<span class="token punctuation">;</span>           minArr <span class="token operator">=</span> bArr<span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span> <span class="token keyword">else</span><span class="token punctuation">&#123;</span>           maxArr <span class="token operator">=</span> bArr<span class="token punctuation">;</span>           minArr <span class="token operator">=</span> aArr<span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>maxArr<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token keyword">boolean</span> needUp <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> minArr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>needUp<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>maxArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> minArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   needUp <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                   res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                   res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> maxArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">|</span> minArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>               <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>maxArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> minArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   needUp <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                   res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>maxArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">|</span> minArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                   needUp <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                   res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                   needUp <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> minArr<span class="token punctuation">.</span>length <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> maxArr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>needUp<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">if</span><span class="token punctuation">(</span>maxArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                   needUp <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                   res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>               res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> maxArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>needUp<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           res<span class="token punctuation">[</span>res<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> <span class="token function">getDenNum</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>      <span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getBinaryArr</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">int</span> origin <span class="token operator">=</span> num<span class="token punctuation">;</span>       <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>num<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>       <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       origin <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">while</span><span class="token punctuation">(</span>origin <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           i <span class="token operator">=</span> origin <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">;</span>           origin <span class="token operator">/=</span> <span class="token number">2</span><span class="token punctuation">;</span>           arr<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>           index <span class="token operator">++</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>num <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">boolean</span> needUp <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>           arr<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>           <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">-</span> arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>               arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>               <span class="token keyword">int</span> d <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>               needUp <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>               <span class="token keyword">while</span><span class="token punctuation">(</span>needUp<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   <span class="token keyword">if</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>d<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                       arr<span class="token punctuation">[</span>d<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                   <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                       arr<span class="token punctuation">[</span>d<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                       needUp <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                   <span class="token punctuation">&#125;</span>                   d<span class="token operator">++</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> arr<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getDenNum</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token keyword">int</span> mi <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               res<span class="token operator">+=</span>mi<span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>            mi <span class="token operator">*=</span> <span class="token number">2</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> res<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p>è¿™é‡Œä¸»è¦é€šè¿‡å°†a,bä¸¤æ•°å­—æ‹†åˆ†æˆäºŒè¿›åˆ¶è¿›è¡Œç›¸åŠ ï¼Œåœ¨äºŒè¿›åˆ¶å±‚é¢è¿›è¡Œæ•°çš„è¿ç®—</p><p>åšé¢˜æ‰€ç”¨çš„æ—¶é—´å¤ªä¹…äº†ï¼Œè¿™é‡Œä¸»è¦çš„é—®é¢˜åŒ…æ‹¬</p><ul><li>æœªè€ƒè™‘æ¸…æ¥šæ­£ã€è´Ÿçš„åŠ å‡æƒ…å†µï¼Œç”ŸæˆäºŒè¿›åˆ¶æ•°æ—¶åº”è¯¥è¦å¯¹å…¶è¿›è¡Œæ­£è´Ÿçš„åˆ¤æ–­å¹¶ä¸”è½¬æ¢</li><li>æœªä½¿ç”¨å‰¯æœ¬ï¼ˆnum =/ 2ï¼‰ã€‚ç›´æ¥ä½¿ç”¨åŸæ•°è¿›è¡Œè¿ç®—ï¼Œåé¢å°±é€ æˆäº†é”™è¯¯ç­”æ¡ˆ</li></ul><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210926185824078.png" alt="image-20210926185824078"></p><h3 id="2-ä½è¿ç®—-è½¬">2. ä½è¿ç®—(è½¬)</h3><p>è¿˜æ˜¯ä¸å¤ªæ‡‚è¿™é‡Œçš„ç®—æ³•ã€‚ã€‚ã€‚</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getSum</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>b <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> carry <span class="token operator">=</span> <span class="token punctuation">(</span>a <span class="token operator">&amp;</span> b<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">;</span>            a <span class="token operator">=</span> a <span class="token operator">^</span> b<span class="token punctuation">;</span>            b <span class="token operator">=</span> carry<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> a<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p>äºæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ•´æ•° a å’Œ b çš„å’Œï¼Œæ‹†åˆ†ä¸º a å’Œ b çš„<strong>æ— è¿›ä½åŠ æ³•ç»“æœ</strong>ä¸<strong>è¿›ä½ç»“æœ</strong>çš„å’Œã€‚</p><p>åŒæ—¶ï¼Œå¼‚æˆ–è¿ç®—^ ç»å¸¸ç”¨äº<strong>æ— è¿›ä½åŠ æ³•</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210926192743054.png" alt="image-20210926192743054"></p><h2 id="373-æŸ¥æ‰¾å’Œæœ€å°çš„Kå¯¹æ•°å­—-â­â­">373. æŸ¥æ‰¾å’Œæœ€å°çš„Kå¯¹æ•°å­— â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-queue">PriorityQueue</div><div class="code-tag-label code-tag-label-binary">Binary</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220114115323944.png" alt="image-20220114115323944"></p><h3 id="å®¡é¢˜-v28">å®¡é¢˜</h3><ul><li>æ•°ç»„æ˜¯å‡åºæ’åˆ—</li><li>åŒæŒ‡é’ˆï¼Ÿæ¯”è¾ƒå¤šä¸ªæ•°ï¼Ÿå¦‚ä½•è®°ä½å·²ç»é€‰äº†çš„æ•°ï¼Ÿï¼ˆå’Œç›¸ç­‰çš„æ—¶å€™æ— æ³•åˆ¤æ–­ï¼‰</li><li>å¯¹ç´¢å¼•ä¸º i çš„æ•°ç»„1å’Œç´¢å¼•ä¸º j çš„æ•°ç»„2ï¼Œæœ‰å¦‚ä¸‹æƒ…å†µï¼š<ul><li>j + 1 ,æ¯”è¾ƒ i = 0</li><li>i + 1 ,æ¯”è¾ƒ j = 0</li><li>ä»¥ä¸Šæƒ…å†µéƒ½è¦è€ƒè™‘æ˜¯å¦é‡å¤ï¼Œä¸”å¦‚æœjæˆ–è€…i = nums.lengthçš„æ—¶å€™ï¼Œè¦è€ƒè™‘é‡ç½®</li></ul></li></ul><h3 id="1-ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆè½¬ï¼‰">1. ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆè½¬ï¼‰</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span><span class="token punctuation">></span></span> <span class="token function">kSmallestPairs</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums1<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums2<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token class-name">PriorityQueue</span><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span> pq <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PriorityQueue</span><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">(</span>k<span class="token punctuation">,</span><span class="token punctuation">(</span>o1<span class="token punctuation">,</span>o2<span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>         <span class="token keyword">return</span> nums1<span class="token punctuation">[</span>o1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">+</span>nums2<span class="token punctuation">[</span>o1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">-</span> nums1<span class="token punctuation">[</span>o2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">-</span> nums2<span class="token punctuation">[</span>o2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// å…ˆæŒ‡å®šComparatorè§„åˆ™</span>     <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span><span class="token punctuation">></span></span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>nums1<span class="token punctuation">.</span>length<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         pq<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>i<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">// é¿å…çŸ›ç›¾æˆ–å†—ä½™</span>     <span class="token punctuation">&#125;</span>     <span class="token comment">// æ³¨æ„è¿™é‡Œæ”¾åœ¨tempä¸­çš„æ˜¯ç´¢å¼•è€Œä¸æ˜¯å€¼ï¼</span>     <span class="token keyword">while</span><span class="token punctuation">(</span>k<span class="token operator">--</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>pq<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> idxPair <span class="token operator">=</span> pq<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> temp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         temp<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>nums1<span class="token punctuation">[</span>idxPair<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         temp<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>nums2<span class="token punctuation">[</span>idxPair<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">// å…³é”®ã€‚å®ç°äº†å»¶ç»­åˆ¤æ–­åé¢çš„å€¼</span>         <span class="token keyword">if</span><span class="token punctuation">(</span>idxPair<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;</span> nums2<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>             pq<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>idxPair<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> idxPair<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>     <span class="token punctuation">&#125;</span>     <span class="token keyword">return</span> res<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></code></pre></div><p>è¿™é¢˜ç”¨ä¼˜å…ˆé˜Ÿåˆ—çš„æ–¹æ³•æœ‰é“ç†ã€‚å¸¦Comparatorçš„ä¼˜å…ˆé˜Ÿåˆ—èƒ½ä¿è¯åœ¨æŒ‡å®šçš„ä¸€æ®µåºåˆ—ä¸­è‚¯å®šæ˜¯æœ€å°çš„é‚£ä¸ªå…ˆå‡ºå»ï¼Œè‡ªç„¶å®ç°äº†æ’åºï¼›å¹¶ä¸”å…ˆåŠ å…¥ä¸€æ®µåºåˆ—ï¼Œæ¶ˆé™¤äº†å»é‡é—®é¢˜ï¼›æˆ‘è€ƒè™‘çš„ä¸åŒæƒ…å†µçš„åˆ¤æ–­ä¹Ÿåœ¨è¿™é‡Œå¾—åˆ°æ¶ˆé™¤ï¼›<br>æ—¶é—´å¤æ‚åº¦  k Â· Logk</p><p><em>å»¶ä¼¸ï¼šå­¦ä¹ ä¸€ä¸‹PriorityQueueçš„siftUp</em></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220114134046477.png" alt="image-20220114134046477"></p><h3 id="2-äºŒåˆ†æ³•ï¼ˆè½¬ï¼‰">2. äºŒåˆ†æ³•ï¼ˆè½¬ï¼‰</h3><p>æ‰¾åˆ°æœ€ä½³è¿‘ä¼¼å€¼ï¼Œå¾—åˆ°æ‰€æœ‰å°äºçš„æ•°å¯¹ ï¼Œæ‰¾åˆ°ç›¸ç­‰çš„å€¼çš„æ•°å¯¹</p><h2 id="380-O-1-æ—¶é—´æ’å…¥ã€åˆ é™¤å’Œè·å–éšæœºå…ƒç´ -â­â­">380. O(1)æ—¶é—´æ’å…¥ã€åˆ é™¤å’Œè·å–éšæœºå…ƒç´  â­â­</h2><div class="code-tag-time">2022/4/13 09:46:00</div><div class="code-tag-label code-tag-label-hash">Hash</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220413182507923.png" alt="image-20220413182507923"></p><h3 id="å®¡é¢˜-v29">å®¡é¢˜</h3><ul><li>æ’å…¥-åˆ é™¤å…ƒç´ å­˜åœ¨-ä¸å­˜åœ¨æ—¶ï¼Œè¿”å›false</li><li>éšæœºè¿”å›ï¼Œå¯ä»¥ç”¨ä¹‹å‰å­¦çš„æŠ¹é™¤ï¼Ÿ</li><li>æ€è·¯ï¼š<ul><li>æ’å…¥å’Œåˆ é™¤éƒ½è¦åˆ¤æ–­æ˜¯å¦å­˜åœ¨ï¼Œæ‰€ä»¥O1æ—¶é—´å†…ï¼Œåº”è¯¥ç”¨å“ˆå¸Œè¡¨</li><li>ä¸»è¦åœ¨äºéšæœºè¿”å›æ˜¯åŸºäºå“ˆå¸Œè¡¨çš„ï¼Œå¦‚ä½•åœ¨O1æ—¶é—´å†…è¿”å›ï¼Ÿ</li></ul></li></ul><h3 id="1-å“ˆå¸Œè¡¨-Random">1. å“ˆå¸Œè¡¨+Random</h3><p>Setå­˜æœ‰æ•ˆå€¼ï¼ŒMapå»æ ¹æ®é¡ºåºä¿å­˜å½“å‰æ’å…¥é¡ºåºä¸ºKeyçš„å€¼ï¼ŒéšæœºæŸ¥æ‰¾ä¸èƒ½åœ¨O1çš„æ—¶é—´å†…è¿”å›ï¼Œä¸”ä¸æ˜¯éšæœºæ¦‚ç‡çš„ï¼Œæ‰€ä»¥ç­”æ¡ˆæ˜¯æ— æ•ˆçš„</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">RandomizedSet</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> set<span class="token punctuation">;</span>    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> map<span class="token punctuation">;</span>    <span class="token keyword">int</span> size<span class="token punctuation">;</span>    <span class="token class-name">Random</span> rand<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">RandomizedSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        rand <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>set<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>size<span class="token operator">++</span><span class="token punctuation">,</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>set<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            set<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> randNum <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>set<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>randNum<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            randNum <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>randNum<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220413190943998.png" alt="image-20220413190943998"></p><h2 id="382-é“¾è¡¨éšæœºèŠ‚ç‚¹-â­â­">382. é“¾è¡¨éšæœºèŠ‚ç‚¹ â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-math">Inference</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220116185310605.png" alt="image-20220116185310605"></p><p><strong>å·²çŸ¥æ•°æ®æœ‰é™å¯¹å¤§æ•°æ®çš„éšæœºåŒ–é—®é¢˜çš„è§£å†³</strong></p><h3 id="å®¡é¢˜-v30">å®¡é¢˜</h3><ul><li><p><strong>æ¯ä¸ªèŠ‚ç‚¹è¢«é€‰ä¸­çš„æ¦‚ç‡ä¸€æ ·</strong></p></li><li><p>Solution æ˜¯ä¸€ä¸ªå•ç‹¬ç±»ï¼Œå¯ä»¥å†…å«è‡ªå·±çš„æ•°æ®ç»“æ„</p></li><li><p>å¦‚ä½•å®ç°éšæœºåŒ–å—ï¼Ÿ</p></li><li><p>åšæ³•ï¼šRandomå‡½æ•°è§£å†³è‚¯å®šå¤ªç®€å•äº†ã€‚</p></li></ul><h3 id="1-APIä½¿ç”¨">1. APIä½¿ç”¨</h3><p>ArrayList å’Œ Randomè”ç”¨</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> arr<span class="token punctuation">;</span>    <span class="token class-name">Random</span> rand<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">Solution</span><span class="token punctuation">(</span><span class="token class-name">ListNode</span> head<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">ListNode</span> temp <span class="token operator">=</span> head<span class="token punctuation">;</span>         rand <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        arr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>temp <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            arr<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>temp<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>            temp <span class="token operator">=</span> temp<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> i <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//         int i =(int) Math.floor((Math.random() * arr.size()));</span>        <span class="token keyword">return</span> arr<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220116190502069.png" alt="image-20220116190502069"></p><p>è™½ç„¶ç”¨äº†APIï¼Œä½†ç»“æœçœ‹èµ·æ¥è¿˜ä¸é”™â€¦ç¼ºç‚¹ï¼šåœ¨åˆå§‹åŒ–æ—¶ä¼šéå†æ‰€æœ‰çš„èŠ‚ç‚¹ï¼Œæœ‰LogNçš„æ—¶é—´å¤æ‚åº¦ï¼Œä¸åˆ‡å®é™…</p><p>å»æ‰Randomç±»æ”¹ç”¨Mathçš„randomæ–¹æ³•ä½¿å†…å­˜æ¶ˆè€—ç•¥æœ‰æå‡</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220116190933542.png" alt="image-20220116190933542"></p><p>æ€»çš„æ¥è¯´ï¼š</p><p>æ—¶é—´å¤æ‚åº¦ï¼šåˆå§‹åŒ–ä¸ºOn é€‰æ‹©æ—¶O1<br>ç©ºé—´å¤æ‚åº¦ï¼šOn</p><h3 id="2-è“„æ°´æ± -è½¬">2. è“„æ°´æ± (è½¬)</h3><p>è¿™é‡Œçš„é—®é¢˜ä¸»è¦æ˜¯åœ¨ä»…èƒ½å¤Ÿè¯»å–1ä¸ªæ•°æ®çš„æ—¶å€™ï¼Œå¦‚ä½•å®ç°å¤§æ•°æ®ä¸­çš„éšæœºåŒ–é—®é¢˜ã€‚å…³é”®çœ‹è¿™é‡Œ<strong>å¦‚ä½•ä¿è¯äº†å¾ªç¯æ—¶å–æ•°æ®çš„å¹³ç­‰æ¦‚ç‡</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220116193745179.png" alt="image-20220116193745179"></p><p><em><a href="https://leetcode-cn.com/problems/linked-list-random-node/solution/lian-biao-sui-ji-jie-dian-by-leetcode-so-x6it/">å›¾ç‰‡æ¥æº â€“ LeetCodeå®˜æ–¹é¢˜è§£</a></em></p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">ListNode</span> inner<span class="token punctuation">;</span>    <span class="token class-name">Random</span> random<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">Solution</span><span class="token punctuation">(</span><span class="token class-name">ListNode</span> head<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        inner <span class="token operator">=</span> head<span class="token punctuation">;</span>        random <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token class-name">ListNode</span> temp <span class="token operator">=</span> inner<span class="token punctuation">;</span>        <span class="token keyword">int</span> res <span class="token operator">=</span> temp<span class="token punctuation">.</span>val<span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>temp <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            i<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                res <span class="token operator">=</span> temp<span class="token punctuation">.</span>val<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            temp <span class="token operator">=</span> temp<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220116193005708.png" alt="image-20220116193005708"></p><h2 id="417-å¤ªå¹³æ´‹å¤§è¥¿æ´‹æ°´æµé—®é¢˜-â­â­">417. å¤ªå¹³æ´‹å¤§è¥¿æ´‹æ°´æµé—®é¢˜ â­â­</h2><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220427175123815.png" alt="image-20220427175123815"></p><h3 id="å®¡é¢˜-v31">å®¡é¢˜</h3><ul><li>ç†æ¸…æ€è·¯ï¼š<ul><li>å¦‚ä½•åˆ¤æ–­æ˜¯åˆ°å¤§è¥¿æ´‹è¿˜æ˜¯å¤ªå¹³æ´‹ï¼Ÿ<ul><li>å·¦ä¸Šæ–¹ (i == 0 || j == 0) &amp;&amp; value &gt; 0</li><li>å³ä¸‹æ–¹ (i == m - 1 || j == n - 1) &amp;&amp; value &gt; 0</li></ul></li><li>æ ¸å¿ƒé—®é¢˜ï¼Œæ‰¾åˆ°ä¸€æ¡è·¯å¾„èƒ½å¤Ÿè®©å½“å‰å…ƒç´ çš„å€¼åˆ†é…1ä¸ªç‚¹åœ¨å…¶ä»–è¾ƒå°å…ƒç´ ä¸”èƒ½åˆ°è¾¾è¾¹ç•Œ</li></ul></li></ul><h3 id="1-DFS">1. DFS</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span><span class="token punctuation">></span></span> <span class="token function">pacificAtlantic</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> heights<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span><span class="token punctuation">></span></span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> temp<span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> heights<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> heights<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">canGetPacific</span><span class="token punctuation">(</span>heights<span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">canGetPacific</span><span class="token punctuation">(</span>heights<span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    temp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    temp<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>                    temp<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>                    res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>               <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">canGetPacific</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> heights<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">,</span> <span class="token keyword">boolean</span> mode<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>mode<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> j <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> heights<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">||</span> j <span class="token operator">==</span> heights<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span> temp <span class="token operator">=</span> heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">boolean</span> canGet <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span> <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> heights<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> heights<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>            canGet <span class="token operator">=</span> <span class="token function">canGetPacific</span><span class="token punctuation">(</span>heights<span class="token punctuation">,</span>i <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">,</span> j<span class="token punctuation">,</span> mode<span class="token punctuation">)</span><span class="token punctuation">;</span>            heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>canGet <span class="token operator">&amp;&amp;</span> i <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;</span> heights<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> heights<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span>  <span class="token operator">&amp;&amp;</span> heights<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>            canGet <span class="token operator">=</span> <span class="token function">canGetPacific</span><span class="token punctuation">(</span>heights<span class="token punctuation">,</span>i <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">,</span> j<span class="token punctuation">,</span> mode<span class="token punctuation">)</span><span class="token punctuation">;</span>            heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>canGet <span class="token operator">&amp;&amp;</span> j <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span>  <span class="token operator">&amp;&amp;</span> heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>            canGet <span class="token operator">=</span> <span class="token function">canGetPacific</span><span class="token punctuation">(</span>heights<span class="token punctuation">,</span>i <span class="token punctuation">,</span> j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> mode<span class="token punctuation">)</span><span class="token punctuation">;</span>            heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>canGet <span class="token operator">&amp;&amp;</span> j <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;</span> heights<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span>  heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>            canGet <span class="token operator">=</span> <span class="token function">canGetPacific</span><span class="token punctuation">(</span>heights<span class="token punctuation">,</span>i <span class="token punctuation">,</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> mode<span class="token punctuation">)</span><span class="token punctuation">;</span>            heights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> canGet<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span></code></pre></div><h4 id="Mapä¼˜åŒ–">Mapä¼˜åŒ–</h4><p>æ•ˆæœä¸æ˜æ˜¾</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token operator">*</span><span class="token punctuation">(</span>heights<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">+</span> j<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token operator">*</span><span class="token punctuation">(</span>heights<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">+</span> j<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span>canGet<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>i<span class="token operator">*</span><span class="token punctuation">(</span>heights<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token operator">+</span>j<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>     </code></pre></div><h2 id="430-æ‰å¹³åŒ–å¤šçº§åŒå‘é“¾è¡¨ï¼ˆRï¼‰-â­â­">430. æ‰å¹³åŒ–å¤šçº§åŒå‘é“¾è¡¨ï¼ˆRï¼‰ â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-dfs">DFS</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210924152929520.png" alt="image-20210924152929520"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210924152935954.png" alt="image-20210924152935954"></p><h3 id="å®¡é¢˜-v32">å®¡é¢˜</h3><ul><li>DFSï¼Ÿ</li></ul><h3 id="1-å›æº¯æ³•ï¼ˆÃ—ï¼‰">1. å›æº¯æ³•ï¼ˆÃ—ï¼‰</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Node</span> pre <span class="token operator">=</span> head<span class="token punctuation">;</span>        <span class="token class-name">Node</span> result <span class="token operator">=</span> pre<span class="token punctuation">;</span>        <span class="token class-name">Node</span> mid <span class="token operator">=</span> head<span class="token punctuation">;</span>        <span class="token class-name">Queue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Node</span><span class="token punctuation">></span></span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">boolean</span> isJump <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>mid <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">Node</span> pullNode <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>pullNode <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                isJump <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                mid <span class="token operator">=</span> pullNode<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>mid<span class="token punctuation">.</span>child <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>isJump<span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>                queue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">;</span>                pre<span class="token punctuation">.</span>next <span class="token operator">=</span> mid<span class="token punctuation">.</span>child<span class="token punctuation">;</span>                mid <span class="token operator">=</span> mid<span class="token punctuation">.</span>child<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>mid<span class="token punctuation">.</span>next <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                pre<span class="token punctuation">.</span>next <span class="token operator">=</span> mid<span class="token punctuation">.</span>next<span class="token punctuation">;</span>                mid <span class="token operator">=</span> mid<span class="token punctuation">.</span>next<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span><span class="token punctuation">&#123;</span>                mid <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            pre <span class="token operator">=</span> pre<span class="token punctuation">.</span>next<span class="token punctuation">;</span>            isJump <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> result<span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span></code></pre></div><p>è¿™é‡Œæ²¡æœ‰åšå‡ºæ¥ï¼Œæƒ³æ³•å’Œå›æº¯æ˜¯ä¸€æ ·çš„ï¼Œä¸è¿‡åœ¨å‹æ ˆçš„è€ƒè™‘ä¸Šï¼Œå¯¹å¯¹è±¡å¼•ç”¨ååˆ†ä¸ç†Ÿæ‚‰ã€‚ã€‚å¯¼è‡´å‹äº†ä¹‹åè¿˜æ˜¯ä¼šæ”¹å˜å€¼</p><p>**åæ€ï¼š**javaå¯¹è±¡å¼•ç”¨</p><h3 id="2-å›æº¯æ³•ï¼ˆè½¬ï¼‰">2. å›æº¯æ³•ï¼ˆè½¬ï¼‰</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">Node</span> <span class="token function">flatten</span><span class="token punctuation">(</span><span class="token class-name">Node</span> head<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token class-name">Node</span> node <span class="token operator">=</span> head<span class="token punctuation">;</span>      <span class="token class-name">Node</span> prev <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>      <span class="token class-name">Deque</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Node</span><span class="token punctuation">></span></span> stack <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayDeque</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">while</span> <span class="token punctuation">(</span>node <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token operator">!</span>stack<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              node <span class="token operator">=</span> stack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              node<span class="token punctuation">.</span>prev <span class="token operator">=</span> prev<span class="token punctuation">;</span>              prev<span class="token punctuation">.</span>next <span class="token operator">=</span> node<span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>child <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>next <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> stack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>next<span class="token punctuation">)</span><span class="token punctuation">;</span>              node<span class="token punctuation">.</span>child<span class="token punctuation">.</span>prev <span class="token operator">=</span> node<span class="token punctuation">;</span>              node<span class="token punctuation">.</span>next <span class="token operator">=</span> node<span class="token punctuation">.</span>child<span class="token punctuation">;</span>              node<span class="token punctuation">.</span>child <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>          prev <span class="token operator">=</span> node<span class="token punctuation">;</span>          node <span class="token operator">=</span> node<span class="token punctuation">.</span>next<span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">return</span> head<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210924175258855.png" alt="image-20210924175258855"></p><h3 id="3-DFSï¼ˆè½¬ï¼‰">3. DFSï¼ˆè½¬ï¼‰</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">Node</span> <span class="token function">flatten</span><span class="token punctuation">(</span><span class="token class-name">Node</span> head<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> head<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">Node</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token class-name">Node</span> node<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Node</span> cur <span class="token operator">=</span> node<span class="token punctuation">;</span>        <span class="token comment">// è®°å½•é“¾è¡¨çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹</span>        <span class="token class-name">Node</span> last <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>cur <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Node</span> next <span class="token operator">=</span> cur<span class="token punctuation">.</span>next<span class="token punctuation">;</span>            <span class="token comment">//  å¦‚æœæœ‰å­èŠ‚ç‚¹ï¼Œé‚£ä¹ˆé¦–å…ˆå¤„ç†å­èŠ‚ç‚¹</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>cur<span class="token punctuation">.</span>child <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">Node</span> childLast <span class="token operator">=</span> <span class="token function">dfs</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>child<span class="token punctuation">)</span><span class="token punctuation">;</span>                next <span class="token operator">=</span> cur<span class="token punctuation">.</span>next<span class="token punctuation">;</span>                <span class="token comment">//  å°† node ä¸ child ç›¸è¿</span>                cur<span class="token punctuation">.</span>next <span class="token operator">=</span> cur<span class="token punctuation">.</span>child<span class="token punctuation">;</span>                cur<span class="token punctuation">.</span>child<span class="token punctuation">.</span>prev <span class="token operator">=</span> cur<span class="token punctuation">;</span>                <span class="token comment">//  å¦‚æœ next ä¸ä¸ºç©ºï¼Œå°±å°† last ä¸ next ç›¸è¿</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>next <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    childLast<span class="token punctuation">.</span>next <span class="token operator">=</span> next<span class="token punctuation">;</span>                    next<span class="token punctuation">.</span>prev <span class="token operator">=</span> childLast<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token comment">// å°† child ç½®ä¸ºç©º</span>                cur<span class="token punctuation">.</span>child <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>                last <span class="token operator">=</span> childLast<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                last <span class="token operator">=</span> cur<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            cur <span class="token operator">=</span> next<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> last<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210924180621400.png" alt="image-20210924180621400"></p><h2 id="437-è·¯å¾„æ€»å’Œ-I-R-â­â­">437. è·¯å¾„æ€»å’Œ (I R) â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-dfs">DFS</div><div class="code-tag-label code-tag-label-presum">Prefix Sum</div><div class="code-tag-label code-tag-label-tree">Tree</div><div class="code-tag-label code-tag-label-foreach">InOrder Traversal</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210928150705690.png" alt="image-20210928150705690"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210928150712358.png" alt="image-20210928150712358"></p><h3 id="å®¡é¢˜-v33">å®¡é¢˜</h3><ul><li>äºŒå‰æ ‘ï¼Œæ²¡æœ‰çš„èŠ‚ç‚¹ç”¨nullè¡¨ç¤º</li><li>åŒä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥æœ‰å¤šä¸ªç»„åˆ</li><li>åŒ…å«è´Ÿæ•°</li><li>è·¯å¾„å¿…é¡»æ˜¯å‘ä¸‹ï¼å·¦å³å­èŠ‚ç‚¹ä¸é™</li><li>é¦–å…ˆè¦ç¡®å®šéå†æ–¹å¼ï¼Œä¸­åºéå†ã€‚</li><li>å¦‚ä½•ä¿å­˜æŸä¸ªèŠ‚ç‚¹çš„é€’åŠ å€¼ï¼Ÿdpï¼Ÿ</li><li>ä»¥æŸä¸ªèŠ‚ç‚¹å¼€å§‹å¾ˆé‡è¦ã€‚ä»¥æŸä¸ªèŠ‚ç‚¹ç»“æŸä¸é‡è¦ã€‚ç¡®å®šéå†æ–¹å¼</li></ul><h3 id="1-é€’å½’-x">1. é€’å½’(x)</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>   <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">pathSum</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> root<span class="token punctuation">,</span> <span class="token keyword">int</span> targetSum<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token class-name">TreeNode</span> node <span class="token operator">=</span> root<span class="token punctuation">;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>node <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token function">pathSum</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>left<span class="token punctuation">,</span> targetSum<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Parent node : "</span> <span class="token operator">+</span>node<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token function">isNodeEqualNum</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span>targetSum<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token function">pathSum</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>right<span class="token punctuation">,</span> targetSum<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> res<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">int</span> <span class="token function">isNodeEqualNum</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> node<span class="token punctuation">,</span> <span class="token keyword">int</span> targetSum<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>node <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">int</span> onLeft <span class="token operator">=</span> <span class="token function">isNodeEqualNum</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>left<span class="token punctuation">,</span> targetSum<span class="token punctuation">)</span> <span class="token operator">+</span> node<span class="token punctuation">.</span>val<span class="token punctuation">;</span>       <span class="token keyword">int</span> onMid <span class="token operator">=</span> <span class="token function">isNodeEqualNum</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span>targetSum<span class="token punctuation">)</span> <span class="token operator">+</span>node<span class="token punctuation">.</span>val<span class="token punctuation">;</span>       <span class="token keyword">int</span> onRight <span class="token operator">=</span> <span class="token function">isNodeEqualNum</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>right<span class="token punctuation">,</span> targetSum<span class="token punctuation">)</span> <span class="token operator">+</span> node<span class="token punctuation">.</span>val<span class="token punctuation">;</span>       <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">" Currentnode: "</span> <span class="token operator">+</span> node<span class="token punctuation">.</span>val <span class="token operator">+</span> <span class="token string">"  l m r"</span> <span class="token operator">+</span> onLeft<span class="token operator">+</span><span class="token string">" "</span><span class="token operator">+</span>onMid<span class="token operator">+</span><span class="token string">" "</span><span class="token operator">+</span>onRight<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>onLeft <span class="token operator">==</span> targetSum<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"head left"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           res<span class="token operator">++</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>onRight <span class="token operator">==</span> targetSum<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"head right"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           res<span class="token operator">++</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>onMid <span class="token operator">==</span> targetSum<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"head mid"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           res<span class="token operator">++</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> node<span class="token punctuation">.</span>val<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p>è¿™é‡Œæœ‰æƒ³åˆ°ç±»ä¼¼å½’å¹¶æ’åºçš„é‚£ç§åˆ†æ²»ï¼Œä½†æ˜¯æ²¡æœ‰è€ƒè™‘åˆ°åç»­çš„ç»“æœå¦‚ä½•å åŠ ï¼Œä¸‰ç§æƒ…å†µä¸‹å¦‚ä½•return åˆ°æƒ³è¦çš„ç´¯åŠ å€¼ã€‚å§‹ç»ˆä¿ç•™åœ¨ä¸¤å±‚é€’å½’ï¼Œè€Œä¸æ˜¯å¤šå±‚â€¦</p><h3 id="2-å‰ç¼€å’Œ-è½¬">2. å‰ç¼€å’Œ(è½¬)</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">pathSum</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> root<span class="token punctuation">,</span> <span class="token keyword">int</span> sum<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// keyæ˜¯å‰ç¼€å’Œ, valueæ˜¯å¤§å°ä¸ºkeyçš„å‰ç¼€å’Œå‡ºç°çš„æ¬¡æ•°</span>        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> prefixSumCount <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// å‰ç¼€å’Œä¸º0çš„ä¸€æ¡è·¯å¾„</span>        prefixSumCount<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// å‰ç¼€å’Œçš„é€’å½’å›æº¯æ€è·¯</span>        <span class="token keyword">return</span> <span class="token function">recursionPathSum</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> prefixSumCount<span class="token punctuation">,</span> sum<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * å‰ç¼€å’Œçš„é€’å½’å›æº¯æ€è·¯     * ä»å½“å‰èŠ‚ç‚¹åæ¨åˆ°æ ¹èŠ‚ç‚¹(åæ¨æ¯”è¾ƒå¥½ç†è§£ï¼Œæ­£å‘å…¶å®ä¹Ÿåªæœ‰ä¸€æ¡)ï¼Œæœ‰ä¸”ä»…æœ‰ä¸€æ¡è·¯å¾„ï¼Œå› ä¸ºè¿™æ˜¯ä¸€æ£µæ ‘     * å¦‚æœæ­¤å‰æœ‰å’Œä¸ºcurrSum-target,è€Œå½“å‰çš„å’Œåˆä¸ºcurrSum,ä¸¤è€…çš„å·®å°±è‚¯å®šä¸ºtargetäº†     * æ‰€ä»¥å‰ç¼€å’Œå¯¹äºå½“å‰è·¯å¾„æ¥è¯´æ˜¯å”¯ä¸€çš„ï¼Œå½“å‰è®°å½•çš„å‰ç¼€å’Œï¼Œåœ¨å›æº¯ç»“æŸï¼Œå›åˆ°æœ¬å±‚æ—¶å»é™¤ï¼Œä¿è¯å…¶ä¸å½±å“å…¶ä»–åˆ†æ”¯çš„ç»“æœ     * @param node æ ‘èŠ‚ç‚¹     * @param prefixSumCount å‰ç¼€å’ŒMap     * @param target ç›®æ ‡å€¼     * @param currSum å½“å‰è·¯å¾„å’Œ     * @return æ»¡è¶³é¢˜æ„çš„è§£     */</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">recursionPathSum</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> node<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> prefixSumCount<span class="token punctuation">,</span> <span class="token keyword">int</span> target<span class="token punctuation">,</span> <span class="token keyword">int</span> currSum<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// 1.é€’å½’ç»ˆæ­¢æ¡ä»¶</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// 2.æœ¬å±‚è¦åšçš„äº‹æƒ…</span>        <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token comment">// å½“å‰è·¯å¾„ä¸Šçš„å’Œ</span>        currSum <span class="token operator">+=</span> node<span class="token punctuation">.</span>val<span class="token punctuation">;</span>        <span class="token comment">//---æ ¸å¿ƒä»£ç </span>        <span class="token comment">// çœ‹çœ‹rootåˆ°å½“å‰èŠ‚ç‚¹è¿™æ¡è·¯ä¸Šæ˜¯å¦å­˜åœ¨èŠ‚ç‚¹å‰ç¼€å’ŒåŠ targetä¸ºcurrSumçš„è·¯å¾„</span>        <span class="token comment">// å½“å‰èŠ‚ç‚¹->rootèŠ‚ç‚¹åæ¨ï¼Œæœ‰ä¸”ä»…æœ‰ä¸€æ¡è·¯å¾„ï¼Œå¦‚æœæ­¤å‰æœ‰å’Œä¸ºcurrSum-target,è€Œå½“å‰çš„å’Œåˆä¸ºcurrSum,ä¸¤è€…çš„å·®å°±è‚¯å®šä¸ºtargetäº†</span>        <span class="token comment">// currSum-targetç›¸å½“äºæ‰¾è·¯å¾„çš„èµ·ç‚¹ï¼Œèµ·ç‚¹çš„sum+target=currSumï¼Œå½“å‰ç‚¹åˆ°èµ·ç‚¹çš„è·ç¦»å°±æ˜¯target</span>        res <span class="token operator">+=</span> prefixSumCount<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>currSum <span class="token operator">-</span> target<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// æ›´æ–°è·¯å¾„ä¸Šå½“å‰èŠ‚ç‚¹å‰ç¼€å’Œçš„ä¸ªæ•°</span>        prefixSumCount<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>currSum<span class="token punctuation">,</span> prefixSumCount<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>currSum<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//---æ ¸å¿ƒä»£ç </span>        <span class="token comment">// 3.è¿›å…¥ä¸‹ä¸€å±‚</span>        res <span class="token operator">+=</span> <span class="token function">recursionPathSum</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>left<span class="token punctuation">,</span> prefixSumCount<span class="token punctuation">,</span> target<span class="token punctuation">,</span> currSum<span class="token punctuation">)</span><span class="token punctuation">;</span>        res <span class="token operator">+=</span> <span class="token function">recursionPathSum</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>right<span class="token punctuation">,</span> prefixSumCount<span class="token punctuation">,</span> target<span class="token punctuation">,</span> currSum<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 4.å›åˆ°æœ¬å±‚ï¼Œæ¢å¤çŠ¶æ€ï¼Œå»é™¤å½“å‰èŠ‚ç‚¹çš„å‰ç¼€å’Œæ•°é‡</span>        <span class="token comment">// è¿™é‡Œè¿™ä¸€æ­¥éå¸¸é‡è¦ï¼é¿å…ç”±äºMapä¸­å§‹ç»ˆä¿ç•™è¯¥è·¯å¾„çš„å€¼è€Œé‡å¤è®¡ç®—</span>        prefixSumCount<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>currSum<span class="token punctuation">,</span> prefixSumCount<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>currSum<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// ä½œè€…ï¼šburning-summer</span><span class="token comment">// é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/path-sum-iii/solution/qian-zhui-he-di-gui-hui-su-by-shi-huo-de-xia-tian/</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210929100111640.png" alt="image-20210929100111640"></p><p>å­¦ä¹ åˆ°è¿™é‡Œçš„ä¸€ç§å‰ç¼€å’Œæ€æƒ³ï¼Œå¯ä»¥ç”¨Map(cur - target)è¿™ç§æ–¹å¼æ¥è§£å†³ï¼Œç±»ä¼¼ä¹‹å‰çœ‹åˆ°çš„å¿«é€Ÿåœ¨1 - 100 æ‰¾åˆ°ä¸ä¸€ä¸ªæ•° ç›¸åŠ  == 100çš„æ•°ï¼Œè€Œä¸”<strong>å¦‚ä½•æ¸…é€€æ‰ä¹‹å‰å­˜å‚¨çš„æ•°</strong>ã€<strong>å¦‚ä½•é€‰æ‹©é€’å½’é¡ºåº</strong>ã€<strong>å¦‚ä½•é€’å½’ç´¯åŠ ç»“æœ</strong>ï¼Œè¿™æ˜¯éœ€è¦é‡æ–°æ€è€ƒçš„</p><h3 id="3-DFS-è½¬">3. DFS (è½¬)</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">pathSum</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> root<span class="token punctuation">,</span> <span class="token keyword">int</span> targetSum<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token comment">// è¿™ä¸ªå½¢å¼éå¸¸é‡è¦ï¼ï¼ï¼</span>        <span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token function">rootSum</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> targetSum<span class="token punctuation">)</span><span class="token punctuation">;</span>        ret <span class="token operator">+=</span> <span class="token function">pathSum</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>left<span class="token punctuation">,</span> targetSum<span class="token punctuation">)</span><span class="token punctuation">;</span>        ret <span class="token operator">+=</span> <span class="token function">pathSum</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>right<span class="token punctuation">,</span> targetSum<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> ret<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">rootSum</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> root<span class="token punctuation">,</span> <span class="token keyword">int</span> targetSum<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span> val <span class="token operator">=</span> root<span class="token punctuation">.</span>val<span class="token punctuation">;</span>        <span class="token comment">// â‘ </span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>val <span class="token operator">==</span> targetSum<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            ret<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token comment">// è§£å†³é€’å½’è§£å†³ä¸äº†å½“å‰å‰ç¼€å’Œçš„é—®é¢˜ targetSum - valï¼Œç„¶ååœ¨â‘ ä¸­å»åˆ¤æ–­</span>        <span class="token comment">// è¿™ä¸€æ­¥å¾ˆå·§å¦™</span>        ret <span class="token operator">+=</span> <span class="token function">rootSum</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>left<span class="token punctuation">,</span> targetSum <span class="token operator">-</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>        ret <span class="token operator">+=</span> <span class="token function">rootSum</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>right<span class="token punctuation">,</span> targetSum <span class="token operator">-</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> ret<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210929101232901.png" alt="image-20210929101232901"></p><p>ä¸ºä»€ä¹ˆä¼šæ¯”å‰ç¼€å’Œæ…¢è¿™ä¹ˆå¤šï¼Ÿ O(N<sup>2</sup>)çš„æ—¶é—´å¤æ‚åº¦(å…¨ä½“éå† + å¯¹æ¯ä¸ªèŠ‚ç‚¹ä½œä¸ºçˆ¶èŠ‚ç‚¹çš„éå†)</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210929101549611.png" alt="image-20210929101549611"></p><p>è¿™æ‰æ˜¯æˆ‘æƒ³è¦çš„æ–¹æ³•çš„æ­£è§£ï¼Œ<strong>å½’å¹¶æ’åºæ²¡æœ‰ææ¸…æ¥š</strong>ã€‚node ã€leftã€rightçš„å¯¹åº”å‡½æ•°è°ƒç”¨å…³ç³»æ··ä¹±äº†ï¼ŒåŒºåˆ†ä¸€ä¸‹ã€‚</p><p>è¿™é‡Œå¦‚ä½•å¾—åˆ°åœ¨é€’å½’ä¸­å‰ç¼€å’Œçš„å€¼ä¹Ÿéœ€è¦å…³æ³¨ã€‚</p><h2 id="440-å­—å…¸åºçš„ç¬¬Kå°çš„æ•°å­—-â­â­â­">440. å­—å…¸åºçš„ç¬¬Kå°çš„æ•°å­— â­â­â­</h2><blockquote><p>Time : 2022 / 3 / 23 22:07<br>TAG:</p></blockquote><h3 id="å®¡é¢˜-v34">å®¡é¢˜</h3><ul><li>æ³¨æ„æ˜¯å­—å…¸åºçš„æ’åºï¼Œå¹¶ä¸”æ˜¯1 - n çš„æ•°å­—ã€‚</li><li>ç‰¹æ®Šç‚¹ï¼š12345ï¼Œåˆ™æœ‰1 10 11 12â€¦100 â€¦ 1000 â€¦ 10000 â€¦ 12345</li><li>æ€è·¯ï¼š<ul><li>ç›´æ¥ï¼š<ul><li>æ ¹æ®nçš„å¤§å°åˆ¤æ–­ï¼Œå…ˆçœ‹æ•°é‡çº§ã€‚æ ¹æ®å…·ä½“æ•°é‡çº§<ol><li>æ•°é‡çº§</li><li>åœ¨</li></ol></li></ul></li></ul></li></ul><p><strong>å°è¯•å¤±è´¥â€¦</strong></p><h2 id="447-å›æ—‹é•–çš„æ•°é‡-â­â­">447. å›æ—‹é•–çš„æ•°é‡ â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-hash">Hash</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210913202552248.png" alt="image-20210913202552248"></p><h3 id="å®¡é¢˜-v35">å®¡é¢˜</h3><ul><li>è·ç¦»ç›¸ç­‰</li><li>è€ƒè™‘é¡ºåº</li><li>jã€kä¸ç­‰ï¼Œåˆ™å¿…æœ‰ä¸¤ç§å¯èƒ½</li><li>å¯èƒ½æ˜¯æ•°å­¦å…¬å¼ï¼Ÿ</li><li>åŠ¨æ€è§„åˆ’ï¼ŸOn*nå¤æ‚åº¦ï¼Ÿ</li></ul><p>è‡ªå·±æƒ³çš„äºŒä½æ•°ç»„å­˜å‚¨æ¯ä¸ªç‚¹å¯¹åº”å…¶ä»–ç‚¹çš„å€¼ï¼Œç„¶åæŸ¥çœ‹äºŒä½æ•°ç»„ä¸­æ¯è¡Œæ•°ç»„ç›¸åŒå€¼æœ‰å‡ ä¸ªï¼Œé€šè¿‡æ’åˆ—ç»„åˆåšã€‚</p><p>æ²¡åšå‡ºæ¥ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><h3 id="æšä¸¾-å“ˆå¸Œè¡¨ï¼ˆè½¬ï¼‰">æšä¸¾+å“ˆå¸Œè¡¨ï¼ˆè½¬ï¼‰</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">numberOfBoomerangs</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> points<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> p <span class="token operator">:</span> points<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> cnt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> q <span class="token operator">:</span> points<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> dis <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> q<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> q<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> q<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> q<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            cnt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>dis<span class="token punctuation">,</span> cnt<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>dis<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> entry <span class="token operator">:</span> cnt<span class="token punctuation">.</span><span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> m <span class="token operator">=</span> entry<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            ans <span class="token operator">+=</span> m <span class="token operator">*</span> <span class="token punctuation">(</span>m <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> ans<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>æ²¡æƒ³åˆ°æœ€ç»ˆæœ€åˆæ¥å±…ç„¶æ˜¯è‡ªå·±æœ€å¼€å§‹æƒ³çš„æ€è·¯ã€‚ã€‚ã€‚ã€‚å«Œå¼ƒHashMapå¤ªæ…¢è‡ªå·±ç”¨æ•°ç»„æ•£åˆ—ï¼Œç»“æœå±æ²¡åšå‡ºæ¥ã€‚ã€‚è£‚å¼€</p><p>æ²¡åšå‡ºæ¥ï¼š</p><ul><li>å› ä¸ºè¿™é‡Œé‡å¤è€ƒè™‘æ—¶è‡ªå·±æ²¡æƒ³æ¸…æ¥šï¼Œæœ‰mä¸ªç‚¹åˆ°ç¬¬iä¸ªç‚¹ç›¸ç­‰ã€‚</li><li>æ’åˆ—ç»„åˆæ•°å­¦å…¬å¼æœ‰é—®é¢˜</li></ul><p>ä»¥åè¿˜æ˜¯<strong>å…ˆè€ƒè™‘åšå‡ºæ¥ï¼Œå†æƒ³ä¼˜åŒ–ï¼ï¼ï¼ï¼</strong></p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">numberOfBoomerangs</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> points<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> total <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>points<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">long</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">long</span><span class="token punctuation">[</span>points<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">[</span>points<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> points<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">long</span> max <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> points<span class="token punctuation">.</span>length<span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">long</span> temp <span class="token operator">=</span> <span class="token function">getPointsDistance</span><span class="token punctuation">(</span>points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>points<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                max <span class="token operator">=</span> max<span class="token operator">></span>temp<span class="token operator">?</span> max<span class="token operator">:</span>temp<span class="token punctuation">;</span>                res<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            res<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>points<span class="token punctuation">.</span>length<span class="token punctuation">]</span> <span class="token operator">=</span> max<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> points<span class="token punctuation">.</span>length <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> column <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>res<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>points<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">long</span> max<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">long</span><span class="token punctuation">[</span>column<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> points<span class="token punctuation">.</span>length<span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                max<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> res<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> max<span class="token punctuation">.</span>length<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>max<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    total <span class="token operator">+=</span> <span class="token function">getSequenceCompose</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> max<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> total<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getPointsDistance</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> one<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> two<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">long</span> res <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token punctuation">(</span>one<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">-</span>two<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>one<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">-</span>two<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>one<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">-</span>two<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">*</span> <span class="token punctuation">(</span>one<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">-</span>two<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getSequenceCompose</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token function">reveseMutiple</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token function">reveseMutiple</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">reveseMutiple</span><span class="token punctuation">(</span>num<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">reveseMutiple</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> total <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> n<span class="token punctuation">;</span>i<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            total <span class="token operator">*=</span> i<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> total<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p>è‡ªå·±ä¿®äº†ä¸‹ä¹‹å‰å†™çš„ä»£ç ï¼Œæœ€åç»“æœåº”è¯¥æ˜¯æ­£ç¡®çš„ï¼Œä½†å†…å­˜æ¶ˆè€—å¤ªå¤§äº†ï¼Œå¯¼è‡´è¶…å‡ºäº†å†…å­˜é™åˆ¶â€¦Shitï¼</p><h2 id="534-é€šè¿‡åˆ é™¤å­—æ¯åŒ¹é…åˆ°å­—å…¸é‡Œæœ€é•¿å•è¯-â­â­">534. é€šè¿‡åˆ é™¤å­—æ¯åŒ¹é…åˆ°å­—å…¸é‡Œæœ€é•¿å•è¯ â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><div class="code-tag-label code-tag-label-sort">Sort</div><div class="code-tag-label code-tag-label-dp">DP</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210914184047505.png" alt="image-20210914184047505"></p><h3 id="å®¡é¢˜-v36">å®¡é¢˜</h3><ul><li>å¯é€šè¿‡åˆ é™¤sä¸­çš„<strong>æŸäº›å­—ç¬¦</strong></li><li>ç­”æ¡ˆä¸æ­¢ä¸€ä¸ªï¼Œåˆ™è¿”å›é•¿åº¦æœ€é•¿ä¸”å­—å…¸åºæœ€å°çš„å­—ç¬¦ä¸²</li></ul><h3 id="1-æš´åŠ›è¿­ä»£-åŒæŒ‡é’ˆ">1. æš´åŠ›è¿­ä»£+åŒæŒ‡é’ˆ</h3><p>ç®€å•è¿­ä»£æ³•ï¼Œæ¯”è¾ƒç¬¨ã€‚</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">findLongestWord</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> dictionary<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token operator">:</span>dictionary<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">int</span> sIndex <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span>           <span class="token keyword">int</span> dIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>           <span class="token keyword">while</span><span class="token punctuation">(</span>sIndex <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> dIndex <span class="token operator">&lt;</span> str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>sIndex<span class="token punctuation">)</span> <span class="token operator">==</span> str<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>dIndex<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                   dIndex<span class="token operator">++</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>               sIndex<span class="token operator">++</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>dIndex <span class="token operator">==</span> str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               result<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token class-name">String</span> maxStr <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token operator">:</span>result<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> maxStr<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               maxStr <span class="token operator">=</span> str<span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> maxStr<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">judgeStrSeq</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span>maxStr<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                   maxStr <span class="token operator">=</span> str<span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> maxStr<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span><span class="token comment">// æ¯”è¾ƒå­—ç¬¦ä¸²çš„å­—å…¸åº,è¿™é‡Œç”¨compareToå°±è¡Œ</span>   <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">judgeStrSeq</span><span class="token punctuation">(</span><span class="token class-name">String</span> o<span class="token punctuation">,</span><span class="token class-name">String</span> a<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> o<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&lt;</span> a<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">></span> a<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210914190012309.png" alt="image-20210914190012309"></p><p>ä¼˜åŒ–ï¼Œè¿™é‡Œå¯ä»¥ä¸è¦æ•°ç»„ï¼Œç›´æ¥ä¸€ä¸ªmaxSträ½œä¸ºæ¯”è¾ƒå¯¹è±¡ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(dÃ—(m+n))ï¼Œå…¶ä¸­ dd è¡¨ç¤º dictionary çš„é•¿åº¦ï¼Œmè¡¨ç¤º s çš„é•¿åº¦ï¼Œn è¡¨ç¤º dictionary ä¸­å­—ç¬¦ä¸²çš„å¹³å‡é•¿åº¦ã€‚æˆ‘ä»¬éœ€è¦éå†}dictionary ä¸­çš„ d ä¸ªå­—ç¬¦ä¸²ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²éœ€è¦ O(n+m) çš„æ—¶é—´å¤æ‚åº¦æ¥åˆ¤æ–­è¯¥å­—ç¬¦ä¸²æ˜¯å¦ä¸º s çš„å­åºåˆ—ã€‚</p><h3 id="2-æ’åºï¼ˆè½¬ï¼‰">2. æ’åºï¼ˆè½¬ï¼‰</h3><p>æœ‰ æƒ³åˆ°è¿™ä¸ªæ–¹æ³•ï¼Œå…ˆæ’åºï¼Œé•¿åº¦ä»é•¿åˆ°çŸ­é¡ºåºæ¥ç­›é€‰ï¼Œæ›´å®¹æ˜“åˆ é€‰åˆ°ç»“æœï¼Œè¿™é‡Œä¸æ¸…æ¥šå¦‚ä½•å¯¹ä¸€ä¸ªæ•°ç»„è¿›è¡Œè‡ªå®šä¹‰æ’åºäº†</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token comment">// å†…éƒ¨å…¶å®æ˜¯å½’å¹¶æ’åº  </span><span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>dictionary<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Comparator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token class-name">String</span> word1<span class="token punctuation">,</span> <span class="token class-name">String</span> word2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>word1<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> word2<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">return</span> word2<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> word1<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">return</span> word1<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>word2<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p>æ—¶é—´å¤æ‚åº¦ï¼šO*(<em>d</em>Ã—<em>m</em>Ã—log<em>d</em>+<em>d</em>Ã—(<em>m</em>+<em>n</em>))</p><h3 id="3-åŠ¨æ€è§„åˆ’">3. åŠ¨æ€è§„åˆ’</h3><p>è€ƒè™‘å‰é¢çš„åŒæŒ‡é’ˆçš„åšæ³•ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°æˆ‘ä»¬<strong>æœ‰å¤§é‡çš„æ—¶é—´ç”¨äºåœ¨ sä¸­æ‰¾åˆ°ä¸‹ä¸€ä¸ªåŒ¹é…å­—</strong>ç¬¦ã€‚</p><p>è¿™æ ·æˆ‘ä»¬é€šè¿‡é¢„å¤„ç†ï¼Œå¾—åˆ°ï¼š<strong>å¯¹äº s çš„æ¯ä¸€ä¸ªä½ç½®ï¼Œä»è¯¥ä½ç½®å¼€å§‹å¾€åæ¯ä¸€ä¸ªå­—ç¬¦ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</strong></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210914192927774.png" alt="image-20210914192927774"></p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">findLongestWord</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> dictionary<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">int</span> m <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>m <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> m <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">26</span><span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token char">'a'</span> <span class="token operator">+</span> j<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                   f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> f<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token class-name">String</span> res <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>       <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> t <span class="token operator">:</span> dictionary<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">boolean</span> match <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>           <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>           <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> t<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">if</span> <span class="token punctuation">(</span>f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>t<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token char">'a'</span><span class="token punctuation">]</span> <span class="token operator">==</span> m<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   match <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                   <span class="token keyword">break</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>               j <span class="token operator">=</span> f<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>t<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token char">'a'</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span>match<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">if</span> <span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> res<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span>  <span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> res<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> t<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   res <span class="token operator">=</span> t<span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> res<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210914193020618.png" alt="image-20210914193020618"></p><p>è¿™ç§æ–¹æ³•ä¼¼ä¹ç½‘ä¼ å« <strong>åºåˆ—è‡ªåŠ¨æœº</strong>ï¼Œç”¨äºå­åºåˆ—åŒ¹é…ã€‚</p><p>åªèƒ½è¯´æ˜¯ç‰›çš®å®ƒå¦ˆç»™ç‰›çš®å¼€é—¨ï¼Œç‰›çš®åˆ°å®¶äº†ã€‚è¿˜æ˜¯æ³¨æ„è¿™é‡Œçš„ä¸»è¦æ€è·¯çœ‹ï¼Œå¤§éƒ¨åˆ†æ—¶é—´éƒ½èŠ±åœ¨æŸ¥æ‰¾sçš„å­—ç¬¦åŒ¹é…æƒ…å†µä¸Šäº†ï¼Œé‚£è¿™é‡Œé€šè¿‡é¢„å¤„ç†ï¼ŒæŠŠsçš„æ‰€æœ‰æƒ…å†µåˆ—å‡ºæ¥ï¼ˆæœ€å¤šä¹Ÿå°±length*26çš„äºŒç»´æ•°ç»„ï¼‰ã€‚åé¢åˆ¤æ–­åˆ™é€šè¿‡O(1)çš„æ—¶é—´å¤æ‚åº¦å»å¯¹æ¯” è€—è´¹O(d x max(str.length))</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210914193233220.png" alt="image-20210914193233220"></p><h2 id="518-é›¶é’±å…‘æ¢II-â­â­">518. é›¶é’±å…‘æ¢II â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-dp">DP</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220121094916992.png" alt="image-20220121094916992"></p><h3 id="å®¡é¢˜-v37">å®¡é¢˜</h3><ul><li>æ¯ç§é¢é¢çš„ç¡¬å¸æ•°ç›®æ— é™</li><li>å¯èƒ½çš„åšæ³•ï¼šåŠ¨æ€è§„åˆ’ï¼ŸDFSï¼Ÿ</li><li></li></ul><h3 id="1-é“¾è¡¨å®ç°çš„DFS-ï¼ˆè¶…æ—¶ï¼‰">1. é“¾è¡¨å®ç°çš„DFS ï¼ˆè¶…æ—¶ï¼‰</h3><p>é“¾è¡¨å®ç°çš„DFSï¼Œèƒ½å¤Ÿåˆ°è¾¾åº•å±‚å°±ä¸ºæ€»æ•°åŠ 1ï¼Œè€Œä¸”è¿™é‡Œæœ€å¼€å§‹çŠ¯äº†ä¸€ä¸ªé”™è¯¯ï¼š<br>è¿™é‡Œé¢˜ç›®çš„æ„æ€æ˜¯ä¸åŒºåˆ†1+2+2å’Œ2+2+1ï¼Œåé¢æƒ³äº†ä¸€ä¸‹ï¼Œåªè¦æŠŠè¿™é‡Œæ–°å»ºNodeçš„æ•°æ®valï¼Œæ”¹æˆçˆ¶èŠ‚ç‚¹çš„valï¼Œå°±èƒ½å¤Ÿå®ç°ä»å¤§åˆ°å°çš„æ’é™¤ï¼Œè€Œä¸ç”¨å¤§è´¹å‘¨ç« çš„æ”¹ç®—æ³•ã€‚</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">change</span><span class="token punctuation">(</span><span class="token keyword">int</span> amount<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> coins<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Node</span> temp<span class="token punctuation">;</span>        <span class="token keyword">int</span> total <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> min <span class="token operator">=</span> coins<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> max <span class="token operator">=</span> coins<span class="token punctuation">[</span>coins<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> curIndex <span class="token operator">=</span> coins<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token class-name">Node</span> head <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span>amount<span class="token punctuation">,</span>curIndex<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>head <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>head<span class="token punctuation">.</span>val <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">while</span><span class="token punctuation">(</span>head<span class="token punctuation">.</span>father<span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> head<span class="token punctuation">.</span>father<span class="token punctuation">.</span>val <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    head <span class="token operator">=</span> head<span class="token punctuation">.</span>father<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                head <span class="token operator">=</span> head<span class="token punctuation">.</span>father<span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>head <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    head<span class="token punctuation">.</span>val<span class="token operator">--</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>head<span class="token punctuation">.</span>res <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                total <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>                head <span class="token operator">=</span> head<span class="token punctuation">.</span>father<span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>head <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    head<span class="token punctuation">.</span>val<span class="token operator">--</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>head<span class="token punctuation">.</span>res <span class="token operator">-</span> coins<span class="token punctuation">[</span>head<span class="token punctuation">.</span>val<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                head<span class="token punctuation">.</span>val<span class="token operator">--</span><span class="token punctuation">;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            temp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span>head<span class="token punctuation">.</span>res <span class="token operator">-</span> coins<span class="token punctuation">[</span>head<span class="token punctuation">.</span>val<span class="token punctuation">]</span><span class="token punctuation">,</span> head<span class="token punctuation">.</span>val<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            temp<span class="token punctuation">.</span>father <span class="token operator">=</span> head<span class="token punctuation">;</span>            head <span class="token operator">=</span> temp<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> total<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">Node</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> res<span class="token punctuation">;</span>    <span class="token keyword">int</span> val<span class="token punctuation">;</span>    <span class="token keyword">int</span> cnt<span class="token punctuation">;</span>    <span class="token class-name">Node</span> father<span class="token punctuation">;</span>    <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token keyword">int</span> res<span class="token punctuation">,</span> <span class="token keyword">int</span> val<span class="token punctuation">,</span> <span class="token keyword">int</span> cnt<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>res <span class="token operator">=</span> res<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>val <span class="token operator">=</span> val<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>cnt <span class="token operator">=</span> cnt<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><h3 id="2-æ•°ç»„å®ç°çš„DFS-ï¼ˆè¶…æ—¶ï¼‰">2. æ•°ç»„å®ç°çš„DFS ï¼ˆè¶…æ—¶ï¼‰</h3><p>ä»¥ä¸ºæ¢ç”¨æ•°ç»„æ¥æ—¶é—´ä¼šæ›´å¿«ï¼Œæ²¡æƒ³åˆ°æµ‹äº†ä¸€ä¸‹æ—¶é—´ï¼Œä¸¤è€…ç›¸å·®æ— å‡ ï¼Œçœ‹æ¥é—®é¢˜è¿˜æ˜¯å‡ºåœ¨DFSä¸Šè€Œä¸åœ¨äºå…·ä½“çš„å®ç°æ–¹å¼</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">change</span><span class="token punctuation">(</span><span class="token keyword">int</span> amount<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> coins<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> total <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token keyword">if</span><span class="token punctuation">(</span>amount <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>          <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>      <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>amount <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arrIndex <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>amount <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> i <span class="token punctuation">,</span> j<span class="token punctuation">;</span>      i <span class="token operator">=</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>      arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> amount<span class="token punctuation">;</span>      arrIndex<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> coins<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>      <span class="token keyword">while</span><span class="token punctuation">(</span>arrIndex<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>arrIndex<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              <span class="token keyword">while</span><span class="token punctuation">(</span>j <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> arrIndex<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                  j<span class="token operator">--</span><span class="token punctuation">;</span>                  i<span class="token operator">--</span><span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span>              arrIndex<span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">--</span><span class="token punctuation">;</span>              <span class="token keyword">continue</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              total <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>              i<span class="token operator">--</span><span class="token punctuation">;</span>j<span class="token operator">--</span><span class="token punctuation">;</span>              <span class="token keyword">if</span><span class="token punctuation">(</span>j <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                  arrIndex<span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">--</span><span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span>              <span class="token keyword">continue</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> coins<span class="token punctuation">[</span>arrIndex<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              arrIndex<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">--</span><span class="token punctuation">;</span>              <span class="token keyword">continue</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>          arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> coins<span class="token punctuation">[</span>arrIndex<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>          arrIndex<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> arrIndex<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>          i<span class="token operator">++</span><span class="token punctuation">;</span>          j<span class="token operator">++</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">return</span> total<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span></code></pre></div><h3 id="3-å®Œå…¨èƒŒåŒ…ï¼ˆè½¬ï¼‰">3. å®Œå…¨èƒŒåŒ…ï¼ˆè½¬ï¼‰</h3><h4 id="3-1-äºŒç»´">3.1 äºŒç»´</h4><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220121120553845.png" alt="image-20220121120553845"></p><p>åŠ å…¥ä¸€æšæ–°çš„ç¡¬å¸åï¼Œå¯ä»¥æœ‰ä»¥ä¸‹ä¸¤ç§å¯èƒ½ï¼š</p><ul><li>è¦ä¹ˆæ˜¯ä¸è¦è¿™æšç¡¬å¸çš„ç»„åˆ</li><li>è¦ä¹ˆæ˜¯åŠ ä¸€æšè¿™æšç¡¬å¸çš„ç»„åˆ</li></ul><p>âºï¸ è¿™é‡Œæˆ‘æœ‰è€ƒè™‘åˆ°æ¯”å¦‚6å—é’±éœ€è¦3æš2å—ç¡¬å¸æ¥ç»„æˆï¼ŒåªåŠ ä¸€æšé‚£å°±ä¼šé—æ¼æ•°ç›®ã€‚ä½†å…¶å®ä¸ä¼šï¼Œå› ä¸ºå®ƒæ˜¯å åŠ çš„è¿‡ç¨‹ï¼Œ6å—é’±å…¶å®ç”±2å—é’±è€Œæ¥ï¼Œæ‰€ä»¥è‚¯å®šä¼šåŒ…å«è¿›å»çš„</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">change</span><span class="token punctuation">(</span><span class="token keyword">int</span> amount<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> coins<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> dp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>coins<span class="token punctuation">.</span>length<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>amount<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        dp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> row <span class="token operator">&lt;=</span> coins<span class="token punctuation">.</span>length<span class="token punctuation">;</span> row<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> col <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> col <span class="token operator">&lt;=</span> amount<span class="token punctuation">;</span> col<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                dp<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">=</span> dp<span class="token punctuation">[</span>row<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span>col<span class="token operator">>=</span>coins<span class="token punctuation">[</span>row<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">?</span>dp<span class="token punctuation">[</span>row<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token operator">-</span>coins<span class="token punctuation">[</span>row<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> dp<span class="token punctuation">[</span>coins<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">[</span>amount<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220121120612552.png" alt="image-20220121120612552"></p><p>O(amount * coins.length)çš„ç©ºé—´å¤æ‚åº¦<br>O(amount * coins.length)çš„æ—¶é—´å¤æ‚åº¦</p><h4 id="3-2-ä¸€ç»´ä¼˜åŒ–">3.2 ä¸€ç»´ä¼˜åŒ–</h4><p>ç‰¹ç‚¹ï¼šå€¼éƒ½ç”±ä¹‹å‰çš„å€¼å†³å®š</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">change</span><span class="token punctuation">(</span><span class="token keyword">int</span> amount<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> coins<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>dp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>amount<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        dp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> coin <span class="token operator">:</span> coins<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> coin<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> amount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> dp<span class="token punctuation">[</span>i<span class="token operator">-</span>coin<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> dp<span class="token punctuation">[</span>amount<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// ä½œè€…ï¼šcheungq-6</span><span class="token comment">// é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/coin-change-2/solution/hua-tu-li-jie-cong-chang-gui-er-wei-dpda-4gfy/</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220121121212373.png" alt="image-20220121121212373"></p><h3 id="æ€»ç»“-v7">æ€»ç»“</h3><p>è‡ªå·±æ€»ç®—æ˜¯äº†ç¡®äº†DFSçš„æ‰§å¿µäº†ï¼Œä¹‹å‰ä¸€æƒ³åˆ°å•¥å°±å®¹æ˜“æƒ³åˆ°DFSï¼Œä½†ç¡®å®è¿™ç±»é¢˜çš„èƒŒåŒ…ç‰¹ç‚¹å¤ªæ˜æ˜¾äº†ï¼Œè‡ªå·±å¯¹èƒŒåŒ…é—®é¢˜è¿˜æ˜¯ä¸ç†Ÿæ‚‰ï¼Œæœ€å¼€å§‹æƒ³çš„ä¹Ÿæ˜¯ä»amount  1-nçš„è¿­ä»£ï¼Œä½†æ²¡æƒ³æ¸…æ¥šå¦‚ä½•ç”¨è§„åˆ’æ¥è¿­ä»£çš„ç®—</p><ul><li>èƒŒåŒ…é—®é¢˜å…ˆä»æœ´ç´ æ–¹æ³•è§£å†³ï¼Œç„¶åå†ä¼˜åŒ–åˆ°ä¸€ç»´</li></ul><h2 id="539-æœ€å°æ—¶é—´å·®-â­â­">539. æœ€å°æ—¶é—´å·® â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><div class="code-tag-label code-tag-label-sort">Sort</div><div class="code-tag-label code-tag-label-math">Pigeonhole Principle</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220118170616179.png" alt="image-20220118170616179"></p><h3 id="å®¡é¢˜-v38">å®¡é¢˜</h3><ul><li>æœ€å°æ—¶é—´å·®ï¼Œæ­£æ•°ï¼Œè¿˜å¿…é¡»ç”¨åˆ†é’Ÿæ•°è¡¨ç¤º</li><li>éš¾ç‚¹ï¼šä¸€ä¸ªæ•°ç»„ä¸­çš„æŒ‰ä¸€å®šè§„åˆ™ç›¸å·®æœ€å°çš„æ•°ï¼Œæš´åŠ›æ³•è‚¯å®šæ˜¯On^2çš„æ—¶é—´å¤æ‚åº¦ï¼ˆé’ˆå¯¹æ¯ä¸€ä¸ªæ•°ï¼Œæ‰¾åˆ°å®ƒçš„ç›¸å·®çš„æœ€å°æ•°å†ä¾æ¬¡æ¯”è¾ƒï¼‰</li><li>å¯èƒ½çš„åšæ³•ï¼šåŒæŒ‡é’ˆï¼Ÿæ’åºåå†åšï¼Ÿ</li></ul><h3 id="1-æš´åŠ›æ³•">1. æš´åŠ›æ³•</h3><p>äºŒæ¬¡å¾ªç¯ï¼ŒOn^2çš„æ—¶é—´å¤æ‚åº¦ï¼ŒO1çš„ç©ºé—´å¤æ‚åº¦</p><h3 id="2-æ’åºåä¾æ¬¡æ¯”è¾ƒ">2. æ’åºåä¾æ¬¡æ¯”è¾ƒ</h3><p>å…ˆè½¬åŒ–æˆå¯æ’çš„æ•°ç»„ï¼ŒOnlognæ’åºåä¾æ¬¡æ¯”è¾ƒå·®å€¼ï¼ŒOnlognçš„æ—¶é—´å¤æ‚åº¦ Onçš„ç©ºé—´å¤æ‚åº¦ï¼ˆä½†åœ¨å­—ç¬¦ä¸²çš„æ—¶é—´å½¢å¼çš„æ•°ç»„è½¬åŒ–å¯èƒ½è€—è´¹æ—¶é—´ï¼‰</p><p>æ³¨æ„çš„å°±æ˜¯ä¸åŒåŒºé—´çš„æ¯”è¾ƒï¼Œæœ‰ä»¥ä¸‹æƒ…å†µï¼š</p><ul><li>00:00 , 23:59</li><li>00:00 11:59</li></ul><p><s>è¿™ä¸¤ç§æƒ…å†µæ˜¯éœ€è¦åˆ†åˆ«è®¨è®ºçš„ï¼Œè¿™é‡Œç”¨Math.minå»åˆ¤æ–­</s></p><p><strong>ä¼˜åŒ–</strong></p><p>ä¸éœ€è¦ï¼Œå› ä¸ºè¿™é‡Œæ¯”è¾ƒå‰ä¸€ä¸ªçš„å·®å€¼ï¼Œæœ€åå†ç®—æœ€åä¸€ä¸ªä¸ç¬¬ä¸€ä¸ªçš„å·®å€¼å°±è¡Œäº†ï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œçœ‹äº†ä¸‰ç§æƒ…å†µï¼ˆå®é™…åªåº”è¯¥æœ‰ä¸¤ç§ï¼‰ï¼Œè¿›è¡Œäº†ä¸‰æ¬¡æœ€å°å€¼åˆ¤æ–­ï¼ˆå®é™…ä¸åº”è¯¥æœ‰ï¼‰</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">findMinDifference</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> timePoints<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> timeMinute <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>timePoints<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> min <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>        <span class="token keyword">int</span> A_DAY <span class="token operator">=</span> <span class="token number">24</span><span class="token operator">*</span> <span class="token number">60</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span>timePoints<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> hour <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>timePoints<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> minute <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>timePoints<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            timeMinute<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> hour<span class="token operator">*</span><span class="token number">60</span> <span class="token operator">+</span>minute<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>timeMinute<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> temp<span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span>timeMinute<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                temp <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>timeMinute<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">-</span>timeMinute<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> A_DAY <span class="token operator">-</span> timeMinute<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> timeMinute<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>timeMinute<span class="token punctuation">[</span>timeMinute<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">-</span>timeMinute<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> A_DAY <span class="token operator">-</span> timeMinute<span class="token punctuation">[</span>timeMinute<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> timeMinute<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> timeMinute<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            temp <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>timeMinute<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>timeMinute<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> A_DAY <span class="token operator">-</span> timeMinute<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> timeMinute<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>timeMinute<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>timeMinute<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> A_DAY <span class="token operator">-</span> timeMinute<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> timeMinute<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span><span class="token punctuation">&#123;</span>            temp <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>timeMinute<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">-</span>timeMinute<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> A_DAY <span class="token operator">-</span> timeMinute<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> timeMinute<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>timeMinute<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>timeMinute<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> A_DAY <span class="token operator">-</span> timeMinute<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> timeMinute<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>min <span class="token operator">></span> temp<span class="token punctuation">)</span>                 min <span class="token operator">=</span> temp<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> min<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220118175015264.png" alt="image-20220118175015264"></p><p>æ„å¤–å±…ç„¶ä¸€æ¬¡è¿‡ ğŸ˜¦<br>ç©ºé—´å¤æ‚åº¦Onæ…¢ä¸€ç‚¹å¯ä»¥ç†è§£ï¼ˆ<s>ä½†è¿™é‡Œä¹Ÿå¯ä»¥ä¼˜åŒ–æˆO1çš„ç©ºé—´å¤æ‚åº¦ï¼Œç›´æ¥åœ¨åŸListä¸­è§£å†³</s> <strong>æ’åºå ç”¨LogNçš„æ ˆç©ºé—´ï¼ï¼ï¼</strong>ï¼‰ï¼Œä½†å› ä¸ºOnLognçš„æ—¶é—´å¤æ‚åº¦æ‰€ä»¥åªæœ‰70%ï¼Œå¹¶ä¸”ä¹Ÿä¸éœ€è¦ä¸¤æ¬¡åˆ¤æ–­ã€‚ æ‰€ä»¥è¿™é¢˜è‚¯å®šæ˜¯æœ‰LogN çš„æ—¶é—´å¤æ‚åº¦çš„è§£æ³•æ»´</p><p>å¥½å§ï¼Œåæ¥çœ‹äº†ä¸€ä¸‹ï¼Œæˆ‘è¿™ä¸ªç®—æ³•å‰é¢åŠ ä¸ª</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">if</span><span class="token punctuation">(</span>timePoints<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span></code></pre></div><p>ä¹Ÿæ˜¯è¿™ä¸ª  â€¦</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220118182641596.png" alt="image-20220118182641596"></p><h3 id="3-é¸½å·¢åŸç†ï¼ˆæŠ½å±‰åŸç†ï¼‰-ï¼ˆè½¬ï¼‰">3. é¸½å·¢åŸç†ï¼ˆæŠ½å±‰åŸç†ï¼‰ ï¼ˆè½¬ï¼‰</h3><p><strong>ä¸»è¦è§£å†³çš„æ˜¯å½“Nå¾ˆå¤§æ—¶ï¼Œä¼šæœ‰è®¸å¤šé‡å¤çš„æ—¶é—´</strong>ï¼ˆå€¼å¾—æ³¨æ„ï¼ŒåŠ ä¸ªåˆ¤æ–­å°±èƒ½è§£å†³ä¸Šé™é—®é¢˜ï¼‰ï¼ŒæŒ‰ç…§ç¬¬äºŒç§æ–¹æ³•çš„ä¼šæœ‰æµªè´¹çš„ç©ºé—´ï¼Œèƒ½å¤Ÿå°†ç©ºé—´å¤æ‚åº¦å‹ç¼©åˆ°Log(min(Nï¼Œ60*24))</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">findMinDifference</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> timePoints<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> timePoints<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">></span> <span class="token number">1440</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>timePoints<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> ans <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>        <span class="token keyword">int</span> t0Minutes <span class="token operator">=</span> <span class="token function">getMinutes</span><span class="token punctuation">(</span>timePoints<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> preMinutes <span class="token operator">=</span> t0Minutes<span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> minutes <span class="token operator">=</span> <span class="token function">getMinutes</span><span class="token punctuation">(</span>timePoints<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            ans <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>ans<span class="token punctuation">,</span> minutes <span class="token operator">-</span> preMinutes<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ç›¸é‚»æ—¶é—´çš„æ—¶é—´å·®</span>            preMinutes <span class="token operator">=</span> minutes<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        ans <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>ans<span class="token punctuation">,</span> t0Minutes <span class="token operator">+</span> <span class="token number">1440</span> <span class="token operator">-</span> preMinutes<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é¦–å°¾æ—¶é—´çš„æ—¶é—´å·®</span>        <span class="token keyword">return</span> ans<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token class-name">String</span> t<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token char">'0'</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token char">'0'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">+</span> <span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token char">'0'</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token char">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/minimum-time-difference/solution/zui-xiao-shi-jian-chai-by-leetcode-solut-xolj/</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220118181621011.png" alt="image-20220118181621011"></p><h3 id="4-ä¼˜åŒ–-æ’åº-é¸½å·¢-ï¼ˆè½¬ï¼‰">4. ä¼˜åŒ– - æ’åº+é¸½å·¢ ï¼ˆè½¬ï¼‰</h3><p>å‰é¢ç¬¬ä¸‰é¢˜è™½ç„¶ç”¨äº†å­—ç¬¦ä¸²æ’åºï¼Œä½†æˆ‘çŒœè¿™é‡Œå­—ç¬¦ä¸²æ’åºçš„æ—¶é—´è¿˜æ˜¯æ…¢äºæ•°å­—æ’åºçš„ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯è¿™é‡Œå¿«ä¸€ç‚¹çš„åŸå› å§<br>åé¢çœ‹äº†ä¸€ä¸‹ï¼Œé™¤äº†é¸½å·¢åŸç†åŸºæœ¬ä¸Šä¸ç¬¬äºŒç§æ–¹æ³•æ€è·¯ä¸Šç›¸å·®æ— å‡ ï¼ˆå½“ç„¶æˆ‘çš„æ›´ç¬¨ä¸€ç‚¹ï¼‰ğŸ˜“</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">findMinDifference</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> timePoints<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>timePoints<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1440</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>timePoints<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> cache<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">String</span> timePoint <span class="token operator">=</span> timePoints<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>cache<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>timePoint<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">+</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>timePoint<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>cache<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> min <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> cache<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>min <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>min<span class="token punctuation">,</span> cache<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> cache<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>min<span class="token punctuation">,</span> cache<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1440</span> <span class="token operator">-</span> cache<span class="token punctuation">[</span>cache<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// ä½œè€…ï¼škyushu</span><span class="token comment">// é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/minimum-time-difference/solution/rustgolangjava-pai-xu-ge-chao-li-lun-by-kt9yd/</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220118182353926.png" alt="image-20220118182353926"></p><p>æˆ‘åªèƒ½è¯´ï¼Œç²¾å½©â€¦</p><h3 id="æ€»ç»“-v8">æ€»ç»“</h3><ol><li>ç¢°åˆ°å­—ç¬¦ä¸²æˆ–æ•°å­—éƒ½å¯æ’åºçš„æƒ…å†µï¼Œå…ˆè€ƒè™‘æ•°å­—æ’åºï¼Œå› ä¸ºå¯èƒ½æ›´å¿«</li><li>ä¸è¦é‚£äº›ä¸å¿…è¦çš„è¿ç®—ï¼Œæƒ³æ¸…æ¥šâ€¦</li><li>è€ƒè™‘æŠ½å±‰åŸç† å·®å€¼è¦è€ƒè™‘Néå¸¸å¤§çš„æ—¶å€™å¯¹Nçš„é™åˆ¶ï¼ŒåŠ if() return çš„é™åˆ¶æ¡ä»¶æœ‰æ—¶å€™æœ‰å¥‡æ•ˆï¼</li></ol><h2 id="589-Nå‰æ ‘çš„å‰åºéå†-â­">589. Nå‰æ ‘çš„å‰åºéå† â­</h2><div class="code-tag-time">2022/3/10 19:24:00</div><div class="code-tag-label code-tag-label-foreach">PreOrder Traversal</div><div class="code-tag-label code-tag-label-tree">Tree</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220310183725558.png" alt="image-20220310183725558"></p><h3 id="å®¡é¢˜-v39">å®¡é¢˜</h3><ul><li><p>å‰åºéå†çš„æ¦‚å¿µ</p></li><li><p>å¯èƒ½çš„ç®—æ³•ï¼šé˜Ÿåˆ— æ ˆ</p></li><li><p>åšå‰æ€è·¯ï¼š</p><ul><li>ç®€å•ï¼šæŒ‰ç…§å·¦å„¿å­çš„æ·±å±‚éå† é€’å½’</li></ul><h3 id="1-è¿­ä»£-v3">1. è¿­ä»£</h3></li></ul><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> <span class="token function">preorder</span><span class="token punctuation">(</span><span class="token class-name">Node</span> root<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Node</span> cur <span class="token operator">=</span> root<span class="token punctuation">;</span>        <span class="token class-name">Node</span> left<span class="token punctuation">,</span>right<span class="token punctuation">;</span>        <span class="token function">innerMethod</span><span class="token punctuation">(</span>cur<span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">void</span> innerMethod <span class="token punctuation">(</span><span class="token class-name">Node</span> node<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> res<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>node <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token punctuation">;</span>        res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// é‡ç‚¹ä¸»è¦åœ¨è¿™ä¸€æ®µè¯äº†</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> node<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token function">innerMethod</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220310190148587.png" alt="image-20220310190148587"></p><p>ä¸é”™å­ï¼Œè¿˜æ˜¯æ¯”è¾ƒå¿«æƒ³å‡ºæ¥äº†ã€‚è§‰å¾—è¿­ä»£æ²¡æœ‰é€’å½’æ¥å¾—å¿«ï¼Œå°±é€’å½’äº†ä¸€ä¸‹</p><h3 id="åæ€-v9">åæ€</h3><ul><li>æœ€å¼€å§‹æŠŠæ¡ä»¶çœ‹é”™äº†ï¼Œä»¥ä¸ºæ˜¯äºŒå‰æ ‘â€¦</li><li>é™„ä¸€ç¯‡è§£å†³å„ç§æ ‘ å„ç§é¡ºåºéå†çš„é—®é¢˜æ€»ç»“ <a href="https://leetcode-cn.com/problems/n-ary-tree-preorder-traversal/solution/yi-tao-quan-fa-shua-diao-nge-bian-li-shu-de-wen--3/">Link~~ ~~</a></li></ul><h2 id="599-ä¸¤ä¸ªåˆ—è¡¨çš„æœ€å°ç´¢å¼•æ€»å’Œ-â­">599. ä¸¤ä¸ªåˆ—è¡¨çš„æœ€å°ç´¢å¼•æ€»å’Œ â­</h2><div class="code-tag-time">2022/3/14 21:34:00</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><div class="code-tag-label code-tag-label-hash">Hash</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220314194701439.png" alt="image-20220314194701439"></p><h3 id="å®¡é¢˜-v40">å®¡é¢˜</h3><ul><li>ä¸¤ä¸ªå­—ç¬¦ä¸²æ•°ç»„ä¸­æ‰¾ç›¸åŒçš„å­—ç¬¦ä¸²ï¼Œä¸”ç´¢å¼•å’Œæœ€å°ã€‚è¾“å‡ºæ‰€æœ‰å¯èƒ½ç­”æ¡ˆ</li><li>æ€è·¯ï¼š<ul><li>ç®€å•ï¼šO(m) * O(n) çš„æ—¶é—´å¤æ‚åº¦ï¼Œä¸¤å±‚éå†ï¼ˆå®é™…è¶…è¿‡ç•Œé™å€¼å°±å¯ä»¥ç›´æ¥è¾“å‡ºç­”æ¡ˆï¼‰</li><li>è¿›é˜¶ï¼šèƒ½å¦åœ¨O(m + n)å³ä¸€æ¬¡éå†åæ±‚å‡ºï¼Ÿ</li></ul></li></ul><h3 id="1-åŒå±‚å¾ªç¯">1. åŒå±‚å¾ªç¯</h3><p>æš´åŠ›è§£æ³•ï¼Œæ‰¾åˆ°æœ€å°å€¼ï¼Œç„¶åå†å¾ªç¯ä¸€æ¬¡æ‰¾ç´¢å¼•å’Œç­‰äºæœ€å°å€¼çš„é‚£äº›å­—ç¬¦ä¸²</p><p>éƒ¨åˆ†ä¼˜åŒ–ï¼ˆç©ºé—´å¤æ‚åº¦æå‡10%ï¼‰ï¼š</p><ul><li>List å»æ‰ï¼Œæ¢æˆè®°å½•æ•°ç»„é•¿åº¦çš„int</li><li>é€šè¿‡i + j &gt; minSum &amp;&amp; minSum != -1åˆ é™¤å†—ä½™çš„åˆ¤æ–­æ“ä½œ</li></ul><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">findRestaurant</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> list1<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> list2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> minSum <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> list1<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> list2<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>list1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>list2<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>minSum <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    minSum <span class="token operator">=</span> i <span class="token operator">+</span> j<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">+</span> j <span class="token operator">&lt;</span> minSum<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    minSum <span class="token operator">=</span> i <span class="token operator">+</span> j<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">+</span> j <span class="token operator">>=</span> minSum <span class="token operator">&amp;&amp;</span> minSum <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> list1<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">+</span> j <span class="token operator">&lt;=</span> minSum <span class="token operator">&amp;&amp;</span> j <span class="token operator">&lt;</span> list2<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">+</span> j <span class="token operator">==</span> minSum <span class="token operator">&amp;&amp;</span> list1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>list2<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>list1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ans <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span>res<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> res<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> ans<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220314201111868.png" alt="image-20220314201111868"></p><h3 id="2-åŒæŒ‡é’ˆ-v2">2. åŒæŒ‡é’ˆ</h3><p>ä¸¤ä¸ªindexåŒæ­¥å¢åŠ ï¼Œå·²è¾¾åˆ°è¿™ä¸€æ—¶åˆ»æ€»æ˜¯æœ€å°ç´¢å¼•å’Œçš„æƒ…å†µã€‚</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">findRestaurant</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> list1<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> list2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token keyword">int</span> minSum <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>       <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ans <span class="token punctuation">;</span>       <span class="token keyword">while</span><span class="token punctuation">(</span>count <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           minSum<span class="token operator">++</span><span class="token punctuation">;</span>           i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>           j <span class="token operator">=</span> minSum<span class="token punctuation">;</span>           <span class="token comment">// é¿å…æº¢å‡ºæƒ…å†µ</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>minSum <span class="token operator">>=</span> list2<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               j <span class="token operator">=</span> list2<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>               i <span class="token operator">=</span> minSum <span class="token operator">-</span> j<span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                      <span class="token keyword">while</span><span class="token punctuation">(</span>j <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> i <span class="token operator">&lt;</span> list1<span class="token punctuation">.</span>length <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                  <span class="token keyword">if</span><span class="token punctuation">(</span>list1<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>list2<span class="token punctuation">[</span>j<span class="token operator">--</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                       count <span class="token operator">++</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       ans <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> minSum <span class="token operator">&amp;&amp;</span> i <span class="token operator">&lt;</span> list1<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>minSum <span class="token operator">-</span> i <span class="token operator">>=</span> list2<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">continue</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>list1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>list2<span class="token punctuation">[</span>minSum<span class="token operator">-</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               ans<span class="token punctuation">[</span>index<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> list1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> ans<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220314204259520.png" alt="image-20220314204259520"></p><p>æ„Ÿè§‰æ˜¯æœ€ä¼˜çš„è·¯çº¿äº†ï¼Œä½†å¤æ‚åº¦è¿˜æ˜¯åé«˜å•Šï¼Œç†è®ºä¸Šæ˜¯O(m)*O(n)çš„æ—¶é—´å¤æ‚åº¦</p><h3 id="3-å“ˆå¸Œç¼“å­˜">3. å“ˆå¸Œç¼“å­˜</h3><p>æ€è·¯è¿˜æ˜¯æ¥è‡ªèƒ½å¦åœ¨O(m + n)çš„æ—¶é—´å¤æ‚åº¦å†…æ‰¾åˆ°æƒ³è¦çš„å€¼ï¼Œå…ˆæ”¾ä¸€ä¸ªæ•°ç»„å…ƒç´ è¿‡å»ï¼Œç„¶ååœ¨å“ˆå¸Œåˆ¤æ–­ç¬¬äºŒä¸ªæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ å€¼æ˜¯å¦åœ¨å“ˆå¸Œè¡¨ä¸­å­˜åœ¨ï¼Œå­˜åœ¨åˆ™è¯´æ˜ç›¸ç­‰ï¼Œåˆ™å¢åŠ å…¶å“ˆå¸Œå€¼ï¼Œï¼ˆå¹¶ä¸å½“å‰æœ€å°è®°å½•ç´¢å¼•å’Œæ¯”è¾ƒï¼‰ã€‚é›†åˆç”¨æ¥è¿›è¡Œå½“å‰æœ€å°ç´¢å¼•å’Œå…ƒç´ çš„æ¸…ç©ºå’Œå¢åŠ </p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java">        <span class="token keyword">public</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">findRestaurant</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> list1<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> list2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> curMin <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>            <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> list1<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>list1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> list2<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">Integer</span> index <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>list2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>index <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>list2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> index <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span><span class="token punctuation">(</span>curMin <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        curMin <span class="token operator">=</span> index <span class="token operator">+</span> i<span class="token punctuation">;</span>                        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>list2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>curMin <span class="token operator">></span> index <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        curMin <span class="token operator">=</span> index <span class="token operator">+</span> i<span class="token punctuation">;</span>                        list<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>list2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>curMin <span class="token operator">==</span> index<span class="token operator">+</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>list2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ans <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span>list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">return</span> ans<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p>æ—¶é—´å¤æ‚åº¦ä½ O(m + n)<br>ç©ºé—´å¤æ‚åº¦é«˜ O(m + n)ï¼Œä¸”å¤§é‡å­—ç¬¦ä¸²å æ®</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220314213243724.png" alt="image-20220314213243724"></p><h4 id="ä¼˜åŒ–-v5">ä¼˜åŒ–</h4><p>ç®€å•çš„ä¸€å¥ è¶³çŸ£â€¦ï¼ˆåœ¨ç¬¬äºŒä¸ªé›†åˆåˆ¤æ–­ä¹‹å‰æ’å…¥åˆ¤æ–­ï¼Œé¿å…äº†ä¹‹åçš„æ— ç”¨å…ƒç´ åˆ¤æ–­ï¼‰</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token comment">// ...   </span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> list2<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>   <span class="token keyword">if</span><span class="token punctuation">(</span>curMin <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> i <span class="token operator">></span> curMin<span class="token punctuation">)</span>  <span class="token keyword">break</span><span class="token punctuation">;</span>     <span class="token comment">// inserted</span>    <span class="token class-name">Integer</span> index <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>list2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ...</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220314222239803.png" alt="image-20220314222239803"></p><h3 id="åæ€-v10">åæ€</h3><ul><li>æ€è·¯è¿˜ç®—æ¸…æ™°ï¼Œä½†æ˜¯æœ€å¼€å§‹æ²¡æœ‰æƒ³åˆ°O(n)çš„è§£å†³æ–¹æ³•ã€‚ä»¥åè§£å†³é—®é¢˜ åœ¨ä¼˜åŒ–æ€è·¯ä¸Šä¸€å®šè¦å…ˆæƒ³åˆ°ä¸€æ¬¡éå†å°±è§£å†³é—®é¢˜çš„æ–¹æ³•ï¼Œä¸è¦ç¼ åœ¨å¤šé‡åµŒå¥—ä¸­</li><li>ä¼˜åŒ–æ–¹å¼æ³¨æ„ï¼š<strong>ç¡®ä¿æ€è·¯æœ€ä¼˜å†è€ƒè™‘ä¼˜åŒ–</strong>ã€‚æœ‰äº›ä¼˜åŒ–çœ‹èµ·æ¥è¿˜ä¸é”™ï¼Œä½†æ¶‰åŠåˆ°æœ€åæƒ…å†µä¸‹ï¼Œè¿˜æ˜¯æ˜¯ä¸å¥½çš„ï¼Œæ˜¯æ²»æ ‡ä¸æ²»æœ¬çš„æ–¹æ³•ï¼Œè€ƒè™‘æ¸…æ¥šæ˜¯å¦åˆ’ç®—å†ä¼˜åŒ–ï¼Œä¸è¡Œå°±é‡æ–°æ¢æ€è·¯ã€‚</li><li>å¯¹ä¸€äº›æœ€å°å€¼ æœ€å¤§å€¼çš„æœç´¢é—®é¢˜ï¼Œç´¢å¼•ä¸Šä¼˜åŒ–æ—¶å°±å¯ä»¥è¿›è¡Œä¸´ç•Œåˆ¤æ–­ï¼Œæ­¤åå¤§äºï¼ˆæˆ–å°äºï¼‰è¿™ä¸ªå€¼çš„éƒ½ä¸è¦â€¦</li></ul><h2 id="639-è§£ç æ–¹æ³•-â­â­â­">639. è§£ç æ–¹æ³• â­â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-dp">DP</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210928150609009.png" alt="image-20210928150609009"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210928150616334.png" alt="image-20210928150616334"></p><h3 id="å®¡é¢˜-v41">å®¡é¢˜</h3><ul><li>6ä¸06ä¸åŒ</li><li>â€˜â€˜*â€™â€™å­—ç¬¦ä¸è¡¨ç¤º0</li><li>é˜Ÿåˆ—ï¼Ÿé€’å½’</li></ul><h3 id="1-é€’å½’ï¼ˆè¶…æ—¶ï¼‰-v2">1. é€’å½’ï¼ˆè¶…æ—¶ï¼‰</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">numDecodings</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> chars <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">int</span> res<span class="token operator">=</span>  <span class="token function">getNum</span><span class="token punctuation">(</span>chars<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">return</span> res<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">int</span> <span class="token function">getNum</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> chars<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> chars<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'0'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">>=</span> chars<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>           <span class="token comment">// two option</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>chars<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'1'</span> <span class="token operator">||</span> <span class="token punctuation">(</span>chars<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'2'</span> <span class="token operator">&amp;&amp;</span> chars<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token char">'6'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>chars<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'0'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">return</span> <span class="token function">getNum</span><span class="token punctuation">(</span>chars<span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">return</span> <span class="token function">getNum</span><span class="token punctuation">(</span>chars<span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">getNum</span><span class="token punctuation">(</span>chars<span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">else</span><span class="token punctuation">&#123;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>chars<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'0'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           <span class="token comment">// only one option</span>           <span class="token keyword">return</span> <span class="token function">getNum</span><span class="token punctuation">(</span>chars<span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p>è¶…æ—¶â€¦</p><p>æµ‹è¯•åï¼Œç­”æ¡ˆæ­£ç¡®ï¼Œä½†è€—æ—¶å¤ªé•¿</p><h3 id="2-dpï¼ˆè½¬ï¼‰">2. dpï¼ˆè½¬ï¼‰</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">numDecodings</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        f<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token char">'0'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                f<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> f<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">></span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token char">'0'</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token char">'0'</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token char">'0'</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                f<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> f<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> f<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token comment">// ä¼˜åŒ–å</span><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">numDecodings</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// a = f[i-2], b = f[i-1], c=f[i]</span>        <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            c <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token char">'0'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                c <span class="token operator">+=</span> b<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">></span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token char">'0'</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token char">'0'</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token char">'0'</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                c <span class="token operator">+=</span> a<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            a <span class="token operator">=</span> b<span class="token punctuation">;</span>            b <span class="token operator">=</span> c<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> c<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210927185325220.png" alt="image-20210927185325220"></p><p>è¿™é‡Œä¹‹å‰ä¸€ç›´åœ¨æƒ³é€’å½’å’Œè¿­ä»£â€¦æœ‰æƒ³è¿‡åŠ¨æ€è§„åˆ’ï¼Œä½†æ²¡è§„åˆ’å‡ºæ¥â€¦</p><p><strong>åŠ¨æ€è§„åˆ’å’Œé€’å½’çš„è€—æ—¶</strong></p><p>dpåšè¿™é“é¢˜  åŸºæœ¬ç§’å‡ºï¼Œé€’å½’åˆ™éœ€è¦7så·¦å³ï¼Œç”±æ­¤dpçš„é‡è¦æ€§ã€‚</p><p>ä»¥åé‡ä¸Šé€’å½’è¶…æ—¶çš„é—®é¢˜ï¼Œè¦å¤šè€ƒè™‘ä¸€ä¸‹åŠ¨æ€è§„åˆ’ã€‚ã€‚ã€‚ã€‚ã€‚<strong>çœ‹çœ‹èƒ½å¦ä»¥å‡½æ•°è¡¨è¾¾å¼å»è¡¨ç¤ºf(x)ï¼Œè¿›è€Œä½¿ç”¨dpè§£ã€‚</strong></p><h2 id="653-ä¸¤æ•°ä¹‹å’ŒIV-è¾“å…¥BST-â­">653. ä¸¤æ•°ä¹‹å’ŒIV-è¾“å…¥BST â­</h2><blockquote><p>Time : 2022 / 3 / 21 21 : 25<br>TAG : DFS \ BFS \ Hash \ InOrder Traversal</p></blockquote><div class="code-tag-time">2022/3/21 21:25:00</div><div class="code-tag-label code-tag-label-dfs">DFS</div><div class="code-tag-label code-tag-label-bfs">BFS</div><div class="code-tag-label code-tag-label-hash">Hash</div><div class="code-tag-label code-tag-label-tree">Tree</div><div class="code-tag-label code-tag-label-foreach">InOrder Traversal</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220321194434537.png" alt="image-20220321194434537"></p><h3 id="å®¡é¢˜-v42">å®¡é¢˜</h3><ul><li>çœ‹</li><li>æ€è·¯ï¼š<ul><li>ç®€å•ï¼š<ul><li>å¯¹æ¯ä¸ªå°äºkçš„å…ƒç´ ï¼Œæ‰¾åˆ°aï¼Œæ‰¾åˆ°ç­‰äºk-açš„å…ƒç´ </li><li>å½“ç„¶ä¹Ÿå¯ä»¥ä¸€æ¬¡éå†è¯»å‡ºæ¥ï¼Œç„¶åå­˜åˆ°Hashè¡¨ä¸­ï¼Œç„¶åå†æ‰¾x-aï¼Œä½†è¿™æ ·å°±æ²¡æ„ä¹‰äº†</li></ul></li></ul></li></ul><h3 id="1-å‰åºæœç´¢DFS">1. å‰åºæœç´¢DFS</h3><p>å…ˆè¯´æ€»ä½“æ€è·¯ï¼š</p><ul><li>å½“å‰å…ƒç´ curNode.valæ˜¯å¦æ¯”kå°ï¼Œå¦‚æœå°ï¼Œåˆ™å»æ‰¾k-curNode.valæ˜¯å¦åœ¨äºŒå‰æœç´¢æ ‘ä¸­ï¼›<ul><li>å…ˆæ‰¾leftï¼Œæ•´ä½“æ˜¯ä¸­åºéå†</li><li>leftæ‰¾ä¸åˆ°ï¼Œæ‰¾right</li><li>è¿˜æ‰¾ä¸åˆ°ï¼Œå¯„</li></ul></li><li>æ¯”kå¤§ï¼Œåˆ™æ‰¾leftï¼Œç›´åˆ°æ¯”kå°ï¼Œæ‰¾ä¸åˆ°è¿™æ ·çš„æ•°ï¼Œå¯„</li></ul><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">findTarget</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> root<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">TreeNode</span> curNode <span class="token operator">=</span> root<span class="token punctuation">;</span>        <span class="token comment">// Optimize: find lowest level that val &lt; k</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>curNode <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> curNode<span class="token punctuation">.</span>val <span class="token operator">></span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>curNode <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>curNode<span class="token punctuation">.</span>left <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                curNode <span class="token operator">=</span> curNode<span class="token punctuation">.</span>left<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token function">preResearch</span><span class="token punctuation">(</span>curNode<span class="token punctuation">,</span> k<span class="token punctuation">,</span> root<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">binaryResearch</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> node<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">,</span><span class="token class-name">TreeNode</span> originNode<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>node <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>val <span class="token operator">></span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token function">binaryResearch</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>left<span class="token punctuation">,</span>k<span class="token punctuation">,</span> originNode<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>val <span class="token operator">&lt;</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token function">binaryResearch</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>right<span class="token punctuation">,</span>k<span class="token punctuation">,</span> originNode<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// 1. in case of same val but different node</span>        <span class="token comment">// 2. in case of relocate to originNode (eg.&#123;1&#125; 2)</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>originNode <span class="token operator">==</span> node<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>val <span class="token operator">==</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token comment">// Wrong Name, actually to be midSearch...</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">preResearch</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> node<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">,</span> <span class="token class-name">TreeNode</span> root<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">boolean</span> left <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">boolean</span> right <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">boolean</span> ans <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>node <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>            ans <span class="token operator">=</span> <span class="token function">binaryResearch</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> k <span class="token operator">-</span> node<span class="token punctuation">.</span>val<span class="token punctuation">,</span> node<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>left <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            left <span class="token operator">=</span> <span class="token function">preResearch</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>left<span class="token punctuation">,</span> k<span class="token punctuation">,</span> root<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>left<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>right <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            right <span class="token operator">=</span> <span class="token function">preResearch</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>right<span class="token punctuation">,</span> k<span class="token punctuation">,</span> root<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> right<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p>æ—¶é—´å¤æ‚åº¦ï¼šBSTæŸ¥æ‰¾å…ƒç´ è€—æ—¶O(logN) æœ€åæ¯ä¸ªå°äºkçš„å…ƒç´ éƒ½æ‰¾ä¸€æ¬¡O((N-a)logN){ä½†å…·ä½“å¤šå°‘æˆ‘è¿™é‡Œä¸çŸ¥é“æ€ä¹ˆç®—äº†ï¼Œæ ¹æ®ç­”æ¡ˆçš„ç»“æœæ¥çœ‹åº”è¯¥æ˜¯Onï¼Ÿ}ï¼Œä½†å…¶å®æ˜¯å°äºå®ƒçš„<br>ç©ºé—´å¤æ‚åº¦ï¼šä¸€ä¸ªå…ƒç´ æœ‰O(N)çš„æ ˆç©ºé—´ï¼ˆæ–¹æ³•å ç”¨ï¼‰</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220321204810908.png" alt="image-20220321204810908"></p><h3 id="ä¼˜åŒ–ç‚¹">ä¼˜åŒ–ç‚¹</h3><p><strong>ä¼˜åŒ–ç‚¹</strong></p><p>åœ¨preResearchä¸­ï¼Œåˆ¤æ–­æ¡ä»¶ï¼ŒæŒ‰ç…§ä¸­åºéå†çš„æ¡ä»¶ï¼Œ<strong>å“ªä¸€ä¸ªèƒ½è·‘å°±ç›´æ¥è·‘</strong>ï¼Œä¸è¿‡ä¹‹åçš„æ˜¯éäº†</p><p><strong>é”™è¯¯çš„ä¼˜åŒ–ç‚¹</strong></p><p>è¿™é‡Œæˆ‘æœ€å¼€å§‹ä½¿ç”¨äº†è¿™æ ·çš„ä¼˜åŒ–ï¼š</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">while</span><span class="token punctuation">(</span>curNode <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> curNode<span class="token punctuation">.</span>val <span class="token operator">></span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>curNode <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>curNode<span class="token punctuation">.</span>left <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              curNode <span class="token operator">=</span> curNode<span class="token punctuation">.</span>left<span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>              <span class="token keyword">break</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span></code></pre></div><p>å…¶å®è¿™æ ·æƒ³çš„æ€è·¯çš„åˆè¡·æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºæˆ‘ä»…ä»…è€ƒè™‘äº†ä¸ºæ­£æ•´æ•°çš„æƒ…å†µï¼Œå½“ä¸ºè´Ÿæ•°æ—¶ï¼Œéè¦æ‰¾ä¸€ä¸ªval &lt; k çš„æ•°ï¼Œåˆ™ä¼šæ‰¾åˆ°<strong>æ›´å·¦ä¸‹æ–¹</strong>ï¼Œä½†å…¶å®ä¸å½±å“ç»“æœï¼Œä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºåªè¦æŸ¥æ‰¾k - node.valçš„æ•°æ˜¯ä»rootæŸ¥æ‰¾çš„ï¼Œæ‰€ä»¥å†æ€æ ·å¦‚æœæœ‰å¯¹åº”çš„k-node.valçš„å…ƒç´ ï¼Œå°±ä¼šæ‰¾åˆ°ï¼Œä¹Ÿç®—æ˜¯ä¸€ä¸ªå°ä¼˜åŒ–</p><h3 id="2-DFS-å“ˆå¸Œï¼ˆè½¬ï¼‰">2. DFS + å“ˆå¸Œï¼ˆè½¬ï¼‰</h3><p>è¿™æ˜¯æˆ‘è¯´çš„æ²¡å¤ªå¤§æ„æ€çš„æ–¹æ³•çš„ä¼˜åŒ–ç‰ˆæœ¬ï¼ˆDFSä¼˜åŒ–ï¼‰</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">findTarget</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> root<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>set<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>k <span class="token operator">-</span> root<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">findTarget</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>left<span class="token punctuation">,</span> k<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">findTarget</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>right<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p>æ—¶é—´å¤æ‚åº¦æ³¢åŠ¨è¾ƒå¤§ 40% ~ 90%</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220321210857593.png" alt="image-20220321210857593"></p><h3 id="3-BFS-å“ˆå¸Œè¡¨ï¼ˆè½¬ï¼‰">3. BFS + å“ˆå¸Œè¡¨ï¼ˆè½¬ï¼‰</h3><p>å…·ä½“å®ç°å°±ä¸å†™äº†</p><h3 id="4-DFS-å“ˆå¸Œè¡¨-åŒæŒ‡é’ˆï¼ˆè½¬ï¼‰">4. DFS + å“ˆå¸Œè¡¨ + åŒæŒ‡é’ˆï¼ˆè½¬ï¼‰</h3><p>æ¯”è¾ƒæœ‰æ„æ€ï¼Œå…ˆæŠŠBSTè½¬åŒ–æˆæ•°ç»„ï¼Œåœ¨æ•°ç»„å±‚é¢ä¸Šæ‰¾</p><blockquote><p>å…·ä½“åœ°ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ªæŒ‡é’ˆåˆ†åˆ«æŒ‡å‘æ•°ç»„çš„å¤´å°¾ï¼Œå½“ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘çš„å…ƒç´ ä¹‹å’Œå°äº kk æ—¶ï¼Œè®©å·¦æŒ‡é’ˆå³ç§»ï¼›å½“ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘çš„å…ƒç´ ä¹‹å’Œå¤§äº kk æ—¶ï¼Œè®©å³æŒ‡é’ˆå·¦ç§»ï¼›å½“ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘çš„å…ƒç´ ä¹‹å’Œç­‰äº kk æ—¶ï¼Œè¿”å› ã€‚æœ€ç»ˆï¼Œå½“å·¦æŒ‡é’ˆå’Œå³æŒ‡é’ˆé‡åˆæ—¶ï¼Œæ ‘ä¸Šä¸å­˜åœ¨ä¸¤ä¸ªå’Œä¸º kk çš„èŠ‚ç‚¹ï¼Œè¿”å› \text{False}Falseã€‚</p><p>åŸç†è§ï¼šLeetCode 167 ä¸¤æ•°ä¹‹å’ŒII</p></blockquote><h3 id="åæ€-v11">åæ€</h3><ul><li>æ•´ä½“åšçš„ä¸è¡Œï¼Œæ•´ä½“æ€è·¯å‡ºæ¥å¿«ï¼Œä½†æŸ¥é”™æ—¶é—´ä¹…ï¼Œè¢«å„ç§nullé”™è¯¯å¡ä½ï¼Œä½¿ç”¨val \ left \ right æ—¶æ²¡æœ‰è¿›è¡Œéç©ºåˆ¤æ–­å‡ºé—®é¢˜æœ€å¤š</li><li>èƒ½æŠŠä¸­åºçš„é€’å½’æƒ³å‡ºæ¥è¿˜ä¸é”™</li></ul><h2 id="655-è¾“å‡ºäºŒå‰æ ‘â­â­">655. è¾“å‡ºäºŒå‰æ ‘â­â­</h2><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220822205946866.png" alt="image-20220822205946866"></p><h3 id="å®¡é¢˜-v43">å®¡é¢˜</h3><ul><li>è½¬åŒ–åçŸ©é˜µçš„å…ƒç´ ä¸ºå­—ç¬¦ä¸²</li><li>æ˜¯å¦è¦å…ˆç¡®å®šæ ‘çš„é«˜åº¦ä»è€Œæ¥ç¡®å®šçŸ©é˜µr x cçš„æ•°å€¼;æˆ–è€…åœ¨ä¸€æ¬¡éå†çš„æ—¶å€™åŠ¨æ€è°ƒæ•´å‰é¢çš„é•¿åº¦<ul><li>row = height</li><li>col = 2^(height - 1) + 1</li></ul></li><li>æ€è·¯ï¼š<ul><li>éå†æ ‘å¾—å‡ºé«˜åº¦ï¼Œå†å±‚æ¬¡éå†å¡«çŸ©é˜µæ¯ä¸€è¡Œçš„å€¼ï¼›ä½†è¿™é‡Œæ¯ä¸€å±‚å¦‚ä½•ç¡®å®šå…¶å…„å¼Ÿå…ƒç´ ä¹‹é—´çš„è·ç¦»ï¼Ÿ</li></ul></li></ul><h2 id="693-äº¤æ›¿ä½äºŒè¿›åˆ¶æ•°-â­">693. äº¤æ›¿ä½äºŒè¿›åˆ¶æ•° â­</h2><div class="code-tag-time">2022/3/28 19:55:00</div><div class="code-tag-label code-tag-label-math">Bit</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220328184317677.png" alt="image-20220328184317677"></p><h3 id="å®¡é¢˜-v44">å®¡é¢˜</h3><ul><li>æœ‰ç›¸åŒæ•°å­—ï¼š<ul><li>1 ç›¸é‚» 2^n + 2 ^ (n -1)</li><li>0 ç›¸é‚» åŒç†</li></ul></li><li>å¯èƒ½çš„æ€è·¯ï¼šä½è¿ç®—ã€å·¦å³ä½ç§»ï¼Ÿ</li><li>æ€è·¯ï¼š<ul><li>ç›´æ¥ï¼š<ul><li>è½¬æ¢æˆäºŒè¿›åˆ¶ï¼Œä¸€æ­¥æ­¥æ¯”è¾ƒ</li><li>å·¦å³ä½ç§»</li></ul></li><li>è¿›é˜¶ï¼š<ul><li>äºŒè¿›åˆ¶ çš„ä½è¿ç®—</li></ul></li></ul></li></ul><h3 id="1-ä½è¿ç®—">1. ä½è¿ç®—</h3><p>æ€è·¯è¿˜æ˜¯æ¯”è¾ƒæ¸…æ¥šï¼Œå…³é”®æ˜¯åˆ¤æ–­é‚»è¿‘çš„ä½æ˜¯å¦é‡å¤ï¼Œè€Œé‚»è¿‘çš„ä½çš„é‡å¤æƒ…å†µæ˜¯2 ^ n ä¸ 2 ^ (n-1)ä¸ è¿™ä¸ªæ•°çš„å…³ç³»ï¼Œä½†è¿™ç§æ¯”è¾ƒå¯ä»¥é€šè¿‡å³ç§»å¹¶ä¸” å¹¶ä¸Š1 å¾—åˆ°æœ€åä¸€ä½æ¥åˆ¤æ–­</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">hasAlternatingBits</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> lastBit <span class="token operator">=</span> n <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> temp <span class="token operator">=</span> n <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token comment">// temp / 2 == 0åˆ™ä¸åˆ¤æ–­äº†</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>temp <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// å¦‚æœä¸å‰ä¸€ä½ç›¸åŒï¼Œåˆ™ä¸æ»¡è¶³</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>lastBit <span class="token operator">==</span> <span class="token punctuation">(</span>temp <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        lastBit <span class="token operator">=</span> temp <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">;</span>        temp <span class="token operator">=</span> temp <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>ä½è¿ç®—å¾ˆå¿«</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220328191353621.png" alt="image-20220328191353621"></p><h3 id="åæ€-v12">åæ€</h3><ul><li>&amp; å’Œ ^ ç¬¦å·æé”™äº†ï¼ï¼&amp; æ˜¯å¹¶    ^ æ˜¯å¼‚æˆ–  ~æ˜¯åŒæˆ–</li><li>æ€è·¯ä¸é”™ï¼Œæƒ³çš„æ¯”è¾ƒå—</li></ul><h2 id="704-äºŒåˆ†æŸ¥æ‰¾-â­">704. äºŒåˆ†æŸ¥æ‰¾ â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-binary">Binary</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210906184027159.png" alt="image-20210906184027159"></p><h3 id="æ€è€ƒ-v18">æ€è€ƒ</h3><p>æœ‰åº å‡åº ã€è¿”å›ä¸‹æ ‡</p><h3 id="1-äºŒåˆ†æŸ¥æ‰¾">1. äºŒåˆ†æŸ¥æ‰¾</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">search</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> target<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> low <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> high <span class="token operator">=</span> nums<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> mid <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>low <span class="token operator">&lt;=</span> high<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            mid <span class="token operator">=</span> <span class="token punctuation">(</span>low <span class="token operator">+</span> high<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">&lt;</span> target<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                low <span class="token operator">=</span> mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">></span> target<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                high <span class="token operator">=</span> mid<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> mid<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p>ä¸»è¦è¿˜æ˜¯äºŒåˆ†æ³•çš„å®ç°ï¼Œæ³¨æ„whileçš„åˆ¤åˆ«æ¡ä»¶  &lt;=</p><p>æ³¨æ„low å’Œ highçš„å¢åŠ å’Œå‡å°‘ï¼Œé¿å…åœ¨ l h targetåœ¨ 1 2 2 æƒ…å†µä¸‹çš„é—®é¢˜</p><p>äºŒåˆ†æ³•è¿˜æ˜¯æœ‰æ¬ ç¼º</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210906190015115.png" alt="image-20210906190015115"></p><h2 id="720-è¯å…¸ä¸­æœ€é•¿çš„å•è¯-â­">720. è¯å…¸ä¸­æœ€é•¿çš„å•è¯ â­</h2><div class="code-tag-time">2022/3/18 12:12:00</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><div class="code-tag-label code-tag-label-hash">Hash</div><div class="code-tag-label code-tag-label-presum">Prefix Sum</div><div class="code-tag-label code-tag-label-trietree">Trie Tree</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220317164310236.png" alt="image-20220317164310236"></p><h3 id="æ€è€ƒ-v19">æ€è€ƒ</h3><ol><li>è¯¥å•è¯åˆå…¶ä»–å•è¯é€æ­¥æ·»åŠ ä¸€ä¸ªå­—æ¯ç»„æˆï¼ˆä¸æ˜¯è¿™æ ·çš„å•è¯å°±ä¸æ˜¯æ­£ç¡®ç­”æ¡ˆï¼Œå¯èƒ½æœ‰å…¶ä»–éšæ„çš„å•è¯ ï¼‰ï¼Œä¸ä¸€å®šæ˜¯ä»ä¸€ä¸ªå•è¯å¼€å§‹æ·»åŠ èµ·ï¼ˆå—ï¼Ÿï¼‰ï¼Œä¸”å¯èƒ½æ˜¯ä¹±åºã€‚ å¤šä¸ªç­”æ¡ˆåˆ™è¿”å›<strong>å­—å…¸åºæœ€å°</strong>çš„ã€‚</li><li>ç»†èŠ‚ï¼šä¸€ä¸ªå­—æ¯åå¯ä»¥è·Ÿä¸åŒçš„å­—æ¯ï¼Œè·Ÿä¸åŒå­—æ¯åæœ€ç»ˆé•¿åº¦å¯èƒ½å˜åŒ–ã€‚</li><li>å¯èƒ½çš„ç®—æ³•/æ•°æ®ç»“æ„ï¼šDFSï¼Ÿå“ˆå¸Œï¼Ÿå‰ç¼€ä¹‹ç±»çš„ä¸œè¥¿ï¼Ÿ</li><li>æ€è·¯ï¼š<ul><li>ç®€å•ï¼šä»¥æŸä¸€ä¸ªä¸€ä¸ªå­—æ¯çš„å•è¯ä¸ºé¦–ï¼Œéå†æ•°ç»„ï¼Œå¾—åˆ°ä¸€ä¸ªæœ€ç»ˆçš„å•è¯ï¼Œé¦–å­—æ¯å­˜åœ¨ã€‚å­˜åœ¨é›†åˆä¸­ï¼Ÿ</li><li>è¿›é˜¶ï¼šè€è¯ï¼šèƒ½å¦åœ¨Onçš„æ—¶é—´å¤æ‚åº¦å†…æ±‚å¾—ï¼Ÿ</li></ul></li></ol><h3 id="1-å“ˆå¸Œ-å‰ç¼€æ¯”è¾ƒ">1. å“ˆå¸Œ-å‰ç¼€æ¯”è¾ƒ</h3><p>HashSetä½œä¸ºåˆ¤æ–­å®¹å™¨ã€‚åˆ¤æ–­æ¡ä»¶ï¼š</p><ol><li>é¦–å­—æ¯æ²¡åŠ å°±åŠ è¿›å»</li><li>è¿™ä¸ªå•è¯çš„å‰n - 1ä¸ªå•è¯åœ¨setä¸­ï¼Œä¸”è¿™ä¸ªå•è¯ä¸åœ¨setä¸­å°±æ·»åŠ è¿›å»</li></ol><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">longestWord</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> words<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> words<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">if</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>             <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>set<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                 set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 i <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span>         <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>             <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>set<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> set<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                 set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 i <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span>         <span class="token punctuation">&#125;</span>     <span class="token punctuation">&#125;</span>     <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> it <span class="token operator">=</span> set<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token class-name">String</span> maxWord <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>     <span class="token keyword">while</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token class-name">String</span> next <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token keyword">if</span><span class="token punctuation">(</span>next<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> maxWord<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>             maxWord <span class="token operator">=</span> next<span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>         <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>next<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> maxWord<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>             maxWord <span class="token operator">=</span> maxWord<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>next<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">?</span> next <span class="token operator">:</span>maxWord<span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>     <span class="token punctuation">&#125;</span>     <span class="token keyword">return</span> maxWord<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></code></pre></div><p>æ—¶é—´å¤æ‚åº¦ï¼šè®¾æœ‰æœ€é•¿å•è¯æ•°aä¸ªï¼Œå•è¯é•¿åº¦ä¸ºmï¼Œæ•´ä½“æ•°ç»„é•¿åº¦ä¸ºMã€‚åˆ™æ—¶é—´å¤æ‚åº¦O(a) * O(m) * O(M)ï¼Œéå¸¸é«˜<br>ç©ºé—´å¤æ‚åº¦ï¼šO(a * m)</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220317172450350.png" alt="image-20220317172450350"></p><h3 id="2-å“ˆå¸Œ-é›†åˆä¸€æ¬¡éå†">2. å“ˆå¸Œ+é›†åˆä¸€æ¬¡éå†</h3><p>ä¸ä¹‹å‰æ€è·¯ç›¸åŒï¼Œä¸è¿‡ä»…ä»…æ˜¯ä¸€æ¬¡éå†åï¼Œé€šè¿‡å†æ¬¡éå†æ¯ä¸ªå…ƒç´ ï¼Œåˆ¤æ–­å…¶å‰ç¼€æ˜¯å¦éƒ½å­˜åœ¨</p><p>ç¼ºç‚¹ï¼šå­˜åœ¨å†—ä½™çš„åˆ¤æ–­ï¼Œæ¯”å¦‚a ap app ä¼šä¾æ¬¡åˆ¤æ–­</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">longestWord</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> words<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> words<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> words<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>           <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>set<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   <span class="token keyword">break</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>j <span class="token operator">></span> words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token class-name">String</span> maxWord <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">String</span> next <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>next<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> maxWord<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               maxWord <span class="token operator">=</span> next<span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>next<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> maxWord<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               maxWord <span class="token operator">=</span> maxWord<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>next<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">?</span> next <span class="token operator">:</span>maxWord<span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> maxWord<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p>æ—¶é—´å¤æ‚åº¦ï¼šO(a) * O(m)æ¯”ä¹‹å‰ç¨å¾®å¥½ä¸€ç‚¹<br>ç©ºé—´å¤æ‚åº¦ï¼šO(n)</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220318101119632.png" alt="image-20220318101119632"></p><h4 id="ä¼˜åŒ–-v6">ä¼˜åŒ–</h4><p><strong>æŒ‰å­—ç¬¦ä¸²é•¿åº¦è¿­ä»£</strong></p><p>ä¸€æ¬¡éå†çš„æ€è·¯ï¼šå…³é”®åœ¨äºè§£å†³ä¹‹å‰å¯¹æ¯ä¸ªå…ƒç´ å‰n-1ä¸ªå‰ç¼€éƒ½é‡å¤åˆ¤æ–­çš„å†—ä½™æ“ä½œ</p><p>æ ¸å¿ƒæ€è·¯ï¼šä»¥æ•°ç»„å…ƒç´ çš„lengthä¸ºæ ‡æ†ï¼ŒSetåªå­˜å½“å‰å‰lengthå‰ç¼€éƒ½å­˜åœ¨çš„å­—ç¬¦ä¸²ï¼ŒæŒ‰lengthéå†æ—¶ï¼Œåªç”¨åˆ¤æ–­ç¬¬length - 1ä¸ªå‰ç¼€ï¼ˆsubstring(0,length-1)ï¼‰çš„é‚£ä¸ªå­—ç¬¦ä¸²æ˜¯å¦å­˜åœ¨å°±è¡Œï¼Œæ„Ÿè§‰æœ‰ä¸€ç‚¹dpçš„æ€è·¯å—ï¼Ÿ</p><p>è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªå·²ä¼˜åŒ–ç‚¹ï¼šå¦‚æœå‡ºç°å­—ç¬¦ä¸²é•¿åº¦æ–­å±‚çš„ç°è±¡ï¼Œä¾‹å¦‚{â€œaâ€,â€œabâ€,â€œabcdâ€}ï¼Œè¿™æ ·ä¹Ÿä¸ä¼šæŠŠabcdè®¡å…¥ï¼Œå¹¶ä¸”ä¸ä¼šå†çœ‹ä¹‹åé•¿åº¦çš„æ•°ç»„äº†ï¼ˆå› ä¸ºå·²ç»**äº§ç”Ÿæ–­å±‚ï¼Œ**åç»­å­—ç¬¦ä¸²è‚¯å®šä¸æ»¡è¶³é¢˜æ„äº†ï¼‰</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">longestWord</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> words<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> words<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> flag <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> words<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>set<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> words<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> flag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            i <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>            length<span class="token operator">++</span><span class="token punctuation">;</span>            flag <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token class-name">String</span> maxWord <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">String</span> next <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>next<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> maxWord<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            maxWord <span class="token operator">=</span> next<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>next<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> maxWord<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            maxWord <span class="token operator">=</span> maxWord<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>next<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">?</span> next <span class="token operator">:</span>maxWord<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> maxWord<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>æ—¶é—´å¤æ‚åº¦ï¼šO(n) * O(length) ï¼ˆlengthä¸ºä¸æ–­å±‚çš„æœ€å¤§å­—ç¬¦ä¸²é•¿åº¦ï¼‰<br>ç©ºé—´å¤æ‚åº¦ï¼šO(n)</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220318104618817.png" alt="image-20220318104618817"></p><p>å®˜æ–¹è§£ç­”è·Ÿæˆ‘æ€è·¯ä¸€è‡´ï¼Œä½†æ˜¯æ˜¯Arrays.sortå…ˆæ’åºäº†ä¸€ä¸‹æ•°ç»„ï¼Œæ²¡æœ‰ç”¨åˆ°æŒ‰å±‚éå†ï¼Œå…¶å®æ²¡æœ‰åšæ–­å±‚æ–¹é¢ä¼˜åŒ–ï¼Œæ¯” è¿™é‡Œå·®ä¸€ç‚¹ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦åœ¨60%</p><h3 id="3-å­—å…¸æ ‘-å‰ç¼€æ ‘">3. å­—å…¸æ ‘ / å‰ç¼€æ ‘</h3><p>è§£å†³å­—ç¬¦ä¸²å‰ç¼€åŒ¹é…é—®é¢˜çš„å¥½å¸®æ‰‹ï¼è¦å…ˆæ¸…æ¥šå…¶æ•°æ®ç»“æ„ã€‚æŠ½ç©ºäº†è§£äº†ä¸€ä¸‹å­—å…¸æ ‘ï¼Œéå¸¸é€‚åˆè§£å†³æ­¤ç±»é—®é¢˜</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">longestWord</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> words<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Trie</span> trie <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Trie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> word <span class="token operator">:</span> words<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            trie<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">String</span> longest <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> word <span class="token operator">:</span> words<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>trie<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>word<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> longest<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>word<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> longest<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> word<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>longest<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    longest <span class="token operator">=</span> word<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> longest<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">Trie</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">Trie</span><span class="token punctuation">[</span><span class="token punctuation">]</span> children<span class="token punctuation">;</span>    <span class="token keyword">boolean</span> isEnd<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">Trie</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// æœ€å¤š26ä¸ªå­—æ¯</span>        children <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Trie</span><span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        isEnd <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">String</span> word<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Trie</span> node <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> word<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">char</span> ch <span class="token operator">=</span> word<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> index <span class="token operator">=</span> ch <span class="token operator">-</span> <span class="token char">'a'</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Trie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            node <span class="token operator">=</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        node<span class="token punctuation">.</span>isEnd <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">search</span><span class="token punctuation">(</span><span class="token class-name">String</span> word<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Trie</span> node <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> word<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">char</span> ch <span class="token operator">=</span> word<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> index <span class="token operator">=</span> ch <span class="token operator">-</span> <span class="token char">'a'</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token operator">!</span>node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>isEnd<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            node <span class="token operator">=</span> node<span class="token punctuation">.</span>children<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> node <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> node<span class="token punctuation">.</span>isEnd<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// ä½œè€…ï¼šLeetCode-Solution</span><span class="token comment">// é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/longest-word-in-dictionary/solution/ci-dian-zhong-zui-chang-de-dan-ci-by-lee-k5gj/</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220318110443715.png" alt="image-20220318110443715"></p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220318121136896.png" alt="image-20220318121136896"></p><h3 id="åæ€-v13">åæ€</h3><ul><li><p>æ€è€ƒé”™è¯¯ï¼šåœ¨for(;;)å¾ªç¯æ—¶æƒ³é‡æ–°å¾ªç¯ï¼Œåœ¨å¾ªç¯å†…éƒ¨ä½¿ç”¨i = 0 å¯¼è‡´å‡ºé”™ï¼Œ<strong>æ²¡æœ‰è€ƒè™‘æ¯æ¬¡å¾ªç¯åi è¿˜ä¼šåŠ 1</strong> ï¼Œå¯¼è‡´å®é™…ç»“æœä¸º 1 å¼€å§‹çš„æƒ…å†µã€‚</p></li><li><p>è„‘è¢‹ä¸æ˜¯å¾ˆæ¸…æ™°</p></li><li><p>ä¸€æ¬¡éå†çš„æ€æƒ³è¿˜æ˜¯èƒ½æä¾›ä¸»è¦æ€è·¯ï¼</p></li><li><p>forå¾ªç¯é‡ç½®æ—¶i = -1 è¿˜æ˜¯ i = 0 éœ€è¦æ³¨æ„</p></li><li><p>æœªè€ƒè™‘length == 1æ—¶ æŠŠå­—ç¬¦ä¸²åŠ è¿›é›†åˆä¸­</p></li><li><p>å­—ç¬¦ä¸²é•¿åº¦æ˜¯æ–¹æ³•ï¼Œè€Œä¸æ˜¯å±æ€§ï¼ˆç»†èŠ‚ï¼‰</p></li><li><p>compareToæ¯”è¾ƒå­—ç¬¦ä¸²çš„å­—å…¸åºï¼a.compareTo(b)ï¼š</p><ul><li><p>&lt; 0è¯´æ˜açš„å­—å…¸åºå°äºb</p></li><li><blockquote><p>0 åˆ™açš„å­—å…¸åºå¤§äºb</p></blockquote></li></ul></li></ul><h2 id="728-è‡ªé™¤æ•°-â­">728. è‡ªé™¤æ•° â­</h2><div class="code-tag-time">2022/3/31 18:53:00</div><div class="code-tag-label code-tag-label-iteration">Iteration</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220331182909108.png" alt="image-20220331182909108"></p><h3 id="å®¡é¢˜-v45">å®¡é¢˜</h3><ul><li>è¿”å›çš„æ˜¯èŒƒå›´å†…æ»¡è¶³æ¡ä»¶çš„æ•°</li><li>å¯èƒ½çš„ç®—æ³•ï¼šDP(æƒ³æ³•æ˜¯å¥½çš„)</li><li>æ€è·¯ï¼š<ul><li>ç›´æ¥ï¼š<ul><li>æ‹†åˆ†ä½æ•°ï¼ŒæŒ‰åè¿›åˆ¶é™¤</li></ul></li></ul></li></ul><h3 id="1-è¿­ä»£-v4">1. è¿­ä»£</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> <span class="token function">selfDividingNumbers</span><span class="token punctuation">(</span><span class="token keyword">int</span> left<span class="token punctuation">,</span> <span class="token keyword">int</span> right<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> left<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> right<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isSelfDividNum</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> list<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isSelfDividNum</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> temp <span class="token operator">=</span> n<span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>temp <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> div <span class="token operator">=</span> temp <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">;</span>            temp <span class="token operator">/=</span> <span class="token number">10</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>div <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> n <span class="token operator">%</span> div <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p>æ˜¯çœŸæ²¡æƒ³åˆ°æœ€ç›´æ¥çš„æ–¹æ³•å±…ç„¶æ¥è¿‘æœ€å¿«â€¦æ—¶é—´å¤æ‚åº¦<em>O</em>(n* log_10{right})</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220331184331762.png" alt="image-20220331184331762"></p><h4 id="ä¼˜åŒ–-v7">ä¼˜åŒ–</h4><p>è€ƒè™‘é¢„å¤„ç† + ç´¢å¼•ï¼Œä¸è¿‡æ„ä¹‰ä¸æ˜¯å¾ˆå¤§æ„Ÿè§‰</p><h4 id="æ€è€ƒ-v20">æ€è€ƒ</h4><ul><li>å…ˆæŠŠæœ€ç®€å•çš„åšå‡ºæ¥å†è¯´éš¾çš„å§</li></ul><h2 id="747-è‡³å°‘æ˜¯å…¶ä»–æ•°å­—ä¸¤å€çš„æœ€å¤§æ•°-â­">747. è‡³å°‘æ˜¯å…¶ä»–æ•°å­—ä¸¤å€çš„æœ€å¤§æ•° â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220113210501253.png" alt="image-20220113210501253"></p><h3 id="å®¡é¢˜-v46">å®¡é¢˜</h3><ul><li>æœ€å¤§æ•´æ•°çš„å”¯ä¸€æ€§</li><li>è‡³å°‘æ˜¯<strong>æ¯ä¸ª</strong>å…¶ä»–æ•°å­—çš„ä¸¤å€</li><li>èƒ½å¦åœ¨Nçš„æ—¶é—´å¤æ‚åº¦å†…å®Œæˆï¼Ÿè¾¹æ‰¾æœ€å¤§çš„è¾¹éªŒè¯ï¼Ÿ</li><li>ä¸€ç§åšæ³•æ˜¯å…ˆæ‰¾åˆ°æœ€å¤§çš„æ•°LogN ç„¶åå†éå†æ•°ç»„éªŒè¯è§„åˆ™ LogNï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯LogN</li></ul><h3 id="1-LogNçš„ä¸¤æ¬¡å¾ªç¯">1. LogNçš„ä¸¤æ¬¡å¾ªç¯</h3><p>å®¡é¢˜æ—¶çš„æƒ³æ³•ï¼Œæ¯”è¾ƒç®€å•ï¼Œä¸¤æ¬¡LogNçš„æœç´¢å³å¯å®Œæˆ</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">dominantIndex</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">int</span> max <span class="token operator">=</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>     <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>     <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>     <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">>=</span> max<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>             max <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>             index <span class="token operator">=</span> i<span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>     <span class="token punctuation">&#125;</span>     <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> max<span class="token punctuation">)</span>             <span class="token keyword">continue</span><span class="token punctuation">;</span>         <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">&lt;=</span> max<span class="token punctuation">)</span>             sum<span class="token operator">++</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span>     <span class="token keyword">if</span><span class="token punctuation">(</span>sum <span class="token operator">==</span> nums<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>          <span class="token keyword">return</span> index<span class="token punctuation">;</span>     <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220113211744734.png" alt="image-20220113211744734"></p><h3 id="2-åŒæ—¶æ‰¾åˆ°æœ€å¤§å€¼å’Œæ¬¡å¤§å€¼">2. åŒæ—¶æ‰¾åˆ°æœ€å¤§å€¼å’Œæ¬¡å¤§å€¼</h3><p>æ²¡æ·±æƒ³ï¼Œç¨å¾®æƒ³åˆ°äº†è¿™é‡Œ</p><p>æ‰¾åˆ°æ¬¡å¤§å€¼åªè¦åˆ¤æ–­æ¬¡å¤§å€¼æ˜¯å¦å¤§äºæœ€å¤§å€¼å³å¯ï¼Œå³çœå»äº†ä¹‹åçš„ç¬¬äºŒæ¬¡LogNçš„åˆ¤æ–­æ“ä½œï¼Œä½†ä»æ•´ä½“çš„æ—¶é—´å¤æ‚åº¦æ¥çœ‹ä¸¤è€…æ˜¯ä¸€æ ·çš„</p><h2 id="781-æ£®æ—ä¸­çš„å…”å­ï¼ˆåä¸ºï¼‰-â­â­">781. æ£®æ—ä¸­çš„å…”å­ï¼ˆåä¸ºï¼‰ â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-hash">Hash</div><div class="code-tag-label code-tag-label-math">Math</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210907152833634.png" alt="image-20210907152833634"></p><h3 id="æ€è€ƒ-v21">æ€è€ƒ</h3><p>æ³¨æ„å›ç­”æ˜¯<strong>è¿˜æœ‰</strong>å‡ åªå…”å­é¢œè‰²ç›¸åŒï¼Œæ³¨æ„ç›¸åŒæ•°å­—çš„ç´¢å¼•é›†åˆæ•°ç›®ï¼Œæ˜¯å¦è¶…è¿‡å…¶æœ¬èº«æ•°å­—ï¼Œè‚¯å®šæ˜¯éœ€è¦éå†å…¨çš„ï¼Œè‡³å°‘Onå¤æ‚åº¦</p><h3 id="1-å“ˆå¸Œè¡¨-è®¡æ•°æ¸…é›¶">1. å“ˆå¸Œè¡¨+è®¡æ•°æ¸…é›¶</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">numRabbits</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> answers<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> total <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>answers<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> total<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span>  hashMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>answers<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>answers<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> answers<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> sCount <span class="token operator">=</span> answers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>sCount<span class="token punctuation">,</span>hashMap<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>sCount<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>hashMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>sCount<span class="token punctuation">)</span> <span class="token operator">></span> sCount <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            total <span class="token operator">+=</span> sCount <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>            hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>sCount<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span> integer <span class="token operator">:</span> hashMap<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        total <span class="token operator">+=</span> integer <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> total<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210907154710259.png" alt="image-20210907154710259"></p><p>è¿™é‡Œä¸»è¦è§£å†³çš„é—®é¢˜å°±æ˜¯åœ¨(1,1,1,1,1)çš„è¿™ç§æƒ…å†µä¸‹ï¼Œæ’é™¤éƒ½æ˜¯åŒä¸€ç±»çš„æƒ…å†µï¼Œåœ¨è¶…è¿‡æ€»å’Œæ—¶ï¼Œç›´æ¥å¢åŠ åˆ°æœ€ç»ˆè®¡æ•°ä¸­</p><h3 id="2-æ•°ç»„ä»£æ›¿å“ˆå¸Œè¡¨">2. æ•°ç»„ä»£æ›¿å“ˆå¸Œè¡¨</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">numRabbits</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> answers<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> total <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>answers<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> total<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span> max <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> answers<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>max <span class="token operator">&lt;</span> answers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>                max <span class="token operator">=</span> answers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>max<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> answers<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> sCount <span class="token operator">=</span> answers<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            nums<span class="token punctuation">[</span>sCount<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>sCount<span class="token punctuation">]</span> <span class="token operator">></span> sCount <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                total <span class="token operator">+=</span> sCount <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>                nums<span class="token punctuation">[</span>sCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;=</span>max<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            total <span class="token operator">+=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> total<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210907155156265.png" alt="image-20210907155156265"></p><p>è€ƒè™‘åˆ°å“ˆå¸Œè¡¨è¯»å–é€Ÿåº¦ï¼Œä»¥åŠåç»­æ‰©å®¹é—®é¢˜ï¼ˆä½†æˆ‘è¿™é‡Œæå‰è®¾ç½®å®¹é‡ï¼Œæ‰€ä»¥ä¸å­˜åœ¨ï¼‰ã€‚ä¸ºäº†èŠ‚çœæ—¶é—´ï¼Œè¿™é‡Œé‡‡ç”¨åŸæ¥æ–¹æ³•çš„æ•°ç»„ä»£æ›¿å“ˆå¸Œè¡¨çš„å­˜å–æ“ä½œï¼Œå…ˆéå†ä¸€æ¬¡ï¼Œå–å¾—æœ€å¤§å€¼ã€‚</p><p>åç»­è¿™é‡Œçš„æ”¹è¿›ä¸»è¦æ˜¯å¯ä»¥ä»max å’Œminå€¼ï¼Œå¯¹numså®¹é‡è¿›è¡Œç©ºé—´èŒƒå›´çš„ç¼©å°ã€‚</p><h3 id="3-æ•°å­¦æ–¹æ³•ï¼ˆä¸å¤ªæ‡‚ï¼‰">3. æ•°å­¦æ–¹æ³•ï¼ˆä¸å¤ªæ‡‚ï¼‰</h3><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210907191535279.png" alt="image-20210907191535279"></p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">numRabbits</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> answers<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> count <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> y <span class="token operator">:</span> answers<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            count<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> count<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> entry <span class="token operator">:</span> count<span class="token punctuation">.</span><span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> y <span class="token operator">=</span> entry<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x <span class="token operator">=</span> entry<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            ans <span class="token operator">+=</span> <span class="token punctuation">(</span>x <span class="token operator">+</span> y<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>y <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>y <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> ans<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210907191620776.png" alt="image-20210907191620776"></p><h3 id="é—ç•™é—®é¢˜">é—ç•™é—®é¢˜</h3><p>HashMapçš„å››ç§éå†ï¼Œå“ªç§å¿«ä¸€ç‚¹ï¼Ÿ</p><h2 id="819-æœ€å¸¸è§çš„å•è¯-â­">819. æœ€å¸¸è§çš„å•è¯ â­</h2><div class="code-tag-time">2022/4/17 17:34:00</div><div class="code-tag-label code-tag-label-hash">Hash</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220417185854100.png" alt="image-20220417185854100"></p><h3 id="å®¡é¢˜-v47">å®¡é¢˜</h3><ul><li>è¦æ±‚ï¼šä¸åœ¨ç¦ç”¨åˆ—è¡¨ä¸­ï¼Œä¸”å‡ºç°æ¬¡æ•°æœ€å¤šã€‚</li><li>çŒœæƒ³ï¼šå¿…é¡»è¦éå†ä¸€æ¬¡</li></ul><h3 id="1-Hash">1. Hash</h3><p>è¯»å–æ¯ä¸ªå•è¯ï¼Œç„¶åçœ‹Hashè¡¨ä¸­æœ‰æ— ç›¸åŒçš„å…ƒç´ ï¼ˆä¸”ä¸ä¸º-1ï¼Œ-1ä»£è¡¨æ˜¯è¢«ç¦æ­¢çš„ï¼‰ï¼Œç„¶åå®è¡Œè‡ªå¢ï¼Œç»´æŠ¤ä¸€ä¸ªå˜é‡è®°å½•å½“å‰çš„æœ€å¤§å‡ºç°æ¬¡æ•°çš„å•è¯ã€‚ä¼˜åŒ–ç‚¹æ˜¯æ²¡æœ‰ç”¨å½“å‰å•è¯å»å¾ªç¯æ¯”è¾ƒbannedæ•°ç»„çœ‹æœ‰æ²¡æœ‰è¢«ç¦æ­¢çš„å•è¯ï¼Œè€Œæ˜¯ç”¨äº†å“ˆå¸Œè¡¨çš„æ–¹å¼ï¼Œæ¯”è¾ƒå¿«é€Ÿã€‚ï¼ˆä»£ç å†™çš„å¾ˆä¸‘ï¼Œä¸¥æ ¼æ„ä¹‰ä¸Šç­”æ¡ˆçš„é¢˜è§£ä¸æ˜¯ä¸€ä¸ªæ®µè½ï¼Œæœ‰ä¾‹å¦‚&quot;Bob&quot;è¿™æ ·çš„å­—ç¬¦ä¸²ï¼Œæ²¡æœ‰ä»¥ . ç»“å°¾ï¼‰</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">mostCommonWord</span><span class="token punctuation">(</span><span class="token class-name">String</span> paragraph<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> banned<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> strMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> begin <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> end <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token class-name">String</span> curMax <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> banned<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          strMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>banned<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> paragraph<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>begin <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>paragraph<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token char">'a'</span> <span class="token operator">&amp;&amp;</span> paragraph<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token char">'z'</span> <span class="token operator">||</span> paragraph<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token char">'A'</span> <span class="token operator">&amp;&amp;</span> paragraph<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token char">'Z'</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              start <span class="token operator">=</span> i<span class="token punctuation">;</span>              begin <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>begin <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>paragraph<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token char">'a'</span> <span class="token operator">&amp;&amp;</span> paragraph<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token char">'z'</span> <span class="token operator">||</span> paragraph<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token char">'A'</span> <span class="token operator">&amp;&amp;</span> paragraph<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token char">'Z'</span> <span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span> i <span class="token operator">==</span> paragraph<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>              end <span class="token operator">=</span> i<span class="token punctuation">;</span>              begin <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>              <span class="token class-name">String</span> curWord <span class="token operator">=</span> paragraph<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span>end <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token keyword">int</span> numInMap <span class="token operator">=</span> strMap<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>curWord<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token keyword">if</span><span class="token punctuation">(</span>numInMap <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                  strMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>curWord<span class="token punctuation">,</span>numInMap<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  curMax <span class="token operator">=</span> strMap<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>curMax<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">></span> numInMap <span class="token operator">+</span> <span class="token number">1</span><span class="token operator">?</span> curMax <span class="token operator">:</span> curWord<span class="token punctuation">;</span>                  <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>begin <span class="token operator">==</span> <span class="token number">1</span>  <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>paragraph<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token char">'a'</span> <span class="token operator">||</span> paragraph<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token char">'z'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span> paragraph<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token char">'Z'</span><span class="token operator">||</span> paragraph<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token char">'A'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              end <span class="token operator">=</span> i<span class="token punctuation">;</span>              begin <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>              <span class="token class-name">String</span> curWord <span class="token operator">=</span> paragraph<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span>end<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token keyword">int</span> numInMap <span class="token operator">=</span> strMap<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>curWord<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token keyword">if</span><span class="token punctuation">(</span>numInMap <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                  strMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>curWord<span class="token punctuation">,</span>numInMap<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  curMax <span class="token operator">=</span> strMap<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>curMax<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">></span> numInMap <span class="token operator">+</span> <span class="token number">1</span><span class="token operator">?</span> curMax <span class="token operator">:</span> curWord<span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">return</span> curMax<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220417192846808.png" alt="image-20220417192846808"></p><h3 id="åæ€-v14">åæ€</h3><ul><li>é¢˜è§£ä¸­æ›´å¥½çš„æ–¹æ³•å»**åˆ¤æ–­å½“å‰å­—ç¬¦æ˜¯å¦æ˜¯è‹±æ–‡å­—ç¬¦ï¼ˆåŒ…æ‹¬å¤§å°å†™ï¼‰ï¼šCharacter.isLetter();**é¢˜è§£ç”¨Setå»ç»´æŠ¤çš„bannedæ•°ç»„ï¼Œä¸€æ ·çš„æ€è·¯ï¼Œæ›´åŠ ç®€æ´</li></ul><h2 id="821-å­—ç¬¦çš„æœ€çŸ­è·ç¦»-â­">821. å­—ç¬¦çš„æœ€çŸ­è·ç¦» â­</h2><div class="code-tag-time">2022/4/20 19:43:00</div><div class="code-tag-label code-tag-label-foreach">Twin Pointer</div><div class="code-tag-label code-tag-label-list">List</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220420184955890.png" alt="image-20220420184955890"></p><h3 id="å®¡é¢˜-v48">å®¡é¢˜</h3><ul><li>è¿”å›çš„è·ç¦»æ˜¯æœ€è¿‘çš„ã€‚</li><li>æƒ³æ³•ï¼šåŒæŒ‡é’ˆï¼Ÿ</li><li>æ€è·¯ï¼š<ul><li>ç›´æ¥ï¼š<ul><li>åŒæŒ‡é’ˆï¼šiç”¨äºä½œä¸ºå¤–éƒ¨å¾ªç¯ï¼Œi != cæ—¶ï¼Œåˆ™ j++ï¼Œjè´Ÿè´£æ‰¾åˆ°æœ€è¿‘çš„cï¼Œå½“iè¶…è¿‡jæ—¶ï¼Œç»´æŠ¤æ—§çš„jï¼Œéœ€è¦æ‰¾æ–°çš„cæ¥åšMath.minçš„åˆ¤æ–­</li></ul></li></ul></li></ul><h3 id="1-åŒæŒ‡é’ˆ">1. åŒæŒ‡é’ˆ</h3><p>åŒºé—´é—®é¢˜ï¼Œç»´æŠ¤ä¸¤ä¸ªæŒ‡é’ˆå’Œä¸€ä¸ªå˜é‡ï¼Œå…ˆæ‰¾åˆ°ç¬¬ä¸€ä¸ªè¾ƒè¿‘çš„ç›¸ç­‰å­—ç¬¦ç´¢å¼•ä½ç½® k</p><ul><li>å½“å‰è¿­ä»£åºå· &lt; é åæŒ‡é’ˆç´¢å¼•ä¸”<strong>é åæŒ‡é’ˆæœ‰æ•ˆ</strong>ï¼ˆé å‰æŒ‡é’ˆæŒ‡å‘çš„ä¸æ˜¯æœ€åä¸€ä¸ªç›¸ç­‰å­—ç¬¦çš„ç´¢å¼•ï¼‰ï¼šåˆ™éœ€è¦æ¯”è¾ƒä¸é å‰å’Œé åæŒ‡é’ˆç´¢å¼•çš„æœ€å°å€¼</li><li>å½“å‰è¿­ä»£åºå· &gt; é åæŒ‡é’ˆç´¢å¼•ä¸”é åæŒ‡é’ˆæœ‰æ•ˆï¼šæ›´æ–°é åæŒ‡é’ˆä¸é å‰æŒ‡é’ˆï¼ˆéœ€è¦æ³¨æ„ç•Œé™é—®é¢˜ï¼Œä¸æœ€å¼€å§‹é å‰æŒ‡é’ˆçš„å–å€¼æ¡ä»¶ï¼‰</li><li>é åæŒ‡é’ˆæ— æ•ˆï¼Œåˆ™ç›´æ¥å–å€¼ä¸ºï¼šå½“å‰ä½ç½®-é å‰æŒ‡é’ˆ</li></ul><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">shortestToChar</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">,</span> <span class="token keyword">char</span> c<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// i: å½“å‰éå†çš„å­—ç¬¦ç´¢å¼• j: é å‰çš„ä¸cç›¸ç­‰çš„å­—ç¬¦ç´¢å¼• k: é åçš„ä¸cç›¸ç­‰çš„å­—ç¬¦ç´¢å¼•</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token operator">!=</span> c<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>k <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> i <span class="token operator">&lt;=</span> j<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>i <span class="token operator">-</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">&lt;=</span> j<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">==</span> c<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>i <span class="token operator">-</span> k<span class="token punctuation">,</span> j <span class="token operator">-</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i <span class="token operator">-</span> k<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">></span> j<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            k <span class="token operator">=</span> j<span class="token punctuation">;</span>            <span class="token keyword">while</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token operator">!=</span> c <span class="token operator">&amp;&amp;</span> j <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">!=</span> c<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i <span class="token operator">-</span> k<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>i <span class="token operator">-</span> k<span class="token punctuation">,</span> j <span class="token operator">-</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>O(n+n)çš„æ—¶é—´å¤æ‚åº¦</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220420191448279.png" alt="image-20220420191448279"></p><h3 id="2-é›†åˆ">2. é›†åˆ</h3><p>å…ˆéå†ä¸€æ¬¡æŠŠæ‰€æœ‰çš„ç›¸åŒå­—ç¬¦ç´¢å¼•å­˜èµ·æ¥ï¼Œç„¶åé€šè¿‡æ¯æ¬¡è¿­ä»£æ—¶åˆ¤æ–­å½“å‰ç´¢å¼•ä¸é›†åˆä¸­ç´¢å¼•çš„å…³ç³»å³å¯ï¼Œæ€è·¯ä¸ä¸Šè§£ç›¸ä¼¼ã€‚ä½†æ—¶é—´å¤æ‚åº¦å¾ˆä½ï¼Œè€ƒè™‘å¯èƒ½éœ€è¦å…ˆéå†ä¸€æ¬¡å­—ç¬¦ä¸²ï¼Ÿ</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">shortestToChar</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">,</span> <span class="token keyword">char</span> c<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> i<span class="token punctuation">,</span>j <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span>s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> c<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span>s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>j <span class="token operator">==</span> list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>i <span class="token operator">-</span> list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>j <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> i <span class="token operator">&lt;=</span> list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">-</span> i<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span> i <span class="token operator">></span> list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            j<span class="token operator">++</span><span class="token punctuation">;</span>            i<span class="token operator">--</span><span class="token punctuation">;</span>            <span class="token keyword">continue</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">&lt;=</span> list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">-</span> i<span class="token punctuation">,</span> i <span class="token operator">-</span> list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220420194109506.png" alt="image-20220420194109506"></p><h2 id="908-æœ€å°å·®å€¼I-â­">908. æœ€å°å·®å€¼I â­</h2><div class="code-tag-time">2022/4/30 11:06:00</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220430105059190.png" alt="image-20220430105059190"></p><h3 id="å®¡é¢˜-v49">å®¡é¢˜</h3><ul><li>æ ¸å¿ƒï¼šåœ¨å¯¹æ¯ä¸ªæ•°åœ¨[-k,k]çš„å˜åŒ–èŒƒå›´å†…ï¼Œæ˜¯å¦ä¸å¦ä¸€ä¸ªæ•°ç›¸å‡æœ‰æœ€å°å€¼</li><li>åˆ†æï¼š<ul><li>æ¯ä¸ªæ•°éƒ½<strong>å¿…é¡»éå†ä¸€æ¬¡</strong>ï¼æœ€ä½³æ—¶é—´å¤æ‚åº¦æ˜¯On</li></ul></li><li>æ€è·¯ï¼š<ul><li>ç›´æ¥ï¼š<ul><li>å…ˆç¡®å®šæœ€å°å€¼æœ€å¤§å€¼<ul><li>å¦‚æœå·®å€¼å°äº<strong>2 * k</strong>ï¼Œåˆ™ç›´æ¥ç­‰äº0</li><li>è‹¥å·®å€¼å¤§äº2 * kï¼Œåˆ™è¿”å›å·®å€¼-2kçš„å€¼ï¼Ÿ</li></ul></li></ul></li></ul></li></ul><h3 id="1-éå†-v2">1. éå†</h3><p>éå†æ‰¾æœ€å¤§å€¼ï¼Œå’Œæœ€å°å€¼ï¼Œä¸2 * k çš„å€¼è¿›è¡Œæ¯”è¾ƒã€‚Onçš„æ—¶é—´å¤æ‚åº¦ï¼ŒO1çš„ç©ºé—´å¤æ‚åº¦</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java">  <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">smallestRangeI</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> min <span class="token operator">=</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> max <span class="token operator">=</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token operator">:</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        min <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> min<span class="token punctuation">)</span><span class="token punctuation">;</span>        max <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> max<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>max <span class="token operator">-</span> min <span class="token operator">&lt;=</span> <span class="token number">2</span> <span class="token operator">*</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> max <span class="token operator">-</span> min <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> k<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220430110515116.png" alt="image-20220430110515116"></p><h3 id="åæ€-v15">åæ€</h3><ul><li>Math.maxæˆ–è€…Math.minéƒ¨åˆ†å½±å“å†…å­˜æ¶ˆè€—å’Œæ‰§è¡Œç”¨æ—¶ï¼Œç›´æ¥æ¢æˆä¸‰ç›®è¿ç®—ç¬¦</li></ul><h2 id="954-äºŒå€æ•°å¯¹æ•°ç»„-â­â­">954. äºŒå€æ•°å¯¹æ•°ç»„ â­â­</h2><div class="code-tag-time">2022/4/2 09:42:00</div><div class="code-tag-label code-tag-label-hash">Hash</div><div class="code-tag-label code-tag-label-sort">Sort</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220401184802279.png" alt="image-20220401184802279"></p><h3 id="å®¡é¢˜-v50">å®¡é¢˜</h3><ul><li>é•¿åº¦ä¸ºå¶æ•°ï¼Œå·²ç»™å®š.è¦å¯¹arrè¿›è¡Œé‡ç»„</li><li>å¯èƒ½çš„ç®—æ³•ï¼š</li><li>æ€è·¯ï¼š<ul><li>ç›´æ¥ï¼š<ul><li>å®é™…å°±æ¯ä¸ªæ•°è¦æœ‰ä¸€ä¸ªå¯¹åº”çš„æ•°è¦ä¹ˆæ˜¯å®ƒçš„äºŒå€è¦ä¹ˆæ˜¯å®ƒçš„2/1ï¼Œè€ƒè™‘ç”¨å“ˆå¸Œè¡¨ï¼Œå­˜å‚¨æ•°æ®å€¼å’Œè¿™ä¸ªæ•°å‡ºç°çš„æ•°ç›®ã€‚å†æ¬¡éå†ï¼ŒæŸ¥è¿™ä¸ªæ•°çš„2å€æˆ–è€…2/1æ˜¯å¦å­˜åœ¨ã€‚ï¼ˆä½†å¯èƒ½çš„æƒ…å†µæ˜¯ï¼Œå…ˆæ‰¾2å€ï¼Œä½†åé¢ä¼šå‘ç°ä¸æ»¡è¶³[4,8,2,16]ï¼Œæ‰€ä»¥å¯èƒ½ç”¨åˆ°å›æº¯ï¼‰</li></ul></li></ul></li></ul><h3 id="1-å“ˆå¸Œ-DFS-è¶…æ—¶">1. å“ˆå¸Œ+DFS(è¶…æ—¶)</h3><p>æ¯”è¾ƒç›´æ¥ä½†å¾ˆéº»çƒ¦çš„æƒ³æ³•ï¼Œå¯¹åŸå§‹æ•°ç»„ï¼Œå…ˆéå†ä¸€æ¬¡ï¼Œè®¡æ•°æ”¾å…¥å“ˆå¸Œè¡¨ä¸­ï¼›é’ˆå¯¹é€’å¢ç´¢å¼•ï¼Œéƒ½è¿›è¡Œæƒ…å†µä¸º num / 2 å’Œ num*2çš„å“ˆå¸ŒæŸ¥è¯¢ï¼Œå¦‚æœä¸ä¸º0ï¼Œåˆ™ä¸¤è€…è®¡æ•°éƒ½-1å¹¶è¿›å…¥ä¸‹ä¸€å±‚ï¼ŒDFSï¼Œå›åˆ°æœ¬å±‚æ—¶è¦è¿˜åŸç°åœºã€‚å› ä¸ºDFSï¼Œæ‰€ä»¥æµªè´¹äº†å¾ˆå¤šæ—¶é—´ï¼Œæ²¡æœ‰å¿…è¦ï¼Œè¶…æ—¶äº†ç†æ‰€å½“ç„¶</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">canReorderDoubled</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> tmp<span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>tmp <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>                <span class="token keyword">return</span> <span class="token function">dfs</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>arr<span class="token punctuation">,</span>arr<span class="token punctuation">.</span>length <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> map<span class="token punctuation">,</span><span class="token keyword">int</span> i<span class="token punctuation">,</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr<span class="token punctuation">,</span><span class="token keyword">int</span> count<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// åŒ¹é…æˆåŠŸ</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>count <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// è¿™ä¸ªæ•°å·²ç»è¢«ç”¨äº†</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            i<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">boolean</span> a <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">boolean</span> b <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token comment">// å¥‡å¶åˆ¤æ–­ï¼Œå¦‚æœæ˜¯å¥‡æ•°ï¼Œåˆ™num/2çš„æƒ…å†µè‚¯å®šæ˜¯falseçš„(numä¸ºæ•´æ•°)</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            a <span class="token operator">=</span> <span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        b <span class="token operator">=</span> <span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            a <span class="token operator">=</span> <span class="token function">dfs</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>arr<span class="token punctuation">,</span>count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// è¿˜åŸç°åœº</span>            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            b <span class="token operator">=</span> <span class="token function">dfs</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>arr<span class="token punctuation">,</span>count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> a <span class="token operator">|</span> b<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><h3 id="2-æ’åº-è¿­ä»£">2. æ’åº+è¿­ä»£</h3><p>åŠ ä¸Šäº†æ’åºï¼Œè¿™æ ·å°±èƒ½é¿å…åœ¨æ— åºçš„æ•°ç»„ä¸­é€šè¿‡å›æº¯çš„æ–¹å¼æŸ¥æ‰¾ã€‚é€šè¿‡æœ‰åºçš„æ–¹å¼ä»å°åˆ°å¤§çš„æœç´¢ã€‚å¹¶ä¸”æœ‰æ˜“å¿½ç•¥ç‚¹ï¼šå¯¹äºæœ‰åºæ•°ç»„ï¼Œå¯¹äºè´Ÿæ•°ï¼Œå…¶å®æ˜¯arr[i*2] == arr[i * 2+1] * 2ï¼Œè€Œä¸èƒ½ç›´æ¥ç”¨é¢˜è¿°çš„arr[2 * i + 1] == arr[i * 2]ï¼ˆ<strong>æ³¨æ„ç‚¹</strong>ï¼‰</p><p>è¿™é‡Œå…¶å®è¿˜æœ‰ä¸€ä¸ª<strong>æ•°å­¦åŸç†</strong>ï¼š</p><p>å¯¹äºæœ‰åºæ’åºçš„æ•°ç»„ä¸­çš„ä¸€ä¸ªæ•°ï¼Œç´¢å¼•ä¸ºiï¼Œå¦‚æœæ»¡è¶³ä¸Šè¿°é¢˜è¿°æ¡ä»¶ï¼Œåˆ™<strong>å¿…å®šåœ¨[ i, i + (arr.length / 2) ]çš„ç´¢å¼•èŒƒå›´ä¸­æ‰¾åˆ°è¿™ä¸ªæ•°</strong>ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘è¿˜å¯ä»¥åšä¸€ä¸ªä¼˜åŒ–ï¼Œå°†å†…å¾ªç¯ç”±æœ€å¤šnæ¬¡ä¼˜åŒ–åˆ°n/2æ¬¡ï¼Œå½“ç„¶è¿˜æ˜¯éœ€è¦åœ¨æ•°ç»„çš„è¾¹ç•ŒèŒƒå›´å†…ï¼Œä¸è¿‡è¿™ä¸ªä¼˜åŒ–ä¸æ˜¯ç‰¹åˆ«é‡è¦</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">canReorderDoubled</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">int</span> zero_idx <span class="token operator">=</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   zero_idx <span class="token operator">=</span> i<span class="token punctuation">;</span>                   <span class="token keyword">break</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                   <span class="token comment">// ä¼˜åŒ–ï¼šå¦‚æœé›¶çš„ä¸ªæ•°ä¸ºå¥‡æ•°ï¼Œåˆ™è‚¯å®šä¸åŒ¹é…</span>                   <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>    <span class="token comment">// è®¾ç½®æ ‡å¿—ä½ï¼Œåˆ¤æ–­è¿™ä¸ªç´¢å¼•ä¸Šçš„æ•°æ˜¯å¦è¢«ç”¨äº†</span>       <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> flag <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>arr<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">// ä»éæ­£æ•´æ•°ä½ç½®å¼€å§‹</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> zero_idx <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           k <span class="token operator">=</span> i<span class="token punctuation">;</span>           <span class="token comment">// å·²è¢«ä½¿ç”¨</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>               <span class="token keyword">continue</span><span class="token punctuation">;</span>           <span class="token keyword">while</span><span class="token punctuation">(</span>k <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token keyword">if</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token operator">--</span>k<span class="token punctuation">]</span> <span class="token operator">==</span>  <span class="token number">2</span> <span class="token operator">*</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> flag<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                   flag<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                   <span class="token keyword">break</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>    <span class="token comment">// ä»æ­£æ•´æ•°ä½ç½®å¼€å§‹</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> zero_idx <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           k <span class="token operator">=</span> i<span class="token punctuation">;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>               <span class="token keyword">continue</span><span class="token punctuation">;</span>           <span class="token keyword">while</span><span class="token punctuation">(</span>k <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token keyword">if</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token operator">++</span>k<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">*</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> flag<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                   flag<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                   <span class="token keyword">break</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>    <span class="token comment">// å¯ä¼˜åŒ–</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>               <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p>å› ä¸ºå†…å¾ªç¯ï¼Œæ‰€ä»¥è¾¾åˆ°äº†O(n *2)çš„æ—¶é—´å¤æ‚åº¦<br>O(n)çš„ç©ºé—´å¤æ‚åº¦</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220401214920594.png" alt="image-20220401214920594"></p><p>å…¶å®è¿™é‡Œéƒ½æµªè´¹äº†å¾ˆå¤šæ—¶é—´ï¼Œæ¯”å¦‚åœ¨å¯¹æŸä¸€ç´¢å¼•éå†æ—¶è¿˜å¯ä»¥åˆ¤æ–­ï¼Œå¦‚æœwhileç»“æŸåæŸä¸€æ¬¡flag[i] == 0,è¯´æ˜æ²¡æœ‰æ‰¾åˆ°æƒ³è¦çš„å€¼ï¼Œå¯ä»¥ç›´æ¥è¿”å›falseï¼Œç¨åŠ ä¿®æ”¹åè¿™é‡Œç”¨æ—¶æå‡åˆ°433msï¼Œæ¥è¿‘ä¸€åŠ</p><h3 id="3-æ’åº-å“ˆå¸Œ">3. æ’åº+å“ˆå¸Œ</h3><p>å¾ˆç»å…¸çš„æåˆ°äº†è¿­ä»£æœç´¢ï¼Œé‚£ä¸ç„¶å°±æœ‰å“ˆå¸Œè¡¨ç”¨ç©ºé—´æ¢æ—¶é—´çš„æ“ä½œï¼Œå¹¶ä¸”å“ˆå¸Œè¡¨ä¹Ÿåœ¨Onçš„ç©ºé—´å¤æ‚åº¦ï¼Œ åœ¨æ—¶é—´å¤æ‚åº¦ä¸Šæ¯”flagæ•°ç»„æ›´å¥½ã€‚ç®—æ˜¯1å’Œ2çš„ç»“åˆï¼Œä½†éœ€è¦æ³¨æ„ç‰¹æ®Šæƒ…å†µï¼Œarr[i] = 0çš„æ—¶å€™ arr[i] * 2 ä¹Ÿç­‰äº0</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">canReorderDoubled</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> zero_idx <span class="token operator">=</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span>      <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>map<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>zero_idx <span class="token operator">==</span> arr<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                  zero_idx <span class="token operator">=</span> i<span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                  <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> zero_idx <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token comment">// æ•°å·²è¢«ä½¿ç”¨</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>              <span class="token keyword">continue</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              <span class="token keyword">if</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                  <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                      map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                      count<span class="token operator">++</span><span class="token punctuation">;</span>                  <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                  map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">,</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  count <span class="token operator">++</span><span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>    <span class="token comment">// å¯¹arr[0] = 0 çš„æƒ…å†µçš„ç‰¹æ®Šåˆ¤æ–­ï¼Œå› ä¸ºæ­¤æ—¶arr[i] * 2ä¹Ÿç­‰äº0</span>      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> zero_idx <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>              <span class="token keyword">continue</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              <span class="token keyword">if</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                  <span class="token comment">// 0å­˜åœ¨çš„æ•°ç›®>2æ‰èƒ½é‡‡ç”¨</span>                  <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                      map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                      count <span class="token operator">++</span><span class="token punctuation">;</span>                  <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                  map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">,</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  count <span class="token operator">++</span><span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">if</span><span class="token punctuation">(</span>count <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length <span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span></code></pre></div><p>æ—¶é—´å¤æ‚åº¦ä¸€ä¸‹å°±å¿«äº†å¾ˆå¤šäº†ï¼Œå› ä¸ºæ¶ˆé™¤äº†å†…å±‚çš„å¾ªç¯ï¼Œæ—¶é—´å¤æ‚åº¦ä»…å–å†³äºArrays.sortçš„æ’åºå¤æ‚åº¦</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220401215607935.png" alt="image-20220401215607935"></p><h4 id="ä¼˜åŒ–-v8">ä¼˜åŒ–</h4><p>ç‰¹æ®Šæ•°ï¼šé›¶ï¼Œå¦‚æœé›¶çš„ä¸ªæ•°æ˜¯å¥‡æ•°ï¼Œåˆ™å¯ä»¥ç›´æ¥åˆ¤falseï¼Œå¹¶ä¸”ä¹Ÿæ¶ˆé™¤äº†ä¹‹å‰å¯¹0çš„ç‰¹æ®Šåˆ¤æ–­</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">canReorderDoubled</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> zero_idx <span class="token operator">=</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span>      <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> zero_count <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span>      <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>map<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              zero_count<span class="token operator">++</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>zero_idx <span class="token operator">==</span> arr<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                  zero_idx <span class="token operator">=</span> i<span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                  <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>    <span class="token comment">// 0çš„ä¸ªæ•°æ˜¯å¥‡æ•°ï¼Œç›´æ¥åˆ¤false</span>      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>zero_count <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>    <span class="token comment">// ä»è´Ÿæ•°å¼€å§‹</span>      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> zero_idx <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">-</span> zero_count <span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>              <span class="token keyword">continue</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">,</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              count <span class="token operator">++</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>    <span class="token comment">// ä»æ­£æ•°å¼€å§‹</span>      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> zero_idx <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>              <span class="token keyword">continue</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">,</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              count <span class="token operator">++</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>    <span class="token comment">// æ³¨æ„è¡¥ä¸Šé›¶çš„ä¸ªæ•°</span>      <span class="token keyword">if</span><span class="token punctuation">(</span>count <span class="token operator">&lt;</span> <span class="token punctuation">(</span>arr<span class="token punctuation">.</span>length <span class="token operator">-</span> zero_count<span class="token punctuation">)</span> <span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span></code></pre></div><p>æœ‰æ‰€æå‡ï¼Œä½†æ˜¯æ„Ÿè§‰ä¸èƒ½å†åœ¨è¿™ä¸ªç®—æ³•ä¸Šå¾€ä¸Šæå‡äº†ï¼Œä¼˜åŒ–å·®ä¸å¤šå°±æ˜¯è¿™äº›äº† â€¦</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220401215919080.png" alt="image-20220401215919080"></p><h4 id="é¢˜è§£">é¢˜è§£</h4><p>å®˜æ–¹è§£ç­”æ€è·¯å·®ä¸å¤šä¸è¿‡æœ‰<strong>å¤§ä¼˜åŒ–</strong>ã€‚éƒ½æ˜¯æ’åºæ•°ç»„ä¸­é€‰æ‹©ï¼Œå¹¶ä¸”ä¹Ÿæœ‰æˆ‘ä¹‹å‰çš„ä¼˜åŒ–æ­¥éª¤ï¼Œè¿™é‡Œå› ä¸º<strong>æ’åºæœ‰æŠ€å·§ï¼šæ˜¯é€šè¿‡ç»å¯¹å€¼å¤§å°æ’åºçš„</strong>ã€‚ç»Ÿè®¡Mapä¸­çš„æ•°è¿›å…¥æœ‰åºçš„é›†åˆä¸­ï¼Œç„¶åæ ¹æ®é›†åˆä¸­å»åˆ¤æ–­æ‰€ä»¥å¯ä»¥ä¸ç”¨å†  map.put(x,map.get(x) - 1)</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">canReorderDoubled</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> cnt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> x <span class="token operator">:</span> arr<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            cnt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> cnt<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> vals <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> x <span class="token operator">:</span> cnt<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            vals<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// å¥½æ€è·¯ï¼šæ ¹æ®ç»å¯¹å€¼é¡ºåºæ’åºï¼Œå°±ä¸ç”¨æˆ‘è¿™æ ·åˆ¤æ–­æƒ…å†µäº†</span>        <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>vals<span class="token punctuation">,</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// é‡ç‚¹æ˜¯ä»mapçš„keySetä¸­æ‰¾ï¼Œèƒ½ä¸€æ¬¡å°±æ‰¾å®ŒæŸä¸ªæ•°åœ¨æ•°ç»„ä¸­æ‰€æœ‰åˆ†å¸ƒçš„å¯¹åº”å€¼</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> x <span class="token operator">:</span> vals<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> x<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> cnt<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// æ— æ³•æ‰¾åˆ°è¶³å¤Ÿçš„ 2x ä¸ x é…å¯¹</span>                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            cnt<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> x<span class="token punctuation">,</span> cnt<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> x<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">-</span> cnt<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// ä½œè€…ï¼šLeetCode-Solution</span><span class="token comment">// é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/array-of-doubled-pairs/solution/er-bei-shu-dui-shu-zu-by-leetcode-soluti-2mqj/</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220402093819482.png" alt="image-20220402093819482"></p><h3 id="æ€»ç»“-v9">æ€»ç»“</h3><ul><li>ğŸ™… è¢«åˆå§‹ç›´æ¥ç®—æ³•å›°æ‰°ã€‚è™½ç„¶åšé¢˜åŸåˆ™ä¸Šæ˜¯ä»ç›´æ¥åˆ°è¿›é˜¶åšï¼Œä½†æ˜¯æœ‰æ—¶å€™ç›´æ¥çš„ç®—æ³•æ¯”è¾ƒå†—ä½™ï¼Œç‰¹æ®Šæƒ…å†µè¾ƒå¤šï¼Œå¦‚æœæ²¡å†™æ¸…æ¥šï¼Œå°±å®¹æ˜“æ··ä¹±ï¼Œå¯¼è‡´æ¶æ€§å¾ªç¯ï¼Œä¹Ÿæ²¡å¿ƒæƒ…æƒ³å¥½çš„æ€è·¯çš„ã€‚æ‰€ä»¥ä»¥åç›´æ¥æ€è·¯çš„å®ç°æ¯”è¾ƒç¹çæ—¶ä¸”çŸ¥é“æ•ˆç‡ä¸é«˜æ—¶ï¼Œè¦è€ƒè™‘å»æ€è€ƒå…¶ä»–çš„æ–¹æ³•äº†ï¼Œä¸åº”è¯¥æŠŠé‡å¿ƒæ”¾åœ¨å†—ä½™ä¸Šã€‚</li><li>âš ï¸ æ’åºæ•°ç»„åœ¨è´Ÿæ•°ä¸æ­£æ•°åœ¨å€æ•°å…³ç³»ä¸Šçš„ç›¸åæƒ…å†µï¼è¿˜æœ‰ä¸€äº›ç‰¹æ®Šæƒ…å†µçš„æŸ¥æ‰¾ï¼Œä»¥åè¯»é¢˜æ—¶<strong>å¯¹å…³é”®æ¡ä»¶è¦å…ˆæ‰¾åˆ°ç‰¹æ®Šæƒ…å†µ</strong></li><li>ğŸ‘ ä¼˜åŒ–åšçš„ä¸é”™ï¼Œèƒ½æƒ³åˆ°çš„ä¼˜åŒ–ç‚¹æ¯”è¾ƒå¤šã€‚</li><li>è¿­ä»£ å‘ å“ˆå¸Œ çš„ä¼˜åŒ– å¤šæ¬¡ç»å†äº†ï¼Œè®°ä½</li><li>ä¸å¤ªæ“…é•¿çš„DFSç£•ç£•ç»Šç»Šåšå‡ºæ¥äº†ï¼Œè¿˜è¡Œï¼Œä¸è¿‡è¿˜æ˜¯ç£•ç£•ç»Šç»Šâ€¦</li><li>æ„šäººèŠ‚å¿«ä¹ï¼</li></ul><h2 id="1221-åˆ†å‰²å¹³è¡¡å­—ç¬¦ä¸²-â­">1221. åˆ†å‰²å¹³è¡¡å­—ç¬¦ä¸² â­</h2><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210907150251964.png" alt="image-20210907150251964"></p><h3 id="æ€è€ƒ-v22">æ€è€ƒ</h3><p>æ¯ä¸ªå­—ç¬¦ä¸²éƒ½æ˜¯å¹³è¡¡å­—ç¬¦ä¸²ï¼Œè¿™é‡Œçˆ¶å­å­˜åœ¨ç›¸åŒå…³ç³»ï¼Œæƒ³åˆ°åˆ†æ²»</p><p>åˆ—ä¸¾ä¸å¯èƒ½</p><p>é•¿åº¦ä¸ºå¶æ•°ã€æ’é™¤äºŒåˆ†æ³•ã€åˆ†æ”¯æ„Ÿè§‰æ— æ³•å®Œæˆ</p><h3 id="1-å åŠ å™¨è¿­ä»£">1. å åŠ å™¨è¿­ä»£</h3><p>æƒ³äº†ä¸€ä¸‹ï¼Œå°±æ˜¯çœ‹ä¸¤ä¸ªå­—æ¯åœ¨indexå¤„æ˜¯å¦æ•°ç›®ç›¸åŒ</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">balancedStringSplit</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>     <span class="token keyword">int</span> r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>     <span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>     <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>     <span class="token keyword">while</span><span class="token punctuation">(</span>index <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token char">'L'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>             l<span class="token operator">++</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>         <span class="token keyword">else</span><span class="token punctuation">&#123;</span>             r<span class="token operator">++</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>         <span class="token keyword">if</span><span class="token punctuation">(</span>r <span class="token operator">==</span> l<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>             count<span class="token operator">++</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>         index<span class="token operator">++</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span>     <span class="token keyword">return</span> count<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210907151338289.png" alt="image-20210907151338289"></p><p>çœ‹äº†é¢˜è§£ï¼Œå¯ä»¥åªç”¨ä¸€ä¸ªç¬¦å·ä½çŠ¶æ€é‡è®°å½•L Rçš„æ•°å€¼æ˜¯å¦ç›¸ç­‰â€¦ç¨å¾®å‡å°‘ä¸‹å†…å­˜å ç”¨</p><h2 id="1282-ç”¨æˆ·åˆ†ç»„-â­â­">1282. ç”¨æˆ·åˆ†ç»„ â­â­</h2><div class="code-tag-time">2022/8/12 16:02:00</div><div class="code-tag-label code-tag-label-hash">Hash</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220812150911253.png" alt="image-20220812150911253"></p><h3 id="å®¡é¢˜-v51">å®¡é¢˜</h3><ul><li>å¯èƒ½çš„è§£æ³•ï¼š<ul><li>ç›´æ¥ï¼šæŠŠå±äºæœ‰näººç»„çš„é‚£ä¸ªäººç»Ÿè®¡èµ·æ¥ï¼Œç„¶åéšæ„åˆ†é…</li><li>å¦‚ä½•è½¬åŒ–æˆæ•°å­¦é—®é¢˜ï¼Ÿ</li></ul></li><li>ç»„çš„äººæ•°å¿…é¡»è¯´å¡«å……æ»¡çš„ï¼Œè€Œä¸èƒ½æœ‰ä½™</li><li>éš¾ç‚¹ï¼šåˆ†ç»„</li><li>èƒ½å¦åœ¨Onçš„æ—¶é—´å¤æ‚åº¦å†…åšå‡ºæ¥</li></ul><h3 id="1-Hash-v2">1. Hash</h3><p>æ€è·¯è¿˜æ˜¯æ¯”è¾ƒæ¸…æ™°ï¼Œå°†è¯¥åˆ†åˆ°näººç»„çš„é‚£ä¸ªäººï¼Œåˆ†åˆ°näººç»„çš„ç¬¬xç»„ï¼Œå¦‚æœç¬¬xç»„æ»¡äº†ï¼Œé‚£å°±å†åˆ›å»ºä¸€ä¸ªnäººç»„æŠŠå®ƒæ”¾è¿›å»ï¼Œå¦åˆ™åˆ™æ·»åŠ åˆ°xç»„çš„æœ«å°¾å³å¯ï¼Œä¸ºäº†å¿«é€Ÿè·å–åˆ°näººç»„ç¬¬xç»„æ˜¯å¦äººæ»¡çš„æƒ…å†µï¼Œå»ºç«‹ä¸€ä¸ªnä¸näººç»„æ€»äººæ•°çš„æ˜ å°„å…³ç³»ï¼Œä½†æœ€ç»ˆé€Ÿåº¦ä¸ç†æƒ³â€¦</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span><span class="token punctuation">></span></span> <span class="token function">groupThePeople</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> groupSizes<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span><span class="token punctuation">></span><span class="token punctuation">></span></span> groupListMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> groupNumMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> groupSizes<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Integer</span> groupNum<span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>groupNum <span class="token operator">=</span> groupNumMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>groupSizes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                groupNumMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>groupSizes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span><span class="token punctuation">></span></span> father <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> son <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                son<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>                father<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>son<span class="token punctuation">)</span><span class="token punctuation">;</span>                groupListMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>groupSizes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> father<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span><span class="token punctuation">></span></span> lists <span class="token operator">=</span> groupListMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>groupSizes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>groupNum <span class="token operator">%</span> groupSizes<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> integers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    integers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>                    lists<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>integers<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                    lists<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>groupNum <span class="token operator">/</span> groupSizes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                groupNumMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>groupSizes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">++</span>groupNum<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span><span class="token punctuation">></span></span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        groupListMap<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> v<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>            res<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220812154857856.png" alt="image-20220812154857856"></p><p><strong>ç®€åŒ–</strong></p><p>å¯è¿›è¡Œå¦‚ä¸‹ç®€åŒ–ï¼Œä½†æ—¶é—´ä¼˜åŒ–ä¸é«˜ï¼Œæ€æƒ³æ˜¯ä¸€æ ·çš„</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span><span class="token punctuation">></span></span> <span class="token function">groupThePeople</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> gs<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span><span class="token punctuation">></span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> gs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>gs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>gs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span><span class="token punctuation">></span></span> ans <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">:</span> map<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">,</span> cur <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                cur<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>cur<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    ans<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>cur<span class="token punctuation">)</span><span class="token punctuation">;</span>                    cur <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> ans<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// ä½œè€…ï¼šAC_OIer</span><span class="token comment">// é“¾æ¥ï¼šhttps://leetcode.cn/problems/group-the-people-given-the-group-size-they-belong-to/solution/by-ac_oier-z1bg/</span></code></pre></div><h3 id="2-å†…å¾ªç¯-N">2. å†…å¾ªç¯(N)</h3><p>ç¬‘æ­»ï¼Œæ²¡æƒ³åˆ°å†…å¾ªç¯æ‰æ˜¯æœ€å¿«çš„ã€‚ä½†ç¡®å®ï¼Œè¿™é‡Œçš„ç²¾é«“åœ¨äºå°†å·²å½’çº³çš„äººâ€œç›´æ¥è·³è¿‡â€ï¼ˆé€šè¿‡ç½®0+åˆ¤æ–­æ¥å®ç°ï¼‰ï¼Œè¿™æ ·å°±èƒ½ç›´æ¥ä¸ä½¿ç”¨HashMapæ¥å®ç°ã€‚çŒœæµ‹å¯èƒ½è¿˜æ˜¯HashMapçš„ä¸€äº›æ–¹æ³•ï¼Œä¾‹å¦‚entrySetçš„éå†ä¹‹ç±»çš„ä¼šå¯¼è‡´é¢å¤–è€—æ—¶</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span><span class="token punctuation">></span></span> <span class="token function">groupThePeople</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> groupSizes<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span><span class="token punctuation">></span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> groupSizes<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>groupSizes<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            result<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>            list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> size <span class="token operator">=</span> groupSizes<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> groupSizes<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> size <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>groupSizes<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> groupSizes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>                    groupSizes<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                    size<span class="token operator">--</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> result<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220812155855997.png" alt="image-20220812155855997"></p><h3 id="åæ€-v16">åæ€</h3><p>è¿™é‡Œå†…å¾ªç¯éå†(å¹¶é€šè¿‡è®¾ç½®ç‰¹æ®Šä½è·³è¿‡å·²ç»å¤„ç†äº†çš„æ•°æ®)æ˜¯å¦è¿‘ä¼¼å®ç°äº†Onçš„æ—¶é—´å¤æ‚åº¦å‘¢ï¼Ÿæˆ‘è§‰å¾—æ˜¯çš„ğŸ¤”</p><h2 id="1332-åˆ é™¤å›æ–‡åºåˆ—-â­">1332. åˆ é™¤å›æ–‡åºåˆ— â­</h2><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220122215309827.png" alt="image-20220122215309827"></p><h3 id="å®¡é¢˜-v52">å®¡é¢˜</h3><ul><li>å›æ–‡å­åºåˆ— + æœ€å°‘åˆ é™¤æ¬¡æ•°</li><li>å¦‚ä½•æ‰¾åˆ°å›æ–‡å­åºåˆ—</li></ul><h1>1455. æ£€æŸ¥å•è¯æ˜¯å¦ä½å¥ä¸­å…¶ä»–å•è¯çš„å‰ç¼€ â­</h1><div class="code-tag-time">2022/8/21 23:48:00</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220821183032495.png" alt="image-20220821183032495"></p><h3 id="æ€è€ƒ-v23">æ€è€ƒ</h3><ul><li>è¾“å…¥æ˜¯ä»»ä½•å•è¯çš„å‰å¯¼è¿ç»­å­å­—ç¬¦ä¸²</li><li>ä¸€æ¬¡éå†</li><li><strong>æ ¸å¿ƒï¼šæŠ“ä½æ¯ä¸€ä¸ªå•è¯ï¼Œå¹¶ä¸”åªç”¨æ¯”è¾ƒæ¯ä¸€ä¸ªå•è¯ä¸å…³é”®è¯ç›¸ç­‰é•¿åº¦çš„å‰ç¼€æ˜¯å¦ç›¸ç­‰å³å¯(è¯¥å•è¯é•¿åº¦å¿…é¡»å¤§äºç­‰äºå…³é”®è¯é•¿åº¦)</strong></li></ul><h3 id="1-ä¸€æ¬¡éå†">1. ä¸€æ¬¡éå†</h3><p>å…ˆåˆ†å‰²å¥å­ä¸ºå•è¯å­—ç¬¦ä¸²æ•°ç»„ï¼Œç„¶åç­›é€‰å‡ºé•¿åº¦å¤§äºç­‰äºå…³é”®è¯çš„å•è¯ï¼Œå†å»æ¯”è¾ƒæ˜¯å¦åŒ…å«è¯¥å•è¯ï¼Œä½†è¦æ³¨æ„è¿™é‡Œå¿…é¡»æ˜¯ä»ä¸€å¼€å§‹å°±è¦åŒ…å«ã€‚ç”±äºéœ€è¦mä¸ªå•è¯çš„å­—ç¬¦ä¸²æ•°ç»„ï¼Œæ‰€ä»¥ç©ºé—´å¤æ‚åº¦è¾ƒé«˜(ä½†ç”±äºæµ‹è¯•ç”¨ä¾‹é—®é¢˜ï¼Œå†…å­˜æ¶ˆè€—è¿˜æ˜¯æœ‰æ¯”è¾ƒä½çš„æƒ…å†µ)</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">isPrefixOfWord</span><span class="token punctuation">(</span><span class="token class-name">String</span> sentence<span class="token punctuation">,</span> <span class="token class-name">String</span> searchWord<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> words <span class="token operator">=</span> sentence<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> words<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">>=</span> searchWord<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">if</span><span class="token punctuation">(</span>words<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> searchWord<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>searchWord<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   <span class="token keyword">return</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220821183833379.png" alt="image-20220821183833379"></p><h4 id="ä¼˜åŒ–-çŠ¶æ€æœº">ä¼˜åŒ–-çŠ¶æ€æœº</h4><p>ç”±äºä¹‹å‰æœ‰Omçš„ç©ºé—´å¤æ‚åº¦ï¼Œæ‰€ä»¥è¦è§£å†³ ä¸å­˜å‚¨é•¿åº¦ä¸ºmçš„å­—ç¬¦ä¸²æ•°ç»„çš„é—®é¢˜ï¼ŒåŒæ—¶ä¹Ÿè¦åœ¨ä¸€æ¬¡éå†ä¹‹å†…è§£å†³ã€‚è¿™é‡Œä¾¿åˆ†æƒ…å†µæ¥è¿›è¡Œï¼Œæœ‰ç‚¹<strong>çŠ¶æ€æœºçš„æ€æƒ³</strong>ã€‚ä¼˜ç‚¹æ˜¯åœ¨OÂ©çš„ç©ºé—´å¤æ‚åº¦å’ŒO(n)çš„æ—¶é—´å¤æ‚åº¦å†…è§£å†³ã€‚ä½†å¤§é‡çš„if elseç»“æ„è¿˜æ˜¯è®©ä»£ç æ˜¾å¾—æœ‰ç‚¹å†—é•¿</p><ul><li>é‡åˆ°ç©ºæ ¼ï¼šè¯´æ˜è¿™ä¸ªå•è¯å·²ç»ç»“æŸï¼Œåº”è¯¥é‡ç½®ä¸€äº›å˜é‡</li><li>é‡åˆ°ç©ºæ ¼åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼šæŸ¥çœ‹å­—ç¬¦ä¸å…³é”®å­—æ˜¯å¦ç›¸ç­‰<ul><li>ç›¸ç­‰ï¼šæ–°çŠ¶æ€ï¼Œå¼€å§‹æ¯”è¾ƒä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚å¦‚æœè¿™ä¸ªè¿‡ç¨‹ä¸­å…³é”®å­—æ¯”è¾ƒå®Œäº†ï¼Œè¯´æ˜åŒ¹é…æˆåŠŸï¼Œç›´æ¥è¿”å›</li><li>ä¸ç›¸ç­‰ï¼šæ–°çŠ¶æ€ï¼Œè¯¥å•è¯å†…æ‰€æœ‰å­—ç¬¦éƒ½ä¸ç”¨æ¯”è¾ƒäº†</li></ul></li></ul><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">isPrefixOfWord</span><span class="token punctuation">(</span><span class="token class-name">String</span> sentence<span class="token punctuation">,</span> <span class="token class-name">String</span> searchWord<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">// flag >= 0 searchword index in sentence</span>  <span class="token comment">// flag == -1 not match</span>  <span class="token comment">// flag == -2 this is a new word</span>       <span class="token keyword">int</span> flag <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span>       <span class="token keyword">int</span> wordIdx <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>       <span class="token keyword">int</span> sequence <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> sentence<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>sentence<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token char">' '</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               wordIdx<span class="token operator">++</span><span class="token punctuation">;</span>               flag <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span>               sequence <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// flag == -2 this is a new word</span>               <span class="token keyword">if</span><span class="token punctuation">(</span>sentence<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> searchWord<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>sequence<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   sequence<span class="token operator">++</span><span class="token punctuation">;</span>                   flag <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                   flag <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">// flag == -3 in matching</span>               <span class="token keyword">if</span><span class="token punctuation">(</span>sentence<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">!=</span> searchWord<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>sequence<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   flag <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">;</span>                   sequence <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                   sequence<span class="token operator">++</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// flag == -4 word matching fail(just for current word in sentence)</span>               <span class="token keyword">continue</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>sequence <span class="token operator">>=</span> searchWord<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   <span class="token keyword">return</span> wordIdx<span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220821224515819.png" alt="image-20220821224515819"></p><h3 id="æ€»ç»“-v10">æ€»ç»“</h3><p>çŠ¶æ€æœºçš„æ€æƒ³ï¼š</p><ul><li>èƒ½å¤Ÿåœ¨ç®€åŒ–ç©ºé—´å¤æ‚åº¦ä¸Šæœ‰</li><li>èƒ½å¤Ÿå¸®åŠ©æ¢³ç†æ€è·¯ï¼Œä½¿é€»è¾‘ç»“æ„æ¸…æ™°</li></ul><h2 id="1672-æœ€å¯Œæœ‰å®¢æˆ·çš„èµ„äº§æ€»é‡-â­">1672. æœ€å¯Œæœ‰å®¢æˆ·çš„èµ„äº§æ€»é‡ â­</h2><blockquote><p>Time : 2022 / 4 /14<br>TAG : Foreach</p></blockquote><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220414193759266.png" alt="image-20220414193759266"></p><h3 id="å®¡é¢˜-v53">å®¡é¢˜</h3><ul><li>å°±æ˜¯è¿”å›ä¸€å †æ•°ç»„ä¸­æœ€å¤§æ•°ç»„å€¼çš„æ•°ï¼Œè‚¯å®šæ˜¯O(i)*O(j)çš„éå†æ–¹å¼</li></ul><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">maximumWealth</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> accounts<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> max <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> accounts<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> temp <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span>accounts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                temp <span class="token operator">+=</span> accounts<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            max <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span>max<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> max<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220414194221705.png" alt="image-20220414194221705"></p><p>ã€‚ã€‚ã€‚ã€‚å½“æˆ‘æ²¡æœ‰åšè¿‡è¿™é“é¢˜</p><h2 id="1716-è®¡ç®—é“¶è¡Œçš„é’±-â­">1716. è®¡ç®—é“¶è¡Œçš„é’± â­</h2><div class="code-tag-time">2022/4/2 09:42:00</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><div class="code-tag-label code-tag-label-math">Arithmetic Progression</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220115111213342.png" alt="image-20220115111213342"></p><h3 id="å®¡é¢˜-v54">å®¡é¢˜</h3><ul><li>æ•°å­¦å…¬å¼</li><li>å˜é‡ç´¯è®¡</li></ul><h3 id="1-æš´åŠ›å¾ªç¯">1. æš´åŠ›å¾ªç¯</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">totalMoney</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> div<span class="token punctuation">;</span>      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          div <span class="token operator">=</span> <span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">7</span><span class="token punctuation">;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">7</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              sum <span class="token operator">+=</span> div <span class="token operator">+</span> <span class="token number">7</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>              sum <span class="token operator">+=</span> div <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">return</span> sum<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220115112311339.png" alt="image-20220115112311339"></p><p>é™¤æ³•å’Œæ±‚ä½™æ“ä½œè€—æ—¶è¾ƒå¤š</p><h3 id="2-å…¬å¼â€“ç­‰å·®æ•°åˆ—">2. å…¬å¼â€“ç­‰å·®æ•°åˆ—</h3><p>é™¤äº†ç¬¬ä¸€å‘¨å¤–ï¼Œå‰©ä¸‹çš„æ¯ä¸ªæ•´å‘¨æ¯”ç¬¬ä¸€ä¸ªå‘¨å¤šå‡ºæ¥çš„é’±éƒ½æ˜¯æˆç­‰å·®æ•°åˆ—çš„ã€‚çœå»LogNçš„é€æ­¥æ“ä½œï¼Œå…ˆæ±‚å‡ºå¤§éƒ¨åˆ†ï¼Œå†æ±‚ä½™ä¸‹çš„</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> left <span class="token operator">=</span> n <span class="token operator">/</span> <span class="token number">7</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> yu <span class="token operator">=</span> n <span class="token operator">%</span> <span class="token number">7</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>left <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        sum <span class="token operator">+=</span> <span class="token number">28</span> <span class="token operator">*</span> <span class="token punctuation">(</span>left <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span>  <span class="token punctuation">(</span><span class="token punctuation">(</span>left <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>left <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token number">7</span><span class="token punctuation">;</span>        <span class="token comment">// æ³¨æ„è¿™é‡Œæ±‚ç­‰å·®æ•°åˆ—å’Œ</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> yu<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        sum <span class="token operator">+=</span> left <span class="token operator">+</span> i<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> sum<span class="token punctuation">;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220115120252292.png" alt="image-20220115120252292"></p><p><em>åŠ äº†ä¸ªprintlnç»“æœè€—æ—¶é™åˆ°24%ï¼ŒèšŒåŸ ä½äº†â€¦</em></p><h2 id="1894-æ‰¾åˆ°éœ€è¦è¡¥å……ç²‰ç¬”çš„å­¦ç”Ÿç¼–å·-â­â­">1894.æ‰¾åˆ°éœ€è¦è¡¥å……ç²‰ç¬”çš„å­¦ç”Ÿç¼–å· â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><div class="code-tag-label code-tag-label-binary">Binary</div><div class="code-tag-label code-tag-label-presum">Prefix sum</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210910154818645.png" alt="image-20210910154818645"></p><h3 id="å®¡é¢˜-v55">å®¡é¢˜</h3><p>è¾“å‡ºçš„æœ€åæ˜¯éœ€è¦è¡¥å……ç²‰ç¬”çš„å­¦ç”Ÿç¼–å·</p><h3 id="1-éå†æ¨¡æ‹Ÿ">1. éå†æ¨¡æ‹Ÿ</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">chalkReplacer</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> chalk<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> singleTotal <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> isRepeat <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>k<span class="token operator">-</span>chalk<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>isRepeat <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            singleTotal <span class="token operator">+=</span> chalk<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>isRepeat <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> index <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>k <span class="token operator">-</span> singleTotal <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                k<span class="token operator">-=</span>singleTotal<span class="token punctuation">;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        k<span class="token operator">-=</span>chalk<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>        index<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>index <span class="token operator">>=</span> chalk<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            isRepeat <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> index<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210910155744122.png" alt="image-20210910155744122"><br>è¿™é‡ŒåŸæ¥ç›´æ¥éå†ï¼Œä½†ä¼šè¶…æ—¶ï¼Œåé¢ç¨å¾®æ”¹è¿›äº†ï¼Œä½¿ç”¨ä¸€ç»„çš„æœ€å¤§å€¼ç¨ä½œè®°å½•ï¼Œä½†æœ€ç»ˆç»“æœè¿˜æ˜¯å¾ˆæ…¢ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯O(n+m)</p><p><strong>ä¸¥æ ¼æ¥è¯´ï¼Œéå†ä¸€æ¬¡æ•°ç»„å°±åº”è¯¥çŸ¥é“æ˜¯è°ç¼ºç²‰ç¬”äº†</strong></p><h3 id="2-ä¼˜åŒ–">2. ä¼˜åŒ–</h3><p>â€¦é€šè¿‡å…ˆè®¡ç®—å‡ºTotalï¼Œå†æ¨¡ä¸€ç»„æ€»æ•°åè¿›è¡ŒæŸ¥æ‰¾å°±çŸ¥é“äº†ã€‚ã€‚ã€‚ã€‚è¿™æ ·çœ‹èµ·æ¥åœ¨ä¸€ä¸ªå¾ªç¯é‡Œä¸€æ ·ï¼Œä½†æ•ˆç‡å´å¿«äº†å¾ˆå¤šå¾ˆå¤šï¼Œä½†ä¸¤æ¬¡å¾ªç¯ï¼Œæ¯æ¬¡å¾ªç¯æœ€å¤šå¾ªç¯næ¬¡ã€‚æ—¶é—´å¤æ‚åº¦æ˜¯O(n)ï¼Œ<strong>è¿™é‡Œè¦æ³¨æ„ä¸€ä¸‹ï¼šä¸€æ ·çš„æ€è·¯ä¸ä¸€æ ·çš„å¤„ç†æ–¹å¼ï¼Œå¯èƒ½ä¼šåœ¨æ•ˆç‡ä¸Šé€ æˆå¾ˆå¤§å·®è·</strong></p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">chalkReplacer</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> chalk<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">long</span> singleTotal <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>chalk<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        singleTotal <span class="token operator">+=</span> chalk<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    k  <span class="token operator">%=</span> singleTotal<span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>k<span class="token operator">-</span>chalk<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        k<span class="token operator">-=</span>chalk<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>        index<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>index <span class="token operator">>=</span> chalk<span class="token punctuation">.</span>length<span class="token punctuation">)</span>            index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> index<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210910161322436.png" alt="image-20210910161322436"></p><h3 id="3-å‰ç¼€å’Œ-äºŒåˆ†æŸ¥æ‰¾">3. å‰ç¼€å’Œ+äºŒåˆ†æŸ¥æ‰¾</h3><p>ï¼ˆè½¬ï¼‰ç¬¬ä¸€æ¬¡æ‰¾æœ€å¤§å€¼ï¼Œè¿˜æ˜¯On</p><p>ç¬¬äºŒæ¬¡å»éå†æ—¶ï¼Œè¿™é‡Œåœ¨å‰ç¼€å’Œä¸­æ‰¾æ˜¯å“ªä¸€ä¸ªä½¿å¾—singleTotal+=chalk[k]åå¤§äºäº†åŸæ¥çš„kå€¼ï¼Œé€šè¿‡äºŒåˆ†æ³•æ‰¾è¿™é‡Œï¼Œå¤æ‚åº¦ä¸ºO(logn),ä½†æ€»çš„æ—¶é—´å¤æ‚åº¦è¿˜æ˜¯Onã€‚</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">chalkReplacer</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> chalk<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">int</span> n <span class="token operator">=</span> chalk<span class="token punctuation">.</span>length<span class="token punctuation">;</span>       <span class="token keyword">if</span> <span class="token punctuation">(</span>chalk<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">></span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           chalk<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> chalk<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span>chalk<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">return</span> i<span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       k <span class="token operator">%=</span> chalk<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token keyword">return</span> <span class="token function">binarySearch</span><span class="token punctuation">(</span>chalk<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">binarySearch</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr<span class="token punctuation">,</span> <span class="token keyword">int</span> target<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">int</span> low <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> high <span class="token operator">=</span> arr<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>       <span class="token keyword">while</span> <span class="token punctuation">(</span>low <span class="token operator">&lt;</span> high<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">int</span> mid <span class="token operator">=</span> <span class="token punctuation">(</span>high <span class="token operator">-</span> low<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> low<span class="token punctuation">;</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> target<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               low <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>               high <span class="token operator">=</span> mid<span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> low<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210910162148116.png" alt="image-20210910162148116"></p><h2 id="2024-è€ƒè¯•çš„æœ€å¤§å›°æ‰°åº¦-â­â­">2024. è€ƒè¯•çš„æœ€å¤§å›°æ‰°åº¦ â­â­</h2><div class="code-tag-time">2022/3/30 11:02:00</div><div class="code-tag-label code-tag-label-sw">Slide Window</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220329193440464.png" alt="image-20220329193440464"></p><h3 id="å®¡é¢˜-v56">å®¡é¢˜</h3><ul><li>ç›®æ ‡ï¼šç»™å®šæ“ä½œæ¬¡æ•°å†…æŠŠå­—ç¬¦å˜ä¸ºæœ€å¤§è¿ç»­ç›¸åŒçš„ä¸ªæ•°</li><li>æƒ³æ³•ï¼šè¦æœ‰æœ€å¤§è¿ç»­ç›¸åŒï¼Œåˆ™kæ¬¡æ“ä½œæ”¹å˜çš„å­—ç¬¦åº”è¯¥éƒ½æ˜¯åŒä¸€ä¸ª</li><li>å¯èƒ½çš„åšæ³•ï¼š</li><li>æ€è·¯<ul><li>ç›´æ¥ï¼šæ‰¾æœ€å¤§ç›¸åŒçš„å­åºåˆ—ï¼Œå’Œå­åºåˆ—ä¸å¦ä¸€ç›¸åŒå­—ç¬¦åºåˆ—é—´éš”çš„ä¸ªæ•°</li><li>è¿›é˜¶ï¼š<ul><li>ä½è¿ç®—</li><li>å­—ç¬¦ä¸²-&gt;æ•°ç»„-&gt;ä¸€æ¬¡éå†æ˜¯å¦èƒ½å¤Ÿè§£å†³</li></ul></li></ul></li></ul><h3 id="1-æ»‘åŠ¨çª—å£">1. æ»‘åŠ¨çª—å£</h3><p>æ²¡æƒ³åˆ°æ»‘åŠ¨çª—å£çš„æ€è·¯ï¼Œæ˜¯çœ‹åˆ°é¢˜è§£æç¤ºæ‰æƒ³åˆ°çš„ï¼Œåšçš„ä¹Ÿå¾ˆéº»çƒ¦</p><p>ä¸å…¶æˆ‘å˜ä¸å¦‚å®ƒå˜ï¼Œæˆ‘ç»´æŠ¤ä¸€ä¸ªæœ€å¤§èƒ½æ“ä½œå­—ç¬¦ä¸ªæ•°çš„åŒºé—´ï¼Œè¶…è¿‡äº†æˆ‘å°±ç§»åŠ¨åˆ°<strong>ç¬¬ä¸€ä¸ªæ“ä½œåŒºé—´çš„ä¸‹ä¸€ä¸ªå­—ç¬¦</strong>ï¼Œç›¸å½“äºæ”¹å˜åŒºé—´èµ·ç‚¹</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">maxConsecutiveAnswers</span><span class="token punctuation">(</span><span class="token class-name">String</span> answerKey<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token function">findMaxSequence</span><span class="token punctuation">(</span>answerKey<span class="token punctuation">,</span>k<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">findMaxSequence</span><span class="token punctuation">(</span>answerKey<span class="token punctuation">,</span>k<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>     <span class="token keyword">int</span> <span class="token function">findMaxSequence</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">,</span> <span class="token keyword">int</span> mode<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">char</span> a <span class="token operator">=</span> <span class="token punctuation">(</span>mode<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token char">'F'</span><span class="token operator">:</span><span class="token char">'T'</span><span class="token punctuation">;</span>        <span class="token keyword">char</span> b <span class="token operator">=</span> <span class="token punctuation">(</span>mode<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token char">'T'</span><span class="token operator">:</span><span class="token char">'F'</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> gap  <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> max <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> a<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>gap <span class="token operator">&lt;</span> k<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    gap<span class="token operator">++</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        count <span class="token operator">=</span> i <span class="token operator">-</span> start <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>                        max <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span>max<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                    count <span class="token operator">=</span> i <span class="token operator">-</span> start <span class="token punctuation">;</span>                    max <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span>max<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment">// å·¦ç§»å¼€å§‹å­—ç¬¦åˆ°ç¬¬ä¸€ä¸ªæ“ä½œæ”¹å˜å­—ç¬¦çš„ä¸‹ä¸€ä¸ª</span>                    <span class="token keyword">while</span><span class="token punctuation">(</span>start <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>start<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">==</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        count <span class="token operator">=</span> i <span class="token operator">-</span> start <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>                        max <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span>max<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    count <span class="token operator">=</span> i <span class="token operator">-</span> start <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>                    max <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span>max<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> max<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre></div><p>ç¼ºç‚¹ï¼šè¿‡åˆ†è€ƒè™‘äº†i = s.length() - 1çš„æƒ…å†µ</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220329222041407.png" alt="image-20220329222041407"></p><h4 id="åå‘ä¼˜åŒ–-v2">åå‘ä¼˜åŒ–</h4><p><strong>é˜Ÿåˆ—ç¼“å­˜</strong></p><p>åˆè¡·ï¼šæ“ä½œæ¬¡æ•°å¤§äºé™å®šå€¼kæ—¶ï¼Œè¦ä»ç¬¬ä¸€ä¸ªåŒºé—´éå†å»æ‰¾ç¬¬ä¸€ä¸ªæ“ä½œå­—ç¬¦ï¼Œè¿™æ ·æœ‰æ—¶é—´æµªè´¹ã€‚å¯ä»¥ç”¨ä¸€ä¸ªé˜Ÿåˆ—å°†æ“ä½œçš„å­—ç¬¦çš„ç´¢å¼•éƒ½ç¼“å­˜èµ·æ¥ï¼Œç„¶åç›´æ¥å»pollå°±è¡Œäº†ã€‚</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">maxConsecutiveAnswers</span><span class="token punctuation">(</span><span class="token class-name">String</span> answerKey<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">return</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token function">findMaxSequence</span><span class="token punctuation">(</span>answerKey<span class="token punctuation">,</span>k<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">findMaxSequence</span><span class="token punctuation">(</span>answerKey<span class="token punctuation">,</span>k<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">int</span> <span class="token function">findMaxSequence</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">,</span> <span class="token keyword">int</span> mode<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">int</span> max <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token comment">// b represent substitute</span>      <span class="token keyword">char</span> b <span class="token operator">=</span> <span class="token punctuation">(</span>mode <span class="token operator">==</span> <span class="token number">0</span><span class="token operator">?</span><span class="token char">'F'</span><span class="token operator">:</span><span class="token char">'T'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token class-name">Queue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> list_s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      list_s<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> b<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>              <span class="token keyword">if</span><span class="token punctuation">(</span>list_s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> k<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                  list_s<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>i <span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                  list_s<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>i <span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token keyword">int</span> a <span class="token operator">=</span> list_s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span>list_s<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  max <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>i <span class="token operator">-</span> a <span class="token punctuation">,</span>max<span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>                      <span class="token keyword">break</span><span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              <span class="token keyword">int</span> a <span class="token operator">=</span> list_s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span>list_s<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              max <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>i <span class="token operator">-</span> a <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>max<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">return</span> max<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span></code></pre></div><p>æ²¡æ‡‚ä¸ºå•¥æ—¶é—´è¿˜æ…¢ä¸€ç‚¹ï¼Œå¯èƒ½æ˜¯é˜Ÿåˆ—çš„åˆ›å»ºåŸå› ï¼Ÿ</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220329230817327.png" alt="image-20220329230817327"></p><h4 id="ç®€æ´ï¼ˆè½¬ï¼‰">ç®€æ´ï¼ˆè½¬ï¼‰</h4><p>LeetCodeé¢˜è§£ï¼Œä¸æˆ‘ç¬¬ä¸€ä¸ªé¢˜è§£ç›¸ä¼¼</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">maxConsecutiveChar</span><span class="token punctuation">(</span><span class="token class-name">String</span> answerKey<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">,</span> <span class="token keyword">char</span> ch<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">int</span> n <span class="token operator">=</span> answerKey<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">int</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">// æ³¨æ„è¿™ç§èµ‹å€¼ï¼Œä¸é”™</span>       <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> right <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> right <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> right<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token comment">// sumè®°å½•æ“ä½œæ•°</span>           sum <span class="token operator">+=</span> answerKey<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>right<span class="token punctuation">)</span> <span class="token operator">!=</span> ch <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>           <span class="token comment">// ç§»åŠ¨èµ·ç‚¹åˆ°ç¬¬ä¸€æ¬¡æ“ä½œçš„ä¸‹ä¸€ä¸ªä½ç½®</span>           <span class="token keyword">while</span> <span class="token punctuation">(</span>sum <span class="token operator">></span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               sum <span class="token operator">-=</span> answerKey<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>left<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">!=</span> ch <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           <span class="token comment">// æ¶ˆé™¤ä»£ç å†—ä½™</span>           <span class="token comment">// æ¯æ¬¡å¾ªç¯éƒ½æ¯”è¾ƒä¸€æ¬¡ï¼Œå°±ä¸ç”¨åši=s.length() - 1çš„åˆ¤æ–­äº†</span>           ans <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>ans<span class="token punctuation">,</span> right <span class="token operator">-</span> left <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> ans<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre></div><p>Onæ—¶é—´å¤æ‚åº¦  O1ç©ºé—´å¤æ‚åº¦</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220330101720672.png" alt="image-20220330101720672"></p><h4 id="ä¸€å¹¶è®¡ç®—ï¼ˆè½¬ï¼‰">ä¸€å¹¶è®¡ç®—ï¼ˆè½¬ï¼‰</h4><p>è¿™ä¸ªæ€è·¯ å¯ä»¥ï¼Œç²¾é«“åœ¨äºï¼šæ²¡æœ‰å…·ä½“è¦æ±‚åˆ°åº•æ˜¯T è¿˜æ˜¯ Fæ”¹å˜ã€‚æˆ‘åŒæ—¶è®¡ç®—tæ“ä½œå’Œfæ“ä½œçš„å€¼ï¼Œåœ¨åŒä¸€å§‹æœ«ç‚¹æ¯”è¾ƒ</p><ul><li>å¦‚æœä¸æº¢å‡ºï¼Œæ­£å¸¸å¢é•¿</li><li>å¦‚æœåªæœ‰å…¶ä¸­ä¸€ç§æ“ä½œæ•°æº¢å‡ºï¼Œé‚£è¡¨æ˜å¦ä¸€ç§æ“ä½œæ•°æ²¡æº¢å‡ºï¼Œè¡¨æ˜å¦ä¸€ç§æ“ä½œæ•°çš„æ€»é•¿&gt;è¯¥ç§æ€»é•¿ï¼Œå¯ä»¥ç»§ç»­è¿ç®—ã€‚</li><li>å¦‚æœä¸¤ç§éƒ½æº¢å‡ºï¼Œåˆ™è¡¨æ˜éƒ½ä¸è¡Œäº†ï¼Œç®—æœ€å¤§å€¼ï¼Œå¹¶å°†lç§»åŠ¨åˆ°ä¸¤ç§éƒ½ä¸æº¢å‡ºçš„æƒ…å†µ<ul><li><s>â“ ä½†è¿™æ ·å°±å‡ºç°ä¸€ä¸ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆ L ç§»åŠ¨çš„æ¡ä»¶æ˜¯ä¸¤ç§éƒ½ä¸æº¢å‡ºï¼Œè€Œä¸æ˜¯æŸä¸€ç§ä¸æº¢å‡ºï¼Ÿæ¯”å¦‚â€¦FFFFFTTFTè¿™æ ·å°±è¦ç§»åŠ¨åˆ°Tçš„ä½ç½®å†é‡æ–°å¼€å§‹ï¼Œä½†èƒ½å¦ä¿è¯èµ·ç‚¹åœ¨å‰é¢çš„å‡ ä¸ªFä¸­å¼€å§‹å°±ä¸€å®šæ²¡æœ‰æœ€å¤§å€¼ï¼Ÿ</s></li><li>æ²¡çœ‹é¢˜ï¼Œæ¡ä»¶æ˜¯å½“ä¸¤ä¸ªå‡å¤§äºkæ‰å‰è¿›left,ä½†åªè¦æœ‰ä¸€ä¸ªä¸æ»¡è¶³å°±å¯ä»¥ç®—äº†ï¼Œæ˜¯å¯¹çš„ã€‚åœ¨Tæ»¡è¶³æƒ…å†µæ—¶ï¼ŒFå¯èƒ½å¢åŠ åˆ°è¿œå¤§äºK,ä½†æ²¡å…³ç³»å› ä¸ºç»´æŠ¤çš„æ˜¯åŒºé—´çš„ç¼˜æ•…ï¼Œä¹‹åéƒ½ä¸æ»¡è¶³æ—¶ï¼Œé‡åˆ°çš„Féƒ½ä¼šè¿›è¡Œf-- å›é€€</li></ul></li></ul><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">maxConsecutiveAnswers</span><span class="token punctuation">(</span><span class="token class-name">String</span> answerKey<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// l:èµ·å§‹ä½ç½® r: ç»“æŸä½ç½®</span><span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> len <span class="token operator">=</span> answerKey<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cs <span class="token operator">=</span> answerKey<span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// t:æ”¹å˜Tçš„æ“ä½œæ¬¡æ•° f:æ”¹å˜Fçš„æ“ä½œæ¬¡æ•°</span><span class="token keyword">int</span> t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> f <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>r <span class="token operator">&lt;</span> len<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">char</span> <span class="token class-name">R</span> <span class="token operator">=</span> cs<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">R</span> <span class="token operator">==</span> <span class="token char">'T'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>t<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>f<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>            <span class="token comment">// é‡ç‚¹</span><span class="token keyword">if</span> <span class="token punctuation">(</span>t <span class="token operator">></span> k <span class="token operator">&amp;&amp;</span> f <span class="token operator">></span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>ans <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>ans<span class="token punctuation">,</span> r <span class="token operator">-</span> l<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>t <span class="token operator">></span> k <span class="token operator">&amp;&amp;</span> f <span class="token operator">></span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">char</span> <span class="token class-name">L</span> <span class="token operator">=</span> cs<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">L</span> <span class="token operator">==</span> <span class="token char">'T'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>t<span class="token operator">--</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>f<span class="token operator">--</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>l<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>r<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>        <span class="token comment">// è®¡ç®—ä¸‹æœ€åçš„å€¼</span>ans <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>ans<span class="token punctuation">,</span> len <span class="token operator">-</span> l<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> ans<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// ä½œè€…ï¼šwa-pian-d</span><span class="token comment">// é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/maximize-the-confusion-of-an-exam/solution/2024-kao-shi-de-zui-da-kun-rao-du-java-b-86wg/</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220330102422950.png" alt="image-20220330102422950"></p><h3 id="æ€»ç»“-v11">æ€»ç»“</h3><ul><li><p>æ»‘åŠ¨çª—å£ä¸ç†Ÿæ‚‰ï¼Œåšçš„æ—¶å€™æ²¡æœ‰æƒ³åˆ°æ»‘åŠ¨çª—å£ã€‚å¥½ä¹…æ²¡æœ‰åšåˆ°æ»‘åŠ¨çª—å£çš„é¢˜äº†ã€‚æ»‘åŠ¨çª—å£é¢˜å‹çš„ç‰¹ç‚¹ï¼š<strong>æœ‰é™å®šå€¼ï¼Œè®¡ç®—èŒƒå›´å†…çš„å€¼ï¼ˆè¿ç»­çš„ï¼‰ï¼Œæœ€å¥½æ˜¯åœ¨æ•°ç»„ä¸­è¿›è¡Œçš„</strong>ã€‚å·©å›ºä¸€ä¸‹</p></li><li><p>å¯¹ç‰¹æ®Šæƒ…å†µçš„åˆ¤æ–­å¤ªå¤šï¼Œé€ æˆæ€ç»´æ··ä¹±ä»£ç å†—ä½™</p></li><li><p><strong>å…ˆæƒ³æ¸…æ¥šå†å†™ä»£ç </strong>â€¦â€¦â€¦â€¦</p></li></ul><h2 id="2034-è‚¡ç¥¨ä»·æ ¼æ³¢åŠ¨-â­â­">2034. è‚¡ç¥¨ä»·æ ¼æ³¢åŠ¨ â­â­</h2><div class="code-tag-time">2021/4/6 09:46:00</div><div class="code-tag-label code-tag-label-hash">Hash</div><div class="code-tag-label code-tag-label-sort">Sort</div><div class="code-tag-label code-tag-label-queue">Priority Queue</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220123210854186.png" alt="image-20220123210854186"></p><h3 id="å®¡é¢˜-v57">å®¡é¢˜</h3><ul><li>é€‰å–æ•°æ®ç»“æ„ååˆ†é‡è¦ï¼Œmaxå’Œminè‚¯å®šæ˜¯å†…éƒ¨å˜é‡ç»´æŠ¤ã€‚<s>é¦–å…ˆè€ƒè™‘æ•°ç»„</s></li><li>updateå’Œæœ€å¤§æœ€å°çš„é€‰å–èŒƒå›´è‚¯å®šæ˜¯ç›¸å…³çš„ï¼Œupdateæœ€å¤§æœ€å°å€¼æ—¶ä»æ•°ç»„ã€é“¾è¡¨è§’åº¦éƒ½ä¼šå¼•èµ·Onçš„æ—¶é—´å¤æ‚åº¦</li><li>updateå¯ä»¥æ˜¯æœªæ¥çš„æ—¶é—´æˆ³ï¼Œæ‰€ä»¥æ•°ç»„å¯èƒ½ä¸å¤ªç°å®</li><li>å¯èƒ½çš„åšæ³•ï¼šå…ˆè€ƒè™‘é“¾è¡¨å§</li></ul><h3 id="1-é“¾è¡¨ï¼ˆè¶…æ—¶ï¼‰">1. é“¾è¡¨ï¼ˆè¶…æ—¶ï¼‰</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">StockPrice</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">Node</span> head<span class="token punctuation">;</span>    <span class="token class-name">Node</span> cur<span class="token punctuation">;</span>    <span class="token class-name">Node</span> max<span class="token punctuation">;</span>    <span class="token class-name">Node</span> min<span class="token punctuation">;</span>    <span class="token class-name">Node</span> temp<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">StockPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">int</span> timestamp<span class="token punctuation">,</span> <span class="token keyword">int</span> price<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        temp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span>price<span class="token punctuation">,</span> timestamp<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>head <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            head <span class="token operator">=</span> temp<span class="token punctuation">;</span>            cur <span class="token operator">=</span> head<span class="token punctuation">;</span>            max <span class="token operator">=</span> head<span class="token punctuation">;</span>            min <span class="token operator">=</span> head<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>max<span class="token punctuation">.</span>val <span class="token operator">&lt;</span> temp<span class="token punctuation">.</span>val<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                max <span class="token operator">=</span> temp<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>min<span class="token punctuation">.</span>val <span class="token operator">></span> temp<span class="token punctuation">.</span>val<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                min <span class="token operator">=</span> temp<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>date <span class="token operator">&lt;</span> temp<span class="token punctuation">.</span>date<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                cur<span class="token punctuation">.</span>next <span class="token operator">=</span> temp<span class="token punctuation">;</span>                cur <span class="token operator">=</span> temp<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token class-name">Node</span> pre_head <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>head<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token class-name">Node</span> ppre_head <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>pre_head<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">int</span> isResearch <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>                                <span class="token keyword">while</span><span class="token punctuation">(</span>pre_head<span class="token punctuation">.</span>next<span class="token punctuation">.</span>date <span class="token operator">&lt;</span> temp<span class="token punctuation">.</span>date<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    pre_head <span class="token operator">=</span> pre_head<span class="token punctuation">.</span>next<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>pre_head<span class="token punctuation">.</span>next<span class="token punctuation">.</span>date <span class="token operator">==</span> temp<span class="token punctuation">.</span>date<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">if</span><span class="token punctuation">(</span>pre_head<span class="token punctuation">.</span>next<span class="token punctuation">.</span>val <span class="token operator">==</span> max<span class="token punctuation">.</span>val <span class="token operator">&amp;&amp;</span> max<span class="token punctuation">.</span>val <span class="token operator">></span> temp<span class="token punctuation">.</span>val <span class="token operator">||</span> pre_head<span class="token punctuation">.</span>next<span class="token punctuation">.</span>val <span class="token operator">==</span> min<span class="token punctuation">.</span>val <span class="token operator">&amp;&amp;</span> min<span class="token punctuation">.</span>val <span class="token operator">&lt;</span> temp<span class="token punctuation">.</span>val<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        isResearch <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                    pre_head<span class="token punctuation">.</span>next<span class="token punctuation">.</span>val <span class="token operator">=</span> temp<span class="token punctuation">.</span>val<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                    temp<span class="token punctuation">.</span>next <span class="token operator">=</span> pre_head<span class="token punctuation">.</span>next<span class="token punctuation">;</span>                    pre_head<span class="token punctuation">.</span>next <span class="token operator">=</span> temp<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                head <span class="token operator">=</span> ppre_head<span class="token punctuation">.</span>next<span class="token punctuation">.</span>next<span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>isResearch <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                     min <span class="token operator">=</span> max <span class="token operator">=</span> head<span class="token punctuation">;</span>                    pre_head <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>head<span class="token punctuation">)</span><span class="token punctuation">;</span>                                    <span class="token keyword">while</span><span class="token punctuation">(</span>pre_head<span class="token punctuation">.</span>next <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        min <span class="token operator">=</span> min<span class="token punctuation">.</span>val <span class="token operator">></span> pre_head<span class="token punctuation">.</span>next<span class="token punctuation">.</span>val<span class="token operator">?</span>pre_head<span class="token punctuation">.</span>next<span class="token operator">:</span>min<span class="token punctuation">;</span>                        max <span class="token operator">=</span> max<span class="token punctuation">.</span>val <span class="token operator">&lt;</span> pre_head<span class="token punctuation">.</span>next<span class="token punctuation">.</span>val<span class="token operator">?</span>pre_head<span class="token punctuation">.</span>next<span class="token operator">:</span>max<span class="token punctuation">;</span>                        pre_head <span class="token operator">=</span> pre_head<span class="token punctuation">.</span>next<span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>                           <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>                <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">current</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> cur<span class="token punctuation">.</span>val<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">maximum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> max<span class="token punctuation">.</span>val<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">minimum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> min<span class="token punctuation">.</span>val<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">class</span> <span class="token class-name">Node</span><span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> val<span class="token punctuation">;</span>        <span class="token keyword">int</span> date<span class="token punctuation">;</span>        <span class="token class-name">Node</span> next<span class="token punctuation">;</span>        <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">,</span> <span class="token keyword">int</span> date<span class="token punctuation">,</span> <span class="token class-name">Node</span> next<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>val <span class="token operator">=</span> val<span class="token punctuation">;</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>date <span class="token operator">=</span> date<span class="token punctuation">;</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>next <span class="token operator">=</span> next<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p>åˆ†æä¸€ä¸‹ï¼šmaxå’Œminéƒ½åœ¨O1çš„å¤æ‚åº¦å†…è¿”å›ï¼Œæ¯æ¬¡updateéƒ½æœ‰Onçš„æ—¶é—´å¤æ‚åº¦ï¼Œçœ‹èµ·æ¥æ˜¯ä¸å¤ªå¥½ï¼Œä½†ä¹Ÿå¿…é¡»éå†å•Šã€‚è¿™é‡Œè¯´æˆ‘è¶…å‡ºæ—¶é—´é™åˆ¶æ˜¯updateæ“ä½œã€‚éš¾é“ç”¨HashMapï¼Ÿ</p><h3 id="2-å“ˆå¸Œè¡¨-æœ‰åºé›†åˆï¼ˆè½¬ï¼‰">2. å“ˆå¸Œè¡¨+æœ‰åºé›†åˆï¼ˆè½¬ï¼‰</h3><p>å“ˆå¸Œè¡¨ç”¨æ¥å­˜å‚¨å¯¹åº”stampçš„priceï¼Œæœ‰åºé›†åˆæ¥ç»´æŠ¤priceçš„æœ‰åºé›†åˆ</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">StockPrice</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> maxTimestamp<span class="token punctuation">;</span>    <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> timePriceMap<span class="token punctuation">;</span>    <span class="token class-name">TreeMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> prices<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">StockPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        maxTimestamp <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        timePriceMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        prices <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TreeMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">int</span> timestamp<span class="token punctuation">,</span> <span class="token keyword">int</span> price<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        maxTimestamp <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>maxTimestamp<span class="token punctuation">,</span> timestamp<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> prevPrice <span class="token operator">=</span> timePriceMap<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>timestamp<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        timePriceMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>timestamp<span class="token punctuation">,</span> price<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>prevPrice <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            prices<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>prevPrice<span class="token punctuation">,</span> prices<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>prevPrice<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>prices<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>prevPrice<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                prices<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>prevPrice<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        prices<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>price<span class="token punctuation">,</span> prices<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>price<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">current</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> timePriceMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>maxTimestamp<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">maximum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> prices<span class="token punctuation">.</span><span class="token function">lastKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">minimum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> prices<span class="token punctuation">.</span><span class="token function">firstKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220124112445414.png" alt="image-20220124112445414"></p><p>åˆå§‹åŒ–å¤æ‚åº¦O1<br>æ›´æ–°æ“ä½œã€è¿”å›æœ€å¤§å€¼å’Œæœ€å°å€¼çš„æ—¶é—´å¤æ‚åº¦æ˜¯OlogN</p><h3 id="3-å“ˆå¸Œè¡¨-2ä¸ªä¼˜å…ˆé˜Ÿåˆ—">3. å“ˆå¸Œè¡¨+2ä¸ªä¼˜å…ˆé˜Ÿåˆ—</h3><p>å“ˆå¸Œè¡¨è¿˜æ˜¯æ¥å­˜stamp-priceè¿™é‡Œ<br>å¦™åœ¨ä¼˜å…ˆé˜Ÿåˆ—å®ç°äº†å»¶è¿Ÿåˆ é™¤ï¼Œåˆ¤æ–­äº†stampå¯¹åº”çš„priceæ˜¯å¦æ˜¯çœŸå®çš„</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">StockPrice</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> maxTimestamp<span class="token punctuation">;</span>    <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> timePriceMap<span class="token punctuation">;</span>    <span class="token class-name">PriorityQueue</span><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span> pqMax<span class="token punctuation">;</span>    <span class="token class-name">PriorityQueue</span><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span> pqMin<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">StockPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        maxTimestamp <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        timePriceMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        pqMax <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PriorityQueue</span><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">-></span> b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        pqMin <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PriorityQueue</span><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">-></span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token keyword">int</span> timestamp<span class="token punctuation">,</span> <span class="token keyword">int</span> price<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        maxTimestamp <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>maxTimestamp<span class="token punctuation">,</span> timestamp<span class="token punctuation">)</span><span class="token punctuation">;</span>        timePriceMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>timestamp<span class="token punctuation">,</span> price<span class="token punctuation">)</span><span class="token punctuation">;</span>        pqMax<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>price<span class="token punctuation">,</span> timestamp<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        pqMin<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>price<span class="token punctuation">,</span> timestamp<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">current</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> timePriceMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>maxTimestamp<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">maximum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> priceTime <span class="token operator">=</span> pqMax<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> price <span class="token operator">=</span> priceTime<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> timestamp <span class="token operator">=</span> priceTime<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>timePriceMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>timestamp<span class="token punctuation">)</span> <span class="token operator">==</span> price<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> price<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            pqMax<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">minimum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> priceTime <span class="token operator">=</span> pqMin<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> price <span class="token operator">=</span> priceTime<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> timestamp <span class="token operator">=</span> priceTime<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>timePriceMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>timestamp<span class="token punctuation">)</span> <span class="token operator">==</span> price<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> price<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            pqMin<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220124112935563.png" alt="image-20220124112935563"></p><h3 id="æ€»ç»“-v12">æ€»ç»“</h3><ul><li>TreeMapä¸ç†Ÿæ‚‰ï¼Œæ ¹æœ¬æ²¡è€ƒè™‘ï¼Œæœ‰ç©ºå†äº†è§£ä¸€ä¸‹<strong>TreeMap</strong>ã€‚HashMapçœ‹ä¸ä¸Šï¼Œè§‰å¾—æ²¡æœ‰é“¾è¡¨å¿«â€¦</li><li>ä»¥åè¿˜æ˜¯è¦å¤šæƒ³ä¸€ä¸‹ï¼Œæ¯•ç«Ÿé“¾è¡¨åœ¨æ’å…¥æ—¶è¿˜æ˜¯Onçš„å¤æ‚åº¦ï¼Œä½†HashMapåŸºæœ¬æ˜¯O1ï¼Œè¿˜æ˜¯æ²¡æœ‰æƒ³æ¸…æ¥šï¼Œæ‰€ä»¥ä¼šé€ æˆè¶…æ—¶çš„é—®é¢˜ã€‚</li></ul><h2 id="2044-ç»Ÿè®¡æŒ‰ä½æˆ–èƒ½å¾—åˆ°æœ€å¤§å€¼çš„å­é›†æ•°ç›®-â­â­">2044. ç»Ÿè®¡æŒ‰ä½æˆ–èƒ½å¾—åˆ°æœ€å¤§å€¼çš„å­é›†æ•°ç›® â­â­</h2><blockquote><p>Time : 2022 / 3 /15 20 : 20<br>TAGï¼šDFSã€Bit</p></blockquote><div class="code-tag-time">2022/3/15 20:20:00</div><div class="code-tag-label code-tag-label-dfs">DFS</div><div class="code-tag-label code-tag-label-math">Bit</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220315183914714.png" alt="image-20220315183914714"></p><h3 id="å®¡é¢˜-v58">å®¡é¢˜</h3><ul><li>æœ€å¤§å€¼æ•°ç›®å¯èƒ½ä¸å”¯ä¸€ï¼Œæ±‚æ•°ç›®</li><li>ç»†èŠ‚ï¼šæ•°ç»„å¯èƒ½æœ‰ç›¸åŒå…ƒç´ ï¼Œæ— æ’åºé¡ºåº</li><li>éš¾ç‚¹ï¼šå­é›†çš„ æ•°ç›®å¤šï¼Œå¦‚ä½•åˆ’åˆ†æœ€å¤§å€¼å­é›†ã€‚å¯èƒ½æ¶‰åŠDFSï¼Ÿ</li><li>ç†è®ºåŸºç¡€ï¼š<ul><li>ä¸€ä¸ªæ•°å¯ä»¥å˜æ¢æˆ c = a | b çš„å½¢å¼ï¼Œåˆ™å¯ä»¥å®ç°æ›¿ä»£ ã€‚åªè¦ä½æ•°ã€</li></ul></li><li>æ€è·¯ï¼šé¦–å…ˆæœ€å¤§å€¼è‚¯å®šæ˜¯åŒ…å«æ‰€æœ‰å…ƒç´ çš„å€¼ï¼ˆé¢˜ç›®ç»™å‡ºçš„num[i] &gt; 0ï¼‰ï¼Œä»¥æ­¤ä¸ºåŸºç¡€<ul><li>æœ€æš´åŠ›ï¼šæ±‚å‡ºæ‰€æœ‰å­é›†çš„ä¸ï¼Œæ”¾åœ¨å“ˆå¸Œè¡¨ä¸­ï¼Œç„¶åæ‰¾ç»“æœ</li><li>ç®€å•ï¼šå…ˆè®¡ç®—å‡ºæœ€å¤§å€¼ï¼ˆå…¨é›†ï¼‰ï¼Œä½¿ç”¨DFSä¾æ¬¡å»æ‰</li><li>è¿›é˜¶ï¼š</li></ul></li></ul><h3 id="1-ä½è¿ç®—-ï¼ˆè½¬ï¼‰">1. ä½è¿ç®— ï¼ˆè½¬ï¼‰</h3><p><strong>ä¸€ä¸ªå·²ç»å¿½ç•¥å·²ä¹…çš„åº”ç”¨ï¼š ä½è¿ç®—ä¸­ä¸€ä¸ªæ•°å¯çœ‹æˆæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œ1 ä»£è¡¨é€‰ä¸­ 0 ä»£è¡¨æœªé€‰ä¸­</strong></p><p>è¿™é‡Œå°±ç”¨ä¸€ä¸ªæ•°æ¥ä»£è¡¨æ•°ç»„ï¼Œç›®çš„æ˜¯<strong>æ–¹ä¾¿è¿›è¡Œä½æ•°çš„å·¦å³ç§»åŠ¨ å’Œ ä¸æˆ–è¿ç®—</strong>ã€‚å¤–å±‚ä»£è¡¨çš„æ˜¯æ˜¯å¦é€‰ä¸­nä½æ•°ï¼Œæ€»å…±æœ‰2 ^ nums.length ï¼Œå†…å±‚åˆ™å¯¹å…¶è¿›è¡Œå¤šæ¬¡ä¸è¿ç®—</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">countMaxOrSubsets</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> maxOr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> orVal <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">>></span> j<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    orVal <span class="token operator">|=</span> nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>orVal <span class="token operator">></span> maxOr<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                maxOr <span class="token operator">=</span> orVal<span class="token punctuation">;</span>                cnt <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>orVal <span class="token operator">==</span> maxOr<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                cnt<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> cnt<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// ä½œè€…ï¼šLeetCode-Solution</span><span class="token comment">// é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/count-number-of-maximum-bitwise-or-subsets/solution/tong-ji-an-wei-huo-neng-de-dao-zui-da-zh-r6zd/</span></code></pre></div><p>æ—¶é—´å¤æ‚åº¦ï¼šO(1 &lt;&lt; nums.length) * O(nums.length)<br>ç©ºé—´å¤æ‚åº¦ï¼šO(1)</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220315194820977.png" alt="image-20220315194820977"></p><h3 id="2-å›æº¯-DFS-ï¼ˆè½¬ï¼‰">2. å›æº¯ / DFS ï¼ˆè½¬ï¼‰</h3><p>ç”¨çš„å¾ˆå·§å¦™ï¼Œæ¯æ¬¡æ–¹æ³•ç»“æŸå‰å›æº¯ ä¸»è¦æ˜¯è¿›è¡Œäº†ä¸æˆ–çš„ç»“æœï¼Œå®ç°äº†æŸä¸€ä½æ•°ä¸å‚ä¸è¿ç®—çš„æ“ä½œã€‚è¿™é‡Œçš„æ€è·¯è¦å¥½å¥½å­¦ä¹ </p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">;</span>    <span class="token keyword">int</span> maxOr<span class="token punctuation">,</span> cnt<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">countMaxOrSubsets</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>nums <span class="token operator">=</span> nums<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>maxOr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> cnt<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> pos<span class="token punctuation">,</span> <span class="token keyword">int</span> orVal<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>pos <span class="token operator">==</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>orVal <span class="token operator">></span> maxOr<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                maxOr <span class="token operator">=</span> orVal<span class="token punctuation">;</span>                cnt <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>orVal <span class="token operator">==</span> maxOr<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                cnt<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>pos <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> orVal <span class="token operator">|</span> nums<span class="token punctuation">[</span>pos<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>pos <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> orVal<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token comment">// ä½œè€…ï¼štong-zhu</span><span class="token comment">// é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/count-number-of-maximum-bitwise-or-subsets/solution/by-tong-zhu-mmeu/</span></code></pre></div><p>æ—¶é—´å¤æ‚åº¦ï¼šO(1 &lt;&lt; nums.length)<br>ç©ºé—´å¤æ‚åº¦ï¼šO(nums.length) ï¼ˆè°ƒç”¨æ ˆå ç”¨ç©ºé—´ï¼‰</p><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220315195438852.png" alt="image-20220315195438852"></p><h4 id="ä¼˜åŒ–-v9">ä¼˜åŒ–</h4><p>å› ä¸ºæ˜¯é¡ºåºæœç´¢çš„ï¼Œæˆ–çš„ç»“æœæ˜¯ä¾æ¬¡å¢å¤§ï¼Œæ‰€ä»¥å…ˆéå†ä¸€æ¬¡æ±‚å‡ºmaxï¼Œå¦‚æœåœ¨çš„dfsæ—¶å…¶å€¼ç­‰äºmaxï¼Œåˆ™å¯ä»¥ç›´æ¥è®¡ç®—å‡ºç»“æœ</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span>or <span class="token operator">==</span> max<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            ans <span class="token operator">+=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>nums<span class="token punctuation">.</span>length <span class="token operator">-</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span></code></pre></div><h4 id="å†ä¼˜åŒ–">å†ä¼˜åŒ–</h4><p>å‰é¢æ­¥éª¤ä¸­æ˜¯æŒ‰é¡ºåºä»0 å¼€å§‹ ä¸¤ç§æƒ…å†µï¼Œç®—å½“å‰å€¼å’Œä¸ç®—å½“å‰å€¼ è¿›è¡Œdfsçš„ï¼Œè¿˜å¯ä»¥ä»å¹¿åº¦ä¸Šæ¥çœ‹ï¼Œå¯¹æŸä¸€å±‚æ¥è¯´ï¼Œå¹¿åº¦éå†å…¶å‰©ä¸‹å…ƒç´ æˆ–ç»“æœï¼Œå¦‚æœç­‰äºmaxï¼Œåˆ™ç›´æ¥return</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> or<span class="token punctuation">,</span> <span class="token keyword">int</span> max<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>or <span class="token operator">==</span> max<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        ans <span class="token operator">+=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>nums<span class="token punctuation">.</span>length <span class="token operator">-</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> i<span class="token punctuation">;</span> j <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> or <span class="token operator">|</span> nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> max<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220315201634199.png" alt="image-20220315201634199"></p><p>å°½ç®¡æ—¶é—´ç©ºé—´å¤æ‚åº¦è¿˜æ˜¯ä¸å˜ï¼Œä½†å®ƒä¼˜åŒ–äº†å¤šæ•°æƒ…å†µã€‚åªèƒ½è¯´å¤ªå¼ºâ€¦</p><h3 id="åæ€-v17">åæ€</h3><ul><li>å¤ªèœäº†å¤ªèœäº†ï¼Œæ€è·¯æ˜¯åœ¨DFSä¸Šçš„ éå†å¾—åˆ°maxçš„æ€è·¯ä¹Ÿæ˜¯æœ‰çš„ï¼Œä½†çº ç»“ç‚¹åœ¨äº <strong>å¦‚ä½•ç®—ä¸€ä¸ªé›†åˆçš„å­é›†çš„æˆ–ç»“æœ</strong>ï¼ŒåµŒå¥—å¾ªç¯éƒ½æ˜¯ä¸å¯èƒ½å®ç°çš„ï¼Œä½†DFSè¿˜æ˜¯çº ç»“äºå±‚æ•°å’Œç´¢å¼•ï¼Œå›æº¯æ€è·¯ä¸å¯¹</li><li>ä½è¿ç®— 1 &lt;&lt; nums.length æ„ä¹‰æƒ³æ¸…æ¥šï¼Œä½è¿ç®—ä¸ä»…ä»…åªæ˜¯ä¸æˆ–çš„è¿ç®—ï¼Œè¿˜åŒ…å« 1 0 è¡¨ç¤ºçš„æ„ä¹‰</li></ul><h2 id="2055-èœ¡çƒ›ä¹‹é—´çš„ç›˜å­-â­â­">2055. èœ¡çƒ›ä¹‹é—´çš„ç›˜å­ â­â­</h2><div class="code-tag-time">2022/3/8 21:09:00</div><div class="code-tag-label code-tag-label-presum">PrefixSum</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220308191156316.png" alt="image-20220308191156316"></p><h3 id="å®¡é¢˜-v59">å®¡é¢˜</h3><ul><li>ç¬¬ä¸€çœ¼ï¼šæ‹¬å·åŒ¹é…-----&gt; æ ˆï¼ˆé”™äº†ï¼ï¼‰</li><li>æŸ¥è¯¢ç´¢å¼•çš„ç»™å‡ºæ˜¯ä¹±åºçš„</li><li>æ€è·¯ï¼š<ul><li>ç®€å•ï¼šæŠŠæœ€è¿‘çš„ | æ‰¾åˆ°ï¼Œç„¶åæ‰¾ä¸‹ä¸€ä¸ª | ï¼Œä¸­é—´çš„ * åˆ™ç´¯åŠ </li><li>è¿›é˜¶ï¼š<ol><li>ç®€å•æ–¹æ³•ä¼šé‡å¤éå†ä¹‹å‰ç®—è¿‡çš„éƒ¨åˆ†åºåˆ—ï¼Œä¸æ–¹ä¾¿ã€‚è¿™é‡Œç›²çŒœæ˜¯çº¿æ®µæ ‘äº†ï¼Œå› ä¸ºå…·ä½“æŸæ®µè·ç¦»å¯¹ç»“æœæœ‰å½±å“</li><li>æ’ä¹…ä¸å˜çš„è¯é¢˜ï¼šèƒ½ä¸èƒ½ä¸€æ¬¡éå†å¾—åˆ°ã€‚å³ç†æƒ³ç»“æœï¼šæˆ‘å…ˆéå†ä¸€æ¬¡æ•°ç»„ï¼Œç„¶åä½ ç»™æˆ‘ä¸€ä¸ªæŸ¥è¯¢åºåˆ—ï¼Œæˆ‘åœ¨OÂ©çš„æ—¶é—´å¤æ‚åº¦å†…è¿”å›æ¯ä¸ªç»“æœï¼ˆ<strong>è¿™ä¸ªæƒ³æ³•ä¸é”™ï¼</strong>ï¼‰</li></ol></li></ul></li></ul><h3 id="1-æš´åŠ›åŒå¾ªç¯ï¼ˆXï¼‰">1. æš´åŠ›åŒå¾ªç¯ï¼ˆXï¼‰</h3><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">platesBetweenCandles</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> queries<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>queries<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> queries<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> temp <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> queries<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> queries<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token char">'|'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token char">'*'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                temp<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token char">'|'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                num <span class="token operator">+=</span> temp<span class="token punctuation">;</span>                temp <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> num<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre></div><p>è¶…æ—¶ï¼Œå› ä¸ºå¤æ‚åº¦åˆ°O(n^2)äº†</p><h3 id="2-ç¼“å­˜ç´¢å¼•ï¼ˆXï¼‰">2. ç¼“å­˜ç´¢å¼•ï¼ˆXï¼‰</h3><p>æŠŠå¸¦ | çš„ç´¢å¼•ä½ç½®éƒ½ç¼“å­˜ä¸‹æ¥ï¼Œç„¶åæ ¹æ®é¡ºåºæ‰¾åˆ°æœ€å°çš„å·¦å¼€ç«¯ï¼Œå°±èƒ½ç®—å‡ºä¸ªæ•°</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">platesBetweenCandles</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> queries<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>queries<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> candleIdx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token char">'|'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                candleIdx<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> queries<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> leftIndex <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> rightIndex <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> candleCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> candleIdx<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>leftIndex <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> candleIdx<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">>=</span> queries<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> candleIdx<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> queries<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    leftIndex <span class="token operator">=</span> k<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>leftIndex <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> candleIdx<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> queries<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        rightIndex <span class="token operator">=</span> k<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>candleIdx<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">></span> queries<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>leftIndex <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> rightIndex <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> leftIndex<span class="token punctuation">;</span> k <span class="token operator">&lt;</span> rightIndex<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    candleCnt <span class="token operator">+=</span> candleIdx<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> candleIdx<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                candleCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> candleCnt<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p>è¶…æ—¶ï¼ŒO(n^2)æ—¶é—´å¤æ‚åº¦ã€‚<strong>èƒ½ä¸èƒ½ä¸æ‰¾ å·¦ä¸´ç•Œå€¼ï¼Ÿ</strong></p><h3 id="3-ç¼“å­˜ä¸´ç•Œæœ€å€¼ï¼ˆXï¼‰">3. ç¼“å­˜ä¸´ç•Œæœ€å€¼ï¼ˆXï¼‰</h3><p>é¢„å¤„ç†çš„å½±å­</p><p>æ–¹æ³•2çš„æ”¹è‰¯ç‰ˆï¼Œé€šè¿‡å“ˆå¸Œè¡¨ç¼“å­˜äº†æ¯ä¸ªç´¢å¼•ä¸‹çš„<strong>ä¹‹å‰æœ€è¿‘</strong>çš„é‚£ä¸ªä¸€ä¸ª | çš„ç´¢å¼•å€¼ï¼Œå°±ä¸ç”¨åœ¨é€šè¿‡Onçš„æ—¶é—´å¤æ‚åº¦æŸ¥æ‰¾å·¦ä¸´ç•Œå€¼äº†ï¼Œä½†è¿˜æ˜¯è¶…æ—¶</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">platesBetweenCandles</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> queries<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>queries<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> candleIdx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> mapInt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token char">'|'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                candleIdx<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            mapInt<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> candleIdx<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> queries<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> leftIndex <span class="token operator">=</span> mapInt<span class="token punctuation">[</span>queries<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> rightIndex <span class="token operator">=</span> mapInt<span class="token punctuation">[</span>queries<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> candleCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>queries<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token char">'|'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                leftIndex<span class="token operator">--</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>leftIndex <span class="token operator">&lt;</span> rightIndex <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> leftIndex<span class="token punctuation">;</span> k <span class="token operator">&lt;</span> rightIndex<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    candleCnt <span class="token operator">+=</span> candleIdx<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> candleIdx<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                candleCnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> candleCnt<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p>ç„¶è€Œï¼ï¼ï¼ï¼ï¼ï¼</p><p>åœ¨ç¨å¾®çœ‹äº†ä¸‹ç­”æ¡ˆåï¼Œå‘ç°è‡ªå·±çš„æ€è·¯å’Œç­”æ¡ˆçš„å‰ç¼€å’Œæœ‰ç±»ä¼¼ä¹‹å¤„ï¼Œå‘ç°è‡ªå·±çš„æ€è·¯è‚¯å®šä¹Ÿæ˜¯å¯è¡Œçš„ï¼Œå°±ç»§ç»­æ›´æ”¹ï¼Œå‰é¢çš„å¤„ç†éƒ½æ²¡é—®é¢˜ï¼Œä¸»è¦æ˜¯åé¢ç®—ç´¯è®¡å’Œçš„æ—¶å€™ï¼Œåˆè¿›è¡Œäº†ä¸€æ¬¡forå¾ªç¯ï¼Œè™½ç„¶å¾ˆçŸ­ï¼Œä½†ä»æ€§èƒ½ä¸Šæ¥è¯´ï¼Œä¹Ÿä¸å¥½ï¼Œè¿™ä¹Ÿæ˜¯é€ æˆè¶…æ—¶çš„é‡è¦åŸå› ï¼Œå°±ä¼˜åŒ–äº†ä¸€ä¸‹ï¼š</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">if</span><span class="token punctuation">(</span>leftIndex <span class="token operator">&lt;</span> rightIndex <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        candleCnt <span class="token operator">+=</span> candleIdx<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>rightIndex<span class="token punctuation">)</span> <span class="token operator">-</span> candleIdx<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>leftIndex<span class="token punctuation">)</span> <span class="token operator">-</span> rightIndex <span class="token operator">+</span> leftIndex<span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220308205408611.png" alt="image-20220308205408611"></p><p>è¿˜æ˜¯åŠŸå¤«ä¸è´Ÿæœ‰å¿ƒäººå“ˆå“ˆå“ˆï¼Œè¿™é“é¢˜çº ç»“äº†åŠå¤©ï¼Œæœ€åè¿˜æ˜¯å›åˆ°æ­£ç¡®æ€è·¯ä¸Šäº†</p><h3 id="4-é¢„å¤„ç†-å‰ç¼€å’Œï¼ˆè½¬ï¼‰">4. é¢„å¤„ç†+å‰ç¼€å’Œï¼ˆè½¬ï¼‰</h3><p>ç­”æ¡ˆçš„æ€è·¯ï¼š</p><ul><li>ä¸‰ä¸ªæ•°ç»„<ul><li>è®°å½• å‰nä¸ªæ•°ä¸­ * çš„æ€»å’Œ</li><li>è®°å½• ç¬¬nä¸ªæ•°ä¸­<strong>ä¸Šä¸€ä¸ª</strong> | çš„ç´¢å¼•</li><li>è®°å½•ç¬¬nä¸ªæ•°ä¸­ <strong>ä¸‹ä¸€ä¸ª</strong> | çš„ç´¢å¼•</li></ul></li><li>æ¯”è¾ƒæ¡ä»¶ï¼ŒäºŒè€…ä¸ä¸º-1 ä¸”å·¦è¾¹ | ç´¢å¼•å¤§äºå³è¾¹ | ç´¢å¼•ï¼Œåˆ™<strong>ç»“æœå°±ä¸ºæœ€å³ä¸´ç•Œå€¼- æœ€å·¦ä¸´ç•Œå€¼</strong>ï¼ˆæ•°å€¼ï¼‰ã€ç¡®å®ï¼ã€‘</li></ul><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">platesBetweenCandles</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> queries<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> preSum <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token char">'*'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                sum<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            preSum<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> sum<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> left <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token char">'|'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                l <span class="token operator">=</span> i<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            left<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> l<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> right <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token char">'|'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                r <span class="token operator">=</span> i<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            right<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ans <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>queries<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> queries<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> query <span class="token operator">=</span> queries<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> x <span class="token operator">=</span> right<span class="token punctuation">[</span>query<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y <span class="token operator">=</span> left<span class="token punctuation">[</span>query<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> x <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> y <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> x <span class="token operator">>=</span> y <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> preSum<span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">-</span> preSum<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> ans<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// ä½œè€…ï¼šLeetCode-Solution</span><span class="token comment">// é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/plates-between-candles/solution/zha-zhu-zhi-jian-de-pan-zi-by-leetcode-s-ejst/</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220308210041331.png" alt="image-20220308210041331"></p><p>è¿™é‡Œæ‹¿ç©ºé—´æ¢æ—¶é—´ï¼ˆ3ä¸ªNé•¿åº¦æ•°ç»„ï¼‰ï¼Œæ‰€ä»¥ç©ºé—´å¤æ‚åº¦ä½ï¼Œä½†æ—¶é—´å¤æ‚åº¦å°±é«˜èµ·æ¥äº†ï¼ŒO(n+q) ï¼šOnçš„æ—¶é—´é¢„å¤„ç†  O(q)å¤„ç†qä¸ªè¯¢é—®ï¼ˆæ¯ä¸ªè¯¢é—®å¤„ç†æ—¶é—´ä¸ºO(1)ï¼‰</p><h3 id="åæ€-v18">åæ€</h3><ul><li>ç®€å•ç®—æ³•ä¸Šæ²¡æµªè´¹å¤ªå¤šæ—¶é—´ï¼Œè¿˜è¡Œ</li><li>èƒ½æƒ³åˆ°ç¼“å­˜ï¼ˆå³é¢„å¤„ç†ï¼‰ è¿›è€Œæƒ³åˆ°ä¸€ç‚¹ç‚¹å‰ç¼€å’Œçš„æ€æƒ³ï¼Œè¿˜å¯ä»¥</li><li>æ€è·¯ä¸Šèƒ½æƒ³åˆ°ä¸€æ¬¡éå†ï¼Œæœ‰é¢„å¤„ç†çš„å½±å­ï¼Œå¯ä»¥</li><li>å‰ç¼€å’Œä¸ç†Ÿæ‚‰ï¼Œé¢„å¤„ç†çš„æƒ³æ³•è¿˜æ²¡å»ºç«‹åœ¨è„‘æµ·ä¸­ï¼Œæ…¢æ…¢å‘ç°ä¸æ˜¯çº¿æ®µæ ‘ä¸æ˜¯è¿™ç§ç±»å‹ï¼Ÿå‰ç¼€å’Œè¿™é‡Œçš„å åŠ æ€æƒ³åšçš„æ—¶å€™æ²¡æœ‰æƒ³å‡ºæ¥ å³<br>è‹¥æœ‰å€¼  å€¼ = æœ€å³ä¸è¶…å‡ºçš„ç´¢å¼•å€¼ï¼ˆoriginï¼‰ - æœ€å·¦ä¸è¶…å‡ºçš„ç´¢å¼•å€¼ï¼ˆoriginï¼‰</li></ul><h2 id="2100-é€‚åˆæ‰“åŠ«é“¶è¡Œçš„æ—¥å­-â­â­">2100. é€‚åˆæ‰“åŠ«é“¶è¡Œçš„æ—¥å­ â­â­</h2><blockquote><p>2022 / 3 / 6 18:35</p></blockquote><div class="code-tag-time">2022/3/6 18:35:00</div><div class="code-tag-label code-tag-label-foreach">Foreach</div><div class="code-tag-label code-tag-label-dp">DP</div><div class="code-tag-label code-tag-label-hash">Hash</div><div class="code-tag-label code-tag-label-sw">Slide Window</div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220306185329864.png" alt="image-20220306185329864"></p><p>å®¡é¢˜</p><ul><li>ä¸‹æ ‡ä»0å¼€å§‹ï¼Œæœ‰ç¬¬0å¤©</li><li>è¿”å›çš„æ˜¯æ‰€æœ‰å¯èƒ½çš„å¤©æ•°</li><li>é—®é¢˜æ ¸å¿ƒï¼šæ‰¾åˆ°æ•°ç»„ä¸­ç»™å®šé—´éš”æ•°ä¸­å‰æ®µå•å‡åæ®µå•å¢çš„æ•°</li><li>å¯èƒ½çš„æ•°æ®ç»“æ„ï¼šæ»‘åŠ¨çª—å£ï¼Ÿæ ˆæˆ–é˜Ÿåˆ—ï¼Ÿ</li><li>æ€è·¯ï¼š<ul><li>åŸºæœ¬ï¼šé¡ºåºåˆ¤æ–­</li><li>è¿›é˜¶ï¼šé˜Ÿåˆ—æŠ½</li></ul></li></ul><h3 id="1-é¡ºåºéå†-v2">1. é¡ºåºéå†</h3><p>æ€è·¯è¿˜æ˜¯ä¾æ¬¡éå† + flagæ¡ä»¶ç­›é€‰ï¼Œä½†è¿™é‡Œä¸ºäº†è§£å†³é¢˜ä¸­çš„å¤§é‡é‡å¤æ•°ç»„å¸¦æ¥çš„è¶…æ—¶é™åˆ¶ï¼Œæˆ‘å°±ç¨å¾®ä¼˜åŒ–äº†ä¸€ä¸‹ï¼Œå¢åŠ äº†ä¸ªå‰ç½®æ¡ä»¶çš„åˆ¤æ–­ï¼šå¦‚æœä¸Šä¸€ä¸ªå¤©æ•°ä¹Ÿæ˜¯Rob Dayï¼Œé‚£åªéœ€è¦åˆ¤æ–­ä¸€ä¸‹å°±å¯ä»¥çŸ¥é“è¿™ä¸€å¤©æ˜¯ä¸æ˜¯Rob Dayäº†ï¼Œä½†å®é™…ä¸Šæ˜¯æ²¡æœ‰è§£å†³æ—¶é—´å¤æ‚åº¦çš„é—®é¢˜çš„ã€‚</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> <span class="token function">goodDaysToRobBank</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> security<span class="token punctuation">,</span> <span class="token keyword">int</span> time<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> time <span class="token operator">>=</span> security<span class="token punctuation">.</span>length<span class="token punctuation">)</span>            <span class="token keyword">return</span> res<span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> time<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> security<span class="token punctuation">.</span>length <span class="token operator">-</span> time<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> res<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>security<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">>=</span> security<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> security<span class="token punctuation">[</span>i <span class="token operator">+</span> time <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> security<span class="token punctuation">[</span>i <span class="token operator">+</span> time<span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">continue</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">int</span> flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> k <span class="token operator">&lt;=</span> time<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>security<span class="token punctuation">[</span>i <span class="token operator">-</span> k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">></span> security<span class="token punctuation">[</span>i <span class="token operator">-</span> k<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    flag <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> k <span class="token operator">&lt;=</span> time<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>security<span class="token punctuation">[</span>i <span class="token operator">+</span> k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">></span> security<span class="token punctuation">[</span>i <span class="token operator">+</span> k<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    flag <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220306191717393.png" alt="image-20220306191717393"></p><p>è¿™ä¸ªç»“æœä¹Ÿæ˜¯æ„æ–™ä¹‹ä¸­äº†ï¼Œä¼¼ä¹æš´åŠ›éƒ½æ˜¯5%ï¼Ÿä¸è¿‡å†…å­˜æ¶ˆè€—è¿˜ä¸é”™</p><p>ç©ºé—´å¤æ‚åº¦ï¼šO(n)<br>æ—¶é—´å¤æ‚åº¦ï¼š$\sum\limits_{i=1}^{security.length - time * 2} \quad \sum\limits_{k=1}^{time * 2}$</p><h3 id="2-æ»‘åŠ¨çª—å£ï¼ˆé˜Ÿåˆ—å®ç°ï¼‰">2. æ»‘åŠ¨çª—å£ï¼ˆé˜Ÿåˆ—å®ç°ï¼‰</h3><p>é˜Ÿåˆ—å®ç°çš„æ»‘åŠ¨çª—å£ï¼Œè¿‡æœŸè‡ªåŠ¨åˆ é™¤ã€‚æœªè¿‡æœŸåˆåœ¨è¿è§„é˜Ÿåˆ—ä¸­ï¼Œé‚£å°±è¯´æ˜è¿™ä¸ªæ•°ä¸æ˜¯åˆé€‚çš„Rob Day</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> <span class="token function">goodDaysToRobBank</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> security<span class="token punctuation">,</span> <span class="token keyword">int</span> time<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> time <span class="token operator">>=</span> security<span class="token punctuation">.</span>length<span class="token punctuation">)</span>          <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token comment">// é¿å…é›¶æ­¥é•¿å¯¼è‡´i-1 &lt; 0 çš„æƒ…å†µ</span>      <span class="token keyword">if</span><span class="token punctuation">(</span>time <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> security<span class="token punctuation">.</span>length <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>          <span class="token keyword">return</span> res<span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      <span class="token class-name">Queue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> leftQueue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token class-name">Queue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> rightQueue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> time<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>security<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> security<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>              leftQueue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>security<span class="token punctuation">[</span>time <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">></span> security<span class="token punctuation">[</span>time <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              rightQueue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>i <span class="token operator">+</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> time<span class="token punctuation">;</span> time <span class="token operator">+</span> i <span class="token operator">&lt;</span> security<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">int</span> flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>security<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> security<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                  leftQueue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>security<span class="token punctuation">[</span>i <span class="token operator">+</span> time <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">></span> security<span class="token punctuation">[</span>time <span class="token operator">+</span> i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                  rightQueue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>i <span class="token operator">+</span> time <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>          <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>leftQueue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              <span class="token keyword">int</span> leftTemp <span class="token operator">=</span> leftQueue<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token keyword">if</span><span class="token punctuation">(</span>leftTemp <span class="token operator">&lt;</span> i <span class="token operator">-</span> time<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                  leftQueue<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                  flag <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>                  <span class="token keyword">break</span><span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>          <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>rightQueue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              <span class="token keyword">int</span> rightTemp <span class="token operator">=</span> rightQueue<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token keyword">if</span><span class="token punctuation">(</span>rightTemp <span class="token operator">&lt;</span> i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                  rightQueue<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                  flag <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>                  <span class="token keyword">break</span><span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>              <span class="token keyword">continue</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>leftQueue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> rightQueue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>              <span class="token keyword">if</span><span class="token punctuation">(</span> security<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">>=</span> security<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> security<span class="token punctuation">[</span>i <span class="token operator">+</span> time <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> security<span class="token punctuation">[</span>time <span class="token operator">+</span> i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                  res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span>              <span class="token keyword">continue</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">return</span> res<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220306201139696.png" alt="image-20220306201139696"></p><p>çœŸçš„ä¸æ‡‚ä¸ºå•¥è¿™ä¹ˆæ…¢å•Šï¼Œæˆ‘æ„Ÿè§‰è¿˜è¡Œå•Šï¼Œä¹Ÿæ˜¯åœ¨ä¸€æ¬¡éå†å°±è§£å†³é—®é¢˜å•Šã€‚ã€‚ã€‚</p><p>ç©ºé—´å¤æ‚åº¦ï¼šOn<br>æ—¶é—´å¤æ‚åº¦ï¼šOn ï¼ˆæ„Ÿè§‰ï¼‰</p><h3 id="3-åŠ¨æ€è§„åˆ’-v2">3. åŠ¨æ€è§„åˆ’</h3><p>æˆ‘æ˜¯å‚»é€¼ä¹‹æ²¡æƒ³èµ·dpâ€¦</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> <span class="token function">goodDaysToRobBank</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> security<span class="token punctuation">,</span> <span class="token keyword">int</span> time<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> security<span class="token punctuation">.</span>length<span class="token punctuation">;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> left <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> right <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>security<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> security<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                left<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> left<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>security<span class="token punctuation">[</span>n <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> security<span class="token punctuation">[</span>n <span class="token operator">-</span> i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                right<span class="token punctuation">[</span>n <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> right<span class="token punctuation">[</span>n <span class="token operator">-</span> i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> ans <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> time<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n <span class="token operator">-</span> time<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>left<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">>=</span> time <span class="token operator">&amp;&amp;</span> right<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">>=</span> time<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                ans<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> ans<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// ä½œè€…ï¼šLeetCode-Solution</span><span class="token comment">// é“¾æ¥ï¼šhttps://leetcode-cn.com/problems/find-good-days-to-rob-the-bank/solution/gua-he-da-jie-yin-xing-de-ri-zi-by-leetc-z6r1/</span></code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220306224419161.png" alt="image-20220306224419161"></p><h3 id="4-åŒå‘éå†-å“ˆå¸Œ-è½¬">4. åŒå‘éå†+å“ˆå¸Œ(è½¬)</h3><p>æ­£å‘æ ‡è®°å‡ºå‰ <code>time</code> å¤©ç¬¦åˆæ¡ä»¶çš„æ—¥æœŸï¼Œé€†å‘éå†é€‰å‡ºå‰åéƒ½ç¬¦åˆçš„åŠ å…¥ç­”æ¡ˆï¼Œè¿˜ä¸æ˜¯å¾ˆç†è§£ã€‚ä¸è¿‡ç¡®å®ç‰›é€¼ï¼ŒåŒç™¾è¶‹å‘ã€‚</p><div class="code-wrapper"><pre class="language-c++" data-language="c++"><code class="language-c++">class Solution &#123;public:    vector&lt;int&gt; goodDaysToRobBank(vector&lt;int&gt;&amp; security, int time) &#123;        vector&lt;int&gt; ans;        int rear &#x3D; -1, n &#x3D; security.size(), cnt &#x3D; 1;        for(int i &#x3D; 0; i &lt; n; ++i)&#123;            int x &#x3D; security[i];            rear &gt;&#x3D; x ? ++cnt : cnt &#x3D; 1;            if(cnt &gt; time) security[i] ^&#x3D; (1&lt;&lt;30);            rear &#x3D; x;        &#125;        rear &#x3D; -1, cnt &#x3D; 0;        for(int i &#x3D; n-1; i &gt;&#x3D; 0; --i)&#123;            int x &#x3D; security[i] &amp;~ (1&lt;&lt;30);            rear &gt;&#x3D; x ? ++cnt : cnt &#x3D; 1;            if(cnt &gt; time &amp;&amp; (security[i] &gt;&gt; 30)) ans.push_back(i);            rear &#x3D; x;        &#125;        return ans;    &#125;&#125;;&#x2F;&#x2F; é“¾æ¥ï¼šhttps:&#x2F;&#x2F;leetcode-cn.com&#x2F;problems&#x2F;find-good-days-to-rob-the-bank&#x2F;solution&#x2F;gua-he-da-jie-yin-xing-de-ri-zi-by-leetc-z6r1&#x2F;1418616</code></pre></div><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20220306224704953.png" alt="image-20220306224704953"></p><h3 id="æ€»ç»“-v13">æ€»ç»“</h3><ul><li>Queueè¿˜ä¸æ˜¯å¾ˆç†Ÿæ‚‰</li><li>æ²¡æƒ³åˆ°dpâ€¦ååè¿™æ¬¡æ²¡æƒ³åˆ°</li><li>å…¶ä»–è¿˜å¥½ï¼Œé™¤äº†æ²¡æƒ³åˆ°å¥½æ–¹æ³• è¿˜å½³äº</li></ul><h2 id="-v7">------------------------------------------</h2><h2 id="LRUå®ç°">LRUå®ç°</h2><h2 id="é˜¿é‡Œ2020-æ ˆæ±‚è¡¨è¾¾å¼">é˜¿é‡Œ2020. æ ˆæ±‚è¡¨è¾¾å¼</h2><p><img src="https://s401177923-1302493622.cos.ap-nanjing.myqcloud.com/mdImages/image-20210330202907036.png" alt="image-20210330202907036"></p><h3 id="-v8"></h3><h2 id="è®¡ç®—æ•´æ•°nçš„å¹³æ–¹æ ¹-ç²¾åº¦ä¸º0-00001">è®¡ç®—æ•´æ•°nçš„å¹³æ–¹æ ¹  ç²¾åº¦ä¸º0.00001</h2><h3 id="ç‰›é¡¿è¿­ä»£æ³•">ç‰›é¡¿è¿­ä»£æ³•</h3><p>ç‰›é¡¿è¿­ä»£æ³•ä¸å®‰å…¨</p><p>æˆ‘çš„ä»£ç ï¼š</p><div class="code-wrapper"><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">double</span> <span class="token function">sqrtByMyOwn</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>num<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>                <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">double</span> result1<span class="token punctuation">,</span>result2<span class="token operator">=</span><span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>            <span class="token keyword">double</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">*</span>i<span class="token operator">&lt;</span>num<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                i<span class="token operator">+=</span><span class="token number">0.5</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            result1<span class="token operator">=</span>i<span class="token punctuation">;</span>            <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                result2<span class="token operator">=</span>result1<span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span>num<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>result1<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>result1<span class="token operator">-</span>result2<span class="token operator">&lt;</span><span class="token number">0.00001</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token class-name">BigDecimal</span> b<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span>result2<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">double</span> result<span class="token operator">=</span>b<span class="token punctuation">.</span><span class="token function">setScale</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">.</span>ROUND_HALF_UP<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">doubleValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">return</span> result<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                    result1<span class="token operator">=</span>result2<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span></code></pre></div><blockquote><p>æœ¬åšå®¢é¢˜è§£å‡è½¬è½½äºåŠ›æ‰£å®˜ç½‘ <a href="https://leetcode-cn.com">https://leetcode-cn.com</a>ï¼Œç”¨äºä¸ªäººå­¦ä¹ ç®—æ³•ã€‚å¦‚æœ‰ä¾µæƒï¼Œè¯·è”ç³»ï¼</p></blockquote><script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><script src="https://cdn.bootcss.com/echarts/5.3.2/echarts.common.min.js"></script><script src="/js/custom-echart.js"></script>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
      <tag>ç®—æ³•</tag>
      
      <tag>è€ƒç ”</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
